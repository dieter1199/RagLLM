**Retrieved CVE ID:** CVE-2024-30250

**Related Info:**
Astro-Shield is an integration to enhance website security with SubResource Integrity hashes, Content-Security-Policy headers, and other techniques. Versions from 1.2.0 to 1.3.1 of Astro-Shield allow bypass to the allow-lists for cross-origin resources by introducing valid `integrity` attributes to the injected code. This implies that the injected SRI hash would be added to the generated CSP header, which would lead the browser to believe that the injected resource is legit. This vulnerability is patched in version 1.3.2.

**Mitigation Changes:**
- **astro.config.mjs:**
  - Added lines to ensure allowed scripts are included in the hashes module.
  - Enabled static and middleware SRI with a specific module.
  - Added a list of allowed script URLs.
  
- **core.test.mts:**
  - Updated integrity attributes for test cases to reflect the changes made in the configuration.

These changes help ensure that only explicitly allowed scripts are included in the Content Security Policy (CSP) headers, mitigating the risk of bypassing the allow-lists for cross-origin resources.