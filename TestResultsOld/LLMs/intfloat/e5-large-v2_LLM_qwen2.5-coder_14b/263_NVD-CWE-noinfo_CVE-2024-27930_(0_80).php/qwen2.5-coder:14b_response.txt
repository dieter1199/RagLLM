Based on the provided code changes, it appears that the modifications are aimed at ensuring that the `entity_restrict` parameter is always set to a value returned by `Session::getMatchingActiveEntities()`. This change seems to be an attempt to prevent unauthorized access to entities by restricting requests to only those entities that are active and accessible to the current session.

Given the context, this appears to be a mitigation strategy for a potential vulnerability related to improper entity restriction. However, the exact CVE ID (CVE-2024-23645, CVE-2024-27930, or CVE-2024-27937) is not directly stated in the provided information.

If we were to deduce a likely CVE based on the description and the changes made, it could potentially relate to improper input validation or insufficient authorization checks. However, without explicit confirmation from the source or a vulnerability database, I cannot definitively state which CVE this corresponds to.

Therefore, while the code changes suggest an attempt to mitigate a security issue related to entity restrictions, the specific CVE ID and detailed information are not provided in the given context.