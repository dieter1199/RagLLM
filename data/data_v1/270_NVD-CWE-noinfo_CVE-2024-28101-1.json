{
    "cve_id": "CVE-2024-28101",
    "cve_description": "The Apollo Router is a graph router written in Rust to run a federated supergraph that uses Apollo Federation. Versions 0.9.5 until 1.40.2 are subject to a Denial-of-Service (DoS) type vulnerability. When receiving compressed HTTP payloads, affected versions of the Router evaluate the `limits.http_max_request_bytes` configuration option after the entirety of the compressed payload is decompressed. If affected versions of the Router receive highly compressed payloads, this could result in significant memory consumption while the compressed payload is expanded. Router version 1.40.2 has a fix for the vulnerability. Those who are unable to upgrade may be able to implement mitigations at proxies or load balancers positioned in front of their Router fleet (e.g. Nginx, HAProxy, or cloud-native WAF services) by creating limits on HTTP body upload size. \n",
    "cve_publish_date": "2024-03-21",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "streaming body decompression\n\nClient request body was fully loaded in memory before decompressing, we\nare now decompressing it as it goes",
    "type_of_change": "Modification",
    "filename_of_changes": "common.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 13: use http::header::CONTENT_ENCODING;",
        "// Line_Reference 381:     pub fn execute_bad_content_encoding(",
        "// Line_Reference 390:         content_encoding: Option<&'static str>,",
        "// Line_Reference 407:                     .header(CONTENT_TYPE, APPLICATION_JSON.essence_str())",
        "// Line_Reference 408:                     .header(CONTENT_ENCODING, content_encoding.unwrap_or(\"identity\"))"
    ]
}