{
    "cve_id": "CVE-2024-23325",
    "cve_description": "Envoy is a high-performance edge/middle/service proxy. Envoy crashes in Proxy protocol when using an address type that isnâ€™t supported by the OS. Envoy is susceptible to crashing on a host with IPv6 disabled and a listener config with proxy protocol enabled when it receives a request where the client presents its IPv6 address.  It is valid for a client to present its IPv6 address to a target server even though the whole chain is connected via IPv4. This issue has been addressed in released 1.29.1, 1.28.1, 1.27.3, and 1.26.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-02-09",
    "cwe_id": "CWE-755",
    "cwe_name": "Improper Handling of Exceptional Conditions",
    "cwe_description": "The product does not handle or incorrectly handles an exceptional condition.",
    "commit_message": "Fix crash when proxy protocol receives an address type that isn't\nsupported by the operating system\n\nFix [CVE-2024-23325](https://github.com/envoyproxy/envoy/security/advisories/GHSA-5m7c-mrwr-pm26)\n\nSigned-off-by: Greg Greenway <ggreenway@apple.com>\nSigned-off-by: Ryan Northey <ryan@synca.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "proxy_protocol.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 279:         proxy_protocol_header_.emplace(",
        "// Line_Reference 280:             WireHeader{PROXY_PROTO_V2_HEADER_LEN, hdr_addr_len, PROXY_PROTO_V2_ADDR_LEN_INET,",
        "// Line_Reference 281:                        hdr_addr_len - PROXY_PROTO_V2_ADDR_LEN_INET, Network::Address::IpVersion::v4,",
        "// Line_Reference 282:                        std::make_shared<Network::Address::Ipv4Instance>(&ra4),",
        "// Line_Reference 283:                        std::make_shared<Network::Address::Ipv4Instance>(&la4)});",
        "// Line_Reference 305:         proxy_protocol_header_.emplace(WireHeader{",
        "// Line_Reference 306:             PROXY_PROTO_V2_HEADER_LEN, hdr_addr_len, PROXY_PROTO_V2_ADDR_LEN_INET6,",
        "// Line_Reference 307:             hdr_addr_len - PROXY_PROTO_V2_ADDR_LEN_INET6, Network::Address::IpVersion::v6,",
        "// Line_Reference 308:             std::make_shared<Network::Address::Ipv6Instance>(ra6),",
        "// Line_Reference 309:             std::make_shared<Network::Address::Ipv6Instance>(la6)});"
    ]
}