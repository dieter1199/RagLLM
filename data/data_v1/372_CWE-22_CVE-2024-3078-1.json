{
    "cve_id": "CVE-2024-3078",
    "cve_description": "A vulnerability was found in Qdrant up to 1.6.1/1.7.4/1.8.2 and classified as critical. This issue affects some unknown processing of the file lib/collection/src/collection/snapshots.rs of the component Full Snapshot REST API. The manipulation leads to path traversal. Upgrading to version 1.8.3 is able to address this issue. The patch is named 3ab5172e9c8f14fa1f7b24e7147eac74e2412b62. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-258611.",
    "cve_publish_date": "2024-03-29",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix arbitrary path traversal vulnerability in full snapshot REST API (#3856)\n\n* Improve function to get collection snapshot path\r\n\r\n* Fix arbitrary path traversal in full snapshot path function\r\n\r\n* Add integration test to assert arbitrary path traversal is blocked",
    "type_of_change": "Modification",
    "filename_of_changes": "mod.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 30:     let snapshot_path = Path::new(toc.snapshots_path()).join(snapshot_name);",
        "// Line_Reference 31:     if !snapshot_path.exists() {",
        "// Line_Reference 32:         return Err(StorageError::NotFound {",
        "// Line_Reference 33:             description: format!(\"Full storage snapshot {snapshot_name} not found\"),",
        "// Line_Reference 34:         });",
        "// Line_Reference 36:     Ok(snapshot_path)"
    ]
}