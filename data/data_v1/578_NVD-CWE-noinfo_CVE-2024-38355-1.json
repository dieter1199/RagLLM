{
    "cve_id": "CVE-2024-38355",
    "cve_description": "Socket.IO is an open source, real-time, bidirectional, event-based, communication framework. A specially crafted Socket.IO packet can trigger an uncaught exception on the Socket.IO server, thus killing the Node.js process. This issue is fixed by commit `15af22fc22` which has been included in `socket.io@4.6.2` (released in May 2023). The fix was backported in the 2.x branch as well with commit `d30630ba10`. Users are advised to upgrade. Users unable to upgrade may attach a listener for the \"error\" event to catch these errors.\n",
    "cve_publish_date": "2024-06-19",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "refactor: add a noop handler for the error event\n\nWe should reduce the scope of the \"event\" error in the next major\nversion, as it is overloaded today:\n\n- it can be sent by the client (`socket.emit(\"error\")`, which is a perfectly valid event name)\n- it can be emitted when the connection encounters an error (an invalid packet for example)\n- it can be emitted when a packet is rejected in a middleware (`socket.use()`)\n\nRelated: https://github.com/socketio/socket.io/issues/2047",
    "type_of_change": "Modification",
    "filename_of_changes": "socket.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 723:     if (this.listeners(\"error\").length) {",
        "// Line_Reference 724:       this.emitReserved(\"error\", err);",
        "// Line_Reference 725:     } else {",
        "// Line_Reference 726:       console.error(\"Missing error handler on `socket`.\");",
        "// Line_Reference 727:       console.error(err.stack);",
        "// Line_Reference 728:     }"
    ]
}