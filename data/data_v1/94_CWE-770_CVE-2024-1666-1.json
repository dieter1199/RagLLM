{
    "cve_id": "CVE-2024-1666",
    "cve_description": "In lunary-ai/lunary version 1.0.0, an authorization flaw exists that allows unauthorized radar creation. The vulnerability stems from the lack of server-side checks to verify if a user is on a free account during the radar creation process, which is only enforced in the web UI. As a result, attackers can bypass the intended account upgrade requirement by directly sending crafted requests to the server, enabling the creation of an unlimited number of radars without payment.",
    "cve_publish_date": "2024-04-16",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "fix: security patches (#192)",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 1: import Router from \"koa-router\"",
        "// Line_Reference 4: import { getReadableDateTime } from \"@/src/utils/date\"",
        "// Line_Reference 5: import { runEval } from \"./utils\"",
        "// Line_Reference 6: import { getEvaluation } from \"./utils\"",
        "// Line_Reference 7: import { calcRunCost } from \"@/src/utils/calcCost\"",
        "// Line_Reference 8: import { runChecksOnRun } from \"@/src/checks/runChecks\"",
        "// Line_Reference 11: import { checkAccess } from \"@/src/utils/authorization\"",
        "// Line_Reference 12: import { RunEvent } from \"lunary/types\"",
        "// Line_Reference 23:     const { userId, projectId } = ctx.state"
    ]
}