{
    "cve_id": "CVE-2024-32983",
    "cve_description": "Misskey is an open source, decentralized microblogging platform. Misskey doesn't perform proper normalization on the JSON structures of incoming signed ActivityPub activity objects before processing them, allowing threat actors to spoof the contents of signed activities and impersonate the authors of the original activities. This vulnerability is fixed in 2024.5.0.",
    "cve_publish_date": "2024-06-03",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Merge pull request from GHSA-2vxv-pv3m-3wvj\n\n* fix: normalize incoming signed activities\n\n* Tweak style\n\n* Update CHANGELOG.md\n\n* Log compacted activity as well\n\n---------\n\nCo-authored-by: syuilo <4439005+syuilo@users.noreply.github.com>",
    "type_of_change": "Renaming",
    "filename_of_changes": "JsonLdService.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 10: import { CONTEXTS } from './misc/contexts.js';",
        "// Line_Reference 13: import type { JsonLd, RemoteDocument } from 'jsonld/jsonld-spec.js';",
        "// Line_Reference 15: // RsaSignature2017 based from https://github.com/transmute-industries/RsaSignature2017",
        "// Line_Reference 17: class LdSignature {",
        "// Line_Reference 92:     public async normalize(data: JsonLdDocument): Promise<string> {",
        "// Line_Reference 107:                 if (url in CONTEXTS) {",
        "// Line_Reference 111:                         document: CONTEXTS[url],",
        "// Line_Reference 128:     private async fetchDocument(url: string): Promise<JsonLd> {",
        "// Line_Reference 149:         return json as JsonLd;",
        "// Line_Reference 161: export class LdSignatureService {",
        "// Line_Reference 168:     public use(): LdSignature {",
        "// Line_Reference 169:         return new LdSignature(this.httpRequestService);"
    ]
}