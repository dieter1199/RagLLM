{
    "cve_id": "CVE-2024-29199",
    "cve_description": "Nautobot is a Network Source of Truth and Network Automation Platform. A number of Nautobot URL endpoints were found to be improperly accessible to unauthenticated (anonymous) users. These endpoints will not disclose any Nautobot data to an unauthenticated user unless the Nautobot configuration variable EXEMPT_VIEW_PERMISSIONS is changed from its default value (an empty list) to permit access to specific data by unauthenticated users. This vulnerability is fixed in 1.6.16 and 2.1.9.",
    "cve_publish_date": "2024-03-26",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "View authentication and permission fixes (#5464)",
    "type_of_change": "Modification",
    "filename_of_changes": "test_graphql.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 633:         \"\"\"Validate unauthenticated users are not able to query anything by default.\"\"\"",
        "// Line_Reference 635:         self.assertEqual(response.status_code, status.HTTP_200_OK)",
        "// Line_Reference 636:         self.assertIsInstance(response.data[\"data\"][\"racks\"], list)",
        "// Line_Reference 637:         names = [item[\"name\"] for item in response.data[\"data\"][\"racks\"]]",
        "// Line_Reference 638:         self.assertEqual(names, [])",
        "// Line_Reference 639: ",
        "// Line_Reference 640:     @override_settings(EXEMPT_VIEW_PERMISSIONS=[\"*\"])",
        "// Line_Reference 641:     def test_graphql_api_no_token_exempt(self):",
        "// Line_Reference 642:         \"\"\"Validate unauthenticated users are able to query based on the exempt permissions.\"\"\"",
        "// Line_Reference 643:         response = self.client.post(self.api_url, {\"query\": self.get_racks_query}, format=\"json\")",
        "// Line_Reference 644:         self.assertEqual(response.status_code, status.HTTP_200_OK)",
        "// Line_Reference 645:         self.assertIsInstance(response.data[\"data\"][\"racks\"], list)",
        "// Line_Reference 646:         names = [item[\"name\"] for item in response.data[\"data\"][\"racks\"]]",
        "// Line_Reference 647:         self.assertEqual(names, [\"Rack 1-1\", \"Rack 1-2\", \"Rack 2-1\", \"Rack 2-2\"])"
    ]
}