{
    "cve_id": "CVE-2024-27304",
    "cve_description": "pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject user input large enough to cause a single query or bind message to exceed 4 GB in size.",
    "cve_publish_date": "2024-03-06",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "SQL sanitizer wraps arguments in parentheses\n\npgx v5 was not vulnerable to CVE-2024-27289 do to how the sanitizer was\nbeing called. But the sanitizer itself still had the underlying issue.\nThis commit ports the fix from pgx v4 to v5 to ensure that the issue\ndoes not emerge if pgx uses the sanitizer differently in the future.",
    "type_of_change": "Modification",
    "filename_of_changes": "sanitize_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 135:             expected: `select 42`,",
        "// Line_Reference 140:             expected: `select 1.23`,",
        "// Line_Reference 145:             expected: `select true`,",
        "// Line_Reference 150:             expected: `select '\\x00010203ff'`,",
        "// Line_Reference 155:             expected: `select null`,",
        "// Line_Reference 160:             expected: `select 'foobar'`,",
        "// Line_Reference 165:             expected: `select 'foo''bar'`,",
        "// Line_Reference 170:             expected: `select 'foo\\''bar'`,",
        "// Line_Reference 175:             expected: `insert '2020-03-01 23:59:59.999999Z'`,"
    ]
}