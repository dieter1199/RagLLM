{
    "cve_id": "CVE-2024-21583",
    "cve_description": "Versions of the package github.com/gitpod-io/gitpod/components/server/go/pkg/lib before main-gha.27122; versions of the package github.com/gitpod-io/gitpod/components/ws-proxy/pkg/proxy before main-gha.27122; versions of the package github.com/gitpod-io/gitpod/install/installer/pkg/components/auth before main-gha.27122; versions of the package github.com/gitpod-io/gitpod/install/installer/pkg/components/public-api-server before main-gha.27122; versions of the package github.com/gitpod-io/gitpod/install/installer/pkg/components/server before main-gha.27122; versions of the package @gitpod/gitpod-protocol before 0.1.5-main-gha.27122 are vulnerable to Cookie Tossing due to a missing __Host- prefix on the _gitpod_io_jwt2_ session cookie. This allows an adversary who controls a subdomain to set the value of the cookie on the Gitpod control plane, which can be assigned to an attackerâ€™s own JWT so that specific actions taken by the victim (such as connecting a new Github organization) are actioned by the attackers session.",
    "cve_publish_date": "2024-07-19",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Make auth cookie stricter (#19973)\n\n* Use `__Host-` prefix for cookie\n\n* Fix tests\n\n* Remove domain from cookie\n\n* Fix logout\n\n* remove unused fn\n\n* fix user logout properly\n\n* [server] Make domain-only cookie work for GitHub oauth login\n\n... by adding additional step so we can set the cookie for the base domain only\n\n* test: fix by redirecting before callbacl/authorize\n\n* [server] SessionHandler: Allow to login with both primary and secondary cookies\n\n* [server] Clear 2ndary cookie on logout\n\n* Fix filtering cookie values when primary cookie is empty\n\n* Fix logouts\n\n* Fix tests\n\n---------\n\nCo-authored-by: Gero Posmyk-Leinemann <gero@gitpod.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "cookie.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 12:     return \"_\" + derived + \"_jwt2_\""
    ]
}