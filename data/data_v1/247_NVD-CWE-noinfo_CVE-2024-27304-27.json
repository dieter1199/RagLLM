{
    "cve_id": "CVE-2024-27304",
    "cve_description": "pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject user input large enough to cause a single query or bind message to exceed 4 GB in size.",
    "cve_publish_date": "2024-03-06",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Backport fixes from pgx v5\n\nCheck for overflow on uint16 sizes in pgproto3\n\nDo not allow protocol messages larger than ~1GB\n\nThe PostgreSQL server will reject messages greater than ~1 GB anyway.\nHowever, worse than that is that a message that is larger than 4 GB\ncould wrap the 32-bit integer message size and be interpreted by the\nserver as multiple messages. This could allow a malicious client to\ninject arbitrary protocol messages.\n\nhttps://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv",
    "type_of_change": "Modification",
    "filename_of_changes": "parameter_status.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 6: ",
        "// Line_Reference 7:     \"github.com/jackc/pgio\"",
        "// Line_Reference 40: func (src *ParameterStatus) Encode(dst []byte) []byte {",
        "// Line_Reference 41:     dst = append(dst, 'S')",
        "// Line_Reference 42:     sp := len(dst)",
        "// Line_Reference 43:     dst = pgio.AppendInt32(dst, -1)",
        "// Line_Reference 44: ",
        "// Line_Reference 49: ",
        "// Line_Reference 50:     pgio.SetInt32(dst[sp:], int32(len(dst[sp:])))",
        "// Line_Reference 51: ",
        "// Line_Reference 52:     return dst"
    ]
}