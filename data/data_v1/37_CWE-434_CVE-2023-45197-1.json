{
    "cve_id": "CVE-2023-45197",
    "cve_description": "The file upload plugin in Adminer and AdminerEvo allows an attacker to upload a file with a table name of “..” to the root of the Adminer directory. The attacker can effectively guess the name of the uploaded file and execute it. Adminer is no longer supported, but this issue was fixed in AdminerEvo version 4.8.3.",
    "cve_publish_date": "2024-06-21",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "Plugin file-upload generate temp filename no extension + prevent file to be located elsewhere then under upload path",
    "type_of_change": "Modification",
    "filename_of_changes": "file-upload.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 35:             if ($_FILES[$name][\"error\"] || !preg_match(\"~(\\\\.($this->extensions))?\\$~\", $_FILES[$name][\"name\"], $regs2)) {",
        "// Line_Reference 38:             //! unlink old",
        "// Line_Reference 39:             $filename = uniqid() . $regs2[0];",
        "// Line_Reference 40:             if (!move_uploaded_file($_FILES[$name][\"tmp_name\"], \"$this->uploadPath$table/$regs[1]-$filename\")) {"
    ]
}