{
    "cve_id": "CVE-2024-1741",
    "cve_description": "lunary-ai/lunary version 1.0.1 is vulnerable to improper authorization, allowing removed members to read, create, modify, and delete prompt templates using an old authorization token. Despite being removed from an organization, these members can still perform operations on prompt templates by sending HTTP requests with their previously captured authorization token. This issue exposes organizations to unauthorized access and manipulation of sensitive template data.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "CWE-285",
    "cwe_name": "Improper Authorization",
    "cwe_description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "feat: jwt invalidation (#197)",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 129:     console.log(\"key\", key)",
        "// Line_Reference 130: ",
        "// Line_Reference 132:     console.log({ type, projectId, orgId })",
        "// Line_Reference 159:         select * from account_project where account_id = ${ctx.state.userId} and project_id = ${ctx.state.projectId}",
        "// Line_Reference 160:       `"
    ]
}