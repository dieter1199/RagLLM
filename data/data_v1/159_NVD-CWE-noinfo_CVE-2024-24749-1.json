{
    "cve_id": "CVE-2024-24749",
    "cve_description": "GeoServer is an open source server that allows users to share and edit geospatial data. Prior to versions 2.23.5 and 2.24.3, if GeoServer is deployed in the Windows operating system using an Apache Tomcat web application server, it is possible to bypass existing input validation in the GeoWebCache ByteStreamController class and read arbitrary classpath resources with specific file name extensions. If GeoServer is also deployed as a web archive using the data directory embedded in the `geoserver.war` file (rather than an external data directory), it will likely be possible to read specific resources to gain administrator privileges. However, it is very unlikely that production environments will be using the embedded data directory since, depending on how GeoServer is deployed, it will be erased and re-installed (which would also reset to the default password) either every time the server restarts or every time a new GeoServer WAR is installed and is therefore difficult to maintain. An external data directory will always be used if GeoServer is running in standalone mode (via an installer or a binary). Versions 2.23.5 and 2.24.3 contain a patch for the issue. Some workarounds are available. One may change from a Windows environment to a Linux environment; or change from Apache Tomcat to Jetty application server. One may also disable anonymous access to the embeded GeoWebCache administration and status pages.",
    "cve_publish_date": "2024-07-01",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "[GWC-1210] Improve input validation in ByteStreamController (#1211)",
    "type_of_change": "Modification",
    "filename_of_changes": "ByteStreamController.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 20: import java.io.UnsupportedEncodingException;",
        "// Line_Reference 82:     String getFileName(HttpServletRequest request) {",
        "// Line_Reference 83:         String path = request.getPathInfo();",
        "// Line_Reference 84:         if (path.indexOf(\"/rest/web\") != 0) {",
        "// Line_Reference 85:             path = path.substring(path.indexOf(\"/rest/web\"));",
        "// Line_Reference 86:         }",
        "// Line_Reference 87:         return path.substring(\"/rest/web/\".length());",
        "// Line_Reference 91:     ResponseEntity<?> doGet(HttpServletRequest request, HttpServletResponse response) {",
        "// Line_Reference 92:         final String filename;",
        "// Line_Reference 93:         try {",
        "// Line_Reference 94:             filename = URLDecoder.decode(getFileName(request), \"UTF-8\");",
        "// Line_Reference 95:         } catch (UnsupportedEncodingException e1) {",
        "// Line_Reference 96:             throw new IllegalStateException(",
        "// Line_Reference 97:                     \"Could not decode encoding UTF-8\", e1); // Should never happen"
    ]
}