{
    "cve_id": "CVE-2018-25101",
    "cve_description": "A vulnerability, which was classified as problematic, has been found in l2c2technologies Koha up to 20180108. This issue affects some unknown processing of the file /cgi-bin/koha/opac-MARCdetail.pl. The manipulation of the argument biblionumber with the input 2\"><TEST> leads to cross site scripting. The attack may be initiated remotely. The identifier of the patch is 950fc8e101886821879066b33e389a47fb0a9782. It is recommended to upgrade the affected component. The identifier VDB-261677 was assigned to this vulnerability.",
    "cve_publish_date": "2024-04-22",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Bug 19319: Reflected XSS Vulnerability in opac-MARCdetail.pl\n\nTry going to this URL on your site: /cgi-bin/koha/opac-MARCdetail.pl?biblionumber=2\"><TEST>\n\nTest Plan:\n1) Go to /cgi-bin/koha/opac-MARCdetail.pl?biblionumber=2\"><TEST>\n2) Note <TEST> is embedded all over the html\n3) Apply this patch\n4) Refresh the page, note the injection is gone!\n5) run koha qa test tools\n\nSigned-off-by: Mark Tompsett <mtompset@hotmail.com>\n\nSigned-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl>\n\nSigned-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>\n\nSigned-off-by: Jonathan Druart <jonathan.druart@bugs.koha-community.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "opac-MARCdetail.tt",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 3: <title>[% IF ( LibraryNameTitle ) %][% LibraryNameTitle %][% ELSE %]Koha online[% END %] catalog &rsaquo;  MARC details for record no. [% biblionumber | html %]</title>",
        "// Line_Reference 23:                                 <span class=\"view\"><a id=\"Normalview\" href=\"/cgi-bin/koha/opac-detail.pl?biblionumber=[% biblionumber | html %]\">Normal view</a></span>",
        "// Line_Reference 25:                                 [% IF ( ISBD ) %]<span class=\"view\"><a id=\"ISBDview\"  href=\"/cgi-bin/koha/opac-ISBDdetail.pl?biblionumber=[% biblionumber | html %]\">ISBD view</a></span>[% END %]",
        "// Line_Reference 27:                             <h1 class=\"title\">[% bibliotitle %] (Record no. [% biblionumber | html %])</h1>",
        "// Line_Reference 30:                                 <div id=\"switchview_div\">[ <a id=\"switchview\" href=\"/cgi-bin/koha/opac-showmarc.pl?id=[% biblionumber | html %]&amp;viewas=html\">view plain</a> ]</div>",
        "// Line_Reference 197:                 $(\"#plainmarc\").show().html(\"<div style=\\\"margin:1em;padding:1em;border:1px solid #EEE;font-size:150%;\\\"><img src=\\\"[% interface %]/[% theme %]/images/loading.gif\\\" /> \"+_(\"Loading\")+\"...</div>\").load(\"/cgi-bin/koha/opac-showmarc.pl\",\"id=[% biblionumber | html %]&viewas=html\");"
    ]
}