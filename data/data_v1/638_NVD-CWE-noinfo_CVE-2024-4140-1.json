{
    "cve_id": "CVE-2024-4140",
    "cve_description": "An excessive memory use issue (CWE-770) exists in Email-MIME, before version 1.954, which can cause denial of service when parsing multipart MIME messages. The patch set (from 2020 and 2024) limits excessive depth and the total number of parts.",
    "cve_publish_date": "2024-05-02",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "do not allow an excessive number of parts\n\nThis is annoying!  It bugs me that making a mere 100,000 parts should lead\nto excessive consumption of memoryâ€¦ but really, nobody does that for\na good reason.\n\nThis makes top-level (non-recursive) Email::MIME->new set a localized\npart counter to 0 and increment before it makes new subpart objects.\nIf the counter exceeds the max, it will die early.\n\nIt would be better to work, but this is better than eating all memory and\ncrashing, right?\n\nPut together with help from Marc Bradshaw.\n\nTest forthcoming.",
    "type_of_change": "Modification",
    "filename_of_changes": "MIME.pm",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 377: our $MAX_DEPTH = 10;",
        "// Line_Reference 378: ",
        "// Line_Reference 411:   my $bits = @bits;",
        "// Line_Reference 418:     my $email = (ref $self)->new($bit, { encode_check => $self->encode_check });"
    ]
}