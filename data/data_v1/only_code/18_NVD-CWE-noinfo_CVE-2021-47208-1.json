my $route;
if (!$name || $name eq 'current') { return {} unless $route = $self->endpoint }
my $captures = $self->stack->[-1] // {};
%values = (%$captures, format => undef, %values);
my $pattern = $route->pattern;
$values{format} //= defined $captures->{format} ? $captures->{format} : $pattern->defaults->{format}
if $pattern->constraints->{format};
my $path = $route->render(\%values);
