p := "/" + strings.TrimLeft(c.Query("file"), "/")
// NOTE: os.IsNotExist() does not work if the error is wrapped.
if err := s.Filesystem().Writefile(f, c.Request.Body); err != nil {
p, err := s.Filesystem().SafePath(filepath.Join(directory, header.Filename))
if err != nil {
middleware.CaptureAndAbort(c, err)
return
}
if err := handleFileUpload(p, s, header); err != nil {
if err := s.Filesystem().Writefile(p, file); err != nil {
