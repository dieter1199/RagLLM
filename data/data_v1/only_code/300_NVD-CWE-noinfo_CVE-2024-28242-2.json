def category_backgrounds(color_scheme_id)
is_dark_color_scheme =
color_scheme_id.present? && ColorScheme.find_by_id(color_scheme_id)&.is_dark?
contents = +""
Category
.where("uploaded_background_id IS NOT NULL")
.each do |c|
contents << category_css(c, is_dark_color_scheme) if c.uploaded_background&.url.present?
end
contents
end
def category_css(category, is_dark_color_scheme)
full_slug = category.full_slug.split("-")[0..-2].join("-")
# in case we're using a dark color scheme, we define the background using the dark image
# if one is available. Otherwise, we use the light image by default.
if is_dark_color_scheme && category.uploaded_background_dark&.url.present?
return category_background_css(full_slug, category.uploaded_background_dark.url)
end
category_background_css(full_slug, category.uploaded_background.url)
end
def category_background_css(full_slug, background_url)
"body.category-#{full_slug} { background-image: url(#{upload_cdn_path(background_url)}) }"
end
