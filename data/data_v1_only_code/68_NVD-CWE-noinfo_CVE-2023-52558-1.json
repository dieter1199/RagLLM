{
    "cve_id": "CVE-2023-52558",
    "cve_description": "In OpenBSD 7.4 before errata 002 and OpenBSD 7.3 before errata 019, aÂ network buffer that had to be split at certain length that could crash the kernel after receiving specially crafted escape sequences.",
    "cve_publish_date": "2024-03-01",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Avoid assertion failure when splitting mbuf cluster.\n\nm_split() calls m_align() to initialize the data pointer of newly\nallocated mbuf.  If the new mbuf will be converted to a cluster,\nthis is not necessary.  If additionally the new mbuf is larger than\nMLEN, this can lead to a panic.\nOnly call m_align() when a valid m_data is needed.  This is the\ncase if we do not refecence the existing cluster, but memcpy() the\ndata into the new mbuf.\n\nReported-by: syzbot+0e6817f5877926f0e96a@syzkaller.appspotmail.com\nOK claudio@ deraadt@",
    "type_of_change": "Modification",
    "filename_of_changes": "uipc_mbuf.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1: /*    $OpenBSD: uipc_mbuf.c,v 1.287 2023/06/23 04:36:49 gnezdo Exp $    */",
        "// Line_Reference 1083:         if (m->m_flags & M_EXT)",
        "// Line_Reference 1084:             goto extpacket;",
        "// Line_Reference 1085:         if (remain > MHLEN) {",
        "// Line_Reference 1097:         } else",
        "// Line_Reference 1098:             m_align(n, remain);",
        "// Line_Reference 1107:         m_align(n, remain);",
        "// Line_Reference 1109: extpacket:"
    ]
}