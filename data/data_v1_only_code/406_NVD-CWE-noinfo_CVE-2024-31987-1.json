{
    "cve_id": "CVE-2024-31987",
    "cve_description": "XWiki Platform is a generic wiki platform. Starting in version 6.4-milestone-1 and prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, any user who can edit any page like their profile can create a custom skin with a template override that is executed with programming right, thus allowing remote code execution. This has been patched in XWiki 14.10.19, 15.5.4 and 15.10RC1. No known workarounds are available except for upgrading.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "XWIKI-21478: Improve rights check of template macros",
    "type_of_change": "Modification",
    "filename_of_changes": "XWikiVelocityManager.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 76:         Arrays.<Event>asList(new TemplateUpdatedEvent(), new TemplateDeletedEvent());",
        "// Line_Reference 102:     private Map<String, VelocityEngine> velocityEngines = new ConcurrentHashMap<>();",
        "// Line_Reference 117:                     velocityEngines.remove(templateEvent.getId());",
        "// Line_Reference 180:      *         Velocity Engine for the current skin since each skin has its own Velocity Engine so that each skin can",
        "// Line_Reference 181:      *         have global velocimacros defined",
        "// Line_Reference 251:         // Inject skin macros",
        "// Line_Reference 252:         if (skinMacrosTemplate != null) {",
        "// Line_Reference 253:             VelocityTemplate skinMacros = compile(\"\", new StringReader(skinMacrosTemplate.getContent().getContent()));",
        "// Line_Reference 254: "
    ]
}