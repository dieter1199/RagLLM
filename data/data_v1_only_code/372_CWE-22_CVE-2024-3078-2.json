{
    "cve_id": "CVE-2024-3078",
    "cve_description": "A vulnerability was found in Qdrant up to 1.6.1/1.7.4/1.8.2 and classified as critical. This issue affects some unknown processing of the file lib/collection/src/collection/snapshots.rs of the component Full Snapshot REST API. The manipulation leads to path traversal. Upgrading to version 1.8.3 is able to address this issue. The patch is named 3ab5172e9c8f14fa1f7b24e7147eac74e2412b62. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-258611.",
    "cve_publish_date": "2024-03-29",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix arbitrary path traversal vulnerability in full snapshot REST API (#3856)\n\n* Improve function to get collection snapshot path\r\n\r\n* Fix arbitrary path traversal in full snapshot path function\r\n\r\n* Add integration test to assert arbitrary path traversal is blocked",
    "type_of_change": "Modification",
    "filename_of_changes": "snapshots.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 236:         let snapshot_path = self.snapshots_path.join(snapshot_name);",
        "// Line_Reference 237: ",
        "// Line_Reference 238:         let absolute_snapshot_path =",
        "// Line_Reference 239:             snapshot_path",
        "// Line_Reference 240:                 .canonicalize()",
        "// Line_Reference 241:                 .map_err(|_| CollectionError::NotFound {",
        "// Line_Reference 242:                     what: format!(\"Snapshot {snapshot_name}\"),",
        "// Line_Reference 243:                 })?;",
        "// Line_Reference 244: ",
        "// Line_Reference 245:         let absolute_snapshot_dir =",
        "// Line_Reference 246:             self.snapshots_path",
        "// Line_Reference 247:                 .canonicalize()",
        "// Line_Reference 248:                 .map_err(|_| CollectionError::NotFound {",
        "// Line_Reference 249:                     what: format!(\"Snapshot directory: {}\", self.snapshots_path.display()),",
        "// Line_Reference 250:                 })?;",
        "// Line_Reference 253:             return Err(CollectionError::NotFound {",
        "// Line_Reference 254:                 what: format!(\"Snapshot {snapshot_name}\"),",
        "// Line_Reference 255:             });",
        "// Line_Reference 258:         if !snapshot_path.exists() {",
        "// Line_Reference 259:             return Err(CollectionError::NotFound {",
        "// Line_Reference 260:                 what: format!(\"Snapshot {snapshot_name}\"),",
        "// Line_Reference 261:             });",
        "// Line_Reference 263:         Ok(snapshot_path)"
    ]
}