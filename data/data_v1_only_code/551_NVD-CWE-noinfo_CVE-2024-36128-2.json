{
    "cve_id": "CVE-2024-36128",
    "cve_description": "Directus is a real-time API and App dashboard for managing SQL database content. Prior to 10.11.2, providing a non-numeric length value to the random string generation utility will create a memory issue breaking the capability to generate random strings platform wide. This creates a denial of service situation where logged in sessions can no longer be refreshed as sessions depend on the capability to generate a random session ID. This vulnerability is fixed in 10.11.2.",
    "cve_publish_date": "2024-06-03",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Fix #22572 Invalid query for random string (#22573)\n\n* Fix #22572 Invalid query for random string\r\n\r\n* Add changeset\r\n\r\n* Run prettier\r\n\r\n* Fix unit tests warnings\r\n\r\n* redo validation with Joi\r\n\r\n* make validation on object level\r\n\r\ndocuments itself and is cleaner to expand on\r\n\r\n* Update changeset\r\n\r\n* Allow integer only\r\n\r\n* Require min value of 1\r\n\r\n* Report as query error, ignore unknown queries\r\n\r\n---------\r\n\r\nCo-authored-by: Daniel Biegler <DanielBiegler@users.noreply.github.com>\r\nCo-authored-by: Pascal Jufer <pascal-jufer@bluewin.ch>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 22:         if (req.query && req.query['length'] && Number(req.query['length']) > 500) {",
        "// Line_Reference 23:             throw new InvalidQueryError({ reason: `\"length\" can't be more than 500 characters` });",
        "// Line_Reference 24:         }",
        "// Line_Reference 26:         const string = nanoid(req.query?.['length'] ? Number(req.query['length']) : 32);",
        "// Line_Reference 28:         return res.json({ data: string });"
    ]
}