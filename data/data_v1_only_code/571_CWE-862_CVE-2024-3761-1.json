{
    "cve_id": "CVE-2024-3761",
    "cve_description": "In lunary-ai/lunary version 1.2.2, the DELETE endpoint located at `packages/backend/src/api/v1/datasets` is vulnerable to unauthorized dataset deletion due to missing authorization and authentication mechanisms. This vulnerability allows any user, even those without a valid token, to delete a dataset by sending a DELETE request to the endpoint. The issue was fixed in version 1.2.8. The impact of this vulnerability is significant as it permits unauthorized users to delete datasets, potentially leading to data loss or disruption of service.",
    "cve_publish_date": "2024-05-20",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: authorization delete dataset (#204)",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 123: datasets.delete(\"/:id\", async (ctx: Context) => {",
        "// Line_Reference 124:   const { id } = ctx.params",
        "// Line_Reference 126:   await sql`delete from dataset where id = ${id}`",
        "// Line_Reference 128:   ctx.status = 200",
        "// Line_Reference 129: })"
    ]
}