{
    "cve_id": "CVE-2024-39934",
    "cve_description": "Robotmk before 2.0.1 allows a local user to escalate privileges (e.g., to SYSTEM) if automated Python environment setup is enabled, because the \"shared holotree usage\" feature allows any user to edit any Python environment.",
    "cve_publish_date": "2024-07-04",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "don't enable shared holotrees\n\nCMK-17546",
    "type_of_change": "Deletion",
    "filename_of_changes": "rcc.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 158:     debug!(\"Initializing shared holotree\");",
        "// Line_Reference 159:     (sucessful_plans, rcc_setup_failures.shared_holotree) =",
        "// Line_Reference 160:         shared_holotree_init(global_config, sucessful_plans)",
        "// Line_Reference 161:             .context(\"Received termination signal while initializing shared holotree\")?;",
        "// Line_Reference 162:     if !rcc_setup_failures.shared_holotree.is_empty() {",
        "// Line_Reference 163:         error!(",
        "// Line_Reference 164:             \"Dropping the following plans due to shared holotree initialization failure: {}\",",
        "// Line_Reference 165:             failed_plan_ids_human_readable(rcc_setup_failures.shared_holotree.keys())",
        "// Line_Reference 166:         );",
        "// Line_Reference 167:     }",
        "// Line_Reference 168: ",
        "// Line_Reference 274: fn shared_holotree_init(",
        "// Line_Reference 275:     global_config: &GlobalConfig,",
        "// Line_Reference 276:     plans: Vec<Plan>,",
        "// Line_Reference 277: ) -> Result<(Vec<Plan>, HashMap<String, String>), Cancelled> {",
        "// Line_Reference 278:     let mut command_spec =",
        "// Line_Reference 279:         RCCEnvironment::bundled_command_spec(&global_config.rcc_config.binary_path);",
        "// Line_Reference 280:     command_spec.add_arguments([\"holotree\", \"shared\", \"--enable\", \"--once\"]);",
        "// Line_Reference 281:     run_command_spec_once_in_current_session(",
        "// Line_Reference 282:         global_config,",
        "// Line_Reference 283:         plans,",
        "// Line_Reference 284:         &command_spec,",
        "// Line_Reference 285:         \"shared_holotree_init\",",
        "// Line_Reference 286:     )",
        "// Line_Reference 287: }",
        "// Line_Reference 288: "
    ]
}