{
    "cve_id": "CVE-2024-4287",
    "cve_description": "In mintplex-labs/anything-llm, a vulnerability exists due to improper input validation in the workspace update process. Specifically, the application fails to validate or format JSON data sent in an HTTP POST request to `/api/workspace/:workspace-slug/update`, allowing it to be executed as part of a database query without restrictions. This flaw enables users with a manager role to craft a request that includes nested write operations, effectively allowing them to create new Administrator accounts.",
    "cve_publish_date": "2024-05-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Enable per-workspace provider/model combination (#1042)\n\n* Enable per-workspace provider/model combination\r\n\r\n* cleanup\r\n\r\n* remove resetWorkspaceChatModels and wipeWorkspaceModelPreference to prevent workspace from resetting model\r\n\r\n* add space\r\n\r\n---------\r\n\r\nCo-authored-by: shatfield4 <seanhatfield5@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "updateENV.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 5:     postUpdate: [wipeWorkspaceModelPreference],",
        "// Line_Reference 496: // If the LLMProvider has changed we need to reset all workspace model preferences to",
        "// Line_Reference 497: // null since the provider<>model name combination will be invalid for whatever the new",
        "// Line_Reference 498: // provider is.",
        "// Line_Reference 499: async function wipeWorkspaceModelPreference(key, prev, next) {",
        "// Line_Reference 500:   if (prev === next) return;",
        "// Line_Reference 501:   const { Workspace } = require(\"../../models/workspace\");",
        "// Line_Reference 502:   await Workspace.resetWorkspaceChatModels();",
        "// Line_Reference 503: }",
        "// Line_Reference 504: "
    ]
}