{
    "cve_id": "CVE-2024-25130",
    "cve_description": "Tuleap is an open source suite to improve management of software developments and collaboration. Prior to version 15.5.99.76 of Tuleap Community Edition and prior to versions 15.5-4 and 15.4-7 of Tuleap Enterprise Edition, users with a read access to a tracker where the mass update feature is used might get access to restricted information. Tuleap Community Edition 15.5.99.76, Tuleap Enterprise Edition 15.5-4, and Tuleap Enterprise Edition 15.4-7 contain a patch for this issue.",
    "cve_publish_date": "2024-02-22",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "fix: request #36803 Mass update clears permissions on artifact\n\nAn additional checkbox is added to control if the field should be\nupdated or not when doing a masschange.\n\nChange-Id: I721298a0f5ec50c3aac1a59efcfba6166958baf0",
    "type_of_change": "Modification",
    "filename_of_changes": "Tracker_FormElement_Field_PermissionsOnArtifact.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 39:     public const GRANTED_GROUPS     = 'granted_groups';",
        "// Line_Reference 40:     public const USE_IT             = 'use_artifact_permissions';",
        "// Line_Reference 41:     public const IS_USED_BY_DEFAULT = false;",
        "// Line_Reference 42:     public const PERMISSION_TYPE    = 'PLUGIN_TRACKER_ARTIFACT_ACCESS';",
        "// Line_Reference 157:     /**",
        "// Line_Reference 158:      * @return string",
        "// Line_Reference 159:      */",
        "// Line_Reference 160:     protected function fetchSubmitValueMasschange()",
        "// Line_Reference 165:         return $this->getArtifactValueHTML($this->getId(), $is_checked, $is_disabled);",
        "// Line_Reference 265:     private function fetchUserGroupList($is_read_only, array $changeset_values)",
        "// Line_Reference 273:             . 'id=\"' . $hp->purify(str_replace('[]', '', $element_name)) . '\" '",
        "// Line_Reference 855:      *",
        "// Line_Reference 856:      * @return string",
        "// Line_Reference 858:     private function fetchRestrictCheckbox($can_user_restrict_permissions_to_nobody, $disabled, $is_expecting_input)",
        "// Line_Reference 865:         $html = '<p class=\"tracker_field_permissionsonartifact ' . $empty_value_class . '\">';",
        "// Line_Reference 868:                 $html .= '<input type=\"hidden\" name=\"artifact[' . $this->getId() . '][use_artifact_permissions]\" value=\"0\" />';",
        "// Line_Reference 870:             $html .= '<label class=\"checkbox\" for=\"artifact_' . $this->getId() . '_use_artifact_permissions\">';",
        "// Line_Reference 871:             $html .= '<input type=\"checkbox\"",
        "// Line_Reference 872:                         name=\"artifact[' . $this->getId() . '][use_artifact_permissions]\"",
        "// Line_Reference 873:                         id=\"artifact_' . $this->getId() . '_use_artifact_permissions\"",
        "// Line_Reference 879:             $html .= '<input type=\"hidden\" name=\"artifact[' . $this->getId(",
        "// Line_Reference 880:             ) . '][use_artifact_permissions]\" value=\"1\" />';"
    ]
}