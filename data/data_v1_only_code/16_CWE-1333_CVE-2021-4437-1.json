{
    "cve_id": "CVE-2021-4437",
    "cve_description": "A vulnerability, which was classified as problematic, has been found in dbartholomae lambda-middleware frameguard up to 1.0.4. Affected by this issue is some unknown functionality of the file packages/json-deserializer/src/JsonDeserializer.ts of the component JSON Mime-Type Handler. The manipulation leads to inefficient regular expression complexity. Upgrading to version 1.1.0 is able to address this issue. The patch is identified as f689404d830cbc1edd6a1018d3334ff5f44dc6a6. It is recommended to upgrade the affected component. VDB-253406 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2024-02-12",
    "cwe_id": "CWE-1333",
    "cwe_name": "Inefficient Regular Expression Complexity",
    "cwe_description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",
    "commit_message": "fix(json-deserializer): fixed codeQL vulnerability\n\nRemoved the regex used to identify a JSON mime-type as this was potentially vulnerable to\n'Regular expression Denial of Service attacks' and making changes to make the regex more restrictive (but compliant with RFC 6838) did not pass tests for this issue online.\n\nThis now matches based on the last segment of a mimetype being json or json; this should match all the expected mime types.\n\nUpdated unit-tests with additional tests for a variety of compatible mime types.",
    "type_of_change": "Modification",
    "filename_of_changes": "JsonDeserializer.test.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 32:   it(\"deserializes objects if the event has a json content-type header\", async () => {",
        "// Line_Reference 33:     const event: APIGatewayProxyEvent = createEvent({",
        "// Line_Reference 34:       headers: { \"Content-Type\": \"application/json\" },",
        "// Line_Reference 35:       body: JSON.stringify(testObject),",
        "// Line_Reference 36:     });",
        "// Line_Reference 38:     await handlerWithMiddleware(event, createContext());",
        "// Line_Reference 39:     expect(processedEvent.bodyObject).toMatchObject(",
        "// Line_Reference 40:       JSON.parse(JSON.stringify(testObject))",
        "// Line_Reference 41:     );"
    ]
}