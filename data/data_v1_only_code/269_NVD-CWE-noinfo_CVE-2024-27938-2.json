{
    "cve_id": "CVE-2024-27938",
    "cve_description": "Postal is an open source SMTP server. Postal versions less than 3.0.0 are vulnerable to SMTP Smuggling attacks which may allow incoming e-mails to be spoofed. This, in conjunction with a cooperative outgoing SMTP service, would allow for an incoming e-mail to be received by Postal addressed from a server that a user has 'authorised' to send mail on their behalf but were not the genuine author of the e-mail. Postal is not affected for sending outgoing e-mails as email is re-encoded with `<CR><LF>` line endings when transmitted over SMTP. This issue has been addressed and users should upgrade to Postal v3.0.0 or higher. Once upgraded, Postal will only accept End of DATA sequences which are explicitly `<CR><LF>.<CR><LF>`. If a non-compliant sequence is detected it will be logged to the SMTP server log. There are no workarounds for this issue.",
    "cve_publish_date": "2024-03-11",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "feat: only accept RFC-compliant End-of-DATA sequence\n\nPreviously Postal was fairly forgiving about line endings. This requires that the end of data sequence is `<CR><LF>.<CR><LF>`.",
    "type_of_change": "Modification",
    "filename_of_changes": "server.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 197:                 # Normalize all \\r\\n and \\n to \\r\\n, but ignore only \\r.",
        "// Line_Reference 198:                 # A \\r\\n may be split in 2 buffers (\\n in one buffer and \\r in the other)",
        "// Line_Reference 199:                 buffers[io] = buffers[io].gsub(/\\r/, \"\").encode(buffers[io].encoding, crlf_newline: true)",
        "// Line_Reference 200: ",
        "// Line_Reference 203:                 while buffers[io].index(\"\\r\\n\")",
        "// Line_Reference 205:                   line, buffers[io] = buffers[io].split(\"\\r\\n\", 2)",
        "// Line_Reference 206: "
    ]
}