{
    "cve_id": "CVE-2024-3025",
    "cve_description": "mintplex-labs/anything-llm is vulnerable to path traversal attacks due to insufficient validation of user-supplied input in the logo filename functionality. Attackers can exploit this vulnerability by manipulating the logo filename to reference files outside of the restricted directory. This can lead to unauthorized reading or deletion of files by utilizing the `/api/system/upload-logo` and `/api/system/logo` endpoints. The issue stems from the lack of filtering or validation on the logo filename, allowing attackers to target sensitive files such as the application's database.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "CWE-23",
    "cwe_name": "Relative Path Traversal",
    "cwe_description": "The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as \"..\" that can resolve to a location that is outside of that directory.",
    "commit_message": "norm path logo",
    "type_of_change": "Modification",
    "filename_of_changes": "logo.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 24:     customLogoPath = path.join(basePath, currentLogoFilename);",
        "// Line_Reference 55:     ? path.join(process.env.STORAGE_DIR, \"assets\", originalFilename)",
        "// Line_Reference 56:     : path.join(__dirname, `../../storage/assets/${originalFilename}`);",
        "// Line_Reference 58:     ? path.join(process.env.STORAGE_DIR, \"assets\", newFilename)",
        "// Line_Reference 59:     : path.join(__dirname, `../../storage/assets/${newFilename}`);",
        "// Line_Reference 68:     ? path.join(process.env.STORAGE_DIR, `assets/${logoFilename}`)",
        "// Line_Reference 69:     : path.join(__dirname, `../../storage/assets/${logoFilename}`);"
    ]
}