{
    "cve_id": "CVE-2024-21512",
    "cve_description": "Versions of the package mysql2 before 3.9.8 are vulnerable to Prototype Pollution due to improper user input sanitization passed to fields and tables when using nestTables.",
    "cve_publish_date": "2024-05-29",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "fix(security): sanitize fields and tables when using nestTables (#2702)\n\n* fix(security): sanitize fields and tables when using nestTables\r\n\r\n* chore: undone `nestTables` validation for `rowsAsArray`",
    "type_of_change": "Modification",
    "filename_of_changes": "binary_parser.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 148:     fieldName = helpers.srcEscape(fields[i].name);",
        "// Line_Reference 149: ",
        "// Line_Reference 150:     if (helpers.privateObjectProps.has(fields[i].name)) {",
        "// Line_Reference 151:       throw new Error(",
        "// Line_Reference 152:         `The field name (${fieldName}) can't be the same as an object's private property.`,",
        "// Line_Reference 153:       );",
        "// Line_Reference 154:     }",
        "// Line_Reference 155: ",
        "// Line_Reference 156:     parserFn(`// ${fieldName}: ${typeNames[fields[i].columnType]}`);",
        "// Line_Reference 159:       lvalue = `result[${helpers.srcEscape(",
        "// Line_Reference 160:         fields[i].table + options.nestTables + fields[i].name,",
        "// Line_Reference 161:       )}]`;",
        "// Line_Reference 163:       tableName = helpers.srcEscape(fields[i].table);",
        "// Line_Reference 193: "
    ]
}