{
    "cve_id": "CVE-2024-27100",
    "cve_description": "Discourse is an open source platform for community discussion. In affected versions the endpoints for suspending users, silencing users and exporting CSV files weren't enforcing limits on the sizes of the parameters that they accept. This could lead to excessive resource consumption which could render an instance inoperable. A site could be disrupted by either a malicious moderator on the same site or a malicious staff member on another site in the same multisite cluster. This issue is patched in the latest stable, beta and tests-passed versions of Discourse. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-03-15",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "SECURITY: Prevent large staff actions causing DoS\n\nThis commit operates at three levels of abstraction:\n\n 1. We want to prevent user history rows from being unbounded in size.\n    This commit adds rails validations to limit the sizes of columns on\n    user_histories,\n\n 2. However, we don't want to prevent certain actions from being\n    completed if these columns are too long. In those cases, we truncate\n    the values that are given and store the truncated versions,\n\n 3. For endpoints that perform staff actions, we can further control\n    what is permitted by explicitly validating the params that are given\n    before attempting the action,",
    "type_of_change": "Modification",
    "filename_of_changes": "export_csv_controller.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 9:     if export_params[:entity] == \"user_archive\"",
        "// Line_Reference 14:         entity: export_params[:entity],",
        "// Line_Reference 19:     StaffActionLogger.new(current_user).log_entity_export(export_params[:entity])"
    ]
}