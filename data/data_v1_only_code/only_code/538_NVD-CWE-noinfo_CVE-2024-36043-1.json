{
    "cve_id": "CVE-2024-36043",
    "cve_description": "question_image.ts in SurveyJS Form Library before 1.10.4 allows contentMode=youtube XSS via the imageLink property.",
    "cve_publish_date": "2024-05-18",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Image with contentMode: \"youtube\" allows external script execution\nfixed https://github.com/surveyjs/service/issues/2174",
    "type_of_change": "Modification",
    "filename_of_changes": "question_image.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 8: const youtubeTags = [\"youtube.com\", \"youtu.be\"];",
        "// Line_Reference 16:   for (let i = 0; i < youtubeTags.length; i++) {",
        "// Line_Reference 17:     if (url.indexOf(youtubeTags[i]) !== -1) return true;",
        "// Line_Reference 34:       return getCorrectImageLink(text);",
        "// Line_Reference 206: function getCorrectImageLink(val: string): string {",
        "// Line_Reference 207:   if(!val || !isUrlYoutubeVideo(val)) return val;"
    ]
}