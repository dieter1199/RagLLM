{
    "cve_id": "CVE-2024-38375",
    "cve_description": "@fastly/js-compute is a JavaScript SDK and runtime for building Fastly Compute applications. The implementation of several functions were determined to include a use-after-free bug. This bug could allow for unintended data loss if the result of the preceding functions were sent anywhere else, and often results in a guest trap causing services to return a 500. This bug has been fixed in version 3.16.0 of the `@fastly/js-compute` package.",
    "cve_publish_date": "2024-06-26",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "fix: Fix uses of cabi_realloc that were discarding their results (#811)\n\nFix issues in some host calls where a buffer length error was being handled by reallocating to the new buffer size, but was discarding the new buffer's pointer. This should also fix flaky tests in CI.",
    "type_of_change": "Modification",
    "filename_of_changes": "fastly_world_adapter.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 213:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 227:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 241:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 253:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 264:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 1246:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 1390:     cabi_realloc(ret->ptr, default_size, 4, ret->len);",
        "// Line_Reference 1396: }"
    ]
}