{
    "cve_id": "CVE-2024-29889",
    "cve_description": "GLPI is a Free Asset and IT Management Software package. Prior to 10.0.15, an authenticated user can exploit a SQL injection vulnerability in the saved searches feature to alter another user account data take control of it. This vulnerability is fixed in 10.0.15.",
    "cve_publish_date": "2024-05-07",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Merge pull request from GHSA-8xvf-v6vv-r75g",
    "type_of_change": "Modification",
    "filename_of_changes": "pin_savedsearches.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 43: if (!is_string($_POST['itemtype']) || getItemForItemtype($_POST['itemtype']) === false) {",
        "// Line_Reference 44:     echo json_encode(['success' => false]);",
        "// Line_Reference 45:     exit();",
        "// Line_Reference 46: }",
        "// Line_Reference 47: ",
        "// Line_Reference 48: $all_pinned = importArrayFromDB($_SESSION['glpisavedsearches_pinned']);",
        "// Line_Reference 49: $already_pinned = $all_pinned[$_POST['itemtype']] ?? 0;",
        "// Line_Reference 50: $all_pinned[$_POST['itemtype']] = $already_pinned ? 0 : 1;",
        "// Line_Reference 51: $_SESSION['glpisavedsearches_pinned'] = exportArrayToDB($all_pinned);",
        "// Line_Reference 54: $success = $user->update(",
        "// Line_Reference 55:     [",
        "// Line_Reference 56:         'id'                   => Session::getLoginUserID(),",
        "// Line_Reference 57:         'savedsearches_pinned' => $_SESSION['glpisavedsearches_pinned'],",
        "// Line_Reference 58:     ]",
        "// Line_Reference 59: );"
    ]
}