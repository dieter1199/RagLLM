{
    "cve_id": "CVE-2024-2313",
    "cve_description": "If kernel headers need to be extracted, bpftrace will attempt to load them from a temporary directory. An unprivileged attacker could use this to force bcc to load compromised linux headers. Linux distributions which provide kernel headers by default are not affected by default.",
    "cve_publish_date": "2024-03-10",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Fix security hole checking unpacked kernel headers (#3033)\n\nMake sure to check that the unpacked kheaders tar\r\nis owned by root to prevent bpftrace from loading\r\ncompromised linux headers.\r\n\r\nCo-authored-by: Jordan Rome <jordalgo@fedoraproject.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 724:   std_filesystem::path path_kheaders{ \"/sys/kernel/kheaders.tar.xz\" };",
        "// Line_Reference 731:   if (std_filesystem::exists(shared_path, ec)) {",
        "// Line_Reference 752:   FILE *tar = ::popen(",
        "// Line_Reference 753:       (\"tar xf /sys/kernel/kheaders.tar.xz -C \" + tmpdir.path).c_str(), \"w\");"
    ]
}