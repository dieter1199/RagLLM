{
    "cve_id": "CVE-2024-1728",
    "cve_description": "gradio-app/gradio is vulnerable to a local file inclusion vulnerability due to improper validation of user-supplied input in the UploadButton component. Attackers can exploit this vulnerability to read arbitrary files on the filesystem, such as private SSH keys, by manipulating the file path in the request to the `/queue/join` endpoint. This issue could potentially lead to remote code execution. The vulnerability is present in the handling of file upload paths, allowing attackers to redirect file uploads to unintended locations on the server.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Prevent components from working with non-uploaded files (#7465)\n\n* changes\r\n\r\n* chanegs\r\n\r\n* add changeset\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* add changeset\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n---------\r\n\r\nCo-authored-by: Ali Abid <aliabid94@gmail.com>\r\nCo-authored-by: gradio-pr-bot <gradio-pr-bot@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "blocks.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 12: import tempfile",
        "// Line_Reference 122:         self.GRADIO_CACHE = str(",
        "// Line_Reference 123:             Path(",
        "// Line_Reference 124:                 os.environ.get(\"GRADIO_TEMP_DIR\")",
        "// Line_Reference 125:                 or str(Path(tempfile.gettempdir()) / \"gradio\")",
        "// Line_Reference 126:             ).resolve()",
        "// Line_Reference 127:         )",
        "// Line_Reference 1302:         self, fn_index: int, inputs: list[Any], state: SessionState | None",
        "// Line_Reference 1329:                         inputs[i], block, add_urls=True",
        "// Line_Reference 1525:     def run_fn_batch(self, fn, batch, fn_index, state):",
        "// Line_Reference 1526:         return [fn(fn_index, list(i), state) for i in zip(*batch)]",
        "// Line_Reference 1606:                     self.preprocess_data, fn_index, inputs, state, limiter=self.limiter"
    ]
}