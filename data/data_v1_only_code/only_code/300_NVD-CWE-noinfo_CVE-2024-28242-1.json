{
    "cve_id": "CVE-2024-28242",
    "cve_description": "Discourse is an open source platform for community discussion. In affected versions an attacker can learn that secret categories exist when they have backgrounds set. The issue is patched in the latest stable, beta and tests-passed version of Discourse. Users are advised to upgrade. Users unable to upgrade should temporarily remove category backgrounds.",
    "cve_publish_date": "2024-03-15",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "SECURITY: Generate more category CSS on client\n\nThis commit moves the generation of category background CSS from the\nserver side to the client side. This simplifies the server side code\nbecause it does not need to check which categories are visible to the\ncurrent user.",
    "type_of_change": "Modification",
    "filename_of_changes": "builder.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 243:     categories_updated =",
        "// Line_Reference 244:       Stylesheet::Manager",
        "// Line_Reference 245:         .cache",
        "// Line_Reference 246:         .defer_get_set(\"categories_updated\") do",
        "// Line_Reference 247:           Category.where(\"uploaded_background_id IS NOT NULL\").pluck(:updated_at).map(&:to_i).sum",
        "// Line_Reference 248:         end",
        "// Line_Reference 249: ",
        "// Line_Reference 253:     if cs || categories_updated > 0",
        "// Line_Reference 256:         \"#{RailsMultisite::ConnectionManagement.current_db}-#{cs&.id}-#{cs&.version}-#{theme_color_defs}-#{Stylesheet::Manager.fs_asset_cachebuster}-#{categories_updated}-#{fonts}\""
    ]
}