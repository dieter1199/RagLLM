{
    "cve_id": "CVE-2024-24808",
    "cve_description": "pyLoad is an open-source Download Manager written in pure Python. There is an open redirect vulnerability due to incorrect validation of input values when redirecting users after login. pyLoad is validating URLs via the `get_redirect_url` function when redirecting users at login. This vulnerability has been patched with commit fe94451.",
    "cve_publish_date": "2024-02-06",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "fix GHSA-g3cm-qg2v-2hj5 security advisory",
    "type_of_change": "Modification",
    "filename_of_changes": "helpers.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 5: from urllib.parse import unquote, urljoin, urlparse",
        "// Line_Reference 36:     ref_url = urlparse(flask.request.host_url)",
        "// Line_Reference 37:     test_url = urlparse(urljoin(flask.request.host_url, location))",
        "// Line_Reference 38:     return test_url.scheme in ('http', 'https') and ref_url.netloc == test_url.netloc",
        "// Line_Reference 42:     login_url = urljoin(flask.request.url_root, flask.url_for('app.login'))",
        "// Line_Reference 43:     request_url = unquote(flask.request.url)",
        "// Line_Reference 44:     for location in flask.request.values.get(\"next\"), flask.request.referrer:",
        "// Line_Reference 45:         if not location:",
        "// Line_Reference 46:             continue",
        "// Line_Reference 47:         if location in (request_url, login_url):  # don't redirect to same location",
        "// Line_Reference 48:             continue",
        "// Line_Reference 49:         if is_safe_url(location):",
        "// Line_Reference 50:             return location",
        "// Line_Reference 51:     return fallback",
        "// Line_Reference 209:                         next=flask.request.url"
    ]
}