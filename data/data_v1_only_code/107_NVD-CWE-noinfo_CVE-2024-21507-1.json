{
    "cve_id": "CVE-2024-21507",
    "cve_description": "Versions of the package mysql2 before 3.9.3 are vulnerable to Improper Input Validation through the keyFromFields function, resulting in cache poisoning. An attacker can inject a colon (:) character within a value of the attacker-crafted key.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "fix(cache): improve cache key serialization (#2424)\n\n* fix(cache): improve cache key formation. Fixes a potential parser cache poisoning attack vulnerability reported by Vsevolod Kokorin (Slonser) of Solidlab",
    "type_of_change": "Modification",
    "filename_of_changes": "parser_cache.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 6:   max: 15000",
        "// Line_Reference 10:   let res =",
        "// Line_Reference 11:     `${type}` +",
        "// Line_Reference 12:     `/${typeof options.nestTables}` +",
        "// Line_Reference 13:     `/${options.nestTables}` +",
        "// Line_Reference 14:     `/${options.rowsAsArray}` +",
        "// Line_Reference 15:     `/${options.supportBigNumbers || config.supportBigNumbers}` +",
        "// Line_Reference 16:     `/${options.bigNumberStrings || config.bigNumberStrings}` +",
        "// Line_Reference 17:     `/${typeof options.typeCast}` +",
        "// Line_Reference 18:     `/${options.timezone || config.timezone}` +",
        "// Line_Reference 19:     `/${options.decimalNumbers}` +",
        "// Line_Reference 20:     `/${options.dateStrings}`;",
        "// Line_Reference 23:     res += `/${field.name}:${field.columnType}:${field.length}:${field.schema}:${field.table}:${field.flags}:${field.characterSet}`;",
        "// Line_Reference 25:   return res;",
        "// Line_Reference 52:   clearCache: clearCache"
    ]
}