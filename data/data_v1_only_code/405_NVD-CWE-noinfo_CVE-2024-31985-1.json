{
    "cve_id": "CVE-2024-31985",
    "cve_description": "XWiki Platform is a generic wiki platform. Starting in version 3.1 and prior to versions 4.10.20, 15.5.4, and 15.10-rc-1, it is possible to schedule/trigger/unschedule existing jobs by having an admin visit the Job Scheduler page through a predictable URL, for example by embedding such an URL in any content as an image. The vulnerability has been fixed in XWiki 14.10.19, 15.5.5, and 15.9. As a workaround, manually apply the patch by modifying the `Scheduler.WebHome` page.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "XWIKI-20851: Validate CSRF token before running job scheduling actions\n\n* Add a mandatory CSRF token for job management\n* Add a page test for Scheduler.WebHome that checks for the proper use of the CSRF token\n* Refactor scheduling actions URL generation\n* Refactor Scheduler.WebHome to improve escaping",
    "type_of_change": "Modification",
    "filename_of_changes": "SchedulerIT.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 73:         setup.deletePage(\"Scheduler\", \"SchedulerTestJob\");",
        "// Line_Reference 77:         schedulerHomePage.setJobName(\"SchedulerTestJob\");",
        "// Line_Reference 110:         setup.gotoPage(\"Scheduler\", \"SchedulerTestJob\", \"view\", \"spaceRedirect=false\");"
    ]
}