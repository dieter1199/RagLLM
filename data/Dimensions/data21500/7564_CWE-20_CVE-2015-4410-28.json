{
    "cve_id": "CVE-2015-4410",
    "cve_description": "The Moped::BSON::ObjecId.legal? method in rubygem-moped before commit dd5a7c14b5d2e466f7875d079af71ad19774609b allows remote attackers to cause a denial of service (worker resource consumption) or perform a cross-site scripting (XSS) attack via a crafted string.",
    "cve_publish_date": "2020-02-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Merge Replica Set Refactor\n\n* Removes Server, and Socket; replaced with Node, and Connection.\n\n  Replica sets are now much more robustly supported, including failover\n  and discovery.\n\n* Refactors specs.\n\n  Internal APIs are now tested with integration specs through the public\n  APIs.\n\n* More documentation.",
    "type_of_change": "Modification",
    "filename_of_changes": "query.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 102:       session.simple_query(operation)",
        "// Line_Reference 110:       cursor = Cursor.new(session.with(retain_socket: true), operation)",
        "// Line_Reference 154:       update = Protocol::Update.new(",
        "// Line_Reference 155:         operation.database,",
        "// Line_Reference 156:         operation.collection,",
        "// Line_Reference 157:         operation.selector,",
        "// Line_Reference 158:         change,",
        "// Line_Reference 159:         flags: flags",
        "// Line_Reference 160:       )",
        "// Line_Reference 161: ",
        "// Line_Reference 163:         session.execute update",
        "// Line_Reference 196:       delete = Protocol::Delete.new(",
        "// Line_Reference 197:         operation.database,",
        "// Line_Reference 198:         operation.collection,",
        "// Line_Reference 199:         operation.selector,",
        "// Line_Reference 200:         flags: [:remove_first]",
        "// Line_Reference 201:       )",
        "// Line_Reference 202: ",
        "// Line_Reference 204:         session.execute delete",
        "// Line_Reference 213:       delete = Protocol::Delete.new(",
        "// Line_Reference 214:         operation.database,",
        "// Line_Reference 215:         operation.collection,",
        "// Line_Reference 216:         operation.selector",
        "// Line_Reference 217:       )",
        "// Line_Reference 218: ",
        "// Line_Reference 220:         session.execute delete"
    ]
}
