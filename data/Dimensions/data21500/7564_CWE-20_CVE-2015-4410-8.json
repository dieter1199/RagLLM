{
    "cve_id": "CVE-2015-4410",
    "cve_description": "The Moped::BSON::ObjecId.legal? method in rubygem-moped before commit dd5a7c14b5d2e466f7875d079af71ad19774609b allows remote attackers to cause a denial of service (worker resource consumption) or perform a cross-site scripting (XSS) attack via a crafted string.",
    "cve_publish_date": "2020-02-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Merge Replica Set Refactor\n\n* Removes Server, and Socket; replaced with Node, and Connection.\n\n  Replica sets are now much more robustly supported, including failover\n  and discovery.\n\n* Refactors specs.\n\n  Internal APIs are now tested with integration specs through the public\n  APIs.\n\n* More documentation.",
    "type_of_change": "Modification",
    "filename_of_changes": "errors.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 2: ",
        "// Line_Reference 3:   # The namespace for all errors generated by Moped.",
        "// Line_Reference 13:     # Raised when providing an invalid string from an object id.",
        "// Line_Reference 14:     class InvalidObjectId < StandardError",
        "// Line_Reference 15:       def initialize(string)",
        "// Line_Reference 16:         super(\"'#{string}' is not a valid object id.\")",
        "// Line_Reference 17:       end",
        "// Line_Reference 18:     end",
        "// Line_Reference 22:     class MongoError < StandardError; end",
        "// Line_Reference 23: ",
        "// Line_Reference 24:     # Exception class for exceptions generated as a direct result of an",
        "// Line_Reference 25:     # operation, such as a failed insert or an invalid command.",
        "// Line_Reference 26:     class OperationFailure < MongoError",
        "// Line_Reference 27: ",
        "// Line_Reference 63:     # A special kind of OperationFailure, raised when Mongo sets the",
        "// Line_Reference 64:     # :query_failure flag on a query response.",
        "// Line_Reference 65:     class QueryFailure < OperationFailure; end"
    ]
}
