{
    "cve_id": "CVE-2022-4822",
    "cve_description": "A vulnerability, which was classified as problematic, has been found in FlatPress. This issue affects some unknown processing of the file setup/lib/main.lib.php of the component Setup. The manipulation leads to cross site scripting. The attack may be initiated remotely. The name of the patch is 5f23b4c2eac294cc0ba5e541f83a6f8a26f9fed1. It is recommended to apply a patch to fix this issue. The identifier VDB-217001 was assigned to this vulnerability.",
    "cve_publish_date": "2022-12-28",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fixes #176, possible XSS in setup",
    "type_of_change": "Modification",
    "filename_of_changes": "main.lib.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 98: \tif (!ctype_alnum($_POST ['fpuser']))",
        "// Line_Reference 99: \t\t$err [] = \"{$_POST['fpuser']} is not a valid username.",
        "// Line_Reference 101: ",
        "// Line_Reference 102: \tif (strlen(trim(($_POST ['fppwd']))) < 6)",
        "// Line_Reference 104: ",
        "// Line_Reference 105: \tif (($_POST ['fppwd']) != ($_POST ['fppwd2']))",
        "// Line_Reference 107: ",
        "// Line_Reference 108: \tif (!(preg_match('!@.*@|\\.\\.|\\,|\\;!', $_POST ['email']) || preg_match('!^.+\\@(\\[?)[a-zA-Z0-9\\.\\-]+\\.([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$!', $_POST ['email'])))",
        "// Line_Reference 109: \t\t$err [] = \"{$_POST['email']} is not a valid email address\";",
        "// Line_Reference 110: ",
        "// Line_Reference 111: \t$www = $_POST ['www'];",
        "// Line_Reference 113: \t\t$err [] = \"$www is not a valid URL\";",
        "// Line_Reference 114: \tif ($www && $www [strlen($www) - 1] != '/')",
        "// Line_Reference 119: \t$fp_config ['general'] ['author'] = $user ['userid'] = $_POST ['fpuser'];",
        "// Line_Reference 120: \t$user ['password'] = $_POST ['fppwd'];",
        "// Line_Reference 123: \t$fp_config ['general'] ['email'] = $user ['email'] = $_POST ['email'];"
    ]
}
