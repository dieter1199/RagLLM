{
    "cve_id": "CVE-2013-7459",
    "cve_description": "Heap-based buffer overflow in the ALGnew function in block_templace.c in Python Cryptography Toolkit (aka pycrypto) allows remote attackers to execute arbitrary code as demonstrated by a crafted iv parameter to cryptmsg.py.",
    "cve_publish_date": "2017-02-15",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Throw exception when IV is used with ECB or CTR\n\nThe IV parameter is currently ignored when initializing\na cipher in ECB or CTR mode.\n\nFor CTR mode, it is confusing: it takes some time to see\nthat a different parameter is needed (the counter).\n\nFor ECB mode, it is outright dangerous.\n\nThis patch forces an exception to be raised.",
    "type_of_change": "Modification",
    "filename_of_changes": "common.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 608:         for mode in (self.module.MODE_ECB, self.module.MODE_CBC, self.module.MODE_CFB, self.module.MODE_OFB, self.module.MODE_OPENPGP):",
        "// Line_Reference 611: ",
        "// Line_Reference 612:             if mode != self.module.MODE_OPENPGP:",
        "// Line_Reference 613:                 decryption_cipher = self.module.new(a2b_hex(self.key), mode, self.iv)",
        "// Line_Reference 614:             else:",
        "// Line_Reference 615:                 eiv = ciphertext[:self.module.block_size+2]",
        "// Line_Reference 616:                 ciphertext = ciphertext[self.module.block_size+2:]",
        "// Line_Reference 617:                 decryption_cipher = self.module.new(a2b_hex(self.key), mode, eiv)"
    ]
}
