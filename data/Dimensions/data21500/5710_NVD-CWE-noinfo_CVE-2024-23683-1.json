{
    "cve_id": "CVE-2024-23683",
    "cve_description": "Artemis Java Test Sandbox versions less than 1.7.6 are vulnerable to a sandbox escape when an attacker crafts a special subclass of InvocationTargetException. An attacker can abuse this issue to execute arbitrary Java when a victim executes the supposedly sandboxed code.\n\n\n\n\n\n",
    "cve_publish_date": "2024-01-19",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-883x-6fch-6wjx\n\n* Blacklist ReflectionUtils.getUnderlyingCause as it is in the invocation\n\nThis means that trusted classes are no longer have a fully whitelisted\nstack when the cause is fetched and exception methods are invoked.\n\n* Allow security manager to work with method names when checking the stack\n\n* Add security test for a malicious InvocationTargetException\n\nA variant of the exploit found by Daniel, related to GHSA-883x-6fch-6wjx\n\nCo-authored-by: Daniel Kirschten <melodicahaspa@gmail.com>\nCo-authored-by: Christian Femers <c.femers@tum.de>\n\nCo-authored-by: Daniel Kirschten <melodicahaspa@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "ArtemisSecurityManager.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 514: \tprivate boolean isCallNotWhitelisted(String call) {",
        "// Line_Reference 517: \t\t\t\t\t\t&& (configuration == null || !(configuration.whitelistedClassNames().contains(call)",
        "// Line_Reference 518: \t\t\t\t\t\t\t\t|| configuration.trustedPackages().stream().anyMatch(pm -> pm.matches(call)))));",
        "// Line_Reference 522: \t\treturn isCallNotWhitelisted(sf.getClassName());",
        "// Line_Reference 526: \t\treturn isCallNotWhitelisted(ste.getClassName());"
    ]
}
