{
    "cve_id": "CVE-2021-4116",
    "cve_description": "yetiforcecrm is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cve_publish_date": "2021-12-15",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Improved validation of uploaded files",
    "type_of_change": "Modification",
    "filename_of_changes": "File.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "49",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 151: \t * @param array $path",
        "// Line_Reference 155: \tpublic static function loadFromPath($path)",
        "// Line_Reference 158: \t\t$instance->name = basename($path);",
        "// Line_Reference 205: \t\t$instance->name = $name;",
        "// Line_Reference 380: \t * @param bool|string $type",
        "// Line_Reference 386: \tpublic function validate($type = false)",
        "// Line_Reference 411: \t\t\tLog::error(\"Error: {$e->getMessage()} | {$this->getName()} | {$this->getSize()}\", __CLASS__);",
        "// Line_Reference 419: \t * @param bool|string $type",
        "// Line_Reference 423: \tpublic function validateAndSecure($type = false): bool",
        "// Line_Reference 429: \t\tif ('image' === $this->getShortMimeType(0) && static::secureImage($this)) {",
        "// Line_Reference 536: \t\t\t\tthrow new \\App\\Exceptions\\DangerousFile('ERR_FILE_PHP_CODE_INJECTION');",
        "// Line_Reference 639: \t\tif (",
        "// Line_Reference 645: \t\t\tif (",
        "// Line_Reference 646: \t\t\t\t$imageSize",
        "// Line_Reference 647: \t\t\t\t&& (empty($imageInfo['APP1']) || 0 === strpos($imageInfo['APP1'], 'Exif'))",
        "// Line_Reference 648: \t\t\t\t&& ($exifdata = exif_read_data($this->path)) && !$this->validateImageMetadata($exifdata)",
        "// Line_Reference 649: \t\t\t) {",
        "// Line_Reference 650: \t\t\t\tthrow new \\App\\Exceptions\\DangerousFile('ERR_FILE_PHP_CODE_INJECTION');",
        "// Line_Reference 656: \t * Validate image metadata.",
        "// Line_Reference 658: \t * @param mixed $data",
        "// Line_Reference 662: \tprivate function validateImageMetadata($data)",
        "// Line_Reference 666: \t\t\t\tif (!$this->validateImageMetadata($value)) {",
        "// Line_Reference 672: \t\t\t\treturn false;",
        "// Line_Reference 675: \t\treturn true;",
        "// Line_Reference 1201: \t\t\t\t\tif (!static::secureImage($file)) {",
        "// Line_Reference 1304: \tpublic static function secureImage(self $file): bool"
    ]
}
