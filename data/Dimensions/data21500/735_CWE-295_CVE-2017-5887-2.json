{
    "cve_id": "CVE-2017-5887",
    "cve_description": "WebSocket.swift in Starscream before 2.0.4 allows an SSL Pinning bypass because pinning occurs in the stream function (this is too late; pinning should occur in the initStreamsWithData function).",
    "cve_publish_date": "2017-04-06",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "some cleanup and SSL pinning fix",
    "type_of_change": "Modification",
    "filename_of_changes": "WebSocket.swift",
    "code_language": "Swift",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 261: ",
        "// Line_Reference 386:                     self?.cleanupStream()",
        "// Line_Reference 393:             guard !sOperation.isCancelled else { return }",
        "// Line_Reference 403:         if let sec = security, !certValidated && [.hasBytesAvailable, .hasSpaceAvailable].contains(eventCode) {",
        "// Line_Reference 404:             let trust = aStream.property(forKey: kCFStreamPropertySSLPeerTrust as Stream.PropertyKey) as! SecTrust",
        "// Line_Reference 405:             let domain = aStream.property(forKey: kCFStreamSSLPeerName as Stream.PropertyKey) as? String",
        "// Line_Reference 406:             if sec.isValid(trust, domain: domain) {",
        "// Line_Reference 407:                 certValidated = true",
        "// Line_Reference 408:             } else {",
        "// Line_Reference 409:                 let error = errorWithDetail(\"Invalid SSL certificate\", code: 1)",
        "// Line_Reference 410:                 disconnectStream(error)",
        "// Line_Reference 411:                 return",
        "// Line_Reference 412:             }",
        "// Line_Reference 413:         }"
    ]
}
