{
    "cve_id": "CVE-2015-4178",
    "cve_description": "The fs_pin implementation in the Linux kernel before 4.0.5 does not ensure the internal consistency of a certain list data structure, which allows local users to cause a denial of service (system crash) by leveraging user-namespace root access for an MNT_DETACH umount2 system call, related to fs/fs_pin.c and include/linux/fs_pin.h.",
    "cve_publish_date": "2016-05-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "fs_pin: Allow for the possibility that m_list or s_list go unused.\n\nThis is needed to support lazily umounting locked mounts.  Because the\nentire unmounted subtree needs to stay together until there are no\nusers with references to any part of the subtree.\n\nTo support this guarantee that the fs_pin m_list and s_list nodes\nare initialized by initializing them in init_fs_pin allowing\nfor the possibility that pin_insert_group does not touch them.\n\nFurther use hlist_del_init in pin_remove so that there is\na hlist_unhashed test before the list we attempt to update\nthe previous list item.\n\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "fs_pin.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 12: \thlist_del(&pin->m_list);",
        "// Line_Reference 13: \thlist_del(&pin->s_list);"
    ]
}
