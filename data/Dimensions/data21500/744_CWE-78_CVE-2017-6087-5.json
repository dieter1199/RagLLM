{
    "cve_id": "CVE-2017-6087",
    "cve_description": "EyesOfNetwork (\"EON\") 5.0 and earlier allows remote authenticated users to execute arbitrary code via shell metacharacters in the selected_events[] parameter in the (1) acknowledge, (2) delete, or (3) ownDisown function in module/monitoring_ged/ged_functions.php or the (4) module parameter to module/index.php.",
    "cve_publish_date": "2017-03-24",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Fix vulnerabilities",
    "type_of_change": "Modification",
    "filename_of_changes": "ged_functions.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "74",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 139: \t\t$where_clause .= \" AND $filter LIKE '$like'\";",
        "// Line_Reference 154: \t\t$where_clause .= \" AND o_sec > $start AND o_sec < $end\";",
        "// Line_Reference 159: \tif($ok != \"\")\t\t{ $states_list .= \"0,\"; }",
        "// Line_Reference 160: \tif($warning != \"\")\t{ $states_list .= \"1,\"; }",
        "// Line_Reference 161: \tif($critical != \"\")\t{ $states_list .= \"2,\"; }",
        "// Line_Reference 162: \tif($unknown != \"\")\t{ $states_list .= \"3,\"; }",
        "// Line_Reference 213: \t$sql = \"SELECT * FROM \".$ged_type.\"_queue_\".$queue.\" WHERE id = $id\";",
        "// Line_Reference 214: \t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 248: \t$sql = \"SELECT comments FROM \".$ged_type.\"_queue_\".$queue.\" WHERE id = $id\";",
        "// Line_Reference 249: \t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 252: \t$event[\"comments\"] = str_replace(\"\\'\", \"'\", $event[\"comments\"]);",
        "// Line_Reference 253: \t$event[\"comments\"] = str_replace(\"\\#\", \"#'\", $event[\"comments\"]);",
        "// Line_Reference 254: ",
        "// Line_Reference 273: \t// format comment string to avoid errors",
        "// Line_Reference 274: \t$comments = str_replace(\"'\", \"\\'\", $comments);",
        "// Line_Reference 275: \t$comments = str_replace(\"#\", \"\\#\", $comments);",
        "// Line_Reference 276: ",
        "// Line_Reference 277: \t$sql = \"UPDATE \".$ged_type.\"_queue_\".$queue.\" SET comments='$comments' WHERE id = $id\";",
        "// Line_Reference 278: \t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 297: \t\t// format comment string to avoid errors",
        "// Line_Reference 298: \t\t$comments = str_replace(\"'\", \"\\'\", $comments);",
        "// Line_Reference 299: \t\t$comments = str_replace(\"#\", \"\\#\", $comments);",
        "// Line_Reference 300: ",
        "// Line_Reference 301: \t\t$sql = \"UPDATE \".$ged_type.\"_queue_\".$queue.\" SET comments='$comments' WHERE id = $id\";",
        "// Line_Reference 302: \t\t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 340: \t\t$sql = \"SELECT * FROM \".$ged_type.\"_queue_\".$queue.\" WHERE id = $id\";",
        "// Line_Reference 341: \t\t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 354: ",
        "// Line_Reference 383: \t\t$sql = \"SELECT * FROM \".$ged_type.\"_queue_\".$queue.\" WHERE id = $id\";",
        "// Line_Reference 384: \t\t$result = sqlrequest($database_ged, $sql);",
        "// Line_Reference 397: ",
        "// Line_Reference 436: ",
        "// Line_Reference 447: ",
        "// Line_Reference 495: ",
        "// Line_Reference 496: \twhile($ged_type = mysqli_fetch_assoc($gedsql_result1)){",
        "// Line_Reference 497: \t\t$sql = \"SELECT DISTINCT $filter FROM \".$ged_type[\"pkt_type_name\"].\"_queue_\".$queue;",
        "// Line_Reference 498: ",
        "// Line_Reference 499: \t\t$results = sqlrequest($database_ged, $sql);",
        "// Line_Reference 500: \t\twhile($result = mysqli_fetch_array($results)){",
        "// Line_Reference 501: \t\t\tif( !in_array($result[$filter], $datas) && $result[$filter] != \"\" ){",
        "// Line_Reference 502: \t\t\t\tarray_push($datas, $result[$filter]);"
    ]
}
