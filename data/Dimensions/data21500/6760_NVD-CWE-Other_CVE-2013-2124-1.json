{
    "cve_id": "CVE-2013-2124",
    "cve_description": "Double free vulnerability in inspect-fs.c in LibguestFS 1.20.x before 1.20.7, 1.21.x, 1.22.0, and 1.23.0 allows remote attackers to cause a denial of service (crash) via empty guest files.",
    "cve_publish_date": "2014-05-27",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "inspection: Fix double-free when certain guest files are empty.\n\nThe following commit:\n\n  commit 5a3da366268825b26b470cde35658b67c1d11cd4\n  Author: Richard W.M. Jones <rjones@redhat.com>\n  Date:   Thu Jan 24 17:07:38 2013 +0000\n\n      inspect: Use CLEANUP_* macros in inspection code.\n\ncan cause a double-free along an error path when certain guest files\nare empty where we expected those files to contain at least one line.\n\nThis causes virt-inspector to crash when run on these guests.\n\nThe following is a test case which demonstrates the crash.\n`f20rawhidex64' is a Fedora guest, but with small adjustments to the\ntest you could use any Linux guest for this test.\n\n  $ qemu-img create -f qcow2 -b f20rawhidex64 /tmp/test.qcow2\n  Formatting '/tmp/test.qcow2', fmt=qcow2 size=21474836480 backing_file='f20rawhidex64' encryption=off cluster_size=65536 lazy_refcounts=off\n  $ guestfish -i -a /tmp/test.qcow2 -- rm /etc/redhat-release : touch /etc/redhat-release\n  $ virt-inspector /tmp/test.qcow2\n  *** glibc detected *** virt-inspector: double free or corruption (fasttop): 0x00007f18bc9925a0 ***\n  ======= Backtrace: =========\n  /lib64/libc.so.6(+0x34ecc7ca8e)[0x7f18b8e64a8e]\n  /lib64/libguestfs.so.0(+0x3f91898078)[0x7f18ba13c078]\n  /lib64/libguestfs.so.0(+0x3f91899761)[0x7f18ba13d761]\n  /lib64/libguestfs.so.0(+0x3f91896d12)[0x7f18ba13ad12]\n  /lib64/libguestfs.so.0(+0x3f91894140)[0x7f18ba138140]\n  /lib64/libguestfs.so.0(guestfs_inspect_os+0x35)[0x7f18ba0bcc35]\n  virt-inspector(main+0x547)[0x7f18ba7c57d7]\n  /lib64/libc.so.6(__libc_start_main+0xf5)[0x7f18b8e09a05]\n  virt-inspector(+0x6665)[0x7f18ba7c7665]\n\nThis is a denial of service, but not likely to be exploitable.\n\n(Found by Coverity)",
    "type_of_change": "Modification",
    "filename_of_changes": "inspect-fs.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 547:   CLEANUP_FREE char **lines = NULL; /* sic: not CLEANUP_FREE_STRING_LIST */"
    ]
}
