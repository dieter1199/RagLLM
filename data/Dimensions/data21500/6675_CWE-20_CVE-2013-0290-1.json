{
    "cve_id": "CVE-2013-0290",
    "cve_description": "The __skb_recv_datagram function in net/core/datagram.c in the Linux kernel before 3.8 does not properly handle the MSG_PEEK flag with zero-length data, which allows local users to cause a denial of service (infinite loop and system hang) via a crafted application.",
    "cve_publish_date": "2013-02-19",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "net: fix infinite loop in __skb_recv_datagram()\n\nTommi was fuzzing with trinity and reported the following problem :\n\ncommit 3f518bf745 (datagram: Add offset argument to __skb_recv_datagram)\nmissed that a raw socket receive queue can contain skbs with no payload.\n\nWe can loop in __skb_recv_datagram() with MSG_PEEK mode, because\nwait_for_packet() is not prepared to skip these skbs.\n\n[   83.541011] INFO: rcu_sched detected stalls on CPUs/tasks: {}\n(detected by 0, t=26002 jiffies, g=27673, c=27672, q=75)\n[   83.541011] INFO: Stall ended before state dump start\n[  108.067010] BUG: soft lockup - CPU#0 stuck for 22s! [trinity-child31:2847]\n...\n[  108.067010] Call Trace:\n[  108.067010]  [<ffffffff818cc103>] __skb_recv_datagram+0x1a3/0x3b0\n[  108.067010]  [<ffffffff818cc33d>] skb_recv_datagram+0x2d/0x30\n[  108.067010]  [<ffffffff819ed43d>] rawv6_recvmsg+0xad/0x240\n[  108.067010]  [<ffffffff818c4b04>] sock_common_recvmsg+0x34/0x50\n[  108.067010]  [<ffffffff818bc8ec>] sock_recvmsg+0xbc/0xf0\n[  108.067010]  [<ffffffff818bf31e>] sys_recvfrom+0xde/0x150\n[  108.067010]  [<ffffffff81ca4329>] system_call_fastpath+0x16/0x1b\n\nReported-by: Tommi Rantala <tt.rantala@gmail.com>\nTested-by: Tommi Rantala <tt.rantala@gmail.com>\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nCc: Pavel Emelyanov <xemul@parallels.com>\nAcked-by: Pavel Emelyanov <xemul@parallels.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "datagram.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 190: \t\t\t\tif (*off >= skb->len) {"
    ]
}
