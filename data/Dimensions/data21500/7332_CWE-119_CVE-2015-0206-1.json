{
    "cve_id": "CVE-2015-0206",
    "cve_description": "Memory leak in the dtls1_buffer_record function in d1_pkt.c in OpenSSL 1.0.0 before 1.0.0p and 1.0.1 before 1.0.1k allows remote attackers to cause a denial of service (memory consumption) by sending many duplicate records for the next epoch, leading to failure of replay detection.",
    "cve_publish_date": "2015-01-09",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "A memory leak can occur in dtls1_buffer_record if either of the calls to\nssl3_setup_buffers or pqueue_insert fail. The former will fail if there is a\nmalloc failure, whilst the latter will fail if attempting to add a duplicate\nrecord to the queue. This should never happen because duplicate records should\nbe detected and dropped before any attempt to add them to the queue.\nUnfortunately records that arrive that are for the next epoch are not being\nrecorded correctly, and therefore replays are not being detected.\nAdditionally, these \"should not happen\" failures that can occur in\ndtls1_buffer_record are not being treated as fatal and therefore an attacker\ncould exploit this by sending repeated replay records for the next epoch,\neventually causing a DoS through memory exhaustion.\n\nThanks to Chris Mueller for reporting this issue and providing initial\nanalysis and a patch. Further analysis and the final patch was performed by\nMatt Caswell from the OpenSSL development team.\n\nCVE-2015-0206\n\nReviewed-by: Dr Stephen Henson <steve@openssl.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "d1_pkt.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 215: ",
        "// Line_Reference 252: \t\treturn(0);",
        "// Line_Reference 261: \t\treturn(0);",
        "// Line_Reference 317:             dtls1_buffer_record(s, &(s->d1->processed_rcds),",
        "// Line_Reference 318:                 s->s3->rrec.seq_num);",
        "// Line_Reference 532: \tdtls1_record_bitmap_update(s, &(s->d1->bitmap));/* Mark receipt of record. */",
        "// Line_Reference 566: \tdtls1_process_buffered_records(s);",
        "// Line_Reference 706: \t\t\tdtls1_buffer_record(s, &(s->d1->unprocessed_rcds), rr->seq_num);",
        "// Line_Reference 872: \t\tdtls1_buffer_record(s, &(s->d1->buffered_app_data), rr->seq_num);"
    ]
}
