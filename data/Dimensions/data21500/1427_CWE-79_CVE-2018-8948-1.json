{
    "cve_id": "CVE-2018-8948",
    "cve_description": "In MISP before 2.4.89, app/View/Events/resolved_attributes.ctp has multiple XSS issues via a malicious MISP module.",
    "cve_publish_date": "2018-03-23",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fix: Fixed various potential XSS issues in the resolved attributes view\n\n- potentially exposed XSS if a malicious MISP module was loaded on the instance\n\n- as reported by Christophe Vandeplas (@cvandeplas)",
    "type_of_change": "Modification",
    "filename_of_changes": "resolved_attributes.ctp",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 146: \t\t\t\t\t\t\t\techo '<option value=\"' . $type . '\" ';",
        "// Line_Reference 147: \t\t\t\t\t\t\t\techo ($type == $item['default_type'] ? 'selected=\"selected\"' : '') . '>' . $type . '</option>';",
        "// Line_Reference 170: \t\t\t\t\t\t\t\techo '<option value=\"' . $sgKey . '\">' . $sgValue . '</option>';",
        "// Line_Reference 177: \t\t\t\t<input type=\"text\" class=\"freetextCommentField\" id=\"<?php echo 'Attribute' . $k . 'Comment'; ?>\" style=\"padding:0px;height:20px;margin-bottom:0px;\" placeholder=\"<?php echo h($importComment); ?>\" <?php if (isset($item['comment']) && $item['comment'] !== false) echo 'value=\"' . $item['comment'] . '\"'?>/>",
        "// Line_Reference 180: \t\t\t\t<input type=\"text\" class=\"freetextTagField\" id=\"<?php echo 'Attribute' . $k . 'Tags'; ?>\" style=\"padding:0px;height:20px;margin-bottom:0px;\"<?php if (isset($item['tags']) && $item['tags'] !== false) echo 'value=\"' . htmlspecialchars(implode(\",\",$item['tags'])) . '\"'?>/>",
        "// Line_Reference 209: \t\t\t\t\t\t\t<option><?php echo $fromElement; ?></option>"
    ]
}
