{
    "cve_id": "CVE-2014-2739",
    "cve_description": "The cma_req_handler function in drivers/infiniband/core/cma.c in the Linux kernel 3.14.x through 3.14.1 attempts to resolve an RDMA over Converged Ethernet (aka RoCE) address that is properly resolved within a different module, which allows remote attackers to cause a denial of service (incorrect pointer dereference and system crash) via crafted network traffic.",
    "cve_publish_date": "2014-04-14",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "IB/core: Don't resolve passive side RoCE L2 address in CMA REQ handler\n\nThe code that resolves the passive side source MAC within the rdma_cm\nconnection request handler was both redundant and buggy, so remove it.\n\nIt was redundant since later, when an RC QP is modified to RTR state,\nthe resolution will take place in the ib_core module.  It was buggy\nbecause this callback also deals with UD SIDR exchange, for which we\nincorrectly looked at the REQ member of the CM event and dereferenced\na random value.\n\nFixes: dd5f03beb4f7 (\"IB/core: Ethernet L2 attributes in verbs/cm structures\")\nSigned-off-by: Moni Shoua <monis@mellanox.com>\nSigned-off-by: Or Gerlitz <ogerlitz@mellanox.com>\nSigned-off-by: Roland Dreier <roland@purestorage.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "cma.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 1287: \tu8 smac[ETH_ALEN];",
        "// Line_Reference 1288: \tu8 alt_smac[ETH_ALEN];",
        "// Line_Reference 1289: \tu8 *psmac = smac;",
        "// Line_Reference 1290: \tu8 *palt_smac = alt_smac;",
        "// Line_Reference 1291: \tint is_iboe = ((rdma_node_get_transport(cm_id->device->node_type) ==",
        "// Line_Reference 1292: \t\t\tRDMA_TRANSPORT_IB) &&",
        "// Line_Reference 1293: \t\t       (rdma_port_get_link_layer(cm_id->device,",
        "// Line_Reference 1294: \t\t\tib_event->param.req_rcvd.port) ==",
        "// Line_Reference 1295: \t\t\tIB_LINK_LAYER_ETHERNET));",
        "// Line_Reference 1339: ",
        "// Line_Reference 1340: \tif (is_iboe) {",
        "// Line_Reference 1341: \t\tif (ib_event->param.req_rcvd.primary_path != NULL)",
        "// Line_Reference 1342: \t\t\trdma_addr_find_smac_by_sgid(",
        "// Line_Reference 1343: \t\t\t\t&ib_event->param.req_rcvd.primary_path->sgid,",
        "// Line_Reference 1344: \t\t\t\tpsmac, NULL);",
        "// Line_Reference 1345: \t\telse",
        "// Line_Reference 1346: \t\t\tpsmac = NULL;",
        "// Line_Reference 1347: \t\tif (ib_event->param.req_rcvd.alternate_path != NULL)",
        "// Line_Reference 1348: \t\t\trdma_addr_find_smac_by_sgid(",
        "// Line_Reference 1349: \t\t\t\t&ib_event->param.req_rcvd.alternate_path->sgid,",
        "// Line_Reference 1350: \t\t\t\tpalt_smac, NULL);",
        "// Line_Reference 1351: \t\telse",
        "// Line_Reference 1352: \t\t\tpalt_smac = NULL;",
        "// Line_Reference 1353: \t}",
        "// Line_Reference 1359: \tif (is_iboe)",
        "// Line_Reference 1360: \t\tib_update_cm_av(cm_id, psmac, palt_smac);"
    ]
}
