{
    "cve_id": "CVE-2023-0048",
    "cve_description": "Code Injection in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-04",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "Validating/sanitizing user input (#327)\n\n* Better validating log filepath\r\n\r\n* improving configuration read/write function\r\n\r\n* SMTP configuration parameter validation\r\n\r\n* Input validation/sanitization fixes\r\n\r\n* minor fix",
    "type_of_change": "Modification",
    "filename_of_changes": "config_read.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "28",
    "vulnerable_lines": [
        "// Line_Reference 17:  * Description:",
        "// Line_Reference 18:  * \t\treads configuration file from daloradius.conf and appends it to the $configValues associated array",
        "// Line_Reference 20:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 24: ",
        "// Line_Reference 25: $_configFile = dirname(__FILE__).'/daloradius.conf.php';",
        "// Line_Reference 26: include($_configFile);",
        "// Line_Reference 28: /*",
        "// Line_Reference 29: ****************************************************************************************************",
        "// Line_Reference 30: * deprecated for handling the configuration variables as a PHP page for the sake of security",
        "// Line_Reference 31: ****************************************************************************************************",
        "// Line_Reference 32: $_configCommentChar = \"#\";",
        "// Line_Reference 34: $_configFp = fopen($_configFile, \"r\");",
        "// Line_Reference 35: if ($_configFp) {",
        "// Line_Reference 36: \twhile (!feof($_configFp)) {",
        "// Line_Reference 37: \t\t$_configLine = trim(fgets($_configFp));",
        "// Line_Reference 38: \t\tif ($_configLine && !ereg(\"^$_configCommentChar\", $_configLine)) {",
        "// Line_Reference 39: \t\t\t$_configPieces = explode(\"=\", $_configLine);",
        "// Line_Reference 40: \t\t\t$_configOption = trim($_configPieces[0]);",
        "// Line_Reference 41: \t\t\t$_configValue = trim($_configPieces[1]);",
        "// Line_Reference 42: \t\t\t$configValues[$_configOption] = $_configValue;",
        "// Line_Reference 43: \t\t}",
        "// Line_Reference 44: \t}",
        "// Line_Reference 45: \tfclose($_configFp);",
        "// Line_Reference 46: } else {",
        "// Line_Reference 47: \t$failureMsg = \"Could not open the file for reading:<b> $_configFile </b>",
        "// Line_Reference 48: \t<br/>Check file permissions. The file should be readable by the webserver's user/group\";",
        "// Line_Reference 50: ****************************************************************************************************",
        "// Line_Reference 51: */"
    ]
}
