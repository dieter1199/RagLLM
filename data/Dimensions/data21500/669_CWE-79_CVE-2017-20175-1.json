{
    "cve_id": "CVE-2017-20175",
    "cve_description": "A vulnerability classified as problematic has been found in DaSchTour matomo-mediawiki-extension up to 2.4.2 on MediaWiki. This affects an unknown part of the file Piwik.hooks.php of the component Username Handler. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 2.4.3 is able to address this issue. The patch is named 681324e4f518a8af4bd1f93867074c728eb9923d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-220203.",
    "cve_publish_date": "2023-02-05",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "SECURITY: XSS when $wgPiwikTrackUsernames is true\n\nWith a specially-crafted username like 0'+(window.alert('You have been hacked'))+'0\nthe user receives the alert \"You have been hacked\". This commit escapes the\nusername.",
    "type_of_change": "Modification",
    "filename_of_changes": "Piwik.hooks.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 85:             $username = $wgUser->getName();",
        "// Line_Reference 86:             $customJs .= PHP_EOL . \"  _paq.push(['setUserId','{$username}']);\";"
    ]
}
