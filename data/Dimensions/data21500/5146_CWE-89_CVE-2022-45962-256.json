{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "MedicalInc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "47",
    "number_of_lines_deleted_vulnerable_to_cve": "46",
    "vulnerable_lines": [
        "// Line_Reference 37:     if (DeletePromptMod($_REQUEST['title'], '&include=MedicalInc&category_id=' . $_REQUEST[category_id])) {",
        "// Line_Reference 48:     echo '<h5 class=\"text-primary\">'._medicalInformation.'</h5>';",
        "// Line_Reference 50: ",
        "// Line_Reference 52: ",
        "// Line_Reference 55:     echo '<div class=\"form-group\">'.TextInput($student['PHYSICIAN'], 'medical_info[PHYSICIAN]', ''._primaryCarePhysician.'', 'class=cell_medium maxlength=100').'</div>';",
        "// Line_Reference 57:     echo '<div class=\"form-group\">'.TextInput($student['PHYSICIAN_PHONE'], 'medical_info[PHYSICIAN_PHONE]', ''._physicianSPhone.'', 'class=cell_medium maxlength=100').'</div>';",
        "// Line_Reference 60: ",
        "// Line_Reference 63:     echo '<div class=\"form-group\">'.TextInput($student['PREFERRED_HOSPITAL'], 'medical_info[PREFERRED_HOSPITAL]', ''._preferredMedicalFacility.'', 'class=cell_medium maxlength=100').'</div>';",
        "// Line_Reference 66: ",
        "// Line_Reference 68: ",
        "// Line_Reference 70: ",
        "// Line_Reference 72: ",
        "// Line_Reference 85:     $columns = array('DOCTORS_NOTE_DATE' =>_date,",
        "// Line_Reference 86:      'DOCTORS_NOTE_COMMENTS' =>_doctorSNote,",
        "// Line_Reference 91:     if (!isset($_REQUEST['dwnl']) || $_REQUEST['dwnl'] == 'notes'){",
        "// Line_Reference 94:         ListOutput_Medical($med_RET, $columns, _medicalNote, _medicalNotes, $link, 'notes', array(), array('search' =>false));",
        "// Line_Reference 99: ",
        "// Line_Reference 100: ",
        "// Line_Reference 108:     $columns = array('TYPE' =>_type,",
        "// Line_Reference 109:      'MEDICAL_DATE' =>_date,",
        "// Line_Reference 110:      'COMMENTS' =>_comments,",
        "// Line_Reference 124:         $plural = _immunizationsAndPhysicals;",
        "// Line_Reference 126: ",
        "// Line_Reference 127:     echo '<div class=\"panel panel-default\"><div class=\"panel-heading\"><h5 class=\"panel-title\">'._immunizationPhysicalRecord.'</h5></div>';",
        "// Line_Reference 129: ",
        "// Line_Reference 130:     if (!isset($_REQUEST['dwnl']) || $_REQUEST['dwnl'] == 'immunizations'){",
        "// Line_Reference 132:         ListOutput_Medical($med_RET, $columns, _immunizationOrPhysical, $plural, $link, 'immunizations', array(), array('search' =>false));",
        "// Line_Reference 136: ",
        "// Line_Reference 141:     $columns = array('ALERT_DATE' =>_alertDate,",
        "// Line_Reference 142:      'TITLE' =>_medicalAlert,",
        "// Line_Reference 152: ",
        "// Line_Reference 156:     echo '<div class=\"panel panel-default\"><div class=\"panel-heading\"><h5 class=\"panel-title\">'._medicalAlert.'</h5></div>';",
        "// Line_Reference 158:     if (!isset($_REQUEST['dwnl']) || $_REQUEST['dwnl'] == 'medical'){",
        "// Line_Reference 160:         ListOutput_Medical($med_RET, $columns, _medicalAlert, _medicalAlerts, $link, 'medical', array(), array('search' =>false));",
        "// Line_Reference 165: ",
        "// Line_Reference 170:     $columns = array('SCHOOL_DATE' =>_date,",
        "// Line_Reference 171:      'TIME_IN' =>_timeIn,",
        "// Line_Reference 172:      'TIME_OUT' =>_timeOut,",
        "// Line_Reference 173:      'REASON' =>_reason,",
        "// Line_Reference 174:      'RESULT' =>_result,",
        "// Line_Reference 175:      'COMMENTS' =>_comments,",
        "// Line_Reference 185: ",
        "// Line_Reference 189:     echo '<div class=\"panel panel-default m-b-0\"><div class=\"panel-heading\"><h4 class=\"panel-title\">'._nurseVisitRecord.'</h4></div>';",
        "// Line_Reference 191:     if (!isset($_REQUEST['dwnl']) || $_REQUEST['dwnl'] == 'nurse'){",
        "// Line_Reference 193:         ListOutput_Medical($med_RET, $columns, _nurseVisit, _nurseVisits, $link, 'nurse', array(), array('search' =>false));",
        "// Line_Reference 198: ?>"
    ]
}
