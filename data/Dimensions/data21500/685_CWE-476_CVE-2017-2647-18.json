{
    "cve_id": "CVE-2017-2647",
    "cve_description": "The KEYS subsystem in the Linux kernel before 3.18 allows local users to gain privileges or cause a denial of service (NULL pointer dereference and system crash) via vectors involving a NULL value for a certain match field, related to the keyring_search_iterator function in keyring.c.",
    "cve_publish_date": "2017-03-31",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "KEYS: Remove key_type::match in favour of overriding default by match_preparse\n\nA previous patch added a ->match_preparse() method to the key type.  This is\nallowed to override the function called by the iteration algorithm.\nTherefore, we can just set a default that simply checks for an exact match of\nthe key description with the original criterion data and allow match_preparse\nto override it as needed.\n\nThe key_type::match op is then redundant and can be removed, as can the\nuser_match() function.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nAcked-by: Vivek Goyal <vgoyal@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "user_defined.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 33: \t.match\t\t\t= user_match,",
        "// Line_Reference 54: \t.match\t\t\t= user_match,",
        "// Line_Reference 139: /*",
        "// Line_Reference 140:  * match users on their name",
        "// Line_Reference 141:  */",
        "// Line_Reference 142: int user_match(const struct key *key, const struct key_match_data *match_data)",
        "// Line_Reference 143: {",
        "// Line_Reference 144: \treturn strcmp(key->description, match_data->raw_data) == 0;",
        "// Line_Reference 145: }",
        "// Line_Reference 146: ",
        "// Line_Reference 147: EXPORT_SYMBOL_GPL(user_match);",
        "// Line_Reference 148: "
    ]
}
