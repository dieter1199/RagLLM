{
    "cve_id": "CVE-2014-8172",
    "cve_description": "The filesystem implementation in the Linux kernel before 3.13 performs certain operations on lists of files with an inappropriate locking approach, which allows local users to cause a denial of service (soft lockup or system crash) via unspecified use of Asynchronous I/O (AIO) operations.",
    "cve_publish_date": "2015-03-16",
    "cwe_id": "CWE-17",
    "cwe_name": "DEPRECATED: Code",
    "cwe_description": "This entry has been deprecated.  It was originally used for organizing the Development View (CWE-699) and some other views, but it introduced unnecessary complexity and depth to the resulting tree.",
    "commit_message": "get rid of s_files and files_lock\n\nThe only thing we need it for is alt-sysrq-r (emergency remount r/o)\nand these days we can do just as well without going through the\nlist of files.\n\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "super.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 143: #ifdef CONFIG_SMP",
        "// Line_Reference 144: \tfree_percpu(s->s_files);",
        "// Line_Reference 145: #endif",
        "// Line_Reference 175: #ifdef CONFIG_SMP",
        "// Line_Reference 176: \ts->s_files = alloc_percpu(struct list_head);",
        "// Line_Reference 177: \tif (!s->s_files)",
        "// Line_Reference 178: \t\tgoto fail;",
        "// Line_Reference 179: \tfor_each_possible_cpu(i)",
        "// Line_Reference 180: \t\tINIT_LIST_HEAD(per_cpu_ptr(s->s_files, i));",
        "// Line_Reference 181: #else",
        "// Line_Reference 182: \tINIT_LIST_HEAD(&s->s_files);",
        "// Line_Reference 183: #endif",
        "// Line_Reference 725: \t\t\tmark_files_ro(sb);"
    ]
}
