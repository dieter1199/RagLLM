{
    "cve_id": "CVE-2023-1350",
    "cve_description": "A vulnerability was found in liferea. It has been rated as critical. Affected by this issue is the function update_job_run of the file src/update.c of the component Feed Enrichment. The manipulation of the argument source with the input |date &gt;/tmp/bad-item-link.txt leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-222848.",
    "cve_publish_date": "2023-03-11",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Fix RCE vulnerability on feed enrichment\n\nCurrently there are a few places in the code that do not check URLs for\nthe presence of a command prefix, allowing malicious websites to run any\ncommand in the local system.\n\nTrying to run feed enrichment (i.e. after option \"Extract full content\nfrom HTML5 and Google AMP\" is enabled) in a subscription that produces\nthis item:\n\n    <item>\n      <title>Check /tmp/bad-item-link.txt</title>\n      <link>|date &gt;/tmp/bad-item-link.txt</link>\n    </item>\n\nwill cause Liferea to call update_request_new on URL\n\"|date >/tmp/bad-item-link.txt\" and then blindly run the command. A\nsimilar effect happens when running the feed enrichment in a item that\nlinks to a document like this:\n\n    <!DOCTYPE html>\n    <html>\n     <head>\n      <title>AMP URL RCE PoC</title>\n      <link rel=\"amphtml\" href=\"|date &gt; /tmp/bad-amp-url.txt\">\n     </head>\n     <body>\n         Check the results in /tmp/bad-amp-url.txt\n     </body>\n    </html>\n\nonce Liferea tries to load the AMP URL.\n\nThere are other calls to update_request_* functions where URLs are\nvalidated correctly (e.g. in feed icons and comments) and do not trigger\nthis vulnerability. Since the subscription update is the exception where\nfeed commands are supported (and welcome!) I chose to lock this feature\nbehind a non-persistent flag and only enable it when required. This is\nsafer than adding the flag in updateOptions, which is usually reused in\nsubordinate requests.\n\nThis failure exists since commits b8288389820a3f510ef4b21684b22439c41d95a5\nand b67dbba73443ab7b36fcd3c78aa803e974c0f23e from Setember 2017.",
    "type_of_change": "Modification",
    "filename_of_changes": "update.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 675: \t\tdebug1 (DEBUG_UPDATE, \"Recognized local command: %s\", job->request->source);",
        "// Line_Reference 676: \t\tupdate_exec_cmd (job);"
    ]
}
