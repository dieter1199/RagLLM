{
    "cve_id": "CVE-2014-1438",
    "cve_description": "The restore_fpu_checking function in arch/x86/include/asm/fpu-internal.h in the Linux kernel before 3.12.8 on the AMD K7 and K8 platforms does not clear pending exceptions before proceeding to an EMMS instruction, which allows local users to cause a denial of service (task kill) or possibly gain privileges via a crafted application.",
    "cve_publish_date": "2014-01-18",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "x86, fpu, amd: Clear exceptions in AMD FXSAVE workaround\n\nBefore we do an EMMS in the AMD FXSAVE information leak workaround we\nneed to clear any pending exceptions, otherwise we trap with a\nfloating-point exception inside this code.\n\nReported-by: halfdog <me@halfdog.net>\nTested-by: Borislav Petkov <bp@suse.de>\nLink: http://lkml.kernel.org/r/CA%2B55aFxQnY_PCG_n4=0w-VG=YLXL-yr7oMxyy0WU2gCBAf3ydg@mail.gmail.com\nSigned-off-by: H. Peter Anvin <hpa@zytor.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "fpu-internal.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 296: \talternative_input(",
        "// Line_Reference 297: \t\tASM_NOP8 ASM_NOP2,",
        "// Line_Reference 298: \t\t\"emms\\n\\t\"\t\t/* clear stack tags */",
        "// Line_Reference 299: \t\t\"fildl %P[addr]\",\t/* set F?P to defined value */",
        "// Line_Reference 300: \t\tX86_FEATURE_FXSAVE_LEAK,",
        "// Line_Reference 301: \t\t[addr] \"m\" (tsk->thread.fpu.has_fpu));"
    ]
}
