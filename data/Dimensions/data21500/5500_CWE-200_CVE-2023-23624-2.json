{
    "cve_id": "CVE-2023-23624",
    "cve_description": "Discourse is an open-source discussion platform. Prior to version 3.0.1 on the `stable` branch and version 3.1.0.beta2 on the `beta` and `tests-passed` branches, someone can use the `exclude_tag param` to filter out topics and deduce which ones were using a specific hidden tag. This affects any Discourse site using hidden tags in public categories. This issue is patched in version 3.0.1 on the `stable` branch and version 3.1.0.beta2 on the `beta` and `tests-passed` branches. As a workaround, secure any categories that are using hidden tags, change any existing hidden tags to not include private data, or remove any hidden tags currently in use.",
    "cve_publish_date": "2023-01-28",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "SECURITY: Update to exclude tag topic filter (#20006)\n\nIgnores tags specified in exclude_tag topics param that a user does not\r\nhave access to.\r\n\r\nCo-authored-by: Blake Erickson <o.blakeerickson@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "topic_query.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 738:       result = result.where(<<~SQL, name: @options[:exclude_tag]) if @options[:exclude_tag].present?",
        "// Line_Reference 739:         topics.id NOT IN (",
        "// Line_Reference 740:           SELECT topic_tags.topic_id",
        "// Line_Reference 741:           FROM topic_tags",
        "// Line_Reference 742:           INNER JOIN tags ON tags.id = topic_tags.tag_id",
        "// Line_Reference 743:           WHERE tags.name = :name",
        "// Line_Reference 744:         )",
        "// Line_Reference 745:         SQL"
    ]
}
