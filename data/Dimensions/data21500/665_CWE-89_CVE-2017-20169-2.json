{
    "cve_id": "CVE-2017-20169",
    "cve_description": "A vulnerability, which was classified as critical, has been found in GGGGGGGG ToN-MasterServer. Affected by this issue is some unknown functionality of the file public_html/irc_updater/svr_request_pub.php. The manipulation leads to sql injection. The patch is identified as 3a4c7e6d51bf95760820e3245e06c6e321a7168a. It is recommended to apply a patch to fix this issue. VDB-218306 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-01-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "protection against sql injections",
    "type_of_change": "Modification",
    "filename_of_changes": "svr_request_pub.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "42",
    "number_of_lines_deleted_vulnerable_to_cve": "36",
    "vulnerable_lines": [
        "// Line_Reference 34: \t$ip = $_SERVER[\"REMOTE_ADDR\"];",
        "// Line_Reference 35: \t$port = intval(post_input(\"port\"));",
        "// Line_Reference 36: \t$num_conn = intval(post_input(\"num_conn\"));",
        "// Line_Reference 37: \t$max_conn = intval(post_input(\"num_max\"));",
        "// Line_Reference 38: \t$name = post_input(\"name\");",
        "// Line_Reference 39: \t$desc = post_input(\"desc\");",
        "// Line_Reference 40: \t$status = post_input(\"status\");",
        "// Line_Reference 41: \t$minkarma = post_input(\"minkarma\");",
        "// Line_Reference 42: \t$location = post_input(\"location\");",
        "// Line_Reference 43: \t$cgt = post_input(\"cgt\");",
        "// Line_Reference 44: \t$next_map = post_input(\"next_map\");",
        "// Line_Reference 45: \t$map = post_input(\"map\");",
        "// Line_Reference 46: \t$login = post_input(\"login\");",
        "// Line_Reference 47: \t$pass = post_input(\"pass\");",
        "// Line_Reference 48: \t$minlevel = intval(post_input(\"minlevel\"));",
        "// Line_Reference 49: \t$maxlevel = intval(post_input(\"maxlevel\"));",
        "// Line_Reference 51: \tglobal $config;",
        "// Line_Reference 78: \tglobal $dbcon;",
        "// Line_Reference 98: \t$num_conn = intval(post_input(\"num_conn\"));",
        "// Line_Reference 99: \t$login = post_input(\"login\");",
        "// Line_Reference 117: \t$id = intval(post_input(\"server_id\"));",
        "// Line_Reference 133: \t$account_id = intval(post_input(\"account_id\"));",
        "// Line_Reference 134: \t$server_id = intval(post_input(\"server_id\"));",
        "// Line_Reference 135: \t$c_conn['account_id'] = post_input(\"account_id\");",
        "// Line_Reference 136: \t$c_conn['server_id'] = post_input(\"server_id\");",
        "// Line_Reference 137: \t$c_conn['num_conn'] = post_input(\"num_conn\");",
        "// Line_Reference 138: \t$c_conn['cookie'] = post_input(\"cookie\");",
        "// Line_Reference 139: \t$c_conn['ip'] = post_input(\"ip\");",
        "// Line_Reference 177: \t$account_id = intval(post_input(\"account_id\"));",
        "// Line_Reference 178: \t$server_id = intval(post_input(\"server_id\"));",
        "// Line_Reference 200: \t$a['login'] = post_input('login');",
        "// Line_Reference 201: \t$a['pass'] = post_input('pass');",
        "// Line_Reference 202: \t$a['type'] = post_input('type'); // = \"reg\"",
        "// Line_Reference 203: \t$a['port'] = post_input('port');",
        "// Line_Reference 204: \t$a['map'] = post_input('map');",
        "// Line_Reference 205: \t$a['account_ids'] = $_POST['account_id'];"
    ]
}
