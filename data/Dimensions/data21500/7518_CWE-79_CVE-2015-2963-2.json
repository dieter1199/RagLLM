{
    "cve_id": "CVE-2015-2963",
    "cve_description": "The thoughtbot paperclip gem before 4.2.2 for Ruby does not consider the content-type value during media-type validation, which allows remote attackers to upload HTML documents and conduct cross-site scripting (XSS) attacks via a spoofed value, as demonstrated by image/jpeg.",
    "cve_publish_date": "2015-07-10",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix a possible security issue with spoofing\n\nThanks to MORI Shingo of DeNA Co., Ltd. for reporting this.\n\nThere is an issue where if an HTML file is uploaded with a .html\nextension, but the content type is listed as being `image/jpeg`, this\nwill bypass a validation checking for images. But it will also pass the\nspoof check, because a file named .html and containing actual HTML\npasses the spoof check.\n\nThis change makes it so that we also check the supplied content type. So\neven if the file contains HTML and ends with .html, it doesn't match the\ncontent type of `image/jpeg` and so it fails.",
    "type_of_change": "Modification",
    "filename_of_changes": "media_type_spoof_detection_validator_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 33:     assert_equal \"has an extension that does not match its contents\", @dummy.errors[:avatar].first"
    ]
}
