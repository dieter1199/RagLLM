{
    "cve_id": "CVE-2015-10127",
    "cve_description": "A vulnerability was found in PlusCaptcha Plugin up to 2.0.6 on WordPress and classified as problematic. Affected by this issue is some unknown functionality. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 2.0.14 is able to address this issue. The patch is identified as 1274afc635170daafd38306487b6bb8a01f78ecd. It is recommended to upgrade the affected component. VDB-248954 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-12-26",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Solver XSS\n\ngit-svn-id: https://plugins.svn.wordpress.org/pluscaptcha/trunk@1094241 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "shortcode-and-others.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "38",
    "number_of_lines_deleted_vulnerable_to_cve": "36",
    "vulnerable_lines": [
        "// Line_Reference 3: # Clean",
        "// Line_Reference 4: # Limpiar data",
        "// Line_Reference 5: function tags($tags){",
        "// Line_Reference 6: \t$tags = strip_tags($tags);",
        "// Line_Reference 7: \t$tags = stripslashes($tags);",
        "// Line_Reference 8: \t$tags = htmlentities($tags);",
        "// Line_Reference 9: \t$tags = addslashes($tags);",
        "// Line_Reference 10: \treturn trim($tags);",
        "// Line_Reference 11: }",
        "// Line_Reference 25:     $page_url = ( isset($_SERVER[\"HTTPS\"]) && $_SERVER[\"HTTPS\"] == \"on\" ? \"https://\" : \"http://\" ) . $_SERVER[\"SERVER_NAME\"] . $_SERVER[\"REQUEST_URI\"];",
        "// Line_Reference 27:     $name = isset($_REQUEST['plscptf_contact_name']) ? $_REQUEST['plscptf_contact_name'] : \"\";",
        "// Line_Reference 28:     $email = isset($_REQUEST['plscptf_contact_email']) ? $_REQUEST['plscptf_contact_email'] : \"\";",
        "// Line_Reference 29:     $subject = isset($_REQUEST['plscptf_contact_subject']) ? $_REQUEST['plscptf_contact_subject'] : \"\";",
        "// Line_Reference 30:     $message = isset($_REQUEST['plscptf_contact_message']) ? $_REQUEST['plscptf_contact_message'] : \"\";",
        "// Line_Reference 31:     $send_copy = isset($_REQUEST['plscptf_contact_send_copy']) ? $_REQUEST['plscptf_contact_send_copy'] : \"\";",
        "// Line_Reference 119:     if (isset($_REQUEST['plscptf_contact_action'])) {",
        "// Line_Reference 150:     if (\"\" != $_REQUEST['plscptf_contact_name'])",
        "// Line_Reference 152:     if (\"\" != $_REQUEST['plscptf_contact_email'] && preg_match(\"/^(?:[a-z0-9]+(?:[a-z0-9\\-_\\.]+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})$/i\", trim($_REQUEST['plscptf_contact_email'])))",
        "// Line_Reference 154:     if (\"\" != $_REQUEST['plscptf_contact_subject'])",
        "// Line_Reference 156:     if (\"\" != $_REQUEST['plscptf_contact_message'])",
        "// Line_Reference 194:       $subject = $_REQUEST['plscptf_contact_subject'];",
        "// Line_Reference 202:         $form_action_url = 'https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];",
        "// Line_Reference 204:         $form_action_url = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];",
        "// Line_Reference 208:         $userdomain = gethostbyaddr($_SERVER['REMOTE_ADDR']);",
        "// Line_Reference 219: \t\t\t\t\t\t\t<td>' . __('Sent from (ip address)', 'PlusCaptcha') . ':</td><td>' . $_SERVER['REMOTE_ADDR'] . \" ( \" . $userdomain . \" )\" . '</td>",
        "// Line_Reference 234: \t\t\t\t\t\t\t<td>' . __('Using (user agent)', 'PlusCaptcha') . ':</td><td>' . plscptf_clean_input($_SERVER['HTTP_USER_AGENT']) . '</td>",
        "// Line_Reference 247: \t\t\t\t\t\t<td width=\"160\">' . __(\"Name\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_name'] . '</td>",
        "// Line_Reference 250: \t\t\t\t\t\t<td>' . __(\"Email\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_email'] . '</td>",
        "// Line_Reference 253: \t\t\t\t\t\t<td>' . __(\"Subject\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_subject'] . '</td>",
        "// Line_Reference 256: \t\t\t\t\t\t<td>' . __(\"Message\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_message'] . '</td>",
        "// Line_Reference 275:         $headers .= 'From: ' . $_REQUEST['plscptf_contact_email'] . \"\\r\\n\";",
        "// Line_Reference 276:         if (isset($_REQUEST['plscptf_contact_send_copy']) && $_REQUEST['plscptf_contact_send_copy'] == 1)",
        "// Line_Reference 277:           wp_mail($_REQUEST['plscptf_contact_email'], stripslashes($subject), stripslashes($message), $headers, $attachments);",
        "// Line_Reference 288:         $headers .= 'From: ' . $_REQUEST['plscptf_contact_email'] . \"\\r\\n\";",
        "// Line_Reference 289:         if (isset($_REQUEST['plscptf_contact_send_copy']) && $_REQUEST['plscptf_contact_send_copy'] == 1)",
        "// Line_Reference 290:           @mail($_REQUEST['plscptf_contact_email'], stripslashes($subject), stripslashes($message), $headers);"
    ]
}
