def self.using(file, name)
new(file, name)
def initialize(file, name)
Paperclip.log("Content Type Spoof: Filename #{File.basename(@name)} (#{supplied_file_content_types}), content type discovered from file command: #{calculated_content_type}. See documentation to allow this combination.")
! supplied_file_media_types.include?(calculated_media_type)
def supplied_file_media_types
@supplied_file_media_types ||= MIME::Types.type_for(@name).collect(&:media_type)
def calculated_media_type
@calculated_media_type ||= calculated_content_type.split("/").first
def supplied_file_content_types
@supplied_file_content_types ||= MIME::Types.type_for(@name).collect(&:content_type)
def calculated_content_type
@calculated_content_type ||= type_from_file_command.chomp
def mapped_content_type
Paperclip.options[:content_type_mappings][filename_extension]
def filename_extension
File.extname(@name.to_s.downcase).sub(/^\./, '').to_sym