if ( ! AddToBuffer(endp, PSEUDO_APP_LAYER_INDEX, &data, &len) )
assert(endp->pkt_length);
if ( ! AddToBuffer(endp, n, &data, &len) )
bool DNP3_Base::AddToBuffer(Endpoint* endp, int target_len, const u_char** data, int* len)
return true;
return endp->buffer_len == target_len;
assert(data + n < endp->buffer + endp->buffer_len);