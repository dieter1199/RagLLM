* @author        Nils Laumaillé
* @copyright     (c) 2009-2014 Nils Laumaillé
$row = $db->fetchRow("SELECT email FROM ".$pre."users WHERE id=".$dataReceived['user_id']);
$data = $db->fetchRow(
"SELECT COUNT(*) FROM ".$pre."users WHERE email = '".
mysql_real_escape_string(stripslashes(($_POST['email'])))."'"
"&login=".$_POST['login']."\">".$_SESSION['settings']['cpassman_url'].
"/index.php?action=password_recovery&key=".$key."&login=".$_POST['login']."</a>.<br><br>".$txt['thku'];
$textMailAlt = $txt['forgot_pw_email_altbody_1']." ".$txt['at_login']." : ".$data['login']." - ".
mysql_real_escape_string(stripslashes(($_POST['email'])))."'"
$data = $db->fetchRow(
"SELECT COUNT(*) FROM ".$pre."misc WHERE intitule = '".
$_POST['login']."' AND type = 'password_recovery'"
'intitule' => $_POST['login']
'intitule' => $_POST['login'],
$data = $db->fetchRow(
$_POST['login']."' AND type = 'password_recovery'"
if ($_POST['key'] == $data[0]) {
"login = '".$_POST['login']."'"
'intitule' => $_POST['login'],
$dataUser = $db->queryFirst("SELECT email FROM ".$pre."users WHERE login = '".$_POST['login']."'");
'user_language' => $_POST['lang']
$_SESSION['user_language'] = $_POST['lang'];
$_SESSION['user_language'] = $_POST['lang'];
//Generate
$pwgen->setLength($_POST['length']);
$pwgen->setSecure($_POST['secure']);
$pwgen->setSymbols($_POST['symbols']);
$pwgen->setCapitalize($_POST['capitalize']);
$pwgen->setNumerals($_POST['numerals']);
echo Encryption\Crypt\aesctr::encrypt($pwgen->generate(), $_SESSION['key'], 256);
$sql = "SELECT * FROM ".$pre."users WHERE login = '".addslashes($_POST['userId'])."'";
$data = $db->fetchArray($row);