{
    "cve_id": "CVE-2014-125048",
    "cve_description": "A vulnerability, which was classified as critical, has been found in kassi xingwall. This issue affects some unknown processing of the file app/controllers/oauth.js. The manipulation leads to session fixiation. The patch is named e9f0d509e1408743048e29d9c099d36e0e1f6ae7. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217559.",
    "cve_publish_date": "2023-01-06",
    "cwe_id": "CWE-384",
    "cwe_name": "Session Fixation",
    "cwe_description": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
    "commit_message": "Regenerate session after XING login to fix \"session fixation\" vulnerability",
    "type_of_change": "Modification",
    "filename_of_changes": "oauth.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "51",
    "number_of_lines_deleted_vulnerable_to_cve": "45",
    "vulnerable_lines": [
        "// Line_Reference 38:         res.cookie('requestToken', null); // delete cookie",
        "// Line_Reference 39: ",
        "// Line_Reference 40:         var client = xingApi.client(oauthToken, oauthTokenSecret);",
        "// Line_Reference 41: ",
        "// Line_Reference 42:         client.get('/v1/users/me', function (error, response) {",
        "// Line_Reference 43:           var user = JSON.parse(response).users[0];",
        "// Line_Reference 44: ",
        "// Line_Reference 45:           Wall.findOne({ _id: req.query.wall_id }).exec()",
        "// Line_Reference 46:             .then(function (wall) {",
        "// Line_Reference 47: ",
        "// Line_Reference 48:               var profile = new Profile({",
        "// Line_Reference 49:                 userId: user.id,",
        "// Line_Reference 50:                 displayName: user.display_name,",
        "// Line_Reference 51:                 photoUrls: {",
        "// Line_Reference 52:                   size_128x128: user.photo_urls.size_128x128,",
        "// Line_Reference 53:                   size_256x256: user.photo_urls.size_256x256",
        "// Line_Reference 54:                 }",
        "// Line_Reference 55:               }).toObject();",
        "// Line_Reference 56: ",
        "// Line_Reference 57:               delete profile._id; // make sure that we don't overwrite the internal _id on an update",
        "// Line_Reference 58: ",
        "// Line_Reference 59:               Profile.findOneAndUpdate({ userId: user.id }, profile, { upsert: true }).exec()",
        "// Line_Reference 60:                 .then(function (profile) {",
        "// Line_Reference 61:                   wall.profiles.pull(profile._id);",
        "// Line_Reference 62:                   wall.profiles.push(profile._id);",
        "// Line_Reference 63: ",
        "// Line_Reference 64:                   wall.save(function (err) {",
        "// Line_Reference 65:                     if (err) {",
        "// Line_Reference 66:                       console.error(err);",
        "// Line_Reference 67:                       res.render('error');",
        "// Line_Reference 68:                     } else {",
        "// Line_Reference 69:                       req.session.user = {",
        "// Line_Reference 70:                         id: profile._id,",
        "// Line_Reference 71:                         oauthToken: oauthToken,",
        "// Line_Reference 72:                         oauthTokenSecret: oauthTokenSecret",
        "// Line_Reference 73:                       };",
        "// Line_Reference 74: ",
        "// Line_Reference 75:                       io.emit('profiles:updated');",
        "// Line_Reference 76:                       res.render('oauth/callback', { url: \"/walls/\" + req.query.wall_id });",
        "// Line_Reference 77:                     }",
        "// Line_Reference 79:                 });",
        "// Line_Reference 80: ",
        "// Line_Reference 81:             }, function (err) {",
        "// Line_Reference 82:               console.log(err);",
        "// Line_Reference 83:             });"
    ]
}
