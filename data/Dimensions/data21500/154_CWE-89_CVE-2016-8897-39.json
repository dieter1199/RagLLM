{
    "cve_id": "CVE-2016-8897",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a sql injection vulnerability in framework/modules/help/controllers/helpController.php.",
    "cve_publish_date": "2019-05-23",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "pixidouController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 25: //    public $cacheDir = \"framework/modules/pixidou/images/\";",
        "// Line_Reference 28:         'editor',",
        "// Line_Reference 29:         'exitEditor'",
        "// Line_Reference 43: ",
        "// Line_Reference 45: ",
        "// Line_Reference 46:         $canSaveOg = $user->id==$file->poster || $user->is_admin ? 1 : 0 ;",
        "// Line_Reference 47: \t    if (file_exists(BASE.$file->directory.$file->filename)) {",
        "// Line_Reference 48: \t\t\t$file->copyToDirectory(BASE.$this->cacheDir);",
        "// Line_Reference 55: \t\t    flash('error',gt('The file').' \"'.BASE.$file->directory.$file->filename.'\" '.gt('does not exist on the server.'));",
        "// Line_Reference 56: \t\t    redirect_to(array(\"controller\"=>'file',\"action\"=>'picker',\"ajax_action\"=>1,\"update\"=>$this->params['update'],\"filter\"=>$this->params['filter']));",
        "// Line_Reference 59: ",
        "// Line_Reference 68:                 $oldimage = new expFile($this->params['fid']);",
        "// Line_Reference 69:                 $copyname = expFile::resolveDuplicateFilename($oldimage->path);",
        "// Line_Reference 70:                 copy(BASE.$this->cacheDir.\"/\".$this->params['cpi'],$oldimage->directory.$copyname); //copy the edited file over to the files dir",
        "// Line_Reference 77:                 $newFile->filesize = filesize(BASE.$this->cacheDir.\"/\".$this->params['cpi']);",
        "// Line_Reference 78:                 $resized = getimagesize(BASE.$this->cacheDir.\"/\".$this->params['cpi']);",
        "// Line_Reference 89:                 $resized = getimagesize(BASE.$this->cacheDir.\"/\".$this->params['cpi']);",
        "// Line_Reference 93:                 copy(BASE.$this->cacheDir.\"/\".$this->params['cpi'],$oldimage->directory.$oldimage->filename); //copy the edited file over to the files dir",
        "// Line_Reference 95: ",
        "// Line_Reference 101:         $types = array(\".jpg\",\".gif\",\".png\");",
        "// Line_Reference 102: ",
        "// Line_Reference 104:         $cachedir = BASE.$this->cacheDir;",
        "// Line_Reference 105: ",
        "// Line_Reference 109:                 if (in_array(substr($tmpfile,-4,4),$types)) {",
        "// Line_Reference 110:                     $filename = $cachedir.$tmpfile;",
        "// Line_Reference 115: ",
        "// Line_Reference 116:         redirect_to(array(\"controller\"=>'file',\"action\"=>'picker',\"ajax_action\"=>1,\"update\"=>$this->params['update'],\"filter\"=>$this->params['filter']));",
        "// Line_Reference 118: ",
        "// Line_Reference 121: ?>"
    ]
}
