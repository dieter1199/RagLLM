{
    "cve_id": "CVE-2015-10109",
    "cve_description": "A vulnerability was found in Video Playlist and Gallery Plugin up to 1.136 on WordPress. It has been rated as problematic. Affected by this issue is some unknown functionality of the file wp-media-cincopa.php. The manipulation leads to cross-site request forgery. The attack may be launched remotely. Upgrading to version 1.137 is able to address this issue. The name of the patch is ee28e91f4d5404905204c43b7b84a8ffecad932e. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-230264.",
    "cve_publish_date": "2023-06-01",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Security exploit fixed\n\ngit-svn-id: https://plugins.svn.wordpress.org/video-playlist-and-gallery-plugin/trunk@1234565 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "wp-media-cincopa.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "50",
    "vulnerable_lines": [
        "// Line_Reference 7: Version: 1.136",
        "// Line_Reference 12: \treturn 'wp1.136';",
        "// Line_Reference 13: }",
        "// Line_Reference 14: ",
        "// Line_Reference 15: function _cpmp_afc()",
        "// Line_Reference 16: {",
        "// Line_Reference 17: \t$cincopa_afc = get_site_option('CincopaAFC');",
        "// Line_Reference 18: ",
        "// Line_Reference 19: \tif ($cincopa_afc == '')",
        "// Line_Reference 20: \t\treturn '';",
        "// Line_Reference 21: ",
        "// Line_Reference 22: \treturn '&afc='.$cincopa_afc;",
        "// Line_Reference 32: \theader('Location: '._cpmp_url().'/media-platform/start.aspx?ver='._cpmp_plugin_ver()._cpmp_afc().'&rdt='.urlencode(_cpmp_selfURL()));",
        "// Line_Reference 97:     <iframe src=\"<?php echo _cpmp_url().'/media-platform/start.aspx?ver='._cpmp_plugin_ver()._cpmp_afc().'&rdt='.urlencode(_cpmp_selfURL().\"&\")?>&\" width=\"100%\" height=\"98%\"></iframe>",
        "// Line_Reference 458: \techo \"<iframe src='//www.cincopa.com/media-platform/wordpress-dashboard-content.aspx?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='100%' height='370px' scrolling='no'></iframe>\";",
        "// Line_Reference 478: ",
        "// Line_Reference 483: ",
        "// Line_Reference 491: ",
        "// Line_Reference 493: ",
        "// Line_Reference 495: ",
        "// Line_Reference 497: ",
        "// Line_Reference 499: ",
        "// Line_Reference 520: \t$cincopa_afc = get_site_option('CincopaAFC');",
        "// Line_Reference 535: \t\t\tif (isset($_POST['cincopaafc']))",
        "// Line_Reference 536: \t\t\t{",
        "// Line_Reference 537: \t\t\t\t$cincopa_afc = $_POST['cincopaafc'];",
        "// Line_Reference 538: \t\t\t\tupdate_site_option('CincopaAFC', $cincopa_afc);",
        "// Line_Reference 539: \t\t\t}",
        "// Line_Reference 606: \t\t\t\t\t\t\t\t\t\t\t<label for=\"cincopaafc\">",
        "// Line_Reference 648: \t\t\t\t\t\t\t\t\t<tr style=\"width:100%;\">",
        "// Line_Reference 649: \t\t\t\t\t\t\t\t\t\t<th valign=\"top\" scrope=\"row\">",
        "// Line_Reference 650: \t\t\t\t\t\t\t\t\t\t\t<label for=\"cincopaafc\">",
        "// Line_Reference 651: \t\t\t\t\t\t\t\t\t\t\t\tCincopa AFC (<a target=\"_blank\" href=\"//help.cincopa.com/entries/448859-wordpress-plugin-settings-page#afc\">what?</a>):",
        "// Line_Reference 652: \t\t\t\t\t\t\t\t\t\t\t</label>",
        "// Line_Reference 653: \t\t\t\t\t\t\t\t\t\t</th>",
        "// Line_Reference 654: \t\t\t\t\t\t\t\t\t\t<td valign=\"top\">",
        "// Line_Reference 655: \t\t\t\t\t\t\t\t\t\t\t<input id=\"cincopaafc\" name=\"cincopaafc\" type=\"text\" size=\"20\" value=\"<?php echo $cincopa_afc; ?>\"/>",
        "// Line_Reference 656: \t\t\t\t\t\t\t\t\t\t</td>",
        "// Line_Reference 657: \t\t\t\t\t\t\t\t\t</tr>",
        "// Line_Reference 658: ",
        "// Line_Reference 659: ",
        "// Line_Reference 660: ",
        "// Line_Reference 661: ",
        "// Line_Reference 662: ",
        "// Line_Reference 743:     echo \"<div style='clear: both;'></div><iframe style='position: fixed; left: 165px;' src='//www.cincopa.com/media-platform/start.aspx?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='88%' height='100%'></iframe>\";",
        "// Line_Reference 747:     //echo \"<iframe src='//www.cincopa.com/media-platform/wizard_name.aspx?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='98%' height='2000px'></iframe>\";",
        "// Line_Reference 748:     echo \"<div style='clear: both;'></div><iframe style='position: fixed; left: 165px;' src='//www.cincopa.com/media-platform/start.aspx?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='88%' height='100%'></iframe>\";",
        "// Line_Reference 752:     echo \"<div style='clear: both;'></div><iframe style='position: fixed; left: 165px;' src='//www.cincopa.com/media-platform/wizard_edit15?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='88%' height='100%'></iframe>\";",
        "// Line_Reference 756:     echo \"<div style='clear: both;'></div><iframe style='position: fixed; left: 165px;' src='//www.cincopa.com/media-platform/wizard2/library15?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='88%' height='100%'></iframe>\";",
        "// Line_Reference 760:     echo \"<div style='clear: both;'></div><iframe style='position: fixed; left: 165px;' src='//www.cincopa.com/cincopaManager/manageaccount.aspx?ver=\"._cpmp_plugin_ver()._cpmp_afc().\"&src=\".urlencode(_cpmp_selfURL()).\"' width='88%' height='100%'></iframe>\";"
    ]
}
