{
    "cve_id": "CVE-2017-6087",
    "cve_description": "EyesOfNetwork (\"EON\") 5.0 and earlier allows remote authenticated users to execute arbitrary code via shell metacharacters in the selected_events[] parameter in the (1) acknowledge, (2) delete, or (3) ownDisown function in module/monitoring_ged/ged_functions.php or the (4) module parameter to module/index.php.",
    "cve_publish_date": "2017-03-24",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Fix vulnerabilities",
    "type_of_change": "Modification",
    "filename_of_changes": "auto_completion.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 2:   // Mot tapé par l'utilisateur",
        "// Line_Reference 3:   $q = $_GET['query'];",
        "// Line_Reference 4: \t$table_name = $_GET['table_name'];",
        "// Line_Reference 6:     try {",
        "// Line_Reference 7:         $bdd = new PDO('mysql:host=localhost;dbname=lilac', 'root', 'root66');",
        "// Line_Reference 8:     } catch(Exception $e) {",
        "// Line_Reference 9: \t\t echo \"Connection failed: \" . $e->getMessage();",
        "// Line_Reference 10:         exit('Impossible de se connecter à la base de données.');",
        "// Line_Reference 11:     }",
        "// Line_Reference 13:     // Requête SQL",
        "// Line_Reference 14:     $requete = \"SELECT name FROM \" . $table_name .  \" WHERE name LIKE '\". $q .\"%' LIMIT 0, 10\";",
        "// Line_Reference 16: \tforeach  ($bdd->query($requete) as $row) {",
        "// Line_Reference 17: \t\t$suggestions['suggestions'][] = $row['name'];",
        "// Line_Reference 18: \t}",
        "// Line_Reference 19:     echo json_encode($suggestions);"
    ]
}
