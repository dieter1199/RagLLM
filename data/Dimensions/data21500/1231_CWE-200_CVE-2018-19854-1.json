{
    "cve_id": "CVE-2018-19854",
    "cve_description": "An issue was discovered in the Linux kernel before 4.19.3. crypto_report_one() and related functions in crypto/crypto_user.c (the crypto user configuration API) do not fully initialize structures that are copied to userspace, potentially leaking sensitive memory to user programs. NOTE: this is a CVE-2013-2547 regression but with easier exploitability because the attacker does not need a capability (however, the system must have the CONFIG_CRYPTO_USER kconfig option).",
    "cve_publish_date": "2018-12-04",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "crypto: user - fix leaking uninitialized memory to userspace\n\nAll bytes of the NETLINK_CRYPTO report structures must be initialized,\nsince they are copied to userspace.  The change from strncpy() to\nstrlcpy() broke this.  As a minimal fix, change it back.\n\nFixes: 4473710df1f8 (\"crypto: user - Prepare for CRYPTO_MAX_ALG_NAME expansion\")\nCc: <stable@vger.kernel.org> # v4.12+\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
    "type_of_change": "Modification",
    "filename_of_changes": "crypto_user_base.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 87: \tstrlcpy(rcipher.type, \"cipher\", sizeof(rcipher.type));",
        "// Line_Reference 106: \tstrlcpy(rcomp.type, \"compression\", sizeof(rcomp.type));",
        "// Line_Reference 120: \tstrlcpy(racomp.type, \"acomp\", sizeof(racomp.type));",
        "// Line_Reference 135: \tstrlcpy(rakcipher.type, \"akcipher\", sizeof(rakcipher.type));",
        "// Line_Reference 150: \tstrlcpy(rkpp.type, \"kpp\", sizeof(rkpp.type));",
        "// Line_Reference 164: \tstrlcpy(ualg->cru_name, alg->cra_name, sizeof(ualg->cru_name));",
        "// Line_Reference 165: \tstrlcpy(ualg->cru_driver_name, alg->cra_driver_name,",
        "// Line_Reference 167: \tstrlcpy(ualg->cru_module_name, module_name(alg->cra_module),",
        "// Line_Reference 180: \t\tstrlcpy(rl.type, \"larval\", sizeof(rl.type));"
    ]
}
