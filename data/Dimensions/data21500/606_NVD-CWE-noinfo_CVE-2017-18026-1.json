{
    "cve_id": "CVE-2017-18026",
    "cve_description": "Redmine before 3.2.9, 3.3.x before 3.3.6, and 3.4.x before 3.4.4 does not block the --config and --debugger flags to the Mercurial hg program, which allows remote attackers to execute arbitrary commands (through the Mercurial adapter) via vectors involving a branch whose name begins with a --config= or --debugger= substring, a related issue to CVE-2017-17536.",
    "cve_publish_date": "2018-01-10",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "mercurial: work around faulty parsing of early command options (#27516)\n\nUse -sVALUE and --long=VALUE instead of \"-s VALUE\" and \"--long VALUE\"\nrespectively.\n\nContributed by Yuya Nishihara.\n\ngit-svn-id: http://svn.redmine.org/redmine/trunk@17062 e93f8b46-1217-0410-a6f0-8f06a7374b81",
    "type_of_change": "Modification",
    "filename_of_changes": "mercurial_adapter.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 143:           manifest = hg('rhmanifest', '-r', CGI.escape(hgrev(identifier)),",
        "// Line_Reference 184:           hg_args = ['log', '--debug', '-C', '--style', self.class.template_path]",
        "// Line_Reference 185:           hg_args << '-r' << \"#{hgrev(identifier_from)}:#{hgrev(identifier_to)}\"",
        "// Line_Reference 186:           hg_args << '--limit' << options[:limit] if options[:limit]",
        "// Line_Reference 227:           hg_args = ['rhlog', '--template', '{node}\\n', '--rhbranch', CGI.escape(branch)]",
        "// Line_Reference 228:           hg_args << '--from' << CGI.escape(branch)",
        "// Line_Reference 229:           hg_args << '--to'   << '0'",
        "// Line_Reference 230:           hg_args << '--limit' << options[:limit] if options[:limit]",
        "// Line_Reference 237:             hg_args << '-r' << hgrev(identifier_to) << '-r' << hgrev(identifier_from)",
        "// Line_Reference 239:             hg_args << '-c' << hgrev(identifier_from)",
        "// Line_Reference 258:           hg 'rhcat', '-r', CGI.escape(hgrev(identifier)), '--', hgtarget(p) do |io|",
        "// Line_Reference 269:           hg 'rhannotate', '-ncu', '-r', CGI.escape(hgrev(identifier)), '--', hgtarget(p) do |io|",
        "// Line_Reference 307:           full_args = ['-R', repo_path, '--encoding', 'utf-8']"
    ]
}
