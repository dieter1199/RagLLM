{
    "cve_id": "CVE-2022-3152",
    "cve_description": "Unverified Password Change in GitHub repository phpfusion/phpfusion prior to 9.10.20.",
    "cve_publish_date": "2022-09-07",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "Security fixes\n\nSigned-off-by: deviance <meangczac.chan@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "UserFieldsInput.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 669:         $a_check = ($this->userData[\"user_password\"] != sanitizer(\"user_hash\", \"\", \"user_hash\"));",
        "// Line_Reference 670:         $b_check = ($this->userData['user_id'] != fusion_get_userdata('user_id'));",
        "// Line_Reference 671:         // for admin with sufficient rights, skip all these formats",
        "// Line_Reference 672:         if (iADMIN && checkrights(\"M\")) {",
        "// Line_Reference 673:             $a_check = FALSE;",
        "// Line_Reference 674:             $b_check = FALSE;",
        "// Line_Reference 675:         }",
        "// Line_Reference 676:         if ($a_check or $b_check) {",
        "// Line_Reference 677:             fusion_stop();"
    ]
}
