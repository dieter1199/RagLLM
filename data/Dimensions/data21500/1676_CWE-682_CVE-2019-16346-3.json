{
    "cve_id": "CVE-2019-16346",
    "cve_description": "ngiflib 0.4 has a heap-based buffer overflow in WritePixel() in ngiflib.c when called from DecodeGifImg, because deinterlacing for small pictures is mishandled.",
    "cve_publish_date": "2019-09-16",
    "cwe_id": "CWE-682",
    "cwe_name": "Incorrect Calculation",
    "cwe_description": "The product performs a calculation that generates incorrect or unintended results that are later used in security-critical decisions or resource management.",
    "commit_message": "fix deinterlacing for small pictures\n\nfixes #12",
    "type_of_change": "Modification",
    "filename_of_changes": "ngiflib.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 9:  * (c) 2004-2017 Thomas Bernard. All rights reserved",
        "// Line_Reference 138: \t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 139: \t\t\t\tcontext->pass++;",
        "// Line_Reference 140: \t\t\t\tcontext->curY = i->posY + 4;",
        "// Line_Reference 141: \t\t\t}",
        "// Line_Reference 145: \t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 146: \t\t\t\tcontext->pass++;",
        "// Line_Reference 147: \t\t\t\tcontext->curY = i->posY + 2;",
        "// Line_Reference 148: \t\t\t}",
        "// Line_Reference 152: \t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 153: \t\t\t\tcontext->pass++;",
        "// Line_Reference 154: \t\t\t\tcontext->curY = i->posY + 1;",
        "// Line_Reference 155: \t\t\t}",
        "// Line_Reference 252: \t\t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 253: \t\t\t\t\tcontext->pass++;",
        "// Line_Reference 254: \t\t\t\t\tcontext->curY = i->posY + 4;",
        "// Line_Reference 255: \t\t\t\t}",
        "// Line_Reference 259: \t\t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 260: \t\t\t\t\tcontext->pass++;",
        "// Line_Reference 261: \t\t\t\t\tcontext->curY = i->posY + 2;",
        "// Line_Reference 262: \t\t\t\t}",
        "// Line_Reference 266: \t\t\t\tif(context->curY >= p->height) {",
        "// Line_Reference 267: \t\t\t\t\tcontext->pass++;",
        "// Line_Reference 268: \t\t\t\t\tcontext->curY = i->posY + 1;",
        "// Line_Reference 269: \t\t\t\t}"
    ]
}
