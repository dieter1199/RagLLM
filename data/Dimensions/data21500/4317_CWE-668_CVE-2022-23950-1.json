{
    "cve_id": "CVE-2022-23950",
    "cve_description": "In Keylime before 6.3.0, Revocation Notifier uses a fixed /tmp path for UNIX domain socket which can allow unprivileged users a method to prohibit keylime operations.",
    "cve_publish_date": "2022-09-21",
    "cwe_id": "CWE-668",
    "cwe_name": "Exposure of Resource to Wrong Sphere",
    "cwe_description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.",
    "commit_message": "revocation_notifier: move zmq socket to /var/run/keylime\n\nCurrently we are placing the zmq IPC socket in /tmp, that can be\naccessed by all the users.\n\nThis patch moves the socket into /var/run/keylime, making sure that the\ndirectory is created and present with the correct user permissions.\n\nSigned-off-by: Alberto Planas <aplanas@suse.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "revocation_notifier.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 31:         frontend.bind(\"ipc:///tmp/keylime.verifier.ipc\")",
        "// Line_Reference 55:         if os.path.exists(\"/tmp/keylime.verifier.ipc\"):",
        "// Line_Reference 56:             os.remove(\"/tmp/keylime.verifier.ipc\")",
        "// Line_Reference 66:         mysock.connect(\"ipc:///tmp/keylime.verifier.ipc\")"
    ]
}
