{
    "cve_id": "CVE-2014-3772",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via a request to index.php followed by a direct request to a file that calls the session_start function before checking the CPM key, as demonstrated by a request to sources/upload/upload.files.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "2.1.20",
    "type_of_change": "Modification",
    "filename_of_changes": "kb.queries.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 18:         !isset($_SESSION['CPM']) || $_SESSION['CPM'] != 1 || !isset($_SESSION['key']) || empty($_SESSION['key'])",
        "// Line_Reference 19:         || !isset($_SESSION['settings']['enable_kb']) || $_SESSION['settings']['enable_kb'] != 1",
        "// Line_Reference 20: ) {",
        "// Line_Reference 72:                 $row = $db->query(\"SELECT anyone_can_modify, author_id FROM \".$pre.\"kb WHERE id = \".$id);",
        "// Line_Reference 73:                 $ret = $db->fetchArray($row);",
        "// Line_Reference 84:                 $data = $db->fetchRow(\"SELECT COUNT(*) FROM \".$pre.\"kb_categories WHERE category = '\".mysql_real_escape_string($category).\"'\");",
        "// Line_Reference 158:             $row = $db->query(",
        "// Line_Reference 159:                 \"SELECT k.id as id, k.label as label, k.description as description, k.category_id as category_id, k.author_id as author_id, k.anyone_can_modify as anyone_can_modify,",
        "// Line_Reference 160:                 u.login as login, c.category as category",
        "// Line_Reference 161:                 FROM \".$pre.\"kb as k",
        "// Line_Reference 162:                 INNER JOIN \".$pre.\"kb_categories as c ON (c.id = k.category_id)",
        "// Line_Reference 163:                 INNER JOIN \".$pre.\"users as u ON (u.id = k.author_id)",
        "// Line_Reference 164:                 WHERE k.id = '\".$_POST['id'].\"'\"",
        "// Line_Reference 166:             $ret = $db->fetchArray($row);"
    ]
}
