{
    "cve_id": "CVE-2012-3371",
    "cve_description": "The Nova scheduler in OpenStack Compute (Nova) Folsom (2012.2) and Essex (2012.1), when DifferentHostFilter or SameHostFilter is enabled, allows remote authenticated users to cause a denial of service (excessive database lookup calls and server hang) via a request with many repeated IDs in the os:scheduler_hints section.",
    "cve_publish_date": "2012-07-17",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Use compute_api.get_all in affinity filters.\n\nUpdates the affinity filters so they make a single compute API\ncall to lookup instance host information rather than single\nlookups for each UUID.\n\nThis resolves a potential performance issue which can cause a\nscheduler to hang while processing requests which contain large numbers\nof UUID's in the scheduler_hints.\n\nFixes LP Bug #1017795.\n\nChange-Id: I30f434faf109058573ee41c4a6abce2e48939e8d",
    "type_of_change": "Modification",
    "filename_of_changes": "affinity_filter.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 28:     def _affinity_host(self, context, instance_id):",
        "// Line_Reference 29:         return self.compute_api.get(context, instance_id)['host']",
        "// Line_Reference 45:                               if self._affinity_host(context, i) == me])",
        "// Line_Reference 66:                           if self._affinity_host(context, i) == me])"
    ]
}
