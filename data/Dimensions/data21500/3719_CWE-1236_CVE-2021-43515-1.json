{
    "cve_id": "CVE-2021-43515",
    "cve_description": "CSV Injection (aka Excel Macro Injection or Formula Injection) exists in creating new timesheet in Kimai. By filling the Description field with malicious payload, it will be mistreated while exporting to a CSV file.",
    "cve_publish_date": "2022-04-08",
    "cwe_id": "CWE-1236",
    "cwe_name": "Improper Neutralization of Formula Elements in a CSV File",
    "cwe_description": "The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.",
    "commit_message": "version 1.14.1 (#2532)\n\n* no back links in modal pages\r\n* remove unused service links to bountysource and gitter\r\n* add validation for budget and time-budget fields\r\n* display time budget if set\r\n* remove console log\r\n* sanitize DDE payloads\r\n* do not show status and name in version string",
    "type_of_change": "Modification",
    "filename_of_changes": "AbstractSpreadsheetRenderer.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 345:             $columns['description']['render'] = function (Worksheet $sheet, int $row, int $column, ExportItemInterface $entity) use (&$isColumnFormatted, $maxWidth, $wrapText) {",
        "// Line_Reference 348:                 $cell->setValueExplicit($entity->getDescription(), DataType::TYPE_STRING);",
        "// Line_Reference 358:                         $sheet->getColumnDimensionByColumn($column)",
        "// Line_Reference 359:                             ->setWidth($maxWidth);"
    ]
}
