{
    "cve_id": "CVE-2022-3971",
    "cve_description": "A vulnerability was found in matrix-appservice-irc up to 0.35.1. It has been declared as critical. This vulnerability affects unknown code of the file src/datastore/postgres/PgDataStore.ts. The manipulation of the argument roomIds leads to sql injection. Upgrading to version 0.36.0 is able to address this issue. The name of the patch is 179313a37f06b298150edba3e2b0e5a73c1415e7. It is recommended to upgrade the affected component. VDB-213550 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2022-11-13",
    "cwe_id": "CWE-707",
    "cwe_name": "Improper Neutralization",
    "cwe_description": "The product does not ensure or incorrectly ensures that structured messages or data are well-formed and that certain security properties are met before being read from an upstream component or sent to a downstream component.",
    "commit_message": "Prevent low-risk SQL injection from roomId values when entered into the config (#1619)\n\n* Prevent SQL injection from roomId values when checking room visibility\r\n\r\n* Add newsfile\r\n\r\n* Update newsfile\r\n\r\n* Update 1619.bugfix\r\n\r\nCo-authored-by: Will Hunt <will@half-shot.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "PgDataStore.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 664:         const list = `('${roomIds.join(\"','\")}')`;",
        "// Line_Reference 665:         const res = await this.pgPool.query(`SELECT room_id, visibility FROM room_visibility WHERE room_id IN ${list}`);"
    ]
}
