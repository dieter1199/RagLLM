{
    "cve_id": "CVE-2011-1768",
    "cve_description": "The tunnels implementation in the Linux kernel before 2.6.34, when tunnel functionality is configured as a module, allows remote attackers to cause a denial of service (OOPS) by sending a packet during module loading.",
    "cve_publish_date": "2012-06-13",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "tunnels: fix netns vs proto registration ordering\n\nSame stuff as in ip_gre patch: receive hook can be called before netns\nsetup is done, oopsing in net_generic().\n\nSigned-off-by: Alexey Dobriyan <adobriyan@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfrm6_tunnel.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 87: ",
        "// Line_Reference 88: static int __init xfrm6_tunnel_spi_init(void)",
        "// Line_Reference 89: {",
        "// Line_Reference 90: \txfrm6_tunnel_spi_kmem = kmem_cache_create(\"xfrm6_tunnel_spi\",",
        "// Line_Reference 91: \t\t\t\t\t\t  sizeof(struct xfrm6_tunnel_spi),",
        "// Line_Reference 92: \t\t\t\t\t\t  0, SLAB_HWCACHE_ALIGN,",
        "// Line_Reference 93: \t\t\t\t\t\t  NULL);",
        "// Line_Reference 94: \tif (!xfrm6_tunnel_spi_kmem)",
        "// Line_Reference 95: \t\treturn -ENOMEM;",
        "// Line_Reference 96: \treturn 0;",
        "// Line_Reference 97: }",
        "// Line_Reference 98: ",
        "// Line_Reference 99: static void xfrm6_tunnel_spi_fini(void)",
        "// Line_Reference 100: {",
        "// Line_Reference 101: \tkmem_cache_destroy(xfrm6_tunnel_spi_kmem);",
        "// Line_Reference 102: }",
        "// Line_Reference 103: ",
        "// Line_Reference 380: \t\tgoto err;",
        "// Line_Reference 383: \t\tgoto unreg;",
        "// Line_Reference 386: \t\tgoto dereg6;",
        "// Line_Reference 387: \trv = xfrm6_tunnel_spi_init();",
        "// Line_Reference 388: \tif (rv < 0)",
        "// Line_Reference 389: \t\tgoto dereg46;",
        "// Line_Reference 390: \trv = register_pernet_subsys(&xfrm6_tunnel_net_ops);",
        "// Line_Reference 391: \tif (rv < 0)",
        "// Line_Reference 392: \t\tgoto deregspi;",
        "// Line_Reference 395: deregspi:",
        "// Line_Reference 396: \txfrm6_tunnel_spi_fini();",
        "// Line_Reference 397: dereg46:",
        "// Line_Reference 398: \txfrm6_tunnel_deregister(&xfrm46_tunnel_handler, AF_INET);",
        "// Line_Reference 399: dereg6:",
        "// Line_Reference 401: unreg:",
        "// Line_Reference 403: err:",
        "// Line_Reference 409: \tunregister_pernet_subsys(&xfrm6_tunnel_net_ops);",
        "// Line_Reference 410: \txfrm6_tunnel_spi_fini();"
    ]
}
