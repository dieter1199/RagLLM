{
    "cve_id": "CVE-2022-4366",
    "cve_description": "Missing Authorization in GitHub repository lirantal/daloradius prior to master branch.",
    "cve_publish_date": "2022-12-08",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: introduced security fixes (#263)\n\n- dologin.php - validating user input and introduced CSRF token check\r\n- logging.php - preventing direct access to this file, which means redirecting to index.php when directly hitting this include file, (repeated for other exten. / include / etc. files), and optimized logging features\r\n- actionMessages.php and errorHandling.php same as logging.php\r\n- library/exten-* files - preventing direct access to these files, generalized the approach of looking for known file locations, improved user input validation (params such as limit, etc.), improved output (escaping logfile output, etc.)\r\n- in library/exten-server_info.php - i also have added new commands for retrieving network information and system distro/version\r\n- opendb.php - general code optimization (TODO prevent direct access to this file)\r\n- sessions.php - introduced new session handling (TODO prevent direct access to this file)\r\n- login.php - removed the default username hardcoded in the form, added the csrf_token\r\n- rep-* - user input validation, code optimization",
    "type_of_change": "Modification",
    "filename_of_changes": "rep-stat-raid.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "69",
    "number_of_lines_deleted_vulnerable_to_cve": "94",
    "vulnerable_lines": [
        "// Line_Reference 17: *",
        "// Line_Reference 18:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 28: \tinclude_once('library/config_read.php');",
        "// Line_Reference 33: ",
        "// Line_Reference 34: ?>",
        "// Line_Reference 35: ",
        "// Line_Reference 36: ",
        "// Line_Reference 37: <?php",
        "// Line_Reference 38: \tinclude_once (\"library/tabber/tab-layout.php\");",
        "// Line_Reference 39: ?>",
        "// Line_Reference 40: <?php",
        "// Line_Reference 41: ",
        "// Line_Reference 43: ",
        "// Line_Reference 44: ?>",
        "// Line_Reference 45: ",
        "// Line_Reference 46: ",
        "// Line_Reference 47: \t\t<div id=\"contentnorightbar\">",
        "// Line_Reference 48: ",
        "// Line_Reference 49: \t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\">RAID Status",
        "// Line_Reference 50: \t\t<h144>&#x2754;</h144></a></h2>",
        "// Line_Reference 51: ",
        "// Line_Reference 52: \t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >",
        "// Line_Reference 53: \t\t\t<br/>",
        "// Line_Reference 54: \t\t</div>",
        "// Line_Reference 55: \t\t<br/>",
        "// Line_Reference 56: ",
        "// Line_Reference 57: ",
        "// Line_Reference 58: ",
        "// Line_Reference 59: <div class=\"tabber\">",
        "// Line_Reference 60: ",
        "// Line_Reference 63: ",
        "// Line_Reference 64: \tif (!file_exists('/proc/mdstat')):",
        "// Line_Reference 65: ?>",
        "// Line_Reference 66: \t<font color='red'><b>Error</b> accessing RAID device information:</font>",
        "// Line_Reference 67: \t<br/><br/>",
        "// Line_Reference 68: ",
        "// Line_Reference 69: <?php",
        "// Line_Reference 70: \telse:",
        "// Line_Reference 71: \texec(\"cat /proc/mdstat  | awk '/md/ {print $1}'\", $mdstat);",
        "// Line_Reference 74: ",
        "// Line_Reference 75: \t<font color='red'><b>Error</b> accessing RAID device information:</font>",
        "// Line_Reference 76: \t<br/><br/>",
        "// Line_Reference 77: ",
        "// Line_Reference 78: \t<?php",
        "// Line_Reference 79: \t\tforeach($mdstat as $mddevice):",
        "// Line_Reference 80: \t?>",
        "// Line_Reference 81: ",
        "// Line_Reference 82: \t\t\t<div class=\"tabbertab\" title=\"<?php echo $mddevice ?>\">",
        "// Line_Reference 83: ",
        "// Line_Reference 84: \t\t\t\t<?php",
        "// Line_Reference 85: \t\t\t\t\t$output = \"\";",
        "// Line_Reference 86: \t\t\t\t\t$cmd = \"sudo /sbin/mdadm --detail /dev/$mddevice\";",
        "// Line_Reference 87: \t\t\t\t\texec($cmd, $output);",
        "// Line_Reference 88: \t\t\t\t?>",
        "// Line_Reference 89: ",
        "// Line_Reference 90: \t\t\t\t<table class='summarySection'>",
        "// Line_Reference 91: ",
        "// Line_Reference 92: \t\t\t\t\t<?php",
        "// Line_Reference 93: \t\t\t\t\t\tforeach($output as $line):",
        "// Line_Reference 94: \t\t\t\t\t?>",
        "// Line_Reference 95: ",
        "// Line_Reference 96: \t\t\t\t\t<?php",
        "// Line_Reference 97: \t\t\t\t\t\tlist($var, $val) = split(\":\", $line);",
        "// Line_Reference 98: \t\t\t\t\t?>",
        "// Line_Reference 99: ",
        "// Line_Reference 100: \t\t\t\t\t  <tr>",
        "// Line_Reference 101: \t\t\t\t\t\t<td class='summaryKey'> <?php echo $var ?> </td>",
        "// Line_Reference 102: \t\t\t\t\t\t<td class='summaryValue'><span class='sleft'> <?php echo $val ?> </span> </td>",
        "// Line_Reference 103: \t\t\t\t\t  </tr>",
        "// Line_Reference 104: ",
        "// Line_Reference 105: \t\t\t\t\t<?php endforeach; ?>",
        "// Line_Reference 106: ",
        "// Line_Reference 107: \t\t\t\t</table>",
        "// Line_Reference 108: ",
        "// Line_Reference 109: \t\t\t</div>",
        "// Line_Reference 110: ",
        "// Line_Reference 111: \t<?php endforeach; ?>",
        "// Line_Reference 112: <?php endif; ?>",
        "// Line_Reference 113: ",
        "// Line_Reference 114: </div>",
        "// Line_Reference 115: ",
        "// Line_Reference 116: ",
        "// Line_Reference 117: ",
        "// Line_Reference 118: ",
        "// Line_Reference 119: \t\t</div>",
        "// Line_Reference 120: ",
        "// Line_Reference 121: \t\t<div id=\"footer\">",
        "// Line_Reference 122: ",
        "// Line_Reference 124:         include 'page-footer.php';",
        "// Line_Reference 126: ",
        "// Line_Reference 127: \t\t</div>",
        "// Line_Reference 128: ",
        "// Line_Reference 129: </div>",
        "// Line_Reference 132: "
    ]
}
