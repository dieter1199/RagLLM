{
    "cve_id": "CVE-2014-5471",
    "cve_description": "Stack consumption vulnerability in the parse_rock_ridge_inode_internal function in fs/isofs/rock.c in the Linux kernel through 3.16.1 allows local users to cause a denial of service (uncontrolled recursion, and system crash or reboot) via a crafted iso9660 image with a CL entry referring to a directory entry that has a CL entry.",
    "cve_publish_date": "2014-09-01",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "isofs: Fix unbounded recursion when processing relocated directories\n\nWe did not check relocated directory in any way when processing Rock\nRidge 'CL' tag. Thus a corrupted isofs image can possibly have a CL\nentry pointing to another CL entry leading to possibly unbounded\nrecursion in kernel code and thus stack overflow or deadlocks (if there\nis a loop created from CL entries).\n\nFix the problem by not allowing CL entry to point to a directory entry\nwith CL entry (such use makes no good sense anyway) and by checking\nwhether CL entry doesn't point to itself.\n\nCC: stable@vger.kernel.org\nReported-by: Chris Evans <cevans@google.com>\nSigned-off-by: Jan Kara <jack@suse.cz>",
    "type_of_change": "Modification",
    "filename_of_changes": "rock.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 293: \t\t\t\tstruct inode *inode, int regard_xa)",
        "// Line_Reference 308: \tif (regard_xa) {",
        "// Line_Reference 488: \t\t\tISOFS_I(inode)->i_first_extent =",
        "// Line_Reference 489: \t\t\t    isonum_733(rr->u.CL.location);",
        "// Line_Reference 490: \t\t\treloc =",
        "// Line_Reference 491: \t\t\t    isofs_iget(inode->i_sb,",
        "// Line_Reference 492: \t\t\t\t       ISOFS_I(inode)->i_first_extent,",
        "// Line_Reference 493: \t\t\t\t       0);",
        "// Line_Reference 640: int parse_rock_ridge_inode(struct iso_directory_record *de, struct inode *inode)",
        "// Line_Reference 642: \tint result = parse_rock_ridge_inode_internal(de, inode, 0);",
        "// Line_Reference 650: \t\tresult = parse_rock_ridge_inode_internal(de, inode, 14);"
    ]
}
