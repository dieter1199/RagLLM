{
    "cve_id": "CVE-2021-4123",
    "cve_description": "livehelperchat is vulnerable to Cross-Site Request Forgery (CSRF)",
    "cve_publish_date": "2021-12-16",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "CSRF minor fixes (#1726)\n\n* CSRF minor fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "user_box.tpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 30:                 <a title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/user_settings','Toggle between dark and white themes');?>\" href=\"<?php echo erLhcoreClassDesign::baseurl('front/switchdashboard')?>/(action)/mode\" class=\"dropdown-item pl-2\"><span class=\"material-icons\">settings_brightness</span><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('pagelayout/pagelayout','Dark/bright');?></a>",
        "// Line_Reference 33:                 <a class=\"dropdown-item pl-2\" onclick=\"$(this).attr('href',$(this).attr('href')+'/(csfr)/'+confLH.csrf_token)\" href=\"<?php echo erLhcoreClassDesign::baseurl('user/logout')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('pagelayout/pagelayout','Logout');?>\"><i class=\"material-icons\">exit_to_app</i><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('pagelayout/pagelayout','Logout');?></a>",
        "// Line_Reference 79:                     <a href=\"<?php echo erLhcoreClassDesign::baseurl('user/setsetting')?>/auto_uppercase/<?php echo erLhcoreClassModelUserSetting::getSetting('auto_uppercase',1) == 0 ? 1 : 0?>\" class=\"dropdown-item pl-2\"><span class=\"material-icons\"><?php erLhcoreClassModelUserSetting::getSetting('auto_uppercase',1) ? print 'check' : print 'remove_done'?></span><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('user/account','Auto uppercase sentences');?></a>",
        "// Line_Reference 82:                     <a href=\"<?php echo erLhcoreClassDesign::baseurl('user/setsetting')?>/no_scroll_bottom/<?php echo erLhcoreClassModelUserSetting::getSetting('no_scroll_bottom',0) == 0 ? 1 : 0?>\" class=\"dropdown-item pl-2\"><span class=\"material-icons\"><?php erLhcoreClassModelUserSetting::getSetting('no_scroll_bottom',0) ? print 'check' : print 'remove_done'?></span><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('user/account','Do not scroll to the bottom on chat open');?></a>",
        "// Line_Reference 85:                     <a href=\"<?php echo erLhcoreClassDesign::baseurl('user/setsetting')?>/auto_preload/<?php echo erLhcoreClassModelUserSetting::getSetting('auto_preload',0) == 0 ? 1 : 0?>\" class=\"dropdown-item pl-2\"><span class=\"material-icons\"><?php erLhcoreClassModelUserSetting::getSetting('auto_preload',0) ? print 'check' : print 'remove_done'?></span><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('user/account','Auto preload previous visitor chat messages');?></a>",
        "// Line_Reference 88:                     <a href=\"<?php echo erLhcoreClassDesign::baseurl('user/setsetting')?>/scroll_load/<?php echo erLhcoreClassModelUserSetting::getSetting('scroll_load',1) == 0 ? 1 : 0?>\" class=\"dropdown-item pl-2\"><span class=\"material-icons\"><?php erLhcoreClassModelUserSetting::getSetting('scroll_load',1) ? print 'check' : print 'remove_done'?></span><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('user/account','Load previous message on scroll');?></a>"
    ]
}
