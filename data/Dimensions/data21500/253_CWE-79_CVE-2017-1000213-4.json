{
    "cve_id": "CVE-2017-1000213",
    "cve_description": "WBCE v1.1.11 is vulnerable to reflected XSS via the \"begriff\" POST parameter in /admin/admintools/tool.php?tool=user_search",
    "cve_publish_date": "2017-11-17",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Update user search\n\nUpdate user search from 0.41 to 0.50",
    "type_of_change": "Modification",
    "filename_of_changes": "usersearch_result.htt",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "82",
    "number_of_lines_deleted_vulnerable_to_cve": "82",
    "vulnerable_lines": [
        "// Line_Reference 1: <h2>{HEADING_RESULT}</h2>",
        "// Line_Reference 2: <p>{HOWTO_RESULT}</p>",
        "// Line_Reference 3: <table width=\"98%\" cellspacing=\"0\" border=\"0\" cellpadding=\"5px\" class=\"row_a\">",
        "// Line_Reference 4: \t<tr>",
        "// Line_Reference 5: \t\t<td style=\"width: 220px;\"><strong>{SEARCH_DETAIL_RESULT}:</strong></td>",
        "// Line_Reference 6: \t\t<td><strong>&nbsp;</td>",
        "// Line_Reference 7: \t</tr>",
        "// Line_Reference 8: <!-- BEGIN searchterm_block -->",
        "// Line_Reference 9: \t<tr>",
        "// Line_Reference 10: \t\t<td>{SEARCH_ITEM_RESULT}:</td>",
        "// Line_Reference 11: \t\t<td>{BEGRIFF}</td>",
        "// Line_Reference 12: \t</tr>",
        "// Line_Reference 13: \t<tr>",
        "// Line_Reference 14: \t\t<td>{SEARCH_FIELD_RESULT}:</td>",
        "// Line_Reference 15: \t\t<td>{DISPLAYSEARCHFIELD}</td>",
        "// Line_Reference 16: \t</tr>",
        "// Line_Reference 17: <!-- END searchterm_block -->",
        "// Line_Reference 18: <!-- BEGIN group_block -->",
        "// Line_Reference 19: \t<tr>",
        "// Line_Reference 20: \t\t<td>{GROUP_RESULT}:</td>",
        "// Line_Reference 21: \t\t<td>{GROUP_NAME}</td>",
        "// Line_Reference 22: \t</tr>",
        "// Line_Reference 23: <!-- END group_block -->",
        "// Line_Reference 24: <!-- BEGIN last_login_block -->",
        "// Line_Reference 25: \t<tr>",
        "// Line_Reference 26: \t\t<td>{LAST_LOGIN}:</td>",
        "// Line_Reference 27: \t\t<td>{BEFORE_OR_AFTER} {DATE_RESULT}</td>",
        "// Line_Reference 28: \t</tr>",
        "// Line_Reference 29: <!-- END last_login_block -->",
        "// Line_Reference 30: \t<tr>",
        "// Line_Reference 31: \t\t<td colspan=\"2\"><br /><strong>{SHOW_RESULT}:</strong></td>",
        "// Line_Reference 32: \t</tr>",
        "// Line_Reference 33: ",
        "// Line_Reference 34: <!-- BEGIN no_result_block -->",
        "// Line_Reference 35: {NO_RESULT}",
        "// Line_Reference 36: <!-- END no_result_block -->",
        "// Line_Reference 37: <!-- BEGIN result_table_block -->",
        "// Line_Reference 38: <table width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\" style=\"border-collapse: collapse;\">",
        "// Line_Reference 39: \t<tr style=\"background-color: #BDCDD9;\">",
        "// Line_Reference 40: \t\t<td align=\"right\" style=\"font-weight:bold; border: 1px solid #ccc;\">ID</td>",
        "// Line_Reference 41: \t\t<td style=\"font-weight:bold; border: 1px solid #ccc;\">{USER_NAME}</td>",
        "// Line_Reference 42: \t\t<td style=\"font-weight:bold; border: 1px solid #ccc;\">{REAL_NAME}</td>",
        "// Line_Reference 43: \t\t<td style=\"font-weight:bold; border: 1px solid #ccc;\">{EMAIL}</td>",
        "// Line_Reference 44: \t\t<td style=\"font-weight:bold; border: 1px solid #ccc;\">{LAST_LOGIN}</td>",
        "// Line_Reference 45: \t\t<td style=\"font-weight:bold; border: 1px solid #ccc;\">{LAST_IP}</td>",
        "// Line_Reference 46: \t</tr>",
        "// Line_Reference 47: <!-- BEGIN result_list_block -->",
        "// Line_Reference 48: \t<tr style=\"background-color: {RESULT_BGCOL}\">",
        "// Line_Reference 49: \t\t<td align=\"center\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 50: \t\t\t<form name=\"edituser{RESULT_USER_ID}\" method=\"post\" action=\"{ADMIN_URL}/users/users.php\" target=\"_blank\">",
        "// Line_Reference 51: \t\t\t<input type=\"hidden\" name=\"user_id\" value=\"{IDKEY_USER_ID}\" />",
        "// Line_Reference 52: \t\t\t<input type=\"hidden\" name=\"modify\" value=\"modify\" />",
        "// Line_Reference 53: \t\t\t<input type=\"hidden\" name=\"details\" value=\"{RESULT_USER_ID}\" />",
        "// Line_Reference 54: \t\t\t<b>{RESULT_USER_ID}</b>",
        "// Line_Reference 55: \t\t\t</form>",
        "// Line_Reference 56: \t\t</td>",
        "// Line_Reference 57: \t\t<td align=\"left\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 58: \t\t\t<a OnClick=\"javascript:if ({RESULT_USER_ID}!=1) { document.edituser{RESULT_USER_ID}.submit();} else {alert('{RESULT_ADMIN_DISABLED}');}; return false;\" HREF=\"#\" title=\"{RESULT_EDIT_USER}: {RESULT_DISPLAYNAME}\">{RESULT_USERNAME}</a>",
        "// Line_Reference 59: \t\t</td>",
        "// Line_Reference 60: \t\t<td align=\"left\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 61: \t\t{RESULT_DISPLAYNAME}",
        "// Line_Reference 62: \t\t</td>",
        "// Line_Reference 63: \t\t<td align=\"left\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 64: \t\t\t<a href=\"mailto:{RESULT_EMAIL}\">{RESULT_EMAIL}</a>",
        "// Line_Reference 65: \t\t</td>",
        "// Line_Reference 66: \t\t<td align=\"left\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 67: \t\t{RESULT_LASTLOGIN}/({RESULT_DAYS_INACTIVE})",
        "// Line_Reference 68: \t\t</td>",
        "// Line_Reference 69: \t\t<td align=\"left\" style=\"border: 1px solid #ccc;\">",
        "// Line_Reference 70: \t\t{RESULT_LAST_IP}",
        "// Line_Reference 71: \t\t</td>",
        "// Line_Reference 72: \t</tr>",
        "// Line_Reference 73: <!-- END result_list_block -->",
        "// Line_Reference 74: \t<tr>",
        "// Line_Reference 75: \t\t<td colspan=\"6\" style=\"font-size:smaller;\" align=\"center\">{HINT_EDIT}</td>",
        "// Line_Reference 76: \t</tr>",
        "// Line_Reference 77: </table>",
        "// Line_Reference 78: </td>",
        "// Line_Reference 79: </tr>",
        "// Line_Reference 80: </table>",
        "// Line_Reference 81: <!-- END result_table_block -->",
        "// Line_Reference 82: "
    ]
}
