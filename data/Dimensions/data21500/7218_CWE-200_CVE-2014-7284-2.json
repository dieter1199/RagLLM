{
    "cve_id": "CVE-2014-7284",
    "cve_description": "The net_get_random_once implementation in net/core/utils.c in the Linux kernel 3.13.x and 3.14.x before 3.14.5 on certain Intel processors does not perform the intended slow-path operation to initialize random seeds, which makes it easier for remote attackers to spoof or disrupt IP communication by leveraging the predictability of TCP sequence numbers, TCP and UDP port numbers, and IP ID values.",
    "cve_publish_date": "2014-10-13",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "net: avoid dependency of net_get_random_once on nop patching\n\nnet_get_random_once depends on the static keys infrastructure to patch up\nthe branch to the slow path during boot. This was realized by abusing the\nstatic keys api and defining a new initializer to not enable the call\nsite while still indicating that the branch point should get patched\nup. This was needed to have the fast path considered likely by gcc.\n\nThe static key initialization during boot up normally walks through all\nthe registered keys and either patches in ideal nops or enables the jump\nsite but omitted that step on x86 if ideal nops where already placed at\nstatic_key branch points. Thus net_get_random_once branches not always\nbecame active.\n\nThis patch switches net_get_random_once to the ordinary static_key\napi and thus places the kernel fast path in the - by gcc considered -\nunlikely path.  Microbenchmarks on Intel and AMD x86-64 showed that\nthe unlikely path actually beats the likely path in terms of cycle cost\nand that different nop patterns did not make much difference, thus this\nswitch should not be noticeable.\n\nFixes: a48e42920ff38b (\"net: introduce new macro net_get_random_once\")\nReported-by: Tuomas Räsänen <tuomasjjrasanen@tjjr.fi>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 351: \tif (!static_key_enabled(work->key))",
        "// Line_Reference 352: \t\tstatic_key_slow_inc(work->key);",
        "// Line_Reference 370: \t\t\t   struct static_key *done_key)",
        "// Line_Reference 385: \t__net_random_once_disable_jump(done_key);"
    ]
}
