{
    "cve_id": "CVE-2013-6367",
    "cve_description": "The apic_get_tmcct function in arch/x86/kvm/lapic.c in the KVM subsystem in the Linux kernel through 3.12.5 allows guest OS users to cause a denial of service (divide-by-zero error and host OS crash) via crafted modifications of the TMICT value.",
    "cve_publish_date": "2013-12-14",
    "cwe_id": "CWE-189",
    "cwe_name": "Numeric Errors",
    "cwe_description": "Weaknesses in this category are related to improper calculation or conversion of numbers.",
    "commit_message": "KVM: x86: Fix potential divide by 0 in lapic (CVE-2013-6367)\n\nUnder guest controllable circumstances apic_get_tmcct will execute a\ndivide by zero and cause a crash.  If the guest cpuid support\ntsc deadline timers and performs the following sequence of requests\nthe host will crash.\n- Set the mode to periodic\n- Set the TMICT to 0\n- Set the mode bits to 11 (neither periodic, nor one shot, nor tsc deadline)\n- Set the TMICT to non-zero.\nThen the lapic_timer.period will be 0, but the TMICT will not be.  If the\nguest then reads from the TMCCT then the host will perform a divide by 0.\n\nThis patch ensures that if the lapic_timer.period is 0, then the division\ndoes not occur.\n\nReported-by: Andrew Honig <ahonig@google.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Andrew Honig <ahonig@google.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "lapic.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 844: \tif (kvm_apic_get_reg(apic, APIC_TMICT) == 0)"
    ]
}
