{
    "cve_id": "CVE-2013-1959",
    "cve_description": "kernel/user_namespace.c in the Linux kernel before 3.8.9 does not have appropriate capability requirements for the uid_map and gid_map files, which allows local users to gain privileges by opening a file within an unprivileged process and then modifying the file within a privileged process.",
    "cve_publish_date": "2013-05-03",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "userns: Don't let unprivileged users trick privileged users into setting the id_map\n\nWhen we require privilege for setting /proc/<pid>/uid_map or\n/proc/<pid>/gid_map no longer allow an unprivileged user to\nopen the file and pass it to a privileged program to write\nto the file.\n\nInstead when privilege is required require both the opener and the\nwriter to have the necessary capabilities.\n\nI have tested this code and verified that setting /proc/<pid>/uid_map\nfails when an unprivileged user opens the file and a privielged user\nattempts to set the mapping, that unprivileged users can still map\ntheir own id, and that a privileged users can still setup an arbitrary\nmapping.\n\nReported-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "user_namespace.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 28: static bool new_idmap_permitted(struct user_namespace *ns, int cap_setid,",
        "// Line_Reference 703: \tif (!new_idmap_permitted(ns, cap_setid, &new_map))",
        "// Line_Reference 790: static bool new_idmap_permitted(struct user_namespace *ns, int cap_setid,",
        "// Line_Reference 815: \tif (ns_capable(ns->parent, cap_setid))"
    ]
}
