{
    "cve_id": "CVE-2015-4410",
    "cve_description": "The Moped::BSON::ObjecId.legal? method in rubygem-moped before commit dd5a7c14b5d2e466f7875d079af71ad19774609b allows remote attackers to cause a denial of service (worker resource consumption) or perform a cross-site scripting (XSS) attack via a crafted string.",
    "cve_publish_date": "2020-02-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Merge Replica Set Refactor\n\n* Removes Server, and Socket; replaced with Node, and Connection.\n\n  Replica sets are now much more robustly supported, including failover\n  and discovery.\n\n* Refactors specs.\n\n  Internal APIs are now tested with integration specs through the public\n  APIs.\n\n* More documentation.",
    "type_of_change": "Modification",
    "filename_of_changes": "object_id_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 5:     [78, 77, 102, 52, 59, 57, 182, 132, 7, 0, 0, 1]",
        "// Line_Reference 12:       it \"initializes with the strings bytes\" do",
        "// Line_Reference 13:         Moped::BSON::ObjectId.should_receive(:new).with(bytes)",
        "// Line_Reference 50:   describe \"#initialize\" do",
        "// Line_Reference 51: ",
        "// Line_Reference 52:     context \"with data\" do",
        "// Line_Reference 53:       it \"sets the object id's data\" do",
        "// Line_Reference 54:         Moped::BSON::ObjectId.new(bytes).data.should == bytes",
        "// Line_Reference 55:       end",
        "// Line_Reference 68: ",
        "// Line_Reference 69:     context \"with a time\" do",
        "// Line_Reference 70:       it \"sets the generation time\" do",
        "// Line_Reference 71:         time = Time.at((Time.now.utc - 64800).to_i).utc",
        "// Line_Reference 72:         Moped::BSON::ObjectId.new(nil, time).generation_time.should == time",
        "// Line_Reference 73:       end",
        "// Line_Reference 74:     end",
        "// Line_Reference 75: ",
        "// Line_Reference 82:         Moped::BSON::ObjectId.new(bytes).should == Moped::BSON::ObjectId.new(bytes)",
        "// Line_Reference 98:         Moped::BSON::ObjectId.new(bytes).should eql Moped::BSON::ObjectId.new(bytes)",
        "// Line_Reference 114:         Moped::BSON::ObjectId.new(bytes).hash.should eq Moped::BSON::ObjectId.new(bytes).hash",
        "// Line_Reference 129:       Moped::BSON::ObjectId.new(bytes).to_s.should eq \"4e4d66343b39b68407000001\""
    ]
}
