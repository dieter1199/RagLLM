{
    "cve_id": "CVE-2014-3771",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via the language file path in a (1) request to index.php or (2) \"change_user_language\" request to sources/main.queries.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Several security improvements\nNew feature: one time item view for anonymous user",
    "type_of_change": "Modification",
    "filename_of_changes": "index.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 13:  * @version       2.1.19",
        "// Line_Reference 58:     /*$dataLanguage =",
        "// Line_Reference 59:         $db->fetchRow(",
        "// Line_Reference 60:             \"SELECT valeur FROM \".$pre.\"misc",
        "// Line_Reference 61:             WHERE type = 'admin' AND intitule = 'default_language'\"",
        "// Line_Reference 62:         );*/",
        "// Line_Reference 94: require_once $_SESSION['settings']['cpassman_dir'].'/includes/language/'.$_SESSION['user_language'].'.php';",
        "// Line_Reference 95: if (isset($_GET['page']) && $_GET['page'] == \"kb\") {",
        "// Line_Reference 96:     require_once $_SESSION['settings']['cpassman_dir'].'/includes/language/'.$_SESSION['user_language'].'_kb.php';",
        "// Line_Reference 98: // Load CORE",
        "// Line_Reference 99: require_once $_SESSION['settings']['cpassman_dir'].'/sources/core.php';",
        "// Line_Reference 211: echo '",
        "// Line_Reference 221:         </div>",
        "// Line_Reference 302:             <button title=\"'.$txt['share'].'\" id=\"menu_button_share\" class=\"\" onclick=\"OpenDialog(\\'div_item_share\\', \\'false\\')\"><img src=\"includes/images/share.png\" id=\"div_share\" alt=\"\" /></button>';",
        "// Line_Reference 461:     if (isset($_GET['session']) && !empty($_GET['session'])) {",
        "// Line_Reference 462:         include 'otv.php?session='.$_GET['session'];",
        "// Line_Reference 463:     } else {"
    ]
}
