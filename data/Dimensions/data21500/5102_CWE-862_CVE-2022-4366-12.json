{
    "cve_id": "CVE-2022-4366",
    "cve_description": "Missing Authorization in GitHub repository lirantal/daloradius prior to master branch.",
    "cve_publish_date": "2022-12-08",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: introduced security fixes (#263)\n\n- dologin.php - validating user input and introduced CSRF token check\r\n- logging.php - preventing direct access to this file, which means redirecting to index.php when directly hitting this include file, (repeated for other exten. / include / etc. files), and optimized logging features\r\n- actionMessages.php and errorHandling.php same as logging.php\r\n- library/exten-* files - preventing direct access to these files, generalized the approach of looking for known file locations, improved user input validation (params such as limit, etc.), improved output (escaping logfile output, etc.)\r\n- in library/exten-server_info.php - i also have added new commands for retrieving network information and system distro/version\r\n- opendb.php - general code optimization (TODO prevent direct access to this file)\r\n- sessions.php - introduced new session handling (TODO prevent direct access to this file)\r\n- login.php - removed the default username hardcoded in the form, added the csrf_token\r\n- rep-* - user input validation, code optimization",
    "type_of_change": "Modification",
    "filename_of_changes": "rep-logs-daloradius.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 18:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 23: \tinclude (\"library/checklogin.php\");",
        "// Line_Reference 24: \t$operator = $_SESSION['operator_user'];",
        "// Line_Reference 26: \tinclude('library/check_operator_perm.php');",
        "// Line_Reference 28: \tisset($_GET['daloradiusLineCount']) ? $daloradiusLineCount = $_GET['daloradiusLineCount'] : $daloradiusLineCount = 50;",
        "// Line_Reference 29: \tisset($_GET['daloradiusFilter']) ? $daloradiusFilter = $_GET['daloradiusFilter'] : $daloradiusFilter = \".\";",
        "// Line_Reference 31: \tinclude_once('library/config_read.php');",
        "// Line_Reference 32: \t$log = \"visited page: \";",
        "// Line_Reference 33: \t$logQuery = \"performed query on page: \";",
        "// Line_Reference 34: \tinclude('include/config/logging.php');",
        "// Line_Reference 36: ?>",
        "// Line_Reference 37: ",
        "// Line_Reference 38: <?php",
        "// Line_Reference 39: ",
        "// Line_Reference 40:     include (\"menu-reports-logs.php\");",
        "// Line_Reference 41: ",
        "// Line_Reference 42: ?>",
        "// Line_Reference 45: \t<div id=\"contentnorightbar\">",
        "// Line_Reference 46: ",
        "// Line_Reference 47: \t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogsdaloradius.php'); ?>",
        "// Line_Reference 48: \t\t:: <?php if (isset($daloradiusLineCount)) { echo $daloradiusLineCount . \" Lines Count \"; } ?>",
        "// Line_Reference 49: \t\t   <?php if (isset($daloradiusFilter)) { echo \" with filter set to \" . $daloradiusFilter; } ?>",
        "// Line_Reference 50: \t\t<h144>&#x2754;</h144></a></h2>",
        "// Line_Reference 52: \t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >",
        "// Line_Reference 53: \t\t\t<?php echo t('helpPage','replogsdaloradius') ?>",
        "// Line_Reference 54: \t\t\t<br/>",
        "// Line_Reference 55: \t\t</div>",
        "// Line_Reference 58: \tinclude 'library/exten-daloradius_log.php';",
        "// Line_Reference 61:                 <?php",
        "// Line_Reference 62:                         include_once('include/management/actionMessages.php');",
        "// Line_Reference 63:                 ?>",
        "// Line_Reference 64: ",
        "// Line_Reference 65: \t</div>",
        "// Line_Reference 66: ",
        "// Line_Reference 67: \t<div id=\"footer\">",
        "// Line_Reference 68: ",
        "// Line_Reference 70: \tinclude 'page-footer.php';",
        "// Line_Reference 72: ",
        "// Line_Reference 73: \t</div>",
        "// Line_Reference 74: ",
        "// Line_Reference 75: </div>"
    ]
}
