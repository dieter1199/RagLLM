{
    "cve_id": "CVE-2014-3772",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via a request to index.php followed by a direct request to a file that calls the session_start function before checking the CPM key, as demonstrated by a request to sources/upload/upload.files.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "2.1.20",
    "type_of_change": "Modification",
    "filename_of_changes": "find.queries.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 41: $row = $db->fetchRow(\"SELECT id FROM \".$pre.\"nested_tree WHERE title = \".$_SESSION['user_id']);",
        "// Line_Reference 46: $rows = $db->fetchAllArray(",
        "// Line_Reference 47:     \"SELECT id FROM \".$pre.\"nested_tree WHERE personal_folder=1 AND NOT parent_id = \".$row[0].",
        "// Line_Reference 48:     \" AND NOT title = \".$_SESSION['user_id']",
        "// Line_Reference 49: );",
        "// Line_Reference 50: foreach ($rows as $reccord) {",
        "// Line_Reference 51:     if (!in_array($reccord['id'], $arrayPf)) {",
        "// Line_Reference 52:         //build an array of personal folders ids",
        "// Line_Reference 53:         array_push($arrayPf, $reccord['id']);",
        "// Line_Reference 54:         //build also a string with those ids",
        "// Line_Reference 55:         if (empty($listPf)) {",
        "// Line_Reference 56:             $listPf = $reccord['id'];",
        "// Line_Reference 57:         } else {",
        "// Line_Reference 58:             $listPf .= ', '.$reccord['id'];",
        "// Line_Reference 59:         }",
        "// Line_Reference 60:     }",
        "// Line_Reference 67:     $sLimit = \"LIMIT \". intval($_GET['iDisplayStart']) .\", \". intval($_GET['iDisplayLength']);",
        "// Line_Reference 78:             $sOrder .= $aColumns[ intval($_GET['iSortCol_'.$i]) ].\"",
        "// Line_Reference 79:             \".$_GET['sSortDir_'.$i] .\", \";",
        "// Line_Reference 88: ",
        "// Line_Reference 167:         \"SELECT role_id FROM \".$pre.\"restriction_to_roles WHERE item_id = \".$reccord['id']"
    ]
}
