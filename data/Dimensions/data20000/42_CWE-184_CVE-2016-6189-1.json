{
    "cve_id": "CVE-2016-6189",
    "cve_description": "Incomplete blacklist in SOGo before 2.3.12 and 3.x before 3.1.1 allows remote authenticated users to obtain sensitive information by reading the fields in the (1) ics or (2) XML calendar feeds.",
    "cve_publish_date": "2017-02-17",
    "cwe_id": "CWE-184",
    "cwe_name": "Incomplete List of Disallowed Inputs",
    "cwe_description": "The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional processing takes place, but the list is incomplete, leading to resultant weaknesses.",
    "commit_message": "(fix) improved previous commit for attributes stripping and UID generation (fixes #3695 and #3696)",
    "type_of_change": "Modification",
    "filename_of_changes": "SOGoCalendarComponent.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 205:   NSString *type, *summary, *tag;",
        "// Line_Reference 206:   NSArray *children;",
        "// Line_Reference 208:   int classification, i;",
        "// Line_Reference 224:   [component setSummary: summary];",
        "// Line_Reference 225:   [component setComment: @\"\"];",
        "// Line_Reference 226:   [component setUserComment: @\"\"];",
        "// Line_Reference 227:   [component setLocation: @\"\"];",
        "// Line_Reference 228:   [component setCategories: [NSArray array]];",
        "// Line_Reference 229:   [component setUrl: @\"\"];",
        "// Line_Reference 230:   [component setOrganizer: nil];",
        "// Line_Reference 231:   [component removeAllAttendees];",
        "// Line_Reference 232:   [component removeAllAlarms];",
        "// Line_Reference 233: ",
        "// Line_Reference 234:   // We strip all X- tags",
        "// Line_Reference 235:   children = [component children];",
        "// Line_Reference 236: ",
        "// Line_Reference 237:   for (i = 0; i < [children count]; i++)",
        "// Line_Reference 239:       tag = [[children objectAtIndex: i] tag];",
        "// Line_Reference 240:       if ([[tag uppercaseString] hasPrefix: @\"X-\"])",
        "// Line_Reference 241:         [component removeChild: [children objectAtIndex: i]];"
    ]
}
