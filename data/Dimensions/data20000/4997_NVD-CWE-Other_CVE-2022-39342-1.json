{
    "cve_id": "CVE-2022-39342",
    "cve_description": "OpenFGA is an authorization/permission engine. Versions prior to version 0.2.4 are vulnerable to authorization bypass under certain conditions. Users whose model has a relation defined as a tupleset (the right hand side of a ‘from’ statement) that involves anything other than a direct relationship (e.g. ‘as self’) are vulnerable. Version 0.2.4 contains a patch for this issue.",
    "cve_publish_date": "2022-10-25",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Merge pull request from GHSA-f4mm-2r69-mg5f",
    "type_of_change": "Modification",
    "filename_of_changes": "typesystem.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "44",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 236: \tallRelations := map[string]struct{}{}",
        "// Line_Reference 237: \ttypeToRelations := map[string]map[string]struct{}{}",
        "// Line_Reference 240: \t\ttypeToRelations[objectType] = map[string]struct{}{}",
        "// Line_Reference 241: \t\tfor relation := range td.GetRelations() {",
        "// Line_Reference 242: \t\t\ttypeToRelations[objectType][relation] = struct{}{}",
        "// Line_Reference 243: \t\t\tallRelations[relation] = struct{}{}",
        "// Line_Reference 250: \t\t\terr := isUsersetRewriteValid(allRelations, typeToRelations[objectType], objectType, relation, rewrite)",
        "// Line_Reference 262: func isUsersetRewriteValid(allRelations map[string]struct{}, relationsOnType map[string]struct{}, objectType, relation string, rewrite *openfgapb.Userset) error {",
        "// Line_Reference 278: \t\tif _, ok := relationsOnType[tupleset]; !ok {"
    ]
}
