{
    "cve_id": "CVE-2017-2298",
    "cve_description": "The mcollective-sshkey-security plugin before 0.5.1 for Puppet uses a server-specified identifier as part of a path where a file is written. A compromised server could use this to write a file to an arbitrary location on the client with the filename appended with the string \"_pub.pem\".",
    "cve_publish_date": "2017-06-30",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "(MCOP-600) Prevent public key overwriting attack via identity\n\nWhen using two-way automatic public key distribution, each end writes\nthe others `identity` as a public key file locally. No validation was\ndone on the `identity`, so it could trigger directory traversal and\nallow the attacker to overwrite an unexpected file (like a trusted\npublic key certificate). Prevent this by verifying identity does not\nresult in traversing outside the intended distribution directory.",
    "type_of_change": "Modification",
    "filename_of_changes": "sshkey.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 145:           if File.exists?(old_keyfile = File.join(publickey_dir, \"#{identity}_pub.pem\"))",
        "// Line_Reference 153:                 File.open(File.join(publickey_dir, \"#{identity}_pub.pem\"), 'w') { |f| f.puts key }",
        "// Line_Reference 158:             File.open(File.join(publickey_dir, \"#{identity}_pub.pem\"), 'w') { |f| f.puts key }"
    ]
}
