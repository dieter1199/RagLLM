{
    "cve_id": "CVE-2013-3301",
    "cve_description": "The ftrace implementation in the Linux kernel before 3.8.8 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by leveraging the CAP_SYS_ADMIN capability for write access to the (1) set_ftrace_pid or (2) set_graph_function file, and then making an lseek system call.",
    "cve_publish_date": "2013-04-29",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "tracing: Fix possible NULL pointer dereferences\n\nCurrently set_ftrace_pid and set_graph_function files use seq_lseek\nfor their fops.  However seq_open() is called only for FMODE_READ in\nthe fops->open() so that if an user tries to seek one of those file\nwhen she open it for writing, it sees NULL seq_file and then panic.\n\nIt can be easily reproduced with following command:\n\n  $ cd /sys/kernel/debug/tracing\n  $ echo 1234 | sudo tee -a set_ftrace_pid\n\nIn this example, GNU coreutils' tee opens the file with fopen(, \"a\")\nand then the fopen() internally calls lseek().\n\nLink: http://lkml.kernel.org/r/1365663302-2170-1-git-send-email-namhyung@kernel.org\n\nCc: Frederic Weisbecker <fweisbec@gmail.com>\nCc: Ingo Molnar <mingo@kernel.org>\nCc: Namhyung Kim <namhyung.kim@lge.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Namhyung Kim <namhyung@kernel.org>\nSigned-off-by: Steven Rostedt <rostedt@goodmis.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "ftrace.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 2700: ftrace_regex_lseek(struct file *file, loff_t offset, int whence)",
        "// Line_Reference 3573: \t.llseek = ftrace_regex_lseek,",
        "// Line_Reference 3581: \t.llseek = ftrace_regex_lseek,",
        "// Line_Reference 3787: \t.llseek\t\t= seq_lseek,",
        "// Line_Reference 4442: \t.llseek\t\t= seq_lseek,"
    ]
}
