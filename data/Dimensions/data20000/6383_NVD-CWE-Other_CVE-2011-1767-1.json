{
    "cve_id": "CVE-2011-1767",
    "cve_description": "net/ipv4/ip_gre.c in the Linux kernel before 2.6.34, when ip_gre is configured as a module, allows remote attackers to cause a denial of service (OOPS) by sending a packet during module loading.",
    "cve_publish_date": "2012-06-13",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "gre: fix netns vs proto registration ordering\n\nGRE protocol receive hook can be called right after protocol addition is done.\nIf netns stuff is not yet initialized, we're going to oops in\nnet_generic().\n\nThis is remotely oopsable if ip_gre is compiled as module and packet\ncomes at unfortunate moment of module loading.\n\nSigned-off-by: Alexey Dobriyan <adobriyan@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip_gre.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 1668: \tif (inet_add_protocol(&ipgre_protocol, IPPROTO_GRE) < 0) {",
        "// Line_Reference 1669: \t\tprintk(KERN_INFO \"ipgre init: can't add protocol\\n\");",
        "// Line_Reference 1670: \t\treturn -EAGAIN;",
        "// Line_Reference 1671: \t}",
        "// Line_Reference 1672: ",
        "// Line_Reference 1675: \t\tgoto gen_device_failed;",
        "// Line_Reference 1691: \tunregister_pernet_device(&ipgre_net_ops);",
        "// Line_Reference 1692: gen_device_failed:",
        "// Line_Reference 1701: \tunregister_pernet_device(&ipgre_net_ops);"
    ]
}
