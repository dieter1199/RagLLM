{
    "cve_id": "CVE-2022-23618",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions there is no protection against URL redirection to untrusted sites, in particular some well known parameters (xredirect) can be used to perform url redirections. This problem has been patched in XWiki 12.10.7 and XWiki 13.3RC1. Users are advised to update. There are no known workarounds for this issue.",
    "cve_publish_date": "2022-02-09",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "XWIKI-10309: Check URL domains based on a whitelist (#1592)\n\nIntroduce a new property for listing the trusted domains and API to\r\ncheck an URL against that list and the aliases used in subwikis.\r\n\r\n  * Add new property url.trustedDomains in xwiki.properties\r\n  * Add new API in URLConfiguration to retrieve this configuration value\r\n  * Create a new URLSecurityManager responsible to check if an URL can\r\n    be trusted based on this property and on the subwikis configurations\r\n  * Introduce a new listener to invalidate the cache of\r\n    URLSecurityManager whenever a XWikiServerClass xobject is\r\nadded/updated/deleted\r\n  * Move URL API implementations to URL default module\r\n  * Add a new property url.enableTrustedDomains as a global switch off the\r\n    checks on domains to avoid breaking behaviours on existing instances\r\n  * Add a constant property in URLSecurityManager to be set in\r\n    ExecutionContext to allow temporary switch off the check for\r\nextensions\r\n  * Use both those switches in DefaultURLSecurityManager to prevent\r\n    performing the check when needed",
    "type_of_change": "ModificationType.RENAME",
    "filename_of_changes": "MyFormAuthenticator.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 247:                 String continueToURL = getContinueToURL(request);"
    ]
}
