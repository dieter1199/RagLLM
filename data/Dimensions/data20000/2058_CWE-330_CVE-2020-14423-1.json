{
    "cve_id": "CVE-2020-14423",
    "cve_description": "Convos before 4.20 does not properly generate a random secret in Core/Settings.pm and Util.pm. This leads to a predictable CONVOS_LOCAL_SECRET value, affecting password resets and invitations.",
    "cve_publish_date": "2020-06-18",
    "cwe_id": "CWE-330",
    "cwe_name": "Use of Insufficiently Random Values",
    "cwe_description": "The product uses insufficiently random numbers or values in a security context that depends on unpredictable numbers.",
    "commit_message": "Fix generating random local secret for Docker",
    "type_of_change": "Modification",
    "filename_of_changes": "Settings.pm",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 7: use Mojo::Util;",
        "// Line_Reference 15: has local_secret   => \\&_build_local_secret;",
        "// Line_Reference 66: ",
        "// Line_Reference 69: ",
        "// Line_Reference 70:   # Remove legacy secrets file",
        "// Line_Reference 71:   my $file = $self->_legacy_session_secrets_file;",
        "// Line_Reference 72:   $file->remove if -e $file;",
        "// Line_Reference 73: ",
        "// Line_Reference 94: sub _build_local_secret {",
        "// Line_Reference 95:   my $self = shift;",
        "// Line_Reference 96:   return $ENV{CONVOS_LOCAL_SECRET} if $ENV{CONVOS_LOCAL_SECRET};",
        "// Line_Reference 97: ",
        "// Line_Reference 98:   my $secret = Mojo::Util::md5_sum(join ':', $self->core->home->to_string, $<, $(, $0);",
        "// Line_Reference 99:   return $secret;",
        "// Line_Reference 100: }",
        "// Line_Reference 101: ",
        "// Line_Reference 106:   my $secrets;",
        "// Line_Reference 107:   my $file = $self->_legacy_session_secrets_file;",
        "// Line_Reference 108:   $secrets = [split /â€š/, $file->slurp] if -e $file;",
        "// Line_Reference 109:   return $secrets if $secrets and @$secrets;",
        "// Line_Reference 111:   $secrets = [Mojo::Util::sha1_sum(join ':', rand(), $$, $<, $(, $^X, Time::HiRes::time())];",
        "// Line_Reference 112:   return $secrets;",
        "// Line_Reference 115: sub _legacy_session_secrets_file { shift->core->home->child('secrets') }",
        "// Line_Reference 116: "
    ]
}
