{
    "cve_id": "CVE-2012-3864",
    "cve_description": "Puppet before 2.6.17 and 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, allows remote authenticated users to read arbitrary files on the puppet master server by leveraging an arbitrary user's certificate and private key in a GET request.",
    "cve_publish_date": "2012-08-06",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Add Selector terminus for file_content/file_metadata\n\nThis terminus is now the default, and encapsulates the behavior that was\npreviously in the IndirectionHooks. That is, we dynamically select the\nterminus to use for a file request based on the key. However, for the\npuppet master, we instead explicitly always use the FileServer terminus,\nso that *all* requests for files from the master will go through\nthe file server. This ensures that we will never accidentally\nserve local files on the puppet master.",
    "type_of_change": "Modification",
    "filename_of_changes": "terminus_selector_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 4: require 'puppet/file_serving/indirection_hooks'",
        "// Line_Reference 6: describe Puppet::FileServing::IndirectionHooks do",
        "// Line_Reference 9:     @object.extend(Puppet::FileServing::IndirectionHooks)",
        "// Line_Reference 17:       @object.select_terminus(@request).should == :file",
        "// Line_Reference 22:       @object.select_terminus(@request).should == :file",
        "// Line_Reference 27:       proc { @object.select_terminus(@request) }.should raise_error(ArgumentError)",
        "// Line_Reference 38:         @object.select_terminus(@request).should == :rest",
        "// Line_Reference 44:         @request.stubs(:server).returns \"foo\"",
        "// Line_Reference 46:         @object.select_terminus(@request).should == :rest",
        "// Line_Reference 54:         Puppet.settings.expects(:value).with(:name).returns \"puppet\"",
        "// Line_Reference 55:         @object.select_terminus(@request).should == :file_server"
    ]
}
