{
    "cve_id": "CVE-2017-18174",
    "cve_description": "In the Linux kernel before 4.7, the amd_gpio_remove function in drivers/pinctrl/pinctrl-amd.c calls the pinctrl_unregister function, leading to a double free.",
    "cve_publish_date": "2018-02-11",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "pinctrl: amd: Use devm_pinctrl_register() for pinctrl registration\n\nUse devm_pinctrl_register() for pin control registration and clean\nerror path.\n\nSigned-off-by: Laxman Dewangan <ldewangan@nvidia.com>\nSigned-off-by: Linus Walleij <linus.walleij@linaro.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "pinctrl-amd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 786: \tgpio_dev->pctrl = pinctrl_register(&amd_pinctrl_desc,",
        "// Line_Reference 787: \t\t\t\t\t&pdev->dev, gpio_dev);",
        "// Line_Reference 795: \t\tgoto out1;",
        "// Line_Reference 828: out1:",
        "// Line_Reference 829: \tpinctrl_unregister(gpio_dev->pctrl);",
        "// Line_Reference 840: \tpinctrl_unregister(gpio_dev->pctrl);"
    ]
}
