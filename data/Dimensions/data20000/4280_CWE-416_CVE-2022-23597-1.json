{
    "cve_id": "CVE-2022-23597",
    "cve_description": "Element Desktop is a Matrix client for desktop platforms with Element Web at its core. Element Desktop before 1.9.7 is vulnerable to a remote program execution bug with user interaction. The exploit is non-trivial and requires clicking on a malicious link, followed by another button click. To the best of our knowledge, the vulnerability has never been exploited in the wild. If you are using Element Desktop < 1.9.7, we recommend upgrading at your earliest convenience. If successfully exploited, the vulnerability allows an attacker to specify a file path of a binary on the victim's computer which then gets executed. Notably, the attacker does *not* have the ability to specify program arguments. However, in certain unspecified configurations, the attacker may be able to specify an URI instead of a file path which then gets handled using standard platform mechanisms. These may allow exploiting further vulnerabilities in those mechanisms, potentially leading to arbitrary code execution.",
    "cve_publish_date": "2022-02-01",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "Merge pull request from GHSA-mjrg-9f8r-h3m7\n\n* Patch part 1: remove electronVersion\n\nWe no longer need to specify electronVersion at all since electron\nis now in devDependencies. Removing it means electron can be updated\nthe same way as any other dependency.\n\n* Only allow main app page to be opened via URL\n\nWe previously allowed any URL to be opened in the main electron\nwindow. Allow only the main app page, as commented.\n\n* use exact equals\n\n* Make url logic clearer",
    "type_of_change": "Modification",
    "filename_of_changes": "protocol.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 22: const PROTOCOL = \"element://\";",
        "// Line_Reference 31:     console.log(\"Handling link: \", url);",
        "// Line_Reference 32:     global.mainWindow.loadURL(url.replace(PROTOCOL, \"vector://\"));",
        "// Line_Reference 65:     const deeplinkUrl = args.find(arg => arg.startsWith('element://'));",
        "// Line_Reference 68:         if (parsedUrl.protocol === 'element:') {",
        "// Line_Reference 99:             if (!url.startsWith(PROTOCOL)) return;"
    ]
}
