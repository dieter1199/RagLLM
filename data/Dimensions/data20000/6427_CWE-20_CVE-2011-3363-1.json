{
    "cve_id": "CVE-2011-3363",
    "cve_description": "The setup_cifs_sb function in fs/cifs/connect.c in the Linux kernel before 2.6.39 does not properly handle DFS referrals, which allows remote CIFS servers to cause a denial of service (system crash) by placing a referral at the root of a share.",
    "cve_publish_date": "2012-05-24",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "cifs: always do is_path_accessible check in cifs_mount\n\nCurrently, we skip doing the is_path_accessible check in cifs_mount if\nthere is no prefixpath. I have a report of at least one server however\nthat allows a TREE_CONNECT to a share that has a DFS referral at its\nroot. The reporter in this case was using a UNC that had no prefixpath,\nso the is_path_accessible check was not triggered and the box later hit\na BUG() because we were chasing a DFS referral on the root dentry for\nthe mount.\n\nThis patch fixes this by removing the check for a zero-length\nprefixpath.  That should make the is_path_accessible check be done in\nthis situation and should allow the client to chase the DFS referral at\nmount time instead.\n\nCc: stable@kernel.org\nReported-and-Tested-by: Yogesh Sharma <ysharma@cymer.com>\nSigned-off-by: Jeff Layton <jlayton@redhat.com>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "connect.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 2834: \tif (!rc && cifs_sb->prepathlen && tcon) {"
    ]
}
