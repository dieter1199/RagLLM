{
    "cve_id": "CVE-2024-41129",
    "cve_description": "The ops library is a Python framework for developing and testing Kubernetes and machine charms. The issue here is that ops passes the secret content as one of the args via CLI. This issue may affect any of the charms that are using: Juju (>=3.0), Juju secrets and not correctly capturing and processing `subprocess.CalledProcessError`. This vulnerability is fixed in 2.15.0.",
    "cve_publish_date": "2024-07-22",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: use temp dir for secret data (#1290)\n\nChange the mechanism used to pass secret values from ops to hook tools\r\nfrom command line to files in temporary directory.\r\n\r\nRemoves the 2MB total secret size limit imposed by command line length\r\n\r\nHook tool calls juju agent which in turn reads these files, I've\r\nconfirmed with the Juju team that juju agent and charm code are run as\r\nthe same user.",
    "type_of_change": "Modification",
    "filename_of_changes": "test_model.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 27: from unittest.mock import MagicMock, patch",
        "// Line_Reference 3352:         assert fake_script.calls(clear=True) == [['secret-add', '--owner', 'application', 'foo=x']]",
        "// Line_Reference 3382:                 'foo=x',",
        "// Line_Reference 3383:                 'bar=y',",
        "// Line_Reference 3395:         assert fake_script.calls(clear=True) == [['secret-add', '--owner', 'unit', 'foo=x']]",
        "// Line_Reference 3425:                 'foo=w',",
        "// Line_Reference 3426:                 'bar=z',",
        "// Line_Reference 3724:             ['secret-set', 'secret:x', 'foo=bar'],",
        "// Line_Reference 3726:             ['secret-set', 'secret:z', 'bar=foo'],"
    ]
}
