if (array_key_exists($perm_action, $perms)) {
flash('error', gt("You don't have permission to")." ".$perms[$perm_action]);
} elseif (array_key_exists($common_action, $perms)) {
flash('error', gt("You don't have permission to")." ".$perms[$common_action]);
} elseif (array_key_exists($perm_action, $controller->requires_login)) {
$msg = empty($controller->requires_login[$perm_action]) ? gt("You must be logged in to perform this action") : gt($controller->requires_login[$perm_action]);
} elseif (array_key_exists($common_action, $controller->requires_login)) {
// check if the action requires the user to at least be logged in
$msg = empty($controller->requires_login[$common_action]) ? gt("You must be logged in to perform this action") : gt($controller->requires_login[$common_action]);