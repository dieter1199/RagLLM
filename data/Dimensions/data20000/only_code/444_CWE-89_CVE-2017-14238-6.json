$original_file              = $check_access['original_file'];
if (preg_match('/\.\./',$original_file) || preg_match('/[<>|]/',$original_file))
dol_syslog("Refused to deliver file ".$original_file, LOG_WARNING);
// Do no show plain path in shown error message
dol_print_error(0,'Error: File '.$_GET["file"].' does not exists');
dol_print_error(0,'Error, parameter "generator" or "encoding" not defined');
dol_syslog("viewimage.php return file $original_file content-type=$type");
if (! dol_is_file($original_file) && empty($_GET["noalt"]))
$original_file=DOL_DOCUMENT_ROOT.'/public/theme/common/nophoto.png';
dol_print_error(0,$error);
header('Content-Disposition: inline; filename="'.basename($original_file).'"');
header('Content-Disposition: inline; filename="'.basename($original_file).'"');
$original_file_osencoded=dol_osencode($original_file);
readfile($original_file_osencoded);