struct ip_options replyopts;
unsigned char  optbuf[40];
if (ip_options_echo(&icmp_param->replyopts, skb))
if (icmp_param->replyopts.optlen) {
ipc.opt = &icmp_param->replyopts;
if (ipc.opt->srr)
daddr = icmp_param->replyopts.faddr;
.daddr = (param->replyopts.srr ?
param->replyopts.faddr : iph->saddr),
if (ip_options_echo(&icmp_param.replyopts, skb_in))
ipc.opt = &icmp_param.replyopts;
room -= sizeof(struct iphdr) + icmp_param.replyopts.optlen;