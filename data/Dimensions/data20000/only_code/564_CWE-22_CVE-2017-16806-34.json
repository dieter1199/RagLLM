using AgentInterface.Api.ScreenShare;
using AgentInterface.Api.Win32;
using AgentInterface.Settings;
ProcessStarter.PROCESS_INFORMATION managerInfo;
ProcessStarter.StartProcessAndBypassUAC(managerPath,
out managerInfo);
managerProcess = Process.GetProcessById((int)managerInfo.dwProcessId);
ProcessStarter.PROCESS_INFORMATION agentInfo;
var agentPath = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location),"UlteriusAgent.exe");
ProcessStarter.StartProcessAndBypassUAC(agentPath,
out agentInfo);
agentProcess = Process.GetProcessById((int)agentInfo.dwProcessId);
if (!RunningAsService())
{
ScreenData.SetupDuplication();
}
if (RunningAsService())
{
ProcessStarter.PROCESS_INFORMATION procInfo;
ProcessStarter.StartProcessAndBypassUAC("CMD.exe " + command,  out procInfo);
}
else
{
Process.Start("CMD.exe", command);
}
string.Format(
"firewall add allowedprogram program=\"{0}\" name=\"{1}\" profile=\"ALL\"",
exeFileName, displayName),
proc.WaitForExit();
return GetCurrent().Name.ToLower().Contains(@"nt authority\system");
