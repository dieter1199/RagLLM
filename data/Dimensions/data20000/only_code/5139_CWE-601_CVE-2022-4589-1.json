def test_accept_redirect_safe(self):
"/terms/accept/", {"terms": 1, "returnTo": "/secure/"}, follow=True
# Pre-accept terms 2 and 3
UserTermsAndConditions.objects.create(user=self.user1, terms=self.terms2)
UserTermsAndConditions.objects.create(user=self.user1, terms=self.terms3)
LOGGER.debug("Test /terms/accept/contrib-terms/3/ post")
accept_response = self.client.post(
"/terms/accept/", {"terms": 3, "returnTo": "http://attacker/"}, follow=False
)