{
    "cve_id": "CVE-2024-39896",
    "cve_description": "Directus is a real-time API and App dashboard for managing SQL database content. When relying on SSO providers in combination with local authentication it can be possible to enumerate existing SSO users in the instance. This is possible because if an email address exists in Directus and belongs to a known SSO provider then it will throw a \"helpful\" error that the user belongs to another provider. This vulnerability is fixed in 10.13.0.",
    "cve_publish_date": "2024-07-08",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-jgf4-vwc3-r46v\n\n* naive fix for enumeration\n\n* re-added explicit provider check\n\n* Remove user suspended error as well\n\n---------\n\nCo-authored-by: Rijk van Zanten <rijkvanzanten@me.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "authentication.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 6: \tInvalidProviderError,",
        "// Line_Reference 128: \t\tif (user?.status !== 'active') {",
        "// Line_Reference 130: ",
        "// Line_Reference 131: \t\t\tif (user?.status === 'suspended') {",
        "// Line_Reference 132: \t\t\t\tawait stall(STALL_TIME, timeStart);",
        "// Line_Reference 133: \t\t\t\tthrow new UserSuspendedError();",
        "// Line_Reference 134: \t\t\t} else {",
        "// Line_Reference 135: \t\t\t\tawait stall(STALL_TIME, timeStart);",
        "// Line_Reference 136: \t\t\t\tthrow new InvalidCredentialsError();",
        "// Line_Reference 137: \t\t\t}",
        "// Line_Reference 138: \t\t} else if (user.provider !== providerName) {",
        "// Line_Reference 140: \t\t\tthrow new InvalidProviderError();"
    ]
}
