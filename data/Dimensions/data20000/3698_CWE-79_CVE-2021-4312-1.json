{
    "cve_id": "CVE-2021-4312",
    "cve_description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in Th3-822 Rapidleech. This affects the function zip_go of the file classes/options/zip.php. The manipulation of the argument archive leads to cross site scripting. It is possible to initiate the attack remotely. The patch is named 885a87ea4ee5e14fa95801eca255604fb2e138c6. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218295. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "cve_publish_date": "2023-01-13",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed XSS on classes/options/zip.php",
    "type_of_change": "Modification",
    "filename_of_changes": "zip.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 3: \tglobal $list, $options, $PHP_SELF;",
        "// Line_Reference 5: <form name=\"ziplist\" method=\"post\" action=\"<?php echo $PHP_SELF; ?>\"><input type=\"hidden\" name=\"act\" value=\"zip_go\" />",
        "// Line_Reference 45: \t$_POST [\"archive\"] = (strlen ( trim ( urldecode ( $_POST [\"archive\"] ) ) ) > 4 && substr ( trim ( urldecode ( $_POST [\"archive\"] ) ), - 4 ) == \".zip\") ? trim ( urldecode ( $_POST [\"archive\"] ) ) : \"archive.zip\";",
        "// Line_Reference 58: \t$archive = new PclZip ( $_POST [\"archive\"] );",
        "// Line_Reference 60: \tif (file_exists ( $_POST [\"archive\"] )) {",
        "// Line_Reference 67: \tif ($v_list == 0) {",
        "// Line_Reference 68: \t\techo \"Error: \" . $archive->errorInfo ( true ) . \"<br /><br />\";",
        "// Line_Reference 69: \t\treturn;",
        "// Line_Reference 70: \t} else {",
        "// Line_Reference 71: \t\techo \"Archive <b>\" . $_POST [\"archive\"] . \"</b> successfully created!<br /><br />\";",
        "// Line_Reference 72: \t}",
        "// Line_Reference 73: \tif (is_file($_POST['archive'])) {",
        "// Line_Reference 78: }",
        "// Line_Reference 79: ?>"
    ]
}
