{
    "cve_id": "CVE-2017-17712",
    "cve_description": "The raw_sendmsg() function in net/ipv4/raw.c in the Linux kernel through 4.14.6 has a race condition in inet->hdrincl that leads to uninitialized stack pointer usage; this allows a local user to execute code and gain privileges.",
    "cve_publish_date": "2017-12-16",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "net: ipv4: fix for a race condition in raw_sendmsg\n\ninet->hdrincl is racy, and could lead to uninitialized stack pointer\nusage, so its value should be read only once.\n\nFixes: c008ba5bdc9f (\"ipv4: Avoid reading user iov twice after raw_probe_proto_opt\")\nSigned-off-by: Mohamed Ghannam <simo.ghannam@gmail.com>\nReviewed-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "raw.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 596: \t\tif (inet->hdrincl)",
        "// Line_Reference 618: \t\t\t   inet->hdrincl ? IPPROTO_RAW : sk->sk_protocol,",
        "// Line_Reference 620: \t\t\t    (inet->hdrincl ? FLOWI_FLAG_KNOWN_NH : 0),",
        "// Line_Reference 623: \tif (!inet->hdrincl) {",
        "// Line_Reference 648: \tif (inet->hdrincl)"
    ]
}
