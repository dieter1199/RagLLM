{
    "cve_id": "CVE-2024-29199",
    "cve_description": "Nautobot is a Network Source of Truth and Network Automation Platform. A number of Nautobot URL endpoints were found to be improperly accessible to unauthenticated (anonymous) users. These endpoints will not disclose any Nautobot data to an unauthenticated user unless the Nautobot configuration variable EXEMPT_VIEW_PERMISSIONS is changed from its default value (an empty list) to permit access to specific data by unauthenticated users. This vulnerability is fixed in 1.6.16 and 2.1.9.",
    "cve_publish_date": "2024-03-26",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "View authentication and permission fixes (#5464)",
    "type_of_change": "Modification",
    "filename_of_changes": "views.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 25: from rest_framework import status",
        "// Line_Reference 27: from rest_framework.permissions import AllowAny, IsAuthenticated",
        "// Line_Reference 344: class APIRootView(NautobotAPIVersionMixin, APIView):",
        "// Line_Reference 346:     This is the root of the REST API. API endpoints are arranged by app and model name; e.g. `/api/dcim/locations/`.",
        "// Line_Reference 349:     _ignore_model_permissions = True",
        "// Line_Reference 351:     def get_view_name(self):",
        "// Line_Reference 352:         return \"API Root\"",
        "// Line_Reference 495:         if not request.user.is_authenticated:",
        "// Line_Reference 496:             doc_url = reverse(\"api_docs\")",
        "// Line_Reference 497:             login_url = reverse(settings.LOGIN_URL)",
        "// Line_Reference 498:             return redirect(f\"{login_url}?next={doc_url}\")",
        "// Line_Reference 499: ",
        "// Line_Reference 528:     The code is a stripped down version of graphene-django default View",
        "// Line_Reference 529:     https://github.com/graphql-python/graphene-django/blob/main/graphene_django/views.py#L57",
        "// Line_Reference 532:     permission_classes = [AllowAny]"
    ]
}
