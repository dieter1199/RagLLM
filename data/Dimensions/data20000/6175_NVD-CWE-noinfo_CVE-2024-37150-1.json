{
    "cve_id": "CVE-2024-37150",
    "cve_description": "An issue in `.npmrc` support in Deno 1.44.0 was discovered where Deno would send `.npmrc` credentials for the scope to the tarball URL when the registry provided URLs for a tarball on a different domain. All users relying on .npmrc are potentially affected by this vulnerability if their private registry references tarball URLs at a different domain. This includes usage of deno install subcommand, auto-install for npm: specifiers and LSP usage. It is recommended to upgrade to Deno 1.44.1 and if your private registry ever serves tarballs at a different domain to rotate your registry credentials.",
    "cve_publish_date": "2024-06-06",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(npm): use configured auth for tarball urls instead of scope auth (#24111)\n\nDeno was using the scope auth for the tarball urls, which is not always\r\ncorrect. We are going to do a release immediately for this issue.",
    "type_of_change": "Modification",
    "filename_of_changes": "http_util.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "38",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 10: use deno_core::anyhow::bail;",
        "// Line_Reference 412:   ) -> Result<Option<Vec<u8>>, AnyError> {",
        "// Line_Reference 432:   ) -> Result<Option<Vec<u8>>, AnyError> {",
        "// Line_Reference 440:       bail!(",
        "// Line_Reference 441:         \"Bad response: {:?}{}\",",
        "// Line_Reference 442:         status,",
        "// Line_Reference 443:         match maybe_response_text {",
        "// Line_Reference 444:           Some(text) => format!(\"\\n\\n{text}\"),",
        "// Line_Reference 445:           None => String::new(),",
        "// Line_Reference 446:         }",
        "// Line_Reference 447:       );",
        "// Line_Reference 459:   ) -> Result<reqwest::Response, AnyError> {",
        "// Line_Reference 489:       Err(custom_error(\"Http\", \"Too many redirects.\"))",
        "// Line_Reference 499: ) -> Result<Vec<u8>, AnyError> {",
        "// Line_Reference 549: ) -> Result<Url, AnyError> {",
        "// Line_Reference 557:     Err(generic_error(format!(",
        "// Line_Reference 558:       \"Redirection from '{request_url}' did not provide location header\"",
        "// Line_Reference 559:     )))"
    ]
}
