{
    "cve_id": "CVE-2017-18270",
    "cve_description": "In the Linux kernel before 4.13.5, a local user could create keyrings for other users via keyctl commands, setting unwanted defaults or causing a denial of service.",
    "cve_publish_date": "2018-05-18",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "KEYS: prevent creating a different user's keyrings\n\nIt was possible for an unprivileged user to create the user and user\nsession keyrings for another user.  For example:\n\n    sudo -u '#3000' sh -c 'keyctl add keyring _uid.4000 \"\" @u\n                           keyctl add keyring _uid_ses.4000 \"\" @u\n                           sleep 15' &\n    sleep 1\n    sudo -u '#4000' keyctl describe @u\n    sudo -u '#4000' keyctl describe @us\n\nThis is problematic because these \"fake\" keyrings won't have the right\npermissions.  In particular, the user who created them first will own\nthem and will have full access to them via the possessor permissions,\nwhich can be used to compromise the security of a user's keys:\n\n    -4: alswrv-----v------------  3000     0 keyring: _uid.4000\n    -5: alswrv-----v------------  3000     0 keyring: _uid_ses.4000\n\nFix it by marking user and user session keyrings with a flag\nKEY_FLAG_UID_KEYRING.  Then, when searching for a user or user session\nkeyring by name, skip all keyrings that don't have the flag set.\n\nFixes: 69664cf16af4 (\"keys: don't generate user and user session keyrings unless they're accessed\")\nCc: <stable@vger.kernel.org>\t[v2.6.26+]\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: David Howells <dhowells@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "process_keys.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 80: \t\t\t\t\t\t    KEY_ALLOC_IN_QUOTA,",
        "// Line_Reference 97: \t\t\t\t\t      KEY_ALLOC_IN_QUOTA,"
    ]
}
