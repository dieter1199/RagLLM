{
    "cve_id": "CVE-2012-0028",
    "cve_description": "The robust futex implementation in the Linux kernel before 2.6.28 does not properly handle processes that make exec system calls, which allows local users to cause a denial of service or possibly gain privileges by writing to a memory location in a child process.",
    "cve_publish_date": "2012-06-21",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Move \"exit_robust_list\" into mm_release()\n\nWe don't want to get rid of the futexes just at exit() time, we want to\ndrop them when doing an execve() too, since that gets rid of the\nprevious VM image too.\n\nDoing it at mm_release() time means that we automatically always do it\nwhen we disassociate a VM map from the task.\n\nReported-by: pageexec@freemail.hu\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Nick Piggin <npiggin@suse.de>\nCc: Hugh Dickins <hugh@veritas.com>\nCc: Ingo Molnar <mingo@elte.hu>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: Brad Spengler <spender@grsecurity.net>\nCc: Alex Efros <powerman@powerman.name>\nCc: Peter Zijlstra <a.p.zijlstra@chello.nl>\nCc: Oleg Nesterov <oleg@redhat.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "exit.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 43: #include <linux/compat.h>",
        "// Line_Reference 1062: #ifdef CONFIG_FUTEX",
        "// Line_Reference 1063: \tif (unlikely(tsk->robust_list))",
        "// Line_Reference 1064: \t\texit_robust_list(tsk);",
        "// Line_Reference 1065: #ifdef CONFIG_COMPAT",
        "// Line_Reference 1066: \tif (unlikely(tsk->compat_robust_list))",
        "// Line_Reference 1067: \t\tcompat_exit_robust_list(tsk);",
        "// Line_Reference 1068: #endif",
        "// Line_Reference 1069: #endif"
    ]
}
