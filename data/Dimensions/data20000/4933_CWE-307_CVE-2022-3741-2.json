{
    "cve_id": "CVE-2022-3741",
    "cve_description": "Impact varies for each individual vulnerability in the application. For generation of accounts, it may be possible, depending on the amount of system resources available, to create a DoS event in the server. These accounts still need to be activated; however, it is possible to identify the output Status Code to separate accounts that are generated and waiting for email verification. \\n\\nFor the sign in directories, it is possible to brute force login attempts to either login portal, which could lead to account compromise.",
    "cve_publish_date": "2022-10-28",
    "cwe_id": "CWE-307",
    "cwe_name": "Improper Restriction of Excessive Authentication Attempts",
    "cwe_description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it more susceptible to brute force attacks.",
    "commit_message": "chore: Improve rack-attack configuration (#5389)\n\nfixes: https://github.com/chatwoot/product/issues/540",
    "type_of_change": "Modification",
    "filename_of_changes": "rack_attack.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "41",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 45:   ### Prevent Brute-Force Login Attacks ###",
        "// Line_Reference 46:   throttle('login/ip', limit: 5, period: 20.seconds) do |req|",
        "// Line_Reference 47:     req.ip if req.path == '/auth/sign_in' && req.post?",
        "// Line_Reference 48:   end",
        "// Line_Reference 49: ",
        "// Line_Reference 50:   ## Prevent Brute-Force Signup Attacks ###",
        "// Line_Reference 51:   throttle('accounts/ip', limit: 5, period: 5.minutes) do |req|",
        "// Line_Reference 52:     req.ip if req.path == '/api/v1/accounts' && req.post?",
        "// Line_Reference 53:   end",
        "// Line_Reference 54: ",
        "// Line_Reference 55:   ## Prevent Conversation Bombing on Widget APIs ###",
        "// Line_Reference 56:   throttle('api/v1/widget/conversations', limit: 6, period: 12.hours) do |req|",
        "// Line_Reference 57:     req.ip if req.path == '/api/v1/widget/conversations' && req.post?",
        "// Line_Reference 60:   ## Prevent Contact update Bombing in Widget API ###",
        "// Line_Reference 61:   throttle('api/v1/widget/contacts', limit: 60, period: 1.hour) do |req|",
        "// Line_Reference 62:     req.ip if req.path == '/api/v1/widget/contacts' && (req.patch? || req.put?)",
        "// Line_Reference 63:   end",
        "// Line_Reference 64: ",
        "// Line_Reference 65:   # ref: https://github.com/rack/rack-attack/issues/399",
        "// Line_Reference 66:   throttle('login/email', limit: 20, period: 5.minutes) do |req|",
        "// Line_Reference 67:     if req.path == '/auth/sign_in' && req.post?",
        "// Line_Reference 75:   throttle('super_admin_login/email', limit: 20, period: 5.minutes) do |req|",
        "// Line_Reference 76:     if req.path == '/super_admin/sign_in' && req.post?",
        "// Line_Reference 85:     if req.path == '/auth/password' && req.post?"
    ]
}
