{
    "cve_id": "CVE-2013-2206",
    "cve_description": "The sctp_sf_do_5_2_4_dupcook function in net/sctp/sm_statefuns.c in the SCTP implementation in the Linux kernel before 3.8.5 does not properly handle associations during the processing of a duplicate COOKIE ECHO chunk, which allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via crafted SCTP traffic.",
    "cve_publish_date": "2013-07-04",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "sctp: Use correct sideffect command in duplicate cookie handling\n\nWhen SCTP is done processing a duplicate cookie chunk, it tries\nto delete a newly created association.  For that, it has to set\nthe right association for the side-effect processing to work.\nHowever, when it uses the SCTP_CMD_NEW_ASOC command, that performs\nmore work then really needed (like hashing the associationa and\nassigning it an id) and there is no point to do that only to\ndelete the association as a next step.  In fact, it also creates\nan impossible condition where an association may be found by\nthe getsockopt() call, and that association is empty.  This\ncauses a crash in some sctp getsockopts.\n\nThe solution is rather simple.  We simply use SCTP_CMD_SET_ASOC\ncommand that doesn't have all the overhead and does exactly\nwhat we need.\n\nReported-by: Karl Heiss <kheiss@gmail.com>\nTested-by: Karl Heiss <kheiss@gmail.com>\nCC: Neil Horman <nhorman@tuxdriver.com>\nSigned-off-by: Vlad Yasevich <vyasevich@gmail.com>\nAcked-by: Neil Horman <nhorman@tuxdriver.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "sm_statefuns.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 2085: \tsctp_add_cmd_sf(commands, SCTP_CMD_NEW_ASOC, SCTP_ASOC(new_asoc));"
    ]
}
