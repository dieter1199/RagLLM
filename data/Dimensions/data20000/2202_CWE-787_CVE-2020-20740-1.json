{
    "cve_id": "CVE-2020-20740",
    "cve_description": "PDFResurrect before 0.20 lack of header validation checks causes heap-buffer-overflow in pdf_get_version().",
    "cve_publish_date": "2020-11-20",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Update header validation checks.\n\nThanks to yifengchen-cc for identifying this.",
    "type_of_change": "Modification",
    "filename_of_changes": "pdf.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 179:     int   is_pdf;",
        "// Line_Reference 182:     header = get_header(fp);",
        "// Line_Reference 183: ",
        "// Line_Reference 184:     if (header && strstr(header, \"%PDF-\"))",
        "// Line_Reference 185:       is_pdf = 1;",
        "// Line_Reference 186:     else",
        "// Line_Reference 187:       is_pdf = 0;",
        "// Line_Reference 188: ",
        "// Line_Reference 196:     char *header, *c;",
        "// Line_Reference 197: ",
        "// Line_Reference 198:     header = get_header(fp);",
        "// Line_Reference 200:     /* Locate version string start and make sure we dont go past header */",
        "// Line_Reference 202:         (c + strlen(\"%PDF-M.m\") + 2))"
    ]
}
