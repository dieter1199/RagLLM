{
    "cve_id": "CVE-2022-1723",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository jgraph/drawio prior to 18.0.6.",
    "cve_publish_date": "2022-05-17",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "18.0.6 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Graph.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "59",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 1666: \treturn DOMPurify.sanitize(value, {ADD_ATTR: ['target'], FORBID_TAGS: ['form'],",
        "// Line_Reference 1667: \t\tALLOWED_URI_REGEXP: /^(?:(?:https?|mailto|tel|callto|data):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i});",
        "// Line_Reference 1671:  * Sanitizes the SVG in the given DOM node in-place.",
        "// Line_Reference 1673: Graph.sanitizeSvg = function(div)",
        "// Line_Reference 1675: \treturn DOMPurify.sanitize(div, {IN_PLACE: true});",
        "// Line_Reference 1705: \t\t\t\tGraph.sanitizeSvg(div);",
        "// Line_Reference 2892: \t\t// Workaround for blocking in same iframe",
        "// Line_Reference 2893: \t\tif (target == '_self' && window != window.top)",
        "// Line_Reference 2894: \t\t{",
        "// Line_Reference 2895: \t\t\twindow.location.href = href;",
        "// Line_Reference 2896: \t\t}",
        "// Line_Reference 2897: \t\telse",
        "// Line_Reference 2899: \t\t\t// Avoids page reload for anchors (workaround for IE but used everywhere)",
        "// Line_Reference 2900: \t\t\tif (href.substring(0, this.baseUrl.length) == this.baseUrl &&",
        "// Line_Reference 2901: \t\t\t\thref.charAt(this.baseUrl.length) == '#' &&",
        "// Line_Reference 2902: \t\t\t\ttarget == '_top' && window == window.top)",
        "// Line_Reference 2904: \t\t\t\tvar hash = href.split('#')[1];",
        "// Line_Reference 2905: ",
        "// Line_Reference 2906: \t\t\t\t// Forces navigation if on same hash",
        "// Line_Reference 2907: \t\t\t\tif (window.location.hash == '#' + hash)",
        "// Line_Reference 2908: \t\t\t\t{",
        "// Line_Reference 2909: \t\t\t\t\twindow.location.hash = '';",
        "// Line_Reference 2910: \t\t\t\t}",
        "// Line_Reference 2911: ",
        "// Line_Reference 2912: \t\t\t\twindow.location.hash = hash;",
        "// Line_Reference 2916: \t\t\t\tresult = window.open(href, (target != null) ? target : '_blank');",
        "// Line_Reference 2917: ",
        "// Line_Reference 2918: \t\t\t\tif (result != null && !allowOpener)",
        "// Line_Reference 2920: \t\t\t\t\tresult.opener = null;"
    ]
}
