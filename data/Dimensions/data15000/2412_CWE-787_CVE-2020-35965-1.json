{
    "cve_id": "CVE-2020-35965",
    "cve_description": "decode_frame in libavcodec/exr.c in FFmpeg 4.3.1 has an out-of-bounds write because of errors in calculations of when to perform memset zero operations.",
    "cve_publish_date": "2021-01-04",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "avcodec/exr: skip bottom clearing loop when its outside the image\n\nFixes: signed integer overflow: 1633771809 * 32960 cannot be represented in type 'int'\nFixes: 26532/clusterfuzz-testcase-minimized-ffmpeg_AV_CODEC_ID_EXR_fuzzer-5613925708857344\n\nFound-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "exr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1845:     for (i = 0; i < planes; i++) {",
        "// Line_Reference 1846:         ptr = picture->data[i] + (ymax * picture->linesize[i]);",
        "// Line_Reference 1847:         for (y = ymax; y < avctx->height; y++) {",
        "// Line_Reference 1848:             memset(ptr, 0, out_line_size);",
        "// Line_Reference 1849:             ptr += picture->linesize[i];",
        "// Line_Reference 1851:     }"
    ]
}
