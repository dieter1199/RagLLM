{
    "cve_id": "CVE-2022-28055",
    "cve_description": "Fusionpbx v4.4 and below contains a command injection vulnerability via the download email logs function.",
    "cve_publish_date": "2022-05-04",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Remove email_logs download. (#6331)\n\n* Remove email_logs download.\r\n\r\nThis feature has a security risk that is being eliminated by removing the download feature.\r\n\r\n* Update email_logs.php",
    "type_of_change": "Modification",
    "filename_of_changes": "email_logs.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 47: \t\t\tcase 'download':",
        "// Line_Reference 48: \t\t\t\tif (permission_exists('email_log_download')) {",
        "// Line_Reference 49: \t\t\t\t\t$obj = new email_logs;",
        "// Line_Reference 50: \t\t\t\t\t$obj->download($emails);",
        "// Line_Reference 51: \t\t\t\t\tmessage::add($text['message-download_failed'],'negative',7000); //download failed, set message",
        "// Line_Reference 52: \t\t\t\t}",
        "// Line_Reference 53: \t\t\t\tbreak;",
        "// Line_Reference 217: \tif (permission_exists('email_log_download') && $result) {",
        "// Line_Reference 218: \t\techo button::create(['type'=>'button','label'=>$text['button-download'],'icon'=>$_SESSION['theme']['button_icon_download'],'onclick'=>\"list_action_set('download'); list_form_submit('form_list');\"]);",
        "// Line_Reference 219: \t}",
        "// Line_Reference 289: \tif (permission_exists('email_log_download') || permission_exists('email_log_resend') || permission_exists('email_log_delete')) {",
        "// Line_Reference 312: \t\t\tif (permission_exists('email_log_download') || permission_exists('email_log_resend') || permission_exists('email_log_delete')) {",
        "// Line_Reference 329: \t\t\tif (permission_exists('email_log_download')) {",
        "// Line_Reference 330: \t\t\t\techo button::create(['type'=>'button','title'=>$text['button-download'],'icon'=>$_SESSION['theme']['button_icon_download'],'onclick'=>\"list_self_check('checkbox_\".$x.\"'); list_action_set('download'); list_form_submit('form_list')\"]);",
        "// Line_Reference 331: \t\t\t}"
    ]
}
