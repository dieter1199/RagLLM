{
    "cve_id": "CVE-2020-29159",
    "cve_description": "An issue was discovered in Zammad before 3.5.1. The default signup Role (for newly created Users) can be a privileged Role, if configured by an admin. This behvaior was unintended.",
    "cve_publish_date": "2020-12-28",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Maintenance: Provide allow_signup column to define the signup permissions for roles and disable new permissions by default as signup permission.",
    "type_of_change": "Modification",
    "filename_of_changes": "role.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 225:     all_permissions = Permission.all.pluck(:id)",
        "// Line_Reference 226:     admin_permissions = Permission.where('name LIKE ? OR name = ?', 'admin%', 'ticket.agent').pluck(:id) # admin.*/ticket.agent permissions",
        "// Line_Reference 227:     normal_permissions = (all_permissions - admin_permissions) | (admin_permissions - all_permissions) # all other permissions besides admin.*/ticket.agent",
        "// Line_Reference 228:     return true if default_at_signup != true # means if default_at_signup = false, no need further checks",
        "// Line_Reference 229:     return true if self.permission_ids.all? { |i| normal_permissions.include? i } # allow user to choose only normal permissions",
        "// Line_Reference 231:     raise Exceptions::UnprocessableEntity, 'Cannot set default at signup when role has admin or ticket.agent permissions.'"
    ]
}
