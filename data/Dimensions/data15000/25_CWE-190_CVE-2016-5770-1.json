{
    "cve_id": "CVE-2016-5770",
    "cve_description": "Integer overflow in the SplFileObject::fread function in spl_directory.c in the SPL extension in PHP before 5.5.37 and 5.6.x before 5.6.23 allows remote attackers to cause a denial of service or possibly have unspecified other impact via a large integer argument, a related issue to CVE-2016-5096.",
    "cve_publish_date": "2016-08-07",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Fix bug #72262 - do not overflow int",
    "type_of_change": "Modification",
    "filename_of_changes": "spl_directory.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "111",
    "number_of_lines_deleted_vulnerable_to_cve": "107",
    "vulnerable_lines": [
        "// Line_Reference 82: ",
        "// Line_Reference 84: ",
        "// Line_Reference 101: \t\t}",
        "// Line_Reference 137: /* creates the object by",
        "// Line_Reference 138:    - allocating memory",
        "// Line_Reference 143:    called from",
        "// Line_Reference 316: ",
        "// Line_Reference 328:    Load the 'other' object",
        "// Line_Reference 373: ",
        "// Line_Reference 392: ",
        "// Line_Reference 416: ",
        "// Line_Reference 462: ",
        "// Line_Reference 517: ",
        "// Line_Reference 533: ",
        "// Line_Reference 536: ",
        "// Line_Reference 537: \t\t\tif (ht && zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"|sbr\",",
        "// Line_Reference 538: \t\t\t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len,",
        "// Line_Reference 547: ",
        "// Line_Reference 556: \tcase SPL_FS_DIR:",
        "// Line_Reference 620: ",
        "// Line_Reference 668: ",
        "// Line_Reference 674: ",
        "// Line_Reference 754: ",
        "// Line_Reference 772: ",
        "// Line_Reference 802: ",
        "// Line_Reference 862: ",
        "// Line_Reference 878: ",
        "// Line_Reference 894: ",
        "// Line_Reference 900: ",
        "// Line_Reference 914: ",
        "// Line_Reference 1022: /* }}}*/",
        "// Line_Reference 1032: ",
        "// Line_Reference 1068: ",
        "// Line_Reference 1087: ",
        "// Line_Reference 1110: ",
        "// Line_Reference 1124: ",
        "// Line_Reference 1125:    When the constructor gets called the object is already created",
        "// Line_Reference 1143: ",
        "// Line_Reference 1147: ",
        "// Line_Reference 1252: ",
        "// Line_Reference 1300: ",
        "// Line_Reference 1310: ",
        "// Line_Reference 1313: \t} else {",
        "// Line_Reference 1351: ",
        "// Line_Reference 1369: ",
        "// Line_Reference 1387: ",
        "// Line_Reference 1405: ",
        "// Line_Reference 1466: ",
        "// Line_Reference 1522: ",
        "// Line_Reference 1526: ",
        "// Line_Reference 1557: ",
        "// Line_Reference 1578: ",
        "// Line_Reference 1614: ",
        "// Line_Reference 1669: ",
        "// Line_Reference 1704: ",
        "// Line_Reference 1722: ",
        "// Line_Reference 1736: ",
        "// Line_Reference 1806: ",
        "// Line_Reference 1827: ",
        "// Line_Reference 1871: ",
        "// Line_Reference 1927: ZEND_BEGIN_ARG_INFO(arginfo_info___construct, 0)",
        "// Line_Reference 1986: ZEND_BEGIN_ARG_INFO(arginfo_dir___construct, 0)",
        "// Line_Reference 1990: ZEND_BEGIN_ARG_INFO(arginfo_dir_it_seek, 0)",
        "// Line_Reference 2012: ZEND_BEGIN_ARG_INFO_EX(arginfo_r_dir___construct, 0, 0, 1)",
        "// Line_Reference 2061: ",
        "// Line_Reference 2089: ",
        "// Line_Reference 2110: ",
        "// Line_Reference 2136: ",
        "// Line_Reference 2162: ",
        "// Line_Reference 2166: ",
        "// Line_Reference 2240: ",
        "// Line_Reference 2263: ",
        "// Line_Reference 2297: \tif (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"p|sbr!\",",
        "// Line_Reference 2299: \t\t\t&intern->u.file.open_mode, &intern->u.file.open_mode_len,",
        "// Line_Reference 2300: \t\t\t&use_include_path, &intern->u.file.zcontext) == FAILURE) {",
        "// Line_Reference 2306: ",
        "// Line_Reference 2371: ",
        "// Line_Reference 2384: ",
        "// Line_Reference 2397: ",
        "// Line_Reference 2410: ",
        "// Line_Reference 2427: ",
        "// Line_Reference 2443: ",
        "// Line_Reference 2464: ",
        "// Line_Reference 2481: ",
        "// Line_Reference 2533: ",
        "// Line_Reference 2542: ",
        "// Line_Reference 2557: ",
        "// Line_Reference 2588: ",
        "// Line_Reference 2630: ",
        "// Line_Reference 2673: ",
        "// Line_Reference 2716: ",
        "// Line_Reference 2745: \tspl_filesystem_object *intern = (spl_filesystem_object*)zend_object_store_get_object(getThis() TSRMLS_CC);",
        "// Line_Reference 2895: ",
        "// Line_Reference 2904: ",
        "// Line_Reference 2914: ",
        "// Line_Reference 2920: \t\tRETURN_FALSE;",
        "// Line_Reference 2922: ",
        "// Line_Reference 2924: ",
        "// Line_Reference 2961: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_flock, 0, 0, 1)",
        "// Line_Reference 2966: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fseek, 0, 0, 1)",
        "// Line_Reference 2971: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fgetss, 0, 0, 0)",
        "// Line_Reference 2975: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fscanf, 1, 0, 1)",
        "// Line_Reference 2979: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_fwrite, 0, 0, 1)",
        "// Line_Reference 2988: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_ftruncate, 0, 0, 1)",
        "// Line_Reference 2992: ZEND_BEGIN_ARG_INFO_EX(arginfo_file_object_seek, 0, 0, 1)",
        "// Line_Reference 3081: ",
        "// Line_Reference 3098: "
    ]
}
