{
    "cve_id": "CVE-2021-21321",
    "cve_description": "fastify-reply-from is an npm package which is a fastify plugin to forward the current http request to another server. In fastify-reply-from before version 4.0.2, by crafting a specific URL, it is possible to escape the prefix of the proxied backend service. If the base url of the proxied server is \"/pub/\", a user expect that accessing \"/priv\" on the target service would not be possible. In affected versions, it is possible. This is fixed in version 4.0.2.",
    "cve_publish_date": "2021-03-02",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Merge pull request from GHSA-qmw8-3v4g-gwj4\n\n* fix: Re-enable unix+http:// base URL, prevent escape of base URL path\n\nCo-Authored-By: Corey Farrell <git@cfware.com>\n\n* More fixes\n\n* Test more build-url error cases\n\nCo-authored-by: Corey Farrell <git@cfware.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 62:   if (reqBase && !reqBase.startsWith(dest.origin)) {",
        "// Line_Reference 63:     throw new Error('source must be a relative path string')"
    ]
}
