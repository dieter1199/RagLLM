{
    "cve_id": "CVE-2022-24804",
    "cve_description": "Discourse is an open source platform for community discussion. In stable versions prior to 2.8.3 and beta versions prior 2.9.0.beta4 erroneously expose groups. When a group with restricted visibility has been used to set the permissions of a category, the name of the group is leaked to any user that is able to see the category. To workaround the problem, a site administrator can remove groups with restricted visibility from any category's permissions setting.",
    "cve_publish_date": "2022-04-11",
    "cwe_id": "CWE-276",
    "cwe_name": "Incorrect Default Permissions",
    "cwe_description": "During installation, installed file permissions are set to allow anyone to modify those files.",
    "commit_message": "SECURITY: Category group permissions leaked to normal users.\n\nAfter this commit, category group permissions can only be seen by users\nthat are allowed to manage a category. In the past, we inadvertently\nincluded a category's group permissions settings in `CategoriesController#show`\nand `CategoriesController#find_by_slug` endpoints for normal users when\nthose settings are only a concern to users that can manage a category.",
    "type_of_change": "Modification",
    "filename_of_changes": "categories_controller.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 5:   requires_login except: [:index, :categories_and_latest, :categories_and_top, :show, :redirect, :find_by_slug]",
        "// Line_Reference 7:   before_action :fetch_category, only: [:show, :update, :destroy]"
    ]
}
