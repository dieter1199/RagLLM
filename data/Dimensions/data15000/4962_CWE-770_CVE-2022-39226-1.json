{
    "cve_id": "CVE-2022-39226",
    "cve_description": "Discourse is an open source discussion platform. In versions prior to 2.8.9 on the `stable` branch and prior to 2.9.0.beta10 on the `beta` and `tests-passed` branches, a malicious actor can add large payloads of text into the Location and Website fields of a user profile, which causes issues for other users when loading that profile. A fix to limit the length of user input for these fields is included in version 2.8.9 on the `stable` branch and version 2.9.0.beta10 on the `beta` and `tests-passed` branches. There are no known workarounds.",
    "cve_publish_date": "2022-09-29",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "SECURITY: Limit user profile field length (#18302)\n\nAdds limits to location and website fields at model and DB level\r\nto match the bio_raw field limits. A limit cannot be added at the\r\nDB level for bio_raw because it is a postgres text field.\r\n\r\nCo-authored-by: Alan Guo Xiang Tan <gxtan1990@gmail.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "user_profile.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 16:   validates :website, url: true, allow_blank: true, if: :validate_website?",
        "// Line_Reference 18:   validates :location, watched_words: true",
        "// Line_Reference 191: #  location                     :string",
        "// Line_Reference 192: #  website                      :string"
    ]
}
