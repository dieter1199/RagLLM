{
    "cve_id": "CVE-2022-41936",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The `modifications` rest endpoint does not filter out entries according to the user's rights. Therefore, information hidden from unauthorized users are exposed though the `modifications` rest endpoint (comments and page names etc). Users should upgrade to XWiki 14.6+, 14.4.3+, or 13.10.8+. Older versions have not been patched. There are no known workarounds.",
    "cve_publish_date": "2022-11-22",
    "cwe_id": "CWE-359",
    "cwe_name": "Exposure of Private Personal Information to an Unauthorized Actor",
    "cwe_description": "The product does not properly prevent a person's private, personal information from being accessed by actors who either (1) are not explicitly authorized to access the information or (2) do not have the implicit consent of the person about whom the information is collected.",
    "commit_message": "XWIKI-19997: Improved modifications rest endpoint history summary filtering",
    "type_of_change": "Modification",
    "filename_of_changes": "ModificationsResourceImpl.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 70:                 String language = (String) fields[2];",
        "// Line_Reference 71:                 if (language.equals(\"\")) {",
        "// Line_Reference 72:                     language = null;",
        "// Line_Reference 73:                 }",
        "// Line_Reference 74:                 XWikiRCSNodeId nodeId = (XWikiRCSNodeId) fields[3];",
        "// Line_Reference 75:                 Timestamp timestamp = (Timestamp) fields[4];",
        "// Line_Reference 76:                 Date modified = new Date(timestamp.getTime());",
        "// Line_Reference 77:                 String modifier = (String) fields[5];",
        "// Line_Reference 78:                 String comment = (String) fields[6];",
        "// Line_Reference 80:                 HistorySummary historySummary = DomainObjectFactory.createHistorySummary(objectFactory,",
        "// Line_Reference 81:                         uriInfo.getBaseUri(), wikiName, spaces, pageName, language, nodeId.getVersion(), modifier,",
        "// Line_Reference 82:                         modified, comment, Utils.getXWikiApi(componentManager), withPrettyNames);",
        "// Line_Reference 84:                 history.getHistorySummaries().add(historySummary);"
    ]
}
