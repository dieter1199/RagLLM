{
    "cve_id": "CVE-2017-15365",
    "cve_description": "sql/event_data_objects.cc in MariaDB before 10.1.30 and 10.2.x before 10.2.10 and Percona XtraDB Cluster before 5.6.37-26.21-3 and 5.7.x before 5.7.19-29.22-3 allows remote authenticated users with SQL access to bypass intended access restrictions and replicate data definition language (DDL) statements to cluster nodes by leveraging incorrect ordering of DDL replication and ACL checking.",
    "cve_publish_date": "2018-01-25",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "MW-416 DDL replication moved after acl checking\n\ngalera_events test shows a regression with the original fix for MW-416\nReason was that Events::drop_event() can be called also from inside event\nexecution, and there we have a speacial treatment for event, which executes\n\"DROP EVENT\" statement, and runs TOI replication inside the event processing body.\nThis resulted in executing WSREP_TO_ISOLATION two times for such DROP EVENT statement.\nFix is to call WSREP_TO_ISOLATION_BEGIN only in Events::drop_event()",
    "type_of_change": "Modification",
    "filename_of_changes": "event_data_objects.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1475:       if (WSREP(thd))",
        "// Line_Reference 1476:       {",
        "// Line_Reference 1478:         WSREP_TO_ISOLATION_BEGIN(WSREP_MYSQL_DB, NULL, NULL);",
        "// Line_Reference 1479:       }",
        "// Line_Reference 1483:       WSREP_TO_ISOLATION_END;",
        "// Line_Reference 1485: #ifdef WITH_WSREP",
        "// Line_Reference 1486:   error:",
        "// Line_Reference 1487: #endif"
    ]
}
