{
    "cve_id": "CVE-2017-11664",
    "cve_description": "The _WM_SetupMidiEvent function in internal_midi.c:2122 in WildMIDI 0.4.2 can cause a denial of service (invalid memory read and application crash) via a crafted mid file.",
    "cve_publish_date": "2017-08-17",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix bug #175:\n\nCVE-2017-11661, CVE-2017-11662, CVE-2017-11663, CVE-2017-11664:\nAdd a new size parameter to _WM_SetupMidiEvent() so that it\nknows where to stop reading, and adjust its clients properly.",
    "type_of_change": "Modification",
    "filename_of_changes": "f_midi.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 46:     uint32_t track_size;",
        "// Line_Reference 59: //  uint32_t sysex_store_len = 0;",
        "// Line_Reference 65: //  uint32_t tmp_length = 0;",
        "// Line_Reference 66: //  uint8_t current_event = 0;",
        "// Line_Reference 67: //  uint8_t current_event_ch = 0;",
        "// Line_Reference 171:         track_size = *midi_data++ << 24;",
        "// Line_Reference 172:         track_size |= *midi_data++ << 16;",
        "// Line_Reference 173:         track_size |= *midi_data++ << 8;",
        "// Line_Reference 174:         track_size |= *midi_data++;",
        "// Line_Reference 176:         if (midi_size < track_size) {",
        "// Line_Reference 180:         if (track_size < 3) {",
        "// Line_Reference 184:         if ((midi_data[track_size - 3] != 0xFF)",
        "// Line_Reference 185:                 || (midi_data[track_size - 2] != 0x2F)",
        "// Line_Reference 186:                 || (midi_data[track_size - 1] != 0x00)) {",
        "// Line_Reference 191:         midi_data += track_size;",
        "// Line_Reference 192:         midi_size -= track_size;",
        "// Line_Reference 246:                     setup_ret = _WM_SetupMidiEvent(mdi, tracks[i], running_event[i]);",
        "// Line_Reference 307:                 setup_ret = _WM_SetupMidiEvent(mdi, tracks[i], running_event[i]);"
    ]
}
