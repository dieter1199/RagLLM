{
    "cve_id": "CVE-2021-4249",
    "cve_description": "A vulnerability was found in xml-conduit. It has been classified as problematic. Affected is an unknown function of the file xml-conduit/src/Text/XML/Stream/Parse.hs of the component DOCTYPE Entity Expansion Handler. The manipulation leads to infinite loop. It is possible to launch the attack remotely. Upgrading to version 1.9.1.0 is able to address this issue. The name of the patch is 4be1021791dcdee8b164d239433a2043dc0939ea. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216204.",
    "cve_publish_date": "2022-12-18",
    "cwe_id": "CWE-404",
    "cwe_name": "Improper Resource Shutdown or Release",
    "cwe_description": "The product does not release or incorrectly releases a resource before it is made available for re-use.",
    "commit_message": "Resolve entities defined in DOCTYPE recursively\n\nEntity expansion loops are detected and avoided.\r\n\r\nIn addition, there is a limit on the length of an\r\nentity expansion (to guard against attacks like the\r\nbillion laughs attack). This can be adjusted using\r\nthe new exported field `psEntityExpansionSizeLimit`\r\non ParseSettings. By default it is set at 8192.\r\n\r\nAdd tests, including a test for the billion laughs attack.",
    "type_of_change": "Modification",
    "filename_of_changes": "Parse.hs",
    "code_language": "Haskell",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 199:             | otherwise = (((tname, map resolve val):) .)",
        "// Line_Reference 215:     resolve (ContentEntity e)",
        "// Line_Reference 216:         | Just t <- lookup e es = ContentText t",
        "// Line_Reference 217:     resolve c = c",
        "// Line_Reference 230: tokenToEvent _ es n (TokenContent (ContentEntity e))",
        "// Line_Reference 231:     | Just t <- lookup e es = (es, n, [EventContent $ ContentText t])",
        "// Line_Reference 558: parseContent (ParseSettings decodeEntities _ decodeIllegalCharacters) breakDouble breakSingle = parseReference <|> parseTextContent where"
    ]
}
