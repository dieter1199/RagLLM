int ff_amf_get_field_value(const uint8_t *data, const uint8_t *data_end,
while (*data != AMF_DATA_TYPE_OBJECT && data < data_end) {
len = ff_amf_tag_size(data, data_end);
if (len < 0)
len = data_end - data;
data += len;
if (data_end - data < 3)
data++;
int size = bytestream_get_be16(&data);
if (size < 0 || size >= data_end - data)
data += size;
if (size == namelen && !memcmp(data-size, name, namelen)) {
switch (*data++) {
snprintf(dst, dst_size, "%g", av_int2double(AV_RB64(data)));
snprintf(dst, dst_size, "%s", *data ? "true" : "false");
len = bytestream_get_be16(&data);
av_strlcpy(dst, data, FFMIN(len+1, dst_size));
len = ff_amf_tag_size(data, data_end);
if (len < 0 || len >= data_end - data)
data += len;