import java.net.InetAddress;
String clientIp = request.getHeader("X-Forwarded-For");
if (clientIp == null) clientIp = request.getRemoteAddr();
if (!InetAddress.getByName(clientIp).isLoopbackAddress()) {
"Git hook callbacks can only be accessed from localhost.");
List<String> fields = StringUtils.splitAndTrim(request.getPathInfo(), "/");
Preconditions.checkState(fields.size() == 2);
