-- If there is an associated exported PDF, expire it too.
when exists $ liftIO $ do
liftIO $ removeFile target
expireCachedPDF target (defaultExtension cfg)
expireCachedPDF :: String -> String -> IO ()
expireCachedPDF file ext =
when (takeExtension file == "." ++ ext) $ do
let pdfname = file ++ ".export.pdf"
exists <- doesFileExist pdfname
when exists $ removeFile pdfname
expireCachedPDF target (defaultExtension cfg)
