extraSessionData: Record<string, any> = {},
if (existingSession.first_known_index()
<= session.first_known_index()
&& !(existingSession.first_known_index() == session.first_known_index()
&& !extraSessionData.untrusted
&& existingSessionData.untrusted)) {
// existing session has lower index (i.e. can
// decrypt more), or they have the same index and
// the new sessions trust does not win over the old
// sessions trust, so keep it
logger.log(`Keeping existing megolm session ${sessionId}`);
return;
"forwarding_curve25519_key_chain":
sessionData.forwardingCurve25519KeyChain || [],