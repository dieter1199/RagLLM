{
    "cve_id": "CVE-2022-4093",
    "cve_description": "SQL injection attacks can result in unauthorized access to sensitive data, such as passwords, credit card details, or personal user information. Many high-profile data breaches in recent years have been the result of SQL injection attacks, leading to reputational damage and regulatory fines. In some cases, an attacker can obtain a persistent backdoor into an organization's systems, leading to a long-term compromise that can go unnoticed for an extended period. This affect 16.0.1 and 16.0.2 only. 16.0.0 or lower, and 16.0.3 or higher are not affected",
    "cve_publish_date": "2022-11-21",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fix sqli ->escape after ->escapeforlike",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "website.lib.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 890:  * @return  string\t\t\t\t\t\t\tHTML content",
        "// Line_Reference 937: \t\t\t$sql .= \" AND wp.lang ='\".$db->escape($langcode).\"'\";",
        "// Line_Reference 950: \t\t\t$searchalgo .= ($searchalgo ? ' OR ' : '').\"wp.title LIKE '%\".$db->escapeforlike($db->escape($searchstring)).\"%' OR wp.description LIKE '%\".$db->escapeforlike($db->escape($searchstring)).\"%'\";",
        "// Line_Reference 951: \t\t\t$searchalgo .= ($searchalgo ? ' OR ' : '').\"wp.keywords LIKE '\".$db->escapeforlike($db->escape($searchstring)).\",%' OR wp.keywords LIKE '% \".$db->escapeforlike($db->escape($searchstring)).\"%'\"; // TODO Use a better way to scan keywords",
        "// Line_Reference 954: \t\t\t$searchalgo .= ($searchalgo ? ' OR ' : '').\"wp.content LIKE '%\".$db->escapeforlike($db->escape($searchstring)).\"%'\";"
    ]
}
