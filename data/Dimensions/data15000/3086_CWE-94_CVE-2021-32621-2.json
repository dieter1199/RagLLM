{
    "cve_id": "CVE-2021-32621",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In versions prior to 12.6.7 and 12.10.3, a user without Script or Programming right is able to execute script requiring privileges by editing gadget titles in the dashboard. The issue has been patched in XWiki 12.6.7, 12.10.3 and 13.0RC1.",
    "cve_publish_date": "2021-05-28",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "XWIKI-17794: Properly interpret velocity in gadget titles",
    "type_of_change": "Modification",
    "filename_of_changes": "DefaultGadgetSourceTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "51",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 126:         VelocityEngine velocityEngine = mock(VelocityEngine.class);",
        "// Line_Reference 128:         when(velocityEngine.evaluate(any(), any(), any(), any(String.class))).then((Answer<Void>) invocation -> {",
        "// Line_Reference 129:             Object[] args = invocation.getArguments();",
        "// Line_Reference 130:             StringWriter stringWriter = (StringWriter) args[1];",
        "// Line_Reference 131:             String title = (String) args[3];",
        "// Line_Reference 132:             stringWriter.append(title);",
        "// Line_Reference 133:             return null;",
        "// Line_Reference 134:         });",
        "// Line_Reference 136:         AuthorExecutor authorExecutor = componentManager.getInstance(AuthorExecutor.class);",
        "// Line_Reference 142:         ContentExecutor<MacroTransformationContext> contentExecutor =",
        "// Line_Reference 169:         assertEquals(\"Gadget 1\", gadget.getTitle().get(0).toString());"
    ]
}
