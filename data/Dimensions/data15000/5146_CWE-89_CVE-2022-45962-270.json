{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Portal.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 700:                                                   ON (gg.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' AND gg.ASSIGNMENT_ID=ga.ASSIGNMENT_ID AND gg.STUDENT_ID=\\'' . UserStudentID() . '\\'),gradebook_assignment_types at",
        "// Line_Reference 701:                                                   WHERE (ga.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' OR ga.COURSE_ID=\\'' . $course[COURSE_ID] . '\\' AND ga.STAFF_ID=\\'' . $staff_id . '\\') AND ga.MARKING_PERIOD_ID=\\'' . UserMP() . '\\'",
        "// Line_Reference 720:                                                    AND (ga.POINTS!=\\'0\\') ORDER BY ga.ASSIGNMENT_ID DESC'));",
        "// Line_Reference 726:                                                   WHERE (ga.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' OR ga.COURSE_ID=\\'' . $course[COURSE_ID] . '\\' AND ga.STAFF_ID=\\'' . $staff_id . '\\') AND (ga.MARKING_PERIOD_ID=\\'' . UserMP() . '\\' or ga.MARKING_PERIOD_ID=' . $full_year_mp . ')",
        "// Line_Reference 728:                                                    AND (ga.POINTS!=\\'0\\') ORDER BY ga.ASSIGNMENT_ID DESC'));",
        "// Line_Reference 808: \t\t\tAND NOT EXISTS (SELECT \\'\\' FROM grades_completed ac WHERE ac.STAFF_ID=cp.TEACHER_ID AND ac.MARKING_PERIOD_ID=\\'' . $_REQUEST[mp] . '\\' AND ac.PERIOD_ID=sp.PERIOD_ID)",
        "// Line_Reference 820:                                                   ON (gg.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' AND gg.ASSIGNMENT_ID=ga.ASSIGNMENT_ID AND gg.STUDENT_ID=\\'' . UserStudentID() . '\\'),gradebook_assignment_types at",
        "// Line_Reference 821:                                                   WHERE (ga.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' OR ga.COURSE_ID=\\'' . $course[COURSE_ID] . '\\' AND ga.STAFF_ID=\\'' . $staff_id . '\\') AND ga.MARKING_PERIOD_ID=\\'' . UserMP() . '\\'",
        "// Line_Reference 826:             $ASSIGNMENT_ID_GRADED = implode(\",\", $GRADED_ASSIGNMENT_ID);",
        "// Line_Reference 835:                 $assignments_RET = DBGet(DBQuery('SELECT ga.ASSIGNMENT_ID,ga.TITLE,ga.DESCRIPTION as COMMENT,ga.ASSIGNED_DATE,ga.DUE_DATE,ga.POINTS AS POINTS_POSSIBLE,at.TITLE AS CATEGORY FROM gradebook_assignments ga, gradebook_assignment_types at    WHERE ga.ASSIGNMENT_ID NOT IN ' . $GRADED_ASSIGNMENT . ' AND (ga.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' OR ga.COURSE_ID=\\'' . $course[COURSE_ID] . '\\' AND ga.STAFF_ID=\\'' . $staff_id . '\\') AND (ga.MARKING_PERIOD_ID=\\'' . UserMP() . '\\'or ga.MARKING_PERIOD_ID=' . $full_year_mp . ')",
        "// Line_Reference 844:                                                   WHERE (ga.COURSE_PERIOD_ID=\\'' . $course[COURSE_PERIOD_ID] . '\\' OR ga.COURSE_ID=\\'' . $course[COURSE_ID] . '\\' AND ga.STAFF_ID=\\'' . $staff_id . '\\') AND (ga.MARKING_PERIOD_ID=\\'' . UserMP() . '\\' or ga.MARKING_PERIOD_ID=' . $full_year_mp . ')"
    ]
}
