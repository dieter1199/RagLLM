{
    "cve_id": "CVE-2022-0122",
    "cve_description": "forge is vulnerable to URL Redirection to Untrusted Site",
    "cve_publish_date": "2022-01-06",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "Remove forge.util.parseUrl.\n\n- Switch URL parsing to the WHATWG URL Standard `URL` API.\n- Older browser or Node.js usage of related code might now require a URL\n  polyfill.",
    "type_of_change": "Modification",
    "filename_of_changes": "util.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "37",
    "vulnerable_lines": [
        "// Line_Reference 2261: /**",
        "// Line_Reference 2262:  * Parses the scheme, host, and port from an http(s) url.",
        "// Line_Reference 2263:  *",
        "// Line_Reference 2264:  * @param str the url string.",
        "// Line_Reference 2265:  *",
        "// Line_Reference 2266:  * @return the parsed url object or null if the url is invalid.",
        "// Line_Reference 2267:  */",
        "// Line_Reference 2268: util.parseUrl = function(str) {",
        "// Line_Reference 2269:   // FIXME: this regex looks a bit broken",
        "// Line_Reference 2270:   var regex = /^(https?):\\/\\/([^:&^\\/]*):?(\\d*)(.*)$/g;",
        "// Line_Reference 2271:   regex.lastIndex = 0;",
        "// Line_Reference 2272:   var m = regex.exec(str);",
        "// Line_Reference 2273:   var url = (m === null) ? null : {",
        "// Line_Reference 2274:     full: str,",
        "// Line_Reference 2275:     scheme: m[1],",
        "// Line_Reference 2276:     host: m[2],",
        "// Line_Reference 2277:     port: m[3],",
        "// Line_Reference 2278:     path: m[4]",
        "// Line_Reference 2279:   };",
        "// Line_Reference 2280:   if(url) {",
        "// Line_Reference 2281:     url.fullHost = url.host;",
        "// Line_Reference 2282:     if(url.port) {",
        "// Line_Reference 2283:       if(url.port !== 80 && url.scheme === 'http') {",
        "// Line_Reference 2284:         url.fullHost += ':' + url.port;",
        "// Line_Reference 2285:       } else if(url.port !== 443 && url.scheme === 'https') {",
        "// Line_Reference 2286:         url.fullHost += ':' + url.port;",
        "// Line_Reference 2287:       }",
        "// Line_Reference 2288:     } else if(url.scheme === 'http') {",
        "// Line_Reference 2289:       url.port = 80;",
        "// Line_Reference 2290:     } else if(url.scheme === 'https') {",
        "// Line_Reference 2291:       url.port = 443;",
        "// Line_Reference 2292:     }",
        "// Line_Reference 2293:     url.full = url.scheme + '://' + url.fullHost;",
        "// Line_Reference 2294:   }",
        "// Line_Reference 2295:   return url;",
        "// Line_Reference 2296: };",
        "// Line_Reference 2297: "
    ]
}
