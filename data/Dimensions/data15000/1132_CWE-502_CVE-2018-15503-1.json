{
    "cve_id": "CVE-2018-15503",
    "cve_description": "The unpack implementation in Swoole version 4.0.4 lacks correct size checks in the deserialization process. An attacker can craft a serialized object to exploit this vulnerability and cause a SEGV.",
    "cve_publish_date": "2018-08-18",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "add buffer end check",
    "type_of_change": "Modification",
    "filename_of_changes": "swoole_serialize.c",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "87",
    "number_of_lines_deleted_vulnerable_to_cve": "77",
    "vulnerable_lines": [
        "// Line_Reference 123:         /* no break */",
        "// Line_Reference 125:         /* no break */",
        "// Line_Reference 127:         /* no break */",
        "// Line_Reference 129:         /* no break */",
        "// Line_Reference 131:         /* no break */",
        "// Line_Reference 133:         /* no break */",
        "// Line_Reference 135:         /* no break */",
        "// Line_Reference 137:         /* no break */",
        "// Line_Reference 139:         /* no break */",
        "// Line_Reference 141:         /* no break */",
        "// Line_Reference 143:         /* no break */",
        "// Line_Reference 145:         /* no break */",
        "// Line_Reference 147:         /* no break */",
        "// Line_Reference 149:         /* no break */",
        "// Line_Reference 151:         /* no break */",
        "// Line_Reference 153:         /* no break */",
        "// Line_Reference 157:         /* no break */",
        "// Line_Reference 159:         /* no break */",
        "// Line_Reference 161:         /* no break */",
        "// Line_Reference 163:         /* no break */",
        "// Line_Reference 165:         /* no break */",
        "// Line_Reference 167:         /* no break */",
        "// Line_Reference 169:         /* no break */",
        "// Line_Reference 171:         /* no break */",
        "// Line_Reference 173:         /* no break */",
        "// Line_Reference 175:         /* no break */",
        "// Line_Reference 177:         /* no break */",
        "// Line_Reference 179:         /* no break */",
        "// Line_Reference 181:         /* no break */",
        "// Line_Reference 183:         /* no break */",
        "// Line_Reference 185:         /* no break */",
        "// Line_Reference 193:         /* no break */",
        "// Line_Reference 195:         /* no break */",
        "// Line_Reference 197:         /* no break */",
        "// Line_Reference 199:         /* no break */",
        "// Line_Reference 201:         /* no break */",
        "// Line_Reference 203:         /* no break */",
        "// Line_Reference 205:         /* no break */",
        "// Line_Reference 207:         /* no break */",
        "// Line_Reference 209:         /* no break */",
        "// Line_Reference 211:         /* no break */",
        "// Line_Reference 213:         /* no break */",
        "// Line_Reference 215:         /* no break */",
        "// Line_Reference 217:         /* no break */",
        "// Line_Reference 219:         /* no break */",
        "// Line_Reference 221:         /* no break */",
        "// Line_Reference 223:         /* no break */",
        "// Line_Reference 227:         /* no break */",
        "// Line_Reference 229:         /* no break */",
        "// Line_Reference 231:         /* no break */",
        "// Line_Reference 233:         /* no break */",
        "// Line_Reference 235:         /* no break */",
        "// Line_Reference 237:         /* no break */",
        "// Line_Reference 239:         /* no break */",
        "// Line_Reference 241:         /* no break */",
        "// Line_Reference 243:         /* no break */",
        "// Line_Reference 245:         /* no break */",
        "// Line_Reference 247:         /* no break */",
        "// Line_Reference 249:         /* no break */",
        "// Line_Reference 251:         /* no break */",
        "// Line_Reference 253:         /* no break */",
        "// Line_Reference 255:         /* no break */",
        "// Line_Reference 257:         /* no break */",
        "// Line_Reference 998:                     ((SBucketType*) (buffer->buffer + p))->data_type = IS_NULL;//reset type null",
        "// Line_Reference 1253: ",
        "// Line_Reference 1292:     if (flag == UNSERIALIZE_OBJECT_TO_STDCLASS)",
        "// Line_Reference 1295:     }",
        "// Line_Reference 1296:     else",
        "// Line_Reference 1314:     zval *data,*d;",
        "// Line_Reference 1318: ",
        "// Line_Reference 1340: //            zend_hash_update(Z_OBJPROP_P(return_value),key,data);",
        "// Line_Reference 1341: //            zend_update_property(ce, return_value, ZSTR_VAL(key), ZSTR_LEN(key), data);",
        "// Line_Reference 1391: ",
        "// Line_Reference 1514:                   php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"detect the error eof\");",
        "// Line_Reference 1515:                   return SW_FALSE;",
        "// Line_Reference 1529:                   php_error_docref(NULL TSRMLS_CC, E_NOTICE, \"detect the error eof\");",
        "// Line_Reference 1530:                   return SW_FALSE;"
    ]
}
