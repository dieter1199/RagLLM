{
    "cve_id": "CVE-2022-1237",
    "cve_description": "Improper Validation of Array Index in GitHub repository radareorg/radare2 prior to 5.6.8. This vulnerability is heap overflow and may be exploitable. For more general description of heap buffer overflow, see [CWE](https://cwe.mitre.org/data/definitions/122.html).",
    "cve_publish_date": "2022-04-06",
    "cwe_id": "CWE-129",
    "cwe_name": "Improper Validation of Array Index",
    "cwe_description": "The product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within the array.",
    "commit_message": "Fix oobread segfaults in the NE bin parser ##crash\n\n* Reported by @han0nly via huntr.dev\n* Reproducers: seed1 seed2\n* BountyID: ad3c9c4c-76e7-40c8-bd4a-c095acd8bb40",
    "type_of_change": "Modification",
    "filename_of_changes": "ne.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 1: /* radare - LGPL - Copyright 2019 - GustavoLCR */",
        "// Line_Reference 86: \t\tNE_image_segment_entry *se = &bin->segment_entries[i];",
        "// Line_Reference 428: \tut16 *modref = malloc (bin->ne_header->ModRefs * sizeof (ut16));",
        "// Line_Reference 454: \t\twhile (off < start + length * sizeof (NE_image_reloc_item)) {",
        "// Line_Reference 487: \t\t\t\tif (rel.index > bin->ne_header->ModRefs) {",
        "// Line_Reference 490: \t\t\t\t\toffset = modref[rel.index - 1] + bin->header_offset + bin->ne_header->ImportNameTable;",
        "// Line_Reference 574: \tut16 size = bin->ne_header->SegCount * sizeof (NE_image_segment_entry);"
    ]
}
