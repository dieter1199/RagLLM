{
    "cve_id": "CVE-2020-11939",
    "cve_description": "In nDPI through 3.2 Stable, the SSH protocol dissector has multiple KEXINIT integer overflows that result in a controlled remote heap overflow in concat_hash_string in ssh.c. Due to the granular nature of the overflow primitive and the ability to control both the contents and layout of the nDPI library's heap memory through remote input, this vulnerability may be abused to achieve full Remote Code Execution against any network inspection stack that is linked against nDPI and uses it to perform network traffic analysis.",
    "cve_publish_date": "2020-04-23",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "ssh: fixing unsigned overflow leading to heap overflow\n\ncf GHSL-2020-051",
    "type_of_change": "Modification",
    "filename_of_changes": "ssh.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "31",
    "vulnerable_lines": [
        "// Line_Reference 98:   u_int16_t offset = 22, buf_out_len = 0;",
        "// Line_Reference 125:     offset += 4;",
        "// Line_Reference 126: ",
        "// Line_Reference 133:     offset += len;",
        "// Line_Reference 134:   } else",
        "// Line_Reference 135:     offset += 4 + len;",
        "// Line_Reference 143:     offset += 4;",
        "// Line_Reference 144: ",
        "// Line_Reference 151:     offset += len;",
        "// Line_Reference 152:   } else",
        "// Line_Reference 153:     offset += 4 + len;",
        "// Line_Reference 161:     offset += 4;",
        "// Line_Reference 162: ",
        "// Line_Reference 169:     offset += len;",
        "// Line_Reference 170:   } else",
        "// Line_Reference 171:     offset += 4 + len;",
        "// Line_Reference 179:     offset += 4;",
        "// Line_Reference 180: ",
        "// Line_Reference 187:     offset += len;",
        "// Line_Reference 188:   } else",
        "// Line_Reference 189:     offset += 4 + len;",
        "// Line_Reference 197:     offset += 4;",
        "// Line_Reference 198: ",
        "// Line_Reference 204:     offset += len;",
        "// Line_Reference 205:   } else",
        "// Line_Reference 206:     offset += 4 + len;",
        "// Line_Reference 214:     offset += 4;",
        "// Line_Reference 215: ",
        "// Line_Reference 221:     offset += len;",
        "// Line_Reference 222:   } else",
        "// Line_Reference 223:     offset += 4 + len;"
    ]
}
