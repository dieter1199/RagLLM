{
    "cve_id": "CVE-2022-1199",
    "cve_description": "A flaw was found in the Linux kernel. This flaw allows an attacker to crash the Linux kernel by simulating amateur radio from the user space, resulting in a null-ptr-deref vulnerability and a use-after-free vulnerability.",
    "cve_publish_date": "2022-08-29",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "ax25: fix NPD bug in ax25_disconnect\n\nThe ax25_disconnect() in ax25_kill_by_device() is not\nprotected by any locks, thus there is a race condition\nbetween ax25_disconnect() and ax25_destroy_socket().\nwhen ax25->sk is assigned as NULL by ax25_destroy_socket(),\na NULL pointer dereference bug will occur if site (1) or (2)\ndereferences ax25->sk.\n\nax25_kill_by_device()                | ax25_release()\n  ax25_disconnect()                  |   ax25_destroy_socket()\n    ...                              |\n    if(ax25->sk != NULL)             |     ...\n      ...                            |     ax25->sk = NULL;\n      bh_lock_sock(ax25->sk); //(1)  |     ...\n      ...                            |\n      bh_unlock_sock(ax25->sk); //(2)|\n\nThis patch moves ax25_disconnect() into lock_sock(), which can\nsynchronize with ax25_destroy_socket() in ax25_release().\n\nFail log:\n===============================================================\nBUG: kernel NULL pointer dereference, address: 0000000000000088\n...\nRIP: 0010:_raw_spin_lock+0x7e/0xd0\n...\nCall Trace:\nax25_disconnect+0xf6/0x220\nax25_device_event+0x187/0x250\nraw_notifier_call_chain+0x5e/0x70\ndev_close_many+0x17d/0x230\nrollback_registered_many+0x1f1/0x950\nunregister_netdevice_queue+0x133/0x200\nunregister_netdev+0x13/0x20\n...\n\nSigned-off-by: Duoming Zhou <duoming@zju.edu.cn>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "af_ax25.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 95: \t\t\trelease_sock(sk);"
    ]
}
