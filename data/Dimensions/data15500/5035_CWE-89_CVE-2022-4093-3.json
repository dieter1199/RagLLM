{
    "cve_id": "CVE-2022-4093",
    "cve_description": "SQL injection attacks can result in unauthorized access to sensitive data, such as passwords, credit card details, or personal user information. Many high-profile data breaches in recent years have been the result of SQL injection attacks, leading to reputational damage and regulatory fines. In some cases, an attacker can obtain a persistent backdoor into an organization's systems, leading to a long-term compromise that can go unnoticed for an extended period. This affect 16.0.1 and 16.0.2 only. 16.0.0 or lower, and 16.0.3 or higher are not affected",
    "cve_publish_date": "2022-11-21",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fix sqli ->escape after ->escapeforlike",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "list.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 505: \t\t\t\t$sql .= \" AND p.socialnetworks REGEXP '\\\"\".$db->escapeforlike($db->escape($key)).\"\\\":\\\"[^\\\"]*\".$db->escapeforlike($db->escape($searchkeyinjsonformat)).\"'\";",
        "// Line_Reference 507: \t\t\t\t$sql .= \" AND p.socialnetworks ~ '\\\"\".$db->escapeforlike($db->escape($key)).\"\\\":\\\"[^\\\"]*\".$db->escapeforlike($db->escape($searchkeyinjsonformat)).\"'\";",
        "// Line_Reference 510: \t\t\t\t$sql .= \" AND p.socialnetworks LIKE '%\\\"\".$db->escapeforlike($db->escape($key)).\"\\\":\\\"\".$db->escapeforlike($db->escape($searchkeyinjsonformat)).\"%'\";"
    ]
}
