{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "AttendanceData.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 47:     echo \"<FORM class=form-horizontal name=percentform action=Modules.php?modname=\" . strip_tags(trim($_REQUEST[modname])) . \"&list_by_day=\" . strip_tags(trim($_REQUEST[list_by_day])) . \"&day_start=\" . strip_tags(trim($_REQUEST[day_start])) . \"&day_end=\" . strip_tags(trim($_REQUEST[day_end])) . \"&month_start=\" . strip_tags(trim($_REQUEST[month_start])) . \"&month_end=\" . strip_tags(trim($_REQUEST[month_end])) . \"&year_start=\" . strip_tags(trim($_REQUEST[year_start])) . \"&year_end=\" . strip_tags(trim($_REQUEST[year_end])) . \" method=POST>\";",
        "// Line_Reference 59:     $btn = '<div class=\"p-l-20\">' . Buttons(submit,'','onclick=\"self_disable(this);\"') . '</div>';",
        "// Line_Reference 74:     echo \"<FORM class=\\\"form-horizontal clearfix m-b-0\\\" action=Modules.php?modname=\" . strip_tags(trim($_REQUEST[modname])) . \"&list_by_day=\" . strip_tags(trim($_REQUEST[list_by_day])) . \" method=POST>\";",
        "// Line_Reference 112:             $student_days_possible = DBGet(DBQuery('SELECT ap.SCHOOL_DATE, CONCAT(s.FIRST_NAME, \\' \\', s.LAST_NAME,\\' \\') as STUDENTS, sg.TITLE as GRADE, sp.TITLE as PERIOD, ac.TITLE as STATUS from attendance_period ap, students s, school_gradelevels sg, attendance_codes ac, student_enrollment ssm, school_periods sp where ssm.syear=\\'' . UserSyear() . '\\' and ap.attendance_code=ac.id and ssm.grade_id=sg.id and ap.period_id=sp.period_id and ap.student_id=s.student_id and ssm.student_id=ap.student_id AND ssm.school_id in (' . $in_schools . ') AND ap.SCHOOL_DATE BETWEEN \\'' . $start_date . '\\' AND \\'' . $end_date . '\\' ' . $extra['WHERE'] . ''), array('SCHOOL_DATE' => 'ProperDate', 'GRADE' => 'GRADE', 'STUDENTS' => 'STUDENTS', 'PRESENT' => '_makeByDay', 'ABSENT' => '_makeByDay', 'ADA' => '_makeByDay'));",
        "// Line_Reference 118:                 $student_days_possible = DBGet(DBQuery('SELECT ap.SCHOOL_DATE, CONCAT(s.FIRST_NAME, \\' \\', s.LAST_NAME,\\' \\') as STUDENTS, sg.TITLE as GRADE, sp.TITLE as PERIOD, ac.TITLE as STATUS, sc.TITLE AS SCHOOL from attendance_period ap, students s, school_gradelevels sg, attendance_codes ac, student_enrollment ssm, school_periods sp, schools sc where ssm.syear=\\'' . UserSyear() . '\\' and ap.attendance_code=ac.id and ssm.grade_id=sg.id and ap.period_id=sp.period_id and ap.student_id=s.student_id and ssm.student_id=ap.student_id AND sc.id=ssm.school_id AND ssm.school_id in (' . $in_schools . ') AND ap.SCHOOL_DATE BETWEEN \\'' . $start_date . '\\' AND \\'' . $end_date . '\\' ' . $extra['WHERE'] . ' '), array('SCHOOL_DATE' => 'ProperDate', 'GRADE' => 'GRADE', 'STUDENTS' => 'STUDENTS', 'PRESENT' => '_makeByDay', 'ABSENT' => '_makeByDay', 'ADA' => '_makeByDay'));",
        "// Line_Reference 120:                 $student_days_possible = DBGet(DBQuery('SELECT ap.SCHOOL_DATE, CONCAT(s.FIRST_NAME, \\' \\', s.LAST_NAME,\\' \\') as STUDENTS, sg.TITLE as GRADE, sp.TITLE as PERIOD, ac.TITLE as STATUS, sc.TITLE AS SCHOOL from attendance_period ap, students s, school_gradelevels sg, attendance_codes ac, student_enrollment ssm, school_periods sp, schools sc where ssm.syear=\\'' . UserSyear() . '\\' and sc.id=\\'' . UserSchool() . '\\' and ap.attendance_code=ac.id and ssm.grade_id=sg.id and ap.period_id=sp.period_id and ap.student_id=s.student_id and ssm.student_id=ap.student_id AND sc.id=ssm.school_id AND ssm.school_id in (' . $in_schools . ') AND ap.SCHOOL_DATE BETWEEN \\'' . $start_date . '\\' AND \\'' . $end_date . '\\' ' . $extra['WHERE'] . ' '), array('SCHOOL_DATE' => 'ProperDate', 'GRADE' => 'GRADE', 'STUDENTS' => 'STUDENTS', 'PRESENT' => '_makeByDay', 'ABSENT' => '_makeByDay', 'ADA' => '_makeByDay'));"
    ]
}
