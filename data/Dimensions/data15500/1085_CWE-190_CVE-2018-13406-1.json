{
    "cve_id": "CVE-2018-13406",
    "cve_description": "An integer overflow in the uvesafb_setcmap function in drivers/video/fbdev/uvesafb.c in the Linux kernel before 4.17.4 could result in local attackers being able to crash the kernel or potentially elevate privileges because kmalloc_array is not used.",
    "cve_publish_date": "2018-07-06",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "video: uvesafb: Fix integer overflow in allocation\n\ncmap->len can get close to INT_MAX/2, allowing for an integer overflow in\nallocation. This uses kmalloc_array() instead to catch the condition.\n\nReported-by: Dr Silvio Cesare of InfoSect <silvio.cesare@gmail.com>\nFixes: 8bdb3a2d7df48 (\"uvesafb: the driver core\")\nCc: stable@vger.kernel.org\nSigned-off-by: Kees Cook <keescook@chromium.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "uvesafb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1047: \t\tentries = kmalloc(sizeof(*entries) * cmap->len, GFP_KERNEL);"
    ]
}
