{
    "cve_id": "CVE-2022-23559",
    "cve_description": "Tensorflow is an Open Source Machine Learning Framework. An attacker can craft a TFLite model that would cause an integer overflow in embedding lookup operations. Both `embedding_size` and `lookup_size` are products of values provided by the user. Hence, a malicious user could trigger overflows in the multiplication. In certain scenarios, this can then result in heap OOB read/write. Users are advised to upgrade to a patched version.",
    "cve_publish_date": "2022-02-04",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "[lite] Check for overflow when creating required bytes.\n\nPiperOrigin-RevId: 417629001\nChange-Id: Ia7feb3ea8e988f4fd4b3c98c1a1fed4557d99fd7",
    "type_of_change": "Modification",
    "filename_of_changes": "embedding_lookup_sparse.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 178:   int embedding_size = 1;",
        "// Line_Reference 179:   int lookup_size = 1;",
        "// Line_Reference 181:     const int dim = dense_shape->data.i32[i];",
        "// Line_Reference 182:     lookup_size *= dim;",
        "// Line_Reference 186:     const int dim = SizeOfDimension(value, i);",
        "// Line_Reference 187:     embedding_size *= dim;",
        "// Line_Reference 191:   const int output_size = lookup_size * embedding_size;"
    ]
}
