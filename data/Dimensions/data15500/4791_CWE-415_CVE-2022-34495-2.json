{
    "cve_id": "CVE-2022-34495",
    "cve_description": "rpmsg_probe in drivers/rpmsg/virtio_rpmsg_bus.c in the Linux kernel before 5.18.4 has a double free.",
    "cve_publish_date": "2022-06-26",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "rpmsg: virtio: Fix possible double free in rpmsg_probe()\n\nvch will be free in virtio_rpmsg_release_device() when\nrpmsg_ns_register_device() fails. There is no need to call kfree() again.\n\nFix this by changing error path from free_vch to free_ctrldev.\n\nFixes: c486682ae1e2 (\"rpmsg: virtio: Register the rpmsg_char device\")\nSigned-off-by: Hangyu Hua <hbh25y@gmail.com>\nTested-by: Arnaud Pouliquen <arnaud.pouliquen@foss.st.com>\nLink: https://lore.kernel.org/r/20220426060536.15594-2-hbh25y@gmail.com\nSigned-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "virtio_rpmsg_bus.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 976: \t\t\tgoto free_vch;",
        "// Line_Reference 1000: free_vch:",
        "// Line_Reference 1001: \tkfree(vch);"
    ]
}
