{
    "cve_id": "CVE-2022-24780",
    "cve_description": "Combodo iTop is a web based IT Service Management tool. In versions prior to 2.7.6 and 3.0.0, users of the iTop user portal can send TWIG code to the server by forging specific http queries, and execute arbitrary code on the server using http server user privileges. This issue is fixed in versions 2.7.6 and 3.0.0. There are currently no known workarounds.",
    "cve_publish_date": "2022-04-05",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "NÂ°4384 Security hardening",
    "type_of_change": "Modification",
    "filename_of_changes": "ObjectFormHandlerHelper.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 111: \t * @param string                                    $sMode",
        "// Line_Reference 112: \t * @param string                                    $sObjectClass",
        "// Line_Reference 113: \t * @param string                                    $sObjectId",
        "// Line_Reference 114: \t * @param string                                    $aFormProperties",
        "// Line_Reference 132: \t\t\t$aFormProperties = ApplicationHelper::GetLoadedFormFromClass($this->aCombodoPortalInstanceConf['forms'], $sObjectClass, $sMode);",
        "// Line_Reference 284: \t\t\t\t// Check the number of editable fields",
        "// Line_Reference 286: \t\t}",
        "// Line_Reference 287: \t\telse",
        "// Line_Reference 288: \t\t{",
        "// Line_Reference 292: \t\t\tif (empty($sFormManagerClass) || empty($sFormManagerData))",
        "// Line_Reference 293: \t\t\t{",
        "// Line_Reference 298: \t\t\t/** @var \\Combodo\\iTop\\Portal\\Form\\ObjectFormManager $oFormManager */",
        "// Line_Reference 299: \t\t\t$oFormManager = $sFormManagerClass::FromJSON($sFormManagerData);",
        "// Line_Reference 303: \t\t\tif (($oFormManager->GetActionRulesToken() !== null) && ($oFormManager->GetActionRulesToken() !== ''))",
        "// Line_Reference 304: \t\t\t{"
    ]
}
