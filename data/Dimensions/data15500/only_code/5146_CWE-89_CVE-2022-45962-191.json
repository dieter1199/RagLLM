if ((strlen($value) > 0) && ($value{0} == '"') && (substr($value,-1) == '"')) {
if ((strlen($formula) == 0) || ($formula{0} != '=')) return array();
if ($formula{0} != '=') return self::_wrapResult($formula);
} elseif ($value{0} == '#') {
$opCharacter = $formula{$index};	//	Get the first character of the value at the current index position
if ((in_array($opCharacter, $comparisonOperators)) && (strlen($formula) > $index) && (in_array($formula{$index+1}, $comparisonOperators))) {
$opCharacter .= $formula{++$index};
while (($formula{$index} == "\n") || ($formula{$index} == "\r")) {
if ($formula{$index} == ' ') {
while ($formula{$index} == ' ') {
if ($opCharacter['value'] == '(') return $this->_raiseFormulaError("Formula Error: Expecting ')'");	// if there are any opening braces on the stack, then braces were unbalanced
} elseif ((is_numeric($token)) || (is_bool($token)) || (is_null($token)) || ($token == '') || ($token{0} == '"') || ($token{0} == '#')) {
if ($operand > '' && $operand{0} == '"') { $operand = self::_unwrapResult($operand); }
if ($operand > '' && $operand{0} == '#') {
if (is_string($operand1) && $operand1 > '' && $operand1{0} == '"') { $operand1 = self::_unwrapResult($operand1); }
if (is_string($operand2) && $operand2 > '' && $operand2{0} == '"') { $operand2 = self::_unwrapResult($operand2); }