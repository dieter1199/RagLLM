{
    "cve_id": "CVE-2019-13224",
    "cve_description": "A use-after-free in onig_new_deluxe() in regext.c in Oniguruma 6.9.2 allows attackers to potentially cause information disclosure, denial of service, or possibly code execution by providing a crafted regular expression. The attacker provides a pair of a regex pattern and a string, with a multi-byte encoding that gets handled by onig_new_deluxe(). Oniguruma issues often affect Ruby, as well as common optional libraries for PHP and Rust.",
    "cve_publish_date": "2019-07-10",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "Fix CVE-2019-13224: don't allow different encodings for onig_new_deluxe()",
    "type_of_change": "Modification",
    "filename_of_changes": "regext.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 172:     r = conv_encoding(ci->pattern_enc, ci->target_enc, pattern, pattern_end,",
        "// Line_Reference 173:                       &cpat, &cpat_end);",
        "// Line_Reference 174:     if (r != 0) return r;"
    ]
}
