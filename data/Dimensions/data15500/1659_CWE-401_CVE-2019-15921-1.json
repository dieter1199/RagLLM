{
    "cve_id": "CVE-2019-15921",
    "cve_description": "An issue was discovered in the Linux kernel before 5.0.6. There is a memory leak issue when idr_alloc() fails in genl_register_family() in net/netlink/genetlink.c.",
    "cve_publish_date": "2019-09-04",
    "cwe_id": "CWE-401",
    "cwe_name": "Missing Release of Memory after Effective Lifetime",
    "cwe_description": "The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory.",
    "commit_message": "genetlink: Fix a memory leak on error path\n\nIn genl_register_family(), when idr_alloc() fails,\nwe forget to free the memory we possibly allocate for\nfamily->attrbuf.\n\nReported-by: Hulk Robot <hulkci@huawei.com>\nFixes: 2ae0f17df1cd (\"genetlink: use idr to track families\")\nSigned-off-by: YueHaibing <yuehaibing@huawei.com>\nReviewed-by: Kirill Tkhai <ktkhai@virtuozzo.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "genetlink.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 369: \t\tgoto errout_locked;"
    ]
}
