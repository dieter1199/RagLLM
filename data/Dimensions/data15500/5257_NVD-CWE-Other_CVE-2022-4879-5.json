{
    "cve_id": "CVE-2022-4879",
    "cve_description": "A vulnerability was found in Forged Alliance Forever up to 3746. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component Vote Handler. The manipulation leads to improper authorization. Upgrading to version 3747 is able to address this issue. The patch is named 6880971bd3d73d942384aff62d53058c206ce644. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217555.",
    "cve_publish_date": "2023-01-06",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Update recall feature (#4398)\n\nFix a few exploits that people could use to vote for another player",
    "type_of_change": "Modification",
    "filename_of_changes": "diplomacy.lua",
    "code_language": "Lua",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 39: local cannotRequestRecall = false",
        "// Line_Reference 41: function CannotRequestRecall()",
        "// Line_Reference 42:     return cannotRequestRecall",
        "// Line_Reference 45: function UpdateCannotRequestRecall(canRequest)",
        "// Line_Reference 46:     cannotRequestRecall = canRequest",
        "// Line_Reference 419:     if not import(\"/lua/ui/campaign/campaignmanager.lua\").campaignMode then",
        "// Line_Reference 434:         local reason = CannotRequestRecall()",
        "// Line_Reference 443:                     function()",
        "// Line_Reference 444:                         SimCallback({",
        "// Line_Reference 445:                             Func = \"SetRecallVote\",",
        "// Line_Reference 446:                             Args = {",
        "// Line_Reference 447:                                 From = GetFocusArmy(),",
        "// Line_Reference 448:                                 Vote = true,",
        "// Line_Reference 449:                             },",
        "// Line_Reference 450:                         })",
        "// Line_Reference 451:                         recallButton:Disable()",
        "// Line_Reference 452:                         cannotRequestRecall = \"active\"",
        "// Line_Reference 453:                         Tooltip.AddButtonTooltip(recallButton, \"dip_recall_request_dis_active\")",
        "// Line_Reference 454:                         import(\"/lua/ui/game/tabs.lua\").CollapseWindow()",
        "// Line_Reference 455:                     end,"
    ]
}
