{
    "cve_id": "CVE-2022-36084",
    "cve_description": "cruddl is software for creating a GraphQL API for a database, using the GraphQL SDL to model a schema. If cruddl starting with version 1.1.0 and prior to versions 2.7.0 and 3.0.2 is used to generate a schema that uses `@flexSearchFulltext`, users of that schema may be able to inject arbitrary AQL queries that will be forwarded to and executed by ArangoDB. Schemas that do not use `@flexSearchFulltext` are not affected. The attacker needs to have `READ` permission to at least one root entity type that has `@flexSearchFulltext` enabled. The issue has been fixed in version 3.0.2 and in version 2.7.0 of cruddl. As a workaround, users can temporarily remove `@flexSearchFulltext` from their schemas.",
    "cve_publish_date": "2022-09-08",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Use regular aql framework for flex search expression tokenization",
    "type_of_change": "Modification",
    "filename_of_changes": "aql-generator.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 1765: export function generateTokenizationQuery(tokensFiltered: ReadonlyArray<FlexSearchTokenizable>) {",
        "// Line_Reference 1766:     const fragments: string[] = [];",
        "// Line_Reference 1769:         fragments.push(`token_${i}: TOKENS(\"${value.expression}\", \"${value.analyzer}\")`);",
        "// Line_Reference 1771:     const query = `RETURN { ${fragments.join(',\\n')} }`;",
        "// Line_Reference 1772:     return query;"
    ]
}
