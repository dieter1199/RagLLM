{
    "cve_id": "CVE-2021-43812",
    "cve_description": "The Auth0 Next.js SDK is a library for implementing user authentication in Next.js applications. Versions before 1.6.2 do not filter out certain returnTo parameter values from the login url, which expose the application to an open redirect vulnerability. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
    "cve_publish_date": "2021-12-16",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "Enforce configured host on user supplied returnTo (#557)\n\n* Enforce configured host on user supplied returnTo\r\n\r\n* Test improvements per PR suggestions",
    "type_of_change": "Modification",
    "filename_of_changes": "login.test.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "43",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 217:       returnTo: '/foo'",
        "// Line_Reference 232:       returnTo: '/foo'",
        "// Line_Reference 242:     await expect(",
        "// Line_Reference 243:       get(baseUrl, '/api/auth/login?returnTo=https://www.google.com', { fullResponse: true })",
        "// Line_Reference 244:     ).rejects.toThrow('Invalid value provided for returnTo, must be a relative url');"
    ]
}
