{
    "cve_id": "CVE-2022-48437",
    "cve_description": "An issue was discovered in x509/x509_verify.c in LibreSSL before 3.6.1, and in OpenBSD before 7.2 errata 001. x509_verify_ctx_add_chain does not store errors that occur during leaf certificate verification, and therefore an incorrect error is returned. This behavior occurs when there is an installed verification callback that instructs the verifier to continue upon detecting an invalid certificate.",
    "cve_publish_date": "2023-04-12",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "Store errors that result from leaf certificate verification.\n\nIn the case that a verification callback is installed that tells the\nverifier to continue when a certificate is invalid (e.g. expired),\nany error resulting from the leaf certificate verification is not stored\nand made available post verification, resulting in an incorrect error being\nreturned.\n\nAlso perform leaf certificate verification prior to adding the chain, which\navoids a potential memory leak (as noted by tb@).\n\nIssue reported by Ilya Shipitsin, who encountered haproxy regress failures.\n\nok tb@",
    "type_of_change": "Modification",
    "filename_of_changes": "x509_verify.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1: /* $OpenBSD: x509_verify.c,v 1.60 2022/08/05 14:46:52 beck Exp $ */",
        "// Line_Reference 511: ",
        "// Line_Reference 512: \tif (!x509_verify_cert_valid(ctx, leaf, NULL))",
        "// Line_Reference 513: \t\treturn 0;",
        "// Line_Reference 514: ",
        "// Line_Reference 515: \tif (!x509_verify_cert_hostname(ctx, leaf, name))",
        "// Line_Reference 516: \t\treturn 0;",
        "// Line_Reference 517: "
    ]
}
