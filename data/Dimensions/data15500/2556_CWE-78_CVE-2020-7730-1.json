{
    "cve_id": "CVE-2020-7730",
    "cve_description": "The package bestzip before 2.1.7 are vulnerable to Command Injection via the options param.",
    "cve_publish_date": "2020-09-04",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "prevent shell command injection\n\nswitch from cp.exec to cp.spawn to prevent shell command injection.\n\nUse path-expansion logic from nodeZip in nativeZip to maintain feature parity without any vulnerability.",
    "type_of_change": "Modification",
    "filename_of_changes": "bestzip.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 68:     const sources = Array.isArray(options.source)",
        "// Line_Reference 69:       ? options.source.join(\" \")",
        "// Line_Reference 70:       : options.source;",
        "// Line_Reference 71:     const command = `zip --quiet --recurse-paths ${",
        "// Line_Reference 72:       options.destination",
        "// Line_Reference 73:     } ${sources}`;",
        "// Line_Reference 74:     const zipProcess = cp.exec(command, {",
        "// Line_Reference 75:       stdio: \"inherit\",",
        "// Line_Reference 76:       cwd: options.cwd",
        "// Line_Reference 77:     });",
        "// Line_Reference 78:     zipProcess.on(\"error\", reject);",
        "// Line_Reference 79:     zipProcess.on(\"close\", exitCode => {",
        "// Line_Reference 80:       if (exitCode === 0) {",
        "// Line_Reference 81:         resolve();",
        "// Line_Reference 82:       } else {",
        "// Line_Reference 83:         // exit code 12 means \"nothing to do\" right?",
        "// Line_Reference 84:         //console.log('rejecting', zipProcess)",
        "// Line_Reference 85:         reject(",
        "// Line_Reference 86:           new Error(",
        "// Line_Reference 87:             `Unexpected exit code from native zip command: ${exitCode}\\n executed command '${command}'\\n executed inin directory '${options.cwd ||",
        "// Line_Reference 88:               process.cwd()}'`",
        "// Line_Reference 89:           )",
        "// Line_Reference 90:         );",
        "// Line_Reference 91:       }"
    ]
}
