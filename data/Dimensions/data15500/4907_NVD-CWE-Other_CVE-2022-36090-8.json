{
    "cve_id": "CVE-2022-36090",
    "cve_description": "XWiki Platform Old Core is a core package for XWiki Platform, a generic wiki platform. Prior to versions 13.1.0.5 and 14.3-rc-1, some resources are missing a check for inactive (not yet activated or disabled) users in XWiki, including the REST service. This means a disabled user can enable themselves using a REST call. On the same way some resources handler created by extensions are not protected by default, so an inactive user could perform actions for such extensions. This issue has existed since at least version 1.1 of XWiki for instance configured with the email activation required for new users. Now it's more critical for versions 11.3-rc-1 and later since the maintainers provided the capability to disable user without deleting them and encouraged using that feature. XWiki 14.3-rc-1 and XWiki 13.10.5 contain a patch. There is no workaround for this other than upgrading XWiki.",
    "cve_publish_date": "2022-09-08",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "XWIKI-19559: Refactor handling of users in oldcore\n\n  * Add property for inactive users in XWikiContext\n  * Ensure that all calls to checkAuth in XS goes through\n    XWiki#checkAuth so that inactive users are handled\n  * Improve code of XWiki#prepareDocuments to simplify it\n  * Ensure that the login page is not displayed if a inactive user\n    logged in, in XWikiCachingRightService\n  * Improve a bit the code of the drawer to display the logout link in\n    case of logged in inactive user",
    "type_of_change": "Modification",
    "filename_of_changes": "XWikiCachingRightService.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 283:         if (context.getUserReference() == null && !DELETE_ACTION.equals(action) && !LOGIN_ACTION.equals(action)) {"
    ]
}
