{
    "cve_id": "CVE-2022-36044",
    "cve_description": "Rizin is a UNIX-like reverse engineering framework and command-line toolset. Versions 0.4.0 and prior are vulnerable to an out-of-bounds write when getting data from Luac files. A user opening a malicious Luac file could be affected by this vulnerability, allowing an attacker to execute code on the user's machine. Commits 07b43bc8aa1ffebd9b68d60624c9610cf7e460c7 and 05bbd147caccc60162d6fba9baaaf24befa281cd contain fixes for the issue.",
    "cve_publish_date": "2022-09-06",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix oob read on _luac_build_info and luac memleaks",
    "type_of_change": "Modification",
    "filename_of_changes": "luac_bin.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "38",
    "number_of_lines_deleted_vulnerable_to_cve": "28",
    "vulnerable_lines": [
        "// Line_Reference 73: static void try_free_empty_list(RzList *list) {",
        "// Line_Reference 74: \tif (list != NULL) {",
        "// Line_Reference 75: \t\trz_list_free(list);",
        "// Line_Reference 76: \t}",
        "// Line_Reference 77: }",
        "// Line_Reference 78: ",
        "// Line_Reference 131: \t\ttry_free_empty_list(ret->entry_list);",
        "// Line_Reference 132: \t\ttry_free_empty_list(ret->symbol_list);",
        "// Line_Reference 133: \t\ttry_free_empty_list(ret->section_list);",
        "// Line_Reference 134: \t\ttry_free_empty_list(ret->string_list);",
        "// Line_Reference 235: \tint i = 0; // iter",
        "// Line_Reference 236: ",
        "// Line_Reference 298: \tchar **upvalue_names;",
        "// Line_Reference 299: \tint real_upvalue_cnt;",
        "// Line_Reference 300: \tLuaDbgUpvalueEntry *debug_upv_entry;",
        "// Line_Reference 301: \treal_upvalue_cnt = rz_list_length(proto->upvalue_entries);",
        "// Line_Reference 302: \tupvalue_names = RZ_NEWS0(char *, real_upvalue_cnt);",
        "// Line_Reference 303: \tif (!upvalue_names) {",
        "// Line_Reference 304: \t\treturn;",
        "// Line_Reference 305: \t}",
        "// Line_Reference 306: \trz_list_foreach (proto->dbg_upvalue_entries, iter, debug_upv_entry) {",
        "// Line_Reference 307: \t\tupvalue_names[i] = (char *)debug_upv_entry->upvalue_name;",
        "// Line_Reference 308: \t\tluac_add_string(",
        "// Line_Reference 309: \t\t\tinfo->string_list,",
        "// Line_Reference 310: \t\t\tupvalue_names[i],",
        "// Line_Reference 311: \t\t\tdebug_upv_entry->offset,",
        "// Line_Reference 312: \t\t\tdebug_upv_entry->name_len);",
        "// Line_Reference 355: \tRZ_FREE(proto_name);"
    ]
}
