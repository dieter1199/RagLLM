{
    "cve_id": "CVE-2022-24976",
    "cve_description": "Atheme IRC Services before 7.2.12, when used in conjunction with InspIRCd, allows authentication bypass by ending an IRC handshake at a certain point during a challenge-response login sequence.",
    "cve_publish_date": "2022-02-14",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "saslserv/main: Track EID we're pending login to\n\nThe existing model does not remember that we've sent a SVSLOGIN for a\ngiven SASL session, and simply assumes that if a client is introduced\nwith a SASL session open, that session must have succeeded. The security\nof this approach requires ircd to implicitly abort SASL sessions on\nclient registration.\n\nThis also means that if a client successfully authenticates and then\ndoes something else its pending login is forgotten about, even though a\nSVSLOGIN has been sent for it, and the ircd is going to think it's\nlogged in.\n\nThis change removes the dependency on ircd's state machine by keeping\nexplicit track of the pending login, i.e. the one we've most recently\nsent a SVSLOGIN for. The next commit will ensure that a client abort\n(even an implicit one) doesn't blow that information away.",
    "type_of_change": "Modification",
    "filename_of_changes": "main.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 388: \t\tif (! *p->authzeid)",
        "// Line_Reference 390: \t\t\t(void) slog(LG_INFO, \"%s: session for '%s' without an authzeid (BUG)\",",
        "// Line_Reference 396: \t\tif (! (mu = myuser_find_uid(p->authzeid)))"
    ]
}
