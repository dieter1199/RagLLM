{
    "cve_id": "CVE-2018-11506",
    "cve_description": "The sr_do_ioctl function in drivers/scsi/sr_ioctl.c in the Linux kernel through 4.16.12 allows local users to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact because sense buffers have different sizes at the CDROM layer and the SCSI layer, as demonstrated by a CDROMREADMODE2 ioctl call.",
    "cve_publish_date": "2018-05-28",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "sr: pass down correctly sized SCSI sense buffer\n\nWe're casting the CDROM layer request_sense to the SCSI sense\nbuffer, but the former is 64 bytes and the latter is 96 bytes.\nAs we generally allocate these on the stack, we end up blowing\nup the stack.\n\nFix this by wrapping the scsi_execute() call with a properly\nsized sense buffer, and copying back the bits for the CDROM\nlayer.\n\nCc: stable@vger.kernel.org\nReported-by: Piotr Gabriel Kosinski <pg.kosinski@gmail.com>\nReported-by: Daniel Shapira <daniel@twistlock.com>\nTested-by: Kees Cook <keescook@chromium.org>\nFixes: 82ed4db499b8 (\"block: split scsi_request out of struct request\")\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
    "type_of_change": "Modification",
    "filename_of_changes": "sr_ioctl.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 201: \t\t\t      cgc->buffer, cgc->buflen,",
        "// Line_Reference 202: \t\t\t      (unsigned char *)cgc->sense, &sshdr,"
    ]
}
