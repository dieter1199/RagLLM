{
    "cve_id": "CVE-2018-17552",
    "cve_description": "SQL Injection in login.php in Naviwebs Navigate CMS 2.8 allows remote attackers to bypass authentication via the navigate-user cookie.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "* security fix: replace string filtering by parameterization in almost all queries",
    "type_of_change": "Modification",
    "filename_of_changes": "webdictionary.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "180",
    "number_of_lines_deleted_vulnerable_to_cve": "74",
    "vulnerable_lines": [
        "// Line_Reference 29: \t\t\t\t\t\t\t  AND node_type = '.protect('global').'",
        "// Line_Reference 30: \t\t\t\t\t\t\t  AND website = '.$website->id))",
        "// Line_Reference 70: \t\t\t\t\t   AND extension = '.protect($this->extension).'",
        "// Line_Reference 71: \t\t\t\t\t   AND subtype = '.protect($this->subtype).'",
        "// Line_Reference 72: \t\t\t\t\t   AND website = '.$website->id",
        "// Line_Reference 77: \t\t\t\tif(!is_array($data)) $data = array();",
        "// Line_Reference 79: \t\t\t\t\t$this->text[$item->lang] = $item->text;",
        "// Line_Reference 108: \t\t\t\t\t   AND theme = '.protect($theme->name).'",
        "// Line_Reference 109: \t\t\t\t\t   AND subtype = '.protect($this->subtype).'",
        "// Line_Reference 110: \t\t\t\t\t   AND website = '.$website->id",
        "// Line_Reference 167: \t\t\t\t$node_id_filter .= ' AND node_id = '.intval($this->node_id);",
        "// Line_Reference 170: \t\t\t\t$node_id_filter .= ' AND node_uid = '.intval($this->node_uid);",
        "// Line_Reference 174: \t\t\t\t\tWHERE website = '.protect($this->website).'",
        "// Line_Reference 175: \t\t\t\t\t  AND subtype = '.protect($this->subtype).'",
        "// Line_Reference 176: \t\t\t\t\t  AND theme = '.protect($this->theme).'",
        "// Line_Reference 177: \t\t\t\t\t  AND extension = '.protect($this->extension).'",
        "// Line_Reference 178: \t\t\t\t\t  AND node_type = '.protect($this->node_type).",
        "// Line_Reference 179: \t\t\t\t\t  $node_id_filter",
        "// Line_Reference 191:         $node_id_filter = \"\";",
        "// Line_Reference 197:                 $node_id_filter .= ' AND node_id = '.intval($this->node_id);",
        "// Line_Reference 200:                 $node_id_filter .= ' AND node_uid = '.intval($this->node_uid);",
        "// Line_Reference 204: \t\t\t\tWHERE subtype = '.protect($this->subtype).'",
        "// Line_Reference 205: \t\t\t\t  AND node_type = '.protect($this->node_type).'",
        "// Line_Reference 206: \t\t\t\t  AND theme = '.protect($this->theme).'",
        "// Line_Reference 207: \t\t\t\t  AND extension = '.protect($this->extension).'",
        "// Line_Reference 208: \t\t\t\t  AND website = '.protect($this->website).",
        "// Line_Reference 209: \t\t\t\t  $node_id_filter",
        "// Line_Reference 230: \t\t\t\t' subtype = '.protect($this->subtype).'",
        "// Line_Reference 231: \t\t\t\t       AND node_type = '.protect($this->node_type).'",
        "// Line_Reference 232: \t\t\t\t\t   AND website = '.$this->website",
        "// Line_Reference 297: \t\t\t WHERE node_type = '.protect($node_type).'",
        "// Line_Reference 298: \t\t\t   AND node_id = '.protect($node_id).",
        "// Line_Reference 299:             (empty($node_uid)? '' : ' AND ( node_uid = '.protect($node_uid).' OR node_uid = \"\" OR node_uid IS NULL )')",
        "// Line_Reference 336:                      WHERE node_type = '.protect($node_type).'",
        "// Line_Reference 337:                        AND node_id = '.protect($node_id).'",
        "// Line_Reference 338:                        AND website = '.$website_id.'",
        "// Line_Reference 339:                        AND lang = '.protect($lang).'",
        "// Line_Reference 340:                        AND subtype IN ('.implode(\",\", array_map(function($k){ return protect($k);}, $subtypes)).')'",
        "// Line_Reference 351:                 $DB->execute('",
        "// Line_Reference 352:                     DELETE FROM nv_webdictionary",
        "// Line_Reference 353:                      WHERE node_type = '.protect($node_type).'",
        "// Line_Reference 354:                        AND node_id = '.protect($node_id).'",
        "// Line_Reference 355:                        AND website = '.$website_id.'",
        "// Line_Reference 356:                        AND lang = '.protect($lang).'",
        "// Line_Reference 357:                        AND subtype IN ('.implode(\",\", array_map(function($k){ return protect($k);}, $subtypes)).')",
        "// Line_Reference 358:                        AND node_uid = '.protect($node_uid)",
        "// Line_Reference 367:                  WHERE node_type = '.protect($node_type).'",
        "// Line_Reference 368:                    AND node_id = '.protect($node_id).'",
        "// Line_Reference 369:                    AND website = '.$website_id",
        "// Line_Reference 425: \t\t\t\t\t$DB->execute('",
        "// Line_Reference 426: \t\t                DELETE FROM nv_webdictionary",
        "// Line_Reference 427: \t\t\t\t\t\tWHERE node_id = '.protect($id).'",
        "// Line_Reference 428: \t\t\t\t\t\t  AND node_type = '.protect('global').'",
        "// Line_Reference 429: \t\t\t\t\t\t  AND lang = '.protect($language).'",
        "// Line_Reference 430: \t\t\t\t\t\t  AND website = '.$website->id.'",
        "// Line_Reference 431: \t\t\t\t\t\tLIMIT 1",
        "// Line_Reference 432: \t\t\t\t\t');",
        "// Line_Reference 439: \t\t\t\t\t\tWHERE subtype = '.protect($id).'",
        "// Line_Reference 440: \t\t\t\t\t\t  AND node_type = '.protect(\"theme\").'",
        "// Line_Reference 441: \t\t\t\t\t\t  AND theme = '.protect($object).'",
        "// Line_Reference 442: \t\t\t\t\t\t  AND lang = '.protect($language).'",
        "// Line_Reference 443: \t\t\t\t\t\t  AND website = '.$website->id.'",
        "// Line_Reference 444: \t\t\t\t\t\tLIMIT 1",
        "// Line_Reference 445: \t\t\t\t\t');",
        "// Line_Reference 450: \t\t\t\t\t$DB->execute('",
        "// Line_Reference 451: \t\t                DELETE FROM nv_webdictionary",
        "// Line_Reference 452: \t\t\t\t\t\tWHERE subtype = '.protect($id).'",
        "// Line_Reference 453: \t\t\t\t\t\t  AND node_type = '.protect(\"extension\").'",
        "// Line_Reference 454: \t\t\t\t\t\t  AND extension = '.protect($object).'",
        "// Line_Reference 455: \t\t\t\t\t\t  AND lang = '.protect($language).'",
        "// Line_Reference 456: \t\t\t\t\t\t  AND website = '.$website->id.'",
        "// Line_Reference 457: \t\t\t\t\t\tLIMIT 1",
        "// Line_Reference 458: \t\t\t\t\t');",
        "// Line_Reference 498:         $DB->query('SELECT * FROM nv_webdictionary WHERE website = '.protect($website->id), 'object');"
    ]
}
