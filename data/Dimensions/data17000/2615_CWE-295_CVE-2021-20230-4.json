{
    "cve_id": "CVE-2021-20230",
    "cve_description": "A flaw was found in stunnel before 5.57, where it improperly validates client certificates when it is configured to use both redirect and verifyChain options. This flaw allows an attacker with a certificate signed by a Certificate Authority, which is not the one accepted by the stunnel server, to access the tunneled service instead of being redirected to the address specified in the redirect option. The highest threat from this vulnerability is to confidentiality.",
    "cve_publish_date": "2021-02-23",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "stunnel-5.57",
    "type_of_change": "Modification",
    "filename_of_changes": "ctx.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 3:  *   Copyright (C) 1998-2019 Michal Trojnara <Michal.Trojnara@stunnel.org>",
        "// Line_Reference 140:     /* create TLS context */",
        "// Line_Reference 168:     /* for callbacks */",
        "// Line_Reference 224:     /* mode */",
        "// Line_Reference 277:     /* initialize the DH/ECDH key agreement in the server mode */",
        "// Line_Reference 278:     if(!section->option.client) {",
        "// Line_Reference 283:         dh_init(section); /* ignore the result (errors are not critical) */",
        "// Line_Reference 286:         ecdh_init(section); /* ignore the result (errors are not critical) */",
        "// Line_Reference 288:     }",
        "// Line_Reference 381:     /* check if DH is actually enabled for this section */",
        "// Line_Reference 398:         s_log(LOG_INFO, \"DH initialization not needed\");",
        "// Line_Reference 1118:         cipher = EVP_aes_128_cbc();",
        "// Line_Reference 1120:         cipher = EVP_aes_256_cbc();",
        "// Line_Reference 1123:         iv_len = EVP_CIPHER_iv_length(cipher);"
    ]
}
