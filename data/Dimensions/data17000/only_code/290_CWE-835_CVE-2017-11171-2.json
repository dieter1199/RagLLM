* connection is first received on the ICE listening socket. (We
* expect that the client will then initiate XSMP on the connection;
* if it does not, GsmXSMPClient will eventually time out and close
* the connection.)
*
* FIXME: it would probably make more sense to not create a
* GsmXSMPClient object until accept_xsmp_connection, below (and to do
* the timing-out here in xsmp.c).
IceListenObj    listener;
GsmClient      *client;
GsmXsmpServer  *server;
listener = data->listener;
server = data->server;
ice_conn = IceAcceptConnection (listener, &status);
client = gsm_xsmp_client_new (ice_conn);
ice_conn->context = client;
gsm_store_add (server->priv->client_store, gsm_client_peek_id (client), G_OBJECT (client));
/* the store will own the ref */
g_object_unref (client);
IceConn        ice_conn;
GsmXSMPClient *client;
client = ice_conn->context;
g_return_val_if_fail (client != NULL, TRUE);
gsm_xsmp_client_connect (client, sms_conn, mask_ret, callbacks_ret);
