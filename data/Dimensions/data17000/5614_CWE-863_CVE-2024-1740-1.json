{
    "cve_id": "CVE-2024-1740",
    "cve_description": "In lunary-ai/lunary version 1.0.1, a vulnerability exists where a user removed from an organization can still read, create, modify, and delete logs by re-using an old authorization token. The lunary web application communicates with the server using an 'Authorization' token in the browser, which does not properly invalidate upon the user's removal from the organization. This allows the removed user to perform unauthorized actions on logs and access project and external user details without valid permissions.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "fix: security patches (#192)",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 1: import Router from \"koa-router\"",
        "// Line_Reference 4: import { getReadableDateTime } from \"@/src/utils/date\"",
        "// Line_Reference 5: import { runEval } from \"./utils\"",
        "// Line_Reference 6: import { getEvaluation } from \"./utils\"",
        "// Line_Reference 7: import { calcRunCost } from \"@/src/utils/calcCost\"",
        "// Line_Reference 8: import { runChecksOnRun } from \"@/src/checks/runChecks\"",
        "// Line_Reference 11: import { checkAccess } from \"@/src/utils/authorization\"",
        "// Line_Reference 12: import { RunEvent } from \"lunary/types\"",
        "// Line_Reference 23:     const { userId, projectId } = ctx.state"
    ]
}
