{
    "cve_id": "CVE-2021-44512",
    "cve_description": "World-writable permissions on the /tmp/tmate/sessions directory in tmate-ssh-server 2.3.0 allow a local attacker to compromise the integrity of session handling, or obtain the read-write session ID from a read-only session symlink in this directory.",
    "cve_publish_date": "2021-12-07",
    "cwe_id": "CWE-732",
    "cwe_name": "Incorrect Permission Assignment for Critical Resource",
    "cwe_description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
    "commit_message": "Harden /tmp/tmate directory\n\nSuggested by Matthias Gerstner",
    "type_of_change": "Modification",
    "filename_of_changes": "tmate-main.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 154: \tif ((mkdir(TMATE_WORKDIR, 0701)             < 0 && errno != EEXIST) ||",
        "// Line_Reference 155: \t    (mkdir(TMATE_WORKDIR \"/sessions\", 0703) < 0 && errno != EEXIST) ||",
        "// Line_Reference 159: \t/* The websocket server needs to access the /session dir to rename sockets */",
        "// Line_Reference 160: \tif ((chmod(TMATE_WORKDIR, 0701)             < 0) ||",
        "// Line_Reference 161: \t    (chmod(TMATE_WORKDIR \"/sessions\", 0703) < 0) ||"
    ]
}
