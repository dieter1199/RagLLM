{
    "cve_id": "CVE-2019-14924",
    "cve_description": "An issue was discovered in GCDWebServer before 3.5.3. The method moveItem in the GCDWebUploader class checks the FileExtension of newAbsolutePath but not oldAbsolutePath. By leveraging this vulnerability, an adversary can make an inaccessible file be available (the credential of the app, for instance).",
    "cve_publish_date": "2019-08-10",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Enforce hidden and extensions restrictions when moving and copying files in uploaders\n\nFixes #433",
    "type_of_change": "Modification",
    "filename_of_changes": "GCDWebUploader.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 331:   NSString* itemName = [newAbsolutePath lastPathComponent];",
        "// Line_Reference 332:   if ((!_allowHiddenItems && [itemName hasPrefix:@\".\"]) || (!isDirectory && ![self _checkFileExtension:itemName])) {",
        "// Line_Reference 333:     return [GCDWebServerErrorResponse responseWithClientError:kGCDWebServerHTTPStatusCode_Forbidden message:@\"Moving to item name \\\"%@\\\" is not allowed\", itemName];"
    ]
}
