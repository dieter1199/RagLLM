{
    "cve_id": "CVE-2019-12439",
    "cve_description": "bubblewrap.c in Bubblewrap before 0.3.3 misuses temporary directories in /tmp as a mount point. In some particular configurations (related to XDG_RUNTIME_DIR), a local attacker may abuse this flaw to prevent other users from executing bubblewrap or potentially execute code.",
    "cve_publish_date": "2019-05-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Don't create our own temporary mount point for pivot_root\n\nAn attacker could pre-create /tmp/.bubblewrap-$UID and make it a\nnon-directory, non-symlink (in which case mounting our tmpfs would fail,\ncausing denial of service), or make it a symlink under their control\n(potentially allowing bad things if the protected_symlinks sysctl is\nnot enabled).\n\nInstead, temporarily mount the tmpfs on a directory that we are sure\nexists and is not attacker-controlled. /tmp (the directory itself, not\na subdirectory) will do.\n\nFixes: #304\nBug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=923557\nSigned-off-by: Simon McVittie <smcv@debian.org>\n\nCloses: #305\nApproved by: cgwalters",
    "type_of_change": "Modification",
    "filename_of_changes": "bubblewrap.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 2049:   cleanup_free char *base_path = NULL;",
        "// Line_Reference 2190:      We first try in /run, and if that fails, try in /tmp. */",
        "// Line_Reference 2191:   base_path = xasprintf (\"/run/user/%d/.bubblewrap\", real_uid);",
        "// Line_Reference 2192:   if (ensure_dir (base_path, 0755))",
        "// Line_Reference 2193:     {",
        "// Line_Reference 2194:       free (base_path);",
        "// Line_Reference 2195:       base_path = xasprintf (\"/tmp/.bubblewrap-%d\", real_uid);",
        "// Line_Reference 2196:       if (ensure_dir (base_path, 0755))",
        "// Line_Reference 2197:         die_with_error (\"Creating root mountpoint failed\");",
        "// Line_Reference 2198:     }",
        "// Line_Reference 2403:    * dir if the user requested to bind mount something over / */"
    ]
}
