{
    "cve_id": "CVE-2021-23352",
    "cve_description": "This affects the package madge before 4.0.1. It is possible to specify a custom Graphviz path via the graphVizPath option parameter which when the .image(), .svg() or .dot() functions are called, is executed by the childprocess.exec function.",
    "cve_publish_date": "2021-03-09",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fix potential command injection vulnerability",
    "type_of_change": "Modification",
    "filename_of_changes": "graph.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 7: const exec = promisify(require('child_process').exec);",
        "// Line_Reference 25: function checkGraphvizInstalled(config) {",
        "// Line_Reference 26: \tif (config.graphVizPath) {",
        "// Line_Reference 27: \t\tconst cmd = path.join(config.graphVizPath, 'gvpr -V');",
        "// Line_Reference 28: \t\treturn exec(cmd)",
        "// Line_Reference 29: \t\t\t.catch(() => {",
        "// Line_Reference 30: \t\t\t\tthrow new Error('Could not execute ' + cmd);",
        "// Line_Reference 31: \t\t\t});",
        "// Line_Reference 32: \t}",
        "// Line_Reference 34: \treturn exec('gvpr -V')",
        "// Line_Reference 35: \t\t.catch((error) => {",
        "// Line_Reference 36: \t\t\tthrow new Error('Graphviz could not be found. Ensure that \"gvpr\" is in your $PATH.\\n' + error);",
        "// Line_Reference 37: \t\t});"
    ]
}
