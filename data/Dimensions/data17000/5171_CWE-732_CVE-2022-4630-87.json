{
    "cve_id": "CVE-2022-4630",
    "cve_description": "Sensitive Cookie Without 'HttpOnly' Flag in GitHub repository lirantal/daloradius prior to master.",
    "cve_publish_date": "2022-12-21",
    "cwe_id": "CWE-732",
    "cwe_name": "Incorrect Permission Assignment for Critical Resource",
    "cwe_description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
    "commit_message": "Improved attribute dictionaries management feature (#316)\n\nImproved layout and other minor features",
    "type_of_change": "Modification",
    "filename_of_changes": "mng-list-all.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 104:     $sql0 = sprintf(\"SELECT COUNT(DISTINCT(username)) AS username",
        "// Line_Reference 105:                        FROM %s",
        "// Line_Reference 106:                       WHERE attribute='Auth-Type' OR attribute LIKE '%%-Password'\", $configValues['CONFIG_DB_TBL_RADCHECK']);",
        "// Line_Reference 174:         // with this second query we retrieve user status (enabled/disabled) and user groups list",
        "// Line_Reference 175:         $sql2 = sprintf(\"SELECT username, groupname FROM %s WHERE username IN (%s)\",",
        "// Line_Reference 176:                         $configValues['CONFIG_DB_TBL_RADUSERGROUP'], implode(\", \", $usernamelist));",
        "// Line_Reference 177:         $res = $dbSocket->query($sql2);",
        "// Line_Reference 178:         $logDebugSQL .= \"$sql2;\\n\";",
        "// Line_Reference 180:         // foreach user we update the enabled flag and the grouplist",
        "// Line_Reference 181:         while ($row = $res->fetchRow(DB_FETCHMODE_ASSOC)) {",
        "// Line_Reference 182:             $this_username = $row['username'];",
        "// Line_Reference 183:             $this_groupname = $row['groupname'];",
        "// Line_Reference 185:             if ($this_groupname === 'daloRADIUS-Disabled-Users') {",
        "// Line_Reference 186:                 $records[$this_username]['enabled'] = false;",
        "// Line_Reference 187:             } else {",
        "// Line_Reference 188:                 array_push($records[$this_username]['groups'],",
        "// Line_Reference 189:                            htmlspecialchars($this_groupname, ENT_QUOTES, 'UTF-8'));",
        "// Line_Reference 277:                 <td><?= ($type == 'USER') ? $auth : \"\" ?></td>"
    ]
}
