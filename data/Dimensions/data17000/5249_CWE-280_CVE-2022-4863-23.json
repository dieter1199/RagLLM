{
    "cve_id": "CVE-2022-4863",
    "cve_description": "Improper Handling of Insufficient Permissions or Privileges in GitHub repository usememos/memos prior to 0.9.1.",
    "cve_publish_date": "2022-12-30",
    "cwe_id": "CWE-280",
    "cwe_name": "Improper Handling of Insufficient Permissions or Privileges ",
    "cwe_description": "The product does not handle or incorrectly handles when it has insufficient privileges to access resources or functionality as specified by their permissions. This may cause it to follow unexpected code paths that may leave the product in an invalid state.",
    "commit_message": "fix: access control (#870)",
    "type_of_change": "Modification",
    "filename_of_changes": "shortcut.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "40",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 24: \t\tshortcutCreate := &api.ShortcutCreate{",
        "// Line_Reference 25: \t\t\tCreatorID: userID,",
        "// Line_Reference 26: \t\t}",
        "// Line_Reference 55: \t\t\tID:        shortcutID,",
        "// Line_Reference 62: \t\tshortcut, err := s.Store.PatchShortcut(ctx, shortcutPatch)",
        "// Line_Reference 76: \t\tshortcutFind := &api.ShortcutFind{}",
        "// Line_Reference 77: ",
        "// Line_Reference 78: \t\tif userID, err := strconv.Atoi(c.QueryParam(\"creatorId\")); err == nil {",
        "// Line_Reference 79: \t\t\tshortcutFind.CreatorID = &userID",
        "// Line_Reference 80: \t\t} else {",
        "// Line_Reference 81: \t\t\tuserID, ok := c.Get(getUserIDContextKey()).(int)",
        "// Line_Reference 82: \t\t\tif !ok {",
        "// Line_Reference 83: \t\t\t\treturn echo.NewHTTPError(http.StatusBadRequest, \"Missing user id to find shortcut\")",
        "// Line_Reference 84: \t\t\t}",
        "// Line_Reference 85: ",
        "// Line_Reference 86: \t\t\tshortcutFind.CreatorID = &userID"
    ]
}
