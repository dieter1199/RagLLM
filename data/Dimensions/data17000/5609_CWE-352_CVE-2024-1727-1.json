{
    "cve_id": "CVE-2024-1727",
    "cve_description": "A Cross-Site Request Forgery (CSRF) vulnerability in gradio-app/gradio allows attackers to upload multiple large files to a victim's system if they are running Gradio locally. By crafting a malicious HTML page that triggers an unauthorized file upload to the victim's server, an attacker can deplete the system's disk space, potentially leading to a denial of service. This issue affects the file upload functionality as implemented in gradio/routes.py.",
    "cve_publish_date": "2024-03-21",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Tighten CORS rules (#7503)\n\n* tighten cors rules\r\n\r\n* add changeset\r\n\r\n* cors policy\r\n\r\n* cors\r\n\r\n* add changeset\r\n\r\n* lint\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* logging\r\n\r\n* add null\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* options\r\n\r\n* options\r\n\r\n* safe changes\r\n\r\n* let browser enforce cors\r\n\r\n* clean\r\n\r\n* route utils\r\n\r\n* fix\r\n\r\n* fix test\r\n\r\n* fix\r\n\r\n---------\r\n\r\nCo-authored-by: gradio-pr-bot <gradio-pr-bot@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "routes.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 32: from fastapi.middleware.cors import CORSMiddleware",
        "// Line_Reference 199:             app.add_middleware(",
        "// Line_Reference 200:                 CORSMiddleware,",
        "// Line_Reference 201:                 allow_origins=[\"*\"],",
        "// Line_Reference 202:                 allow_methods=[\"*\"],",
        "// Line_Reference 203:                 allow_headers=[\"*\"],",
        "// Line_Reference 204:             )"
    ]
}
