{
    "cve_id": "CVE-2017-15112",
    "cve_description": "keycloak-httpd-client-install versions before 0.8 allow users to insecurely pass password through command line, leaking it via command history and process info to other local users.",
    "cve_publish_date": "2018-01-20",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "CVE-2017-15112 unsafe use of -p/--admin-password on command line\n\nIt is unsafe to pass a password as part of the command line args\nbecause it appears in the process info and is recorded in the\nshell command history.\n\nThe -p --keycloak-admin-password arg has been replaced with -P\n--keycloak-admin-password-file which reads the password from a file or\nstdin if given a hyphen. The now deprecated --keycloak-admin-password\nalso accepted stdin with a hyphen, this was retained for backward\ncompatibility during a transition period, it will issue a deprecation\nwarning. Trying to use --keycloak-admin-password with anything other\nthan a hyphen will result in an error and explanation.\n\nThe man page was updated to include a section on password passing and\nincludes documention on using the KEYCLOAK_ADMIN_PASSWORD environment\nvariable (which was always supported but never documented).\n\nThe --admin-password command line arg in keycloak_cli.py was also\nupdated in a similar manner and now also includes support for\nKEYCLOAK_ADMIN_PASSWORD environment variable.",
    "type_of_change": "Modification",
    "filename_of_changes": "keycloak-httpd-client-install",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "57",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 945:                        help='admin password (use - to read from stdin)')",
        "// Line_Reference 1029:             else:",
        "// Line_Reference 1030:                 options.keycloak_admin_password = getpass.getpass(",
        "// Line_Reference 1031:                     '%s password: ' % (options.keycloak_admin_username))",
        "// Line_Reference 1032:         elif options.keycloak_admin_password == '-':",
        "// Line_Reference 1033:             options.keycloak_admin_password = sys.stdin.readline().rstrip('\\n')"
    ]
}
