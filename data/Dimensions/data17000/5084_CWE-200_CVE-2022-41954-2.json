{
    "cve_id": "CVE-2022-41954",
    "cve_description": "MPXJ is an open source library to read and write project plans from a variety of file formats and databases. On Unix-like operating systems (not Windows or macos), MPXJ's use of `File.createTempFile(..)` results in temporary files being created with the permissions `-rw-r--r--`. This means that any other user on the system can read the contents of this file. When MPXJ is reading a schedule file which requires the creation of a temporary file or directory, a knowledgeable local user could locate these transient files while they are in use and would then be able to read the schedule being processed by MPXJ. The problem has been patched, MPXJ version 10.14.1 and later includes the necessary changes. Users unable to upgrade may set `java.io.tmpdir` to a directory to which only the user running the application has access will prevent other users from accessing these temporary files.",
    "cve_publish_date": "2022-11-25",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "vuln-fix: Temporary File Information Disclosure\n\n\n\nThis fixes temporary file information disclosure vulnerability due to the use\nof the vulnerable `File.createTempFile()` method. The vulnerability is fixed by\nusing the `Files.createTempFile()` method which sets the correct posix permissions.\n\nWeakness: CWE-377: Insecure Temporary File\nSeverity: Medium\nCVSSS: 5.5\nDetection: CodeQL & OpenRewrite (https://public.moderne.io/recipes/org.openrewrite.java.security.SecureTempFileCreation)\n\nReported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\nSigned-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\n\nBug-tracker: https://github.com/JLLeitschuh/security-research/issues/18\n\n\nCo-authored-by: Moderne <team@moderne.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "BasicTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 77:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 96:       File out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 113:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 131:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 147:       File out = File.createTempFile(\"junit\", \".planner\");",
        "// Line_Reference 270:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 283:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 296:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 356:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 361:       out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 431:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 493:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 527:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 539:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 566:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 899:       File out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 930:       File out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 1250:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 1341:       File out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 1407:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 1438:       out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 1515:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 1521:       out = File.createTempFile(\"junit\", \".xml\");",
        "// Line_Reference 1723:       File out = File.createTempFile(\"junit\", \".mpx\");",
        "// Line_Reference 1740:       File out = File.createTempFile(\"junit\", \".mpx\");"
    ]
}
