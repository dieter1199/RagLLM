{
    "cve_id": "CVE-2017-15732",
    "cve_description": "In phpMyFAQ before 2.9.9, there is Cross-Site Request Forgery (CSRF) in admin/news.php.",
    "cve_publish_date": "2017-10-22",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Added missing CSRF check",
    "type_of_change": "Modification",
    "filename_of_changes": "news.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 36:                 <h2 class=\"page-header\"><i aria-hidden=\"true\" class=\"fa fa-pencil\"></i> <?php echo $PMF_LANG['ad_news_add'];",
        "// Line_Reference 37:     ?></h2>",
        "// Line_Reference 47:                             <?php echo $PMF_LANG['ad_news_header'];",
        "// Line_Reference 48:     ?>",
        "// Line_Reference 56:                         <label class=\"col-lg-2 control-label\" for=\"news\"><?php echo $PMF_LANG['ad_news_text'];",
        "// Line_Reference 57:     ?>:</label>",
        "// Line_Reference 65:                         <label class=\"col-lg-2 control-label\" for=\"authorName\"><?php echo $PMF_LANG['ad_news_author_name'];",
        "// Line_Reference 66:     ?></label>",
        "// Line_Reference 69:                                    value=\"<?php echo $user->getUserData('display_name');",
        "// Line_Reference 70:     ?>\"/>",
        "// Line_Reference 75:                         <label class=\"col-lg-2 control-label\" for=\"authorEmail\"><?php echo $PMF_LANG['ad_news_author_email'];",
        "// Line_Reference 76:     ?></label>",
        "// Line_Reference 79:                                    value=\"<?php echo $user->getUserData('email');",
        "// Line_Reference 80:     ?>\"/>",
        "// Line_Reference 86:                             <?php echo $PMF_LANG['ad_news_set_active'];",
        "// Line_Reference 87:     ?>:",
        "// Line_Reference 92:                                 <?php echo $PMF_LANG['ad_gen_yes'];",
        "// Line_Reference 93:     ?>",
        "// Line_Reference 99:                         <label class=\"col-lg-2 control-label\" for=\"comment\"><?php echo $PMF_LANG['ad_news_allowComments'];",
        "// Line_Reference 100:     ?></label>",
        "// Line_Reference 104:                                 <?php echo $PMF_LANG['ad_gen_yes'];",
        "// Line_Reference 105:     ?>",
        "// Line_Reference 111:                         <label class=\"col-lg-2 control-label\" for=\"link\"><?php echo $PMF_LANG['ad_news_link_url'];",
        "// Line_Reference 112:     ?></label>",
        "// Line_Reference 119:                         <label class=\"col-lg-2 control-label\" for=\"linkTitle\"><?php echo $PMF_LANG['ad_news_link_title'];",
        "// Line_Reference 120:     ?></label>",
        "// Line_Reference 127:                         <label class=\"col-lg-2 control-label\" ><?php echo $PMF_LANG['ad_news_link_target'];",
        "// Line_Reference 128:     ?></label>",
        "// Line_Reference 143:                         <label class=\"col-lg-2 control-label\" for=\"langTo\"><?php echo $PMF_LANG['ad_entry_locale'];",
        "// Line_Reference 144:     ?>:</label>",
        "// Line_Reference 146:                             <?php echo PMF_Language::selectLanguages($LANGCODE, false, [], 'langTo');",
        "// Line_Reference 147:     ?>",
        "// Line_Reference 151:                     <legend><?php echo $PMF_LANG['ad_news_expiration_window'];",
        "// Line_Reference 152:     ?></legend>",
        "// Line_Reference 597:     $delete_id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);",
        "// Line_Reference 605:     <input type=\"hidden\" name=\"id\" value=\"<?php echo $delete_id;",
        "// Line_Reference 606:         ?>\">",
        "// Line_Reference 629:         $delete_id = PMF_Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);",
        "// Line_Reference 630:         $news->deleteNews($delete_id);",
        "// Line_Reference 631:         printf('<p class=\"alert alert-success\">%s</p>', $PMF_LANG['ad_news_delsuc']);",
        "// Line_Reference 632:         printf('<div class=\"form-group\">&rarr; <a href=\"?action=news\">%s</a></p>', $PMF_LANG['msgNews']);"
    ]
}
