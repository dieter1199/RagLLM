{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Administration.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 45:     $_REQUEST['month_date'] = strtoupper(date('M'));",
        "// Line_Reference 46:     $_REQUEST['year_date'] = date('y');",
        "// Line_Reference 56:     $extra_sql = ' AND TABLE_NAME=\\'' . $_REQUEST[table] . '\\'';",
        "// Line_Reference 133: if (count($_REQUEST['attendance_day'])) {",
        "// Line_Reference 143: $codes_RET = DBGet(DBQuery('SELECT ID,SHORT_NAME,TITLE,STATE_CODE FROM attendance_codes WHERE SCHOOL_ID=\\'' . UserSchool() . '\\' AND SYEAR=\\'' . UserSyear() . '\\' AND TABLE_NAME=\\'' . $_REQUEST[table] . '\\''));",
        "// Line_Reference 179:             DrawHeader(''._selectedStudent.' : ' . $RET[1]['FIRST_NAME'] . '&nbsp;' . ($RET[1]['MIDDLE_NAME'] ? $RET[1]['MIDDLE_NAME'] . ' ' : '') . $RET[1]['LAST_NAME'] . '&nbsp;' . $RET[1]['NAME_SUFFIX'], '<span class=\"heading-text\"><A HREF=Modules.php?modname=' . $_REQUEST['modname'] . '&search_modfunc=list&next_modname=students/Student.php&codes[]=' . $_SESSION[code][0] . '&ajax=true&bottom_back=true&month_date=' . $_REQUEST[month_date] . '&day_date=' . $_REQUEST[day_date] . '&year_date=' . $_REQUEST[year_date] . ' target=body><i class=\"icon-square-left\"></i> '._backToStudentList.'</A></span><div class=\"btn-group heading-btn\"><A HREF=Side.php?student_id=new&modcat=' . $_REQUEST['modcat'] . ' class=\"btn btn-danger btn-xs\">'._deselect.'</A></div>');",
        "// Line_Reference 185:     ListOutput($schedule_RET, $columns, _course, _courses);",
        "// Line_Reference 224:         $RET = DBGet(DBQuery('SELECT ID FROM attendance_codes WHERE SYEAR=\\'' . UserSyear() . '\\' AND SCHOOL_ID=\\'' . UserSchool() . '\\' AND (DEFAULT_CODE!=\\'' . 'Y' . '\\' OR DEFAULT_CODE IS NULL) AND TABLE_NAME=\\'' . $_REQUEST[table] . '\\''));",
        "// Line_Reference 390: ",
        "// Line_Reference 468:     global $THIS_RET, $codes_RET, $current_RET;",
        "// Line_Reference 511: ?>"
    ]
}
