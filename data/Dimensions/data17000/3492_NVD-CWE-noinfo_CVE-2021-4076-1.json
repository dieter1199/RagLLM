{
    "cve_id": "CVE-2021-4076",
    "cve_description": "A flaw exists in tang, a network-based cryptographic binding server, which could result in leak of private keys.",
    "cve_publish_date": "2022-03-02",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "keys: move signing part out of find_by_thp() and to find_jws() (#81)\n\nHandle just signing keys in find_jws(), to make sure we are\r\nresponding only to proper queries.\r\n\r\nTests were also failing to detect this issue and were updated\r\naccordingly.\r\n\r\nIssue discovered by Twitter Kernel and OS team during a source\r\ncode audit while evaluating Tang/Clevis for their needs.\r\n\r\nFixes CVE-2021-4076",
    "type_of_change": "Modification",
    "filename_of_changes": "keys.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 270: ",
        "// Line_Reference 271:             if (jwk_valid_for_deriving_keys(jwk)) {",
        "// Line_Reference 272:                 return json_incref(jwk);",
        "// Line_Reference 273:             } else if (jwk_valid_for_signing(jwk)) {",
        "// Line_Reference 274:                 json_auto_t* sign = json_deep_copy(tki->m_sign);",
        "// Line_Reference 275:                 if (json_array_append(sign, jwk) == -1) {",
        "// Line_Reference 276:                     return NULL;",
        "// Line_Reference 277:                 }",
        "// Line_Reference 278:                 json_auto_t* jws = jwk_sign(tki->m_payload, sign);",
        "// Line_Reference 279:                 if (!jws) {",
        "// Line_Reference 280:                     return NULL;",
        "// Line_Reference 281:                 }",
        "// Line_Reference 282:                 return json_incref(jws);",
        "// Line_Reference 283:             }",
        "// Line_Reference 448:     return find_by_thp(tki, thp);"
    ]
}
