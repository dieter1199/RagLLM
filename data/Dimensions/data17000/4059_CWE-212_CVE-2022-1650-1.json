{
    "cve_id": "CVE-2022-1650",
    "cve_description": "Improper Removal of Sensitive Information Before Storage or Transfer in GitHub repository eventsource/eventsource prior to v2.0.2.\n\n",
    "cve_publish_date": "2022-05-12",
    "cwe_id": "CWE-212",
    "cwe_name": "Improper Removal of Sensitive Information Before Storage or Transfer",
    "cwe_description": "The product stores, transfers, or shares a resource that contains sensitive information, but it does not properly remove that information before the product makes the resource available to unauthorized actors.",
    "commit_message": "fix: strip sensitive headers on redirect to different origin",
    "type_of_change": "Modification",
    "filename_of_changes": "eventsource.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "38",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 56:     // The url may have been changed by a temporary",
        "// Line_Reference 57:     // redirect. If that's the case, revert it now.",
        "// Line_Reference 73:   if (eventSourceInitDict && eventSourceInitDict.headers && eventSourceInitDict.headers['Last-Event-ID']) {",
        "// Line_Reference 74:     lastEventId = eventSourceInitDict.headers['Last-Event-ID']",
        "// Line_Reference 75:     delete eventSourceInitDict.headers['Last-Event-ID']",
        "// Line_Reference 89:     if (eventSourceInitDict && eventSourceInitDict.headers) {",
        "// Line_Reference 90:       for (var i in eventSourceInitDict.headers) {",
        "// Line_Reference 91:         var header = eventSourceInitDict.headers[i]",
        "// Line_Reference 151:         if (!res.headers.location) {",
        "// Line_Reference 157:         url = res.headers.location"
    ]
}
