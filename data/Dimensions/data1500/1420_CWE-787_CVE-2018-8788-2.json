{
    "cve_id": "CVE-2018-8788",
    "cve_description": "FreeRDP prior to version 2.0.0-rc4 contains an Out-Of-Bounds Write of up to 4 bytes in function nsc_rle_decode() that results in a memory corruption and possibly even a remote code execution.",
    "cve_publish_date": "2018-11-29",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fixed CVE-2018-8788\n\nThanks to Eyal Itkin from Check Point Software Technologies.",
    "type_of_change": "Modification",
    "filename_of_changes": "nsc_encode.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "44",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 90: static void nsc_encode_argb_to_aycocg(NSC_CONTEXT* context, const BYTE* data,",
        "// Line_Reference 247: static void nsc_encode_subsampling(NSC_CONTEXT* context)",
        "// Line_Reference 251: \tBYTE* co_dst;",
        "// Line_Reference 252: \tBYTE* cg_dst;",
        "// Line_Reference 253: \tINT8* co_src0;",
        "// Line_Reference 254: \tINT8* co_src1;",
        "// Line_Reference 255: \tINT8* cg_src0;",
        "// Line_Reference 256: \tINT8* cg_src1;",
        "// Line_Reference 264: \t\tco_dst = context->priv->PlaneBuffers[1] + y * (tempWidth >> 1);",
        "// Line_Reference 265: \t\tcg_dst = context->priv->PlaneBuffers[2] + y * (tempWidth >> 1);",
        "// Line_Reference 266: \t\tco_src0 = (INT8*) context->priv->PlaneBuffers[1] + (y << 1) * tempWidth;",
        "// Line_Reference 267: \t\tco_src1 = co_src0 + tempWidth;",
        "// Line_Reference 268: \t\tcg_src0 = (INT8*) context->priv->PlaneBuffers[2] + (y << 1) * tempWidth;",
        "// Line_Reference 269: \t\tcg_src1 = cg_src0 + tempWidth;",
        "// Line_Reference 285: void nsc_encode(NSC_CONTEXT* context, const BYTE* bmpdata, UINT32 rowstride)",
        "// Line_Reference 287: \tnsc_encode_argb_to_aycocg(context, bmpdata, rowstride);",
        "// Line_Reference 291: \t\tnsc_encode_subsampling(context);",
        "// Line_Reference 295: static UINT32 nsc_rle_encode(BYTE* in, BYTE* out, UINT32 originalSize)"
    ]
}
