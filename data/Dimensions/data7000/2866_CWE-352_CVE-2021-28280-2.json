{
    "cve_id": "CVE-2021-28280",
    "cve_description": "CSRF + Cross-site scripting (XSS) vulnerability in search.php in PHPFusion 9.03.110 allows remote attackers to inject arbitrary web script or HTML",
    "cve_publish_date": "2021-04-29",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Prevent unwanted vars redirection.\nJust to mitigate flooding of error logs, redirect if someone do malicious attempts on the search script.",
    "type_of_change": "Modification",
    "filename_of_changes": "Search_Engine.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 298:         $info = [",
        "// Line_Reference 299:             'stype'        => htmlentities(self::$search_type),",
        "// Line_Reference 300:             'stext'        => htmlentities(self::$search_text),",
        "// Line_Reference 301:             'method'       => htmlentities(self::$search_method),",
        "// Line_Reference 302:             'datelimit'    => self::$search_date_limit,",
        "// Line_Reference 303:             'fields'       => self::$search_fields,",
        "// Line_Reference 304:             'sort'         => self::$search_sort,",
        "// Line_Reference 305:             'chars'        => htmlentities(self::$search_chars),",
        "// Line_Reference 306:             'order'        => self::$search_order,",
        "// Line_Reference 307:             'forum_id'     => self::$forum_id,",
        "// Line_Reference 308:             'memory_limit' => self::$memory_limit,",
        "// Line_Reference 309:             'composevars'  => self::$composevars,",
        "// Line_Reference 310:             'rowstart'     => self::$rowstart,",
        "// Line_Reference 311:             'search_param' => self::$search_param,",
        "// Line_Reference 312:         ];"
    ]
}
