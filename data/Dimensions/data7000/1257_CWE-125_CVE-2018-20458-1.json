{
    "cve_id": "CVE-2018-20458",
    "cve_description": "In radare2 prior to 3.1.1, r_bin_dyldcache_extract in libr/bin/format/mach0/dyldcache.c may allow attackers to cause a denial-of-service (application crash caused by out-of-bounds read) by crafting an input file.",
    "cve_publish_date": "2018-12-25",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix #12374 - oobread crash in truncated dyldcache ##bin (#12381)",
    "type_of_change": "Modification",
    "filename_of_changes": "dyldcache.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1: /* radare - LGPL - Copyright 2010-2016 - nibble, pancake  */",
        "// Line_Reference 50: \t\tperror (\"malloc (ret)\");",
        "// Line_Reference 63: \timage_infos = (struct dyld_cache_image_info*) (bin->b->buf + bin->hdr.startaddr);",
        "// Line_Reference 64: \tdyld_vmbase = *(ut64 *)(bin->b->buf + bin->hdr.baseaddroff);",
        "// Line_Reference 72: \tif (image_infos[idx].pathFileOffset > bin->size) {",
        "// Line_Reference 73: \t    eprintf (\"corrupted file\\n\");",
        "// Line_Reference 77: \tlibname = (char *)(bin->b->buf + image_infos[idx].pathFileOffset);",
        "// Line_Reference 227: \tstruct r_bin_dyldcache_obj_t *bin;",
        "// Line_Reference 228: \tif (!(bin = malloc (sizeof (struct r_bin_dyldcache_obj_t)))) {",
        "// Line_Reference 231: \tmemset (bin, 0, sizeof (struct r_bin_dyldcache_obj_t));",
        "// Line_Reference 235: \tbin->b = r_buf_new();",
        "// Line_Reference 236: \tif (!r_buf_set_bytes (bin->b, buf, size)) {"
    ]
}
