//rootdn_passwd is set with a value (a password, not encrypted)
$password = 'toto';
$input    = ['name' => 'ldap', 'rootdn_passwd' => $password];
$result   = $ldap->prepareInputForUpdate($input);
//Expected value to be encrypted using GLPIKEY key
$expected = \Toolbox::encrypt(stripslashes($password), GLPIKEY);
$this->string($result['rootdn_passwd'])->isIdenticalTo($expected);
$password = 'tot\'o';
$input    = ['name' => 'ldap', 'rootdn_passwd' => $password];
$result   = $ldap->prepareInputForUpdate($input);
//Expected value to be encrypted using GLPIKEY key
$expected = \Toolbox::encrypt(stripslashes($password), GLPIKEY);
$this->string($result['rootdn_passwd'])->isIdenticalTo($expected);
$input['_blank_passwd'] = 1;
$result   = $ldap->prepareInputForUpdate($input);
//rootdn_passwd is set but empty
$this->string($result['rootdn_passwd'])->isEmpty();
