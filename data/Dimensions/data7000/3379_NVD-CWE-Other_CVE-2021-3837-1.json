{
    "cve_id": "CVE-2021-3837",
    "cve_description": "openwhyd is vulnerable to Improper Authorization",
    "cve_publish_date": "2022-01-03",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "fix(security): Make login redirects more secure (#519)\n\nAddresses:\r\n- [Improper Authorization vulnerability found in openwhyd](https://huntr.dev/bounties/d66f90d6-1b5f-440d-8be6-cdffc9d4587e/)\r\n- [Open Redirect vulnerability found in openwhyd](https://huntr.dev/bounties/8852bb22-7312-4af5-b9c2-507a68e37a6a/)\r\n- [Cross-site Scripting (XSS) - Reflected vulnerability found in openwhyd](https://huntr.dev/bounties/84a14deb-5dd8-4cc0-810f-d0987566f845/)\r\n\r\nTests:\r\n* test: /login should allow redirect to /stream\r\n* test: /login should NOT allow javascript in redirect URL\r\n* test: /login should should NOT allow redirect to other domain\r\n* test: /login should NOT allow script element in redirect URL",
    "type_of_change": "Modification",
    "filename_of_changes": "logging.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 264:   const fullURL = new URL(url, config.urlPrefix);",
        "// Line_Reference 265:   if (`${fullURL.protocol}//${fullURL.host}` !== config.urlPrefix)",
        "// Line_Reference 266:     return this.forbidden();"
    ]
}
