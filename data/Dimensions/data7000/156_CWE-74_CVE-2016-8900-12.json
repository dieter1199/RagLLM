{
    "cve_id": "CVE-2016-8900",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a Object Injection vulnerability in framework/modules/core/controllers/expTagController.php related to change_tags.",
    "cve_publish_date": "2019-05-24",
    "cwe_id": "CWE-74",
    "cwe_name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
    "cwe_description": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "expCommentController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "63",
    "number_of_lines_deleted_vulnerable_to_cve": "62",
    "vulnerable_lines": [
        "// Line_Reference 27:     protected $add_permissions = array(",
        "// Line_Reference 28:         'approve'=>\"Approve Comments\"",
        "// Line_Reference 29:     );",
        "// Line_Reference 30:    \tprotected $remove_permissions = array(",
        "// Line_Reference 36: ",
        "// Line_Reference 40:             expHistory::back();",
        "// Line_Reference 41: \t    }",
        "// Line_Reference 48: ",
        "// Line_Reference 49: ",
        "// Line_Reference 58: \t}",
        "// Line_Reference 59: ",
        "// Line_Reference 71: ",
        "// Line_Reference 83:             'sql'=>$sql,",
        "// Line_Reference 118:         $require_login = empty($this->params['require_login']) ? COMMENTS_REQUIRE_LOGIN : $this->params['require_login'];",
        "// Line_Reference 119:         $require_approval = empty($this->params['require_approval']) ? COMMENTS_REQUIRE_APPROVAL : $this->params['require_approval'];",
        "// Line_Reference 120:         $require_notification = empty($this->params['require_notification']) ? COMMENTS_REQUIRE_NOTIFICATION : $this->params['require_notification'];",
        "// Line_Reference 121:         $notification_email = empty($this->params['notification_email']) ? COMMENTS_NOTIFICATION_EMAIL : $this->params['notification_email'];",
        "// Line_Reference 131:         $sql .= 'WHERE cnt.content_id='.$this->params['content_id'].\" AND cnt.content_type='\".$this->params['content_type'].\"' \";",
        "// Line_Reference 138:             'sql'=>$sql,",
        "// Line_Reference 160: ",
        "// Line_Reference 165:             $sql .= 'WHERE cnt.content_id='.$this->params['content_id'].\" AND cnt.content_type='\".$this->params['content_type'].\"' \";",
        "// Line_Reference 170:         }",
        "// Line_Reference 171: ",
        "// Line_Reference 180: \t\t\t'content_id'=>$this->params['content_id'],",
        "// Line_Reference 327: ",
        "// Line_Reference 342: ",
        "// Line_Reference 348: ",
        "// Line_Reference 354: ",
        "// Line_Reference 369: ",
        "// Line_Reference 378: ",
        "// Line_Reference 381: ",
        "// Line_Reference 384: ",
        "// Line_Reference 385:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 391: ",
        "// Line_Reference 396: ",
        "// Line_Reference 402: ",
        "// Line_Reference 408: ",
        "// Line_Reference 409:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 415: ",
        "// Line_Reference 422: ",
        "// Line_Reference 425: ",
        "// Line_Reference 426:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 482: ",
        "// Line_Reference 483:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 489: ",
        "// Line_Reference 494: ",
        "// Line_Reference 498: ",
        "// Line_Reference 500:         $db->delete($comment->attachable_table, 'expcomments_id='.$this->params['id']);",
        "// Line_Reference 501: ",
        "// Line_Reference 505: ",
        "// Line_Reference 509: ",
        "// Line_Reference 511:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 517: ",
        "// Line_Reference 529: ",
        "// Line_Reference 543: ",
        "// Line_Reference 545:         $mail = new expMail();",
        "// Line_Reference 552: ",
        "// Line_Reference 558: ",
        "// Line_Reference 559:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 565: ",
        "// Line_Reference 590:         $mail = new expMail();",
        "// Line_Reference 597: "
    ]
}
