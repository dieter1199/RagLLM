{
    "cve_id": "CVE-2018-5729",
    "cve_description": "MIT krb5 1.6 or later allows an authenticated kadmin with permission to add principals to an LDAP Kerberos database to cause a denial of service (NULL pointer dereference) or bypass a DN container check by supplying tagged data that is internal to the database module.",
    "cve_publish_date": "2018-03-06",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix flaws in LDAP DN checking\n\nKDB_TL_USER_INFO tl-data is intended to be internal to the LDAP KDB\nmodule, and not used in disk or wire principal entries.  Prevent\nkadmin clients from sending KDB_TL_USER_INFO tl-data by giving it a\ntype number less than 256 and filtering out type numbers less than 256\nin kadm5_create_principal_3().  (We already filter out low type\nnumbers in kadm5_modify_principal()).\n\nIn the LDAP KDB module, if containerdn and linkdn are both specified\nin a put_principal operation, check both linkdn and the computed\nstandalone_principal_dn for container membership.  To that end, factor\nout the checks into helper functions and call them on all applicable\nclient-influenced DNs.\n\nCVE-2018-5729:\n\nIn MIT krb5 1.6 or later, an authenticated kadmin user with permission\nto add principals to an LDAP Kerberos database can cause a null\ndereference in kadmind, or circumvent a DN container check, by\nsupplying tagged data intended to be internal to the database module.\nThanks to Sharwan Ram and Pooja Anil for discovering the potential\nnull dereference.\n\nCVE-2018-5730:\n\nIn MIT krb5 1.6 or later, an authenticated kadmin user with permission\nto add principals to an LDAP Kerberos database can circumvent a DN\ncontainership check by supplying both a \"linkdn\" and \"containerdn\"\ndatabase argument, or by supplying a DN string which is a left\nextension of a container DN string but is not hierarchically within\nthe container DN.\n\nticket: 8643 (new)\ntags: pullup\ntarget_version: 1.16-next\ntarget_version: 1.15-next",
    "type_of_change": "Modification",
    "filename_of_changes": "kdb_ldap.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 144: #define  KDB_TL_USER_INFO      0x7ffe"
    ]
}
