{
    "cve_id": "CVE-2016-9934",
    "cve_description": "ext/wddx/wddx.c in PHP before 5.6.28 and 7.x before 7.0.13 allows remote attackers to cause a denial of service (NULL pointer dereference) via crafted serialized data in a wddxPacket XML document, as demonstrated by a PDORow string.",
    "cve_publish_date": "2017-01-04",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix bug #73331 - do not try to serialize/unserialize objects wddx can not handle\n\nProper soltion would be to call serialize/unserialize and deal with the result,\nbut this requires more work that should be done by wddx maintainer (not me).",
    "type_of_change": "Modification",
    "filename_of_changes": "wddx.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 478: ",
        "// Line_Reference 485: \t\t\tPHP_CLASS_ATTRIBUTES;",
        "// Line_Reference 486: ",
        "// Line_Reference 487: \t\t\tPHP_SET_CLASS_ATTRIBUTES(obj);",
        "// Line_Reference 488: ",
        "// Line_Reference 497: \t\t\tPHP_CLEANUP_CLASS_ATTRIBUTES();",
        "// Line_Reference 498: ",
        "// Line_Reference 519: \t\tPHP_CLASS_ATTRIBUTES;",
        "// Line_Reference 520: ",
        "// Line_Reference 521: \t\tPHP_SET_CLASS_ATTRIBUTES(obj);",
        "// Line_Reference 522: ",
        "// Line_Reference 531: \t\tPHP_CLEANUP_CLASS_ATTRIBUTES();",
        "// Line_Reference 532: ",
        "// Line_Reference 1015: \t\t\t\t\t\t/* Initialize target object */",
        "// Line_Reference 1016: \t\t\t\t\t\tMAKE_STD_ZVAL(obj);",
        "// Line_Reference 1017: \t\t\t\t\t\tobject_init_ex(obj, *pce);",
        "// Line_Reference 1018: ",
        "// Line_Reference 1019: \t\t\t\t\t\t/* Merge current hashtable with object's default properties */",
        "// Line_Reference 1020: \t\t\t\t\t\tzend_hash_merge(Z_OBJPROP_P(obj),",
        "// Line_Reference 1021: \t\t\t\t\t\t\t\t\t\tZ_ARRVAL_P(ent2->data),",
        "// Line_Reference 1022: \t\t\t\t\t\t\t\t\t\t(void (*)(void *)) zval_add_ref,",
        "// Line_Reference 1023: \t\t\t\t\t\t\t\t\t\t(void *) &tmp, sizeof(zval *), 0);",
        "// Line_Reference 1024: ",
        "// Line_Reference 1025: \t\t\t\t\t\tif (incomplete_class) {",
        "// Line_Reference 1026: \t\t\t\t\t\t\tphp_store_class_name(obj, Z_STRVAL_P(ent1->data), Z_STRLEN_P(ent1->data));",
        "// Line_Reference 1028: ",
        "// Line_Reference 1029: \t\t\t\t\t\t/* Clean up old array entry */",
        "// Line_Reference 1030: \t\t\t\t\t\tzval_ptr_dtor(&ent2->data);",
        "// Line_Reference 1031: ",
        "// Line_Reference 1032: \t\t\t\t\t\t/* Set stack entry to point to the newly created object */",
        "// Line_Reference 1033: \t\t\t\t\t\tent2->data = obj;",
        "// Line_Reference 1034: "
    ]
}
