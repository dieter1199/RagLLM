{
    "cve_id": "CVE-2020-11087",
    "cve_description": "In FreeRDP less than or equal to 2.0.0, there is an out-of-bound read in ntlm_read_AuthenticateMessage. This has been fixed in 2.1.0.",
    "cve_publish_date": "2020-05-29",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fixed oob read in ntlm_read_AuthenticateMessage",
    "type_of_change": "Modification",
    "filename_of_changes": "ntlm_message.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "43",
    "number_of_lines_deleted_vulnerable_to_cve": "99",
    "vulnerable_lines": [
        "// Line_Reference 686: \tUINT32 flags;",
        "// Line_Reference 687: \tNTLM_AV_PAIR* AvFlags;",
        "// Line_Reference 691: \tflags = 0;",
        "// Line_Reference 692: \tAvFlags = NULL;",
        "// Line_Reference 701: \t{",
        "// Line_Reference 702: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 703: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 704: \t}",
        "// Line_Reference 707: \t{",
        "// Line_Reference 708: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 709: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 710: \t}",
        "// Line_Reference 714: \t{",
        "// Line_Reference 715: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 716: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 717: \t}",
        "// Line_Reference 721: \t{",
        "// Line_Reference 722: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 723: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 724: \t}",
        "// Line_Reference 727: \t{",
        "// Line_Reference 728: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 729: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 730: \t}",
        "// Line_Reference 733: \t{",
        "// Line_Reference 734: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 735: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 736: \t}",
        "// Line_Reference 739: \t{",
        "// Line_Reference 740: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 741: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 742: \t}",
        "// Line_Reference 746: \t{",
        "// Line_Reference 747: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 748: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 749: \t}",
        "// Line_Reference 757: \t{",
        "// Line_Reference 758: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 759: \t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 760: \t}",
        "// Line_Reference 765: \t\t{",
        "// Line_Reference 766: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 767: \t\t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 768: \t\t}",
        "// Line_Reference 774: \t{",
        "// Line_Reference 775: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 776: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 777: \t}",
        "// Line_Reference 780: \t{",
        "// Line_Reference 781: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 782: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 783: \t}",
        "// Line_Reference 786: \t{",
        "// Line_Reference 787: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 788: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 789: \t}",
        "// Line_Reference 793: \t{",
        "// Line_Reference 794: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 795: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 796: \t}",
        "// Line_Reference 800: \t{",
        "// Line_Reference 801: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 802: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 803: \t}",
        "// Line_Reference 812: \t\t{",
        "// Line_Reference 813: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 814: \t\t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 815: \t\t}",
        "// Line_Reference 816: ",
        "// Line_Reference 817: \t\tif (ntlm_read_ntlm_v2_response(snt, &(context->NTLMv2Response)) < 0)",
        "// Line_Reference 818: \t\t{",
        "// Line_Reference 819: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 820: \t\t\tStream_Free(snt, FALSE);",
        "// Line_Reference 821: \t\t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 822: \t\t}",
        "// Line_Reference 841: \t{",
        "// Line_Reference 842: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 843: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 844: \t}",
        "// Line_Reference 849: \t\t{",
        "// Line_Reference 850: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 851: \t\t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 852: \t\t}",
        "// Line_Reference 861: \t{",
        "// Line_Reference 862: \t\tStream_Free(s, FALSE);",
        "// Line_Reference 863: \t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 864: \t}",
        "// Line_Reference 875: \t\t{",
        "// Line_Reference 876: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 877: \t\t\treturn SEC_E_INVALID_TOKEN;",
        "// Line_Reference 878: \t\t}",
        "// Line_Reference 914: \t\t{",
        "// Line_Reference 915: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 916: \t\t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 917: \t\t}",
        "// Line_Reference 928: \t\t{",
        "// Line_Reference 929: \t\t\tStream_Free(s, FALSE);",
        "// Line_Reference 930: \t\t\treturn SEC_E_INTERNAL_ERROR;",
        "// Line_Reference 931: \t\t}"
    ]
}
