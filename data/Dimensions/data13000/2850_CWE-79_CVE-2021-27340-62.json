{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Portal.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 47: // ----------------------------------------Update Missing Attendance_________________________________-",
        "// Line_Reference 48: ",
        "// Line_Reference 58: echo '<div id=\"calculating\" style=\"display: none;\" class=\"alert alert-info alert-bordered\"><i class=\"fa fa-cog fa-spin fa-lg fa-fw\"></i><span class=\"text-semibold\">'._pleaseWait.'.</span> '._compilingMissingAttendanceData.'. '._doNotClickAnywhere.'.</div>",
        "// Line_Reference 59: <div id=\"resp\"></div>';",
        "// Line_Reference 75: //-----------------------------------------Update missing attendance ends--------------------------------------------------",
        "// Line_Reference 131: // echo $_SESSION['PROFILE_ID'];",
        "// Line_Reference 155: $update_notify_s = DBGet(DBQuery('SELECT VALUE FROM program_config WHERE school_id=\\'' . UserSchool() . '\\'  AND program=\\'UPDATENOTIFY\\' AND title=\\'display_school\\' LIMIT 0, 1'));",
        "// Line_Reference 589:             echo '<div id=\"attn_alert\" style=\"display: none\" class=\"alert alert-danger alert-styled-left alert-bordered\"><span class=\"text-bold\">Warning!!</span> - Teachers have missing attendance. Go to : <b>Users -> Teacher Programs -> Missing Attendance</b></div>';",
        "// Line_Reference 599:             $RET = DBGet(DBQuery('SELECT DISTINCT s.TITLE AS SCHOOL,mi.SCHOOL_DATE,cp.TITLE AS TITLE,mi.COURSE_PERIOD_ID,mi.PERIOD_ID,cpv.ID AS CPV_ID",
        "// Line_Reference 600:     FROM missing_attendance mi,schools s,course_periods cp,course_period_var cpv WHERE s.ID=mi.SCHOOL_ID AND  cp.COURSE_PERIOD_ID=mi.COURSE_PERIOD_ID AND cp.COURSE_PERIOD_ID=cpv.COURSE_PERIOD_ID AND mi.period_id=cpv.period_id AND (mi.TEACHER_ID=\\'' . User('STAFF_ID') . '\\' OR mi.SECONDARY_TEACHER_ID=\\'' . User('STAFF_ID') . '\\' ) AND mi.SCHOOL_ID=\\'' . UserSchool() . '\\' AND mi.SYEAR=\\'' . UserSyear() . '\\' AND mi.SCHOOL_DATE < \\'' . DBDate() . '\\' AND (mi.SCHOOL_DATE=cpv.COURSE_PERIOD_DATE OR POSITION(IF(DATE_FORMAT(mi.SCHOOL_DATE,\\'%a\\') LIKE \\'Thu\\',\\'H\\',(IF(DATE_FORMAT(mi.SCHOOL_DATE,\\'%a\\') LIKE \\'Sun\\',\\'U\\',SUBSTR(DATE_FORMAT(mi.SCHOOL_DATE,\\'%a\\'),1,1)))) IN cpv.DAYS)>0) ORDER BY cp.TITLE,mi.SCHOOL_DATE '), array('SCHOOL_DATE' => 'ProperDate'));"
    ]
}
