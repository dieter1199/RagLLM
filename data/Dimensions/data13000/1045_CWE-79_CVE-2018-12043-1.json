{
    "cve_id": "CVE-2018-12043",
    "cve_description": "content/content.blueprintspages.php in Symphony 2.7.6 has XSS via the pages content page.",
    "cve_publish_date": "2018-06-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix possible self-XSS in the pages content page\n\nReported by Linkey <2542566937@qq.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "content.blueprintspages.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "54",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 33:                     PageManager::fetchTitleFromHandle($page),",
        "// Line_Reference 41:                     PageManager::fetchTitleFromHandle($page),",
        "// Line_Reference 48:                 $page = new XMLElement('span', PageManager::fetchTitleFromHandle($page));",
        "// Line_Reference 73:         $this->appendSubheading(isset($parent) ? $parent['title'] : __('Pages'), Widget::Anchor(",
        "// Line_Reference 74:             __('Create New'), Administration::instance()->getCurrentPageURL() . 'new/' . ($nesting && isset($parent) ? \"?parent={$parent['id']}\" : null),",
        "// Line_Reference 75:             __('Create a new page'), 'create button', null, array('accesskey' => 'c')",
        "// Line_Reference 76:         ));",
        "// Line_Reference 115:                 $col_title = Widget::TableData(Widget::Anchor($page_title, $page_edit_url, $page['handle']));",
        "// Line_Reference 116:                 $col_title->appendChild(Widget::Label(__('Select Page %s', array($page_title)), null, 'accessible', null, array(",
        "// Line_Reference 117:                     'for' => 'page-' . $page['id']",
        "// Line_Reference 118:                 )));",
        "// Line_Reference 128:                     $col_params = Widget::TableData(trim($page['params'], '/'));",
        "// Line_Reference 134:                     $col_types = Widget::TableData(implode(', ', $page['type']));",
        "// Line_Reference 297:         $this->setTitle(__(",
        "// Line_Reference 298:             ($title ? '%1$s &ndash; %2$s &ndash; %3$s' : '%2$s &ndash; %3$s'),",
        "// Line_Reference 299:             array(",
        "// Line_Reference 300:                 $title,",
        "// Line_Reference 301:                 __('Pages'),",
        "// Line_Reference 302:                 __('Symphony')",
        "// Line_Reference 304:         ));",
        "// Line_Reference 315:             $this->appendSubheading($title, array(",
        "// Line_Reference 316:                 Widget::Anchor(__('View Page'), $page_url, __('View Page on Frontend'), 'button', null, array('target' => '_blank', 'accesskey' => 'v'))",
        "// Line_Reference 317:             ));",
        "// Line_Reference 319:             $this->appendSubheading(!empty($title) ? $title : __('Untitled'));",
        "// Line_Reference 423:             $tags->appendChild(new XMLElement('li', $type));",
        "// Line_Reference 512:             'action[save]', ($this->_context[0] == 'edit' ? __('Save Changes') : __('Create Page')),",
        "// Line_Reference 513:             'submit', array('accesskey' => 's')"
    ]
}
