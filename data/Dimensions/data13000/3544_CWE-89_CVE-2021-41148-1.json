{
    "cve_id": "CVE-2021-41148",
    "cve_description": "Tuleap Open ALM is a libre and open source tool for end to end traceability of application and system developments. Prior to version 11.16.99.173 of Community Edition and versions 11.16-6 and 11.15-8 of Enterprise Edition, an attacker with the ability to add one the CI widget to its personal dashboard could execute arbitrary SQL queries. Tuleap Community Edition 11.16.99.173, Tuleap Enterprise Edition 11.16-6, and Tuleap Enterprise Edition 11.15-8 contain a patch for this issue.",
    "cve_publish_date": "2021-10-15",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "request #15028: The update of the CI job targeted by a widget is vulnerable to blind SQL injections\n\nChange-Id: Ib02a01586740b990feb675a8728a006ea20f7777",
    "type_of_change": "Modification",
    "filename_of_changes": "HudsonJobWidget.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 45:             $sql = 'INSERT INTO plugin_hudson_widget (widget_name, owner_id, owner_type, job_id) VALUES (\"' . $this->id . '\", ' . $this->owner_id . \", '\" . $this->owner_type . \"', \" . db_escape_int($job_id) . \" )\";",
        "// Line_Reference 46:             $res = db_query($sql);",
        "// Line_Reference 47:             $content_id = db_insertid($res);",
        "// Line_Reference 54:         $sql = 'DELETE FROM plugin_hudson_widget WHERE id = ' . $id . ' AND owner_id = ' . $this->owner_id . \" AND owner_type = '\" . $this->owner_type . \"'\";",
        "// Line_Reference 55:         db_query($sql);",
        "// Line_Reference 123:             $sql = \"UPDATE plugin_hudson_widget SET job_id=\" . $job_id . \" WHERE owner_id = \" . $this->owner_id . \" AND owner_type = '\" . $this->owner_type . \"' AND id = \" . (int) $request->get('content_id');",
        "// Line_Reference 124:             $res = db_query($sql);",
        "// Line_Reference 136:         $sql = \"SELECT *",
        "// Line_Reference 137:                     FROM plugin_hudson_widget",
        "// Line_Reference 138:                     WHERE widget_name = '\" . db_es($this->widget_id) . \"'",
        "// Line_Reference 139:                       AND owner_id = \" . db_ei($this->owner_id) . \"",
        "// Line_Reference 140:                       AND owner_type = '\" . db_es($this->owner_type) . \"'",
        "// Line_Reference 141:                       AND id = \" . db_ei($this->content_id);",
        "// Line_Reference 142: ",
        "// Line_Reference 143:         $res = db_query($sql);",
        "// Line_Reference 144:         if ($res && db_numrows($res)) {",
        "// Line_Reference 145:             $data   = db_fetch_array($res);",
        "// Line_Reference 146:             return $data['job_id'];",
        "// Line_Reference 149:         return null;"
    ]
}
