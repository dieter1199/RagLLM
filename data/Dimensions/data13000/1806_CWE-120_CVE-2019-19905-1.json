{
    "cve_id": "CVE-2019-19905",
    "cve_description": "NetHack 3.6.x before 3.6.4 is prone to a buffer overflow vulnerability when reading very long lines from configuration files. This affects systems that have NetHack installed suid/sgid, and shared systems that allow users to upload their own configuration files.",
    "cve_publish_date": "2019-12-19",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "fix potential buffer overflow loading config file",
    "type_of_change": "Modification",
    "filename_of_changes": "files.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 2315:     mungspaces(strcpy(buf, origbuf));",
        "// Line_Reference 3037:     struct obj *otmp = readobjnam(buf, (struct obj *) 0);",
        "// Line_Reference 3145:                     len = (int) strlen(inbuf) + 1;",
        "// Line_Reference 3147:                         len += (int) strlen(buf);",
        "// Line_Reference 3150:                         Sprintf(tmpbuf, \"%s %s\", buf, inbuf);",
        "// Line_Reference 3152:                     } else",
        "// Line_Reference 3153:                         Strcpy(tmpbuf, inbuf);",
        "// Line_Reference 3154:                     buf = tmpbuf;",
        "// Line_Reference 3160:                 if (handle_config_section(ep)) {",
        "// Line_Reference 3182:                         free(config_section_chosen);",
        "// Line_Reference 3184:                     if (section)",
        "// Line_Reference 3186:                     else {"
    ]
}
