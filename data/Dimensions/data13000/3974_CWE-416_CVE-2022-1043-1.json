{
    "cve_id": "CVE-2022-1043",
    "cve_description": "A flaw was found in the Linux kernelâ€™s io_uring implementation. This flaw allows an attacker with a local account to corrupt system memory, crash the system or escalate privileges.",
    "cve_publish_date": "2022-08-29",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "io_uring: fix xa_alloc_cycle() error return value check\n\nWe currently check for ret != 0 to indicate error, but '1' is a valid\nreturn and just indicates that the allocation succeeded with a wrap.\nCorrect the check to be for < 0, like it was before the xarray\nconversion.\n\nCc: stable@vger.kernel.org\nFixes: 61cf93700fe6 (\"io_uring: Convert personality_idr to XArray\")\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
    "type_of_change": "Modification",
    "filename_of_changes": "io_uring.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 9846: \tif (!ret)",
        "// Line_Reference 9847: \t\treturn id;",
        "// Line_Reference 9848: \tput_cred(creds);",
        "// Line_Reference 9849: \treturn ret;"
    ]
}
