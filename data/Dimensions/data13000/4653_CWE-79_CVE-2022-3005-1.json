{
    "cve_id": "CVE-2022-3005",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository yetiforcecompany/yetiforcecrm prior to 6.4.0.",
    "cve_publish_date": "2022-09-20",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Improved SLA Policy elements",
    "type_of_change": "Modification",
    "filename_of_changes": "CustomConditions.tpl",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "44",
    "number_of_lines_deleted_vulnerable_to_cve": "51",
    "vulnerable_lines": [
        "// Line_Reference 3: \t<!-- tpl-ServiceContracts-CustomConditions -->",
        "// Line_Reference 4: \t<input type=\"hidden\" class=\"js-all-business-hours\" value=\"{\\App\\Purifier::encodeHtml(\\App\\Json::encode($ALL_BUSINESS_HOURS))}\">",
        "// Line_Reference 5: \t<div class=\"d-none js-conditions-template\" data-js=\"container\">",
        "// Line_Reference 6: \t\t{include file=\\App\\Layout::getTemplatePath('ConditionBuilder.tpl', $MODULE_NAME) ADVANCE_CRITERIA=[]}",
        "// Line_Reference 7: \t</div>",
        "// Line_Reference 8: \t<div class=\"js-custom-conditions\" data-js=\"container\">",
        "// Line_Reference 9: \t\t{foreach item=ROW from=$SLA_POLICY_ROWS key=$ROW_INDEX}",
        "// Line_Reference 10: \t\t\t{if $ROW['policy_type']===2}",
        "// Line_Reference 11: \t\t\t\t<div class=\"card js-custom-row shadow-sm mb-2\" data-id=\"{$ROW['id']}\" data-record-id=\"{$RECORD->getId()}\" data-js=\"container\">",
        "// Line_Reference 12: \t\t\t\t\t<div class=\"card-body\">",
        "// Line_Reference 13: \t\t\t\t\t\t<div class=\"d-flex\">",
        "// Line_Reference 14: \t\t\t\t\t\t\t<div class=\"d-block\" style=\"flex-grow:1\">",
        "// Line_Reference 15: \t\t\t\t\t\t\t\t<div class=\"row no-gutters\">",
        "// Line_Reference 16: \t\t\t\t\t\t\t\t\t<div class=\"col-5 pr-2\">",
        "// Line_Reference 17: \t\t\t\t\t\t\t\t\t\t{assign var=ROW_HOURS value=explode(',', $ROW['business_hours'])}",
        "// Line_Reference 18: \t\t\t\t\t\t\t\t\t\t<label>{\\App\\Language::translate('LBL_BUSINESS_HOURS', 'ServiceContracts')}</label>",
        "// Line_Reference 19: \t\t\t\t\t\t\t\t\t\t<div>",
        "// Line_Reference 20: \t\t\t\t\t\t\t\t\t\t\t<select class=\"select2 js-business-hours\" name=\"business_hours[{$ROW_INDEX}][]\" multiple data-validation-engine=\"validate[required,funcCall[Vtiger_Base_Validator_Js.invokeValidation]]\">",
        "// Line_Reference 21: \t\t\t\t\t\t\t\t\t\t\t\t{foreach item=BUSINESS_HOURS from=$ALL_BUSINESS_HOURS}",
        "// Line_Reference 22: \t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"{$BUSINESS_HOURS['id']}\" {if in_array($BUSINESS_HOURS['id'], $ROW_HOURS)}selected=\"selected\" {/if}>{$BUSINESS_HOURS['name']}</option>",
        "// Line_Reference 23: \t\t\t\t\t\t\t\t\t\t\t\t{/foreach}",
        "// Line_Reference 24: \t\t\t\t\t\t\t\t\t\t\t</select>",
        "// Line_Reference 25: \t\t\t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 27: \t\t\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">",
        "// Line_Reference 28: \t\t\t\t\t\t\t\t\t\t<label>{\\App\\Language::translate('LBL_REACTION_TIME','ServiceContracts')}</label>",
        "// Line_Reference 29: \t\t\t\t\t\t\t\t\t\t<div class=\"input-group time\">",
        "// Line_Reference 30: \t\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"reaction_time[{$ROW_INDEX}]\" class=\"c-time-period\" value=\"{$ROW['reaction_time']}\">",
        "// Line_Reference 31: \t\t\t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 32: \t\t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 33: \t\t\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">",
        "// Line_Reference 34: \t\t\t\t\t\t\t\t\t\t<label>{\\App\\Language::translate('LBL_IDLE_TIME','ServiceContracts')}</label>",
        "// Line_Reference 35: \t\t\t\t\t\t\t\t\t\t<div class=\"input-group time\">",
        "// Line_Reference 36: \t\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"idle_time[{$ROW_INDEX}]\" class=\"c-time-period\" value=\"{$ROW['idle_time']}\">",
        "// Line_Reference 37: \t\t\t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 39: \t\t\t\t\t\t\t\t\t<div class=\"col-2 pr-2\">",
        "// Line_Reference 40: \t\t\t\t\t\t\t\t\t\t<label>{\\App\\Language::translate('LBL_RESOLVE_TIME','ServiceContracts')}</label>",
        "// Line_Reference 41: \t\t\t\t\t\t\t\t\t\t<div class=\"input-group time\">",
        "// Line_Reference 42: \t\t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"resolve_time[{$ROW_INDEX}]\" class=\"c-time-period\" value=\"{$ROW['resolve_time']}\">",
        "// Line_Reference 43: \t\t\t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 46: \t\t\t\t\t\t\t\t<div class=\"row mt-2\">",
        "// Line_Reference 47: \t\t\t\t\t\t\t\t\t<div class=\"js-conditions-col col\">",
        "// Line_Reference 48: \t\t\t\t\t\t\t\t\t\t<label>{\\App\\Language::translate('LBL_CONDITIONS', $MODULE_NAME)}</label>",
        "// Line_Reference 49: \t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"rowid[{$ROW_INDEX}]\" value=\"{$ROW['id']}\" class=\"js-custom-row-id\" />",
        "// Line_Reference 50: \t\t\t\t\t\t\t\t\t\t<input type=\"hidden\" name=\"conditions[{$ROW_INDEX}]\" class=\"js-conditions-value\" value=\"{\\App\\Purifier::encodeHtml($ROW['conditions'])}\" data-js=\"container\">",
        "// Line_Reference 51: \t\t\t\t\t\t\t\t\t\t{include file=\\App\\Layout::getTemplatePath('ConditionBuilder.tpl', $MODULE_NAME) ADVANCE_CRITERIA=\\App\\Json::decode($ROW['conditions'])}",
        "// Line_Reference 55: \t\t\t\t\t\t\t<div class=\"d-inline-flex text-right border-left\" style=\"flex-grow:0\">",
        "// Line_Reference 56: \t\t\t\t\t\t\t\t<div class=\"d-inline-block align-center\" style=\"margin:auto 0;\">",
        "// Line_Reference 57: \t\t\t\t\t\t\t\t\t<a href class=\"btn btn-danger ml-4 js-delete-row-action\"><span class=\"fas fa-trash-alt\"></span></a>",
        "// Line_Reference 63: \t\t\t{/if}",
        "// Line_Reference 64: \t\t{/foreach}",
        "// Line_Reference 65: \t</div>"
    ]
}
