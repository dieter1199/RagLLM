{
    "cve_id": "CVE-2017-12061",
    "cve_description": "An XSS issue was discovered in admin/install.php in MantisBT before 1.3.12 and 2.x before 2.5.2. Some variables under user control in the MantisBT installation script are not properly sanitized before being output, allowing remote attackers to inject arbitrary JavaScript code, as demonstrated by the $f_database, $f_db_username, and $f_admin_username variables. This is mitigated by the fact that the admin/ folder should be deleted after installation, and also prevented by CSP.",
    "cve_publish_date": "2017-08-01",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix XSS in install.php (CVE-2017-12061)\n\naLLy from ONSEC (https://twitter.com/IamSecurity) reported this\nvulnerability, allowing an attacker to inject arbitrary code through\ncrafted forms variables.\n\nSanitizing the database error message prior to output prevents the\nattack.\n\nFixes #23146",
    "type_of_change": "Modification",
    "filename_of_changes": "install.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "50",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 424: \t\tprint_test_result( BAD, true, 'Does administrative user have access to the database? ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 444: \t\t\tprint_test_result( BAD, false, 'Database user doesn\\'t have access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 796: \t\t\t\t\tprint_test_result( BAD, false, 'Database already exists? ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 798: \t\t\t\t\tprint_test_result( BAD, true, 'Does administrative user have access to create the database? ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 820: \t\t\tprint_test_result( BAD, false, 'Database user doesn\\'t have access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 1220: \t\tprint_test_result( BAD, false, 'Database user does not have access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 1235: \t\tprint_test_result( BAD, true, 'Database user does not have SELECT access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 1250: \t\tprint_test_result( BAD, true, 'Database user does not have INSERT access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 1265: \t\tprint_test_result( BAD, true, 'Database user does not have UPDATE access to the database ( ' . db_error_msg() . ' )' );",
        "// Line_Reference 1280: \t\tprint_test_result( BAD, true, 'Database user does not have DELETE access to the database ( ' . db_error_msg() . ' )' );"
    ]
}
