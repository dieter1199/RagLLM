{
    "cve_id": "CVE-2021-39181",
    "cve_description": "OpenOlat is a web-based learning management system (LMS). Prior to version 15.3.18, 15.5.3, and 16.0.0, using a prepared import XML file (e.g. a course) any class on the Java classpath can be instantiated, including spring AOP bean factories. This can be used to execute code arbitrary code by the attacker. The attack requires an OpenOlat user account with the authoring role. It can not be exploited by unregistered users. The problem is fixed in versions 15.3.18, 15.5.3, and 16.0.0. There are no known workarounds aside from upgrading.",
    "cve_publish_date": "2021-09-01",
    "cwe_id": "CWE-91",
    "cwe_name": "XML Injection (aka Blind XPath Injection)",
    "cwe_description": "The product does not properly neutralize special elements that are used in XML, allowing attackers to modify the syntax, content, or commands of the XML before it is processed by an end system.",
    "commit_message": "OO-5548: setup security of XStream by default",
    "type_of_change": "Modification",
    "filename_of_changes": "EfficiencyStatementMediaHandler.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 40: import org.olat.core.util.xml.XStreamHelper;",
        "// Line_Reference 60: import com.thoughtworks.xstream.XStream;",
        "// Line_Reference 61: ",
        "// Line_Reference 72: \tprivate static final XStream myXStream = XStreamHelper.createXStreamInstance();",
        "// Line_Reference 73: ",
        "// Line_Reference 117: \t\t\tString xml = myXStream.toXML(statement);",
        "// Line_Reference 131: \t\t\t\tstatement = (EfficiencyStatement)myXStream.fromXML(statementXml);",
        "// Line_Reference 151: \t\t\t\tstatement = (EfficiencyStatement)myXStream.fromXML(media.getContent());"
    ]
}
