{
    "cve_id": "CVE-2022-37452",
    "cve_description": "Exim before 4.95 has a heap-based buffer overflow for the alias list in host_name_lookup in host.c when sender_host_name is set.",
    "cve_publish_date": "2022-08-07",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix host_name_lookup (Close 2747)\n\nThanks to Nico R for providing a reproducing configuration.\n\n        host_lookup             = *\n        message_size_limit      = ${if def:sender_host_name {32M}{32M}}\n        acl_smtp_connect        = acl_smtp_connect\n        acl_smtp_rcpt           = acl_smtp_rcpt\n\n        begin acl\n          acl_smtp_connect:\n                warn ratelimit = 256 / 1m / per_conn\n                accept\n\n          acl_smtp_rcpt:\n                accept hosts = 127.0.0.*\n\n        begin routers\n        null:\n          driver          = accept\n          transport       = null\n\n        begin transports\n        null:\n          driver          = appendfile\n          file            = /dev/null\n\nTested with\n\n        swaks -f mailbox@example.org -t mailbox@example.org --pipe 'exim -bh 127.0.0.1 -C /opt/exim/etc/exim-bug.conf'\n\nThe IP must have a PTR to \"localhost.\" to reproduce it.\n\n(cherry picked from commit 20812729e3e47a193a21d326ecd036d67a8b2724)",
    "type_of_change": "Modification",
    "filename_of_changes": "host.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 1585:     int count = 1;",
        "// Line_Reference 1694:       int count = 0;"
    ]
}
