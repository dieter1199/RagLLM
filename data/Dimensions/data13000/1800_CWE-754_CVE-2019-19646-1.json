{
    "cve_id": "CVE-2019-19646",
    "cve_description": "pragma.c in SQLite through 3.30.1 mishandles NOT NULL in an integrity_check PRAGMA command in certain cases of generated columns.",
    "cve_publish_date": "2019-12-09",
    "cwe_id": "CWE-754",
    "cwe_name": "Improper Check for Unusual or Exceptional Conditions",
    "cwe_description": "The product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.",
    "commit_message": "Ensure that the SrcList_item.colUsed field is set correctly (set to have a\n1 for all columns of the table) when a generated column appears in the USING\nclause of a join.\n\nFossilOrigin-Name: 1923efb283e8840fa7436eb20b9d2174ef7cace1690d3b97b572a0db2048b8e3",
    "type_of_change": "Modification",
    "filename_of_changes": "resolve.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 627:     p->y.pTab = pItem->pTab;",
        "// Line_Reference 633:       testcase( iCol==BMS );",
        "// Line_Reference 634:       testcase( iCol==BMS-1 );",
        "// Line_Reference 635:       pItem->colUsed |= ((Bitmask)1)<<(iCol>=BMS ? BMS-1 : iCol);"
    ]
}
