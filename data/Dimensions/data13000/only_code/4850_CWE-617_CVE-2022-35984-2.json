int32_t num_batches = shape_tensor.flat<int32>()(0);
const int32_t num_dims = shape_tensor.dim_size(0);
samples_per_batch *= shape_tensor.flat<int32>()(i);
auto shape_vec = shape_tensor.flat<int32>();
TensorShape tensor_shape;
OP_REQUIRES_OK(ctx, TensorShapeUtils::MakeShape(
shape_vec.data(), shape_vec.size(), &tensor_shape));