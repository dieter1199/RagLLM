if (jwk_valid_for_deriving_keys(jwk)) {
return json_incref(jwk);
} else if (jwk_valid_for_signing(jwk)) {
json_auto_t* sign = json_deep_copy(tki->m_sign);
if (json_array_append(sign, jwk) == -1) {
return NULL;
}
json_auto_t* jws = jwk_sign(tki->m_payload, sign);
if (!jws) {
return NULL;
}
return json_incref(jws);
}
return find_by_thp(tki, thp);
