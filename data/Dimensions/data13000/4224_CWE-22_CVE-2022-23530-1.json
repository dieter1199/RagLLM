{
    "cve_id": "CVE-2022-23530",
    "cve_description": "GuardDog is a CLI tool to identify malicious PyPI packages. Versions prior to v0.1.8 are vulnerable to arbitrary file write when scanning a specially-crafted remote PyPI package. Extracting files using shutil.unpack_archive() from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  This issue is patched in version 0.1.8. Potential workarounds include using a safer module, like zipfile, and validating the location of the extracted files and discarding those with malicious paths.",
    "cve_publish_date": "2022-12-16",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Securely extract PyPI .tar.gz archives (#102)\n\n* Add Semgrep rule and run custom Semgrep rules in CI for SAST\r\n\r\n* Securely extract remote .tar.gz files",
    "type_of_change": "Modification",
    "filename_of_changes": "package_scanner.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 3: import shutil",
        "// Line_Reference 4: import tarsafe  # type: ignore",
        "// Line_Reference 163:         shutil.unpack_archive(zippath, unzippedpath)",
        "// Line_Reference 164:         os.remove(zippath)"
    ]
}
