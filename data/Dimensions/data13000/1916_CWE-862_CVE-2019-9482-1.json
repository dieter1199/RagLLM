{
    "cve_id": "CVE-2019-9482",
    "cve_description": "In MISP 2.4.102, an authenticated user can view sightings that they should not be eligible for. Exploiting this requires access to the event that has received the sighting. The issue affects instances with restrictive sighting settings (event only / sighting reported only).",
    "cve_publish_date": "2019-03-01",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: [vulnerability] Fixes a vulnerability where a user can view sightings that they should not be eligible for\n\n- requires access to the event that has received the sighting\n- affects instances with restrictive sighting settings (event only / sighting reported only)\n\n- as reported by Tyler McLellan of CanCyber.org",
    "type_of_change": "Modification",
    "filename_of_changes": "SightingsController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "55",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 349:             foreach ($sightings as $k => $v) {",
        "// Line_Reference 350:                 if ($v['Sighting']['org_id'] != $this->Auth->user('org_id')) {",
        "// Line_Reference 351:                     $sightings[$k]['Organisation']['name'] = '';",
        "// Line_Reference 352:                     $sightings[$k]['Sighting']['org_id'] = 0;",
        "// Line_Reference 359:         $this->set('sightings', $sightings);"
    ]
}
