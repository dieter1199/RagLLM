{
    "cve_id": "CVE-2022-2084",
    "cve_description": "Sensitive data could be exposed in world readable logs of cloud-init before version 22.3 when schema failures are reported. This leak could include hashed passwords.",
    "cve_publish_date": "2023-04-19",
    "cwe_id": "CWE-532",
    "cwe_name": "Insertion of Sensitive Information into Log File",
    "cwe_description": "Information written to log files can be of a sensitive nature and give valuable guidance to an attacker or expose sensitive user information.",
    "commit_message": "Remove schema errors from log (#1551)\n\nWhen schema errors are encountered, the section of userdata in question\r\ngets printed to the cloud-init log. As this could contain sensitive\r\ndata, so log a generic warning instead and redirect user to run\r\ncloud-init schema --system as root.\r\n\r\nLP: #1978422\r\nCVE: 2022-2084",
    "type_of_change": "Modification",
    "filename_of_changes": "schema.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 238:         else:",
        "// Line_Reference 240:             LOG.warning(",
        "// Line_Reference 241:                 \"Invalid cloud-config provided:\\n%s\", \"\\n\".join(messages)"
    ]
}
