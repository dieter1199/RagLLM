{
    "cve_id": "CVE-2020-11096",
    "cve_description": "In FreeRDP before version 2.1.2, there is a global OOB read in update_read_cache_bitmap_v3_order. As a workaround, one can disable bitmap cache with -bitmap-cache (default). This is fixed in version 2.1.2.",
    "cve_publish_date": "2020-06-22",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fixed OOB read in update_read_cache_bitmap_v3_order\n\nCVE-2020-11096 thanks @antonio-morales for finding this.",
    "type_of_change": "Modification",
    "filename_of_changes": "orders.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "98",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 116: static const BYTE CBR2_BPP[] = { 0, 0, 0, 8, 16, 24, 32 };",
        "// Line_Reference 117: ",
        "// Line_Reference 118: static const BYTE BPP_CBR2[] = { 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0,",
        "// Line_Reference 119: \t                             0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0 };",
        "// Line_Reference 120: ",
        "// Line_Reference 121: static const BYTE CBR23_BPP[] = { 0, 0, 0, 8, 16, 24, 32 };",
        "// Line_Reference 122: ",
        "// Line_Reference 123: static const BYTE BPP_CBR23[] = { 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0,",
        "// Line_Reference 124: \t                              0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0 };",
        "// Line_Reference 125: ",
        "// Line_Reference 126: static const BYTE BMF_BPP[] = { 0, 1, 0, 8, 16, 24, 32, 0 };",
        "// Line_Reference 128: static const BYTE BPP_BMF[] = { 0, 1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0,",
        "// Line_Reference 129: \t                            0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0 };",
        "// Line_Reference 818: \t\tbrush->bpp = BMF_BPP[brush->style & 0x07];",
        "// Line_Reference 819: ",
        "// Line_Reference 862: \t\tbrush->bpp = BMF_BPP[brush->style & 0x07];",
        "// Line_Reference 863: ",
        "// Line_Reference 2033: \tcache_bitmap_v2->bitmapBpp = CBR2_BPP[bitsPerPixelId];",
        "// Line_Reference 2118: \tbitsPerPixelId = BPP_CBR2[cache_bitmap_v2->bitmapBpp];",
        "// Line_Reference 2197: \tcache_bitmap_v3->bpp = CBR23_BPP[bitsPerPixelId];",
        "// Line_Reference 2253: \tbitsPerPixelId = BPP_CBR23[cache_bitmap_v3->bpp];",
        "// Line_Reference 2590: \tif (iBitmapFormat >= ARRAYSIZE(BMF_BPP))",
        "// Line_Reference 2593: \tcache_brush->bpp = BMF_BPP[iBitmapFormat];",
        "// Line_Reference 2670: \tiBitmapFormat = BPP_BMF[cache_brush->bpp];"
    ]
}
