{
    "cve_id": "CVE-2022-44900",
    "cve_description": "A directory traversal vulnerability in the SevenZipFile.extractall() function of the python library py7zr v0.20.0 and earlier allows attackers to write arbitrary files via extracting a crafted 7z file.",
    "cve_publish_date": "2022-12-06",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix sanity check for path traversal attack\n\n- Previous versions do not detect the attack in some case\n   - fixed it by call resolve()\n   - resolve() converts \"/hoge/fuga/../../../tmp/evil.sh\" to be \"/tmp/evil.sh\" then\n     relative_to() can detect path traversal attack.\n- Add path checker in writef() and writestr() methods\n  - When pass arcname as evil path such as \"../../../../tmp/evil.sh\"\n    it raises ValueError\n- Add test case of bad path detection\n- extraction: check symlink and junction is under target folder\n- Fix relative_path_marker removal\n- Don't put windows file namespace to output file path\n\nSigned-off-by: Hiroshi Miura <miurahr@linux.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "helpers.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "58",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 268:     Supports Windows NT symbolic links and reparse points.",
        "// Line_Reference 283:     Supports Windows NT symbolic links and reparse points."
    ]
}
