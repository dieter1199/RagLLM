{
    "cve_id": "CVE-2017-12895",
    "cve_description": "The ICMP parser in tcpdump before 4.9.2 has a buffer over-read in print-icmp.c:icmp_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-12895/ICMP: Check the availability of data before checksumming it.\n\nThis fixes a buffer over-read discovered by Forcepoint's security\nresearchers Otto Airamo & Antti LevomÃ¤ki.\n\nAdd tests using the capture files supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-icmp.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 601:             if (!ext_dp->icmp_length) {",
        "// Line_Reference 622:             vec[0].ptr = (const uint8_t *)(const void *)&ext_dp->icmp_ext_version_res;",
        "// Line_Reference 623:             vec[0].len = hlen;",
        "// Line_Reference 624:             ND_PRINT((ndo, \", checksum 0x%04x (%scorrect), length %u\",",
        "// Line_Reference 625:                    EXTRACT_16BITS(ext_dp->icmp_ext_checksum),",
        "// Line_Reference 626:                    in_cksum(vec, 1) ? \"in\" : \"\",",
        "// Line_Reference 627:                    hlen));"
    ]
}
