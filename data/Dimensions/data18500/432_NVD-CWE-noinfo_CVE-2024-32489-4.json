{
    "cve_id": "CVE-2024-32489",
    "cve_description": "TCPDF before 6.7.4 mishandles calls that use HTML syntax.",
    "cve_publish_date": "2024-04-15",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Squash multiple fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "tcpdf_fonts.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 1326:                 $pad = 4 - ($table[$tag]['length'] % 4);",
        "// Line_Reference 1327:                 if ($pad != 4) {",
        "// Line_Reference 1328:                     // the length of a table must be a multiple of four bytes",
        "// Line_Reference 1329:                     $table[$tag]['length'] += $pad;",
        "// Line_Reference 1330:                     $table[$tag]['data'] .= str_repeat(\"\\x0\", $pad);",
        "// Line_Reference 1331:                 }",
        "// Line_Reference 1335:                 //$table[$tag]['checkSum'] = self::_getTTFtableChecksum($table[$tag]['data'], $table[$tag]['length']);",
        "// Line_Reference 1343:         $pad = 4 - ($table['loca']['length'] % 4);",
        "// Line_Reference 1344:         if ($pad != 4) {",
        "// Line_Reference 1345:             // the length of a table must be a multiple of four bytes",
        "// Line_Reference 1346:             $table['loca']['length'] += $pad;",
        "// Line_Reference 1347:             $table['loca']['data'] .= str_repeat(\"\\x0\", $pad);",
        "// Line_Reference 1348:         }",
        "// Line_Reference 1350:         $table['loca']['checkSum'] = self::_getTTFtableChecksum($table['loca']['data'], $table['loca']['length']);",
        "// Line_Reference 1355:         $pad = 4 - ($table['glyf']['length'] % 4);",
        "// Line_Reference 1356:         if ($pad != 4) {",
        "// Line_Reference 1357:             // the length of a table must be a multiple of four bytes",
        "// Line_Reference 1358:             $table['glyf']['length'] += $pad;",
        "// Line_Reference 1359:             $table['glyf']['data'] .= str_repeat(\"\\x0\", $pad);",
        "// Line_Reference 1360:         }",
        "// Line_Reference 1362:         $table['glyf']['checkSum'] = self::_getTTFtableChecksum($table['glyf']['data'], $table['glyf']['length']);",
        "// Line_Reference 1386:         $font = substr($font, 0, $table['head']['offset'] + 8).pack('N', $checkSumAdjustment).substr($font, $table['head']['offset'] + 12);",
        "// Line_Reference 1783:             return array_map(array('TCPDF_FONTS', 'unichrUnicode'), $ta);",
        "// Line_Reference 1785:         return array_map(array('TCPDF_FONTS', 'unichrASCII'), $ta);",
        "// Line_Reference 2005:             $carr = array_map(array('TCPDF_FONTS', 'uniord'), $chars);"
    ]
}
