{
    "cve_id": "CVE-2024-24747",
    "cve_description": "MinIO is a High Performance Object Storage. When someone creates an access key, it inherits the permissions of the parent key. Not only for `s3:*` actions, but also `admin:*` actions. Which means unless somewhere above in the access-key hierarchy, the `admin` rights are denied, access keys will be able to simply override their own `s3` permissions to something more permissive. The vulnerability is fixed in RELEASE.2024-01-31T20-20-33Z.",
    "cve_publish_date": "2024-01-31",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "fix: permission checks for editing access keys (#18928)\n\nWith this change, only a user with `UpdateServiceAccountAdminAction`\r\npermission is able to edit access keys.\r\n\r\nWe would like to let a user edit their own access keys, however the\r\nfeature needs to be re-designed for better security and integration with\r\nexternal systems like AD/LDAP and OpenID.\r\n\r\nThis change prevents privilege escalation via service accounts.",
    "type_of_change": "Modification",
    "filename_of_changes": "admin-handlers-users.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 785: \t\trequestUser := cred.AccessKey",
        "// Line_Reference 786: \t\tif cred.ParentUser != \"\" {",
        "// Line_Reference 787: \t\t\trequestUser = cred.ParentUser",
        "// Line_Reference 788: \t\t}",
        "// Line_Reference 789: ",
        "// Line_Reference 790: \t\tif requestUser != svcAccount.ParentUser {",
        "// Line_Reference 791: \t\t\twriteErrorResponseJSON(ctx, w, errorCodes.ToAPIErr(ErrAccessDenied), r.URL)",
        "// Line_Reference 792: \t\t\treturn",
        "// Line_Reference 793: \t\t}"
    ]
}
