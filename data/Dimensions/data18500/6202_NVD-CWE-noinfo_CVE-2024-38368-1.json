{
    "cve_id": "CVE-2024-38368",
    "cve_description": "trunk.cocoapods.org is the authentication server for the CoacoaPods dependency manager. A vulnerability affected older pods which migrated from the pre-2014 pull request workflow to trunk. If the pods had never been claimed then it was still possible to do so. It was also possible to have all owners removed from a pod, and that made the pod available for the same claiming system. This was patched server-side in commit 71be5440906b6bdfbc0bcc7f8a9fec33367ea0f4 in September 2023.",
    "cve_publish_date": "2024-07-01",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Drop the claims feature",
    "type_of_change": "Modification",
    "filename_of_changes": "claims_controller.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "56",
    "vulnerable_lines": [
        "// Line_Reference 28: ",
        "// Line_Reference 29:       get '/new' do",
        "// Line_Reference 30:         @owner = Owner.new",
        "// Line_Reference 31:         @pods = []",
        "// Line_Reference 32:         slim :new",
        "// Line_Reference 33:       end",
        "// Line_Reference 34: ",
        "// Line_Reference 35:       post '/' do",
        "// Line_Reference 36:         find_owner",
        "// Line_Reference 37:         find_pods",
        "// Line_Reference 38:         if @owner.valid? && valid_pods?",
        "// Line_Reference 39:           change_ownership",
        "// Line_Reference 40:           if all_pods_already_claimed?",
        "// Line_Reference 41:             query = {",
        "// Line_Reference 42:               :claimer_email => @owner.email,",
        "// Line_Reference 43:               :pods => @already_claimed_pods,",
        "// Line_Reference 44:             }",
        "// Line_Reference 45:             redirect to(\"/disputes/new?#{query.to_query}\")",
        "// Line_Reference 46:           else",
        "// Line_Reference 47:             query = {",
        "// Line_Reference 48:               :claimer_email => @owner.email,",
        "// Line_Reference 49:               :successfully_claimed => @successfully_claimed_pods,",
        "// Line_Reference 50:               :already_claimed => @already_claimed_pods,",
        "// Line_Reference 51:             }",
        "// Line_Reference 52:             redirect to(\"/thanks?#{query.to_query}\")",
        "// Line_Reference 53:           end",
        "// Line_Reference 54:         end",
        "// Line_Reference 55:         prepare_errors",
        "// Line_Reference 56:         slim :new",
        "// Line_Reference 57:       end",
        "// Line_Reference 58: ",
        "// Line_Reference 59:       get '/thanks' do",
        "// Line_Reference 60:         slim :thanks",
        "// Line_Reference 61:       end",
        "// Line_Reference 114:       def all_pods_already_claimed?",
        "// Line_Reference 115:         @successfully_claimed_pods.empty? && !@already_claimed_pods.empty?",
        "// Line_Reference 116:       end",
        "// Line_Reference 117: ",
        "// Line_Reference 126: ",
        "// Line_Reference 127:       def change_ownership",
        "// Line_Reference 128:         @successfully_claimed_pods = []",
        "// Line_Reference 129:         @already_claimed_pods = []",
        "// Line_Reference 130:         DB.test_safe_transaction do",
        "// Line_Reference 131:           @owner.save_changes(:raise_on_save_failure => true)",
        "// Line_Reference 132:           unclaimed_owner = Owner.unclaimed",
        "// Line_Reference 133:           @pods.each do |pod|",
        "// Line_Reference 134:             if pod.owners == [unclaimed_owner]",
        "// Line_Reference 135:               @owner.add_pod(pod)",
        "// Line_Reference 136:               pod.remove_owner(unclaimed_owner)",
        "// Line_Reference 137:               @successfully_claimed_pods << pod.name",
        "// Line_Reference 138:             else",
        "// Line_Reference 139:               @already_claimed_pods << pod.name",
        "// Line_Reference 140:             end",
        "// Line_Reference 141:           end",
        "// Line_Reference 142:         end",
        "// Line_Reference 143:       end"
    ]
}
