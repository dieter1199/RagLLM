{
    "cve_id": "CVE-2022-23587",
    "cve_description": "Tensorflow is an Open Source Machine Learning Framework. Under certain scenarios, Grappler component of TensorFlow is vulnerable to an integer overflow during cost estimation for crop and resize. Since the cropping parameters are user controlled, a malicious person can trigger undefined behavior. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.",
    "cve_publish_date": "2022-02-04",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Prevent overflow in grappler cost estimation of crop&resize op.\n\nThe crop parameters are user controlled, so we should make sure a user can not trigger an overflow maliciously.\n\nPiperOrigin-RevId: 409670234\nChange-Id: I7994734a98b037c5642e051240329d16f959aae4",
    "type_of_change": "Modification",
    "filename_of_changes": "op_level_cost_estimator.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 2687:   ops += (mul_cost * 2 + sub_cost + add_cost) * crop_height * num_boxes;",
        "// Line_Reference 2689:   ops += (mul_cost * 2 + sub_cost + add_cost) * crop_height * crop_width *",
        "// Line_Reference 2690:          num_boxes;",
        "// Line_Reference 2694:     ops += (floor_cost + ceil_cost + sub_cost) * crop_height * num_boxes;",
        "// Line_Reference 2696:     ops += (floor_cost + ceil_cost + sub_cost) * crop_height * crop_width *",
        "// Line_Reference 2697:            num_boxes;",
        "// Line_Reference 2704:     ops += round_cost * 2 * crop_height * crop_width * num_boxes;"
    ]
}
