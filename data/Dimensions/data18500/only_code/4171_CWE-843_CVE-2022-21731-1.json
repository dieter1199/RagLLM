const int min_rank = concat_dim < 0 ? -concat_dim : concat_dim + 1;