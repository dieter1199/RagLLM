$post_type = explode( ',', $post_types );
$args      = array(
'post_type'      => $post_type,
'order'          => 'ASC',
'orderby'        => 'ID',
'posts_per_page' => -1,
'post_status'    => 'any',
);
$click_count = filter_input( INPUT_POST, 'click_count' );
if ( $click_count ) {
$posts_per_page = get_option( 'posts_per_page' );
$offset         = $click_count * $posts_per_page;
$args           = array_merge(
$args,
array(
'offset'         => $offset,
'posts_per_page' => $posts_per_page,
)
);
$s = filter_input( INPUT_POST, 's' );
if ( $s ) {
$args = array_merge(
$args,
array(
's' => $s,
)
}
$field_name = sanitize_text_field( filter_input( INPUT_POST, 'field_name' ) );
/**
* This filter will be always applied when it queries posts in related posts field.
*/
$args = apply_filters( SCF_Config::PREFIX . 'custom_related_posts_args', $args, $field_name, $post_type );
/**
* This filter will only be applied when getting posts via ajax call, therefore it won't be applied for the first load.
*/
$args = apply_filters( SCF_Config::PREFIX . 'custom_related_posts_args_ajax_call', $args, $field_name, $post_type );
$_posts = get_posts( $args );
if ( ! $post_type ) {
$post_type = array( 'post' );
}
if ( ! preg_match( '/^\d+$/', $limit ) ) {
$limit = '';
}
$args = array(
'post_type'      => $post_type,
'order'          => 'ASC',
'orderby'        => 'ID',
'posts_per_page' => $posts_per_page,
'post_status'    => 'any',
);
/**
* This filter will be always applied when it queries posts in related posts field.
*/
$args = apply_filters( SCF_Config::PREFIX . 'custom_related_posts_args', $args, $name, $post_type );
/**
* This filter will only be applied in the first load, therefore it won't be applied when getting posts via ajax call.
*/
$args = apply_filters( SCF_Config::PREFIX . 'custom_related_posts_args_first_load', $args, $name, $post_type );
// Get posts to show in the first load.
$choices_posts = get_posts( $args );
