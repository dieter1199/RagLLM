@override_settings(BANNER_TOP="Hello, Banner Top", BANNER_BOTTOM="Hello, Banner Bottom")
def test_routes_redirect_back_to_login_unauthenticated(self):
"""Assert that api docs and graphql redirects to login page if user is unauthenticated."""
urls = [reverse("api_docs"), reverse("graphql")]
response = self.client.get(url, follow=True, **headers)
self.assertHttpStatus(response, 200)
redirect_chain = [(f"/login/?next={url}", 302)]
self.assertEqual(response.redirect_chain, redirect_chain)
response_content = response.content.decode(response.charset).replace("\n", "")
# Assert Footer items(`self.footer_elements`), Banner and Banner Top is hidden
for footer_text in self.footer_elements:
self.assertNotIn(footer_text, response_content)
# Only API Docs implements BANNERS
if url == urls[0]:
self.assertNotIn("Hello, Banner Top", response_content)
self.assertNotIn("Hello, Banner Bottom", response_content)