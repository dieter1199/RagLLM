use Elabftw\Models\Config;
use Monolog\Logger;
use PDOException;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Session\Session;
require_once dirname(__DIR__, 3) . '/config.php';
require_once dirname(__DIR__, 3) . '/vendor/autoload.php';
// create Request object
$Request = Request::createFromGlobals();
$Session = new Session();
$Session->start();
$Request->setSession($Session);
// INIT APP OBJECT
// Config::getConfig() will make the first SQL request
// PDO will throw an exception if the SQL structure is not imported yet
try {
$App = new App($Request, $Session, Config::getConfig(), new Logger('elabftw'), new Csrf($Request, $Session));
} catch (PDOException $e) {
throw new ImproperActionException('The database structure is not loaded! Did you run the installer?');
}