{
    "cve_id": "CVE-2016-5733",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3 allow remote attackers to inject arbitrary web script or HTML via vectors involving (1) a crafted table name that is mishandled during privilege checking in table_row.phtml, (2) a crafted mysqld log_bin directive that is mishandled in log_selector.phtml, (3) the Transformation implementation, (4) AJAX error handling in js/ajax.js, (5) the Designer implementation, (6) the charts implementation in js/tbl_chart.js, or (7) the zoom-search implementation in rows_zoom.phtml.",
    "cve_publish_date": "2016-07-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Simplify and cleanup transformation plugins\n\nRemove PMA_transformation_global_html_replace which makes the code only\nmore confusing.\n\nAlso add escaping to browse transformations.\n\nSigned-off-by: Michal Čihař <michal@cihar.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "transformations.lib.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "38",
    "vulnerable_lines": [
        "// Line_Reference 403: ",
        "// Line_Reference 404: /**",
        "// Line_Reference 405:  * Replaces \"[__BUFFER__]\" occurrences found in $options['string'] with the text",
        "// Line_Reference 406:  * in $buffer, after performing a regular expression search and replace on",
        "// Line_Reference 407:  * $buffer using $options['regex'] and $options['regex_replace'].",
        "// Line_Reference 408:  *",
        "// Line_Reference 409:  * @param string $buffer  text that will be replaced in $options['string'],",
        "// Line_Reference 410:  *                        after being formatted",
        "// Line_Reference 411:  * @param array  $options the options required to format $buffer",
        "// Line_Reference 412:  *     = array (",
        "// Line_Reference 413:  *         'string'        => 'string', // text containing \"[__BUFFER__]\"",
        "// Line_Reference 414:  *         'regex'         => 'mixed',  // the pattern to search for",
        "// Line_Reference 415:  *         'regex_replace' => 'mixed',  // string or array of strings to replace",
        "// Line_Reference 416:  *                                      // with",
        "// Line_Reference 417:  *     );",
        "// Line_Reference 418:  *",
        "// Line_Reference 419:  * @return string containing the text with all the replacements",
        "// Line_Reference 420:  */",
        "// Line_Reference 421: function PMA_Transformation_globalHtmlReplace($buffer, $options = array())",
        "// Line_Reference 422: {",
        "// Line_Reference 423:     if (! isset($options['string'])) {",
        "// Line_Reference 424:         $options['string'] = '';",
        "// Line_Reference 425:     }",
        "// Line_Reference 426: ",
        "// Line_Reference 427:     if (isset($options['regex']) && isset($options['regex_replace'])) {",
        "// Line_Reference 428:         $buffer = preg_replace(",
        "// Line_Reference 429:             '@' . str_replace('@', '\\@', $options['regex']) . '@si',",
        "// Line_Reference 430:             $options['regex_replace'],",
        "// Line_Reference 431:             $buffer",
        "// Line_Reference 432:         );",
        "// Line_Reference 433:     }",
        "// Line_Reference 434: ",
        "// Line_Reference 435:     // Replace occurrences of [__BUFFER__] with actual text",
        "// Line_Reference 436:     $return = str_replace(\"[__BUFFER__]\", $buffer, $options['string']);",
        "// Line_Reference 437:     return $return;",
        "// Line_Reference 438: }",
        "// Line_Reference 439: ",
        "// Line_Reference 440: "
    ]
}
