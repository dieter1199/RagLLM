{
    "cve_id": "CVE-2024-24747",
    "cve_description": "MinIO is a High Performance Object Storage. When someone creates an access key, it inherits the permissions of the parent key. Not only for `s3:*` actions, but also `admin:*` actions. Which means unless somewhere above in the access-key hierarchy, the `admin` rights are denied, access keys will be able to simply override their own `s3` permissions to something more permissive. The vulnerability is fixed in RELEASE.2024-01-31T20-20-33Z.",
    "cve_publish_date": "2024-01-31",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "fix: permission checks for editing access keys (#18928)\n\nWith this change, only a user with `UpdateServiceAccountAdminAction`\r\npermission is able to edit access keys.\r\n\r\nWe would like to let a user edit their own access keys, however the\r\nfeature needs to be re-designed for better security and integration with\r\nexternal systems like AD/LDAP and OpenID.\r\n\r\nThis change prevents privilege escalation via service accounts.",
    "type_of_change": "Modification",
    "filename_of_changes": "admin-handlers-users_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "90",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 899: \t// 4. Check that svc account can restrict the policy, and that the",
        "// Line_Reference 900: \t// session policy can be updated.",
        "// Line_Reference 901: \tc.assertSvcAccSessionPolicyUpdate(ctx, s, userAdmClient, accessKey, bucket)",
        "// Line_Reference 902: ",
        "// Line_Reference 903: \t// 4. Check that service account's secret key and account status can be",
        "// Line_Reference 904: \t// updated.",
        "// Line_Reference 905: \tc.assertSvcAccSecretKeyAndStatusUpdate(ctx, s, userAdmClient, accessKey, bucket)",
        "// Line_Reference 906: "
    ]
}
