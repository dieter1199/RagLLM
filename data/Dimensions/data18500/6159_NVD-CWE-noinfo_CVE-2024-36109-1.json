{
    "cve_id": "CVE-2024-36109",
    "cve_description": "CoCalc is web-based software that enables collaboration in research, teaching, and scientific publishing. In affected versions the markdown parser allows `<script>` tags to be included which execute when published. This issue has been addressed in commit `419862a9c9879c`. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-05-28",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix XSS with Markdown on share server vulnerability\n\n- https://github.com/sagemathinc/cocalc/security/advisories/GHSA-8w44-hggw-p5rf\n- this removes some math rendering support and may cause \"user\n  frustration\", but it is worth it and the right thing to do.",
    "type_of_change": "Modification",
    "filename_of_changes": "html-ssr.tsx",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 44:       script: [\"type\"],",
        "// Line_Reference 52:       if (tag == \"script\" && name == \"type\") {",
        "// Line_Reference 53:         if (value.toLowerCase().startsWith(\"math/tex\")) {",
        "// Line_Reference 54:           if (value.includes(\"display\")) {",
        "// Line_Reference 55:             return \"math/tex; mode=display\";",
        "// Line_Reference 56:           } else {",
        "// Line_Reference 57:             return \"math/tex\";",
        "// Line_Reference 58:           }",
        "// Line_Reference 59:         }",
        "// Line_Reference 60:         return \"\";",
        "// Line_Reference 61:       }",
        "// Line_Reference 183:                 : undefined"
    ]
}
