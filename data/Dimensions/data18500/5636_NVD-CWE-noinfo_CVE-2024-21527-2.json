{
    "cve_id": "CVE-2024-21527",
    "cve_description": "Versions of the package github.com/gotenberg/gotenberg/v8/pkg/gotenberg before 8.1.0; versions of the package github.com/gotenberg/gotenberg/v8/pkg/modules/chromium before 8.1.0; versions of the package github.com/gotenberg/gotenberg/v8/pkg/modules/webhook before 8.1.0 are vulnerable to Server-side Request Forgery (SSRF) via the /convert/html endpoint when a request is made to a file via localhost, such as <iframe src=\"\\\\localhost/etc/passwd\">. By exploiting this vulnerability, an attacker can achieve local file inclusion, allowing of sensitive files read on the host system.\r\r Workaround\rAn alternative is using either or both --chromium-deny-list and --chromium-allow-list flags.",
    "cve_publish_date": "2024-07-19",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(chromium): better default deny list regexp",
    "type_of_change": "Modification",
    "filename_of_changes": "browser_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "119",
    "number_of_lines_deleted_vulnerable_to_cve": "121",
    "vulnerable_lines": [
        "// Line_Reference 8: \t\"regexp\"",
        "// Line_Reference 271: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does not match the allowed list\",",
        "// Line_Reference 274: \t\t\t\tb.arguments = browserArguments{",
        "// Line_Reference 275: \t\t\t\t\tallowList: regexp.MustCompile(\"^file:///[^tmp].*\"),",
        "// Line_Reference 276: \t\t\t\t}",
        "// Line_Reference 280: \t\t\tfs:            gotenberg.NewFileSystem(),",
        "// Line_Reference 281: \t\t\tnoDeadline:    false,",
        "// Line_Reference 282: \t\t\tstart:         false,",
        "// Line_Reference 283: \t\t\texpectError:   true,",
        "// Line_Reference 284: \t\t\texpectedError: ErrUrlNotAuthorized,",
        "// Line_Reference 287: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does match the denied list\",",
        "// Line_Reference 291: \t\t\t\t\tallowList: regexp.MustCompile(\"\"),",
        "// Line_Reference 292: \t\t\t\t\tdenyList:  regexp.MustCompile(\"^file:///tmp.*\"),",
        "// Line_Reference 301: \t\t\texpectedError: ErrUrlNotAuthorized,",
        "// Line_Reference 304: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does match the denied list\",",
        "// Line_Reference 308: \t\t\t\t\tallowList: regexp.MustCompile(\"\"),",
        "// Line_Reference 309: \t\t\t\t\tdenyList:  regexp.MustCompile(\"\"),",
        "// Line_Reference 314: \t\t\tfs:          gotenberg.NewFileSystem(),",
        "// Line_Reference 315: \t\t\tnoDeadline:  true,",
        "// Line_Reference 316: \t\t\tstart:       false,",
        "// Line_Reference 317: \t\t\texpectError: true,",
        "// Line_Reference 325: \t\t\t\t\tallowList:        regexp.MustCompile(\"^file:///tmp.*\"),",
        "// Line_Reference 326: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 357: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 358: \t\t\t\t\tdenyList:         regexp.MustCompile(\"^file:///[^tmp].*\"),",
        "// Line_Reference 389: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 390: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 424: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 425: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 457: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 458: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 490: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 491: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 523: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 524: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 556: \t\t\t\t\tallowList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 557: \t\t\t\t\tdenyList:          regexp.MustCompile(\"\"),",
        "// Line_Reference 591: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 592: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 628: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 629: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 661: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 662: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 697: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 698: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 730: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 731: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 765: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 766: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 800: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 801: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 835: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 836: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 881: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 882: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 916: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 917: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 962: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 963: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 998: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 999: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1036: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1037: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1069: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1070: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1205: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does not match the allowed list\",",
        "// Line_Reference 1209: \t\t\t\t\tallowList: regexp.MustCompile(\"^file:///[^tmp].*\"),",
        "// Line_Reference 1214: \t\t\tfs:            gotenberg.NewFileSystem(),",
        "// Line_Reference 1215: \t\t\tnoDeadline:    false,",
        "// Line_Reference 1216: \t\t\tstart:         false,",
        "// Line_Reference 1217: \t\t\texpectError:   true,",
        "// Line_Reference 1218: \t\t\texpectedError: ErrUrlNotAuthorized,",
        "// Line_Reference 1221: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does match the denied list\",",
        "// Line_Reference 1225: \t\t\t\t\tallowList: regexp.MustCompile(\"\"),",
        "// Line_Reference 1226: \t\t\t\t\tdenyList:  regexp.MustCompile(\"^file:///tmp.*\"),",
        "// Line_Reference 1235: \t\t\texpectedError: ErrUrlNotAuthorized,",
        "// Line_Reference 1238: \t\t\tscenario: \"ErrUrlNotAuthorized: main URL does match the denied list\",",
        "// Line_Reference 1242: \t\t\t\t\tallowList: regexp.MustCompile(\"\"),",
        "// Line_Reference 1243: \t\t\t\t\tdenyList:  regexp.MustCompile(\"\"),",
        "// Line_Reference 1248: \t\t\tfs:          gotenberg.NewFileSystem(),",
        "// Line_Reference 1249: \t\t\tnoDeadline:  true,",
        "// Line_Reference 1250: \t\t\tstart:       false,",
        "// Line_Reference 1251: \t\t\texpectError: true,",
        "// Line_Reference 1259: \t\t\t\t\tallowList:        regexp.MustCompile(\"^file:///tmp.*\"),",
        "// Line_Reference 1260: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1291: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1292: \t\t\t\t\tdenyList:         regexp.MustCompile(\"^file:///[^tmp].*\"),",
        "// Line_Reference 1323: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1324: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1358: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1359: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1391: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1392: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1424: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1425: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1457: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1458: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1490: \t\t\t\t\tallowList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1491: \t\t\t\t\tdenyList:          regexp.MustCompile(\"\"),",
        "// Line_Reference 1525: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1526: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1562: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1563: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1597: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1598: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1630: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1631: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1665: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1666: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1700: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1701: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1735: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1736: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1781: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1782: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1816: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1817: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1862: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1863: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),",
        "// Line_Reference 1903: \t\t\t\t\tallowList:        regexp.MustCompile(\"\"),",
        "// Line_Reference 1904: \t\t\t\t\tdenyList:         regexp.MustCompile(\"\"),"
    ]
}
