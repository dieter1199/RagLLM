{
    "cve_id": "CVE-2022-41921",
    "cve_description": "Discourse is an open-source discussion platform. Prior to version 2.9.0.beta13, users can post chat messages of an unlimited length, which can cause a denial of service for other users when posting huge amounts of text. Users should upgrade to version 2.9.0.beta13, where a limit has been introduced. No known workarounds are available.",
    "cve_publish_date": "2022-11-28",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "SECURITY: Limit chat message char length (#19207)\n\nOnly allow maximum of 6000 characters for chat messages when they\r\nare created or edited. A hidden setting can control this limit,\r\n6000 is the default.\r\n\r\nThere is also a migration here to truncate any existing messages to\r\n6000 characters if the message is already over that and if the\r\nchat_messages table exists. We also set cooked_version to NULL\r\nfor those messages so we can identify them for rebake.",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "chat_message_updater_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 75:     updater = Chat::ChatMessageUpdater.update(",
        "// Line_Reference 76:       guardian: Guardian.new(Fabricate(:user)),",
        "// Line_Reference 77:       chat_message: chat_message,",
        "// Line_Reference 78:       new_content: new_message,",
        "// Line_Reference 79:     )",
        "// Line_Reference 98:     events = DiscourseEvent.track_events {",
        "// Line_Reference 99:       Chat::ChatMessageUpdater.update(",
        "// Line_Reference 100:         guardian: guardian,",
        "// Line_Reference 101:         chat_message: chat_message,",
        "// Line_Reference 102:         new_content: \"Change to this!\",",
        "// Line_Reference 103:       )",
        "// Line_Reference 104:     }"
    ]
}
