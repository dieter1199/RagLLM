{
    "cve_id": "CVE-2024-27915",
    "cve_description": "Sulu is a PHP content management system. Starting in verson 2.2.0 and prior to version 2.4.17 and 2.5.13, access to pages is granted regardless of role permissions for webspaces which have a security system configured and permission check enabled. Webspaces without do not have this issue. The problem is patched in versions 2.4.17 and 2.5.13. Some workarounds are available. One may apply the patch to `vendor/symfony/security-http/HttpUtils.php` manually or avoid installing `symfony/security-http` versions greater equal than `v5.4.30` or `v6.3.6`.",
    "cve_publish_date": "2024-03-06",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Merge pull request from GHSA-jr83-m233-gg6p\n\n* Fix setting of Webspace Security System before Symfony RouteListener\n\n* Fix Redirect for Security System checker error\n\n* Add test case to avoid regression\n\n* Add test for none secured pages\n\n* Fix some PHP 7.2 issues\n\n* Remmove website based system listener test\n\n* Activate security only for specific test\n\n* Remove old ContentRouteProviderTests\n\n* Fix phpcs\n\n* Skip security listener test for older symfony security system\n\n* Fix code style\n\n* Fix phpstan issues\n\n* Throw deprecation when requestAnalyzer is still given\n\n* Fix code style\n\n* Mark new service as internal and final",
    "type_of_change": "Modification",
    "filename_of_changes": "SystemListenerTest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 18: use Sulu\\Component\\Webspace\\Security;",
        "// Line_Reference 19: use Sulu\\Component\\Webspace\\Webspace;",
        "// Line_Reference 49:     public function provideSetWebsiteSystem()",
        "// Line_Reference 50:     {",
        "// Line_Reference 51:         return [",
        "// Line_Reference 52:             ['sulu-test'],",
        "// Line_Reference 53:             ['sulu-blog'],",
        "// Line_Reference 54:         ];",
        "// Line_Reference 55:     }",
        "// Line_Reference 56: ",
        "// Line_Reference 57:     /**",
        "// Line_Reference 58:      * @dataProvider provideSetWebsiteSystem",
        "// Line_Reference 59:      */",
        "// Line_Reference 60:     public function testSetWebsiteSystem(string $system): void",
        "// Line_Reference 61:     {",
        "// Line_Reference 62:         $systemListener = $this->createSystemListener('website');",
        "// Line_Reference 63:         $requestEvent = $this->prophesize(RequestEvent::class);",
        "// Line_Reference 64: ",
        "// Line_Reference 65:         $webspace = new Webspace();",
        "// Line_Reference 66:         $security = new Security();",
        "// Line_Reference 67:         $security->setSystem($system);",
        "// Line_Reference 68:         $webspace->setSecurity($security);",
        "// Line_Reference 69:         $this->requestAnalyzer->getWebspace()->willReturn($webspace);",
        "// Line_Reference 70: ",
        "// Line_Reference 71:         $systemListener->onKernelRequest($requestEvent->reveal());",
        "// Line_Reference 72: ",
        "// Line_Reference 73:         $this->systemStore->setSystem($system)->shouldBeCalled();",
        "// Line_Reference 74:     }",
        "// Line_Reference 75: "
    ]
}
