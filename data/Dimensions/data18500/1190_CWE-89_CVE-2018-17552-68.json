{
    "cve_id": "CVE-2018-17552",
    "cve_description": "SQL Injection in login.php in Naviwebs Navigate CMS 2.8 allows remote attackers to bypass authentication via the navigate-user cookie.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "* security fix: replace string filtering by parameterization in almost all queries",
    "type_of_change": "Modification",
    "filename_of_changes": "webuser.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "82",
    "number_of_lines_deleted_vulnerable_to_cve": "33",
    "vulnerable_lines": [
        "// Line_Reference 52:         $ok = $DB->query('SELECT * FROM nv_webusers WHERE cookie_hash = '.protect($hash));",
        "// Line_Reference 102:             ' network = '.protect($network).' AND '.",
        "// Line_Reference 103:             ' network_user_id = '.protect($network_user_id)",
        "// Line_Reference 435: \t\t\t$website_check = 'AND website  = '.protect($website);",
        "// Line_Reference 436: ",
        "// Line_Reference 437: \t\tif($DB->query('SELECT *",
        "// Line_Reference 438: \t\t\t\t\t\t FROM nv_webusers",
        "// Line_Reference 439: \t\t\t\t\t\tWHERE ( access = 0 OR",
        "// Line_Reference 440: \t\t\t\t\t\t \t\t(access = 2 AND",
        "// Line_Reference 441: \t\t\t\t\t\t \t\t\t(access_begin = 0 OR access_begin < '.time().') AND",
        "// Line_Reference 442: \t\t\t\t\t\t \t\t\t(access_end = 0 OR access_end > '.time().')",
        "// Line_Reference 443: \t\t\t\t\t            )",
        "// Line_Reference 444: \t\t\t\t\t           )",
        "// Line_Reference 445: \t\t\t\t\t\t  '.$website_check.'",
        "// Line_Reference 446: \t\t\t\t\t\t  AND LOWER(username) = '.protect($username))",
        "// Line_Reference 447: \t\t)",
        "// Line_Reference 489:             'website = '.intval($website).' AND email = '.protect($email)",
        "// Line_Reference 571: \t\t\t WHERE email = '.protect($email).'",
        "// Line_Reference 572: \t\t\t   AND activation_key = '.protect($hash).'",
        "// Line_Reference 573: \t\t');",
        "// Line_Reference 614: \t\t\t WHERE email = '.protect($email).'",
        "// Line_Reference 615: \t\t\t   AND activation_key = '.protect($hash).'",
        "// Line_Reference 616: \t\t');",
        "// Line_Reference 673:             ' network = '.protect($network).' AND '.",
        "// Line_Reference 674:             ' network_user_id = '.protect($network_user_id)",
        "// Line_Reference 760: \t\tif($DB->query('SELECT COUNT(*) as total",
        "// Line_Reference 761: \t\t\t\t\t   FROM nv_webusers",
        "// Line_Reference 762: \t\t\t\t\t   WHERE LOWER(username) = '.protect($username).'",
        "// Line_Reference 763: \t\t\t\t\t   \t AND website = '.$website_id))",
        "// Line_Reference 891:                     WHERE website = ' . protect($website->id) . '",
        "// Line_Reference 929:             WHERE website = '.protect($website->id), 'array');",
        "// Line_Reference 992:         $DB->query('SELECT * FROM nv_webusers WHERE website = '.protect($website->id), 'object');",
        "// Line_Reference 999:                       AND nw.website = '.protect($website->id),"
    ]
}
