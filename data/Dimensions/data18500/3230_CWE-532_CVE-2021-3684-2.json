{
    "cve_id": "CVE-2021-3684",
    "cve_description": "A vulnerability was found in OpenShift Assisted Installer. During generation of the Discovery ISO, image pull secrets were leaked as plaintext in the installation logs. An authenticated user could exploit this by re-using the image pull secret to pull container images from the registry as the associated user.",
    "cve_publish_date": "2023-03-24",
    "cwe_id": "CWE-532",
    "cwe_name": "Insertion of Sensitive Information into Log File",
    "cwe_description": "Information written to log files can be of a sensitive nature and give valuable guidance to an attacker or expose sensitive user information.",
    "commit_message": "MGMT-7450: Removing pull secret token from failure logs (#340)\n\nAdding function that will change token value to <SECRET>",
    "type_of_change": "Modification",
    "filename_of_changes": "ops_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 29: \t\t\tArgs:       []string{\"-t\", \"1\", \"-m\", \"-i\", \"--\", \"podman\", \"run\", \"--net\", \"host\", \"--volume\", \"/:/rootfs:rw\", \"--volume\", \"/usr/bin/rpm-ostree:/usr/bin/rpm-ostree\", \"--privileged\", \"--entrypoint\", \"/usr/bin/machine-config-daemon\", \"quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:dc1a34f55c712b2b9c5e5a14dd85e67cbdae11fd147046ac2fef9eaf179ab221\", \"start\", \"--node-name\", \"localhost\", \"--root-mount\", \"/rootfs\", \"--once-from\", \"/opt/install-dir/bootstrap.ign\", \"--skip-reboot\"},",
        "// Line_Reference 30: \t\t\tEnv:        []string{\"HOME=/home/userZ\"},",
        "// Line_Reference 35: \t\twantError := `failed executing nsenter [-t 1 -m -i -- podman run --net host --volume /:/rootfs:rw --volume /usr/bin/rpm-ostree:/usr/bin/rpm-ostree --privileged --entrypoint /usr/bin/machine-config-daemon quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:dc1a34f55c712b2b9c5e5a14dd85e67cbdae11fd147046ac2fef9eaf179ab221 start --node-name localhost --root-mount /rootfs --once-from /opt/install-dir/bootstrap.ign --skip-reboot], Error exit status 255, LastOutput \"... or: Timeout was reached",
        "// Line_Reference 37: \t\twantDetailedError := `failed executing nsenter [-t 1 -m -i -- podman run --net host --volume /:/rootfs:rw --volume /usr/bin/rpm-ostree:/usr/bin/rpm-ostree --privileged --entrypoint /usr/bin/machine-config-daemon quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:dc1a34f55c712b2b9c5e5a14dd85e67cbdae11fd147046ac2fef9eaf179ab221 start --node-name localhost --root-mount /rootfs --once-from /opt/install-dir/bootstrap.ign --skip-reboot], env vars [HOME=/home/userZ], error exit status 255, waitStatus 255, Output \"Trying to pull quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:dc1a34f55c712b2b9c5e5a14dd85e67cbdae11fd147046ac2fef9eaf179ab221..."
    ]
}
