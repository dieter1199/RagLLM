{
    "cve_id": "CVE-2022-3065",
    "cve_description": "Improper Access Control in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "EditorUi.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 95: \t\t\t'simplification', 'sketchStyle', 'pointerEvents'];",
        "// Line_Reference 179: \t\t\t\t\t\t ['startSize', 'endSize'],",
        "// Line_Reference 180: \t\t\t\t\t\t ['sourcePerimeterSpacing', 'targetPerimeterSpacing'],",
        "// Line_Reference 181: \t\t                 ['strokeColor', 'strokeWidth'],",
        "// Line_Reference 182: \t\t                 ['fillColor', 'gradientColor', 'gradientDirection'],",
        "// Line_Reference 183: \t\t                 ['opacity'],",
        "// Line_Reference 184: \t\t                 ['html']];",
        "// Line_Reference 758: ",
        "// Line_Reference 760: \t\t\t\tif (keys[i] != 'strokeColor' || values[i] != null && values[i] != 'none')",
        "// Line_Reference 5358: ",
        "// Line_Reference 5359: \tif (graph.isEnabled())",
        "// Line_Reference 5361: \t\tgraph.getModel().beginUpdate();",
        "// Line_Reference 5362: \t\ttry",
        "// Line_Reference 5363: \t\t{",
        "// Line_Reference 5364: \t\t\texec();",
        "// Line_Reference 5365: \t\t}",
        "// Line_Reference 5366: \t\tcatch (e)",
        "// Line_Reference 5367: \t\t{",
        "// Line_Reference 5368: \t\t\tthrow e;",
        "// Line_Reference 5369: \t\t}",
        "// Line_Reference 5370: \t\tfinally",
        "// Line_Reference 5372: \t\t\t// Animates the changes in the graph model except",
        "// Line_Reference 5373: \t\t\t// for Camino, where animation is too slow",
        "// Line_Reference 5374: \t\t\tif (this.allowAnimation && animate && (navigator.userAgent == null ||",
        "// Line_Reference 5375: \t\t\t\tnavigator.userAgent.indexOf('Camino') < 0))",
        "// Line_Reference 5376: \t\t\t{",
        "// Line_Reference 5377: \t\t\t\t// New API for animating graph layout results asynchronously",
        "// Line_Reference 5378: \t\t\t\tvar morph = new mxMorphing(graph);",
        "// Line_Reference 5379: \t\t\t\tmorph.addListener(mxEvent.DONE, mxUtils.bind(this, function()",
        "// Line_Reference 5380: \t\t\t\t{",
        "// Line_Reference 5381: \t\t\t\t\tgraph.getModel().endUpdate();",
        "// Line_Reference 5382: ",
        "// Line_Reference 5383: \t\t\t\t\tif (post != null)",
        "// Line_Reference 5384: \t\t\t\t\t{",
        "// Line_Reference 5385: \t\t\t\t\t\tpost();",
        "// Line_Reference 5386: \t\t\t\t\t}",
        "// Line_Reference 5387: \t\t\t\t}));",
        "// Line_Reference 5388: ",
        "// Line_Reference 5389: \t\t\t\tmorph.startAnimation();",
        "// Line_Reference 5390: \t\t\t}",
        "// Line_Reference 5391: \t\t\telse"
    ]
}
