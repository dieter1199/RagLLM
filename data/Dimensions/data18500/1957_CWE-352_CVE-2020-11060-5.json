{
    "cve_id": "CVE-2020-11060",
    "cve_description": "In GLPI before 9.4.6, an attacker can execute system commands by abusing the backup functionality. Theoretically, this vulnerability can be exploited by an attacker without a valid account by using a CSRF. Due to the difficulty of the exploitation, the attack is only conceivable by an account having Maintenance privileges and the right to add WIFI networks. This is fixed in version 9.4.6.",
    "cve_publish_date": "2020-05-12",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Drop xml backup; check new versions from config\n\ncloses #7182",
    "type_of_change": "Modification",
    "filename_of_changes": "toolbox.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "62",
    "vulnerable_lines": [
        "// Line_Reference 1410:     * @param $auto                  boolean: check done autically ? (if not display result)",
        "// Line_Reference 1411:     *                                        (true by default)",
        "// Line_Reference 1412:     * @param $messageafterredirect  boolean: use message after redirect instead of display",
        "// Line_Reference 1413:     *                                        (false by default)",
        "// Line_Reference 1414:     *",
        "// Line_Reference 1415:     * @return string explaining the result",
        "// Line_Reference 1417:    static function checkNewVersionAvailable($auto = true, $messageafterredirect = false) {",
        "// Line_Reference 1420:       if (!$auto",
        "// Line_Reference 1421:           && !Session::haveRight('backup', Backup::CHECKUPDATE)) {",
        "// Line_Reference 1422:          return false;",
        "// Line_Reference 1423:       }",
        "// Line_Reference 1424: ",
        "// Line_Reference 1425:       if (!$auto && !$messageafterredirect) {",
        "// Line_Reference 1426:          echo \"<br>\";",
        "// Line_Reference 1427:       }",
        "// Line_Reference 1428: ",
        "// Line_Reference 1443:          if (!$auto) {",
        "// Line_Reference 1444:             if ($messageafterredirect) {",
        "// Line_Reference 1445:                Session::addMessageAfterRedirect($error, true, ERROR);",
        "// Line_Reference 1446:             } else {",
        "// Line_Reference 1447:                echo \"<div class='center'>$error</div>\";",
        "// Line_Reference 1448:             }",
        "// Line_Reference 1449:          } else {",
        "// Line_Reference 1450:             return $error;",
        "// Line_Reference 1451:          }",
        "// Line_Reference 1452: ",
        "// Line_Reference 1456: ",
        "// Line_Reference 1457:             if (!$auto) {",
        "// Line_Reference 1458:                if ($messageafterredirect) {",
        "// Line_Reference 1459:                   Session::addMessageAfterRedirect(sprintf(__('A new version is available: %s.'),",
        "// Line_Reference 1460:                                                            $latest_version));",
        "// Line_Reference 1461:                   Session::addMessageAfterRedirect(__('You will find it on the GLPI-PROJECT.org site.'));",
        "// Line_Reference 1462:                } else {",
        "// Line_Reference 1463:                   echo \"<div class='center'>\".sprintf(__('A new version is available: %s.'),",
        "// Line_Reference 1464:                                                       $latest_version).\"</div>\";",
        "// Line_Reference 1465:                   echo \"<div class='center'>\".__('You will find it on the GLPI-PROJECT.org site.').",
        "// Line_Reference 1466:                        \"</div>\";",
        "// Line_Reference 1467:                }",
        "// Line_Reference 1468: ",
        "// Line_Reference 1469:             } else {",
        "// Line_Reference 1470:                if ($messageafterredirect) {",
        "// Line_Reference 1471:                   Session::addMessageAfterRedirect(sprintf(__('A new version is available: %s.'),",
        "// Line_Reference 1472:                                                            $latest_version));",
        "// Line_Reference 1473:                } else {",
        "// Line_Reference 1474:                   return sprintf(__('A new version is available: %s.'), $latest_version);",
        "// Line_Reference 1475:                }",
        "// Line_Reference 1476:             }",
        "// Line_Reference 1477: ",
        "// Line_Reference 1479:             if (!$auto) {",
        "// Line_Reference 1480:                if ($messageafterredirect) {",
        "// Line_Reference 1481:                   Session::addMessageAfterRedirect(__('You have the latest available version'));",
        "// Line_Reference 1482:                } else {",
        "// Line_Reference 1483:                   echo \"<div class='center'>\".__('You have the latest available version').\"</div>\";",
        "// Line_Reference 1484:                }",
        "// Line_Reference 1485: ",
        "// Line_Reference 1486:             } else {",
        "// Line_Reference 1487:                if ($messageafterredirect) {",
        "// Line_Reference 1488:                   Session::addMessageAfterRedirect(__('You have the latest available version'));",
        "// Line_Reference 1489:                } else {",
        "// Line_Reference 1490:                   return __('You have the latest available version');",
        "// Line_Reference 1491:                }",
        "// Line_Reference 1492:             }"
    ]
}
