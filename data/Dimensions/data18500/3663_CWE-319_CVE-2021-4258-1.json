{
    "cve_id": "CVE-2021-4258",
    "cve_description": "A vulnerability was found in whohas. It has been rated as problematic. This issue affects some unknown processing of the component Package Information Handler. The manipulation leads to cleartext transmission of sensitive information. The attack may be initiated remotely. The real existence of this vulnerability is still doubted at the moment. The name of the patch is 667c3e2e9178f15c23d7918b5db25cd0792c8472. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216251. NOTE: Most sources redirect to the encrypted site which limits the possibilities of an attack.",
    "cve_publish_date": "2022-12-19",
    "cwe_id": "CWE-319",
    "cwe_name": "Cleartext Transmission of Sensitive Information",
    "cwe_description": "The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.",
    "commit_message": "Use https when checking package information\n\nPrevents network attackers from manipulating the displayed information.\n\nStick to http for Mandriva and SourceMage,\nsince they don't appear to support https.",
    "type_of_change": "Modification",
    "filename_of_changes": "whohas",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 190: \tmy $baseurl = \"http://dl.fedoraproject.org/pub/fedora/linux/releases/\";",
        "// Line_Reference 264: \tmy $baseurl = \"http://www.macports.org\";",
        "// Line_Reference 294: \tmy $baseurl = \"http://pdb.finkproject.org/pdb/\";",
        "// Line_Reference 391: \tmy $query = \"http://www.freebsd.org/cgi/ports.cgi?query=\".$_[0].\"&stype=all\";",
        "// Line_Reference 407: \t\t\tpush @urls,  \"http://www.freebsd.org/cgi/ports.cgi?stype=all&query=$names[$now]\";",
        "// Line_Reference 555: \tmy $baseurl = 'http://ftp.openbsd.org/pub/OpenBSD/'.$rel.'/packages/'.$arch.'/';",
        "// Line_Reference 602: \tmy $baseurl = \"http://www.openbsd.org/\".$rel.'_packages/';",
        "// Line_Reference 649: \tmy $baseurl = \"http://www.cygwin.com/packages\";",
        "// Line_Reference 696: \tmy $gentoobase = \"http://gpo.zugaina.org/\";",
        "// Line_Reference 697: \tmy $gentoobaseofficial = \"http://packages.gentoo.org/package\";",
        "// Line_Reference 819: \tmy $slackbase  = \"http://packages.slackware.com/\";",
        "// Line_Reference 895: \t&debuntu('http://packages.debian.org','Debian',\\@dists,$_[0]);",
        "// Line_Reference 901: \t&debuntu('http://packages.ubuntu.com','Ubuntu',\\@array,$_[0]);",
        "// Line_Reference 1158: \tmy $opensusebase = \"http://software.opensuse.org\";",
        "// Line_Reference 1241: \tmy @lines = split /\\n|<br\\/>/, &fetchdoc(\"http://pkgsrc.se/search.php?so=\".$_[0]);"
    ]
}
