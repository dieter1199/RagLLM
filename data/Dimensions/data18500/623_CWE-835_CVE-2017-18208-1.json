{
    "cve_id": "CVE-2017-18208",
    "cve_description": "The madvise_willneed function in mm/madvise.c in the Linux kernel before 4.14.4 allows local users to cause a denial of service (infinite loop) by triggering use of MADVISE_WILLNEED for a DAX mapping.",
    "cve_publish_date": "2018-03-01",
    "cwe_id": "CWE-835",
    "cwe_name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
    "cwe_description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop.",
    "commit_message": "mm/madvise.c: fix madvise() infinite loop under special circumstances\n\nMADVISE_WILLNEED has always been a noop for DAX (formerly XIP) mappings.\nUnfortunately madvise_willneed() doesn't communicate this information\nproperly to the generic madvise syscall implementation.  The calling\nconvention is quite subtle there.  madvise_vma() is supposed to either\nreturn an error or update &prev otherwise the main loop will never\nadvance to the next vma and it will keep looping for ever without a way\nto get out of the kernel.\n\nIt seems this has been broken since introduction.  Nobody has noticed\nbecause nobody seems to be using MADVISE_WILLNEED on these DAX mappings.\n\n[mhocko@suse.com: rewrite changelog]\nLink: http://lkml.kernel.org/r/20171127115318.911-1-guoxuenan@huawei.com\nFixes: fe77ba6f4f97 (\"[PATCH] xip: madvice/fadvice: execute in place\")\nSigned-off-by: chenjie <chenjie6@huawei.com>\nSigned-off-by: guoxuenan <guoxuenan@huawei.com>\nAcked-by: Michal Hocko <mhocko@suse.com>\nCc: Minchan Kim <minchan@kernel.org>\nCc: zhangyi (F) <yi.zhang@huawei.com>\nCc: Miao Xie <miaoxie@huawei.com>\nCc: Mike Rapoport <rppt@linux.vnet.ibm.com>\nCc: Shaohua Li <shli@fb.com>\nCc: Andrea Arcangeli <aarcange@redhat.com>\nCc: Mel Gorman <mgorman@techsingularity.net>\nCc: Kirill A. Shutemov <kirill.shutemov@linux.intel.com>\nCc: David Rientjes <rientjes@google.com>\nCc: Anshuman Khandual <khandual@linux.vnet.ibm.com>\nCc: Rik van Riel <riel@redhat.com>\nCc: Carsten Otte <cotte@de.ibm.com>\nCc: Dan Williams <dan.j.williams@intel.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "madvise.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 281: \t\t*prev = vma;",
        "// Line_Reference 287: \t\t*prev = vma;",
        "// Line_Reference 302: \t*prev = vma;"
    ]
}
