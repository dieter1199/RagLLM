{
    "cve_id": "CVE-2018-9918",
    "cve_description": "libqpdf.a in QPDF through 8.0.2 mishandles certain \"expected dictionary key but found non-name object\" cases, allowing remote attackers to cause a denial of service (stack exhaustion), related to the QPDFObjectHandle and QPDF_Dictionary classes, because nesting in direct objects is not restricted.",
    "cve_publish_date": "2018-04-10",
    "cwe_id": "CWE-674",
    "cwe_name": "Uncontrolled Recursion",
    "cwe_description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
    "commit_message": "Limit depth of nesting in direct objects (fixes #202)\n\nThis fixes CVE-2018-9918.",
    "type_of_change": "Modification",
    "filename_of_changes": "QPDFObjectHandle.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1490:             olist_stack.push_back(std::vector<QPDFObjectHandle>());",
        "// Line_Reference 1491:             state = st_start;",
        "// Line_Reference 1492:             offset_stack.push_back(input->tell());",
        "// Line_Reference 1493:             state_stack.push_back(",
        "// Line_Reference 1494:                 (token.getType() == QPDFTokenizer::tt_array_open) ?",
        "// Line_Reference 1495:                 st_array : st_dictionary);"
    ]
}
