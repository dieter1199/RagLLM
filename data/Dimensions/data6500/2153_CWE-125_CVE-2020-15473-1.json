{
    "cve_id": "CVE-2020-15473",
    "cve_description": "In nDPI through 3.2, the OpenVPN dissector is vulnerable to a heap-based buffer over-read in ndpi_search_openvpn in lib/protocols/openvpn.c.",
    "cve_publish_date": "2020-07-01",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix for potential heap-buffer-overflow in ndpi_search_openvpn",
    "type_of_change": "Modification",
    "filename_of_changes": "openvpn.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 75: ",
        "// Line_Reference 76:   if(packet->payload_packet_len >= 40) {",
        "// Line_Reference 79:       ovpn_payload += 2;",
        "// Line_Reference 88: \t     htons(packet->udp->source), htons(packet->udp->dest), packet->payload_packet_len);",
        "// Line_Reference 94: \t     ((packet->payload_packet_len == 112)",
        "// Line_Reference 97: \t     || ((packet->payload_packet_len == 80)",
        "// Line_Reference 122:         alen = ovpn_payload[P_PACKET_ID_ARRAY_LEN_OFFSET(hmac_size)];",
        "// Line_Reference 124: \t  session_remote = ovpn_payload + P_PACKET_ID_ARRAY_LEN_OFFSET(hmac_size) + 1 + alen * 4;",
        "// Line_Reference 125: ",
        "// Line_Reference 126:           if(memcmp(flow->ovpn_session_id, session_remote, 8) == 0) {",
        "// Line_Reference 127: \t    NDPI_LOG_INFO(ndpi_struct,\"found openvpn\\n\");",
        "// Line_Reference 128: \t    ndpi_set_detected_protocol(ndpi_struct, flow, NDPI_PROTOCOL_OPENVPN, NDPI_PROTOCOL_UNKNOWN);",
        "// Line_Reference 129: \t    return;",
        "// Line_Reference 130: \t  } else {",
        "// Line_Reference 131:             NDPI_LOG_DBG2(ndpi_struct,",
        "// Line_Reference 132: \t\t   \"key mismatch: %02x%02x%02x%02x%02x%02x%02x%02x\\n\",",
        "// Line_Reference 133: \t\t   session_remote[0], session_remote[1], session_remote[2], session_remote[3],",
        "// Line_Reference 134: \t\t   session_remote[4], session_remote[5], session_remote[6], session_remote[7]);",
        "// Line_Reference 135:             failed = 1;",
        "// Line_Reference 136:           }",
        "// Line_Reference 137:         } else"
    ]
}
