{
    "cve_id": "CVE-2019-8460",
    "cve_description": "OpenBSD kernel version <= 6.5 can be forced to create long chains of TCP SACK holes that causes very expensive calls to tcp_sack_option() for every incoming SACK packet which can lead to a denial of service.",
    "cve_publish_date": "2019-08-26",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Received SACK options are managed by a linked list at the TCP socket.\nThere is a global tunable limit net.inet.tcp.sackholelimit, default\nis 32768.  If an attacker manages to attach all these sack holes\nto a few TCP connections, the lists may grow long.  Traversing them\nmight cause higher CPU consumption on the victim machine.  In\npractice such a situation is hard to create as the TCP retransmit\nand 2*msl timer flush the list periodically.  For additional\nprotection, enforce a per connection limit of 128 SACK holes in the\nlist.\nreported by Reuven Plevinsky and Tal Vainshtein\ndiscussed with claudio@ and procter@; OK deraadt@",
    "type_of_change": "Modification",
    "filename_of_changes": "tcp.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 1: /*\t$OpenBSD: tcp.h,v 1.20 2013/08/12 21:57:16 bluhm Exp $\t*/",
        "// Line_Reference 105: #define\tTCP_MAX_SACK\t3\t/* MAX # SACKs sent in any segment */"
    ]
}
