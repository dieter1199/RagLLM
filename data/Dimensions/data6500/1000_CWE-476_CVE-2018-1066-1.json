{
    "cve_id": "CVE-2018-1066",
    "cve_description": "The Linux kernel before version 4.11 is vulnerable to a NULL pointer dereference in fs/cifs/cifsencrypt.c:setup_ntlmv2_rsp() that allows an attacker controlling a CIFS server to kernel panic a client that has this server mounted, because an empty TargetInfo field in an NTLMSSP setup negotiation response is mishandled during session recovery.",
    "cve_publish_date": "2018-03-02",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "CIFS: Enable encryption during session setup phase\n\nIn order to allow encryption on SMB connection we need to exchange\na session key and generate encryption and decryption keys.\n\nSigned-off-by: Pavel Shilovsky <pshilov@microsoft.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "sess.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 347: \t\tNTLMSSP_NEGOTIATE_NTLM | NTLMSSP_NEGOTIATE_EXTENDED_SEC;",
        "// Line_Reference 348: \tif (ses->server->sign) {",
        "// Line_Reference 350: \t\tif (!ses->server->session_estab ||",
        "// Line_Reference 351: \t\t\t\tses->ntlmssp->sesskey_per_smbsess)",
        "// Line_Reference 352: \t\t\tflags |= NTLMSSP_NEGOTIATE_KEY_XCH;",
        "// Line_Reference 353: \t}",
        "// Line_Reference 410: \t\tNTLMSSP_NEGOTIATE_NTLM | NTLMSSP_NEGOTIATE_EXTENDED_SEC;",
        "// Line_Reference 411: \tif (ses->server->sign) {",
        "// Line_Reference 413: \t\tif (!ses->server->session_estab ||",
        "// Line_Reference 414: \t\t\t\tses->ntlmssp->sesskey_per_smbsess)",
        "// Line_Reference 415: \t\t\tflags |= NTLMSSP_NEGOTIATE_KEY_XCH;",
        "// Line_Reference 416: \t}"
    ]
}
