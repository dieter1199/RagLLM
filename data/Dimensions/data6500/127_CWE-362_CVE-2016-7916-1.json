{
    "cve_id": "CVE-2016-7916",
    "cve_description": "Race condition in the environ_read function in fs/proc/base.c in the Linux kernel before 4.5.4 allows local users to obtain sensitive information from kernel memory by reading a /proc/*/environ file during a process-setup time interval in which environment-variable copying is incomplete.",
    "cve_publish_date": "2016-11-16",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "proc: prevent accessing /proc/<PID>/environ until it's ready\n\nIf /proc/<PID>/environ gets read before the envp[] array is fully set up\nin create_{aout,elf,elf_fdpic,flat}_tables(), we might end up trying to\nread more bytes than are actually written, as env_start will already be\nset but env_end will still be zero, making the range calculation\nunderflow, allowing to read beyond the end of what has been written.\n\nFix this as it is done for /proc/<PID>/cmdline by testing env_end for\nzero.  It is, apparently, intentionally set last in create_*_tables().\n\nThis bug was found by the PaX size_overflow plugin that detected the\narithmetic underflow of 'this_len = env_end - (env_start + src)' when\nenv_end is still zero.\n\nThe expected consequence is that userland trying to access\n/proc/<PID>/environ of a not yet fully set up process may get\ninconsistent data as we're in the middle of copying in the environment\nvariables.\n\nFixes: https://forums.grsecurity.net/viewtopic.php?f=3&t=4363\nFixes: https://bugzilla.kernel.org/show_bug.cgi?id=116461\nSigned-off-by: Mathias Krause <minipli@googlemail.com>\nCc: Emese Revfy <re.emese@gmail.com>\nCc: Pax Team <pageexec@freemail.hu>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: Mateusz Guzik <mguzik@redhat.com>\nCc: Alexey Dobriyan <adobriyan@gmail.com>\nCc: Cyrill Gorcunov <gorcunov@openvz.org>\nCc: Jarod Wilson <jarod@redhat.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "base.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 958: \tif (!mm)"
    ]
}
