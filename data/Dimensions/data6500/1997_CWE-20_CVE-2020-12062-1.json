{
    "cve_id": "CVE-2020-12062",
    "cve_description": "The scp client in OpenSSH 8.2 incorrectly sends duplicate responses to the server upon a utimes system call failure, which allows a malicious unprivileged user on the remote server to overwrite arbitrary files in the client's download directory by creating a crafted subdirectory anywhere on the remote server. The victim must use the command scp -rp to download a file hierarchy containing, anywhere inside, this crafted subdirectory. NOTE: the vendor points out that \"this attack can achieve no more than a hostile peer is already able to achieve within the scp protocol\" and \"utimes does not fail under normal circumstances.",
    "cve_publish_date": "2020-06-01",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "upstream: another case where a utimes() failure could make scp send\n\na desynchronising error; reminded by Aymeric Vincent ok deraadt markus\n\nOpenBSD-Commit-ID: 2ea611d34d8ff6d703a7a8bf858aa5dbfbfa7381",
    "type_of_change": "Modification",
    "filename_of_changes": "scp.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 1: /* $OpenBSD: scp.c,v 1.209 2020/05/01 06:31:42 djm Exp $ */",
        "// Line_Reference 1430: \t\t\t\tif (utimes(vect[0], tv) == -1)",
        "// Line_Reference 1431: \t\t\t\t\trun_err(\"%s: set times: %s\",",
        "// Line_Reference 1432: \t\t\t\t\t    vect[0], strerror(errno));"
    ]
}
