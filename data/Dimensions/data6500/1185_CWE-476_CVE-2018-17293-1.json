{
    "cve_id": "CVE-2018-17293",
    "cve_description": "An issue was discovered in WAVM before 2018-09-16. The run function in Programs/wavm/wavm.cpp does not check whether there is Emscripten memory to store the command-line arguments passed by the input WebAssembly file's main function, which allows attackers to cause a denial of service (application crash by NULL pointer dereference) or possibly have unspecified other impact by crafting certain WebAssembly files.",
    "cve_publish_date": "2018-09-21",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix dereferencing null pointer when running wavm with WebAssembly main function that takes command-line arguments but no Emscripten memory to write them to",
    "type_of_change": "Modification",
    "filename_of_changes": "wavm.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 253: \t\t\tMemoryInstance* defaultMemory = Runtime::getDefaultMemory(moduleInstance);",
        "// Line_Reference 254: \t\t\tif(!defaultMemory)",
        "// Line_Reference 262: \t\t\tstd::vector<const char*> argStrings;",
        "// Line_Reference 263: \t\t\targStrings.push_back(options.filename);",
        "// Line_Reference 264: \t\t\tchar** args = options.args;",
        "// Line_Reference 265: \t\t\twhile(*args) { argStrings.push_back(*args++); };",
        "// Line_Reference 266: ",
        "// Line_Reference 267: \t\t\tEmscripten::injectCommandArgs(emscriptenInstance, argStrings, invokeArgs);"
    ]
}
