guint      protocol_timeout;
/* Called if too much time passes between the initial connection and
* the XSMP protocol setup.
*/
static gboolean
_client_protocol_timeout (GsmXSMPClient *client)
{
g_debug ("GsmXSMPClient: client_protocol_timeout for client '%s' in ICE status %d",
client->priv->description,
IceConnectionStatus (client->priv->ice_connection));
gsm_client_set_status (GSM_CLIENT (client), GSM_CLIENT_FAILED);
gsm_client_disconnected (GSM_CLIENT (client));
return FALSE;
}
client->priv->protocol_timeout = g_timeout_add_seconds (5,
(GSourceFunc)_client_protocol_timeout,
client);
if (client->priv->protocol_timeout > 0) {
g_source_remove (client->priv->protocol_timeout);
}
if (client->priv->protocol_timeout) {
g_source_remove (client->priv->protocol_timeout);
client->priv->protocol_timeout = 0;
}
