{
    "cve_id": "CVE-2024-32489",
    "cve_description": "TCPDF before 6.7.4 mishandles calls that use HTML syntax.",
    "cve_publish_date": "2024-04-15",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Squash multiple fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "example_049.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 5: // Last Update : 2014-12-10",
        "// Line_Reference 81: If you are printing user-generated content, tcpdf tag can be unsafe.",
        "// Line_Reference 82: You can disable this tag by setting to false the K_TCPDF_CALLS_IN_HTML",
        "// Line_Reference 83: constant on TCPDF configuration file.",
        "// Line_Reference 85: For security reasons, the parameters for the 'params' attribute of TCPDF",
        "// Line_Reference 94: <span style=\"color:red;\">If you are using user-generated content, the tcpdf tag can be unsafe.<br />",
        "// Line_Reference 95: You can disable this tag by setting to false the <b>K_TCPDF_CALLS_IN_HTML</b> constant on TCPDF configuration file.</span>",
        "// Line_Reference 98: $params = $pdf->serializeTCPDFtagParameters(array('CODE 39', 'C39', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N'));",
        "// Line_Reference 99: $html .= '<tcpdf method=\"write1DBarcode\" params=\"'.$params.'\" />';",
        "// Line_Reference 101: $params = $pdf->serializeTCPDFtagParameters(array('CODE 128', 'C128', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N'));",
        "// Line_Reference 102: $html .= '<tcpdf method=\"write1DBarcode\" params=\"'.$params.'\" />';",
        "// Line_Reference 104: $html .= '<tcpdf method=\"AddPage\" /><h2>Graphic Functions</h2>';",
        "// Line_Reference 106: $params = $pdf->serializeTCPDFtagParameters(array(0));",
        "// Line_Reference 107: $html .= '<tcpdf method=\"SetDrawColor\" params=\"'.$params.'\" />';",
        "// Line_Reference 109: $params = $pdf->serializeTCPDFtagParameters(array(50, 50, 40, 10, 'DF', array(), array(0,128,255)));",
        "// Line_Reference 110: $html .= '<tcpdf method=\"Rect\" params=\"'.$params.'\" />';"
    ]
}
