{
    "cve_id": "CVE-2022-23564",
    "cve_description": "Tensorflow is an Open Source Machine Learning Framework. When decoding a resource handle tensor from protobuf, a TensorFlow process can encounter cases where a `CHECK` assertion is invalidated based on user controlled arguments. This allows attackers to cause denial of services in TensorFlow processes. The fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.",
    "cve_publish_date": "2022-02-04",
    "cwe_id": "CWE-617",
    "cwe_name": "Reachable Assertion",
    "cwe_description": "The product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.",
    "commit_message": "Prevent `CHECK`-fail when decoding resource handles from proto\n\nIn certain scenarios, the proto might contain tensors that have too many elements (overflow). This is a `CHECK`-fail in general, but we should prevent this, given how many CVEs caused by that we have received this year (a large fraction of 200).\n\nPiperOrigin-RevId: 408049766\nChange-Id: I2ac20b247aa8ed9110846fbdb7a0a9401f2c168c",
    "type_of_change": "Modification",
    "filename_of_changes": "resource_handle.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 31:   FromProto(proto);",
        "// Line_Reference 49: void ResourceHandle::FromProto(const ResourceHandleProto& proto) {",
        "// Line_Reference 58:     PartialTensorShape shape(dtype_and_shape.shape());",
        "// Line_Reference 72:   const bool status = proto.ParseFromString(s);",
        "// Line_Reference 73:   if (status) FromProto(proto);",
        "// Line_Reference 74:   return status;",
        "// Line_Reference 143:     ps[i].FromProto(proto);"
    ]
}
