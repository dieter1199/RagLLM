{
    "cve_id": "CVE-2022-23544",
    "cve_description": "MeterSphere is a one-stop open source continuous testing platform, covering test management, interface testing, UI testing and performance testing. Versions prior to 2.5.0 are subject to a Server-Side Request Forgery that leads to Cross-Site Scripting. A Server-Side request forgery in `IssueProxyResourceService::getMdImageByUrl` allows an attacker to access internal resources, as well as executing JavaScript code in the context of Metersphere's origin by a victim of a reflected XSS. This vulnerability has been fixed in v2.5.0. There are no known workarounds.",
    "cve_publish_date": "2022-12-28",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "fix(测试跟踪): 缺陷平台请求转发添加白名单",
    "type_of_change": "Modification",
    "filename_of_changes": "ZentaoPlatform.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 495:             if (originSubUrl.contains(\"/url?url=\")) {",
        "// Line_Reference 568:                     try {",
        "// Line_Reference 569:                         URI uri = new URI(zentaoClient.getBaseUrl());",
        "// Line_Reference 570:                         path = uri.getScheme() + \"://\" + uri.getHost() + path.replaceAll(\"&amp;\", \"&\");",
        "// Line_Reference 571:                     } catch (URISyntaxException e) {",
        "// Line_Reference 572:                         path = zentaoClient.getBaseUrl() + path.replaceAll(\"&amp;\", \"&\");",
        "// Line_Reference 573:                         LogUtil.error(e);",
        "// Line_Reference 576:                 path = \"/resource/md/get/url?url=\" + URLEncoder.encode(path, StandardCharsets.UTF_8);"
    ]
}
