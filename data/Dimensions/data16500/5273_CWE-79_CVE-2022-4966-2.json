{
    "cve_id": "CVE-2022-4966",
    "cve_description": "A vulnerability was found in sequentech admin-console up to 6.1.7 and classified as problematic. Affected by this issue is some unknown functionality of the component Election Description Handler. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 7.0.0-beta.1 is able to address this issue. The patch is identified as 0043a6b1e6e0f5abc9557e73f9ffc524fc5d609d. It is recommended to upgrade the affected component. VDB-258782 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2024-04-01",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix some XSS (#292) (#293)\n\nThere was an issue with election description. During election creation,\r\nwe relied in ng-bind-html to sanitize the visualization of election\r\ndescription before being sanitized by the backend (because it has not\r\nyet been sent to the backend), but apparently it doesn't work for some\r\nxss. The same issue happened in election list when showing the\r\ndescription of the drafti election.\r\n\r\nWith this change, we always show the election description as plain text\r\nso that we don't need to sanitize it. Also see related issue with\r\nhtmlToText in common-ui: https://github.com/sequentech/common-ui/pull/221\r\nbecause sometimes we also called to our own htmlToText angular filter,\r\nand sanitization was also needed to happen there.\r\n\r\nAnother fix is to use $sanitize more pervasively in the election\r\ncreation screen, so that any reply from the server is also not trusted\r\nand properly sanitized.",
    "type_of_change": "Modification",
    "filename_of_changes": "create.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 72:           scope.log += \"<p>\" + text + \"</p>\";",
        "// Line_Reference 76:           scope.log += \"<p class=\\\"text-brand-danger\\\">\" + text + \"</p>\";",
        "// Line_Reference 1081:                     data: {message: errorMsg},",
        "// Line_Reference 1319:                       data: errorData,"
    ]
}
