{
    "cve_id": "CVE-2020-15852",
    "cve_description": "An issue was discovered in the Linux kernel 5.5 through 5.7.9, as used in Xen through 4.13.x for x86 PV guests. An attacker may be granted the I/O port permissions of an unrelated task. This occurs because tss_invalidate_io_bitmap mishandling causes a loss of synchronization between the I/O bitmaps of TSS and Xen, aka CID-cadfad870154.",
    "cve_publish_date": "2020-07-20",
    "cwe_id": "CWE-276",
    "cwe_name": "Incorrect Default Permissions",
    "cwe_description": "During installation, installed file permissions are set to allow anyone to modify those files.",
    "commit_message": "x86/ioperm: Fix io bitmap invalidation on Xen PV\n\ntss_invalidate_io_bitmap() wasn't wired up properly through the pvop\nmachinery, so the TSS and Xen's io bitmap would get out of sync\nwhenever disabling a valid io bitmap.\n\nAdd a new pvop for tss_invalidate_io_bitmap() to fix it.\n\nThis is XSA-329.\n\nFixes: 22fe5b0439dd (\"x86/ioperm: Move TSS bitmap update to exit to user work\")\nSigned-off-by: Andy Lutomirski <luto@kernel.org>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nReviewed-by: Juergen Gross <jgross@suse.com>\nReviewed-by: Thomas Gleixner <tglx@linutronix.de>\nCc: stable@vger.kernel.org\nLink: https://lkml.kernel.org/r/d53075590e1f91c19f8af705059d3ff99424c020.1595030016.git.luto@kernel.org",
    "type_of_change": "Modification",
    "filename_of_changes": "process.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 325: static inline void tss_invalidate_io_bitmap(struct tss_struct *tss)",
        "// Line_Reference 326: {",
        "// Line_Reference 327: \t/*",
        "// Line_Reference 328: \t * Invalidate the I/O bitmap by moving io_bitmap_base outside the",
        "// Line_Reference 329: \t * TSS limit so any subsequent I/O access from user space will",
        "// Line_Reference 330: \t * trigger a #GP.",
        "// Line_Reference 331: \t *",
        "// Line_Reference 332: \t * This is correct even when VMEXIT rewrites the TSS limit",
        "// Line_Reference 333: \t * to 0x67 as the only requirement is that the base points",
        "// Line_Reference 334: \t * outside the limit.",
        "// Line_Reference 335: \t */",
        "// Line_Reference 336: \ttss->x86_tss.io_bitmap_base = IO_BITMAP_OFFSET_INVALID;",
        "// Line_Reference 337: }",
        "// Line_Reference 338: ",
        "// Line_Reference 349: \t\ttss_invalidate_io_bitmap(this_cpu_ptr(&cpu_tss_rw));",
        "// Line_Reference 383: \t\ttss_invalidate_io_bitmap(tss);"
    ]
}
