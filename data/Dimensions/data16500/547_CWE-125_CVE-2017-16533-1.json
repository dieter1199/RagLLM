{
    "cve_id": "CVE-2017-16533",
    "cve_description": "The usbhid_parse function in drivers/hid/usbhid/hid-core.c in the Linux kernel before 4.13.8 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.",
    "cve_publish_date": "2017-11-04",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "HID: usbhid: fix out-of-bounds bug\n\nThe hid descriptor identifies the length and type of subordinate\ndescriptors for a device. If the received hid descriptor is smaller than\nthe size of the struct hid_descriptor, it is possible to cause\nout-of-bounds.\n\nIn addition, if bNumDescriptors of the hid descriptor have an incorrect\nvalue, this can also cause out-of-bounds while approaching hdesc->desc[n].\n\nSo check the size of hid descriptor and bNumDescriptors.\n\n\tBUG: KASAN: slab-out-of-bounds in usbhid_parse+0x9b1/0xa20\n\tRead of size 1 at addr ffff88006c5f8edf by task kworker/1:2/1261\n\n\tCPU: 1 PID: 1261 Comm: kworker/1:2 Not tainted\n\t4.14.0-rc1-42251-gebb2c2437d80 #169\n\tHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011\n\tWorkqueue: usb_hub_wq hub_event\n\tCall Trace:\n\t__dump_stack lib/dump_stack.c:16\n\tdump_stack+0x292/0x395 lib/dump_stack.c:52\n\tprint_address_description+0x78/0x280 mm/kasan/report.c:252\n\tkasan_report_error mm/kasan/report.c:351\n\tkasan_report+0x22f/0x340 mm/kasan/report.c:409\n\t__asan_report_load1_noabort+0x19/0x20 mm/kasan/report.c:427\n\tusbhid_parse+0x9b1/0xa20 drivers/hid/usbhid/hid-core.c:1004\n\thid_add_device+0x16b/0xb30 drivers/hid/hid-core.c:2944\n\tusbhid_probe+0xc28/0x1100 drivers/hid/usbhid/hid-core.c:1369\n\tusb_probe_interface+0x35d/0x8e0 drivers/usb/core/driver.c:361\n\treally_probe drivers/base/dd.c:413\n\tdriver_probe_device+0x610/0xa00 drivers/base/dd.c:557\n\t__device_attach_driver+0x230/0x290 drivers/base/dd.c:653\n\tbus_for_each_drv+0x161/0x210 drivers/base/bus.c:463\n\t__device_attach+0x26e/0x3d0 drivers/base/dd.c:710\n\tdevice_initial_probe+0x1f/0x30 drivers/base/dd.c:757\n\tbus_probe_device+0x1eb/0x290 drivers/base/bus.c:523\n\tdevice_add+0xd0b/0x1660 drivers/base/core.c:1835\n\tusb_set_configuration+0x104e/0x1870 drivers/usb/core/message.c:1932\n\tgeneric_probe+0x73/0xe0 drivers/usb/core/generic.c:174\n\tusb_probe_device+0xaf/0xe0 drivers/usb/core/driver.c:266\n\treally_probe drivers/base/dd.c:413\n\tdriver_probe_device+0x610/0xa00 drivers/base/dd.c:557\n\t__device_attach_driver+0x230/0x290 drivers/base/dd.c:653\n\tbus_for_each_drv+0x161/0x210 drivers/base/bus.c:463\n\t__device_attach+0x26e/0x3d0 drivers/base/dd.c:710\n\tdevice_initial_probe+0x1f/0x30 drivers/base/dd.c:757\n\tbus_probe_device+0x1eb/0x290 drivers/base/bus.c:523\n\tdevice_add+0xd0b/0x1660 drivers/base/core.c:1835\n\tusb_new_device+0x7b8/0x1020 drivers/usb/core/hub.c:2457\n\thub_port_connect drivers/usb/core/hub.c:4903\n\thub_port_connect_change drivers/usb/core/hub.c:5009\n\tport_event drivers/usb/core/hub.c:5115\n\thub_event+0x194d/0x3740 drivers/usb/core/hub.c:5195\n\tprocess_one_work+0xc7f/0x1db0 kernel/workqueue.c:2119\n\tworker_thread+0x221/0x1850 kernel/workqueue.c:2253\n\tkthread+0x3a1/0x470 kernel/kthread.c:231\n\tret_from_fork+0x2a/0x40 arch/x86/entry/entry_64.S:431\n\nCc: stable@vger.kernel.org\nReported-by: Andrey Konovalov <andreyknvl@google.com>\nSigned-off-by: Jaejoong Kim <climbbb.kim@gmail.com>\nTested-by: Andrey Konovalov <andreyknvl@google.com>\nAcked-by: Alan Stern <stern@rowland.harvard.edu>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "type_of_change": "Modification",
    "filename_of_changes": "hid-core.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1003: \tfor (n = 0; n < hdesc->bNumDescriptors; n++)"
    ]
}
