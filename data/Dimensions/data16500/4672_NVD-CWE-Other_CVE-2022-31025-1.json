{
    "cve_id": "CVE-2022-31025",
    "cve_description": "Discourse is an open source platform for community discussion. Prior to version 2.8.4 on the `stable` branch and 2.9.0beta5 on the `beta` and `tests-passed` branches, inviting users on sites that use single sign-on could bypass the `must_approve_users` check and invites by staff are always approved automatically. The issue is patched in Discourse version 2.8.4 on the `stable` branch and version `2.9.0.beta5` on the `beta` and `tests-passed` branches. As a workaround, disable invites or increase `min_trust_level_to_allow_invite` to reduce the attack surface to more trusted users.",
    "cve_publish_date": "2022-06-07",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "FIX: Approves user when redeeming an invite for invites only sites (#16984)\n\nWhen a site has `SiteSetting.invite_only` enabled, we create a\r\n`ReviewableUser`record when activating a user if the user is not\r\napproved. Therefore, we need to approve the user when redeeming an\r\ninvite.\r\n\r\nThere are some uncertainties surrounding why a `ReviewableRecord` is\r\ncreated for a user in an invites only site but this commit does not seek\r\nto address that.\r\n\r\nFollow-up to 7c4e2d33fa4b922354c177ffc880a2f2701a91f9",
    "type_of_change": "Modification",
    "filename_of_changes": "invite_redeemer.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 43:     if SiteSetting.must_approve_users? && EmailValidator.can_auto_approve_user?(user.email)",
        "// Line_Reference 82:       user.email_tokens.create!(email: user.email, scope: EmailToken.scopes[:signup])"
    ]
}
