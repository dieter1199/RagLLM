{
    "cve_id": "CVE-2022-24754",
    "cve_description": "PJSIP is a free and open source multimedia communication library written in C language. In versions prior to and including 2.12 PJSIP there is a stack-buffer overflow vulnerability which only impacts PJSIP users who accept hashed digest credentials (credentials with data_type `PJSIP_CRED_DATA_DIGEST`). This issue has been patched in the master branch of the PJSIP repository and will be included with the next release. Users unable to upgrade need to check that the hashed digest data length must be equal to `PJSIP_MD5STRLEN` before passing to PJSIP.",
    "cve_publish_date": "2022-03-11",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "Use PJ_ASSERT_RETURN() on pjsip_auth_create_digest() and pjsua_init_tpselector() (#3009)\n\n* Use PJ_ASSERT_RETURN on pjsip_auth_create_digest\r\n\r\n* Use PJ_ASSERT_RETURN on pjsua_init_tpselector()\r\n\r\n* Fix incorrect check.\r\n\r\n* Add return value to pjsip_auth_create_digest() and pjsip_auth_create_digestSHA256()\r\n\r\n* Modification based on comments.",
    "type_of_change": "Modification",
    "filename_of_changes": "sip_auth_client.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "42",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 163: PJ_DEF(void) pjsip_auth_create_digest( pj_str_t *result,",
        "// Line_Reference 164: \t\t\t\t       const pj_str_t *nonce,",
        "// Line_Reference 165: \t\t\t\t       const pj_str_t *nc,",
        "// Line_Reference 166: \t\t\t\t       const pj_str_t *cnonce,",
        "// Line_Reference 167: \t\t\t\t       const pj_str_t *qop,",
        "// Line_Reference 168: \t\t\t\t       const pj_str_t *uri,",
        "// Line_Reference 169: \t\t\t\t       const pj_str_t *realm,",
        "// Line_Reference 170: \t\t\t\t       const pjsip_cred_info *cred_info,",
        "// Line_Reference 171: \t\t\t\t       const pj_str_t *method)",
        "// Line_Reference 197: \tpj_assert(cred_info->data.slen == 32);",
        "// Line_Reference 255: PJ_DEF(void) pjsip_auth_create_digestSHA256(pj_str_t *result,",
        "// Line_Reference 294: \tpj_assert(cred_info->data.slen == 32);",
        "// Line_Reference 455: \t\tpjsip_auth_create_digestSHA256(",
        "// Line_Reference 460: \t\tpjsip_auth_create_digest( &cred->response, &cred->nonce, NULL,",
        "// Line_Reference 461: \t\t\t\t\t  NULL,  NULL, uri, &chal->realm,",
        "// Line_Reference 462: \t\t\t\t\t  cred_info, method);",
        "// Line_Reference 489: \t\tpjsip_auth_create_digestSHA256(",
        "// Line_Reference 496: \t\tpjsip_auth_create_digest( &cred->response, &cred->nonce,",
        "// Line_Reference 497: \t\t\t\t\t  &cred->nc, &cred->cnonce,",
        "// Line_Reference 498: \t\t\t\t\t  &pjsip_AUTH_STR, uri,",
        "// Line_Reference 499: \t\t\t\t\t  &chal->realm, cred_info,",
        "// Line_Reference 500: \t\t\t\t\t  method);",
        "// Line_Reference 511:     return PJ_SUCCESS;"
    ]
}
