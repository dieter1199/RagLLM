{
    "cve_id": "CVE-2022-2153",
    "cve_description": "A flaw was found in the Linux kernelâ€™s KVM when attempting to set a SynIC IRQ. This issue makes it possible for a misbehaving VMM to write to SYNIC/STIMER MSRs, causing a NULL pointer dereference. This flaw allows an unprivileged local attacker on the host to issue specific ioctl calls, causing a kernel oops condition that results in a denial of service.",
    "cve_publish_date": "2022-08-31",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "KVM: x86: Forbid VMM to set SYNIC/STIMER MSRs when SynIC wasn't activated\n\nSetting non-zero values to SYNIC/STIMER MSRs activates certain features,\nthis should not happen when KVM_CAP_HYPERV_SYNIC{,2} was not activated.\n\nNote, it would've been better to forbid writing anything to SYNIC/STIMER\nMSRs, including zeroes, however, at least QEMU tries clearing\nHV_X64_MSR_STIMER0_CONFIG without SynIC. HV_X64_MSR_EOM MSR is somewhat\n'special' as writing zero there triggers an action, this also should not\nhappen when SynIC wasn't activated.\n\nSigned-off-by: Vitaly Kuznetsov <vkuznets@redhat.com>\nMessage-Id: <20220325132140.25650-4-vkuznets@redhat.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "hyperv.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 242: \tif (!synic->active && !host)",
        "// Line_Reference 667: \tif (!synic->active && !host)",
        "// Line_Reference 696: \tif (!synic->active && !host)"
    ]
}
