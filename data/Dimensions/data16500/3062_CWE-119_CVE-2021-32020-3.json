{
    "cve_id": "CVE-2021-32020",
    "cve_description": "The kernel in Amazon Web Services FreeRTOS before 10.4.3 has insufficient bounds checking during management of heap memory.",
    "cve_publish_date": "2021-05-03",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Improve heap2 bounds checking (#224)\n\n* Improve heap bounds checking in pvPortMalloc",
    "type_of_change": "Modification",
    "filename_of_changes": "heap_4.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 139:             /* The wanted size is increased so it can contain a BlockLink_t",
        "// Line_Reference 141:             if( xWantedSize > 0 )",
        "// Line_Reference 145:                 /* Ensure that blocks are always aligned to the required number",
        "// Line_Reference 146:                  * of bytes. */",
        "// Line_Reference 149:                     /* Byte alignment required. */",
        "// Line_Reference 150:                     xWantedSize += ( portBYTE_ALIGNMENT - ( xWantedSize & portBYTE_ALIGNMENT_MASK ) );",
        "// Line_Reference 151:                     configASSERT( ( xWantedSize & portBYTE_ALIGNMENT_MASK ) == 0 );",
        "// Line_Reference 157:             }",
        "// Line_Reference 158:             else",
        "// Line_Reference 160:                 mtCOVERAGE_TEST_MARKER();",
        "// Line_Reference 166:                  * one\tof adequate size is found. */",
        "// Line_Reference 177:                  * was\tnot found. */"
    ]
}
