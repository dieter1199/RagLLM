{
    "cve_id": "CVE-2023-0337",
    "cve_description": "Cross-site Scripting (XSS) - Reflected in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-17",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed acct and hs management (#341)\n\n* Fixed bugs in some accounting related feature\r\n\r\n* Fixed hs management ui components",
    "type_of_change": "Modification",
    "filename_of_changes": "contactinfo.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "66",
    "vulnerable_lines": [
        "// Line_Reference 30: $input_descriptors1 = array();",
        "// Line_Reference 31: $input_descriptors1[] = array( \"name\" => \"ownername\", \"caption\" => t('ContactInfo','OwnerName'),",
        "// Line_Reference 32:                                \"type\" => \"text\", \"value\" => ((isset($owner)) ? $owner : \"\"), );",
        "// Line_Reference 33: $input_descriptors1[] = array( \"name\" => \"emailowner\", \"caption\" => t('ContactInfo','OwnerEmail'),",
        "// Line_Reference 34:                                \"type\" => \"text\", \"value\" => ((isset($email_owner)) ? $email_owner : \"\") , );",
        "// Line_Reference 35: $input_descriptors1[] = array( \"name\" => \"managername\", \"caption\" => t('ContactInfo','ManagerName'),",
        "// Line_Reference 36:                                \"type\" => \"text\", \"value\" => ((isset($manager)) ? $manager : \"\") , );",
        "// Line_Reference 37: $input_descriptors1[] = array( \"name\" => \"emailmanager\", \"caption\" => t('ContactInfo','ManagerEmail'),",
        "// Line_Reference 38:                                \"type\" => \"text\", \"value\" => ((isset($email_manager)) ? $email_manager : \"\") , );",
        "// Line_Reference 39: $input_descriptors1[] = array( \"name\" => \"company\", \"caption\" => t('ContactInfo','Company'),",
        "// Line_Reference 40:                                \"type\" => \"text\", \"value\" => ((isset($company)) ? $company : \"\") , );",
        "// Line_Reference 41: $input_descriptors1[] = array( \"name\" => \"address\", \"caption\" => t('ContactInfo','Address'),",
        "// Line_Reference 42:                                \"type\" => \"textarea\", \"content\" => ((isset($address)) ? $address : \"\"), );",
        "// Line_Reference 43: $input_descriptors1[] = array( \"name\" => \"phone1\", \"caption\" => t('ContactInfo','Phone1'),",
        "// Line_Reference 44:                                \"type\" => \"text\", \"value\" => ((isset($phone1)) ? $phone1 : \"\") , );",
        "// Line_Reference 45: $input_descriptors1[] = array( \"name\" => \"phone2\", \"caption\" => t('ContactInfo','Phone2'),",
        "// Line_Reference 46:                                \"type\" => \"text\", \"value\" => ((isset($phone2)) ? $phone2 : \"\") , );",
        "// Line_Reference 47: $input_descriptors1[] = array( \"name\" => \"hotspot_type\", \"caption\" => t('ContactInfo','HotspotType'),",
        "// Line_Reference 48:                                \"type\" => \"text\", \"value\" => ((isset($hotspot_type)) ? $hotspot_type : \"\") , );",
        "// Line_Reference 49: $input_descriptors1[] = array( \"name\" => \"companywebsite\", \"caption\" => t('ContactInfo','CompanyWebsite'),",
        "// Line_Reference 50:                                \"type\" => \"text\", \"value\" => ((isset($companywebsite)) ? $companywebsite : \"\") , );",
        "// Line_Reference 51: $input_descriptors1[] = array( \"name\" => \"companyemail\", \"caption\" => t('ContactInfo','CompanyEmail'),",
        "// Line_Reference 52:                                \"type\" => \"text\", \"value\" => ((isset($companyemail)) ? $companyemail : \"\") , );",
        "// Line_Reference 53: $input_descriptors1[] = array( \"name\" => \"companyphone\", \"caption\" => t('ContactInfo','CompanyPhone'),",
        "// Line_Reference 54:                                \"type\" => \"text\", \"value\" => ((isset($companyphone)) ? $companyphone : \"\") , );",
        "// Line_Reference 55: $input_descriptors1[] = array( \"name\" => \"companycontact\", \"caption\" => t('ContactInfo','CompanyContact'),",
        "// Line_Reference 56:                                \"type\" => \"text\", \"value\" => ((isset($companycontact)) ? $companycontact : \"\") , );",
        "// Line_Reference 58: $input_descriptors2 = array();",
        "// Line_Reference 59: $input_descriptors2[] = array( 'name' => 'creationdate', 'caption' => t('all','CreationDate'), 'type' => 'text',",
        "// Line_Reference 60:                                'disabled' => true, 'value' => ((isset($creationdate)) ? $creationdate : '') );",
        "// Line_Reference 61: $input_descriptors2[] = array( 'name' => 'creationby', 'caption' => t('all','CreationBy'), 'type' => 'text',",
        "// Line_Reference 62:                                'disabled' => true, 'value' => ((isset($creationby)) ? $creationby : '') );",
        "// Line_Reference 63: $input_descriptors2[] = array( 'name' => 'updatedate', 'caption' => t('all','UpdateDate'), 'type' => 'text',",
        "// Line_Reference 64:                                'disabled' => true, 'value' => ((isset($updatedate)) ? $updatedate : '') );",
        "// Line_Reference 65: $input_descriptors2[] = array( 'name' => 'updateby', 'caption' => t('all','UpdateBy'), 'type' => 'text',",
        "// Line_Reference 66:                                'disabled' => true, 'value' => ((isset($updateby)) ? $updateby : '') );",
        "// Line_Reference 68: $button_descriptor = array(",
        "// Line_Reference 69:                             \"type\" => \"submit\",",
        "// Line_Reference 70:                             \"name\" => \"submit\",",
        "// Line_Reference 71:                             \"value\" => t('buttons','apply')",
        "// Line_Reference 72:                           );",
        "// Line_Reference 74: ?>",
        "// Line_Reference 76: <fieldset>",
        "// Line_Reference 77:     <h302>Contact Info</h302>",
        "// Line_Reference 78:     <h301>Contact Info</h301>",
        "// Line_Reference 80:     <ul>",
        "// Line_Reference 81: <?php",
        "// Line_Reference 83:     foreach ($input_descriptors1 as $input_descriptor) {",
        "// Line_Reference 84:         print_form_component($input_descriptor);",
        "// Line_Reference 85:     }",
        "// Line_Reference 87: ?>",
        "// Line_Reference 88:     </ul>",
        "// Line_Reference 89: </fieldset>",
        "// Line_Reference 91: <fieldset>",
        "// Line_Reference 92:     <h302>Other</h302>",
        "// Line_Reference 93:     <h301>Other</h301>",
        "// Line_Reference 94:     <ul>",
        "// Line_Reference 95: <?php",
        "// Line_Reference 97:     foreach ($input_descriptors2 as $input_descriptor) {",
        "// Line_Reference 98:         print_form_component($input_descriptor);",
        "// Line_Reference 99:     }",
        "// Line_Reference 101: ?>",
        "// Line_Reference 102:     </ul>",
        "// Line_Reference 103: </fieldset>",
        "// Line_Reference 105: <?php",
        "// Line_Reference 106:     print_form_component($button_descriptor);"
    ]
}
