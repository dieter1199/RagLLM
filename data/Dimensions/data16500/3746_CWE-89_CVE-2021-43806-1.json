{
    "cve_id": "CVE-2021-43806",
    "cve_description": "Tuleap is a Libre and Open Source tool for end to end traceability of application and system developments. In affected versions Tuleap does not sanitize properly user settings when constructing the SQL query to browse and search commits in the CVS repositories. A authenticated malicious user with read access to a CVS repository could execute arbitrary SQL queries. Tuleap instances without an active CVS repositories are not impacted. The following versions contain the fix: Tuleap Community Edition 13.2.99.155, Tuleap Enterprise Edition 13.1-7, and Tuleap Enterprise Edition 13.2-6.",
    "cve_publish_date": "2021-12-15",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "request #24202: SQL injection via the user settings of the CVS commits browser\n\nChange-Id: I9dff1d45d703de5c9a55182d673a70c21ea53d89",
    "type_of_change": "Modification",
    "filename_of_changes": "commit_utils.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 716:     $repo_id        = $repo_id ? $repo_id : -1;",
        "// Line_Reference 721:     \"AND \" . (check_cvs_access(user_getname(), $project->getUnixName(false), '') ? 1 : 0) . \" \" .",
        "// Line_Reference 732:         $limit = \" LIMIT $offset,$chunksz\";"
    ]
}
