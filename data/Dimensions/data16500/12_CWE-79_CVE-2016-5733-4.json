{
    "cve_id": "CVE-2016-5733",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3 allow remote attackers to inject arbitrary web script or HTML via vectors involving (1) a crafted table name that is mishandled during privilege checking in table_row.phtml, (2) a crafted mysqld log_bin directive that is mishandled in log_selector.phtml, (3) the Transformation implementation, (4) AJAX error handling in js/ajax.js, (5) the Designer implementation, (6) the charts implementation in js/tbl_chart.js, or (7) the zoom-search implementation in rows_zoom.phtml.",
    "cve_publish_date": "2016-07-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Simplify and cleanup transformation plugins\n\nRemove PMA_transformation_global_html_replace which makes the code only\nmore confusing.\n\nAlso add escaping to browse transformations.\n\nSigned-off-by: Michal Čihař <michal@cihar.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "InlineTransformationsPlugin.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 52:             $transform_options = array(",
        "// Line_Reference 53:                 'string' => '<a href=\"transformation_wrapper.php'",
        "// Line_Reference 54:                     . $options['wrapper_link']",
        "// Line_Reference 55:                     . '\" target=\"_blank\"><img src=\"transformation_wrapper.php'",
        "// Line_Reference 56:                     . $options['wrapper_link'] . '&amp;resize=jpeg&amp;newWidth='",
        "// Line_Reference 57:                     . (isset($options[0]) ? $options[0] : '100') . '&amp;newHeight='",
        "// Line_Reference 58:                     . (isset($options[1]) ? $options[1] : 100)",
        "// Line_Reference 59:                     . '\" alt=\"[__BUFFER__]\" border=\"0\" /></a>',",
        "// Line_Reference 60:             );",
        "// Line_Reference 62:             $transform_options = array(",
        "// Line_Reference 63:                 'string' => '<img src=\"transformation_wrapper.php'",
        "// Line_Reference 64:                     . $options['wrapper_link']",
        "// Line_Reference 65:                     . '\" alt=\"[__BUFFER__]\" width=\"320\" height=\"240\" />',",
        "// Line_Reference 66:             );",
        "// Line_Reference 68: ",
        "// Line_Reference 69:         return PMA_Transformation_globalHtmlReplace(",
        "// Line_Reference 70:             $buffer,",
        "// Line_Reference 71:             $transform_options",
        "// Line_Reference 72:         );"
    ]
}
