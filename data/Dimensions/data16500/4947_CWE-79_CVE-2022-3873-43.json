{
    "cve_id": "CVE-2022-3873",
    "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository jgraph/drawio prior to 20.5.2.",
    "cve_publish_date": "2022-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.5.2 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Sidebar.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "77",
    "vulnerable_lines": [
        "// Line_Reference 1170: \t\t'portConstraint=eastwest;rotatable=0;' + fontSize);",
        "// Line_Reference 1206: \t\tthis.createVertexTemplateEntry('swimlane;', 200, 200, 'Vertical Container', 'Container', null, null, 'container swimlane lane pool group'),",
        "// Line_Reference 1207: \t\tthis.createVertexTemplateEntry('swimlane;horizontal=0;', 200, 200, 'Horizontal Container', 'Horizontal Container', null, null, 'container swimlane lane pool group'),",
        "// Line_Reference 1212: \t\t    \t'resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;');",
        "// Line_Reference 1352:  \t\tthis.addDataEntry('table', 280, 160, 'Table', '7Zpdc+IgFIZ/Te4D+JXLaj/2YvfGdvYeDRqmGDIEW+2vX5KAWjEWY7RNXGc6Q46Bwvtw8oYzemi0WD0JnER/eEiYhx48NBKcy6K1WI0IYx70aeihew9CX/158LHkW5B/6ydYkFi6dIBFhzfMlqSI3KUpkWkRTuWa6fA0oiz8jdd8mY0r8YQRczUUZLoUKX0jY5LSj6yDr6KpFPyVjDjjIh8CBYPJTM0QDWeUsZ34XX8UdGDWI8Ihf1fB7CY9MSIkWZUuLg/plT0RviBSrNUt7zSUkV7goBDAjwidR6ZbTwdxWgTmm75brVRDy3VYOmRppOafEKPOOFvJMOKCfvBYYrZRBQv5vKPSO10wHJNfBId7oSEP1zokeaJbjMykbk64lHyhL4ReXdYOBU9esJgTE5hyxnCS0gkz//YwMrJKcGymMVPTftaLs3nSOCKCSpvmLP+4AoTVACJ0Pr+OtfVfqFSrhT6wdz+PYzLNuR4V0FGjzY7HjM5jFZsqQYjYEx3o652Oj/nHVVz0pbgBOk1bPdg40yKe52KdOBpmaqExlmp3L+MwtYBt5unEsFvKELab4eqz4rsQOrUidRitXqS9UqT2A7eNSMGgbzNteJr2Lab/vfNi3rn+TPRLK4XnW+nA4vs3b17aSrdRK2OdFOxXM8gjilXIvL3R6s28oJTMZQ3yQmROtL3qoBxGqxcU8EtJXdb3LkvK2c0alFMA3LKdAXc7e7h7hPeoHjvrdR3tDJxvZ8Cuiphc7FwpF50UA1+XPw5mxxGJKuTa3mg15xoqRdFtAooTDas6GYfRaiZj108MmV6DyDgbVJOSxi6L3JBBfdN5K+g5GlQNpUtgF0lM7vWvlHv7ild7eSx2aqtLlMAufhhWg1awam8pEpTXNYI2oWtjyRHYlY8b8sBvOqQBU2+6xikNlldMTDHlh7yBBtVMrkFvnNAuiWxYXKsEfBaL9p7TzHPvEBr7kfhz0bTgoKYut7/sKW7f/eHPPw=='),",
        "// Line_Reference 1354:  \t\tthis.addDataEntry('table', 180, 140, 'Table', '7ZjJcuIwEIafxncvhOWKs8xhciGpuQu7sVVpq12yCHaefmQsJSHGwUAOmEpRVEmtBfX/qWlJThBm5YNkefpIMaAT3DlBKIlUU8rKEBAd3+WxE9w6vu/qr+Pfd7R621Y3ZxKE6jPAbwa8MlxDY2kMharQGKKUY/yXVbSuZ1RsiWBrcwnRWhb8FRZQ8Ld6gKutRcpi2pjKiiOGhCR1XZCAul1JegFrdPwgdOuPbjGrAamg7PRoazLuPABloGSlu2x4rFLTY9p47abAk9QOGxkjKxpD8j72QyBdMBrt1ys4rJf2Pger1KLWYZ6S5G8kFEOrkGJSPX1SbMMzZAL+AIu/mOYUV8akKDclhJUyxSUpRZmpSONuXY4l5c9MJmANESGyvOBLtD+7Hx+UORN2GSu97CfjXAfOXtD806CNJuczG7WY/dsWfddrb3YSAqItum812t3CRog92jDkidDVSAsBsq9YwUGxxkdqZSZb1L6JBOH42RhqBwRTekOuRVy0ALyvsxeTm04me/6ALplJuavgFSEadyIKBonI86+P0eQ3+5yTfapdRgeT0fj8ZDTtjKrRhUbV5LRk9I1WJ0TRl9l+NopmnUxuhsXkyGQ0IESe28loPEhGvbPRkCC1z9O/6ej4dDQLeqajH7gbee0HABtX7bPFZcSVd/j+P/Rjndd+ZrBUpgOjcr33I6/7XWE2TEhXcEPS1Y/H06b757fV/w=='),",
        "// Line_Reference 1356:  \t\tthis.addDataEntry('table', 180, 140, 'Table', '7ZhLc+IwDMc/Te55UB5X2G176F7ozt5NIhLPKlbGMSXpp1+H2H0Fl0DZGcL0wIys2I71/8XIlhct8upOsiL7RQmgF/30ooUkUq2VVwtA9EKfJ170wwtDX/+88NbxNNg99QsmQag+A8J2wBPDDbSe1lGqGo0jzjgmD6ymTTOjYisE25pLiDey5E+whJI/NwN87S0zltDWNNYccUFIUrcFCd1nbt4JUkHlXPfOZRZ9B5SDkrXusuWJykyPaRubnwFPMztsZJysbB3py9hXGbRhlNivSnRYFR1jAVaPZRPtPCPJn0kohlYHxaR6fKPLlufIBNwDSz645pTUxqWoMBbCWhlzRUpRbhrShNvYiaTiN5MpWEdMiKwo+Qrta/dDgqpgwi5jrZf9aIJzQCuVpL9gnVxkILnqCzM8DeZo8nWWow7LPzsz9IPup05CQLxD+ql2Li32yMaQp0I3Y60FyL56RQf1Gh8pl5ls2YQnUoTjZ2OoAxBM6W91I5Kyw+Blnb2w3Dix7PkHunAs1XsRr4jS2EkpGiqlILw+TJPv9PQ/0lP9nt3BbDX+eraaOjfc6HI33OS0bPWJXCdssA+znXeDzZxYbgaH5chsNSBKge/ENB4qpt7pakicuifv73x1vnw1i3rmqzPcroJuAcFuue6h5GK2XHC4uDD0I2HQrWFYMNPhgbneG1bgrk/MBsvpCu5YuvlahW27vy3S/gM='),",
        "// Line_Reference 1358: \t \tthis.createVertexTemplateEntry('text;html=1;strokeColor=none;fillColor=none;overflow=fill;', 160, 140,",
        "// Line_Reference 1401: \t \tthis.createVertexTemplateEntry('shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;', 20, 120, '', 'Left Curly Bracket'),",
        "// Line_Reference 1402: \t\tthis.createVertexTemplateEntry('shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;', 20, 120, '', 'Right Curly Bracket'),",
        "// Line_Reference 1432: \t \tthis.createEdgeTemplateEntry('shape=filledEdge;rounded=0;fixDash=1;endArrow=none;strokeWidth=10;fillColor=#ffffff;edgeStyle=orthogonalEdgeStyle;', 60, 40, '', 'Filled Edge'),",
        "// Line_Reference 1476: \tvar field = new mxCell('List Item', new mxGeometry(0, 0, 60, 26), 'text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;');",
        "// Line_Reference 1504: \t\tthis.addEntry('process bar', function()",
        "// Line_Reference 1505: \t\t{",
        "// Line_Reference 1506: \t\t\treturn sb.createVertexTemplateFromData('zZXRaoMwFIafJpcDjbNrb2233rRQ8AkyPdPQaCRJV+3T7yTG2rUVBoOtgpDzn/xJzncCIdGyateKNeVW5iBI9EqipZLS9KOqXYIQhAY8J9GKUBrgT+jbRDZ02aBhCmrzEwPtDZ9MHKBXdkpmoDWKCVN9VptO+Kw+8kqwGqMkK7nIN6yTB7uTNizbD1FSSsVPsjYMC1qFKHxwIZZSSIVxLZ1/nJNar5+oQPMT7IYCrqUta1ENzuqGaeOFTArBGs3f3Vmtoo2Se7ja1h00kSoHK4bBIKUNy3hdoPYU0mF91i9mT8EEL2ocZ3gKa00ayWujLZY4IfHKFonVDLsRGgXuQ90zBmWgneyTk3yT1iArMKrDKUeem9L3ajHrbSXwohxsQd/ggOleKM7ese048J2/fwuim1uQGmhQCW8vQMkacP3GCQgBFMftHEsr7cYYe95CnmKTPMFbYD8CQ++DGQy+/M5X4ku5wHYmdIktfvk9tecpavThqS3m/0YtnqIWPTy1cD77K2wYjo+Ay317I74A', 296, 100, 'Process Bar');",
        "// Line_Reference 1507: \t\t}),",
        "// Line_Reference 1508: \t \tthis.createVertexTemplateEntry('swimlane;', 200, 200, 'Container', 'Container', null, null, 'container swimlane lane pool group'),",
        "// Line_Reference 1509: \t\tthis.addEntry('list group erd table', function()",
        "// Line_Reference 1510: \t\t{",
        "// Line_Reference 1511: \t\t\tvar cell = new mxCell('List', new mxGeometry(0, 0, 140, 110),",
        "// Line_Reference 1512: \t\t    \t'swimlane;fontStyle=0;childLayout=stackLayout;horizontal=1;startSize=26;fillColor=none;horizontalStack=0;' +",
        "// Line_Reference 1513: \t\t    \t'resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;');",
        "// Line_Reference 1514: \t\t\tcell.vertex = true;",
        "// Line_Reference 1515: \t\t\tcell.insert(sb.cloneCell(field, 'Item 1'));",
        "// Line_Reference 1516: \t\t\tcell.insert(sb.cloneCell(field, 'Item 2'));",
        "// Line_Reference 1517: \t\t\tcell.insert(sb.cloneCell(field, 'Item 3'));",
        "// Line_Reference 1518: ",
        "// Line_Reference 1519: \t\t\treturn sb.createVertexTemplateFromCells([cell], cell.geometry.width, cell.geometry.height, 'List');",
        "// Line_Reference 1520: \t\t}),",
        "// Line_Reference 1521: \t\tthis.addEntry('list item entry value group erd table', function()",
        "// Line_Reference 1522: \t\t{",
        "// Line_Reference 1523: \t\t\treturn sb.createVertexTemplateFromCells([sb.cloneCell(field, 'List Item')], field.geometry.width, field.geometry.height, 'List Item');",
        "// Line_Reference 1524: \t\t})",
        "// Line_Reference 1525: \t];",
        "// Line_Reference 1526: };",
        "// Line_Reference 1527: ",
        "// Line_Reference 1528: /**",
        "// Line_Reference 1529:  * Adds the container palette to the sidebar.",
        "// Line_Reference 1530:  */",
        "// Line_Reference 1531: Sidebar.prototype.createAdvancedShapes = function()",
        "// Line_Reference 1532: {",
        "// Line_Reference 1533: \t// Avoids having to bind all functions to \"this\"",
        "// Line_Reference 1534: \tvar sb = this;",
        "// Line_Reference 1536: \t// Reusable cells",
        "// Line_Reference 1537: \tvar field = new mxCell('List Item', new mxGeometry(0, 0, 60, 26), 'text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;');",
        "// Line_Reference 1538: \tfield.vertex = true;",
        "// Line_Reference 1539: ",
        "// Line_Reference 1540: \treturn [",
        "// Line_Reference 1541: \t \tthis.createVertexTemplateEntry('shape=tapeData;whiteSpace=wrap;html=1;perimeter=ellipsePerimeter;', 80, 80, '', 'Tape Data'),",
        "// Line_Reference 1542: \t \tthis.createVertexTemplateEntry('shape=manualInput;whiteSpace=wrap;html=1;', 80, 80, '', 'Manual Input'),",
        "// Line_Reference 1543: \t \tthis.createVertexTemplateEntry('shape=loopLimit;whiteSpace=wrap;html=1;', 100, 80, '', 'Loop Limit'),",
        "// Line_Reference 1544: \t \tthis.createVertexTemplateEntry('shape=offPageConnector;whiteSpace=wrap;html=1;', 80, 80, '', 'Off Page Connector'),",
        "// Line_Reference 1545: \t \tthis.createVertexTemplateEntry('shape=delay;whiteSpace=wrap;html=1;', 80, 40, '', 'Delay'),",
        "// Line_Reference 1546: \t \tthis.createVertexTemplateEntry('shape=display;whiteSpace=wrap;html=1;', 80, 40, '', 'Display'),",
        "// Line_Reference 1547: \t \tthis.createVertexTemplateEntry('shape=singleArrow;direction=west;whiteSpace=wrap;html=1;', 100, 60, '', 'Arrow Left'),",
        "// Line_Reference 1548: \t \tthis.createVertexTemplateEntry('shape=singleArrow;whiteSpace=wrap;html=1;', 100, 60, '', 'Arrow Right'),",
        "// Line_Reference 1549: \t \tthis.createVertexTemplateEntry('shape=singleArrow;direction=north;whiteSpace=wrap;html=1;', 60, 100, '', 'Arrow Up'),",
        "// Line_Reference 1550: \t \tthis.createVertexTemplateEntry('shape=singleArrow;direction=south;whiteSpace=wrap;html=1;', 60, 100, '', 'Arrow Down'),",
        "// Line_Reference 1551: \t \tthis.createVertexTemplateEntry('shape=doubleArrow;whiteSpace=wrap;html=1;', 100, 60, '', 'Double Arrow'),",
        "// Line_Reference 1552: \t \tthis.createVertexTemplateEntry('shape=doubleArrow;direction=south;whiteSpace=wrap;html=1;', 60, 100, '', 'Double Arrow Vertical', null, null, 'double arrow'),",
        "// Line_Reference 1553: \t \tthis.createVertexTemplateEntry('shape=actor;whiteSpace=wrap;html=1;', 40, 60, '', 'User', null, null, 'user person human'),",
        "// Line_Reference 1554: \t \tthis.createVertexTemplateEntry('shape=cross;whiteSpace=wrap;html=1;', 80, 80, '', 'Cross'),",
        "// Line_Reference 1555: \t \tthis.createVertexTemplateEntry('shape=corner;whiteSpace=wrap;html=1;', 80, 80, '', 'Corner'),",
        "// Line_Reference 1556: \t \tthis.createVertexTemplateEntry('shape=tee;whiteSpace=wrap;html=1;', 80, 80, '', 'Tee'),",
        "// Line_Reference 1557: \t \tthis.createVertexTemplateEntry('shape=datastore;whiteSpace=wrap;html=1;', 60, 60, '', 'Data Store', null, null, 'data store cylinder database'),",
        "// Line_Reference 1558: \t \tthis.createVertexTemplateEntry('shape=orEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;backgroundOutline=1;', 80, 80, '', 'Or', null, null, 'or circle oval ellipse'),",
        "// Line_Reference 1559: \t \tthis.createVertexTemplateEntry('shape=sumEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;backgroundOutline=1;', 80, 80, '', 'Sum', null, null, 'sum circle oval ellipse'),",
        "// Line_Reference 1560: \t \tthis.createVertexTemplateEntry('shape=lineEllipse;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;backgroundOutline=1;', 80, 80, '', 'Ellipse with horizontal divider', null, null, 'circle oval ellipse'),",
        "// Line_Reference 1561: \t \tthis.createVertexTemplateEntry('shape=lineEllipse;line=vertical;perimeter=ellipsePerimeter;whiteSpace=wrap;html=1;backgroundOutline=1;', 80, 80, '', 'Ellipse with vertical divider', null, null, 'circle oval ellipse'),",
        "// Line_Reference 1562: \t \tthis.createVertexTemplateEntry('shape=sortShape;perimeter=rhombusPerimeter;whiteSpace=wrap;html=1;', 80, 80, '', 'Sort', null, null, 'sort'),",
        "// Line_Reference 1563: \t \tthis.createVertexTemplateEntry('shape=collate;whiteSpace=wrap;html=1;', 80, 80, '', 'Collate', null, null, 'collate'),",
        "// Line_Reference 1564: \t \tthis.createVertexTemplateEntry('shape=switch;whiteSpace=wrap;html=1;', 60, 60, '', 'Switch', null, null, 'switch router'),",
        "// Line_Reference 1567: \t\t\treturn sb.createVertexTemplateFromData('zZXRaoMwFIafJpcDjbNrb2233rRQ8AkyPdPQaCRJV+3T7yTG2rUVBoOtgpDzn/xJzncCIdGyateKNeVW5iBI9EqipZLS9KOqXYIQhAY8J9GKUBrgT+jbRDZ02aBhCmrzEwPtDZ9MHKBXdkpmoDWKCVN9VptO+Kw+8kqwGqMkK7nIN6yTB7uTNizbD1FSSsVPsjYMC1qFKHxwIZZSSIVxLZ1/nJNar5+oQPMT7IYCrqUta1ENzuqGaeOFTArBGs3f3Vmtoo2Se7ja1h00kSoHK4bBIKUNy3hdoPYU0mF91i9mT8EEL2ocZ3gKa00ayWujLZY4IfHKFonVDLsRGgXuQ90zBmWgneyTk3yT1iArMKrDKUeem9L3ajHrbSXwohxsQd/ggOleKM7ese048J2/fwuim1uQGmhQCW8vQMkacP3GCQgBFMftHEsr7cYYe95CnmKTPMFbYD8CQ++DGQy+/M5X4ku5wHYmdIktfvk9tecpavThqS3m/0YtnqIWPTy1cD77K2wYjo+Ay317I74A', 296, 100, 'Process Bar');",
        "// Line_Reference 1574: \t\t    \t'resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;');",
        "// Line_Reference 3681: Sidebar.prototype.createEdgeTemplateFromCells = function(cells, width, height, title, showLabel, allowCellsInserted, showTooltip, showTitle)",
        "// Line_Reference 3682: {",
        "// Line_Reference 3683: \treturn this.createItem(cells, title, showLabel, (showTitle != null) ? showTitle : true, width, height, allowCellsInserted, showTooltip);"
    ]
}
