auto secret_name = request_id_to_secret_name.find(e->content.request_id);
if (secret_name != request_id_to_secret_name.end()) {
nhlog::crypto()->info("Received secret: {}", secret_name->second);
if (deviceKeys) {
for (auto &[dev, key] : deviceKeys->device_keys) {
if (key.keys["curve25519:" + dev] == msg.sender_key) {
sender_device_id = dev;
break;
}
[name = secret_name->second](mtx::http::RequestErr err) {
name);
nhlog::crypto()->info("Storing secret {}", secret_name->second);
cache::client()->storeSecret(secret_name->second, e->content.secret);
request_id_to_secret_name.erase(secret_name);
