DrawBC(""._scheduling." > " . ProgramTitle());
DrawHeaderHome('<div class="panel"><div class="panel-heading"><h6 class="panel-title">'._selectedStudent.' ' . $RET[1]['FIRST_NAME'] . '&nbsp;' . ($RET[1]['MIDDLE_NAME'] ? $RET[1]['MIDDLE_NAME'] . ' ' : '') . $RET[1]['LAST_NAME'] . '&nbsp;' . $RET[1]['NAME_SUFFIX'] . '</h6> <div class="heading-elements clearfix"><span class="heading-text"> <A HREF=Modules.php?modname=' . $_REQUEST['modname'] . '&search_modfunc=list&next_modname=students/Student.php&ajax=true&bottom_back=true&return_session=true target=body><i class="icon-square-left"></i>'._selectedStudent.'</A></span> <div class="btn-group heading-btn"><A HREF=Side.php?student_id=new&modcat=' . $_REQUEST['modcat'] . ' class="btn btn-danger btn-xs">'._deselect.'</A></div></div></div></div>');
DrawHeaderHome('<div class="panel"><div class="panel-heading"><h6 class="panel-title">'._selectedStudent.' ' . $RET[1]['FIRST_NAME'] . '&nbsp;' . ($RET[1]['MIDDLE_NAME'] ? $RET[1]['MIDDLE_NAME'] . ' ' : '') . $RET[1]['LAST_NAME'] . '&nbsp;' . $RET[1]['NAME_SUFFIX'] . '</h6> <div class="heading-elements clearfix"><div class="btn-group heading-btn"> <A HREF=Side.php?student_id=new&modcat=' . $_REQUEST['modcat'] . ' class="btn btn-danger btn-xs">'._deselect.'</A></div></div></div></div>');
echo "<FORM name=modify class=no-padding id=modify action=Modules.php?modname=" . strip_tags(trim($_REQUEST[modname])) . " &modfunc=modify METHOD=POST>";
echo '<div class="panel panel-default">';
DrawHeader('<div class="form-inline"><div class="input-group">' . PrepareDateSchedule($date, '_date', false, array('submit' => true)) . '<span class="input-group-btn"><INPUT type=submit class="btn btn-primary" value='._go.'></span></div><div class="form-group"><label class="control-label">&nbsp;</label><div class="checkbox"><label><INPUT type=checkbox name=include_inactive value=Y' . ($_REQUEST['include_inactive'] == 'Y' ? " CHECKED onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=\";'" : " onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=Y\";'") . '> '._includeInactiveCourses.'</label></div></div></div>', '<div class="form-inline"><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._markingPeriod.'</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">'._calendarView.'</span>' . $view_mode . '</div></div>');
DrawHeader('<div class="form-inline"><div class="input-group">' . PrepareDateSchedule($date, '_date', false, array('submit' => true)) . '<span class="input-group-btn"><INPUT type=submit class="btn btn-primary" value='._go.'></span></div></div>', '<div class="form-inline"><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._markingPeriod.' :</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">'._calendarView.'</span>' . $view_mode . '</div></div>');
s.COURSE_ID,
s.COURSE_PERIOD_ID,
s.MARKING_PERIOD_ID,
s.START_DATE,
s.END_DATE,
UNIX_TIMESTAMP(s.START_DATE) AS START_EPOCH,
UNIX_TIMESTAMP(s.END_DATE) AS END_EPOCH,
sp.PERIOD_ID,CONCAT(sp.START_TIME,\'' . ' - ' . '\',sp.END_TIME) AS TIME_PERIOD,
cpv.PERIOD_ID,
cp.MARKING_PERIOD_ID as COURSE_MARKING_PERIOD_ID,
cp.MP,
sp.SORT_ORDER,
c.TITLE,
cp.COURSE_PERIOD_ID AS PERIOD_PULLDOWN,
s.STUDENT_ID,
r.TITLE AS ROOM,
cpv.DAYS,
SCHEDULER_LOCK
FROM schedule s,courses c,course_periods cp,school_periods sp,course_period_var cpv,rooms r
WHERE s.COURSE_ID = c.COURSE_ID
AND cp.COURSE_PERIOD_ID=cpv.COURSE_PERIOD_ID
AND r.ROOM_ID=cpv.ROOM_ID
AND s.COURSE_ID = cp.COURSE_ID
AND s.COURSE_PERIOD_ID = cp.COURSE_PERIOD_ID
AND s.SCHOOL_ID = sp.SCHOOL_ID
AND s.SYEAR = c.SYEAR
AND sp.PERIOD_ID = cpv.PERIOD_ID
AND (cp.MARKING_PERIOD_ID IN (' . implode(',', $mp_ids_arr) . ') OR (cp.MARKING_PERIOD_ID IS NULL AND cp.BEGIN_DATE<=\'' . date('Y-m-d', strtotime($date)) . '\' AND cp.END_DATE>=\'' . date('Y-m-d', strtotime($date)) . '\'))
AND POSITION(\'' . $day . '\' IN cpv.days)>0
AND s.STUDENT_ID=\'' . UserStudentID() . '\'
AND s.SYEAR=\'' . UserSyear() . '\'
AND s.SCHOOL_ID = \'' . UserSchool() . '\'
AND (cpv.COURSE_PERIOD_DATE=\'' . date('Y-m-d', strtotime($date)) . '\' OR cpv.COURSE_PERIOD_DATE IS NULL)
AND (\'' . date('Y-m-d', strtotime($date)) . '\' BETWEEN cp.BEGIN_DATE AND cp.END_DATE) ';
$columns = array('TIME_PERIOD' => _period,
'TITLE' => _course,
'PERIOD_PULLDOWN' => _periodTeacher,
'ROOM' => _room,
'DAYS' => _daysOfWeek,
'COURSE_MARKING_PERIOD_ID' => _term,
'START_DATE' => _enrolled,
'END_DATE' => _endDateDropDate,
'SCHEDULE_ID' => _moreInfo,
$columns = array('TIME_PERIOD' => _period,
'TITLE' => _course,
'PERIOD_PULLDOWN' => _periodTeacher,
'ROOM' => _room,
'DAYS' => _daysOfWeek,
'COURSE_MARKING_PERIOD_ID' => _term,
DrawHeader($week_range, '<div class="form-inline"><label class="control-label">&nbsp;</label><div class="checkbox"><label><INPUT type=checkbox name=include_inactive value=Y' . ($_REQUEST['include_inactive'] == 'Y' ? " CHECKED onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=\";'" : " onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=Y\";'") . '> '._includeInactiveCourses.'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label></div><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._includeInactiveCourses.':</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">Calendar View :</span>' . $view_mode . '</div></div>');
DrawHeader($week_range, '<div class="form-inline"><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._markingPeriod.':</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">'._markingPeriod.':</span>' . $view_mode . '</div></div>');
$mp_start_date=DBGET(DBQuery('SELECT start_date FROM marking_periods WHERE MARKING_PERIOD_ID = '.$_REQUEST['marking_period_id']));
$sql_week='SELECT acc.SCHOOL_DATE,cp.TITLE,cp.COURSE_PERIOD_ID,cp.TEACHER_ID,cpv.PERIOD_ID
$sql_custom_schedule='SELECT cp.COURSE_PERIOD_ID FROM course_periods cp,schedule s WHERE cp.MARKING_PERIOD_ID IS NULL AND cp.MARKING_PERIOD_ID IS NULL AND cp.BEGIN_DATE<=\'' . date('Y-m-d', strtotime($date)) . '\' AND cp.END_DATE>=\'' . date('Y-m-d', strtotime($date)) . '\' AND cp.COURSE_PERIOD_ID=s.COURSE_PERIOD_ID ';
if (in_array(date('Y-m-d', $j), $week_RET[date('Y-m-d', $j)][$course['PERIOD_ID']][1])) {
(cpv.COURSE_PERIOD_DATE=\'' . date('Y-m-d', $j) . '\' OR cpv.COURSE_PERIOD_DATE IS NULL) AND sch.START_DATE<=  \'' . date('Y-m-d', $j) . '\' AND (sch.END_DATE>=\'' . date('Y-m-d', $j) . '\' OR sch.END_DATE IS NULL) AND \'' . date('Y-m-d', $j) . '\' BETWEEN mp.START_DATE AND mp.END_DATE AND  cpv.PERIOD_ID =\'' . $course[PERIOD_ID] . '\'  AND r.ROOM_ID=cpv.ROOM_ID AND sch.STUDENT_ID=\'' . UserStudentID() . '\' AND POSITION(\'' . get_db_day($day) . '\' IN cpv.days)>0'));
if (count($custom_schedule) > 0 && count($custom_schedule_cpid) > 0)
(cpv.COURSE_PERIOD_DATE=\'' . date('Y-m-d', $j) . '\' OR cpv.COURSE_PERIOD_DATE IS NULL) AND cpv.PERIOD_ID =\'' . $course[PERIOD_ID] . '\'  AND r.ROOM_ID=cpv.ROOM_ID AND POSITION(\'' . get_db_day($day) . '\' IN cpv.days)>0 AND cp.COURSE_PERIOD_ID IN (' . $custom_schedule_cpid . ')'));
if (count($day_RET_custom) > 0)
DrawHeader($month_str, '<div class="form-inline"><label class="control-label">&nbsp;</label><div class="checkbox"><label><INPUT type=checkbox name=include_inactive value=Y' . ($_REQUEST['include_inactive'] == 'Y' ? " CHECKED onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=\";'" : " onclick='document.location.href=\"" . PreparePHP_SELF($tmp_REQUEST) . "&include_inactive=Y\";'") . '> '._includeInactiveCourses.' &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label></div><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._includeInactiveCourses.'</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">'._includeInactiveCourses.'</span>' . $view_mode . '</div></div>');
DrawHeader($month_str, '<div class="form-inline"><div class="input-group"><span class="input-group-addon" id="marking_period_id">'._markingPeriod.'</span>' . $mp . '</div><div class="input-group"><span class="input-group-addon" id="view_mode">'._markingPeriod.'</span>' . $view_mode . '</div></div>');
echo '<div class="table-responsive">';
echo "<TABLE class=\"table table-bordered\" style=\"table-layout: fixed;\"><thead><TR align=center>";
echo "<TD style=\"width: 14.25%;\">"._monday."</TD><TD style=\"width: 14.25%;\">"._tuesday."</TD><TD style=\"width: 14.25%;\">"._wednesday."</TD><TD style=\"width: 14.25%;\">"._thursday."</TD><TD style=\"width: 14.25%;\">"._friday."</TD><TD style=\"width: 14.25%;\">"._saturday."</TD><TD style=\"width: 14.25%;\">"._sunday."</TD>";
echo "<ul class=\"list list-square mt-10 no-margin-bottom\">";
$cp_link['START_TIME'] = date("g:i A", strtotime($cp_link[START_TIME]));
echo "<li><a class=\"text-primary\" HREF=# title=Details onclick='javascript:window.open(\"ForWindow.php?modname=$_REQUEST[modname]&modfunc=detail&date=$date&marking_period_id=$_REQUEST[marking_period_id]&period=$cp_link[PERIOD_ID]\",\"blank\",\"width=600,height=450,scrollbars=1\"); return false;'>" . $cp_link[START_TIME] . ' - ' . $cp_link[TITLE] . "<a></li>";
echo '</ul>';
echo '<div class="text-muted mt-10">'._scheduleNotAvailable.'</div>';
echo '<font class=text-danger>'._holiday.'</font>';
AND sp.PERIOD_ID=\'' . $_REQUEST[period] . '\'
}
$columns = array('TIME_PERIOD' => _period,
'TITLE' => _course,
'PERIOD_PULLDOWN' => _periodTeacher,
'ROOM' => _room,
'DAYS' => _daysOfWeek,
'COURSE_MARKING_PERIOD_ID' => _term,
'START_DATE' => _enrolled,
'END_DATE' => _endDateDropDate,
$columns = array('TIME_PERIOD' => _period,
'TITLE' => _course,
'PERIOD_PULLDOWN' => _periodTeacher,
'ROOM' => _room,
'DAYS' => _daysOfWeek,
'COURSE_MARKING_PERIOD_ID' => _term,
echo '<div class="panel-body"><input type="button" class="btn btn-default pull-right" value="'._close.'" onclick="window.close();"></div>';
echo ProgramLinkforExport('scheduling/PrintSchedules.php', '<b><i class="icon-printer4"></i></b>'._printSchedule.'', '&modfunc=save&st_arr[]=' . UserStudentID() . '&mp_id=' . $mp_id . '&include_inactive=' . $_REQUEST['include_inactive'] . '&date1=' . $date1 . '&_openSIS_PDF=true', 'target="_blank" class="btn btn-success btn-labeled"') . '</div>';
echo '<h5 class="modal-title">'._moreInfo.'</h5>';
$sql = 'SELECT cp.COURSE_PERIOD_ID,cp.PARENT_ID,cp.TITLE,cp.MARKING_PERIOD_ID,COALESCE(cp.TOTAL_SEATS-cp.FILLED_SEATS,0) AS AVAILABLE_SEATS FROM course_periods cp,school_periods sp,course_period_var cpv WHERE sp.PERIOD_ID=cpv.PERIOD_ID AND cp.COURSE_PERIOD_ID=cpv.COURSE_PERIOD_ID AND cp.COURSE_ID=\'' . $THIS_RET[COURSE_ID] . '\' ORDER BY sp.SORT_ORDER';
if ($column == 'END_DATE' && $THIS_RET[END_DATE] != '') {
return '<div style="white-space: nowrap;">' . DateInputAY($value != "" ? $value : "", "schedule[$THIS_RET[COURSE_PERIOD_ID]][$THIS_RET[START_DATE]][$column]", $counter . $THIS_RET[COURSE_PERIOD_ID], '', true, $allow_na) . '</div>';
return '<div style="white-space: nowrap;">' . DateInputAY($value != "" ? $value : "", "schedule[$THIS_RET[COURSE_PERIOD_ID]][$THIS_RET[START_DATE]][$column]", $counter . $THIS_RET[COURSE_PERIOD_ID], '', true, $allow_na) . '</div>';
if ($column == 'END_DATE' && $THIS_RET[END_DATE] != '') {
$html .= '<option value="day_view" ' . ($_REQUEST['view_mode'] == 'day_view' ? 'selected' : '') . ' >'._day.'</option>';
$html .= '<option value="week_view" ' . ($_REQUEST['view_mode'] == 'week_view' ? 'selected' : '') . '>'._week.'</option>';
$html .= '<option value="month_view" ' . ($_REQUEST['view_mode'] == 'month_view' ? 'selected' : '') . '>'._month.'</option>';
$html .= "<a href='javascript:void(0);' class=\"text-primary\" title=Previous onClick=\"window.location='" . $link . $prev . "';\"><i class=\"fa fa-angle-left\"></i> "._prev."</a> &nbsp; &nbsp; <span>" . properDate($_REQUEST[week_range]) . "&nbsp; - &nbsp;" . properDate($upper) . "</span> &nbsp; &nbsp; <a href='javascript:void(0);' title=Next onClick=\"window.location='" . $link . $next . "';\" class=\"text-primary\">"._prev." <i class=\"fa fa-angle-right\"></i></a>";
