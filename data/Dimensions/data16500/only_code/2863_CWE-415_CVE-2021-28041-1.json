/* $OpenBSD: ssh-agent.c,v 1.276 2021/02/02 22:35:14 djm Exp $ */
char *ext_name = NULL;
struct sshbuf *b = NULL;
goto err;
goto err;
goto err;
goto err;
goto err;
goto err;
goto err;
goto err;
if ((r = sshbuf_get_cstring(m, &ext_name, NULL)) != 0) {
error_fr(r, "parse constraint extension");
goto err;
}
debug_f("constraint ext %s", ext_name);
if (strcmp(ext_name, "sk-provider@openssh.com") == 0) {
if (sk_providerp == NULL) {
error_f("%s not valid here", ext_name);
goto err;
}
if (*sk_providerp != NULL) {
error_f("%s already set", ext_name);
goto err;
}
if ((r = sshbuf_get_cstring(m,
sk_providerp, NULL)) != 0) {
error_fr(r, "parse %s", ext_name);
goto err;
}
} else {
error_f("unsupported constraint \"%s\"",
ext_name);
goto err;
}
free(ext_name);
err:
free(ext_name);
sshbuf_free(b);
return -1;
return 0;