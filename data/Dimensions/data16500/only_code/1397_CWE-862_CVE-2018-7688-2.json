r.state = hash.delete('state') { raise ArgumentError, 'no state' }
r.state = r.state.to_sym