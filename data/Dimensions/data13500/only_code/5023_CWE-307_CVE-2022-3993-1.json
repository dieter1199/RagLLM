if (user == null) return Unauthorized("Invalid username");
return Unauthorized(result.IsNotAllowed ? "You must confirm your email first" : "Your credentials are not correct.");
return BadRequest("The email does not match the registered email");
if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest("Invalid Email Token");
return BadRequest("Invalid Email Token");
if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest("Invalid Email Token");
return BadRequest("Invalid Details");
if (!result) return BadRequest("Unable to reset password, your email token is not correct.");
if (user == null) return BadRequest("This email is not on system");
if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest("Invalid Email Token");
