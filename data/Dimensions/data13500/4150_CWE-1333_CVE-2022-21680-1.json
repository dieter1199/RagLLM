{
    "cve_id": "CVE-2022-21680",
    "cve_description": "Marked is a markdown parser and compiler. Prior to version 4.0.10, the regular expression `block.def` may cause catastrophic backtracking against some strings and lead to a regular expression denial of service (ReDoS). Anyone who runs untrusted markdown through a vulnerable version of marked and does not use a worker with a time limit may be affected. This issue is patched in version 4.0.10. As a workaround, avoid running untrusted markdown through marked or run marked on a worker thread and set a reasonable time limit to prevent draining resources.",
    "cve_publish_date": "2022-01-14",
    "cwe_id": "CWE-1333",
    "cwe_name": "Inefficient Regular Expression Complexity",
    "cwe_description": "The product uses a regular expression with an inefficient, possibly exponential worst-case computational complexity that consumes excessive CPU cycles.",
    "commit_message": "Merge pull request from GHSA-rrrm-qjm4-v8hf\n\n* fix: fix reflink redos\n\nCo-authored-by: MakeNowJust <make.just.on@gmail.com>\n\n* fix: fix def redos\n\nCo-authored-by: MakeNowJust <make.just.on@gmail.com>\n\n* fix block label for multiple slashes\n\nCo-authored-by: MakeNowJust <make.just.on@gmail.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "rules.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 28:   def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,",
        "// Line_Reference 37: block._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;",
        "// Line_Reference 165:   reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,",
        "// Line_Reference 166:   nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,"
    ]
}
