{
    "cve_id": "CVE-2021-28280",
    "cve_description": "CSRF + Cross-site scripting (XSS) vulnerability in search.php in PHPFusion 9.03.110 allows remote attackers to inject arbitrary web script or HTML",
    "cve_publish_date": "2021-04-29",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Fixes broken rendering trying to parse against <script> input values.",
    "type_of_change": "Modification",
    "filename_of_changes": "Search_Engine.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "44",
    "number_of_lines_deleted_vulnerable_to_cve": "44",
    "vulnerable_lines": [
        "// Line_Reference 24:     protected static $search_instance = NULL;",
        "// Line_Reference 38: ",
        "// Line_Reference 42:     public static $locale = [];",
        "// Line_Reference 43: ",
        "// Line_Reference 44:     /**",
        "// Line_Reference 45:      * Returns params",
        "// Line_Reference 46:      *",
        "// Line_Reference 47:      * @param null $key",
        "// Line_Reference 48:      *",
        "// Line_Reference 49:      * @return array|string",
        "// Line_Reference 50:      */",
        "// Line_Reference 51:     public static function get_param($key = NULL) {",
        "// Line_Reference 52:         $info = [",
        "// Line_Reference 53:             'stype'        => self::$search_type,",
        "// Line_Reference 54:             'stext'        => self::$search_text,",
        "// Line_Reference 55:             'method'       => self::$search_method,",
        "// Line_Reference 56:             'datelimit'    => self::$search_date_limit,",
        "// Line_Reference 57:             'fields'       => self::$search_fields,",
        "// Line_Reference 58:             'sort'         => self::$search_sort,",
        "// Line_Reference 59:             'chars'        => self::$search_chars,",
        "// Line_Reference 60:             'order'        => self::$search_order,",
        "// Line_Reference 61:             'forum_id'     => self::$forum_id,",
        "// Line_Reference 62:             'memory_limit' => self::$memory_limit,",
        "// Line_Reference 63:             'composevars'  => self::$composevars,",
        "// Line_Reference 64:             'rowstart'     => self::$rowstart,",
        "// Line_Reference 65:             'search_param' => self::$search_param,",
        "// Line_Reference 66:         ];",
        "// Line_Reference 68:         return $key === NULL ? $info : (isset($info[$key]) ? $info[$key] : NULL);",
        "// Line_Reference 85:     protected function __construct() {",
        "// Line_Reference 86:         parent::__construct();",
        "// Line_Reference 87:         self::$locale = fusion_get_locale('', LOCALE.LOCALESET.'search.php');",
        "// Line_Reference 88:     }",
        "// Line_Reference 89: ",
        "// Line_Reference 336:                 $qualified_search_text[] = $search_text[$i];",
        "// Line_Reference 480: ",
        "// Line_Reference 481:     /**",
        "// Line_Reference 482:      * Load the search driver file",
        "// Line_Reference 483:      * - Prevents string mutation",
        "// Line_Reference 484:      *",
        "// Line_Reference 485:      * @param $path",
        "// Line_Reference 486:      */",
        "// Line_Reference 487:     protected static function __Load($path) {",
        "// Line_Reference 488:         include_once($path);",
        "// Line_Reference 489:     }"
    ]
}
