{
    "cve_id": "CVE-2020-28896",
    "cve_description": "Mutt before 2.0.2 and NeoMutt before 2020-11-20 did not ensure that $ssl_force_tls was processed if an IMAP server's initial server response was invalid. The connection was not properly closed, and the code could continue attempting to authenticate. This could result in authentication credentials being exposed on an unencrypted connection, or to a machine-in-the-middle.",
    "cve_publish_date": "2020-11-23",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "imap: close connection on all failures\n\nThanks to Gabriel Salles-Loustau for spotting the problem.\n\nCo-authored-by: Kevin McCarthy <kevin@8t8.us>",
    "type_of_change": "Modification",
    "filename_of_changes": "imap.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 764:         goto err_close_conn;",
        "// Line_Reference 779:             goto err_close_conn;",
        "// Line_Reference 794:       goto err_close_conn;",
        "// Line_Reference 810:       goto err_close_conn;",
        "// Line_Reference 827: #ifdef USE_SSL",
        "// Line_Reference 828: err_close_conn:",
        "// Line_Reference 829:   imap_close_connection(adata);",
        "// Line_Reference 830: #endif"
    ]
}
