{
    "cve_id": "CVE-2021-29061",
    "cve_description": "A Regular Expression Denial of Service (ReDOS) vulnerability was discovered in Vfsjfilechooser2 version 0.2.9 and below which occurs when the application attempts to validate crafted URIs.",
    "cve_publish_date": "2021-06-21",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "incorporated Yeting Li's fix for Potential Regex Denial of Service (ReDoS), see https://github.com/fracpete/vfsjfilechooser2/issues/7\npasswords can now also contain special characters (eg :), which have to be URL encoded (ie %3A)",
    "type_of_change": "Modification",
    "filename_of_changes": "VFSURIValidator.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "95",
    "number_of_lines_deleted_vulnerable_to_cve": "73",
    "vulnerable_lines": [
        "// Line_Reference 236: \t\t\t\t.compile(\"(ftp|FTP|sftp|SFTP|http|HTTP|https|HTTPS|webdav|WEBDAV|smb|SMB)://(.+:.+@)*([^:]+?/*)([ \t]*:[0-9]+)*([ \t]*:)*(/.*)\");",
        "// Line_Reference 240: \t\t\t\t.compile(\"(ftp|FTP|sftp|SFTP|http|HTTP|https|HTTPS|webdav|WEBDAV|smb|SMB)://(.+:.+@)*([^:]+)([ \t]*:[0-9]+)*([ \t]*:)*(/*?.*)\");",
        "// Line_Reference 826: \t\ts = \"ftp://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 833: \t\tv.assertEquals(v.getPassword(), \"pass:\");",
        "// Line_Reference 838: \t\ts = \"ftp://user:pass:@machine/the_dir/\";",
        "// Line_Reference 845: \t\tv.assertEquals(v.getPassword(), \"pass:\");",
        "// Line_Reference 995: \t\ts = \"FTP://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1007: \t\ts = \"FTP://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1164: \t\ts = \"sftp://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1176: \t\ts = \"sftp://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1188: \t\ts = \"sftp: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 1200: \t\ts = \"sftp:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 1212: \t\ts = \"sftp:/ /user:pass:@machine\";",
        "// Line_Reference 1224: \t\ts = \"sftp://user:pass:@:123/a\";",
        "// Line_Reference 1236: \t\ts = \"sftp://user:pass:@machine:a/the_file\";",
        "// Line_Reference 1332: \t\ts = \"SFTP://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1344: \t\ts = \"SFTP://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1501: \t\ts = \"http://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1513: \t\ts = \"http://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1525: \t\ts = \"http: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 1537: \t\ts = \"http:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 1549: \t\ts = \"http:/ /user:pass:@machine\";",
        "// Line_Reference 1561: \t\ts = \"http://user:pass:@:123/a\";",
        "// Line_Reference 1573: \t\ts = \"http://user:pass:@machine:a/the_file\";",
        "// Line_Reference 1669: \t\ts = \"HTTP://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1681: \t\ts = \"HTTP://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1693: \t\ts = \"HTTP: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 1705: \t\ts = \"HTTP:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 1717: \t\ts = \"HTTP:/ /user:pass:@machine\";",
        "// Line_Reference 1729: \t\ts = \"HTTP://user:pass:@:123/a\";",
        "// Line_Reference 1741: \t\ts = \"HTTP://user:pass:@machine:a/the_file\";",
        "// Line_Reference 1838: \t\ts = \"https://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 1850: \t\ts = \"https://user:pass:@machine/the_dir/\";",
        "// Line_Reference 1862: \t\ts = \"https: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 1874: \t\ts = \"https:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 1886: \t\ts = \"https:/ /user:pass:@machine\";",
        "// Line_Reference 1898: \t\ts = \"https://user:pass:@:123/a\";",
        "// Line_Reference 1910: \t\ts = \"https://user:pass:@machine:a/the_file\";",
        "// Line_Reference 2006: \t\ts = \"HTTPS://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 2018: \t\ts = \"HTTPS://user:pass:@machine/the_dir/\";",
        "// Line_Reference 2030: \t\ts = \"HTTPS: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 2042: \t\ts = \"HTTPS:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 2054: \t\ts = \"HTTPS:/ /user:pass:@machine\";",
        "// Line_Reference 2066: \t\ts = \"HTTPS://user:pass:@:123/a\";",
        "// Line_Reference 2078: \t\ts = \"HTTPS://user:pass:@machine:a/the_file\";",
        "// Line_Reference 2175: \t\ts = \"webdav://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 2187: \t\ts = \"webdav://user:pass:@machine/the_dir/\";",
        "// Line_Reference 2193: \t\ts = \"webdav: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 2205: \t\ts = \"webdav:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 2217: \t\ts = \"webdav:/ /user:pass:@machine\";",
        "// Line_Reference 2229: \t\ts = \"webdav://user:pass:@:123/a\";",
        "// Line_Reference 2241: \t\ts = \"webdav://user:pass:@machine:a/the_file\";",
        "// Line_Reference 2337: \t\ts = \"WEBDAV://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 2349: \t\ts = \"WEBDAV://user:pass:@machine/the_dir/\";",
        "// Line_Reference 2361: \t\ts = \"WEBDAV: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 2373: \t\ts = \"WEBDAV:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 2385: \t\ts = \"WEBDAV:/ /user:pass:@machine\";",
        "// Line_Reference 2397: \t\ts = \"WEBDAV://user:pass:@:123/a\";",
        "// Line_Reference 2409: \t\ts = \"WEBDAV://user:pass:@machine:a/the_file\";",
        "// Line_Reference 2506: \t\ts = \"smb://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 2518: \t\ts = \"smb://user:pass:@machine/the_dir/\";",
        "// Line_Reference 2530: \t\ts = \"smb: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 2542: \t\ts = \"smb:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 2554: \t\ts = \"smb:/ /user:pass:@machine\";",
        "// Line_Reference 2566: \t\ts = \"smb://user:pass:@:123/a\";",
        "// Line_Reference 2578: \t\ts = \"smb://user:pass:@machine:a/the_file\";",
        "// Line_Reference 2674: \t\ts = \"SMB://user:pass:@machine/the_file\"; //can \":\" be part of a password?",
        "// Line_Reference 2686: \t\ts = \"SMB://user:pass:@machine/the_dir/\";",
        "// Line_Reference 2698: \t\ts = \"SMB: //user:pass:@machine/the_file\"; //failure tests",
        "// Line_Reference 2710: \t\ts = \"SMB:/ /user:pass:@machine/the_file\";",
        "// Line_Reference 2722: \t\ts = \"SMB:/ /user:pass:@machine\";",
        "// Line_Reference 2734: \t\ts = \"SMB://user:pass:@:123/a\";",
        "// Line_Reference 2746: \t\ts = \"SMB://user:pass:@machine:a/the_file\";"
    ]
}
