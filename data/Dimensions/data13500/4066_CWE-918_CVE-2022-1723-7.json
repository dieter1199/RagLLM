{
    "cve_id": "CVE-2022-1723",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository jgraph/drawio prior to 18.0.6.",
    "cve_publish_date": "2022-05-17",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "18.0.6 release",
    "type_of_change": "Modification",
    "filename_of_changes": "viewer.min.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 112: window.STYLE_PATH=window.STYLE_PATH||\"styles\";window.CSS_PATH=window.CSS_PATH||\"styles\";window.OPEN_FORM=window.OPEN_FORM||\"open.html\";window.mxBasePath=window.mxBasePath||\"mxgraph\";window.mxImageBasePath=window.mxImageBasePath||\"mxgraph/images\";window.mxLanguage=window.mxLanguage||urlParams.lang;window.mxLanguages=window.mxLanguages||[\"de\",\"se\"];var mxClient={VERSION:\"18.0.5\",IS_IE:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"MSIE\"),IS_IE11:null!=navigator.userAgent&&!!navigator.userAgent.match(/Trident\\/7\\./),IS_EDGE:null!=navigator.userAgent&&!!navigator.userAgent.match(/Edge\\//),IS_EM:\"spellcheck\"in document.createElement(\"textarea\")&&8==document.documentMode,VML_PREFIX:\"v\",OFFICE_PREFIX:\"o\",IS_NS:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"Mozilla/\")&&0>navigator.userAgent.indexOf(\"MSIE\")&&0>navigator.userAgent.indexOf(\"Edge/\"),",
        "// Line_Reference 2296: Graph.sanitizeHtml=function(b,e){return DOMPurify.sanitize(b,{ADD_ATTR:[\"target\"],FORBID_TAGS:[\"form\"],ALLOWED_URI_REGEXP:/^(?:(?:https?|mailto|tel|callto|data):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i})};Graph.sanitizeSvg=function(b){return DOMPurify.sanitize(b,{IN_PLACE:!0})};",
        "// Line_Reference 2297: Graph.clipSvgDataUri=function(b,e){if(!mxClient.IS_IE&&!mxClient.IS_IE11&&null!=b&&\"data:image/svg+xml;base64,\"==b.substring(0,26))try{var k=document.createElement(\"div\");k.style.position=\"absolute\";k.style.visibility=\"hidden\";var n=decodeURIComponent(escape(atob(b.substring(26)))),D=n.indexOf(\"<svg\");if(0<=D){k.innerHTML=n.substring(D);Graph.sanitizeSvg(k);var t=k.getElementsByTagName(\"svg\");if(0<t.length){if(e||null!=t[0].getAttribute(\"preserveAspectRatio\")){document.body.appendChild(k);try{n=e=",
        "// Line_Reference 2298: 1;var F=t[0].getAttribute(\"width\"),d=t[0].getAttribute(\"height\");F=null!=F&&\"%\"!=F.charAt(F.length-1)?parseFloat(F):NaN;d=null!=d&&\"%\"!=d.charAt(d.length-1)?parseFloat(d):NaN;var f=t[0].getAttribute(\"viewBox\");if(null!=f&&!isNaN(F)&&!isNaN(d)){var g=f.split(\" \");4<=f.length&&(e=parseFloat(g[2])/F,n=parseFloat(g[3])/d)}var m=t[0].getBBox();0<m.width&&0<m.height&&(k.getElementsByTagName(\"svg\")[0].setAttribute(\"viewBox\",m.x+\" \"+m.y+\" \"+m.width+\" \"+m.height),k.getElementsByTagName(\"svg\")[0].setAttribute(\"width\",",
        "// Line_Reference 2326: Graph.prototype.openLink=function(b,e,k){var n=window;try{if(\"_self\"==e&&window!=window.top)window.location.href=b;else if(b.substring(0,this.baseUrl.length)==this.baseUrl&&\"#\"==b.charAt(this.baseUrl.length)&&\"_top\"==e&&window==window.top){var D=b.split(\"#\")[1];window.location.hash==\"#\"+D&&(window.location.hash=\"\");window.location.hash=D}else n=window.open(b,null!=e?e:\"_blank\"),null==n||k||(n.opener=null)}catch(t){}return n};",
        "// Line_Reference 2647: null);mxEvent.consume(ca)})))}if(null!=L)for(M=0;M<L.length;M++){var T=document.createElement(\"div\");T.style.marginTop=null!=z||0<M?\"6px\":\"0px\";T.appendChild(this.graph.createLinkForHint(L[M].getAttribute(\"href\"),mxUtils.getTextContent(L[M])));this.linkHint.appendChild(T)}}}catch(ca){}};mxEdgeHandler.prototype.updateLinkHint=mxVertexHandler.prototype.updateLinkHint;var Ca=mxEdgeHandler.prototype.init;mxEdgeHandler.prototype.init=function(){Ca.apply(this,arguments);this.constraintHandler.isEnabled=",
        "// Line_Reference 2648: mxUtils.bind(this,function(){return this.state.view.graph.connectionHandler.isEnabled()});var z=mxUtils.bind(this,function(){null!=this.linkHint&&(this.linkHint.style.display=1==this.graph.getSelectionCount()?\"\":\"none\");null!=this.labelShape&&(this.labelShape.node.style.display=this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells?\"\":\"none\")});this.changeHandler=mxUtils.bind(this,function(T,ca){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell),this.graph.getLinksForState(this.state));",
        "// Line_Reference 2649: z();this.redrawHandles()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.changeHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);var L=this.graph.getLinkForCell(this.state.cell),M=this.graph.getLinksForState(this.state);if(null!=L||null!=M&&0<M.length)this.updateLinkHint(L,M),this.redrawHandles()};var Qa=mxConnectionHandler.prototype.init;mxConnectionHandler.prototype.init=function(){Qa.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,",
        "// Line_Reference 2650: function(){return this.graph.connectionHandler.isEnabled()})};var Ta=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){if(null!=this.moveHandles)for(var z=0;z<this.moveHandles.length;z++)this.moveHandles[z].style.left=this.moveHandles[z].rowState.x+this.moveHandles[z].rowState.width-5+\"px\",this.moveHandles[z].style.top=this.moveHandles[z].rowState.y+this.moveHandles[z].rowState.height/2-6+\"px\";if(null!=this.cornerHandles){z=this.getSelectionBorderInset();var L=",
        "// Line_Reference 2651: this.cornerHandles,M=L[0].bounds.height/2;L[0].bounds.x=this.state.x-L[0].bounds.width/2+z;L[0].bounds.y=this.state.y-M+z;L[0].redraw();L[1].bounds.x=L[0].bounds.x+this.state.width-2*z;L[1].bounds.y=L[0].bounds.y;L[1].redraw();L[2].bounds.x=L[0].bounds.x;L[2].bounds.y=this.state.y+this.state.height-2*z;L[2].redraw();L[3].bounds.x=L[1].bounds.x;L[3].bounds.y=L[2].bounds.y;L[3].redraw();for(z=0;z<this.cornerHandles.length;z++)this.cornerHandles[z].node.style.display=1==this.graph.getSelectionCount()?",
        "// Line_Reference 3348: (function(){var b=new mxObjectCodec(new ChangeGridColor,[\"ui\"]);b.beforeDecode=function(e,k,n){n.ui=e.ui;return k};mxCodecRegistry.register(b)})();(function(){EditorUi.VERSION=\"18.0.5\";EditorUi.compactUi=\"atlas\"!=uiTheme;Editor.isDarkMode()&&(mxGraphView.prototype.gridColor=mxGraphView.prototype.defaultDarkGridColor);EditorUi.enableLogging=\"1\"!=urlParams.stealth&&\"1\"!=urlParams.lockdown&&(/.*\\.draw\\.io$/.test(window.location.hostname)||/.*\\.diagrams\\.net$/.test(window.location.hostname))&&\"support.draw.io\"!=window.location.hostname;EditorUi.drawHost=window.DRAWIO_BASE_URL;EditorUi.lightboxHost=window.DRAWIO_LIGHTBOX_URL;EditorUi.lastErrorMessage="
    ]
}
