{
    "cve_id": "CVE-2021-41086",
    "cve_description": "jsuites is an open source collection of common required javascript web components. In affected versions users are subject to cross site scripting (XSS) attacks via clipboard content. jsuites is vulnerable to DOM based XSS if the user can be tricked into copying _anything_ from a malicious and pasting it into the html editor. This is because a part of the clipboard content is directly written to `innerHTML` allowing for javascript injection and thus XSS. Users are advised to update to version 4.9.11 to resolve.",
    "cve_publish_date": "2021-09-21",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Editor sanitize parser updates.",
    "type_of_change": "Modification",
    "filename_of_changes": "jsuites.layout.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "46",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 1704:                     if (state === null || state == 1) {",
        "// Line_Reference 1719:     obj.select = function(o) {",
        "// Line_Reference 1720:         var menu = el.querySelectorAll('nav a');",
        "// Line_Reference 1721:         for (var i = 0; i < menu.length; i++) {",
        "// Line_Reference 1722:             menu[i].classList.remove('selected');",
        "// Line_Reference 1723:         }",
        "// Line_Reference 1724:         o.classList.add('selected');",
        "// Line_Reference 1725: ",
        "// Line_Reference 1726:         // Better navigation",
        "// Line_Reference 1727:         if (options && options.collapse == true) {",
        "// Line_Reference 1728:             if (o.classList.contains('show')) {",
        "// Line_Reference 1729:                 menu = el.querySelectorAll('nav');",
        "// Line_Reference 1730:                 for (var i = 0; i < menu.length; i++) {",
        "// Line_Reference 1731:                     menu[i].style.display = '';",
        "// Line_Reference 1732:                 }",
        "// Line_Reference 1733:                 o.style.display = 'none';",
        "// Line_Reference 1734:             } else {",
        "// Line_Reference 1735:                 menu = el.querySelectorAll('nav');",
        "// Line_Reference 1736:                 for (var i = 0; i < menu.length; i++) {",
        "// Line_Reference 1737:                     menu[i].style.display = 'none';",
        "// Line_Reference 1738:                 }",
        "// Line_Reference 1740:                 menu = el.querySelector('.show');",
        "// Line_Reference 1741:                 if (menu) {",
        "// Line_Reference 1742:                     menu.style.display = 'block';",
        "// Line_Reference 1743:                 }",
        "// Line_Reference 1745:                 menu = jSuites.findElement(o.parentNode, 'selected');",
        "// Line_Reference 1746:                 if (menu) {",
        "// Line_Reference 1747:                     menu.style.display = '';",
        "// Line_Reference 1754:             setTimeout(function() {",
        "// Line_Reference 1755:                 obj.hide();",
        "// Line_Reference 1756:             }, 0);",
        "// Line_Reference 1760:     var actionDown = function(e) {",
        "// Line_Reference 1771:             obj.select(e.target);",
        "// Line_Reference 1776:         el.addEventListener('touchstart', actionDown);",
        "// Line_Reference 1778:         el.addEventListener('mousedown', actionDown);"
    ]
}
