{
    "cve_id": "CVE-2019-12816",
    "cve_description": "Modules.cpp in ZNC before 1.7.4-rc1 allows remote authenticated non-admin users to escalate privileges and execute arbitrary code by loading a module with a crafted name.",
    "cve_publish_date": "2019-06-15",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Fix remote code execution and privilege escalation vulnerability.\n\nTo trigger this, need to have a user already.\n\nThanks for Jeriko One <jeriko.one@gmx.us> for finding and reporting this.\n\nCVE-2019-12816",
    "type_of_change": "Modification",
    "filename_of_changes": "Modules.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 1914:     for (unsigned int a = 0; a < sModule.length(); a++) {",
        "// Line_Reference 1915:         if (((sModule[a] < '0') || (sModule[a] > '9')) &&",
        "// Line_Reference 1916:             ((sModule[a] < 'a') || (sModule[a] > 'z')) &&",
        "// Line_Reference 1917:             ((sModule[a] < 'A') || (sModule[a] > 'Z')) && (sModule[a] != '_')) {",
        "// Line_Reference 1918:             sRetMsg =",
        "// Line_Reference 1919:                 t_f(\"Module names can only contain letters, numbers and \"",
        "// Line_Reference 1920:                     \"underscores, [{1}] is invalid\")(sModule);",
        "// Line_Reference 1921:             return nullptr;",
        "// Line_Reference 1922:         }"
    ]
}
