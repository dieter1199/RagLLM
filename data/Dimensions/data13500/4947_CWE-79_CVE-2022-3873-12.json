{
    "cve_id": "CVE-2022-3873",
    "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository jgraph/drawio prior to 20.5.2.",
    "cve_publish_date": "2022-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.5.2 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Menus.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "87",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 1500: \t\tthis.addMenuItems(menu, ['delete', '-', 'cut', 'copy', '-', 'duplicate'], null, evt);",
        "// Line_Reference 1509: \tif (this.editorUi.editor.graph.getSelectionCount() == 1)",
        "// Line_Reference 1510: \t{",
        "// Line_Reference 1511: \t\tthis.addMenuItems(menu, ['-', 'setAsDefaultStyle'], null, evt);",
        "// Line_Reference 1512: \t}",
        "// Line_Reference 1513: \telse if (this.editorUi.editor.graph.isSelectionEmpty())",
        "// Line_Reference 1515: \t\tthis.addMenuItems(menu, ['-', 'clearDefaultStyle'], null, evt);",
        "// Line_Reference 1524: \tvar graph = this.editorUi.editor.graph;",
        "// Line_Reference 1525: ",
        "// Line_Reference 1526: \tif (graph.getEditableCells(graph.getSelectionCells()).length > 0)",
        "// Line_Reference 1528: \t\tthis.addMenuItems(menu, ['-', 'toFront', 'toBack'], null, evt);",
        "// Line_Reference 1530: \t\tif (graph.getSelectionCount() == 1)",
        "// Line_Reference 1532: \t\t\tthis.addMenuItems(menu, ['bringForward', 'sendBackward'], null, evt);",
        "// Line_Reference 1534: \t}",
        "// Line_Reference 1536: \tif (graph.getSelectionCount() > 1)",
        "// Line_Reference 1537: \t{",
        "// Line_Reference 1538: \t\tthis.addMenuItems(menu, ['-', 'group'], null, evt);",
        "// Line_Reference 1539: \t}",
        "// Line_Reference 1540: \telse if (graph.getSelectionCount() == 1 && !graph.getModel().isEdge(cell) &&",
        "// Line_Reference 1541: \t\t!graph.isSwimlane(cell) && graph.getModel().getChildCount(cell) > 0 &&",
        "// Line_Reference 1542: \t\tgraph.isCellEditable(cell))",
        "// Line_Reference 1543: \t{",
        "// Line_Reference 1544: \t\tthis.addMenuItems(menu, ['-', 'ungroup'], null, evt);",
        "// Line_Reference 1561: \t\tif (graph.getSelectionCount() == 1 && graph.getModel().isEdge(cell))",
        "// Line_Reference 1594: \t\t\tthis.addMenuItem(menu, 'turn', null, evt, null, mxResources.get('reverse'));",
        "// Line_Reference 1602: \t\tif (graph.getSelectionCount() == 1 && (hasWaypoints || (graph.getModel().isVertex(cell) &&",
        "// Line_Reference 1620: \tvar graph = this.editorUi.editor.graph;",
        "// Line_Reference 1621: \tvar state = graph.view.getState(cell);",
        "// Line_Reference 1622: \tthis.addMenuItems(menu, ['-', 'editStyle', 'editData', 'editLink'], parent, evt);",
        "// Line_Reference 1623: ",
        "// Line_Reference 1624: \t// Shows edit image action if there is an image in the style",
        "// Line_Reference 1625: \tif (graph.getModel().isVertex(cell) && mxUtils.getValue(state.style, mxConstants.STYLE_IMAGE, null) != null)",
        "// Line_Reference 1627: \t\tmenu.addSeparator();",
        "// Line_Reference 1628: \t\tthis.addMenuItem(menu, 'image', parent, evt).firstChild.nextSibling.innerHTML = mxResources.get('editImage') + '...';",
        "// Line_Reference 1629: \t\tthis.addMenuItem(menu, 'crop', parent, evt);",
        "// Line_Reference 1630: \t}",
        "// Line_Reference 1632: \tif ((graph.getModel().isVertex(cell) && graph.getModel().getChildCount(cell) == 0)",
        "// Line_Reference 1633: \t\t\t|| graph.isContainer(cell)) //Allow vertex only excluding group (but allowing container [e.g, swimlanes])",
        "// Line_Reference 1634: \t{",
        "// Line_Reference 1635: \t\tthis.addMenuItem(menu, 'editConnectionPoints', parent, evt);",
        "// Line_Reference 1638: "
    ]
}
