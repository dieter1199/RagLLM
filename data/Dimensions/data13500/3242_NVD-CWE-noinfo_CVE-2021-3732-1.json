{
    "cve_id": "CVE-2021-3732",
    "cve_description": "A flaw was found in the Linux kernel's OverlayFS subsystem in the way the user mounts the TmpFS filesystem with OverlayFS. This flaw allows a local user to gain access to hidden files that should not be accessible.",
    "cve_publish_date": "2022-03-10",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "ovl: prevent private clone if bind mount is not allowed\n\nAdd the following checks from __do_loopback() to clone_private_mount() as\nwell:\n\n - verify that the mount is in the current namespace\n\n - verify that there are no locked children\n\nReported-by: Alois Wohlschlager <alois1@gmx-topmail.de>\nFixes: c771d683a62e (\"vfs: introduce clone_private_mount()\")\nCc: <stable@vger.kernel.org> # v3.18\nSigned-off-by: Miklos Szeredi <mszeredi@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "namespace.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 1957: \t\treturn ERR_PTR(-EINVAL);",
        "// Line_Reference 2318: static bool has_locked_children(struct mount *mnt, struct dentry *dentry)",
        "// Line_Reference 2319: {",
        "// Line_Reference 2320: \tstruct mount *child;",
        "// Line_Reference 2321: \tlist_for_each_entry(child, &mnt->mnt_mounts, mnt_child) {",
        "// Line_Reference 2322: \t\tif (!is_subdir(child->mnt_mountpoint, dentry))",
        "// Line_Reference 2323: \t\t\tcontinue;",
        "// Line_Reference 2324: ",
        "// Line_Reference 2325: \t\tif (child->mnt.mnt_flags & MNT_LOCKED)",
        "// Line_Reference 2326: \t\t\treturn true;",
        "// Line_Reference 2327: \t}",
        "// Line_Reference 2328: \treturn false;",
        "// Line_Reference 2329: }",
        "// Line_Reference 2330: "
    ]
}
