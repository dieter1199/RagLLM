{
    "cve_id": "CVE-2021-3819",
    "cve_description": "firefly-iii is vulnerable to Cross-Site Request Forgery (CSRF)",
    "cve_publish_date": "2021-09-27",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Convert GET routes to POST.",
    "type_of_change": "Modification",
    "filename_of_changes": "CreateController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 34: use Illuminate\\Http\\RedirectResponse;",
        "// Line_Reference 35: use Illuminate\\Routing\\Redirector;",
        "// Line_Reference 52:             static function ($request, $next) {",
        "// Line_Reference 62:      * @param TransactionGroup $group",
        "// Line_Reference 64:      * @return RedirectResponse|Redirector",
        "// Line_Reference 66:     public function cloneGroup(TransactionGroup $group)",
        "// Line_Reference 69:         /** @var GroupCloneService $service */",
        "// Line_Reference 70:         $service  = app(GroupCloneService::class);",
        "// Line_Reference 71:         $newGroup = $service->cloneGroup($group);",
        "// Line_Reference 73:         // event!",
        "// Line_Reference 74:         event(new StoredTransactionGroup($newGroup));",
        "// Line_Reference 76:         app('preferences')->mark();",
        "// Line_Reference 78:         $title = $newGroup->title ?? $newGroup->transactionJournals->first()->description;",
        "// Line_Reference 79:         $link  = route('transactions.show', [$newGroup->id]);",
        "// Line_Reference 80:         session()->flash('success', trans('firefly.stored_journal', ['description' => $title]));",
        "// Line_Reference 81:         session()->flash('success_url', $link);",
        "// Line_Reference 83:         return redirect(route('transactions.show', [$newGroup->id]));"
    ]
}
