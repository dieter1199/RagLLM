{
    "cve_id": "CVE-2022-1514",
    "cve_description": "Stored XSS via upload plugin functionality in zip format in GitHub repository neorazorx/facturascripts prior to 2022.06. Cross-site scripting attacks can have devastating consequences. Code injected into a vulnerable application can exfiltrate data or install malware on the user's machine. Attackers can masquerade as authorized users via session cookies, allowing them to perform any action allowed by the user account.",
    "cve_publish_date": "2022-04-28",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Sanitized the data read from the ini file to avoid security problems.\n------\nSaneados los datos leÃ­dos del archivo ini para evitar problemas de seguridad.",
    "type_of_change": "Modification",
    "filename_of_changes": "PluginManager.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 383: ",
        "// Line_Reference 385:         if ($ini !== false) {",
        "// Line_Reference 386:             foreach (['name', 'version', 'description', 'min_version'] as $key) {",
        "// Line_Reference 387:                 $info[$key] = $ini[$key] ?? $info[$key];",
        "// Line_Reference 388:             }",
        "// Line_Reference 390:             if (isset($ini['require'])) {",
        "// Line_Reference 391:                 $info['require'] = explode(',', $ini['require']);",
        "// Line_Reference 392:             }",
        "// Line_Reference 394:             if ($info['min_version'] >= 2018 && $info['min_version'] <= self::CORE_VERSION) {",
        "// Line_Reference 395:                 $info['compatible'] = true;",
        "// Line_Reference 396:                 $info['description'] = ('Incompatible' === $info['description']) ? ToolBox::i18n()->trans('compatible') : $info['description'];",
        "// Line_Reference 397:             } else {",
        "// Line_Reference 398:                 $info['description'] = ToolBox::i18n()->trans('incompatible-with-facturascripts', ['%version%' => self::CORE_VERSION]);",
        "// Line_Reference 401:             $info['enabled'] = in_array($info['name'], $this->enabledPlugins());"
    ]
}
