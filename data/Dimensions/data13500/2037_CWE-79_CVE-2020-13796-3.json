{
    "cve_id": "CVE-2020-13796",
    "cve_description": "An issue was discovered in Navigate CMS through 2.8.7. It allows XSS because of a lack of purify calls in lib/packages/structure/structure.class.php.",
    "cve_publish_date": "2020-06-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "+ HTML Purify some fields to prevent XSS attacks",
    "type_of_change": "Modification",
    "filename_of_changes": "menus.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "61",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 61: \t\t\t\t\t$DB->queryLimit('id,lid,codename,icon,enabled',",
        "// Line_Reference 62: \t\t\t\t\t\t\t\t\t'nv_menus',",
        "// Line_Reference 63: \t\t\t\t\t\t\t\t\t$where,",
        "// Line_Reference 64: \t\t\t\t\t\t\t\t\t$orderby,",
        "// Line_Reference 65: \t\t\t\t\t\t\t\t\t$offset,",
        "// Line_Reference 66: \t\t\t\t\t\t\t\t\t$max);",
        "// Line_Reference 155: \t$navibars->add_actions(\tarray(\t'<a href=\"?fid='.$_REQUEST['fid'].'&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>',",
        "// Line_Reference 156: \t\t\t\t\t\t\t\t\t'<a href=\"?fid='.$_REQUEST['fid'].'&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',",
        "// Line_Reference 157: \t\t\t\t\t\t\t\t\t'search_form' ));",
        "// Line_Reference 192: \t\t$navibars->title(t(244, 'Menus').' / '.t(38, 'Create'));",
        "// Line_Reference 194: \t\t$navibars->title(t(244, 'Menus').' / '.t(170, 'Edit').' ['.$item->id.']');",
        "// Line_Reference 224: \t$navibars->add_actions(\tarray(\t(!empty($item->id)? '<a href=\"?fid=menus&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>' : ''),",
        "// Line_Reference 225: \t\t\t\t\t\t\t\t\t'<a href=\"?fid=menus&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',",
        "// Line_Reference 226: \t\t\t\t\t\t\t\t\t'search_form' ));",
        "// Line_Reference 293: \tif(empty($item->functions)) $item->functions = array();",
        "// Line_Reference 303: \t\t\t\t\t$sortable_assigned[] = '<li class=\"ui-state-highlight\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';",
        "// Line_Reference 305: \t\t\t\t\t$sortable_assigned[] = '<li class=\"ui-state-highlight ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';",
        "// Line_Reference 316: \t\t\t\t$sortable_unassigned[] = '<li class=\"ui-state-default\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';",
        "// Line_Reference 318: \t\t\t\t$sortable_unassigned[] = '<li class=\"ui-state-default ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';",
        "// Line_Reference 328: \t$navibars->add_tab_content_row(array(\t'<label>'.t(78, 'Category').'</label>',",
        "// Line_Reference 329: \t\t\t\t\t\t\t\t\t\t\t$naviforms->selectfield('menus_functions_category_select', $func_cats, $func_cats, 'web', \"navigate_menus_change_functions_category();\", false)",
        "// Line_Reference 330: \t\t\t\t\t\t\t\t\t\t)",
        "// Line_Reference 331: \t\t\t\t\t\t\t\t\t);",
        "// Line_Reference 333: \t$navibars->add_tab_content($naviforms->hidden(\"menu-functions\", implode('#', $item->functions)));",
        "// Line_Reference 334: \t$navibars->add_tab_content_row(array(\t'<label>'.t(240, 'Functions').'</label>',",
        "// Line_Reference 335: \t\t\t\t\t\t\t\t\t\t\timplode(\"\\n\", $sortable_assigned),",
        "// Line_Reference 336: \t\t\t\t\t\t\t\t\t\t\timplode(\"\\n\", $sortable_unassigned)",
        "// Line_Reference 337: \t\t\t\t\t\t\t\t\t\t)",
        "// Line_Reference 338: \t\t\t\t\t\t\t\t\t);"
    ]
}
