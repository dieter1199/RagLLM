{
    "cve_id": "CVE-2019-14868",
    "cve_description": "In ksh version 20120801, a flaw was found in the way it evaluates certain environment variables. An attacker could use this flaw to override or bypass environment restrictions to execute shell commands. Services and applications that allow remote unauthenticated attackers to provide one of those environment variables could allow them to exploit this issue remotely.",
    "cve_publish_date": "2020-04-02",
    "cwe_id": "CWE-77",
    "cwe_name": "Improper Neutralization of Special Elements used in a Command ('Command Injection')",
    "cwe_description": "The product constructs all or part of a command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended command when it is sent to a downstream component.",
    "commit_message": "Harden env var imports",
    "type_of_change": "Modification",
    "filename_of_changes": "arith.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 570:         if (ptr) *ptr = (char *)str;",
        "// Line_Reference 571:         return 0;",
        "// Line_Reference 572:     }",
        "// Line_Reference 573:     errno = 0;",
        "// Line_Reference 574:     d = number(str, &last, shp->inarith ? 0 : 10, NULL);",
        "// Line_Reference 575:     if (*last) {",
        "// Line_Reference 576:         if (*last != '.' || last[1] != '.') {",
        "// Line_Reference 577:             d = strval(shp, str, &last, arith, mode);",
        "// Line_Reference 578:             Varsubscript = true;",
        "// Line_Reference 580:         if (!ptr && *last && mode > 0) errormsg(SH_DICT, ERROR_exit(1), e_lexbadchar, *last, str);",
        "// Line_Reference 581:     } else if (!d && *str == '-') {",
        "// Line_Reference 582:         d = -0.0;"
    ]
}
