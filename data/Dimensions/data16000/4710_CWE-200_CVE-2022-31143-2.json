{
    "cve_id": "CVE-2022-31143",
    "cve_description": "GLPI stands for Gestionnaire Libre de Parc Informatique and is a Free Asset and IT Management Software package, that provides ITIL Service Desk features, licenses tracking and software auditing. It was found that in affected versions there is an exposure of private information defined in setup of GLPI (like smtp or cas hosts). Note that passwords are not exposed. Users are advised to upgrade to version 10.0.3. There are no known workarounds for this issue.",
    "cve_publish_date": "2022-09-14",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Do not expose CFG_GLPI on anonymous page",
    "type_of_change": "Modification",
    "filename_of_changes": "login.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 91:    // we have done at least a good login? No, we exit.",
        "// Line_Reference 92:     Html::nullHeader(\"Login\", $CFG_GLPI[\"root_doc\"] . '/index.php');",
        "// Line_Reference 93:     echo '<div class=\"center b\">' . $auth->getErr() . '<br><br>';",
        "// Line_Reference 94:    // Logout whit noAUto to manage auto_login with errors",
        "// Line_Reference 95:     echo '<a href=\"' . $CFG_GLPI[\"root_doc\"] . '/front/logout.php?noAUTO=1' .",
        "// Line_Reference 96:          str_replace(\"?\", \"&\", $REDIRECT) . '\">' . __('Log in again') . '</a></div>';",
        "// Line_Reference 97:     Html::nullFooter();"
    ]
}
