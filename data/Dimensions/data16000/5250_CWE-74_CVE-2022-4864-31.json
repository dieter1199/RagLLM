{
    "cve_id": "CVE-2022-4864",
    "cve_description": "Argument Injection in GitHub repository froxlor/froxlor prior to 2.0.0-beta1.",
    "cve_publish_date": "2022-12-30",
    "cwe_id": "CWE-74",
    "cwe_name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
    "cwe_description": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
    "commit_message": "adjust Request-class methods to be more flexible\n\nSigned-off-by: Michael Kaufmann <d00p@froxlor.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "Ajax.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 56: \t\t$this->action = $_GET['action'] ?? $_POST['action'] ?? null;",
        "// Line_Reference 57: \t\t$this->theme = $_GET['theme'] ?? 'Froxlor';",
        "// Line_Reference 115: \t\tif (isset($_GET['role']) && $_GET['role'] == \"customer\") {",
        "// Line_Reference 143: \t\t\tforeach(libxml_get_errors() as $error) {",
        "// Line_Reference 208: \t\t\t\tResponse::dynamicError($e->getMessage());",
        "// Line_Reference 218: \t\t$searchtext = Request::get('searchtext');",
        "// Line_Reference 239: \t\tforeach ((Request::get('columns') ?? []) as $value) {",
        "// Line_Reference 243: \t\t\tListing::storeColumnListingForUser([Request::get('listing') => $columns]);",
        "// Line_Reference 251: \t\tListing::deleteColumnListingForUser([Request::get('listing') => []]);",
        "// Line_Reference 257: \t\t$keyid = isset($_POST['id']) ? (int)$_POST['id'] : 0;",
        "// Line_Reference 258: \t\t$allowed_from = isset($_POST['allowed_from']) ? $_POST['allowed_from'] : \"\";",
        "// Line_Reference 259: \t\t$valid_until = isset($_POST['valid_until']) ? $_POST['valid_until'] : \"\";",
        "// Line_Reference 321: \t\t\t$distribution = isset($_POST['distro']) ? $_POST['distro'] : \"\";",
        "// Line_Reference 322: \t\t\t$section = isset($_POST['section']) ? $_POST['section'] : \"\";",
        "// Line_Reference 323: \t\t\t$daemon = isset($_POST['daemon']) ? $_POST['daemon'] : \"\";",
        "// Line_Reference 378: \t\t$langid = isset($_POST['langid']) ? $_POST['langid'] : \"\";"
    ]
}
