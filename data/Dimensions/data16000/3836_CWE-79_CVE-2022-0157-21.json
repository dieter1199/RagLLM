{
    "cve_id": "CVE-2022-0157",
    "cve_description": "phoronix-test-suite is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cve_publish_date": "2022-01-10",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "phodevi: Input sanitization updates for Phoromatic Server\n\nAlso other code formatting / cleanups while reviewing the code...",
    "type_of_change": "Modification",
    "filename_of_changes": "phoromatic_results.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "178",
    "number_of_lines_deleted_vulnerable_to_cve": "184",
    "vulnerable_lines": [
        "// Line_Reference 6: \tCopyright (C) 2008 - 2018, Phoronix Media",
        "// Line_Reference 7: \tCopyright (C) 2008 - 2018, Michael Larabel",
        "// Line_Reference 23: ",
        "// Line_Reference 40: \t\t\techo phoromatic_webui_header_logged_in();",
        "// Line_Reference 41: \t\t\t$main = null;",
        "// Line_Reference 43: \t\t\tif(!PHOROMATIC_USER_IS_VIEWER && isset($PATH[0]) && $PATH[0] == 'delete')",
        "// Line_Reference 44: \t\t\t{",
        "// Line_Reference 45: \t\t\t\t$pprids = explode(',', $PATH[1]);",
        "// Line_Reference 47: \t\t\t\tforeach($pprids as $pprid)",
        "// Line_Reference 49: \t\t\t\t\t$stmt = phoromatic_server::$db->prepare('SELECT * FROM phoromatic_results WHERE AccountID = :account_id AND PPRID = :pprid LIMIT 1');",
        "// Line_Reference 50: \t\t\t\t\t$stmt->bindValue(':account_id', $_SESSION['AccountID']);",
        "// Line_Reference 51: \t\t\t\t\t$stmt->bindValue(':pprid', $pprid);",
        "// Line_Reference 52: \t\t\t\t\t$result = $stmt->execute();",
        "// Line_Reference 53: \t\t\t\t\tif($result && ($row = $result->fetchArray()))",
        "// Line_Reference 55: \t\t\t\t\t\t$composite_xml = phoromatic_server::phoromatic_account_result_path($_SESSION['AccountID'], $row['UploadID']) . 'composite.xml';",
        "// Line_Reference 56: \t\t\t\t\t\tif(is_file($composite_xml))",
        "// Line_Reference 57: \t\t\t\t\t\t{",
        "// Line_Reference 58: \t\t\t\t\t\t\tunlink($composite_xml);",
        "// Line_Reference 59: \t\t\t\t\t\t}",
        "// Line_Reference 60: ",
        "// Line_Reference 61: \t\t\t\t\t\tpts_file_io::delete(phoromatic_server::phoromatic_account_result_path($_SESSION['AccountID'], $row['UploadID']), null, true);",
        "// Line_Reference 62: ",
        "// Line_Reference 63: \t\t\t\t\t\t$stmt = phoromatic_server::$db->prepare('DELETE FROM phoromatic_results_results WHERE AccountID = :account_id AND UploadID = :upload_id');",
        "// Line_Reference 64: \t\t\t\t\t\t$stmt->bindValue(':account_id', $_SESSION['AccountID']);",
        "// Line_Reference 65: \t\t\t\t\t\t$stmt->bindValue(':upload_id', $row['UploadID']);",
        "// Line_Reference 66: \t\t\t\t\t\t$result = $stmt->execute();",
        "// Line_Reference 67: ",
        "// Line_Reference 68: \t\t\t\t\t\t$stmt = phoromatic_server::$db->prepare('DELETE FROM phoromatic_results_systems WHERE AccountID = :account_id AND UploadID = :upload_id');",
        "// Line_Reference 69: \t\t\t\t\t\t$stmt->bindValue(':account_id', $_SESSION['AccountID']);",
        "// Line_Reference 70: \t\t\t\t\t\t$stmt->bindValue(':upload_id', $row['UploadID']);",
        "// Line_Reference 71: \t\t\t\t\t\t$result = $stmt->execute();",
        "// Line_Reference 72: ",
        "// Line_Reference 73: ",
        "// Line_Reference 76: \t\t\t\t\t$stmt = phoromatic_server::$db->prepare('DELETE FROM phoromatic_results WHERE AccountID = :account_id AND PPRID = :pprid');",
        "// Line_Reference 78: \t\t\t\t\t$stmt->bindValue(':pprid', $pprid);",
        "// Line_Reference 81: \t\t\t\t\t// TODO XXX fix below",
        "// Line_Reference 82: \t\t\t\t\t//$upload_dir = phoromatic_server::phoromatic_account_result_path($_SESSION['AccountID'], $upload_id);",
        "// Line_Reference 83: \t\t\t\t\t//pts_file_io::delete($upload_dir);",
        "// Line_Reference 87: \t\t\tif($main == null)",
        "// Line_Reference 89: \t\t\t\tif(isset($_POST['result_limit']))",
        "// Line_Reference 91: \t\t\t\t\tif(is_numeric($_POST['result_limit']) && $_POST['result_limit'] > 9)",
        "// Line_Reference 92: \t\t\t\t\t{",
        "// Line_Reference 93: \t\t\t\t\t\t$result_limit = $_POST['result_limit'];",
        "// Line_Reference 94: \t\t\t\t\t}",
        "// Line_Reference 95: \t\t\t\t\telse",
        "// Line_Reference 96: \t\t\t\t\t{",
        "// Line_Reference 97: \t\t\t\t\t\t$result_limit = 0;",
        "// Line_Reference 98: \t\t\t\t\t}",
        "// Line_Reference 102: \t\t\t\t\t$result_limit = 100;",
        "// Line_Reference 104: \t\t\t\t$min_date = strtotime(phoromatic_server::account_created_on($_SESSION['AccountID']));",
        "// Line_Reference 105: \t\t\t\t$default_start_date = max($min_date, strtotime('-1 year'));",
        "// Line_Reference 106: \t\t\t\t$min_date = date('Y-m-d', $min_date);",
        "// Line_Reference 107: \t\t\t\t$time_start = strtotime(isset($_POST['time_start']) && !empty($_POST['time_start']) ? $_POST['time_start'] : $min_date);",
        "// Line_Reference 108: \t\t\t\tif(empty($time_start))",
        "// Line_Reference 110: \t\t\t\t\t$time_start = strtotime($min_date);",
        "// Line_Reference 112: \t\t\t\t$time_end = strtotime((isset($_POST['time_end']) && !empty($_POST['time_end']) ? $_POST['time_end'] : date('Y-m-d')) . ' 23:59:59');",
        "// Line_Reference 113: \t\t\t\tif(empty($time_end))",
        "// Line_Reference 115: \t\t\t\t\t$time_end = strtotime(date('Y-m-d') . ' 23:59:59');",
        "// Line_Reference 117: \t\t\t\t$main .= '<form action=\"' . $_SERVER['REQUEST_URI'] . '\" method=\"post\"><div style=\"text-align: left; font-weight: bold;\">Results From <input id=\"time_start\" name=\"time_start\" type=\"date\" required pattern=\"[0-9]{4}-[0-9]{2}-[0-9]{2}\" min=\"' . $min_date . '\" value=\"' . (isset($_POST['time_start']) ? $_POST['time_start'] : date('Y-m-d', $default_start_date)) . '\" max=\"' . date('Y-m-d') . '\" /> To  <input id=\"time_end\" name=\"time_end\" type=\"date\" required pattern=\"[0-9]{4}-[0-9]{2}-[0-9]{2}\" min=\"' . $min_date . '\" value=\"' . (isset($_POST['time_end']) ? $_POST['time_end'] : date('Y-m-d')) . '\" max=\"' . date('Y-m-d') . '\" /> &nbsp; With Tests: <input type=\"text\" name=\"containing_tests\" id=\"containing_tests\" value=\"' . (isset($_POST['containing_tests']) ? $_POST['containing_tests'] : null) . '\" /> With Hardware: <input type=\"text\" name=\"containing_hardware\" id=\"containing_hardware\" value=\"' . (isset($_POST['containing_hardware']) ? $_POST['containing_hardware'] : null) . '\" /> With System Software: <input type=\"text\" name=\"containing_software\" id=\"containing_software\" value=\"' . (isset($_POST['containing_software']) ? $_POST['containing_software'] : null) . '\" /> Search For <input type=\"text\" name=\"search\" id=\"search_for\" value=\"' . (isset($_POST['search']) ? $_POST['search'] : null) . '\" /> Limit Results To <select id=\"result_limit\" name=\"result_limit\">';",
        "// Line_Reference 118: \t\t\t\tfor($i = 100; $i <= 500; $i += 100)",
        "// Line_Reference 120: \t\t\t\t\t$main .= '<option value=\"' . $i . '\"' . ($result_limit == $i ? ' selected=\"selected\"' : null) . '>' . $i . '</option>';",
        "// Line_Reference 122: \t\t\t\t$main .= '<option value=\"\"' . (isset($_POST['result_limit']) && empty($result_limit) ? ' selected=\"selected\"' : null) . '>No Limit</option>';",
        "// Line_Reference 124: \t\t\t\t$main .= '</select> &nbsp; <input type=\"button\" value=\"Reset\" onclick=\"phoromatic_clear_results_search_fields();\" />';",
        "// Line_Reference 125: \t\t\t\t$main .= ' &nbsp; <input type=\"submit\" value=\"Update\" /></div></form>';",
        "// Line_Reference 126: \t\t\t\t$main .= '<p style=\"font-size: 90%;\">** <em>AND</em>, <em>OR</em>, and <em>NOT</em> search operators supported for tests/hardware/software search fields. **</p>';",
        "// Line_Reference 127: \t\t\t\t$main .= '<h1>Account Test Results</h1>';",
        "// Line_Reference 128: \t\t\t\t$main .= '<div class=\"pts_phoromatic_info_box_area\">';",
        "// Line_Reference 129: \t\t\t\t$search_for = (!isset($_POST['search']) || empty($_POST['search']) ? null : 'AND (Title LIKE :search OR Description LIKE :search OR UploadID IN (SELECT UploadID FROM phoromatic_results_systems WHERE AccountID = :account_id AND (Software LIKE :search OR Hardware LIKE :search)))');",
        "// Line_Reference 130: \t\t\t\tif(isset($_POST['containing_hardware']) && !empty($_POST['containing_hardware']))",
        "// Line_Reference 132: \t\t\t\t\t$hw_advanced_query = stripos($_POST['containing_hardware'], ' AND ') !== false || stripos($_POST['containing_hardware'], ' OR ') !== false || stripos($_POST['containing_hardware'], ' NOT ') !== false;",
        "// Line_Reference 133: \t\t\t\t\tif($hw_advanced_query || true)",
        "// Line_Reference 134: \t\t\t\t\t{",
        "// Line_Reference 135: \t\t\t\t\t\t$hw_advanced_query = pts_phoroql::search_query_to_tree($_POST['containing_hardware']);",
        "// Line_Reference 136: \t\t\t\t\t}",
        "// Line_Reference 137: \t\t\t\t\telse",
        "// Line_Reference 138: \t\t\t\t\t{",
        "// Line_Reference 139: \t\t\t\t\t\t$search_for .= ' AND UploadID IN (SELECT UploadID FROM phoromatic_results_systems WHERE AccountID = :account_id AND Hardware LIKE :containing_hardware)';",
        "// Line_Reference 140: \t\t\t\t\t}",
        "// Line_Reference 142: \t\t\t\tif(isset($_POST['containing_software']) && !empty($_POST['containing_software']))",
        "// Line_Reference 144: \t\t\t\t\t$sw_advanced_query = strpos($_POST['containing_software'], ' AND ') !== false || strpos($_POST['containing_software'], ' OR ') !== false || strpos($_POST['containing_software'], ' NOT ') !== false;",
        "// Line_Reference 145: \t\t\t\t\tif($sw_advanced_query || true)",
        "// Line_Reference 146: \t\t\t\t\t{",
        "// Line_Reference 147: \t\t\t\t\t\t$sw_advanced_query = pts_phoroql::search_query_to_tree($_POST['containing_software']);",
        "// Line_Reference 148: \t\t\t\t\t}",
        "// Line_Reference 149: \t\t\t\t\telse",
        "// Line_Reference 150: \t\t\t\t\t{",
        "// Line_Reference 151: \t\t\t\t\t\t$search_for .= ' AND UploadID IN (SELECT UploadID FROM phoromatic_results_systems WHERE AccountID = :account_id AND Software LIKE :containing_software)';",
        "// Line_Reference 152: \t\t\t\t\t}",
        "// Line_Reference 154: \t\t\t\t$main .= '<div style=\"margin: 0 5%;\"><ul style=\"max-height: 100%;\"><li><h1>Recent Test Results</h1></li>';",
        "// Line_Reference 155: ",
        "// Line_Reference 156: \t\t\t\tif(isset($PATH[1]) && $PATH[0] == 'hash')",
        "// Line_Reference 158: \t\t\t\t\t// Find matching comparison hashes",
        "// Line_Reference 159: \t\t\t\t\t$stmt = phoromatic_server::$db->prepare('SELECT Title, SystemID, ScheduleID, PPRID, UploadTime, TimesViewed, AccountID, UploadID FROM phoromatic_results WHERE AccountID = :account_id ' . $search_for. ' AND ComparisonHash = :comparison_hash ORDER BY UploadTime DESC');",
        "// Line_Reference 160: \t\t\t\t\t$stmt->bindValue(':comparison_hash', $PATH[1]);",
        "// Line_Reference 162: \t\t\t\telse if(isset($PATH[1]) && $PATH[0] == 'ticket')",
        "// Line_Reference 164: \t\t\t\t\t// Find matching ticket results",
        "// Line_Reference 165: \t\t\t\t\t$stmt = phoromatic_server::$db->prepare('SELECT Title, SystemID, ScheduleID, PPRID, UploadTime, TimesViewed, AccountID, UploadID FROM phoromatic_results WHERE AccountID = :account_id ' . $search_for. ' AND BenchmarkTicketID = :ticket_id ORDER BY UploadTime DESC');",
        "// Line_Reference 166: \t\t\t\t\t$stmt->bindValue(':ticket_id', $PATH[1]);",
        "// Line_Reference 168: \t\t\t\telse",
        "// Line_Reference 170: \t\t\t\t\t$stmt = phoromatic_server::$db->prepare('SELECT Title, SystemID, ScheduleID, PPRID, UploadTime, TimesViewed, AccountID, UploadID FROM phoromatic_results WHERE AccountID = :account_id ' . $search_for. ' ORDER BY UploadTime DESC');",
        "// Line_Reference 172: ",
        "// Line_Reference 173: \t\t\t\t$stmt->bindValue(':account_id', $_SESSION['AccountID']);",
        "// Line_Reference 174: \t\t\t\t$stmt->bindValue(':search', (isset($_POST['search']) ? '%' . $_POST['search'] . '%' : null));",
        "// Line_Reference 175: \t\t\t\t$stmt->bindValue(':containing_hardware', (isset($_POST['containing_hardware']) ? '%' . $_POST['containing_hardware'] . '%' : null));",
        "// Line_Reference 176: \t\t\t\t$stmt->bindValue(':containing_software', (isset($_POST['containing_software']) ? '%' . $_POST['containing_software'] . '%' : null));",
        "// Line_Reference 177: \t\t\t\t$test_result_result = $stmt->execute();",
        "// Line_Reference 178: \t\t\t\t$results = 0;",
        "// Line_Reference 179: \t\t\t\t$containing_tests = isset($_POST['containing_tests']) ? $_POST['containing_tests'] : null;",
        "// Line_Reference 182: \t\t\t\t\t$containing_tests = pts_phoroql::search_query_to_tree($containing_tests);",
        "// Line_Reference 185: \t\t\t\twhile($test_result_row = $test_result_result->fetchArray())",
        "// Line_Reference 218: ",
        "// Line_Reference 227: \t\t\t\t\t$main .= '<a onclick=\"\"><li id=\"result_select_' . $test_result_row['PPRID'] . '\"><input type=\"checkbox\" id=\"result_compare_checkbox_' . $test_result_row['PPRID'] . '\" onclick=\"javascript:phoromatic_checkbox_toggle_result_comparison(\\'' . $test_result_row['PPRID'] . '\\');\" onchange=\"return false;\"></input> <span onclick=\"javascript:phoromatic_window_redirect(\\'?result/' . $test_result_row['PPRID'] . '\\');\">' . $test_result_row['Title'] . '</span><br /><table><tr><td>' . phoromatic_system_id_to_name($test_result_row['SystemID']) . '</td><td>' . phoromatic_user_friendly_timedate($test_result_row['UploadTime']) .  '</td><td>' . $test_result_row['TimesViewed'] . ' Times Viewed</td></table></li></a>';",
        "// Line_Reference 230: \t\t\t\tif($results == 0)",
        "// Line_Reference 231: \t\t\t\t{",
        "// Line_Reference 232: \t\t\t\t\t$main .= '<li class=\"light\" style=\"text-align: center;\">No Results Found</li>';",
        "// Line_Reference 233: \t\t\t\t}",
        "// Line_Reference 234: \t\t\t\telse if($results > 3)",
        "// Line_Reference 235: \t\t\t\t{",
        "// Line_Reference 236: \t\t\t\t\t$main .= '<a onclick=\"\"><li id=\"global_bottom_totals\"><input type=\"checkbox\" id=\"global_checkbox\" onclick=\"javascript:phoromatic_toggle_checkboxes_on_page(this);\" onchange=\"return false;\"></input> <strong>' . $results . ' Results</strong></li></a>';",
        "// Line_Reference 237: \t\t\t\t}",
        "// Line_Reference 239: \t\t\t\t$main .= '</div>';",
        "// Line_Reference 240: ",
        "// Line_Reference 241: \t\t\t\t$result_share_opt = phoromatic_server::read_setting('force_result_sharing') ? '1 = 1' : 'AccountID IN (SELECT AccountID FROM phoromatic_account_settings WHERE LetOtherGroupsViewResults = \"1\")';",
        "// Line_Reference 242: \t\t\t\t$stmt = phoromatic_server::$db->prepare('SELECT Title, SystemID, ScheduleID, PPRID, UploadTime, TimesViewed, AccountID, UploadID FROM phoromatic_results WHERE ' . $result_share_opt . ' AND AccountID != :account_id ' . $search_for. ' ORDER BY UploadTime DESC');",
        "// Line_Reference 243: \t\t\t\t$stmt->bindValue(':account_id', $_SESSION['AccountID']);",
        "// Line_Reference 244: \t\t\t\t$stmt->bindValue(':search', (isset($_POST['search']) ? '%' . $_POST['search'] . '%' : null));",
        "// Line_Reference 245: \t\t\t\t$stmt->bindValue(':containing_hardware', (isset($_POST['containing_hardware']) ? '%' . $_POST['containing_hardware'] . '%' : null));",
        "// Line_Reference 246: \t\t\t\t$stmt->bindValue(':containing_software', (isset($_POST['containing_software']) ? '%' . $_POST['containing_software'] . '%' : null));",
        "// Line_Reference 247: \t\t\t\t$test_result_result = $stmt->execute();",
        "// Line_Reference 248: \t\t\t\tif(!empty($test_result_result) && ($test_result_row = $test_result_result->fetchArray()))",
        "// Line_Reference 249: \t\t\t\t{",
        "// Line_Reference 250: \t\t\t\t\t$main .= '<div class=\"pts_phoromatic_info_box_area\">';",
        "// Line_Reference 251: \t\t\t\t\t$main .= '<ul style=\"max-height: 100%;\"><li><h1>Results Shared By Other Groups</h1></li>';",
        "// Line_Reference 252: \t\t\t\t\t$results = 0;",
        "// Line_Reference 253: \t\t\t\t\tdo",
        "// Line_Reference 254: \t\t\t\t\t{",
        "// Line_Reference 255: \t\t\t\t\t\tif(strtotime($test_result_row['UploadTime']) > $time_end)",
        "// Line_Reference 256: \t\t\t\t\t\t{",
        "// Line_Reference 257: \t\t\t\t\t\t\tcontinue;",
        "// Line_Reference 258: \t\t\t\t\t\t}",
        "// Line_Reference 259: \t\t\t\t\t\tif(strtotime($test_result_row['UploadTime']) < $time_start)",
        "// Line_Reference 260: \t\t\t\t\t\t{",
        "// Line_Reference 261: \t\t\t\t\t\t\t//break;",
        "// Line_Reference 262: \t\t\t\t\t\t}",
        "// Line_Reference 263: \t\t\t\t\t\tif(!empty($result_limit) && $result_limit > 1 && $result_limit == $results)",
        "// Line_Reference 264: \t\t\t\t\t\t{",
        "// Line_Reference 265: \t\t\t\t\t\t\tbreak;",
        "// Line_Reference 266: \t\t\t\t\t\t}",
        "// Line_Reference 267: ",
        "// Line_Reference 268: \t\t\t\t\t\t$composite_xml = phoromatic_server::phoromatic_account_result_path($test_result_row['AccountID'], $test_result_row['UploadID']) . 'composite.xml';",
        "// Line_Reference 269: \t\t\t\t\t\t$result_file = new pts_result_file($composite_xml);",
        "// Line_Reference 270: ",
        "// Line_Reference 271: \t\t\t\t\t\tif(isset($_POST['containing_hardware']) && !empty($_POST['containing_hardware']) && $hw_advanced_query)",
        "// Line_Reference 272: \t\t\t\t\t\t{",
        "// Line_Reference 273: \t\t\t\t\t\t\t//if(!$result_file->contains_system_hardware($_POST['containing_hardware']))",
        "// Line_Reference 274: \t\t\t\t\t\t\tif(!pts_phoroql::evaluate_search_tree($hw_advanced_query, 'AND', array($result_file, 'contains_system_hardware')))",
        "// Line_Reference 275: \t\t\t\t\t\t\t{",
        "// Line_Reference 276: \t\t\t\t\t\t\t\tcontinue;",
        "// Line_Reference 277: \t\t\t\t\t\t\t}",
        "// Line_Reference 278: \t\t\t\t\t\t}",
        "// Line_Reference 279: \t\t\t\t\t\tif(isset($_POST['containing_software']) && !empty($_POST['containing_software']) && $sw_advanced_query)",
        "// Line_Reference 280: \t\t\t\t\t\t{",
        "// Line_Reference 281: \t\t\t\t\t\t\tif(!pts_phoroql::evaluate_search_tree($sw_advanced_query, 'AND', array($result_file, 'contains_system_software')))",
        "// Line_Reference 282: \t\t\t\t\t\t\t{",
        "// Line_Reference 283: \t\t\t\t\t\t\t\tcontinue;",
        "// Line_Reference 284: \t\t\t\t\t\t\t}",
        "// Line_Reference 285: \t\t\t\t\t\t}",
        "// Line_Reference 286: ",
        "// Line_Reference 287: \t\t\t\t\t\tif(!empty($containing_tests))",
        "// Line_Reference 288: \t\t\t\t\t\t{",
        "// Line_Reference 289: \t\t\t\t\t\t\tif(!pts_phoroql::evaluate_search_tree($containing_tests, 'AND', array($result_file, 'contains_test')))",
        "// Line_Reference 290: \t\t\t\t\t\t\t{",
        "// Line_Reference 291: \t\t\t\t\t\t\t\tcontinue;",
        "// Line_Reference 292: \t\t\t\t\t\t\t}",
        "// Line_Reference 293: \t\t\t\t\t\t}",
        "// Line_Reference 294: ",
        "// Line_Reference 295: \t\t\t\t\t\t$main .= '<a onclick=\"\"><li id=\"result_select_' . $test_result_row['PPRID'] . '\"><input type=\"checkbox\" id=\"result_compare_checkbox_' . $test_result_row['PPRID'] . '\" onclick=\"javascript:phoromatic_checkbox_toggle_result_comparison(\\'' . $test_result_row['PPRID'] . '\\');\" onchange=\"return false;\"></input> <span onclick=\"javascript:phoromatic_window_redirect(\\'?result/' . $test_result_row['PPRID'] . '\\');\">' . $test_result_row['Title'] . '</span><br /><table><tr><td><strong>' . phoromatic_account_id_to_group_name($test_result_row['AccountID']) . '</strong></td><td>' . phoromatic_system_id_to_name($test_result_row['SystemID'], $test_result_row['AccountID']) . '</td><td>' . phoromatic_user_friendly_timedate($test_result_row['UploadTime']) .  '</td><td>' . $test_result_row['TimesViewed'] . ' Times Viewed</td></table></li></a>';",
        "// Line_Reference 296: \t\t\t\t\t\t$results++;",
        "// Line_Reference 297: \t\t\t\t\t}",
        "// Line_Reference 298: \t\t\t\t\twhile($test_result_row = $test_result_result->fetchArray());",
        "// Line_Reference 299: \t\t\t\t\t$main .= '</ul></div>';",
        "// Line_Reference 300: \t\t\t\t}",
        "// Line_Reference 303: \t\t\techo phoromatic_webui_main($main);",
        "// Line_Reference 304: \t\t\techo phoromatic_webui_footer();"
    ]
}
