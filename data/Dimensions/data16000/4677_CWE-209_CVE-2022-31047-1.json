{
    "cve_id": "CVE-2022-31047",
    "cve_description": "TYPO3 is an open source web content management system. Prior to versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, and 11.5.11, system internal credentials or keys (e.g. database credentials) can be logged as plaintext in exception handlers, when logging the complete exception stack trace. TYPO3 versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, 11.5.11 contain a fix for the problem.",
    "cve_publish_date": "2022-06-14",
    "cwe_id": "CWE-209",
    "cwe_name": "Generation of Error Message Containing Sensitive Information",
    "cwe_description": "The product generates an error message that includes sensitive information about its environment, users, or associated data.",
    "commit_message": "[SECURITY] Do not log stacktrace in exception handlers\n\nWhen a TYPO3 exception is handled through registered exception\nhandlers, log writers may log sensitive information to logs,\nsince the full stacktrace is logged.\n\nWith this change, exception handlers that extend\nAbstractExceptionHandler except DebugExceptionHandler will\nby default not include the exception object any more and\nthereby not log the full stacktrace.\n\nResolves: #96866\nReleases: main, 11.5, 10.4\nChange-Id: Iaf233eefc9a1a60334a47753baf457e8282e68c0\nSecurity-Bulletin: TYPO3-CORE-SA-2022-002\nSecurity-References: CVE-2022-31047\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/74903\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "AbstractExceptionHandler.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 101:                     'exception' => $exception,"
    ]
}
