{
    "cve_id": "CVE-2018-17552",
    "cve_description": "SQL Injection in login.php in Naviwebs Navigate CMS 2.8 allows remote attackers to bypass authentication via the navigate-user cookie.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "* security fix: replace string filtering by parameterization in almost all queries",
    "type_of_change": "Modification",
    "filename_of_changes": "comments.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "62",
    "number_of_lines_deleted_vulnerable_to_cve": "38",
    "vulnerable_lines": [
        "// Line_Reference 180:             $DB->query('SELECT id, username as text",
        "// Line_Reference 181: \t\t\t\t\t\t  FROM nv_webusers",
        "// Line_Reference 182: \t\t\t\t\t\t WHERE username LIKE '.protect('%'.$_REQUEST['username'].'%').'",
        "// Line_Reference 183: \t\t\t\t\t\t AND website = '.$website->id.'",
        "// Line_Reference 184: \t\t\t\t      ORDER BY username ASC",
        "// Line_Reference 185: \t\t\t\t\t     LIMIT 30',",
        "// Line_Reference 186:                 'array');",
        "// Line_Reference 196:             $DB->query('SELECT c.id, c.date_created, c.name, u.username, c.message",
        "// Line_Reference 197: \t\t\t\t\t\t  FROM nv_comments c",
        "// Line_Reference 198: \t\t\t\t\t\t  LEFT JOIN nv_webusers u ON c.user = u.id",
        "// Line_Reference 199: \t\t\t\t\t\t WHERE",
        "// Line_Reference 200: \t\t\t\t\t\t    c.website = '.$website->id.' AND",
        "// Line_Reference 201: \t\t\t\t\t\t    c.object_type = '.protect($_REQUEST['object_type']).' AND",
        "// Line_Reference 202: \t\t\t\t\t\t    c.object_id = '.protect($_REQUEST['object_id']).' AND",
        "// Line_Reference 203: \t\t\t\t\t\t    c.date_created <= '.$_REQUEST['maxdate'].' AND",
        "// Line_Reference 204: \t\t\t\t\t\t    c.id <> '.$_REQUEST['exclude'].' AND",
        "// Line_Reference 205: \t\t\t\t\t\t    (   c.name LIKE ' . protect('%' . $_REQUEST['search'] . '%') . ' OR",
        "// Line_Reference 206: \t\t\t\t\t\t        c.message LIKE ' . protect('%' . $_REQUEST['search'] . '%') . ' OR",
        "// Line_Reference 207: \t\t\t\t\t\t        u.username LIKE ' . protect('%' . $_REQUEST['search'] . '%') . '",
        "// Line_Reference 208:                             )",
        "// Line_Reference 209: \t\t\t\t      ORDER BY c.date_created DESC",
        "// Line_Reference 210: \t\t\t\t\t     LIMIT 30',",
        "// Line_Reference 211:                 'array');",
        "// Line_Reference 225:             $DB->query('SELECT c.*",
        "// Line_Reference 226: \t\t\t\t\t\t  FROM nv_comments c",
        "// Line_Reference 227: \t\t\t\t\t\t  LEFT JOIN nv_webusers u ON c.user = u.id",
        "// Line_Reference 228: \t\t\t\t\t\t WHERE",
        "// Line_Reference 229: \t\t\t\t\t\t    c.website = '.$website->id.' AND",
        "// Line_Reference 230: \t\t\t\t\t\t    c.id = '.protect($_REQUEST['id']));",
        "// Line_Reference 241: \t\t\t$DB->query('SELECT DISTINCT node_id as id, text as label, text as value",
        "// Line_Reference 242: \t\t\t\t\t\t  FROM nv_webdictionary",
        "// Line_Reference 243: \t\t\t\t\t\t WHERE node_type = '.protect($_REQUEST['object_type']).'",
        "// Line_Reference 244: \t\t\t\t\t\t   AND subtype = \"title\"",
        "// Line_Reference 245: \t\t\t\t\t\t   AND website = '.$website->id.'",
        "// Line_Reference 246: \t\t\t\t\t\t   AND text LIKE '.protect('%'.$_REQUEST['title'].'%').'",
        "// Line_Reference 247: \t\t\t\t      ORDER BY text ASC",
        "// Line_Reference 248: \t\t\t\t\t     LIMIT 30',",
        "// Line_Reference 249: \t\t\t\t\t\t'array'"
    ]
}
