{
    "cve_id": "CVE-2022-4630",
    "cve_description": "Sensitive Cookie Without 'HttpOnly' Flag in GitHub repository lirantal/daloradius prior to master.",
    "cve_publish_date": "2022-12-21",
    "cwe_id": "CWE-732",
    "cwe_name": "Incorrect Permission Assignment for Critical Resource",
    "cwe_description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
    "commit_message": "Improved attribute dictionaries management feature (#316)\n\nImproved layout and other minor features",
    "type_of_change": "Modification",
    "filename_of_changes": "menu-bill-merchant.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "78",
    "number_of_lines_deleted_vulnerable_to_cve": "116",
    "vulnerable_lines": [
        "// Line_Reference 26:     header(\"Location: /index.php\");",
        "// Line_Reference 36: ",
        "// Line_Reference 37: $checkboxes = array(",
        "// Line_Reference 38:                         \"id\" => t('all','ID'),",
        "// Line_Reference 39:                         \"username\" => t('all','Username'),",
        "// Line_Reference 40:                         \"password\"  => t('all','Password'),",
        "// Line_Reference 41:                         \"txnId\"  => t('all','TxnId'),",
        "// Line_Reference 42:                         \"planName\" => t('all','PlanName'),",
        "// Line_Reference 43:                         \"planId\"  => t('all','PlanId'),",
        "// Line_Reference 44:                         \"quantity\"  => t('all','Quantity'),",
        "// Line_Reference 45:                         \"business_email\"  => t('all','ReceiverEmail'),",
        "// Line_Reference 46:                         \"business_id\"  => t('all','Business'),",
        "// Line_Reference 47:                         \"payment_tax\" => t('all','Tax'),",
        "// Line_Reference 48:                         \"payment_cost\"  => t('all','Cost'),",
        "// Line_Reference 49:                         \"payment_fee\" => t('all','TransactionFee'),",
        "// Line_Reference 50:                         \"payment_total\" => t('all','TotalCost'),",
        "// Line_Reference 51:                         \"payment_currency\" => t('all','PaymentCurrency'),",
        "// Line_Reference 52:                         \"first_name\" => t('all','FirstName'),",
        "// Line_Reference 53:                         \"last_name\" => t('all','LastName'),",
        "// Line_Reference 54:                         \"payer_email\" => t('all','PayerEmail'),",
        "// Line_Reference 55:                         \"payer_address_name\"  => t('all','AddressRecipient'),",
        "// Line_Reference 56:                         \"payer_address_street\"  => t('all','Street'),",
        "// Line_Reference 57:                         \"payer_address_country\" => t('all','Country'),",
        "// Line_Reference 58:                         \"payer_address_country_code\"  => t('all','CountryCode'),",
        "// Line_Reference 59:                         \"payer_address_city\" => t('all','City'),",
        "// Line_Reference 60:                         \"payer_address_state\" => t('all','State'),",
        "// Line_Reference 61:                         \"payer_address_zip\"  => t('all','Zip'),",
        "// Line_Reference 62:                         \"payment_date\" => t('all','PaymentDate'),",
        "// Line_Reference 63:                         \"payment_status\" => t('all','PaymentStatus'),",
        "// Line_Reference 64:                         \"payer_status\" => t('all','PayerStatus'),",
        "// Line_Reference 65:                         \"payment_address_status\" => t('all','PaymentAddressStatus'),",
        "// Line_Reference 66:                         \"vendor_type\" => t('all','VendorType')",
        "// Line_Reference 67:                    );",
        "// Line_Reference 68: $checkboxes_checked = array(",
        "// Line_Reference 69:                             \"username\",",
        "// Line_Reference 70:                             \"planName\",",
        "// Line_Reference 71:                             \"payment_fee\",",
        "// Line_Reference 72:                             \"payment_total\",",
        "// Line_Reference 73:                             \"payment_currency\",",
        "// Line_Reference 74:                             \"first_name\",",
        "// Line_Reference 75:                             \"last_name\",",
        "// Line_Reference 76:                             \"payer_email\",",
        "// Line_Reference 77:                             \"payer_address_country\",",
        "// Line_Reference 78:                             \"payer_address_city\",",
        "// Line_Reference 79:                             \"payer_address_state\",",
        "// Line_Reference 80:                             \"payment_date\",",
        "// Line_Reference 81:                             \"payment_status\",",
        "// Line_Reference 82:                             \"vendor_type\"",
        "// Line_Reference 83:                            );",
        "// Line_Reference 102:                                     value=\"<?= (isset($billing_date_startdate)) ? $billing_date_startdate : date(\"Y-m-01\") ?>\">",
        "// Line_Reference 105:                                 <input name=\"enddate\" type=\"text\" id=\"enddate\" tooltipText=\"<?= t('Tooltip','Date') ?>\"",
        "// Line_Reference 106:                                     value=\"<?= (isset($billing_date_enddate)) ? $billing_date_enddate : date(\"Y-m-t\") ?>\">",
        "// Line_Reference 107: ",
        "// Line_Reference 108:                                 <br><br>",
        "// Line_Reference 109: ",
        "// Line_Reference 110:                                 <h109><?= t('all','VendorType'); ?></h109><br>",
        "// Line_Reference 111:                                 <select name=\"vendor_type\" size=\"1\">",
        "// Line_Reference 112:                                     <option value=\"<?= (isset($billing_paypal_vendor_type)) ? $billing_paypal_vendor_type : \"%\" ?>\">",
        "// Line_Reference 113:                                         <?= (isset($billing_paypal_vendor_type)) ? $billing_paypal_vendor_type : \"Any\" ?>",
        "// Line_Reference 114:                                     </option>",
        "// Line_Reference 115:                                     <option value=\"\"></option>",
        "// Line_Reference 116:                                     <option value=\"%\">Any</option>",
        "// Line_Reference 117:                                     <option value=\"PayPal\">PayPal</option>",
        "// Line_Reference 118:                                     <option value=\"2Checkout\">2Checkout</option>",
        "// Line_Reference 119:                                 </select>",
        "// Line_Reference 120: ",
        "// Line_Reference 121:                                 <h109><?= t('all','PayerEmail'); ?></h109><br>",
        "// Line_Reference 122:                                 <input name=\"payer_email\" type=\"text\"",
        "// Line_Reference 123:                                     value=\"<?= (isset($billing_paypal_payeremail)) ? $billing_paypal_payeremail : \"*\" ?>\">",
        "// Line_Reference 124: ",
        "// Line_Reference 125:                                 <br><br>",
        "// Line_Reference 126: ",
        "// Line_Reference 127:                                 <h109><?= t('all','PaymentStatus'); ?></h109><br>",
        "// Line_Reference 128:                                 <select name=\"payment_status\" size=\"1\">",
        "// Line_Reference 129:                                     <option value=\"<?= (isset($billing_paypal_paymentstatus)) ? $billing_paypal_paymentstatus : \"%\" ?>\">",
        "// Line_Reference 130:                                         <?= (isset($billing_paypal_paymentstatus)) ? $billing_paypal_paymentstatus : \"Any\" ?>",
        "// Line_Reference 131:                                     </option>",
        "// Line_Reference 132:                                     <option value=\"\"></option>",
        "// Line_Reference 133:                                     <option value=\"Completed\">Completed</option>",
        "// Line_Reference 134:                                     <option value=\"Denied\">Denied</option>",
        "// Line_Reference 135:                                     <option value=\"Expired\">Expired</option>",
        "// Line_Reference 136:                                     <option value=\"Failed\">Failed</option>",
        "// Line_Reference 137:                                     <option value=\"In-Progress\">In-Progress</option>",
        "// Line_Reference 138:                                     <option value=\"Pending\">Pending</option>",
        "// Line_Reference 139:                                     <option value=\"Processed\">Processed</option>",
        "// Line_Reference 140:                                     <option value=\"Refunded\">Refunded</option>",
        "// Line_Reference 141:                                     <option value=\"Reversed\">Reversed</option>",
        "// Line_Reference 142:                                     <option value=\"Canceled-Reversal\">Canceled-Reversal</option>",
        "// Line_Reference 143:                                     <option value=\"Voided\">Voided</option>",
        "// Line_Reference 144:                                 </select>",
        "// Line_Reference 147: ",
        "// Line_Reference 148:                                 <h109><?= t('button','AccountingFieldsinQuery'); ?></h109><br>",
        "// Line_Reference 150:                                 foreach ($checkboxes as $value => $caption) {",
        "// Line_Reference 151:                                     $checked = in_array($value, $checkboxes_checked) ? ' checked' : '';",
        "// Line_Reference 152:                                     printf('<input type=\"checkbox\" name=\"sqlfields[]\" value=\"%s\"%s><h109>%s</h109><br>',",
        "// Line_Reference 153:                                            $value, $checked, $caption);",
        "// Line_Reference 154:                                 }",
        "// Line_Reference 156:                                 <br><h109>Select:</h109>",
        "// Line_Reference 157:                                 <a class=\"table\" href=\"javascript:SetChecked(1,'sqlfields[]','billpaypaltransactions')\">All</a>",
        "// Line_Reference 158:                                 <a class=\"table\" href=\"javascript:SetChecked(0,'sqlfields[]','billpaypaltransactions')\">None</a>",
        "// Line_Reference 159: ",
        "// Line_Reference 161: ",
        "// Line_Reference 162:                                 <h109><?= t('button','OrderBy') ?></h109><br>",
        "// Line_Reference 163: ",
        "// Line_Reference 164:                                 <div style=\"text-align: center\">",
        "// Line_Reference 165:                                     <select name=\"orderBy\" size=\"1\">",
        "// Line_Reference 166:                                         <option value=\"id\"> Id </option>",
        "// Line_Reference 167:                                         <option value=\"username\"> username </option>",
        "// Line_Reference 168:                                         <option value=\"txnId\"> txnId </option>",
        "// Line_Reference 169:                                     </select>",
        "// Line_Reference 170: ",
        "// Line_Reference 171:                                     <select name=\"orderType\" size=\"1\">",
        "// Line_Reference 172:                                         <option value=\"ASC\"> Ascending </option>",
        "// Line_Reference 173:                                         <option value=\"DESC\"> Descending </option>",
        "// Line_Reference 174:                                     </select>",
        "// Line_Reference 175:                                 </div>"
    ]
}
