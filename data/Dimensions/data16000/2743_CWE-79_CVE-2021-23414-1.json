{
    "cve_id": "CVE-2021-23414",
    "cve_description": "This affects the package video.js before 7.14.3. The src attribute of track tag allows to bypass HTML escaping and execute arbitrary code.",
    "cve_publish_date": "2021-07-28",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fix: remove IE8 url parsing workaround (#7334)",
    "type_of_change": "Modification",
    "filename_of_changes": "url.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 47:   let a = document.createElement('a');",
        "// Line_Reference 51:   // IE8 (and 9?) Fix",
        "// Line_Reference 52:   // ie8 doesn't parse the URL correctly until the anchor is actually",
        "// Line_Reference 53:   // added to the body, and an innerHTML is needed to trigger the parsing",
        "// Line_Reference 54:   const addToBody = (a.host === '' && a.protocol !== 'file:');",
        "// Line_Reference 55:   let div;",
        "// Line_Reference 56: ",
        "// Line_Reference 57:   if (addToBody) {",
        "// Line_Reference 58:     div = document.createElement('div');",
        "// Line_Reference 59:     div.innerHTML = `<a href=\"${url}\"></a>`;",
        "// Line_Reference 60:     a = div.firstChild;",
        "// Line_Reference 61:     // prevent the div from affecting layout",
        "// Line_Reference 62:     div.setAttribute('style', 'display:none; position:absolute;');",
        "// Line_Reference 63:     document.body.appendChild(div);",
        "// Line_Reference 64:   }",
        "// Line_Reference 65: ",
        "// Line_Reference 67:   // This is also needed for IE8 because the anchor loses its",
        "// Line_Reference 75:   // IE9 adds the port to the host property unlike everyone else. If",
        "// Line_Reference 89:   if (addToBody) {",
        "// Line_Reference 90:     document.body.removeChild(div);"
    ]
}
