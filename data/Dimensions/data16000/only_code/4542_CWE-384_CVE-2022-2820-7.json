* @version 2.0.0-pr13
$user = Session::get($this->_sessionName);
if ($this->find($user, $field)) {
$user = Session::get($this->_admSessionName);
if ($user == $this->data()->id && $this->find($user, $field)) {
$data = $this->_db->get('users', [$field, $value]);
* @param string $method What column to check for their details in. Can be either `username` or `email`.
if (!$username && !$password && $this->exists()) {
Session::put($sessionName, $this->data()->id);
Session::put($sessionName, $this->data()->id);
if ($remember) {
$hash = SecureRandom::alphanumeric();
$table = $is_admin ? 'users_admin_session' : 'users_session';
$hashCheck = $this->_db->get($table, ['user_id', $this->data()->id]);
if (!$hashCheck->count()) {
$this->_db->insert($table, [
'user_id' => $this->data()->id,
'hash' => $hash
]);
} else {
$hash = $hashCheck->first()->hash;
}
$this->_db->delete('users_session', ['user_id', $this->data()->id]);
$this->_db->delete('users_admin_session', ['user_id', $this->data()->id]);
