TF_RETURN_IF_ERROR(wrap_kernel_call(ComputeEmptyRowIndicatorKernel<Tindex>,
/*device=*/device, /*size=*/dense_rows,
elements_per_row, empty_row_indicator));
OP_REQUIRES_OK_ASYNC(
context,
wrap_kernel_call(ScatterNewElementsKernel<T, Tindex>,
/*device=*/device, /*size=*/dense_rows, rank,
default_value, num_empty_rows_through,
input_row_ends, empty_row_indicator, output_indices,
output_values),
done);
TF_RETURN_IF_ERROR(wrap_kernel_call(CopyRowIndicesKernel<Tindex>,
/*device=*/device, /*size=*/N, rank,
indices, row_indices));
TF_RETURN_IF_ERROR(wrap_kernel_call(
GatherOriginalGradValuesKernel<T, Tindex>, /*device=*/device,
/*size=*/N, reverse_index_map, grad_values, d_values, visited));