{
    "cve_id": "CVE-2022-24754",
    "cve_description": "PJSIP is a free and open source multimedia communication library written in C language. In versions prior to and including 2.12 PJSIP there is a stack-buffer overflow vulnerability which only impacts PJSIP users who accept hashed digest credentials (credentials with data_type `PJSIP_CRED_DATA_DIGEST`). This issue has been patched in the master branch of the PJSIP repository and will be included with the next release. Users unable to upgrade need to check that the hashed digest data length must be equal to `PJSIP_MD5STRLEN` before passing to PJSIP.",
    "cve_publish_date": "2022-03-11",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "Use PJ_ASSERT_RETURN() on pjsip_auth_create_digest() and pjsua_init_tpselector() (#3009)\n\n* Use PJ_ASSERT_RETURN on pjsip_auth_create_digest\r\n\r\n* Use PJ_ASSERT_RETURN on pjsua_init_tpselector()\r\n\r\n* Fix incorrect check.\r\n\r\n* Add return value to pjsip_auth_create_digest() and pjsip_auth_create_digestSHA256()\r\n\r\n* Modification based on comments.",
    "type_of_change": "Modification",
    "filename_of_changes": "sip_auth.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "39",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 588: PJ_DECL(void) pjsip_auth_create_digest(pj_str_t *result,",
        "// Line_Reference 589: \t\t\t\t       const pj_str_t *nonce,",
        "// Line_Reference 590: \t\t\t\t       const pj_str_t *nc,",
        "// Line_Reference 591: \t\t\t\t       const pj_str_t *cnonce,",
        "// Line_Reference 592: \t\t\t\t       const pj_str_t *qop,",
        "// Line_Reference 593: \t\t\t\t       const pj_str_t *uri,",
        "// Line_Reference 594: \t\t\t\t       const pj_str_t *realm,",
        "// Line_Reference 595: \t\t\t\t       const pjsip_cred_info *cred_info,",
        "// Line_Reference 596: \t\t\t\t       const pj_str_t *method);"
    ]
}
