{
    "cve_id": "CVE-2022-27008",
    "cve_description": "nginx njs 0.7.2 is vulnerable to Buffer Overflow. Type confused in Array.prototype.concat() when a slow array appended element is fast array.",
    "cve_publish_date": "2022-04-14",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "Fixed Array.prototype.concat() when \"this\" is a slow array.\n\nPreviously, when the current appended element is fast array the \"this\"\narray was expected to always be a fast array also.  This may not be the\ncase when the previous appended element was not fast thus converting\nthe \"this\" array to a slow form.\n\nPrevious fix introduced in 2c1382bab643 (0.7.2) was not complete, the\ncorrect fix is to never assume \"this\" is fast, whereas njs_array_add()\nmay only be called with fast arrays.\n\nThis closes #471 issue in Github.",
    "type_of_change": "Modification",
    "filename_of_changes": "njs_array.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 1757:                     ret = njs_array_add(vm, array, &retval);",
        "// Line_Reference 1758:                     if (njs_slow_path(ret != NJS_OK)) {",
        "// Line_Reference 1759:                         return NJS_ERROR;"
    ]
}
