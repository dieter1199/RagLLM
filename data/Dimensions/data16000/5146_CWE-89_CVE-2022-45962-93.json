{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "ParentProgressReports.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "44",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 120:                                                         AND s.COURSE_ID = cp.COURSE_ID AND ga.assignment_id = g.assignment_id AND ga.marking_period_id in (' . GetAllMP($MP_TYPE, UserMP()) . ')  and  g.STUDENT_ID=\\'' . $student[STUDENT_ID] . '\\' and s.syear=\\'' . UserSyear() . '\\' group by cp.COURSE_PERIOD_ID'));",
        "// Line_Reference 200:                     if (count($percent_weights)) {",
        "// Line_Reference 215:                         $tot_weight_grade = '';",
        "// Line_Reference 237:                                 if ($tot_weight_grade == '')",
        "// Line_Reference 245:                     $tot_weight_grade = ($tot_weight_grade / $total_weightage) * 100;",
        "// Line_Reference 247:                     $link['add']['html'] = array('TITLE' => '<font style=\"font-size:13;font-weight:bold;\"><B>' . _total . '</B></font>', 'POINTS' => '<font style=\"font-size:13;font-weight:bold;\">' . $total_stpoints . ' / ' . $total_asgnpoints . '</font>', 'LETTER_GRADE' => '<font style=\"font-size:13;font-weight:bold;\">' . _makeLetterGrade(($total_stpoints / $total_asgnpoints), $course_period_id, $course['TEACHER_ID'], \"%\") . '%&nbsp;' . _makeLetterGrade(($total_stpoints / $total_asgnpoints), $course_period_id, $course['TEACHER_ID']) . '</font>', 'WEIGHT_GRADE' => '<font style=\"font-size:13;font-weight:bold;\">' . ($program_config[$course['TEACHER_ID']][$course_period_id]['WEIGHT'] == 'Y' ? _makeLetterGrade($tot_weight_grade, \"\", $course['TEACHER_ID'], '%') . '%&nbsp;' . _makeLetterGrade($tot_weight_grade, $course_period_id, $course['TEACHER_ID']) : 'N/A') . '</font>');",
        "// Line_Reference 257:                         echo '<tr><td> ' . _total . ':</td><td>' . _makeLetterGrade(($total_stpoints / $total_asgnpoints), $course_period_id, $course['TEACHER_ID'], \"%\") . '%&nbsp;' . _makeLetterGrade(($total_stpoints / $total_asgnpoints), $course_period_id, $course['TEACHER_ID']) . '</td> </tr>';",
        "// Line_Reference 278:     echo \"<FORM action=ForExport.php?modname=\" . strip_tags(trim($_REQUEST[modname])) . \"&modfunc=save&include_inactive=\" . strip_tags(trim($_REQUEST[include_inactive])) . \"&_openSIS_PDF=true method=POST target=_blank>\";",
        "// Line_Reference 285:     echo '<div class=\"form-group\"><div class=\"checkbox checkbox-switch switch-success switch-xs\"><label><INPUT type=checkbox value=Y name=assigned_date><span></span>' . _assignedDate . '</label></div></div>';",
        "// Line_Reference 294:     echo '<div class=\"form-group\"><div class=\"checkbox checkbox-switch switch-success switch-xs\"><label><INPUT type=checkbox value=Y name=due_date checked><span></span>' . _dueDate . '</label></div></div>';",
        "// Line_Reference 303:     echo '<div class=\"form-group\"><div class=\"radio\"><label><INPUT class=\"styled\" type=radio value=detail name=list_type checked=true>' . _withAssignmentDetails . '</label></div></div>';",
        "// Line_Reference 306:     echo '<div class=\"form-group\"><div class=\"radio\"><label><INPUT class=\"styled\" type=radio value=total name=list_type>' . _totalsOnly . '</label></div></div>';",
        "// Line_Reference 327:                 return '<TABLE border=0 cellspacing=0 cellpadding=0 class=LO_field><TR><TD><font size=-1>' . (rtrim(rtrim($value, '0'), '.') + 0) . '</font></TD><TD><font size=-1>&nbsp;/&nbsp;</font></TD><TD><font size=-1>' . $THIS_RET['TOTAL_POINTS'] . '</font></TD></TR></TABLE>';",
        "// Line_Reference 332:             return '<TABLE border=0 cellspacing=0 cellpadding=0 class=LO_field><TR><TD><font size=-1>' . (rtrim(rtrim($value, '0'), '.') + 0) . '</font></TD><TD><font size=-1>&nbsp;/&nbsp;</font></TD><TD><font size=-1>' . $THIS_RET['TOTAL_POINTS'] . '</font></TD></TR></TABLE>';"
    ]
}
