{
    "cve_id": "CVE-2018-6412",
    "cve_description": "In the function sbusfb_ioctl_helper() in drivers/video/fbdev/sbuslib.c in the Linux kernel through 4.15, an integer signedness error allows arbitrary information leakage for the FBIOPUTCMAP_SPARC and FBIOGETCMAP_SPARC commands.",
    "cve_publish_date": "2018-01-31",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "fbdev: Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in sbusfb_ioctl_helper().\n\nFixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in\nsbusfb_ioctl_helper().\n\n'index' is defined as an int in sbusfb_ioctl_helper().\nWe retrieve this from the user:\nif (get_user(index, &c->index) ||\n    __get_user(count, &c->count) ||\n    __get_user(ured, &c->red) ||\n    __get_user(ugreen, &c->green) ||\n    __get_user(ublue, &c->blue))\n       return -EFAULT;\n\nand then we use 'index' in the following way:\nred = cmap->red[index + i] >> 8;\ngreen = cmap->green[index + i] >> 8;\nblue = cmap->blue[index + i] >> 8;\n\nThis is a classic information leak vulnerability. 'index' should be\nan unsigned int, given its usage above.\n\nThis patch is straight-forward; it changes 'index' to unsigned int\nin two switch-cases: FBIOGETCMAP_SPARC && FBIOPUTCMAP_SPARC.\n\nThis patch fixes CVE-2018-6412.\n\nSigned-off-by: Peter Malone <peter.malone@gmail.com>\nAcked-by: Mathieu Malaterre <malat@debian.org>\nSigned-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "sbuslib.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 125: \t\tint index, count, i;",
        "// Line_Reference 164: \t\tint index, count, i;"
    ]
}
