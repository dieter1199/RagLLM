{
    "cve_id": "CVE-2016-5768",
    "cve_description": "Double free vulnerability in the _php_mb_regex_ereg_replace_exec function in php_mbregex.c in the mbstring extension in PHP before 5.5.37, 5.6.x before 5.6.23, and 7.x before 7.0.8 allows remote attackers to execute arbitrary code or cause a denial of service (application crash) by leveraging a callback exception.",
    "cve_publish_date": "2016-08-07",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "Fix bug #72402: _php_mb_regex_ereg_replace_exec - double free",
    "type_of_change": "Modification",
    "filename_of_changes": "php_mbregex.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "33",
    "vulnerable_lines": [
        "// Line_Reference 35: ",
        "// Line_Reference 58: static void php_mb_regex_free_cache(php_mb_regex_t **pre)",
        "// Line_Reference 81: static void _php_mb_regex_globals_dtor(zend_mb_regex_globals *pglobals TSRMLS_DC)",
        "// Line_Reference 469: \treturn retval;",
        "// Line_Reference 486: \t\t++len_req;",
        "// Line_Reference 494: \t\t++len_req;",
        "// Line_Reference 503: \t\t++len_req;",
        "// Line_Reference 510: \t\t\t++len_req;",
        "// Line_Reference 518: \t\t\t++len_req;",
        "// Line_Reference 520: \t}",
        "// Line_Reference 526: \t\t++len_req;",
        "// Line_Reference 533: \t\t++len_req;",
        "// Line_Reference 569: \t++len_req;",
        "// Line_Reference 580: _php_mb_regex_init_options(const char *parg, int narg, OnigOptionType *option, OnigSyntaxType **syntax, int *eval)",
        "// Line_Reference 584: \tint optm = 0;",
        "// Line_Reference 639: \t\t\t\t\tif (eval != NULL) *eval = 1;",
        "// Line_Reference 645: \t\tif (option != NULL) *option|=optm;",
        "// Line_Reference 863: \t\tpat_buf[0] = (char)Z_LVAL_PP(arg_pattern_zval);",
        "// Line_Reference 867: \t\targ_pattern_len = 1;",
        "// Line_Reference 937: ",
        "// Line_Reference 956: \t\t\t\tzval *retval_ptr;",
        "// Line_Reference 960: ",
        "// Line_Reference 963: ",
        "// Line_Reference 966: \t\t\t\t}",
        "// Line_Reference 967: ",
        "// Line_Reference 971: ",
        "// Line_Reference 975: \t\t\t\tif (zend_call_function(&arg_replace_fci, &arg_replace_fci_cache TSRMLS_CC) == SUCCESS && arg_replace_fci.retval_ptr_ptr) {",
        "// Line_Reference 981: \t\t\t\t\tefree(description);",
        "// Line_Reference 994: \t\t\t\t\tsmart_str_appendl(&out_buf, pos, 1);",
        "// Line_Reference 1016: \t\tsmart_str_free(&out_buf);",
        "// Line_Reference 1066: \t}",
        "// Line_Reference 1320: ",
        "// Line_Reference 1419: static void _php_mb_regex_set_options(OnigOptionType options, OnigSyntaxType *syntax, OnigOptionType *prev_options, OnigSyntaxType **prev_syntax TSRMLS_DC)"
    ]
}
