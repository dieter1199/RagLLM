{
    "cve_id": "CVE-2022-3232",
    "cve_description": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.5.",
    "cve_publish_date": "2022-09-17",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Mitigate CSRF on repository deletion and user deletion #214 #215",
    "type_of_change": "Modification",
    "filename_of_changes": "page_delete.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 27: from wtforms import validators",
        "// Line_Reference 41:     confirm = StringField(_('Confirmation'), validators=[validators.data_required()])",
        "// Line_Reference 42:     redirect = StringField(default='/')",
        "// Line_Reference 64:         if not form.validate():",
        "// Line_Reference 65:             raise cherrypy.HTTPError(400, form.error_message)",
        "// Line_Reference 66: ",
        "// Line_Reference 67:         # Validate the name",
        "// Line_Reference 68:         if form.confirm.data != path_obj.display_name:",
        "// Line_Reference 69:             _logger.info(\"do not delete repo, bad confirmation %r != %r\", form.confirm.data, path_obj.display_name)",
        "// Line_Reference 70:             raise cherrypy.HTTPError(400, 'bad confirmation')",
        "// Line_Reference 71: ",
        "// Line_Reference 72:         # Delete repository in background using a schedule task.",
        "// Line_Reference 73:         scheduled = cherrypy.engine.publish('schedule_task', repo.delete, path)",
        "// Line_Reference 74:         assert scheduled",
        "// Line_Reference 75:         raise cherrypy.HTTPRedirect(form.redirect.data)"
    ]
}
