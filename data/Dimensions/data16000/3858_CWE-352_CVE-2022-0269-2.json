{
    "cve_id": "CVE-2022-0269",
    "cve_description": "Cross-Site Request Forgery (CSRF) in Packagist yetiforce/yetiforce-crm prior to 6.3.0.",
    "cve_publish_date": "2022-01-24",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Improved CSRF protection",
    "type_of_change": "Modification",
    "filename_of_changes": "Base.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 21: \t/**",
        "// Line_Reference 22: \t * CSRF is active?.",
        "// Line_Reference 23: \t *",
        "// Line_Reference 24: \t * @var bool",
        "// Line_Reference 25: \t */",
        "// Line_Reference 26: \tpublic $csrfActive = true;",
        "// Line_Reference 34: \t/**",
        "// Line_Reference 35: \t * Activated csrf.",
        "// Line_Reference 36: \t *",
        "// Line_Reference 37: \t * @var bool",
        "// Line_Reference 38: \t */",
        "// Line_Reference 39: \tprotected static $activatedCsrf = false;",
        "// Line_Reference 51: \t\tif (!self::$activatedCsrf) {",
        "// Line_Reference 52: \t\t\tif ($this->csrfActive && \\App\\Config::security('csrfActive')) {",
        "// Line_Reference 53: \t\t\t\trequire_once 'config/csrf_config.php';",
        "// Line_Reference 54: \t\t\t\t\\CsrfMagic\\Csrf::init();",
        "// Line_Reference 55: \t\t\t\t$this->csrfActive = true;",
        "// Line_Reference 56: \t\t\t} else {",
        "// Line_Reference 57: \t\t\t\t$this->csrfActive = false;",
        "// Line_Reference 58: \t\t\t}",
        "// Line_Reference 59: \t\t\tself::$activatedCsrf = true;"
    ]
}
