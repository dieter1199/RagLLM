{
    "cve_id": "CVE-2022-46171",
    "cve_description": "Tauri is a framework for building binaries for all major desktop platforms. The filesystem glob pattern wildcards `*`, `?`, and `[...]` match file path literals and leading dots by default, which unintentionally exposes sub folder content of allowed paths. Scopes without the wildcards are not affected. As `**` allows for sub directories the behavior there is also as expected. The issue has been patched in the latest release and was backported into the currently supported 1.x branches. There are no known workarounds at the time of publication.",
    "cve_publish_date": "2022-12-23",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Merge pull request from GHSA-6mv3-wm7j-h4w5\n\n* fix(core): use `require_literal_separator` when matching paths\n\n* document the need for `require_literal_separator`\n\n* use `require_literal_leading_dot`",
    "type_of_change": "Modification",
    "filename_of_changes": "fs.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "98",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 144:   /// the directory and all of its files and subdirectories.",
        "// Line_Reference 225:         .any(|p| p.matches_path(&path));",
        "// Line_Reference 235:           .any(|p| p.matches_path(&path));",
        "// Line_Reference 272:     scope.allow_directory(\"/home/tauri/**\", false).unwrap();",
        "// Line_Reference 273:     assert!(scope.is_allowed(\"/home/tauri/**\"));",
        "// Line_Reference 274:     assert!(scope.is_allowed(\"/home/tauri/**/file\"));",
        "// Line_Reference 275:     assert!(!scope.is_allowed(\"/home/tauri/anyfile\"));",
        "// Line_Reference 278:     scope.allow_file(\"/home/tauri/**\").unwrap();",
        "// Line_Reference 279:     assert!(scope.is_allowed(\"/home/tauri/**\"));",
        "// Line_Reference 280:     assert!(!scope.is_allowed(\"/home/tauri/**/file\"));",
        "// Line_Reference 281:     assert!(!scope.is_allowed(\"/home/tauri/anyfile\"));",
        "// Line_Reference 284:     scope.allow_directory(\"/home/tauri\", true).unwrap();",
        "// Line_Reference 285:     scope.forbid_directory(\"/home/tauri/**\", false).unwrap();",
        "// Line_Reference 286:     assert!(!scope.is_allowed(\"/home/tauri/**\"));",
        "// Line_Reference 287:     assert!(!scope.is_allowed(\"/home/tauri/**/file\"));",
        "// Line_Reference 288:     assert!(!scope.is_allowed(\"/home/tauri/**/inner/file\"));",
        "// Line_Reference 289:     assert!(scope.is_allowed(\"/home/tauri/inner/folder/anyfile\"));",
        "// Line_Reference 290:     assert!(scope.is_allowed(\"/home/tauri/anyfile\"));",
        "// Line_Reference 293:     scope.allow_directory(\"/home/tauri\", true).unwrap();",
        "// Line_Reference 294:     scope.forbid_file(\"/home/tauri/**\").unwrap();",
        "// Line_Reference 295:     assert!(!scope.is_allowed(\"/home/tauri/**\"));",
        "// Line_Reference 296:     assert!(scope.is_allowed(\"/home/tauri/**/file\"));",
        "// Line_Reference 297:     assert!(scope.is_allowed(\"/home/tauri/**/inner/file\"));",
        "// Line_Reference 298:     assert!(scope.is_allowed(\"/home/tauri/anyfile\"));"
    ]
}
