{
    "cve_id": "CVE-2016-8687",
    "cve_description": "Stack-based buffer overflow in the safe_fprintf function in tar/util.c in libarchive 3.2.1 allows remote attackers to cause a denial of service via a crafted non-printable multibyte character in a filename.",
    "cve_publish_date": "2017-02-15",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Issue #767:  Buffer overflow printing a filename\n\nThe safe_fprintf function attempts to ensure clean output for an\narbitrary sequence of bytes by doing a trial conversion of the\nmultibyte characters to wide characters -- if the resulting wide\ncharacter is printable then we pass through the corresponding bytes\nunaltered, otherwise, we convert them to C-style ASCII escapes.\n\nThe stack trace in Issue #767 suggest that the 20-byte buffer\nwas getting overflowed trying to format a non-printable multibyte\ncharacter.  This should only happen if there is a valid multibyte\ncharacter of more than 5 bytes that was unprintable.  (Each byte\nwould get expanded to a four-charcter octal-style escape of the form\n\"\\123\" resulting in >20 characters for the >5 byte multibyte character.)\n\nI've not been able to reproduce this, but have expanded the conversion\nbuffer to 128 bytes on the belief that no multibyte character set\nhas a single character of more than 32 bytes.",
    "type_of_change": "Modification",
    "filename_of_changes": "util.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 185: \t\tif (i > (sizeof(outbuff) - 20)) {"
    ]
}
