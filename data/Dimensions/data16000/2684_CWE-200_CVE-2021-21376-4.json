{
    "cve_id": "CVE-2021-21376",
    "cve_description": "OMERO.web is open source Django-based software for managing microscopy imaging. OMERO.web before version 5.9.0 loads various information about the current user such as their id, name and the groups they are in, and these are available on the main webclient pages. This represents an information exposure vulnerability. Some additional information being loaded is not used by the webclient and is being removed in this release. This is fixed in version 5.9.0.",
    "cve_publish_date": "2021-03-23",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "SV commits",
    "type_of_change": "Modification",
    "filename_of_changes": "views.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "42",
    "vulnerable_lines": [
        "// Line_Reference 70: from .forms import ShareForm, BasketShareForm",
        "// Line_Reference 2874:     elif action == \"add\":",
        "// Line_Reference 2875:         template = \"webclient/public/share_form.html\"",
        "// Line_Reference 2876:         experimenters = list(conn.getExperimenters())",
        "// Line_Reference 2877:         experimenters.sort(key=lambda x: x.getOmeName().lower())",
        "// Line_Reference 2878:         if o_type == \"share\":",
        "// Line_Reference 2879:             img_ids = request.GET.getlist(\"image\", request.POST.getlist(\"image\"))",
        "// Line_Reference 2880:             if request.method == \"GET\" and len(img_ids) == 0:",
        "// Line_Reference 2881:                 return HttpResponse(\"No images specified\")",
        "// Line_Reference 2882:             images_to_share = list(conn.getObjects(\"Image\", img_ids))",
        "// Line_Reference 2883:             if request.method == \"POST\":",
        "// Line_Reference 2884:                 form = BasketShareForm(",
        "// Line_Reference 2885:                     initial={\"experimenters\": experimenters, \"images\": images_to_share},",
        "// Line_Reference 2886:                     data=request.POST.copy(),",
        "// Line_Reference 2887:                 )",
        "// Line_Reference 2888:                 if form.is_valid():",
        "// Line_Reference 2889:                     images = form.cleaned_data[\"image\"]",
        "// Line_Reference 2890:                     message = form.cleaned_data[\"message\"]",
        "// Line_Reference 2891:                     expiration = form.cleaned_data[\"expiration\"]",
        "// Line_Reference 2892:                     members = form.cleaned_data[\"members\"]",
        "// Line_Reference 2893:                     # guests = request.POST['guests']",
        "// Line_Reference 2894:                     enable = form.cleaned_data[\"enable\"]",
        "// Line_Reference 2895:                     host = \"%s?server=%i\" % (",
        "// Line_Reference 2896:                         request.build_absolute_uri(",
        "// Line_Reference 2897:                             reverse(\"load_template\", args=[\"public\"])",
        "// Line_Reference 2898:                         ),",
        "// Line_Reference 2899:                         int(conn.server_id),",
        "// Line_Reference 2900:                     )",
        "// Line_Reference 2901:                     shareId = manager.createShare(",
        "// Line_Reference 2902:                         host, images, message, members, enable, expiration",
        "// Line_Reference 2903:                     )",
        "// Line_Reference 2904:                     return HttpResponse(\"shareId:%s\" % shareId)",
        "// Line_Reference 2905:             else:",
        "// Line_Reference 2906:                 initial = {",
        "// Line_Reference 2907:                     \"experimenters\": experimenters,",
        "// Line_Reference 2908:                     \"images\": images_to_share,",
        "// Line_Reference 2909:                     \"enable\": True,",
        "// Line_Reference 2910:                     \"selected\": request.GET.getlist(\"image\"),",
        "// Line_Reference 2911:                 }",
        "// Line_Reference 2912:                 form = BasketShareForm(initial=initial)",
        "// Line_Reference 2913:         template = \"webclient/public/share_form.html\"",
        "// Line_Reference 2914:         context = {\"manager\": manager, \"form\": form}"
    ]
}
