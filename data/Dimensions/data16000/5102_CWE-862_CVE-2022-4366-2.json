{
    "cve_id": "CVE-2022-4366",
    "cve_description": "Missing Authorization in GitHub repository lirantal/daloradius prior to master branch.",
    "cve_publish_date": "2022-12-08",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: introduced security fixes (#263)\n\n- dologin.php - validating user input and introduced CSRF token check\r\n- logging.php - preventing direct access to this file, which means redirecting to index.php when directly hitting this include file, (repeated for other exten. / include / etc. files), and optimized logging features\r\n- actionMessages.php and errorHandling.php same as logging.php\r\n- library/exten-* files - preventing direct access to these files, generalized the approach of looking for known file locations, improved user input validation (params such as limit, etc.), improved output (escaping logfile output, etc.)\r\n- in library/exten-server_info.php - i also have added new commands for retrieving network information and system distro/version\r\n- opendb.php - general code optimization (TODO prevent direct access to this file)\r\n- sessions.php - introduced new session handling (TODO prevent direct access to this file)\r\n- login.php - removed the default username hardcoded in the form, added the csrf_token\r\n- rep-* - user input validation, code optimization",
    "type_of_change": "Modification",
    "filename_of_changes": "errorHandling.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 17:  * Description:",
        "// Line_Reference 18:  *\t\tglobal error handling for all PEAR packages, it isn't too wise to do",
        "// Line_Reference 19:  *\t\tthat as I've no idea what other php applications are running on this machine",
        "// Line_Reference 20:  *\t\teven though this is really just about handling the error but still.",
        "// Line_Reference 21:  *\t\tSo instead we're using the object's error handling method (see library/opendb.php)",
        "// Line_Reference 22:  *\t\tPEAR::setErrorHandling(PEAR_ERROR_CALLBACK, 'errorHandler');",
        "// Line_Reference 24:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 31: \techo(\"<br/><b>Database error</b><br>",
        "// Line_Reference 32: \t\t<b>Error Message: </b>\" . $err->getMessage() . \"<br><b>Debug info: </b>\" . $err->getDebugInfo() . \"<br>\");"
    ]
}
