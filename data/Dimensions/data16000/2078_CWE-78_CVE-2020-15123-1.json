{
    "cve_id": "CVE-2020-15123",
    "cve_description": "In codecov (npm package) before version 3.7.1 the upload method has a command injection vulnerability. Clients of the codecov-node library are unlikely to be aware of this, so they might unwittingly write code that contains a vulnerability. A similar CVE (CVE-2020-7597 for GHSA-5q88-cjfq-g2mh) was issued but the fix was incomplete. It only blocked &, and command injection is still possible using backticks instead to bypass the sanitizer. The attack surface is low in this case. Particularly in the standard use of codecov, where the module is used directly in a build pipeline, not built against as a library in another application that may supply malicious input and perform command injection.",
    "cve_publish_date": "2020-07-20",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Switch from execSync to execFileSync (#180)\n\n* Switch from execSync to execFileSync\r\n\r\n* Call existsSync instead of executing `if`\r\n\r\n* Trigger a build\r\n\r\n* I think this fixes linux and macos...\r\n\r\n* Only add more_patterns of it has a value. Correct windows.\r\n\r\n* Remove default value to more_patterns, change windows to winPatterns\r\n\r\n* Try a colon.\r\n\r\n* Let's try not using MinGw...\r\n\r\n* What are the chances that Windows has a find?\r\n\r\n* Put it back\r\n\r\n* Reverting Windows side so this can me merged in time if needed.\r\n\r\n* Reverting Windows side so this can me merged in time if needed.\r\n\r\n* Update lib/codecov.js\r\n\r\nCo-authored-by: Guillaume St-Pierre <guillaume@codecov.io>\r\n\r\n* Update lib/codecov.js\r\n\r\nCo-authored-by: Guillaume St-Pierre <guillaume@codecov.io>\r\n\r\n* Set initial values\r\n\r\nCo-authored-by: Guillaume St-Pierre <guillaume@codecov.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "codecov.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 13: var patterns,",
        "// Line_Reference 14:   more_patterns = ''",
        "// Line_Reference 20:   patterns =",
        "// Line_Reference 21:     \"-type f \\\\( -name '*coverage.*' \" +",
        "// Line_Reference 32:     \"-or -name '*.lst' \\\\) \" +",
        "// Line_Reference 80:   patterns =",
        "// Line_Reference 81:     '/a-d /b /s *coverage.* ' +",
        "// Line_Reference 358:       execSync('git ls-files || hg locate', { cwd: root })",
        "// Line_Reference 417:       execSync(gcov)",
        "// Line_Reference 434:     bowerrc = execSync('if exist .bowerrc type .bowerrc', { cwd: root })",
        "// Line_Reference 435:       .toString()",
        "// Line_Reference 436:       .trim()",
        "// Line_Reference 442:         more_patterns =",
        "// Line_Reference 443:           \" -not -path '*/\" + bowerrc.toString().replace(/\\/$/, '') + \"/*'\"",
        "// Line_Reference 445:         more_patterns =",
        "// Line_Reference 446:           '| findstr /i /v \\\\' + bowerrc.toString().replace(/\\/$/, '') + '\\\\'",
        "// Line_Reference 478:       _files = execSync('find ' + root + ' ' + patterns + more_patterns)",
        "// Line_Reference 485:       _files = execSync('dir ' + patterns + more_patterns)"
    ]
}
