{
    "cve_id": "CVE-2022-3363",
    "cve_description": "Business Logic Errors in GitHub repository ikus060/rdiffweb prior to 2.5.0a7.",
    "cve_publish_date": "2022-10-26",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Send email notification when enabling or disabling MFA",
    "type_of_change": "Modification",
    "filename_of_changes": "notification.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 81:         if 'email' not in attrs:",
        "// Line_Reference 82:             return",
        "// Line_Reference 83: ",
        "// Line_Reference 84:         old_email = attrs['email'][0]",
        "// Line_Reference 85:         if not old_email:",
        "// Line_Reference 86:             logger.info(\"can't sent mail to user [%s] without an email\", userobj.username)",
        "// Line_Reference 87:             return",
        "// Line_Reference 88: ",
        "// Line_Reference 89:         # If the email attributes was changed, send a mail notification.",
        "// Line_Reference 90:         body = self.app.templates.compile_template(",
        "// Line_Reference 91:             \"email_changed.html\", **{\"header_name\": self.app.cfg.header_name, 'user': userobj}",
        "// Line_Reference 92:         )",
        "// Line_Reference 93:         self.bus.publish('queue_mail', to=old_email, subject=_(\"Email address changed\"), message=body)"
    ]
}
