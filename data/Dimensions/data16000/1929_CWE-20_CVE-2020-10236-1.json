{
    "cve_id": "CVE-2020-10236",
    "cve_description": "An issue was discovered in Froxlor before 0.10.14. It created files with static names in /tmp during installation if the installation directory was not writable. This allowed local attackers to cause DoS or disclose information out of the config files, because of _createUserdataConf in install/lib/class.FroxlorInstall.php.",
    "cve_publish_date": "2020-03-09",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "use unpredictable tmpfile-name in installation if lib/userdata.inc.php cannot be written due to permission\n\nSigned-off-by: Michael Kaufmann <d00p@froxlor.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "class.FroxlorInstall.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 341: \t\t} elseif ($fp = @fopen('/tmp/userdata.inc.php', 'w')) {",
        "// Line_Reference 342: \t\t\t$result = @fputs($fp, $userdata, strlen($userdata));",
        "// Line_Reference 343: \t\t\t@fclose($fp);",
        "// Line_Reference 344: \t\t\t$content .= $this->_status_message('orange', $this->_lng['install']['creating_configfile_temp']);",
        "// Line_Reference 345: \t\t\tchmod('/tmp/userdata.inc.php', 0440);",
        "// Line_Reference 347: \t\t\t$content .= $this->_status_message('red', $this->_lng['install']['creating_configfile_failed']);",
        "// Line_Reference 348: \t\t\t$escpduserdata = nl2br(htmlspecialchars($userdata));",
        "// Line_Reference 349: \t\t\teval(\"\\$content .= \\\"\" . $this->_getTemplate(\"textarea\") . \"\\\";\");"
    ]
}
