{
    "cve_id": "CVE-2020-12135",
    "cve_description": "bson before 0.8 incorrectly uses int rather than size_t for many variables, parameters, and return values. In particular, the bson_ensure_space() parameter bytesNeeded could have an integer overflow via properly constructed bson input.",
    "cve_publish_date": "2020-04-24",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "don't mix up int and size_t (first pass to fix that)",
    "type_of_change": "Modification",
    "filename_of_changes": "env.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 41: int mongo_env_write_socket( mongo *conn, const void *buf, int len ) {",
        "// Line_Reference 46:         int sent = send( conn->sock, cbuf, len, flags );",
        "// Line_Reference 59: int mongo_env_read_socket( mongo *conn, void *buf, int len ) {",
        "// Line_Reference 63:         int sent = recv( conn->sock, cbuf, len, 0 );",
        "// Line_Reference 228: int mongo_env_write_socket( mongo *conn, const void *buf, int len ) {",
        "// Line_Reference 237:         int sent = send( conn->sock, cbuf, len, flags );",
        "// Line_Reference 251: int mongo_env_read_socket( mongo *conn, void *buf, int len ) {",
        "// Line_Reference 254:         int sent = recv( conn->sock, cbuf, len, 0 );",
        "// Line_Reference 446: int mongo_env_write_socket( mongo *conn, const void *buf, int len ) {",
        "// Line_Reference 459:         int sent = send( conn->sock, cbuf, len, flags );",
        "// Line_Reference 473: int mongo_env_read_socket( mongo *conn, void *buf, int len ) {",
        "// Line_Reference 476:         int sent = recv( conn->sock, cbuf, len, 0 );"
    ]
}
