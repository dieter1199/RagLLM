{
    "cve_id": "CVE-2020-35538",
    "cve_description": "A crafted input file could cause a null pointer dereference in jcopy_sample_rows() when processed by libjpeg-turbo.",
    "cve_publish_date": "2022-08-31",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix jpeg_skip_scanlines() segfault w/merged upsamp\n\nThe additional segfault mentioned in #244 was due to the fact that\nthe merged upsamplers use a different private structure than the\nnon-merged upsamplers.  jpeg_skip_scanlines() was assuming the latter, so\nwhen merged upsampling was enabled, jpeg_skip_scanlines() clobbered one\nof the IDCT method pointers in the merged upsampler's private structure.\n\nFor reasons unknown, the test image in #441 did not encounter this\nsegfault (too small?), but it encountered an issue similar to the one\nfixed in 5bc43c7821df982f65aa1c738f67fbf7cba8bd69, whereby it was\nnecessary to set up a dummy postprocessing function in\nread_and_discard_scanlines() when merged upsampling was enabled.\nFailing to do so caused either a segfault in merged_2v_upsample() (due\nto a NULL pointer being passed to jcopy_sample_rows()) or an error\n(\"Corrupt JPEG data: premature end of data segment\"), depending on the\nnumber of scanlines skipped and whether the first scanline skipped was\nan odd- or even-numbered row.\n\nFixes #441\nFixes #244 (for real this time)",
    "type_of_change": "Modification",
    "filename_of_changes": "jdmrg565.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 8:  * Copyright (C) 2014-2015, 2018, D. R. Commander.",
        "// Line_Reference 22:   my_upsample_ptr upsample = (my_upsample_ptr)cinfo->upsample;",
        "// Line_Reference 93:   my_upsample_ptr upsample = (my_upsample_ptr)cinfo->upsample;",
        "// Line_Reference 166:   my_upsample_ptr upsample = (my_upsample_ptr)cinfo->upsample;",
        "// Line_Reference 262:   my_upsample_ptr upsample = (my_upsample_ptr)cinfo->upsample;"
    ]
}
