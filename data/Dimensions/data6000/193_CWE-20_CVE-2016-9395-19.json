{
    "cve_id": "CVE-2016-9395",
    "cve_description": "The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.",
    "cve_publish_date": "2017-03-23",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "The generation of the configuration file jas_config.h has been completely\nreworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.",
    "type_of_change": "Modification",
    "filename_of_changes": "jpg_dec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 130: *",
        "// Line_Reference 133: typedef struct {",
        "// Line_Reference 134: \tsize_t max_size;",
        "// Line_Reference 135: } jpg_dec_importopts_t;",
        "// Line_Reference 136: ",
        "// Line_Reference 137: typedef enum {",
        "// Line_Reference 138: \tOPT_MAXSIZE,",
        "// Line_Reference 139: } optid_t;",
        "// Line_Reference 140: ",
        "// Line_Reference 142: \t{OPT_MAXSIZE, \"max_size\"},",
        "// Line_Reference 150: \topts->max_size = 0;",
        "// Line_Reference 160: \t\t\topts->max_size = atoi(jas_tvparser_getval(tvp));",
        "// Line_Reference 191: \tsize_t size;",
        "// Line_Reference 248: \tif (opts.max_size) {",
        "// Line_Reference 249: \t\tif (!jas_safe_size_mul(cinfo.output_width, cinfo.output_height,",
        "// Line_Reference 250: \t\t  &size) ||",
        "// Line_Reference 251: \t\t  !jas_safe_size_mul(size, cinfo.output_components, &size)) {",
        "// Line_Reference 252: \t\t\tgoto error;",
        "// Line_Reference 253: \t\t}",
        "// Line_Reference 254: \t\tif (size > opts.max_size) {",
        "// Line_Reference 255: \t\t\tjas_eprintf(\"image is too large\\n\");",
        "// Line_Reference 256: \t\t\tgoto error;",
        "// Line_Reference 257: \t\t}",
        "// Line_Reference 258: \t}",
        "// Line_Reference 259: "
    ]
}
