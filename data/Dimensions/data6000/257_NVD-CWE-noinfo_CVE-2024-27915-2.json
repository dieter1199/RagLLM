{
    "cve_id": "CVE-2024-27915",
    "cve_description": "Sulu is a PHP content management system. Starting in verson 2.2.0 and prior to version 2.4.17 and 2.5.13, access to pages is granted regardless of role permissions for webspaces which have a security system configured and permission check enabled. Webspaces without do not have this issue. The problem is patched in versions 2.4.17 and 2.5.13. Some workarounds are available. One may apply the patch to `vendor/symfony/security-http/HttpUtils.php` manually or avoid installing `symfony/security-http` versions greater equal than `v5.4.30` or `v6.3.6`.",
    "cve_publish_date": "2024-03-06",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Merge pull request from GHSA-jr83-m233-gg6p\n\n* Fix setting of Webspace Security System before Symfony RouteListener\n\n* Fix Redirect for Security System checker error\n\n* Add test case to avoid regression\n\n* Add test for none secured pages\n\n* Fix some PHP 7.2 issues\n\n* Remmove website based system listener test\n\n* Activate security only for specific test\n\n* Remove old ContentRouteProviderTests\n\n* Fix phpcs\n\n* Skip security listener test for older symfony security system\n\n* Fix code style\n\n* Fix phpstan issues\n\n* Throw deprecation when requestAnalyzer is still given\n\n* Fix code style\n\n* Mark new service as internal and final",
    "type_of_change": "Modification",
    "filename_of_changes": "SystemListener.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 30:      * @var RequestAnalyzerInterface",
        "// Line_Reference 41:         RequestAnalyzerInterface $requestAnalyzer,",
        "// Line_Reference 61: ",
        "// Line_Reference 62:         $webspace = $this->requestAnalyzer->getWebspace();",
        "// Line_Reference 63:         if ($webspace) {",
        "// Line_Reference 64:             $security = $webspace->getSecurity();",
        "// Line_Reference 65:             if ($security) {",
        "// Line_Reference 66:                 $this->systemStore->setSystem($security->getSystem());",
        "// Line_Reference 67: ",
        "// Line_Reference 68:                 return;",
        "// Line_Reference 69:             }",
        "// Line_Reference 70:         }"
    ]
}
