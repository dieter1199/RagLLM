{
    "cve_id": "CVE-2020-7660",
    "cve_description": "serialize-javascript prior to 3.1.0 allows remote attackers to inject arbitrary code via the function \"deleteFunctions\" within \"index.js\".",
    "cve_publish_date": "2020-06-01",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "Don't replace regex / function placeholders within string literals (#79)\n\nPreviously we weren't checking if the quote that started the placeholder\r\nwas escaped or not, meaning an object like\r\n\r\n    {\"foo\": /1\"/, \"bar\": \"a\\\"@__R-<UID>-0__@\"}\r\n\r\nWould be serialized as\r\n\r\n    {\"foo\": /1\"/, \"bar\": \"a\\/1\"/}\r\n\r\nmeaning an attacker could escape out of `bar` if they controlled both\r\n`foo` and `bar` and were able to guess the value of `<UID>`.\r\n\r\nUID was generated once on startup, was chosen using `Math.random()` and\r\nhad a keyspace of roughly 4 billion, so within the realm of an online\r\nattack.\r\n\r\nHere's a simple example that will cause `console.log()` to be called when\r\nthe `serialize()`d version is `eval()`d\r\n\r\n    eval('('+ serialize({\"foo\": /1\" + console.log(1)/i, \"bar\": '\"@__R-<UID>-0__@'}) + ')');\r\n\r\nWhere `<UID>` is the guessed `UID`.\r\n\r\nThis fixes the issue by ensuring that placeholders are not preceded by\r\na backslash.\r\n\r\nWe also switch to a higher entropy `UID` to prevent people from guessing it.\r\n\r\nCo-authored-by: Jordan Milne <jmilne@uber.com>\r\nCo-authored-by: Ryan Siebert <ryan.siebert@energyaustralia.com.au>",
    "type_of_change": "Modification",
    "filename_of_changes": "package-lock.json",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 1652:       \"integrity\": \"sha512-Gd2UZBJDkXlY7GbJxfsE8/nvKkUEU1G38c1siN6QP6a9PT9MmHB8GnpscSmMJSoF8LOIrt8ud/wPtojys4G6+g==\",",
        "// Line_Reference 1653:       \"dev\": true"
    ]
}
