{
    "cve_id": "CVE-2018-16276",
    "cve_description": "An issue was discovered in yurex_read in drivers/usb/misc/yurex.c in the Linux kernel before 4.17.7. Local attackers could use user access read/writes with incorrect bounds checking in the yurex USB driver to crash the kernel or potentially escalate privileges.",
    "cve_publish_date": "2018-08-31",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "USB: yurex: fix out-of-bounds uaccess in read handler\n\nIn general, accessing userspace memory beyond the length of the supplied\nbuffer in VFS read/write handlers can lead to both kernel memory corruption\n(via kernel_read()/kernel_write(), which can e.g. be triggered via\nsys_splice()) and privilege escalation inside userspace.\n\nFix it by using simple_read_from_buffer() instead of custom logic.\n\nFixes: 6bc235a2e24a (\"USB: add driver for Meywa-Denki & Kayac YUREX\")\nSigned-off-by: Jann Horn <jannh@google.com>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "yurex.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 399: \tint retval = 0;",
        "// Line_Reference 400: \tint bytes_read = 0;",
        "// Line_Reference 408: \t\tretval = -ENODEV;",
        "// Line_Reference 409: \t\tgoto exit;",
        "// Line_Reference 413: \tbytes_read = snprintf(in_buffer, 20, \"%lld\\n\", dev->bbu);",
        "// Line_Reference 415: ",
        "// Line_Reference 416: \tif (*ppos < bytes_read) {",
        "// Line_Reference 417: \t\tif (copy_to_user(buffer, in_buffer + *ppos, bytes_read - *ppos))",
        "// Line_Reference 418: \t\t\tretval = -EFAULT;",
        "// Line_Reference 419: \t\telse {",
        "// Line_Reference 420: \t\t\tretval = bytes_read - *ppos;",
        "// Line_Reference 421: \t\t\t*ppos += bytes_read;",
        "// Line_Reference 422: \t\t}",
        "// Line_Reference 423: \t}",
        "// Line_Reference 424: ",
        "// Line_Reference 425: exit:",
        "// Line_Reference 427: \treturn retval;"
    ]
}
