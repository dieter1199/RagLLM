def write_varint(Py_ssize_t number, buf):
cdef Py_ssize_t i = 0
cdef unsigned char towrite
# Py_ssize_t checks integer on function call and
# raises OverflowError if integer overflows Py_ssize_t.
# Long enough for handling Py_ssize_t.
towrite = number & 0x7f
num_buf[i] = towrite | 0x80
num_buf[i] = towrite
cdef Py_ssize_t shift = 0
cdef Py_ssize_t result = 0
cdef unsigned char i