{
    "cve_id": "CVE-2021-25956",
    "cve_description": "In “Dolibarr” application, v3.3.beta1_20121221 to v13.0.2 have “Modify” access for admin level users to change other user’s details but fails to validate already existing “Login” name, while renaming the user “Login”. This leads to complete account takeover of the victim user. This happens since the password gets overwritten for the victim user having a similar login name.",
    "cve_publish_date": "2021-08-17",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "FIX Broken Access Control reported by Ahsan Aziz.",
    "type_of_change": "Modification",
    "filename_of_changes": "card.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 447: \t\t\t\tif (!empty($conf->multicompany->enabled)) {",
        "// Line_Reference 448: \t\t\t\t\tif (GETPOST(\"superadmin\")) {",
        "// Line_Reference 449: \t\t\t\t\t\t$object->entity = 0;",
        "// Line_Reference 450: \t\t\t\t\t} elseif (!empty($conf->global->MULTICOMPANY_TRANSVERSE_MODE)) {",
        "// Line_Reference 451: \t\t\t\t\t\t$object->entity = 1; // all users in master entity",
        "// Line_Reference 453: \t\t\t\t\t\t$object->entity = (!GETPOST('entity', 'int') ? 0 : GETPOST('entity', 'int'));",
        "// Line_Reference 455: \t\t\t\t} else {",
        "// Line_Reference 456: \t\t\t\t\t$object->entity = (!GETPOST('entity', 'int') ? 0 : GETPOST('entity', 'int'));"
    ]
}
