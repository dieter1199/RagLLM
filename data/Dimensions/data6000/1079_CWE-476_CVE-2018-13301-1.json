{
    "cve_id": "CVE-2018-13301",
    "cve_description": "In FFmpeg 4.0.1, due to a missing check of a profile value before setting it, the ff_mpeg4_decode_picture_header function in libavcodec/mpeg4videodec.c may trigger a NULL pointer dereference while converting a crafted AVI file to MPEG4, leading to a denial of service.",
    "cve_publish_date": "2018-07-05",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "avcodec/mpeg4videodec: Check read profile before setting it\n\nFixes: null pointer dereference\nFixes: ffmpeg_crash_7.avi\n\nFound-by: Thuan Pham, Marcel BÃ¶hme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "mpeg4videodec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1983: static int mpeg4_decode_profile_level(MpegEncContext *s, GetBitContext *gb)",
        "// Line_Reference 1986:     s->avctx->profile = get_bits(gb, 4);",
        "// Line_Reference 1987:     s->avctx->level   = get_bits(gb, 4);",
        "// Line_Reference 1990:     if (s->avctx->profile == 0 && s->avctx->level == 8) {",
        "// Line_Reference 1991:         s->avctx->level = 0;",
        "// Line_Reference 3214:             mpeg4_decode_profile_level(s, gb);",
        "// Line_Reference 3215:             if (s->avctx->profile == FF_PROFILE_MPEG4_SIMPLE_STUDIO &&",
        "// Line_Reference 3216:                 (s->avctx->level > 0 && s->avctx->level < 9)) {"
    ]
}
