{
    "cve_id": "CVE-2017-12190",
    "cve_description": "The bio_map_user_iov and bio_unmap_user functions in block/bio.c in the Linux kernel before 4.13.8 do unbalanced refcounting when a SCSI I/O vector has small consecutive buffers belonging to the same page. The bio_add_pc_page function merges them into one, but the page reference is never dropped. This causes a memory leak and possible system lockup (exploitable against the host OS by a guest OS user, if a SCSI disk is passed through to a virtual machine) due to an out-of-memory condition.",
    "cve_publish_date": "2017-11-22",
    "cwe_id": "CWE-400",
    "cwe_name": "Uncontrolled Resource Consumption",
    "cwe_description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
    "commit_message": "more bio_map_user_iov() leak fixes\n\nwe need to take care of failure exit as well - pages already\nin bio should be dropped by analogue of bio_unmap_pages(),\nsince their refcounts had been bumped only once per reference\nin bio.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "bio.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 1378: \t\tif (ret < local_nr_pages) {",
        "// Line_Reference 1434: \tfor (j = 0; j < nr_pages; j++) {",
        "// Line_Reference 1435: \t\tif (!pages[j])",
        "// Line_Reference 1436: \t\t\tbreak;",
        "// Line_Reference 1437: \t\tput_page(pages[j]);"
    ]
}
