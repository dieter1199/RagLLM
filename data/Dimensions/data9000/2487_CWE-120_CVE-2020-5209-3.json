{
    "cve_id": "CVE-2020-5209",
    "cve_description": "In NetHack before 3.6.5, unknown options starting with -de and -i can cause a buffer overflow resulting in a crash or remote code execution/privilege escalation. This vulnerability affects systems that have NetHack installed suid/sgid and shared systems that allow users to influence command line options. Users should upgrade to NetHack 3.6.5.",
    "cve_publish_date": "2020-01-28",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "command line triggered buffer overruns\n\nPrevent extremely long command line arguments from overflowing local\nbuffers in raw_printf or config_error_add.  The increased buffer\nsizes they recently got to deal with long configuration file values\naren't sufficient to handle command line induced overflows.\n\nchoose_windows(core): copy and truncate the window_type argument in\ncase it gets passed to config_error_add().\n\nprocess_options(unix): report bad values with \"%.60s\" so that vsprintf\nwill implicitly truncate when formatted by raw_printf().",
    "type_of_change": "Modification",
    "filename_of_changes": "unixmain.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 386:                 raw_printf(\"Unknown option: %s\", *argv);",
        "// Line_Reference 390: ",
        "// Line_Reference 416:                 raw_printf(\"Unknown option: %s\", *argv);",
        "// Line_Reference 454:             /* else raw_printf(\"Unknown option: %s\", *argv); */"
    ]
}
