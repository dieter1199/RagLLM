{
    "cve_id": "CVE-2021-23177",
    "cve_description": "An improper link resolution flaw while extracting an archive can lead to changing the access control list (ACL) of the target of the link. An attacker may provide a malicious archive to a victim user, who would trigger this flaw when trying to extract the archive. A local attacker may use this flaw to change the ACL of a file on the system and gain more privileges.",
    "cve_publish_date": "2022-08-23",
    "cwe_id": "CWE-59",
    "cwe_name": "Improper Link Resolution Before File Access ('Link Following')",
    "cwe_description": "The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",
    "commit_message": "Fix handling of symbolic link ACLs\n\nOn Linux ACLs on symbolic links are not supported.\nWe must avoid calling acl_set_file() on symbolic links as their\ntargets are modified instead.\n\nWhile here, do not try to set default ACLs on non-directories.\n\nFixes #1565",
    "type_of_change": "Modification",
    "filename_of_changes": "archive_disk_acl_freebsd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 322:     struct archive_acl *abstract_acl,",
        "// Line_Reference 545: \telse if (acl_set_file(name, acl_type, acl) != 0)",
        "// Line_Reference 680: \t\t\tret = set_acl(a, fd, name, abstract_acl,",
        "// Line_Reference 687: \t\t\tret = set_acl(a, fd, name, abstract_acl,",
        "// Line_Reference 696: \t\tret = set_acl(a, fd, name, abstract_acl,"
    ]
}
