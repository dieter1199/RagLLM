{
    "cve_id": "CVE-2020-28349",
    "cve_description": "An inaccurate frame deduplication process in ChirpStack Network Server 3.9.0 allows a malicious gateway to perform uplink Denial of Service via malformed frequency attributes in CollectAndCallOnceCollect in internal/uplink/collect.go. NOTE: the vendor's position is that there are no \"guarantees that allowing untrusted LoRa gateways to the network should still result in a secure network.",
    "cve_publish_date": "2020-11-09",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Improve uplink de-duplication.\n\nThis removes the de-duplication at the MQTT backend. Some MQTT brokers\nprovide shared subscription options in which case this additional\nde-duplication is not needed.\n\nFor MQTT brokers that do not support shared subscriptions, the\ncollectAndCallOnce function will still filter out duplicated uplinks.\n\nBy adding the TXInfo object (hex encoded) to the de-duplication key,\nuplink messages received on multiple channels will be handled\nseparately as they will result in different de-duplication keys.",
    "type_of_change": "Modification",
    "filename_of_changes": "collect.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 22: \tCollectKeyTempl     = \"lora:ns:rx:collect:%s\"",
        "// Line_Reference 23: \tCollectLockKeyTempl = \"lora:ns:rx:collect:%s:lock\"",
        "// Line_Reference 36: \tkey := fmt.Sprintf(CollectKeyTempl, phyKey)",
        "// Line_Reference 37: \tlockKey := fmt.Sprintf(CollectLockKeyTempl, phyKey)"
    ]
}
