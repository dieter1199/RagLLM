(*handlers)["workspace/didChangeWorkspaceFolders"] = WorkspaceDidChangeWorkspaceFoldersHandler()
func WorkspaceDidChangeWorkspaceFoldersHandler() jrpc2.Handler {
workspace.Get().ProcessFolderChange(bgCtx, params)
if len(params.WorkspaceFolders) > 0 {
for _, workspaceFolder := range params.WorkspaceFolders {
log.Info().Str("method", method).Msgf("Adding workspaceFolder %v", workspaceFolder)
f := workspace.NewFolder(
uri.PathFromUri(workspaceFolder.Uri),
workspaceFolder.Name,
di.Scanner(),
di.HoverService(),
)
w.AddFolder(f)
}
} else {
if params.RootURI != "" {
w.AddFolder(workspace.NewFolder(uri.PathFromUri(params.RootURI), params.ClientInfo.Name, di.Scanner(), di.HoverService()))
} else if params.RootPath != "" {
w.AddFolder(workspace.NewFolder(params.RootPath, params.ClientInfo.Name, di.Scanner(), di.HoverService()))
}
}