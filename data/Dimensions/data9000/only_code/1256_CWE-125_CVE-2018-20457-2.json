for (i = j = 0; i < sizeof (buf) - 1 && str[i]; i++, j++) {