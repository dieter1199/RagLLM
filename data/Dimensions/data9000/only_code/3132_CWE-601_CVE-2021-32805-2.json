from flask import abort, current_app, flash, g, redirect, request, session, url_for
"""
For Future Use, API Auth, must check howto keep REST stateless
"""
"""
@expose_api(name='auth',url='/api/auth')
def auth(self):
if g.user is not None and g.user.is_authenticated:
http_return_code = 401
response = make_response(
jsonify(
{
'message': 'Login Failed already authenticated',
'severity': 'critical'
}
),
http_return_code
)
username = str(request.args.get('username'))
password = str(request.args.get('password'))
user = self.appbuilder.sm.auth_user_ldap(username, password)
if not user:
http_return_code = 401
response = make_response(
jsonify(
{
'message': 'Login Failed',
'severity': 'critical'
}
),
http_return_code
)
else:
login_user(user, remember=False)
http_return_code = 201
response = make_response(
jsonify(
{
'message': 'Login Success',
'severity': 'info'
}
),
http_return_code
)
return response
"""
def login(self, provider=None, register=None):
def oauth_authorized(self, provider):
try:
next_url = state["next"][0] or self.appbuilder.get_url_for_index
except (KeyError, IndexError):
next_url = self.appbuilder.get_url_for_index
