{
    "cve_id": "CVE-2020-12135",
    "cve_description": "bson before 0.8 incorrectly uses int rather than size_t for many variables, parameters, and return values. In particular, the bson_ensure_space() parameter bytesNeeded could have an integer overflow via properly constructed bson input.",
    "cve_publish_date": "2020-04-24",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "don't mix up int and size_t (first pass to fix that)",
    "type_of_change": "Modification",
    "filename_of_changes": "mongo.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 115:     int errstr_size, str_size;",
        "// Line_Reference 268: static mongo_message *mongo_message_create( int len , int id , int responseTo , int op ) {",
        "// Line_Reference 275:     mm->head.len = len;",
        "// Line_Reference 347: static char *mongo_data_append( char *start , const void *data , int len ) {",
        "// Line_Reference 903:     int overhead =  16 + 4 + strlen( ns ) + 1;",
        "// Line_Reference 904:     int size = overhead;",
        "// Line_Reference 1207:         int sl = strlen( cursor->ns )+1;",
        "// Line_Reference 1519:     int sl = strlen( db );",
        "// Line_Reference 1677:     mongo_md5_append( &st, ( const mongo_md5_byte_t * )user, strlen( user ) );",
        "// Line_Reference 1679:     mongo_md5_append( &st, ( const mongo_md5_byte_t * )pass, strlen( pass ) );",
        "// Line_Reference 1737:     mongo_md5_append( &st, ( const mongo_md5_byte_t * )nonce, strlen( nonce ) );",
        "// Line_Reference 1738:     mongo_md5_append( &st, ( const mongo_md5_byte_t * )user, strlen( user ) );"
    ]
}
