{
    "cve_id": "CVE-2018-10916",
    "cve_description": "It has been discovered that lftp up to and including version 4.8.3 does not properly sanitize remote file names, leading to a loss of integrity on the local system when reverse mirroring is used. A remote attacker may trick a user to use reverse mirroring on an attacker controlled FTP server, resulting in the removal of all files in the current working directory of the victim's system.",
    "cve_publish_date": "2018-08-01",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "mirror: prepend ./ to rm and chmod arguments to avoid URL recognition (fix #452)",
    "type_of_change": "Modification",
    "filename_of_changes": "MirrorJob.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 1169: \t    ArgV args(\"rm\");",
        "// Line_Reference 1170: \t    if(file->TypeIs(file->DIRECTORY))",
        "// Line_Reference 1171: \t    {",
        "// Line_Reference 1172: \t       if(recursion_mode==RECURSION_NEVER)",
        "// Line_Reference 1173: \t\t  args.setarg(0,\"rmdir\");",
        "// Line_Reference 1174: \t       else",
        "// Line_Reference 1175: \t\t  args.Append(\"-r\");",
        "// Line_Reference 1176: \t    }",
        "// Line_Reference 1183: \t    ArgV *args=new ArgV(\"rm\");",
        "// Line_Reference 1184: \t    args->Append(file->name);",
        "// Line_Reference 1192: \t       {",
        "// Line_Reference 1193: \t\t  args->setarg(0,\"rmdir\");",
        "// Line_Reference 1195: \t       }",
        "// Line_Reference 1261: \t    a->Append(file->name);",
        "// Line_Reference 1383: \t    args->Append(file->name);"
    ]
}
