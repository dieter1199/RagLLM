{
    "cve_id": "CVE-2020-28196",
    "cve_description": "MIT Kerberos 5 (aka krb5) before 1.17.2 and 1.18.x before 1.18.3 allows unbounded recursion via an ASN.1-encoded Kerberos message because the lib/krb5/asn.1/asn1_encode.c support for BER indefinite lengths lacks a recursion limit.",
    "cve_publish_date": "2020-11-06",
    "cwe_id": "CWE-674",
    "cwe_name": "Uncontrolled Recursion",
    "cwe_description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
    "commit_message": "Add recursion limit for ASN.1 indefinite lengths\n\nThe libkrb5 ASN.1 decoder supports BER indefinite lengths.  It\ncomputes the tag length using recursion; the lack of a recursion limit\nallows an attacker to overrun the stack and cause the process to\ncrash.  Reported by Demi Obenour.\n\nCVE-2020-28196:\n\nIn MIT krb5 releases 1.11 and later, an unauthenticated attacker can\ncause a denial of service for any client or server to which it can\nsend an ASN.1-encoded Kerberos message of sufficient length.\n\nticket: 8959 (new)\ntags: pullup\ntarget_version: 1.18-next\ntarget_version: 1.17-next",
    "type_of_change": "Modification",
    "filename_of_changes": "asn1_encode.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 359:         const uint8_t **remainder_out, size_t *rlen_out)",
        "// Line_Reference 399:             ret = get_tag(p, len, &t, &c, &clen, &p, &len);",
        "// Line_Reference 616:     ret = get_tag(*der, len, tag_out, &contents, &clen, &remainder, &rlen);",
        "// Line_Reference 1202:             ret = get_tag(asn1, len, &inner_tag, &asn1, &len, &rem, &rlen);",
        "// Line_Reference 1423:         ret = get_tag(asn1, len, &t, &contents, &clen, &asn1, &len);",
        "// Line_Reference 1481:         ret = get_tag(asn1, len, &t, &contents, &clen, &asn1, &len);",
        "// Line_Reference 1587:                   &clen, &remainder, &rlen);"
    ]
}
