{
    "cve_id": "CVE-2016-7781",
    "cve_description": "SQL injection vulnerability in framework/modules/blog/controllers/blogController.php in Exponent CMS 2.3.9 and earlier allows remote attackers to execute arbitrary SQL commands via the author parameter.",
    "cve_publish_date": "2017-03-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "expSimpleNoteController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "84",
    "number_of_lines_deleted_vulnerable_to_cve": "84",
    "vulnerable_lines": [
        "// Line_Reference 27:     protected $add_permissions = array(",
        "// Line_Reference 28:         'approve'=>\"Approve Comments\"",
        "// Line_Reference 38: ",
        "// Line_Reference 41: ",
        "// Line_Reference 42:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 48: ",
        "// Line_Reference 49:         if (empty($this->params['formtitle']))",
        "// Line_Reference 64: ",
        "// Line_Reference 81:     }",
        "// Line_Reference 82: ",
        "// Line_Reference 85: ",
        "// Line_Reference 86:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 92: ",
        "// Line_Reference 97: ",
        "// Line_Reference 100:             'sql'=>$sql,",
        "// Line_Reference 113: ",
        "// Line_Reference 125: ",
        "// Line_Reference 128: ",
        "// Line_Reference 129:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 131:         $require_login = empty($this->params['require_login']) ? SIMPLENOTE_REQUIRE_LOGIN : $this->params['require_login'];",
        "// Line_Reference 132:         $require_approval = empty($this->params['require_approval']) ? SIMPLENOTE_REQUIRE_APPROVAL : $this->params['require_approval'];",
        "// Line_Reference 133:         $require_notification = empty($this->params['require_notification']) ? SIMPLENOTE_REQUIRE_NOTIFICATION : $this->params['require_notification'];",
        "// Line_Reference 134:         $notification_email = empty($this->params['notification_email']) ? SIMPLENOTE_NOTIFICATION_EMAIL : $this->params['notification_email'];",
        "// Line_Reference 135: ",
        "// Line_Reference 136: ",
        "// Line_Reference 139:         $sql .= 'WHERE cnt.content_id='.$this->params['content_id'].\" AND cnt.content_type='\".$this->params['content_type'].\"' \";",
        "// Line_Reference 141: ",
        "// Line_Reference 144:             'sql'=>$sql,",
        "// Line_Reference 155: ",
        "// Line_Reference 156:         // count the unapproved comments",
        "// Line_Reference 160:             $sql .= 'WHERE cnt.content_id='.$this->params['content_id'].\" AND cnt.content_type='\".$this->params['content_type'].\"' \";",
        "// Line_Reference 165:         }",
        "// Line_Reference 166: ",
        "// Line_Reference 171:             'unapproved'=>$unapproved,",
        "// Line_Reference 172:             'content_id'=>$this->params['content_id'],",
        "// Line_Reference 189: ",
        "// Line_Reference 190:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 196: ",
        "// Line_Reference 202: ",
        "// Line_Reference 203:         // if simplenotes are configed to require approvals set this to 0 otherwise we",
        "// Line_Reference 206: ",
        "// Line_Reference 210: ",
        "// Line_Reference 225: ",
        "// Line_Reference 229: ",
        "// Line_Reference 231: ",
        "// Line_Reference 232: ",
        "// Line_Reference 240: ",
        "// Line_Reference 243: ",
        "// Line_Reference 244:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 250: ",
        "// Line_Reference 255: ",
        "// Line_Reference 266: ",
        "// Line_Reference 269: ",
        "// Line_Reference 274: ",
        "// Line_Reference 275:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 281: ",
        "// Line_Reference 287: ",
        "// Line_Reference 295: ",
        "// Line_Reference 298: ",
        "// Line_Reference 300: ",
        "// Line_Reference 301:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 307: ",
        "// Line_Reference 308: ",
        "// Line_Reference 312: ",
        "// Line_Reference 320: ",
        "// Line_Reference 323: ",
        "// Line_Reference 324:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 330: ",
        "// Line_Reference 335: ",
        "// Line_Reference 339: ",
        "// Line_Reference 341:         $db->delete($simplenote->attachable_table, 'expsimplenote_id='.$this->params['id']);",
        "// Line_Reference 342: ",
        "// Line_Reference 351: ",
        "// Line_Reference 354: ",
        "// Line_Reference 355:         /* The global constants can be overriden by passing appropriate params */",
        "// Line_Reference 357:         $require_login = empty($this->params['require_login']) ? SIMPLENOTE_REQUIRE_LOGIN : $this->params['require_login'];",
        "// Line_Reference 358:         $require_approval = empty($this->params['require_approval']) ? SIMPLENOTE_REQUIRE_APPROVAL : $this->params['require_approval'];",
        "// Line_Reference 359:         $require_notification = empty($this->params['require_notification']) ? SIMPLENOTE_REQUIRE_NOTIFICATION : $this->params['require_notification'];",
        "// Line_Reference 360:         $notification_email = empty($this->params['notification_email']) ? SIMPLENOTE_NOTIFICATION_EMAIL : $this->params['notification_email'];",
        "// Line_Reference 361: ",
        "// Line_Reference 366: ",
        "// Line_Reference 373: ",
        "// Line_Reference 375:         $mail = new expMail();",
        "// Line_Reference 382: "
    ]
}
