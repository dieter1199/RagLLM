{
    "cve_id": "CVE-2020-10235",
    "cve_description": "An issue was discovered in Froxlor before 0.10.14. Remote attackers with access to the installation routine could have executed arbitrary code via the database configuration options that were passed unescaped to exec, because of _backupExistingDatabase in install/lib/class.FroxlorInstall.php.",
    "cve_publish_date": "2020-03-09",
    "cwe_id": "CWE-116",
    "cwe_name": "Improper Encoding or Escaping of Output",
    "cwe_description": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.",
    "commit_message": "forgot one escapeshellarg() and enhanced security on userdata.inc.php creation when installing\n\nSigned-off-by: Michael Kaufmann <d00p@froxlor.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "class.FroxlorInstall.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 336: \t\tif ($fp = @fopen($userdata_file, 'w')) {",
        "// Line_Reference 337: \t\t\t$result = @fputs($fp, $userdata, strlen($userdata));",
        "// Line_Reference 340: \t\t\tchmod($userdata_file, 0440);",
        "// Line_Reference 343: \t\t\t$temp_file = tempnam(sys_get_temp_dir(), 'fx');",
        "// Line_Reference 344: \t\t\tif (touch($temp_file)) {",
        "// Line_Reference 347: \t\t\t\t$result = @fputs($fp, $userdata, strlen($userdata));",
        "// Line_Reference 571: \t\t\t\t\t\t$result = $db->query($sql_query[$i]);",
        "// Line_Reference 738: \t\t\t\t$command = $mysql_dump . \" \" . escapeshellarg($this->_data['mysql_database']) . \" -u \" . escapeshellarg($this->_data['mysql_root_user']) . \" --password='\" . $this->_data['mysql_root_pass'] . \"' --result-file=\" . $filename;"
    ]
}
