{
    "cve_id": "CVE-2020-35535",
    "cve_description": "In LibRaw, there is an out-of-bounds read vulnerability within the \"LibRaw::parseSonySRF()\" function (libraw\\src\\metadata\\sony.cpp) when processing srf files.",
    "cve_publish_date": "2022-09-01",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "additional checks in parseSonySRF\n\nparseSonySR2: buffer size check",
    "type_of_change": "Modification",
    "filename_of_changes": "sony.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "62",
    "number_of_lines_deleted_vulnerable_to_cve": "28",
    "vulnerable_lines": [
        "// Line_Reference 1815:           FORC4 cblack[c] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1819:           FORC4 cam_mul[GRBG_2_RGBG(c)] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1823:           FORC4 cblack[RGGB_2_RGBG(c)] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1831:           FORC4 cam_mul[RGGB_2_RGBG(c)] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1835:           ilm.MaxAp4MaxFocal = sgetreal(tag_type, cbuf_SR2 + tag_dataoffset);",
        "// Line_Reference 1839:           ilm.MaxAp4MinFocal = sgetreal(tag_type, cbuf_SR2 + tag_dataoffset);",
        "// Line_Reference 1843:           ilm.MaxFocal = sgetreal(tag_type, cbuf_SR2 + tag_dataoffset);",
        "// Line_Reference 1847:           ilm.MinFocal = sgetreal(tag_type, cbuf_SR2 + tag_dataoffset);",
        "// Line_Reference 1851:           for (i = 0; i < 3; i++)",
        "// Line_Reference 1868:             FORC3 imgdata.color.linear_max[c] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1873:             imgdata.color.linear_max[0] = imgdata.color.linear_max[1] =",
        "// Line_Reference 1887:             FORC3 icWBCCTC[WBCTC_count][c + 1] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1891:             FORC3 icWBC[Sony_SR2_wb_list[i]][c] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1898:             FORC3 icWBCCTC[WBCTC_count][c + 1] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1906:             FORC3 icWBC[Sony_SR2_wb_list1[i]][c] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1910:           FORC4 icWBC[LIBRAW_WBI_Auto][GRBG_2_RGBG(c)] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1912:           FORC4 icWBC[LIBRAW_WBI_Auto][RGGB_2_RGBG(c)] = sget2(cbuf_SR2 + tag_dataoffset + tag_dataunitlen * c);",
        "// Line_Reference 1938:   short entries;",
        "// Line_Reference 1941:   srf_buf = (uchar *)malloc(len);",
        "// Line_Reference 1998:         SRF2Key = sget4(srf_buf + tag_dataoffset);",
        "// Line_Reference 2000:         RawDataKey = sget4(srf_buf + tag_dataoffset);",
        "// Line_Reference 2022:     if (tiff_sget (save, srf_buf, len,",
        "// Line_Reference 2028:         icWBC[Sony_SRF_wb_list[nWB]][i] = sget4(srf_buf + tag_dataoffset);",
        "// Line_Reference 2035:         cam_mul[i] = sget4(srf_buf + tag_dataoffset);",
        "// Line_Reference 2047:         ilm.MaxAp4MaxFocal = sgetreal(tag_type, srf_buf + tag_dataoffset);",
        "// Line_Reference 2050:          ilm.MaxAp4MinFocal = sgetreal(tag_type, srf_buf + tag_dataoffset);",
        "// Line_Reference 2053:         ilm.MinFocal = sgetreal(tag_type, srf_buf + tag_dataoffset);",
        "// Line_Reference 2056:         ilm.MaxFocal = sgetreal(tag_type, srf_buf + tag_dataoffset);"
    ]
}
