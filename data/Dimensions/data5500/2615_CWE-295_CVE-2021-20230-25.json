{
    "cve_id": "CVE-2021-20230",
    "cve_description": "A flaw was found in stunnel before 5.57, where it improperly validates client certificates when it is configured to use both redirect and verifyChain options. This flaw allows an attacker with a certificate signed by a Certificate Authority, which is not the one accepted by the stunnel server, to access the tunneled service instead of being redirected to the address specified in the redirect option. The highest threat from this vulnerability is to confidentiality.",
    "cve_publish_date": "2021-02-23",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "stunnel-5.57",
    "type_of_change": "Modification",
    "filename_of_changes": "verify.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 3:  *   Copyright (C) 1998-2019 Michal Trojnara <Michal.Trojnara@stunnel.org>",
        "// Line_Reference 217:     if(verify_checks(c, preverify_ok, callback_ctx)) {",
        "// Line_Reference 220:             int ok=SSL_SESSION_set_ex_data(sess, index_session_authenticated,",
        "// Line_Reference 221:                 (void *)(-1));",
        "// Line_Reference 230:     if(c->opt->option.client || c->opt->protocol)",
        "// Line_Reference 231:         return 0; /* reject */",
        "// Line_Reference 232:     if(c->opt->redirect_addr.names)",
        "// Line_Reference 233:         return 1; /* accept */"
    ]
}
