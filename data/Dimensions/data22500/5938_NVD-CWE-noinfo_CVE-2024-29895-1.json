{
    "cve_id": "CVE-2024-29895",
    "cve_description": "Cacti provides an operational monitoring and fault management framework. A command injection vulnerability on the 1.3.x DEV branch allows any unauthenticated user to execute arbitrary command on the server when `register_argc_argv` option of PHP is `On`. In `cmd_realtime.php` line 119, the `$poller_id` used as part of the command execution is sourced from `$_SERVER['argv']`, which can be controlled by URL when `register_argc_argv` option of PHP is `On`. And this option is `On` by default in many environments such as the main PHP Docker image for PHP. Commit 53e8014d1f082034e0646edc6286cde3800c683d contains a patch for the issue, but this commit was reverted in commit 99633903cad0de5ace636249de16f77e57a3c8fc.",
    "cve_publish_date": "2024-05-14",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Revert \"Merge pull request from GHSA-cr28-x256-xf5m\"\n\nThis reverts commit 53e8014d1f082034e0646edc6286cde3800c683d.",
    "type_of_change": "Modification",
    "filename_of_changes": "cmd_realtime.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 43: $poller_id = (int)$_SERVER['argv'][1];",
        "// Line_Reference 47: if ($poller_id <= 0) {",
        "// Line_Reference 48: \tprint \"Invalid poller_id specified.\\n\\n\";",
        "// Line_Reference 49: ",
        "// Line_Reference 50: \texit(-1);",
        "// Line_Reference 51: }",
        "// Line_Reference 52: "
    ]
}
