{
    "cve_id": "CVE-2016-10027",
    "cve_description": "Race condition in the XMPP library in Smack before 4.1.9, when the SecurityMode.required TLS setting has been set, allows man-in-the-middle attackers to bypass TLS protections and trigger use of cleartext for client authentication by stripping the \"starttls\" feature from a server response.",
    "cve_publish_date": "2017-01-12",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "Move TLS Required check at the end of connect()\n\nIt was a *very* bad idea to perform the SecurityMode.Required check in\nthe connection's reader thread and not at the end of\nAbstractXMPPConnectin's connect(). :/\n\nThis behavior dates back to 8e750912a765f77a4f178a4f307a8b42c2afb5ae\n\nFixes SMACK-739",
    "type_of_change": "Modification",
    "filename_of_changes": "XMPPTCPConnection.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 31: import org.jivesoftware.smack.SmackException.ConnectionException;",
        "// Line_Reference 34: import org.jivesoftware.smack.SmackException.SecurityRequiredException;",
        "// Line_Reference 900:     protected void afterFeaturesReceived() throws SecurityRequiredException, NotConnectedException {",
        "// Line_Reference 912:         // If TLS is required but the server doesn't offer it, disconnect",
        "// Line_Reference 913:         // from the server and throw an error. First check if we've already negotiated TLS",
        "// Line_Reference 914:         // and are secure, however (features get parsed a second time after TLS is established).",
        "// Line_Reference 915:         if (!isSecureConnection() && startTlsFeature == null",
        "// Line_Reference 916:                         && getConfiguration().getSecurityMode() == SecurityMode.required) {",
        "// Line_Reference 917:             throw new SecurityRequiredByClientException();",
        "// Line_Reference 918:         }"
    ]
}
