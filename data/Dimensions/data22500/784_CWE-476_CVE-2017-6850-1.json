{
    "cve_id": "CVE-2017-6850",
    "cve_description": "The jp2_cdef_destroy function in jp2_cod.c in JasPer before 2.0.13 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted image.",
    "cve_publish_date": "2017-03-15",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fixed bugs due to uninitialized data in the JP2 decoder.\nAlso, added some comments marking I/O stream interfaces that probably\nneed to be changed (in the long term) to fix integer overflow problems.",
    "type_of_change": "Modification",
    "filename_of_changes": "jp2_cod.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 186: jp2_box_t *jp2_box_create(int type)",
        "// Line_Reference 189: \tjp2_boxinfo_t *boxinfo;",
        "// Line_Reference 190: ",
        "// Line_Reference 251: \tif (!(box = jas_malloc(sizeof(jp2_box_t)))) {",
        "// Line_Reference 254: ",
        "// Line_Reference 255: \t// Mark the box data as never having been constructed",
        "// Line_Reference 256: \t// so that we will not errantly attempt to destroy it later.",
        "// Line_Reference 257: \tbox->ops = &jp2_boxinfo_unk.ops;",
        "// Line_Reference 258: ",
        "// Line_Reference 266: \t  \"preliminary processing of JP2 box: type=%c%s%c (0x%08x); length=%d\\n\",",
        "// Line_Reference 521: \t\tif (jas_stream_copy(out, tmpstream, box->len - JP2_BOX_HDRLEN(false))) {",
        "// Line_Reference 872: /* Eliminate warning about unused variable. */",
        "// Line_Reference 873: box = 0;",
        "// Line_Reference 874: out = 0;"
    ]
}
