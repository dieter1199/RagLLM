{
    "cve_id": "CVE-2015-8314",
    "cve_description": "The Devise gem before 3.5.4 for Ruby mishandles Remember Me cookies for sessions, which may allow an adversary to obtain unauthorized persistent application access.",
    "cve_publish_date": "2023-12-12",
    "cwe_id": "CWE-312",
    "cwe_name": "Cleartext Storage of Sensitive Information",
    "cwe_description": "The product stores sensitive information in cleartext within a resource that might be accessible to another control sphere.",
    "commit_message": "Store creation timestamp on remember cookies\n\nSigned-off-by: Jos√© Valim <jose.valim@plataformatec.com.br>",
    "type_of_change": "Modification",
    "filename_of_changes": "rememberable_test.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "95",
    "vulnerable_lines": [
        "// Line_Reference 36:     assert_equal [user.to_key, user.authenticatable_salt], User.serialize_into_cookie(user)",
        "// Line_Reference 42:     assert_equal user, User.serialize_from_cookie(user.to_key, user.authenticatable_salt)",
        "// Line_Reference 96:   test 'remember is expired if not created at timestamp is set' do",
        "// Line_Reference 97:     assert create_resource.remember_expired?",
        "// Line_Reference 98:   end",
        "// Line_Reference 99: ",
        "// Line_Reference 100:   test 'serialize should return nil if no resource is found' do",
        "// Line_Reference 101:     assert_nil resource_class.serialize_from_cookie([0], \"123\")",
        "// Line_Reference 102:   end",
        "// Line_Reference 103: ",
        "// Line_Reference 104:   test 'remember me return nil if is a valid resource with invalid token' do",
        "// Line_Reference 105:     resource = create_resource",
        "// Line_Reference 106:     assert_nil resource_class.serialize_from_cookie([resource.id], \"123\")",
        "// Line_Reference 107:   end",
        "// Line_Reference 108: ",
        "// Line_Reference 109:   test 'remember for should fallback to devise remember for default configuration' do",
        "// Line_Reference 110:     swap Devise, remember_for: 1.day do",
        "// Line_Reference 111:       resource = create_resource",
        "// Line_Reference 112:       resource.remember_me!",
        "// Line_Reference 113:       assert_not resource.remember_expired?",
        "// Line_Reference 114:     end",
        "// Line_Reference 115:   end",
        "// Line_Reference 116: ",
        "// Line_Reference 117:   test 'remember expires at should sum date of creation with remember for configuration' do",
        "// Line_Reference 128:   test 'remember should be expired if remember_for is zero' do",
        "// Line_Reference 129:     swap Devise, remember_for: 0.days do",
        "// Line_Reference 130:       Devise.remember_for = 0.days",
        "// Line_Reference 131:       resource = create_resource",
        "// Line_Reference 132:       resource.remember_me!",
        "// Line_Reference 133:       assert resource.remember_expired?",
        "// Line_Reference 134:     end",
        "// Line_Reference 135:   end",
        "// Line_Reference 136: ",
        "// Line_Reference 137:   test 'remember should be expired if it was created before limit time' do",
        "// Line_Reference 138:     swap Devise, remember_for: 1.day do",
        "// Line_Reference 139:       resource = create_resource",
        "// Line_Reference 140:       resource.remember_me!",
        "// Line_Reference 141:       resource.remember_created_at = 2.days.ago",
        "// Line_Reference 142:       resource.save",
        "// Line_Reference 143:       assert resource.remember_expired?",
        "// Line_Reference 144:     end",
        "// Line_Reference 145:   end",
        "// Line_Reference 146: ",
        "// Line_Reference 147:   test 'remember should not be expired if it was created within the limit time' do",
        "// Line_Reference 148:     swap Devise, remember_for: 30.days do",
        "// Line_Reference 149:       resource = create_resource",
        "// Line_Reference 150:       resource.remember_me!",
        "// Line_Reference 151:       resource.remember_created_at = (30.days.ago + 2.minutes)",
        "// Line_Reference 152:       resource.save",
        "// Line_Reference 153:       assert_not resource.remember_expired?",
        "// Line_Reference 154:     end",
        "// Line_Reference 155:   end",
        "// Line_Reference 156: ",
        "// Line_Reference 157:   test 'if extend_remember_period is false, remember_me! should generate a new timestamp if expired' do",
        "// Line_Reference 158:     swap Devise, remember_for: 5.minutes do",
        "// Line_Reference 159:       resource = create_resource",
        "// Line_Reference 160:       resource.remember_me!(false)",
        "// Line_Reference 161:       assert resource.remember_created_at",
        "// Line_Reference 162: ",
        "// Line_Reference 163:       resource.remember_created_at = old = 10.minutes.ago",
        "// Line_Reference 164:       resource.save",
        "// Line_Reference 165: ",
        "// Line_Reference 166:       resource.remember_me!(false)",
        "// Line_Reference 167:       assert_not_equal old.to_i, resource.remember_created_at.to_i",
        "// Line_Reference 168:     end",
        "// Line_Reference 169:   end",
        "// Line_Reference 170: ",
        "// Line_Reference 171:   test 'if extend_remember_period is false, remember_me! should not generate a new timestamp' do",
        "// Line_Reference 172:     swap Devise, remember_for: 1.year do",
        "// Line_Reference 173:       resource = create_resource",
        "// Line_Reference 174:       resource.remember_me!(false)",
        "// Line_Reference 175:       assert resource.remember_created_at",
        "// Line_Reference 176: ",
        "// Line_Reference 177:       resource.remember_created_at = old = 10.minutes.ago.utc",
        "// Line_Reference 178:       resource.save",
        "// Line_Reference 179: ",
        "// Line_Reference 180:       resource.remember_me!(false)",
        "// Line_Reference 181:       assert_equal old.to_i, resource.remember_created_at.to_i",
        "// Line_Reference 182:     end",
        "// Line_Reference 183:   end",
        "// Line_Reference 184: ",
        "// Line_Reference 185:   test 'if extend_remember_period is true, remember_me! should always generate a new timestamp' do",
        "// Line_Reference 186:     swap Devise, remember_for: 1.year do",
        "// Line_Reference 187:       resource = create_resource",
        "// Line_Reference 188:       resource.remember_me!(true)",
        "// Line_Reference 189:       assert resource.remember_created_at",
        "// Line_Reference 190: ",
        "// Line_Reference 191:       resource.remember_created_at = old = 10.minutes.ago",
        "// Line_Reference 192:       resource.save",
        "// Line_Reference 193: ",
        "// Line_Reference 194:       resource.remember_me!(true)",
        "// Line_Reference 195:       assert_not_equal old, resource.remember_created_at",
        "// Line_Reference 196:     end",
        "// Line_Reference 197:   end",
        "// Line_Reference 198: "
    ]
}
