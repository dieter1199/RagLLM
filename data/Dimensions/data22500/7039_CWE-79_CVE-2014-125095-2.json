{
    "cve_id": "CVE-2014-125095",
    "cve_description": "A vulnerability was found in BestWebSoft Contact Form Plugin 1.3.4 on WordPress and classified as problematic. Affected by this issue is the function bws_add_menu_render of the file bws_menu/bws_menu.php. The manipulation of the argument bwsmn_form_email leads to cross site scripting. The attack may be launched remotely. Upgrading to version 1.3.7 is able to address this issue. The name of the patch is 4d531f74b4a801c805dc80360d4ea1312e9a278f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-225320.",
    "cve_publish_date": "2023-04-09",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "V3.82 - Security Exploit was fixed. The French language file is updated.\n\ngit-svn-id: https://plugins.svn.wordpress.org/contact-form-plugin/trunk@961828 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "contact_form.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 7: Version: 3.81",
        "// Line_Reference 117: ",
        "// Line_Reference 410: \t\t\t$cntctfrm_options_submit['cntctfrm_custom_email'] = stripslashes( $_POST['cntctfrm_custom_email'] );",
        "// Line_Reference 413: \t\t\t$cntctfrm_options_submit['cntctfrm_custom_from_email'] = stripslashes( $_POST['cntctfrm_custom_from_email'] );",
        "// Line_Reference 496: \t\t\t\t$cntctfrm_options_submit['cntctfrm_from_field']\t\t\t\t\t= $_POST['cntctfrm_from_field'];",
        "// Line_Reference 566: \t\t\t\t$cntctfrm_options_submit['cntctfrm_required_symbol']\t\t\t= isset( $_POST['cntctfrm_required_symbol']) ? $_POST['cntctfrm_required_symbol'] : '*';",
        "// Line_Reference 670: \t\t\t\t$cntctfrm_options_submit['cntctfrm_redirect_url']\t= $_POST['cntctfrm_redirect_url'];",
        "// Line_Reference 676: \t\t\t\t|| ! preg_match( '@^(?:http://)?([^/]+)@i', trim( $cntctfrm_options_submit['cntctfrm_redirect_url'] ) ) ) ) {",
        "// Line_Reference 689: \t\t\t\tif ( \"\" == $cntctfrm_options_submit['cntctfrm_custom_email'] || ! preg_match( \"/^((?:[a-z0-9_']+(?:[a-z0-9\\-_\\.']+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})[, ]*)+$/i\", trim( $cntctfrm_options_submit['cntctfrm_custom_email'] ) ) ){",
        "// Line_Reference 690: \t\t\t\t\t$error .= __( \"Please enter a valid email address in the 'FROM' field. Settings are not saved.\", 'contact_form' );",
        "// Line_Reference 695: \t\t\t\t\t&& ! preg_match( \"/^((?:[a-z0-9_']+(?:[a-z0-9\\-_\\.']+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})[, ]*)+$/i\", trim( $cntctfrm_options_submit['cntctfrm_custom_from_email'] ) ) ) {",
        "// Line_Reference 743: \t\t\t$bws_license_key = ( isset( $_POST['bws_license_key'] ) ) ? trim( $_POST['bws_license_key'] ) : \"\";",
        "// Line_Reference 750: \t\t\t\t\t\t$bws_license_plugin = trim( $_POST['bws_license_plugin'] );",
        "// Line_Reference 1178: \t\t\t\t\t\t\t\t\techo '<option value=\"' . esc_attr( $key ) . '\"> ' . esc_html ( $val ) . '</option>';",
        "// Line_Reference 1824: \t\t\t\t$content .= '<input type=\"hidden\" value=\"' . $atts['id'] . '\" name=\"cntctfrmmlt_shortcode_id\">';",
        "// Line_Reference 1826: \t\t\t\t\t<input type=\"hidden\" value=\"' . $lang . '\" name=\"cntctfrm_language\">",
        "// Line_Reference 1946: \t\tif ( 1 == $cntctfrm_options['cntctfrm_required_email_field'] && \"\" != $email && preg_match( \"/^(?:[a-z0-9_']+(?:[a-z0-9\\-_\\.']+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})$/i\", trim( stripslashes( $email ) ) ) )",
        "// Line_Reference 2393: \t\t\t\twp_enqueue_script( 'cntctfrm_script', plugins_url( 'js/script_wp_before_3.5.js', __FILE__ ) );",
        "// Line_Reference 2542: \t\t\t\tarray( 'cntctfrmmlt_hide_banner_on_plugin_page', 'contact-form-multi/contact-form-multi.php', '1.0.7' ),",
        "// Line_Reference 2543: \t\t\t\tarray( 'gglmps_hide_banner_on_plugin_page', 'bws-google-maps/bws-google-maps.php', '1.2' ),",
        "// Line_Reference 2553: \t\t\t\tarray( 'gllr_hide_banner_on_plugin_page', 'gallery-plugin/gallery-plugin.php', '3.9.1' )",
        "// Line_Reference 2675: register_uninstall_hook( __FILE__, 'cntctfrm_delete_options' );",
        "// Line_Reference 2676: ?>"
    ]
}
