{
    "cve_id": "CVE-2015-10105",
    "cve_description": "A vulnerability, which was classified as critical, was found in IP Blacklist Cloud Plugin up to 3.42 on WordPress. This affects the function valid_js_identifier of the file ip_blacklist_cloud.php of the component CSV File Import. The manipulation of the argument filename leads to path traversal. It is possible to initiate the attack remotely. Upgrading to version 3.43 is able to address this issue. The identifier of the patch is 6e6fe8c6fda7cbc252eef083105e08d759c07312. It is recommended to upgrade the affected component. The identifier VDB-227757 was assigned to this vulnerability.",
    "cve_publish_date": "2023-05-01",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "fixed CSV file import vulnerability - version 3.43\n\ngit-svn-id: https://plugins.svn.wordpress.org/ip-blacklist-cloud/trunk@1107588 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "ip_blacklist_cloud.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 6: Version: 3.42",
        "// Line_Reference 1884: \t\t\tif(current_user_can( 'manage_options' ) && $_REQUEST['filename'])",
        "// Line_Reference 1890: \t\t\t\t$filename= $upload_dir.\"/ipblc_csv/\".$_REQUEST['filename'];",
        "// Line_Reference 1893: \t\t\t\tif (($handle = fopen(\"$filename\", \"r\")) !== FALSE)",
        "// Line_Reference 1894: \t\t\t\t{",
        "// Line_Reference 1895: \t\t\t\t\t$AllData=array();",
        "// Line_Reference 1896: \t\t\t\t\twhile (($data = fgetcsv($handle, 5242880, \",\")) !== FALSE)",
        "// Line_Reference 1898: \t\t\t\t\t\t$field=$data[0];",
        "// Line_Reference 1899: \t\t\t\t\t\t$value=$data[1];",
        "// Line_Reference 1900: \t\t\t\t\t\t$AllData[]=array(\"$field\"=>$value);",
        "// Line_Reference 1902: \t\t\t\t\tfclose($handle);",
        "// Line_Reference 1903: \t\t\t\t\techo json_encode($AllData);"
    ]
}
