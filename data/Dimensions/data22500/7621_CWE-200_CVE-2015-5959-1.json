{
    "cve_id": "CVE-2015-5959",
    "cve_description": "Froxlor before 0.9.33.2 with the default configuration/setup might allow remote attackers to obtain the database password by reading /logs/sql-error.log.",
    "cve_publish_date": "2017-09-06",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "replace passwords even before logging, not just for display\n\nSigned-off-by: Michael Kaufmann (d00p) <d00p@froxlor.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "class.Database.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "30",
    "vulnerable_lines": [
        "// Line_Reference 325: \t\t@fwrite($sqllog, date('d.m.Y H:i', time()).\" --- \".str_replace(\"\\n\", \" \", $error->getMessage()).\"\\n\");",
        "// Line_Reference 326: \t\t@fwrite($sqllog, date('d.m.Y H:i', time()).\" --- DEBUG: \\n\".$error->getTraceAsString().\"\\n\");",
        "// Line_Reference 336: \t\t@fwrite($errlog, \"|MSG \".$error->getMessage().\"\\n\");",
        "// Line_Reference 339: \t\t@fwrite($errlog, \"|TRACE\\n\".$error->getTraceAsString().\"\\n\");",
        "// Line_Reference 344: \t\t\t// include userdata.inc.php",
        "// Line_Reference 345: \t\t\trequire FROXLOR_INSTALL_DIR.\"/lib/userdata.inc.php\";",
        "// Line_Reference 346: ",
        "// Line_Reference 350: \t\t\t// le format",
        "// Line_Reference 351: \t\t\tif (isset($sql['root_user'])",
        "// Line_Reference 352: \t\t\t\t&& isset($sql['root_password'])",
        "// Line_Reference 353: \t\t\t\t&& (!isset($sql_root) || !is_array($sql_root))",
        "// Line_Reference 354: \t\t\t) {",
        "// Line_Reference 355: \t\t\t\t$sql_root = array(0 => array('caption' => 'Default', 'host' => $sql['host'], 'socket' => (isset($sql['socket']) ? $sql['socket'] : null), 'user' => $sql['root_user'], 'password' => $sql['root_password']));",
        "// Line_Reference 356: \t\t\t}",
        "// Line_Reference 357: ",
        "// Line_Reference 358: \t\t\t// hide username/password in messages",
        "// Line_Reference 359: \t\t\t$error_message = $error->getMessage();",
        "// Line_Reference 360: \t\t\t$error_trace = $error->getTraceAsString();",
        "// Line_Reference 361: \t\t\t// error-message",
        "// Line_Reference 362: \t\t\t$error_message = str_replace($sql['password'], 'DB_UNPRIV_PWD', $error_message);",
        "// Line_Reference 363: \t\t\t$error_message = str_replace($sql_root[0]['password'], 'DB_ROOT_PWD', $error_message);",
        "// Line_Reference 364: \t\t\t// error-trace",
        "// Line_Reference 365: \t\t\t$error_trace = str_replace($sql['password'], 'DB_UNPRIV_PWD', $error_trace);",
        "// Line_Reference 366: \t\t\t$error_trace = str_replace($sql_root[0]['password'], 'DB_ROOT_PWD', $error_trace);",
        "// Line_Reference 367: ",
        "// Line_Reference 368: \t\t\tif ($error->getCode() == 2003) {",
        "// Line_Reference 369: \t\t\t    $error_message = \"Unable to connect to database. Either the mysql-server is not running or your user/password is wrong.\";",
        "// Line_Reference 370: \t\t\t    $error_trace = \"\";",
        "// Line_Reference 371: \t\t\t}",
        "// Line_Reference 372: "
    ]
}
