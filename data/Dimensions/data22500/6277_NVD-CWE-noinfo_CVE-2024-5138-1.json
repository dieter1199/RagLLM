{
    "cve_id": "CVE-2024-5138",
    "cve_description": "The snapctl component within snapd allows a confined snap to interact with the snapd daemon to take certain privileged actions on behalf of the snap. It was found that snapctl did not properly parse command-line arguments, allowing an unprivileged user to trigger an authorised action on behalf of the snap that would normally require administrator privileges to perform. This could possibly allow an unprivileged user to perform a denial of service or similar.",
    "cve_publish_date": "2024-05-31",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-p9v8-q5m4-pf46\n\n* o/hookstate: recognize \"--\" in snapctl argument parser\n\nWhen parsing snapctl argument vector recognize the \"--\" as an option\nterminator, so that dash-options are not recognized afterwards.\n\nFixes: https://bugs.launchpad.net/snapd/+bug/2065077\n\nSigned-off-by: Zygmunt Krynicki <zygmunt.krynicki@canonical.com>\n\n* tests: add regression test for lp-2065077\n\nSigned-off-by: Zygmunt Krynicki <zygmunt.krynicki@canonical.com>\n\n---------\n\nSigned-off-by: Zygmunt Krynicki <zygmunt.krynicki@canonical.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "ctlcmd.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 184: \t// A command can run if any of the following are true:",
        "// Line_Reference 185: \t//\t* It runs as root",
        "// Line_Reference 186: \t//\t* It's contained in nonRootAllowed",
        "// Line_Reference 187: \t//\t* It's used with the -h or --help flags",
        "// Line_Reference 188: \t// note: commands still need valid context and snaps can only access own config.",
        "// Line_Reference 189: \treturn uid == 0 ||",
        "// Line_Reference 190: \t\tstrutil.ListContains(nonRootAllowed, args[0]) ||",
        "// Line_Reference 191: \t\tstrutil.ListContains(args, \"-h\") ||",
        "// Line_Reference 192: \t\tstrutil.ListContains(args, \"--help\")"
    ]
}
