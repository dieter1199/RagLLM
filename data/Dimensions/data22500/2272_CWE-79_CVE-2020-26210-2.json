{
    "cve_id": "CVE-2020-26210",
    "cve_description": "In BookStack before version 0.30.4, a user with permissions to edit a page could add an attached link which would execute untrusted JavaScript code when clicked by a viewer of the page. Dangerous content may remain in the database after this update. If you think this could have been exploited the linked advisory provides a SQL query to test. As a workaround, page edit permissions could be limited to only those that are trusted until you can upgrade although this will not address existing exploitation of this vulnerability. The issue is fixed in version 0.30.4.",
    "cve_publish_date": "2020-11-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Prevented possible XSS via link attachments\n\nThis filters out potentially malicious javascript: or data: uri's coming\nthrough to be attached to attachments.\nAdded tests to cover.\n\nThanks to Yassine ABOUKIR (@yassineaboukir on twitter) for reporting this\nvulnerability.",
    "type_of_change": "Modification",
    "filename_of_changes": "AttachmentService.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 91:      * @param string $name",
        "// Line_Reference 92:      * @param string $link",
        "// Line_Reference 93:      * @param int $page_id",
        "// Line_Reference 94:      * @return Attachment",
        "// Line_Reference 96:     public function saveNewFromLink($name, $link, $page_id)",
        "// Line_Reference 126:      * @param Attachment $attachment",
        "// Line_Reference 127:      * @param $requestData",
        "// Line_Reference 128:      * @return Attachment",
        "// Line_Reference 130:     public function updateFile(Attachment $attachment, $requestData)"
    ]
}
