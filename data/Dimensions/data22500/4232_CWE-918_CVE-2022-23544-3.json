{
    "cve_id": "CVE-2022-23544",
    "cve_description": "MeterSphere is a one-stop open source continuous testing platform, covering test management, interface testing, UI testing and performance testing. Versions prior to 2.5.0 are subject to a Server-Side Request Forgery that leads to Cross-Site Scripting. A Server-Side request forgery in `IssueProxyResourceService::getMdImageByUrl` allows an attacker to access internal resources, as well as executing JavaScript code in the context of Metersphere's origin by a victim of a reflected XSS. This vulnerability has been fixed in v2.5.0. There are no known workarounds.",
    "cve_publish_date": "2022-12-28",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "fix(测试跟踪): 缺陷平台请求转发添加白名单",
    "type_of_change": "Modification",
    "filename_of_changes": "IssueProxyResourceService.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 3: import io.metersphere.commons.exception.MSException;",
        "// Line_Reference 4: import io.metersphere.i18n.Translator;",
        "// Line_Reference 7: import org.springframework.http.HttpMethod;",
        "// Line_Reference 28:      * @param url",
        "// Line_Reference 32:     public ResponseEntity<byte[]> getMdImageByUrl(String url, String platform, String workspaceId) {",
        "// Line_Reference 33:         if (url.contains(\"md/get/url\")) {",
        "// Line_Reference 34:             MSException.throwException(Translator.get(\"invalid_parameter\"));",
        "// Line_Reference 35:         }",
        "// Line_Reference 36:         if (StringUtils.isNotBlank(platform)) {",
        "// Line_Reference 37:             return platformPluginService.getPlatform(platform, workspaceId)",
        "// Line_Reference 38:                     .proxyForGet(url, byte[].class);",
        "// Line_Reference 41:         return restTemplate.exchange(url, HttpMethod.GET, null, byte[].class);"
    ]
}
