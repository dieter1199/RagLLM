$sql_inj = 0;
$sql_inj += preg_match('/delete\s+from/i',	 $val);
$sql_inj += preg_match('/create\s+table/i',	 $val);
$sql_inj += preg_match('/update.+set.+=/i',  $val);
$sql_inj += preg_match('/insert\s+into/i', 	 $val);
$sql_inj += preg_match('/select.+from/i', 	 $val);
$sql_inj += preg_match('/union.+select/i', 	 $val);
$sql_inj += preg_match('/into\s+(outfile|dumpfile)/i',  $val);
$sql_inj += preg_match('/(\.\.%2f)+/i',		 $val);
$sql_inj += preg_match('/<script/i', $val);
if (! defined('NOSTYLECHECK')) $sql_inj += preg_match('/<style/i', $val);
$sql_inj += preg_match('/base[\s]+href/si', $val);
$sql_inj += preg_match('/<.*onmouse/si', $val);       // onmousexxx can be set on img or any html tag like <img title='...' onmouseover=alert(1)>
$sql_inj += preg_match('/onerror\s*=/i', $val);       // onerror can be set on img or any html tag like <img title='...' onerror = alert(1)>
$sql_inj += preg_match('/onfocus\s*=/i', $val);       // onfocus can be set on input text html tag like <input type='text' value='...' onfocus = alert(1)>
$sql_inj += preg_match('/javascript:/i', $val);
$sql_inj += preg_match('/vbscript:/i', $val);
if ($type == 1) $sql_inj += preg_match('/"/i', $val);		// We refused " in GET parameters value
if ($type == 2) $sql_inj += preg_match('/[;"]/', $val);		// PHP_SELF is a file system path. It can contains spaces.
return $sql_inj;