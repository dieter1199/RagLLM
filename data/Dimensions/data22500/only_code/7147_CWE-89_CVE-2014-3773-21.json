if (count($apiip_pool) > 0 && !array_search($_SERVER['REMOTE_ADDR'], $apiip_pool)) {
$array_category = explode(';',$GLOBALS['request'][2]);
foreach($array_category as $category) {
if(!preg_match_all("/^([\w\:\'\-\sàáâãäåçèéêëìíîïðòóôõöùúûüýÿ]+)$/i", $category,$result)) {
rest_error('CATEGORY_MALFORMED');
}
}
if(count($array_category) > 1 && count($array_category) < 5) {
for ($i = count($array_category); $i > 0; $i--) {
$slot = $i - 1;
if (!$slot) {
$category_query .= "select id from ".$GLOBALS['pre']."nested_tree where title LIKE '".$array_category[$slot]."' AND parent_id = 0";
} else {
$category_query .= "select id from ".$GLOBALS['pre']."nested_tree where title LIKE '".$array_category[$slot]."' AND parent_id = (";
}
}
for ($i = 1; $i < count($array_category); $i++) { $category_query .= ")"; }
} elseif (count($array_category) == 1) {
$category_query = "select id from ".$GLOBALS['pre']."nested_tree where title LIKE '".$array_category[0]."' AND parent_id = 0";
rest_error ('NO_CATEGORY');
$response = $bdd->query("select id,label,login,pw from ".$GLOBALS['pre']."items where id_tree = (".$category_query.")");
//					$json[$id]['pw'] = teampass_decrypt_pw($data['pw'],SALT,$rand_key);
}
?>
