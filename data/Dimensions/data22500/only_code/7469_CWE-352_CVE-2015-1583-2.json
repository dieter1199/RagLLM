if($_SERVER['HTTP_REFERER'] != $_SERVER['PHP_SELF']){
$referer_script = preg_replace('#'.$_base_href.'#', '', $_SERVER['HTTP_REFERER']);
if(!in_array($_pages[$referer_script], $_pages)){
echo "not a valid referer";
exit;
}
}