static inline bool unconditional(const struct ipt_ip *ip)
return memcmp(ip, &uncond, sizeof(uncond)) == 0;
if (s->target_offset == sizeof(struct ipt_entry) &&
t->verdict < 0 &&
unconditional(&s->ip)) {
if ((e->target_offset == sizeof(struct ipt_entry) &&
t->verdict < 0 && unconditional(&e->ip)) ||
visited) {
if (!unconditional(&e->ip))
pr_err("Underflows must be unconditional and "
"use the STANDARD target with "
"ACCEPT/DROP\n");