} else if ((new_shape.size() == shape.size() + 1) && new_shape.back() == 1) {
// This is a trivial shift left, then we shift the quant_dim as well.
if (std::equal(shape.begin(), shape.end(), new_shape.begin()) &&
quant_dim == -1) {
quant_dim = shape.size() + quant_dim;
} else {