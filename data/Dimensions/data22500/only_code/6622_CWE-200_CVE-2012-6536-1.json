if ((p->flags & XFRM_STATE_ESN) && !rt)
return -EINVAL;
if (xfrm_replay_state_esn_len(replay_esn) !=
xfrm_replay_state_esn_len(up))
p = kmemdup(up, xfrm_replay_state_esn_len(up), GFP_KERNEL);
pp = kmemdup(up, xfrm_replay_state_esn_len(up), GFP_KERNEL);