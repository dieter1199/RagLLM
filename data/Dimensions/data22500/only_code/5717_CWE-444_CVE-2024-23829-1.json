METHRE: Final[Pattern[str]] = re.compile(r"[!#$%&'*+\-.^_`|~0-9A-Za-z]+")
VERSRE: Final[Pattern[str]] = re.compile(r"HTTP/(\d).(\d)")
HDRRE: Final[Pattern[bytes]] = re.compile(
rb"[\x00-\x1F\x7F-\xFF()<>@,;:\[\]={} \t\"\\]"
)
HEXDIGIT = re.compile(rb"[0-9a-fA-F]+")
if HDRRE.search(bname):
raise InvalidHeader(bname)
name = bname.decode("utf-8", "surrogateescape")
if not length_hdr.strip(" \t").isdecimal():
if not METHRE.fullmatch(method):
# The status code is a three-digit number
if len(status) != 3 or not status.isdecimal():
if not re.fullmatch(HEXDIGIT, size_b):