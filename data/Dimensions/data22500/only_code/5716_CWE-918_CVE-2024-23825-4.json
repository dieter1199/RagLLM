// Check the host of the Import URL against a blacklist of hosts, which should not be accessible, e.g. for security considerations.
$blocked_hosts = array(
'169.254.169.254', // AWS Meta-data API.
if ( in_array( $host, $blocked_hosts, true ) ) {
return new WP_Error( 'table_import_url_host_blocked', '', $this->import_config['url'] );
&& function_exists( 'libxml_disable_entity_loader' );
if ( '<' === $first_character ) {
} elseif ( '{' === $first_character || '[' === $first_character ) {
$format = 'json';