if (!is_string($_POST['itemtype']) || getItemForItemtype($_POST['itemtype']) === false) {
echo json_encode(['success' => false]);
exit();
}
$all_pinned = importArrayFromDB($_SESSION['glpisavedsearches_pinned']);
$already_pinned = $all_pinned[$_POST['itemtype']] ?? 0;
$all_pinned[$_POST['itemtype']] = $already_pinned ? 0 : 1;
$_SESSION['glpisavedsearches_pinned'] = exportArrayToDB($all_pinned);
$success = $user->update(
[
'id'                   => Session::getLoginUserID(),
'savedsearches_pinned' => $_SESSION['glpisavedsearches_pinned'],
]
);
