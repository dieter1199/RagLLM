import java.sql.Statement;
import java.util.Map;
import java.util.Map.Entry;
String sql = connection.nativeSQL("INSERT INTO users(login, email, password_digest, first_name, last_name) VALUES" +
"  ('" + user.getLogin() + "','" + user.getEmail() + "','" + passwordDigest + "','" + user.getFirstName() + "','" + user.getLastName() + "')");
play.Logger.info("Insert user: " + sql);
connection.createStatement().execute(sql);
Statement statement = connection.createStatement();
ResultSet result = statement.executeQuery("SELECT * FROM users WHERE login = '" + user.getLogin() +"'");
Statement getuserStatement = connection.createStatement();
ResultSet resultUser = getuserStatement.executeQuery("SELECT * FROM users "
+ "WHERE (login = '" + login + "' OR email = '" + login + "') AND password_digest = '" + passwordDigest + "'");
getuserStatement.close();
public User getById(String userId) { //TODO change to userId
Statement getuserStatement = connection.createStatement();
ResultSet resultUser = getuserStatement.executeQuery("SELECT * FROM users "
+ "WHERE user_id = '" + userId + "'");
getuserStatement.close();
public boolean checkPasswordForUser(String userId, String password) {
Statement getuserStatement = connection.createStatement();
ResultSet resultUser = getuserStatement.executeQuery("SELECT * FROM users "
+ "WHERE user_id = '" + userId + "' AND password_digest = '" + passwordDigest + "'");
getuserStatement.close();
public void changePassword(String userId, String password) {
Statement statement = connection.createStatement();
String sql = "UPDATE users SET password_digest = '"+ passwordDigest + "' where user_id = '" + userId + "';";
statement.executeUpdate(sql);
statement.close();
public boolean update(String userId, Map<String, String> toUpdate) {
Statement statement = connection.createStatement();
String sql = "UPDATE users SET ";
for (Entry<String, String> entry : toUpdate.entrySet()) {
sql += entry.getKey() + " = '" + entry.getValue() + "', ";
}
sql += " where user_id = '" + userId + "';";
play.Logger.info(sql);
statement.executeUpdate(sql);
statement.close();
Statement statement = connection.createStatement();
ResultSet resultSet = statement.executeQuery("SELECT * FROM random_strangers_of_user(" + userId + ")");
statement.close();
