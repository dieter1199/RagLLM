{
    "cve_id": "CVE-2017-15729",
    "cve_description": "In phpMyFAQ before 2.9.9, there is Cross-Site Request Forgery (CSRF) for adding a glossary.",
    "cve_publish_date": "2017-10-22",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Added missing CSRF protection",
    "type_of_change": "Modification",
    "filename_of_changes": "stat.adminlog.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 69:                     <a class=\"btn btn-danger\" href=\"?action=deleteadminlog\">",
        "// Line_Reference 125:         $text = str_replace('Loginerror', $PMF_LANG['ad_log_lger'], $text);",
        "// Line_Reference 126:         $text = str_replace('Session expired', $PMF_LANG['ad_log_sess'], $text);",
        "// Line_Reference 127:         $text = str_replace('Useredit, ', $PMF_LANG['ad_log_edit'], $text);",
        "// Line_Reference 128:         $text = str_replace('Beitragcreatesave', $PMF_LANG['ad_log_crsa'], $text);",
        "// Line_Reference 129:         $text = str_replace('Beitragcreate', $PMF_LANG['ad_log_crea'], $text);",
        "// Line_Reference 130:         $text = str_replace('Usersave, ', $PMF_LANG['ad_log_ussa'], $text);",
        "// Line_Reference 131:         $text = str_replace('Userdel, ', $PMF_LANG['ad_log_usde'], $text);",
        "// Line_Reference 132:         $text = str_replace('Beitragedit, ', $PMF_LANG['ad_log_beed'], $text);",
        "// Line_Reference 133:         $text = str_replace('Beitragdel, ', $PMF_LANG['ad_log_bede'], $text);",
        "// Line_Reference 134:         echo $text;",
        "// Line_Reference 135:         ?></small>",
        "// Line_Reference 147: } elseif ($user->perm->checkRight($user->getUserId(), 'adminlog') && 'deleteadminlog' == $action) {"
    ]
}
