{
    "cve_id": "CVE-2014-3772",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via a request to index.php followed by a direct request to a file that calls the session_start function before checking the CPM key, as demonstrated by a request to sources/upload/upload.files.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "2.1.20",
    "type_of_change": "Modification",
    "filename_of_changes": "core.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 148:     $dataSession = $db->fetchRow(\"SELECT key_tempo FROM \".$pre.\"users WHERE id=\".$_SESSION['user_id']);",
        "// Line_Reference 194:     $row = $db->fetchRow(\"SELECT valeur FROM \".$pre.\"misc WHERE type = 'admin' AND intitule = 'cpassman_version'\");",
        "// Line_Reference 288:     $sql=\"SELECT * FROM \".$pre.\"users WHERE id = '\".$_SESSION['user_id'].\"'\";",
        "// Line_Reference 289:     $row = $db->query($sql);",
        "// Line_Reference 290:     $data = $db->fetchArray($row);",
        "// Line_Reference 420: $queryCount = $db->fetchRow(\"SELECT COUNT(*) FROM \".$pre.\"users WHERE timestamp >= '\".(time() - 600).\"'\");"
    ]
}
