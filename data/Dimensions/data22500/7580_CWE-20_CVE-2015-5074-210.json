{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "mediaBox.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 137:         ?>",
        "// Line_Reference 139:         <?php foreach($users as $user){ ?>",
        "// Line_Reference 140:             <?php //$userMediaItems = X2Model::model('Media')->findAllByAttributes(array('uploadedBy'=>$user->username)); ?>",
        "// Line_Reference 141:             <?php",
        "// Line_Reference 147:             ?>",
        "// Line_Reference 148:             <?php if($userMediaItems){ // user has any media items? ?>",
        "// Line_Reference 149:                 <?php $toggleUserMediaVisibleUrl = Yii::app()->controller->createUrl('/media/media/toggleUserMediaVisible').\"?user={$user['username']}\"; ?>",
        "// Line_Reference 150:                 <?php $visible = !in_array($user['username'], $hideUsers); ?>",
        "// Line_Reference 151:                 <?php if(!$visible) $minimizeUserMedia .= \"$('#{$user['username']}-media').hide();\\n\"; ?>",
        "// Line_Reference 152:                 <?php $minimizeLink = CHtml::ajaxLink("
    ]
}
