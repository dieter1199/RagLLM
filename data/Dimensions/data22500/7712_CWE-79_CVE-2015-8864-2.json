{
    "cve_id": "CVE-2015-8864",
    "cve_description": "Cross-site scripting (XSS) vulnerability in Roundcube Webmail before 1.0.9 and 1.1.x before 1.1.5 allows remote attackers to inject arbitrary web script or HTML via a crafted SVG, a different vulnerability than CVE-2016-4068.",
    "cve_publish_date": "2017-04-13",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix XSS issue in SVG images handling (#1490625)",
    "type_of_change": "Modification",
    "filename_of_changes": "get.inc",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "75",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 332:                 if ($saved) {",
        "// Line_Reference 341:             // do content filtering to avoid XSS through fake images",
        "// Line_Reference 342:             else if (!empty($_REQUEST['_embed']) && $browser->ie && $browser->ver <= 8) {",
        "// Line_Reference 343:                 if ($body) {",
        "// Line_Reference 344:                     echo preg_match('/<(script|iframe|object)/i', $body) ? '' : $body;",
        "// Line_Reference 345:                     $sent = true;",
        "// Line_Reference 346:                 }",
        "// Line_Reference 347:                 else if ($part->size) {",
        "// Line_Reference 348:                     $stdout = fopen('php://output', 'w');",
        "// Line_Reference 349:                     stream_filter_register('rcube_content', 'rcube_content_filter') or die('Failed to register content filter');",
        "// Line_Reference 350:                     stream_filter_append($stdout, 'rcube_content');",
        "// Line_Reference 351:                     $sent = $MESSAGE->get_part_body($part->mime_id, true, 0, $stdout);",
        "// Line_Reference 352:                 }",
        "// Line_Reference 353:             }",
        "// Line_Reference 354:             // send part as-it-is",
        "// Line_Reference 356:                 if ($body && empty($plugin['download'])) {",
        "// Line_Reference 357:                     header(\"Content-Length: \" . strlen($body));",
        "// Line_Reference 358:                     echo $body;",
        "// Line_Reference 359:                     $sent = true;",
        "// Line_Reference 360:                 }",
        "// Line_Reference 361:                 else if ($part->size) {",
        "// Line_Reference 362:                     // Don't be tempted to set Content-Length to $part->d_parameters['size'] (#1490482)",
        "// Line_Reference 363:                     // RFC2183 says \"The size parameter indicates an approximate size\"",
        "// Line_Reference 364: ",
        "// Line_Reference 365:                     $sent = $MESSAGE->get_part_body($part->mime_id, false, 0, -1);",
        "// Line_Reference 366:                 }"
    ]
}
