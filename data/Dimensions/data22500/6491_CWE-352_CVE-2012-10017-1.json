{
    "cve_id": "CVE-2012-10017",
    "cve_description": "A vulnerability was found in BestWebSoft Portfolio Plugin up to 2.04 on WordPress. It has been classified as problematic. This affects an unknown part. The manipulation leads to cross-site request forgery. It is possible to initiate the attack remotely. Upgrading to version 2.06 is able to address this issue. The patch is named 68af950330c3202a706f0ae9bbb52ceaa17dda9d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-248955.",
    "cve_publish_date": "2023-12-26",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "V2.06 - Cross Site Request Forgery bug was fixed.\n\ngit-svn-id: https://plugins.svn.wordpress.org/portfolio/trunk@576717 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "portfolio.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 4:  * @version 1",
        "// Line_Reference 11: Version: 2.04",
        "// Line_Reference 338: \tfunction prtfl_custom_permalinks() {",
        "// Line_Reference 339: \t\tglobal $wp_rewrite;",
        "// Line_Reference 340: \t\t$wp_rewrite->add_rule( 'portfolio/page/([^/]+)/?$', 'index.php?pagename=portfolio&paged=$matches[1]', 'top' );",
        "// Line_Reference 341: \t\t$wp_rewrite->add_rule( 'portfolio/page/([^/]+)?$', 'index.php?pagename=portfolio&paged=$matches[1]', 'top' );",
        "// Line_Reference 342:     $wp_rewrite->flush_rules();",
        "// Line_Reference 357: \t\tstatic $sp_nonce_flag = false;",
        "// Line_Reference 358: \t\t// Run once",
        "// Line_Reference 359: \t\tif( ! $sp_nonce_flag ) {",
        "// Line_Reference 360: \t\t\tprtfl_echo_nonce();",
        "// Line_Reference 361: \t\t\t$sp_nonce_flag = true;",
        "// Line_Reference 362: \t\t}",
        "// Line_Reference 413: ",
        "// Line_Reference 414: // Use nonce for verification ...",
        "// Line_Reference 415: if( ! function_exists ( 'prtfl_echo_prtfl_nonce' ) ) {",
        "// Line_Reference 416: \tfunction prtfl_echo_nonce () {",
        "// Line_Reference 417: \t\techo sprintf(",
        "// Line_Reference 418: \t\t\t'<input type=\"hidden\" name=\"%1$s\" id=\"%1$s\" value=\"%2$s\" />',",
        "// Line_Reference 419: \t\t\t'prtfl_nonce_name',",
        "// Line_Reference 420: \t\t\twp_create_nonce( plugin_basename(__FILE__) )",
        "// Line_Reference 421: \t\t);",
        "// Line_Reference 422: \t}",
        "// Line_Reference 423: }",
        "// Line_Reference 424: ",
        "// Line_Reference 719: \t\tif( isset( $_REQUEST['prtfl_form_submit'] ) ) {",
        "// Line_Reference 1067: add_action( 'init', 'prtfl_custom_permalinks' ); // add custom permalink for portfolio"
    ]
}
