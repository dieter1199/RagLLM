{
    "cve_id": "CVE-2022-4885",
    "cve_description": "A vulnerability has been found in sviehb jefferson up to 0.3 and classified as critical. This vulnerability affects unknown code of the file src/scripts/jefferson. The manipulation leads to path traversal. The attack can be initiated remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. Upgrading to version 0.4 is able to address this issue. The name of the patch is 53b3f2fc34af0bb32afbcee29d18213e61471d87. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-218020.",
    "cve_publish_date": "2023-01-11",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix path traversal security vulnerability by canonicalizing path names of every inodes and discarding inodes with a path\npointing outside of the extraction directory.\n\nFix path traversal through symlinks by canonicalizing link target path using the extraction directory as root. If the link\nstill points outside the extraction root, it gets discarded. This way symlinks reflects the reality of a filesystem on device\nby pointing to files within the extracted filesystem instead of files from the host executing jefferson.",
    "type_of_change": "Modification",
    "filename_of_changes": "jefferson",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 9: ",
        "// Line_Reference 477:         target_path = os.path.join(os.getcwd(), target, path)",
        "// Line_Reference 490:                         os.symlink(inode.data, target_path)",
        "// Line_Reference 564:         dest_path_fs = os.path.join(dest_path, \"fs_%i\" % fs_index)"
    ]
}
