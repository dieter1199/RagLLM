{
    "cve_id": "CVE-2024-39846",
    "cve_description": "NewPass before 1.2.0 stores passwords (rather than password hashes) directly, which makes it easier to obtain unauthorized access to sensitive information. NOTE: in each case, data at rest is encrypted, but is decrypted within process memory during use.",
    "cve_publish_date": "2024-06-29",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Feature: Store password hash in encrypted shared preferences\n\nPreviously, the database encryption password (used for login as well and created during the first launch) was directly stored encrypted in EncryptedSharedPreferences. With this commit, when a user inputs the password to create the user during the first launch, the password is hashed using PBKDF2WithHmacSHA256, and the resulting hash is stored in encrypted shared preferences.\n\nThen, every time the user inputs the known password to login, the password is hashed using the same algorithm, the same number of iterations, and is confronted with the (hashed) password retrieved from the EncryptedSharedPreferences.\n\nThis improves security by ensuring that the actual password is not stored directly, but rather its hash, making it more difficult for unauthorized access to obtain sensitive information.",
    "type_of_change": "Modification",
    "filename_of_changes": "LoginActivity.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 76:             String savedPasswordSharedPreferences = encryptedSharedPreferences.getString(\"password\", \"\");",
        "// Line_Reference 80:                 StringHelper.setSharedString(savedPasswordSharedPreferences);",
        "// Line_Reference 93:         String password = encryptedSharedPreferences.getString(\"password\", \"\");",
        "// Line_Reference 94:         Boolean isPasswordEmpty = password.isEmpty();",
        "// Line_Reference 182:             loginViewModel.createUser(passwordInput, encryptedSharedPreferences);",
        "// Line_Reference 216:                     loginViewModel.loginUserWithPassword(passwordInput, encryptedSharedPreferences);"
    ]
}
