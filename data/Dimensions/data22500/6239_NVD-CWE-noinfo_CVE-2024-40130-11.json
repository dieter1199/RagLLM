{
    "cve_id": "CVE-2024-40130",
    "cve_description": "open5gs v2.6.4 is vulnerable to Buffer Overflow. via /lib/core/abts.c.",
    "cve_publish_date": "2024-07-16",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fixed dynamic-stack-buffer-overflow (#2578, #2577)",
    "type_of_change": "Modification",
    "filename_of_changes": "ngap-build.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "85",
    "number_of_lines_deleted_vulnerable_to_cve": "61",
    "vulnerable_lines": [
        "// Line_Reference 40:     int i, j;",
        "// Line_Reference 121:     SupportedTAItem = CALLOC(1, sizeof(NGAP_SupportedTAItem_t));",
        "// Line_Reference 123:         ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 124:             test_self()->nr_served_tai[0].list2.tai[0].tac,",
        "// Line_Reference 125:             &SupportedTAItem->tAC);",
        "// Line_Reference 127:         ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 128:             test_self()->nr_served_tai[0].list0.tai[0].tac[0],",
        "// Line_Reference 129:                 &SupportedTAItem->tAC);",
        "// Line_Reference 133:     for (i = 0; i < test_self()->num_of_plmn_support; i++) {",
        "// Line_Reference 134:         plmn_id = &test_self()->plmn_support[i].plmn_id;",
        "// Line_Reference 136:         BroadcastPLMNItem = CALLOC(1, sizeof(NGAP_BroadcastPLMNItem_t));",
        "// Line_Reference 138:         ogs_asn_buffer_to_OCTET_STRING(",
        "// Line_Reference 139:                 plmn_id, OGS_PLMN_ID_LEN, &BroadcastPLMNItem->pLMNIdentity);",
        "// Line_Reference 141:         for (j = 0; j < test_self()->plmn_support[i].num_of_s_nssai; j++) {",
        "// Line_Reference 142:             ogs_s_nssai_t *s_nssai = &test_self()->plmn_support[i].s_nssai[j];",
        "// Line_Reference 144:             SliceSupportItem = CALLOC(1, sizeof(NGAP_SliceSupportItem_t));",
        "// Line_Reference 145:             ogs_asn_uint8_to_OCTET_STRING(s_nssai->sst,",
        "// Line_Reference 146:                     &SliceSupportItem->s_NSSAI.sST);",
        "// Line_Reference 147:             if (s_nssai->sd.v != OGS_S_NSSAI_NO_SD_VALUE) {",
        "// Line_Reference 148:                 SliceSupportItem->s_NSSAI.sD = CALLOC(1, sizeof(NGAP_SD_t));",
        "// Line_Reference 149:                 ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 150:                         s_nssai->sd, SliceSupportItem->s_NSSAI.sD);",
        "// Line_Reference 153:             ASN_SEQUENCE_ADD(&BroadcastPLMNItem->tAISliceSupportList.list,",
        "// Line_Reference 154:                             SliceSupportItem);",
        "// Line_Reference 157:         ASN_SEQUENCE_ADD(&SupportedTAItem->broadcastPLMNList.list,",
        "// Line_Reference 158:                 BroadcastPLMNItem);",
        "// Line_Reference 161:     ASN_SEQUENCE_ADD(&SupportedTAList->list, SupportedTAItem);",
        "// Line_Reference 162: ",
        "// Line_Reference 171:     int i, j;",
        "// Line_Reference 213:         SupportedTAItem = CALLOC(1, sizeof(NGAP_SupportedTAItem_t));",
        "// Line_Reference 215:             ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 216:                 test_self()->nr_served_tai[0].list2.tai[0].tac,",
        "// Line_Reference 217:                 &SupportedTAItem->tAC);",
        "// Line_Reference 219:             ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 220:                 test_self()->nr_served_tai[0].list0.tai[0].tac[0],",
        "// Line_Reference 221:                     &SupportedTAItem->tAC);",
        "// Line_Reference 225:         for (i = 0; i < test_self()->num_of_plmn_support; i++) {",
        "// Line_Reference 226:             plmn_id = &test_self()->plmn_support[i].plmn_id;",
        "// Line_Reference 227: ",
        "// Line_Reference 228:             BroadcastPLMNItem = CALLOC(1, sizeof(NGAP_BroadcastPLMNItem_t));",
        "// Line_Reference 229: ",
        "// Line_Reference 230:             ogs_asn_buffer_to_OCTET_STRING(",
        "// Line_Reference 231:                     plmn_id, OGS_PLMN_ID_LEN, &BroadcastPLMNItem->pLMNIdentity);",
        "// Line_Reference 232: ",
        "// Line_Reference 233:             for (j = 0; j < test_self()->plmn_support[i].num_of_s_nssai; j++) {",
        "// Line_Reference 234:                 ogs_s_nssai_t *s_nssai =",
        "// Line_Reference 235:                     &test_self()->plmn_support[i].s_nssai[j];",
        "// Line_Reference 236: ",
        "// Line_Reference 237:                 SliceSupportItem = CALLOC(1, sizeof(NGAP_SliceSupportItem_t));",
        "// Line_Reference 238:                 ogs_asn_uint8_to_OCTET_STRING(s_nssai->sst,",
        "// Line_Reference 239:                         &SliceSupportItem->s_NSSAI.sST);",
        "// Line_Reference 240:                 if (s_nssai->sd.v != OGS_S_NSSAI_NO_SD_VALUE) {",
        "// Line_Reference 241:                     SliceSupportItem->s_NSSAI.sD = CALLOC(1, sizeof(NGAP_SD_t));",
        "// Line_Reference 242:                     ogs_asn_uint24_to_OCTET_STRING(",
        "// Line_Reference 243:                             s_nssai->sd, SliceSupportItem->s_NSSAI.sD);",
        "// Line_Reference 246:                 ASN_SEQUENCE_ADD(&BroadcastPLMNItem->tAISliceSupportList.list,",
        "// Line_Reference 247:                                 SliceSupportItem);",
        "// Line_Reference 250:             ASN_SEQUENCE_ADD(&SupportedTAItem->broadcastPLMNList.list,",
        "// Line_Reference 251:                     BroadcastPLMNItem);",
        "// Line_Reference 253: ",
        "// Line_Reference 254:         ASN_SEQUENCE_ADD(&SupportedTAList->list, SupportedTAItem);"
    ]
}
