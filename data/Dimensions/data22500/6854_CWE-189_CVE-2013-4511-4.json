{
    "cve_id": "CVE-2013-4511",
    "cve_description": "Multiple integer overflows in Alchemy LCD frame-buffer drivers in the Linux kernel before 3.12 allow local users to create a read-write memory mapping for the entirety of kernel memory, and consequently gain privileges, via crafted mmap operations, related to the (1) au1100fb_fb_mmap function in drivers/video/au1100fb.c and the (2) au1200fb_fb_mmap function in drivers/video/au1200fb.c.",
    "cve_publish_date": "2013-11-12",
    "cwe_id": "CWE-189",
    "cwe_name": "Numeric Errors",
    "cwe_description": "Weaknesses in this category are related to improper calculation or conversion of numbers.",
    "commit_message": "Fix a few incorrectly checked [io_]remap_pfn_range() calls\n\nNico Golde reports a few straggling uses of [io_]remap_pfn_range() that\nreally should use the vm_iomap_memory() helper.  This trivially converts\ntwo of them to the helper, and comments about why the third one really\nneeds to continue to use remap_pfn_range(), and adds the missing size\ncheck.\n\nReported-by: Nico Golde <nico@ngolde.de>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org.",
    "type_of_change": "Modification",
    "filename_of_changes": "au1100fb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 364: \tunsigned int len;",
        "// Line_Reference 365: \tunsigned long start=0, off;",
        "// Line_Reference 369: \tif (vma->vm_pgoff > (~0UL >> PAGE_SHIFT)) {",
        "// Line_Reference 370: \t\treturn -EINVAL;",
        "// Line_Reference 371: \t}",
        "// Line_Reference 372: ",
        "// Line_Reference 373: \tstart = fbdev->fb_phys & PAGE_MASK;",
        "// Line_Reference 374: \tlen = PAGE_ALIGN((start & ~PAGE_MASK) + fbdev->fb_len);",
        "// Line_Reference 375: ",
        "// Line_Reference 376: \toff = vma->vm_pgoff << PAGE_SHIFT;",
        "// Line_Reference 377: ",
        "// Line_Reference 378: \tif ((vma->vm_end - vma->vm_start + off) > len) {",
        "// Line_Reference 379: \t\treturn -EINVAL;",
        "// Line_Reference 380: \t}",
        "// Line_Reference 381: ",
        "// Line_Reference 382: \toff += start;",
        "// Line_Reference 383: \tvma->vm_pgoff = off >> PAGE_SHIFT;",
        "// Line_Reference 384: ",
        "// Line_Reference 388: \tif (io_remap_pfn_range(vma, vma->vm_start, off >> PAGE_SHIFT,",
        "// Line_Reference 389: \t\t\t\tvma->vm_end - vma->vm_start,",
        "// Line_Reference 390: \t\t\t\tvma->vm_page_prot)) {",
        "// Line_Reference 391: \t\treturn -EAGAIN;",
        "// Line_Reference 392: \t}",
        "// Line_Reference 393: ",
        "// Line_Reference 394: \treturn 0;"
    ]
}
