{
    "cve_id": "CVE-2015-6520",
    "cve_description": "IPPUSBXD before 1.22 listens on all interfaces, which allows remote attackers to obtain access to USB connected printers via a direct request.",
    "cve_publish_date": "2015-09-01",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "SECURITY FIX: Actually restrict the access to the printer to localhost\n\nBefore, any machine in any network connected by any of the interfaces (as\nlisted by \"ifconfig\") could access to an IPP-over-USB printer on the assigned\nport, allowing users on remote machines to print and to access the web\nconfiguration interface of a IPP-over-USB printer in contrary to conventional\nUSB printers which are only accessible locally.",
    "type_of_change": "Modification",
    "filename_of_changes": "tcp.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "100",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 34: \t\tERR(\"callocing this failed\");",
        "// Line_Reference 42: \t\tERR(\"sockect open failed\");",
        "// Line_Reference 51: \taddr.sin6_addr = in6addr_any;",
        "// Line_Reference 58: \t\t\tERR(\"Bind on port failed. \"",
        "// Line_Reference 65: \t\tERR(\"listen failed on socket\");",
        "// Line_Reference 182: struct tcp_conn_t *tcp_conn_accept(struct tcp_sock_t *sock)",
        "// Line_Reference 190: \tconn->sd = accept(sock->sd, NULL, NULL);",
        "// Line_Reference 195: "
    ]
}
