{
    "cve_id": "CVE-2015-6520",
    "cve_description": "IPPUSBXD before 1.22 listens on all interfaces, which allows remote attackers to obtain access to USB connected printers via a direct request.",
    "cve_publish_date": "2015-09-01",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "SECURITY FIX: Actually restrict the access to the printer to localhost\n\nBefore, any machine in any network connected by any of the interfaces (as\nlisted by \"ifconfig\") could access to an IPP-over-USB printer on the assigned\nport, allowing users on remote machines to print and to access the web\nconfiguration interface of a IPP-over-USB printer in contrary to conventional\nUSB printers which are only accessible locally.",
    "type_of_change": "Modification",
    "filename_of_changes": "ippusbxd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 174: \tstruct tcp_sock_t *tcp_socket;",
        "// Line_Reference 175: \twhile ((tcp_socket = tcp_open(desired_port)) == NULL &&",
        "// Line_Reference 176: \t       g_options.only_desired_port == 0) {",
        "// Line_Reference 187: \tif (tcp_socket == NULL)",
        "// Line_Reference 190: \tuint16_t real_port = tcp_port_number_get(tcp_socket);",
        "// Line_Reference 219: \t\targs->tcp = tcp_conn_accept(tcp_socket);"
    ]
}
