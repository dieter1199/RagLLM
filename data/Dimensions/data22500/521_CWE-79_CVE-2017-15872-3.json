{
    "cve_id": "CVE-2017-15872",
    "cve_description": "phpwcms 1.8.9 has XSS in include/inc_tmpl/admin.edituser.tmpl.php and include/inc_tmpl/admin.newuser.tmpl.php via the username (aka new_login) field.",
    "cve_publish_date": "2017-10-24",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix stored XSS as reported by Chirag Savla\n\nIt's a pretty old problem – a beginner's mistake in programming. Damn. As far I can see no huge problem because of CSRF and you need to be logged in to the backend. But it wasn't well done from my side.\n\nIf you have older installations check the html() function which were added. Older releases do not know html() – use html_specialchars() instead.",
    "type_of_change": "Modification",
    "filename_of_changes": "admin.newuser.tmpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 90: ?><form action=\"phpwcms.php?do=admin&amp;s=1\" method=\"post\" name=\"edituser\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">",
        "// Line_Reference 107:             <td align=\"right\"><strong style=\"color:#FF3300\"><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>",
        "// Line_Reference 108:             <td><strong style=\"color:#FF3300\"><?php echo nl2br(chop($user_err)) ?></strong></td>",
        "// Line_Reference 116:             <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_login ?>\" size=\"30\" maxlength=\"30\" autocomplete=\"off\"></td>",
        "// Line_Reference 121:             <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_password ?>\" size=\"30\" maxlength=\"50\" autocomplete=\"off\"></td>",
        "// Line_Reference 126:             <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_email ?>\" size=\"30\" maxlength=\"150\"></td>",
        "// Line_Reference 131:             <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_name ?>\" size=\"30\" maxlength=\"80\"></td>",
        "// Line_Reference 139:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?>></td>",
        "// Line_Reference 141:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?>></td>",
        "// Line_Reference 143:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?>></td>",
        "// Line_Reference 155:                   <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?>></td>",
        "// Line_Reference 166:                   <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked($set_user_admin, 1); ?>></td>",
        "// Line_Reference 167:                   <td><label for=\"form_admin\"><?php echo  $BL['be_admin_usr_ifadmin'] ?> <strong style=\"color:#FF0000\">!!!</strong></label></td>",
        "// Line_Reference 183:           <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"><input name=\"form_aktion\" type=\"hidden\" value=\"create_account\"></td></tr>",
        "// Line_Reference 186:             <td><input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_button'] ?>\"></td>",
        "// Line_Reference 195: ",
        "// Line_Reference 196: ?>"
    ]
}
