{
    "cve_id": "CVE-2022-36068",
    "cve_description": "Discourse is an open source discussion platform. In versions prior to 2.8.9 on the `stable` branch and prior to 2.9.0.beta10 on the `beta` and `tests-passed` branches, a moderator can create new and edit existing themes by using the API when they should not be able to do so. The problem is patched in version 2.8.9 on the `stable` branch and version 2.9.0.beta10 on the `beta` and `tests-passed` branches. There are no known workarounds.",
    "cve_publish_date": "2022-09-29",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "SECURITY: moderator shouldn't be able to import a theme via API (#18418)\n\n* SECURITY: moderator shouldn't be able to import a theme via API.\r\n* DEV: apply `AdminConstraint` for all the \"themes\" routes.\r\n\r\nCo-authored-by: Vinoth Kannan <svkn.87@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "routes.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 209:       resources :themes, constraints: AdminConstraint.new",
        "// Line_Reference 210: ",
        "// Line_Reference 211:       post \"themes/import\" => \"themes#import\"",
        "// Line_Reference 212:       post \"themes/upload_asset\" => \"themes#upload_asset\"",
        "// Line_Reference 213:       post \"themes/generate_key_pair\" => \"themes#generate_key_pair\"",
        "// Line_Reference 214:       get \"themes/:id/preview\" => \"themes#preview\"",
        "// Line_Reference 215:       put \"themes/:id/setting\" => \"themes#update_single_setting\""
    ]
}
