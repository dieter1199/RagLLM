{
    "cve_id": "CVE-2021-37491",
    "cve_description": "An issue discovered in src/wallet/wallet.cpp in Dogecoin Project Dogecoin Core 1.14.3 and earlier allows attackers to view sensitive information via CWallet::CreateTransaction() function.",
    "cve_publish_date": "2023-02-07",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "shuffle selected coins before transaction finalization",
    "type_of_change": "Modification",
    "filename_of_changes": "wallet.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 2892:                 // Fill vin",
        "// Line_Reference 2894:                 // Note how the sequence number is set to non-maxint so that",
        "// Line_Reference 2895:                 // the nLockTime set above actually works.",
        "// Line_Reference 2896:                 //",
        "// Line_Reference 2897:                 // BIP125 defines opt-in RBF as any nSequence < maxint-1, so",
        "// Line_Reference 2898:                 // we use the highest possible value in that range (maxint-2)",
        "// Line_Reference 2899:                 // to avoid conflicting with other possible uses of nSequence,",
        "// Line_Reference 2900:                 // and in the spirit of \"smallest possible change from prior",
        "// Line_Reference 2901:                 // behavior.\"",
        "// Line_Reference 2902:                 const uint32_t nSequence = coin_control.signalRbf ? MAX_BIP125_RBF_SEQUENCE : (CTxIn::SEQUENCE_FINAL - 1);",
        "// Line_Reference 2903:                 for (const auto& coin : setCoins)",
        "// Line_Reference 2904:                     txNew.vin.push_back(CTxIn(coin.outpoint,CScript(),",
        "// Line_Reference 2905:                                               nSequence));",
        "// Line_Reference 2999:             for (const auto& coin : setCoins)"
    ]
}
