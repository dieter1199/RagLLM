{
    "cve_id": "CVE-2024-0964",
    "cve_description": "A local file include could be remotely triggered in Gradio due to a vulnerable user-supplied JSON value in an API request.",
    "cve_publish_date": "2024-02-05",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix api event drops (#6556)\n\n* changes\r\n\r\n* changes\r\n\r\n* add changeset\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changs\r\n\r\n* chagnes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes~git push\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* change\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n---------\r\n\r\nCo-authored-by: gradio-pr-bot <gradio-pr-bot@users.noreply.github.com>\r\nCo-authored-by: Ubuntu <ubuntu@ip-172-31-25-241.us-west-2.compute.internal>\r\nCo-authored-by: Abubakar Abid <abubakar@huggingface.co>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "129",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 20: from typing import Any, Callable, Optional",
        "// Line_Reference 29: SSE_URL = \"queue/join\"",
        "// Line_Reference 30: SSE_DATA_URL = \"queue/data\"",
        "// Line_Reference 310: async def get_pred_from_sse(",
        "// Line_Reference 318:     cookies: dict[str, str] | None = None,",
        "// Line_Reference 322:             asyncio.create_task(check_for_cancel(helper, cookies)),",
        "// Line_Reference 324:                 stream_sse(",
        "// Line_Reference 331:                     headers=headers,",
        "// Line_Reference 332:                     cookies=cookies,",
        "// Line_Reference 351: async def check_for_cancel(helper: Communicator, cookies: dict[str, str] | None):",
        "// Line_Reference 360:                 helper.reset_url, json={\"event_id\": helper.event_id}, cookies=cookies",
        "// Line_Reference 365: async def stream_sse(",
        "// Line_Reference 373:     cookies: dict[str, str] | None = None,",
        "// Line_Reference 380:             cookies=cookies,",
        "// Line_Reference 416:                             cookies=cookies,"
    ]
}
