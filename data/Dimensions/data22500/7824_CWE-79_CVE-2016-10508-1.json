{
    "cve_id": "CVE-2016-10508",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in phpThumb() before 1.7.14 allow remote attackers to inject arbitrary web script or HTML via parameters in demo/phpThumb.demo.showpic.php.",
    "cve_publish_date": "2017-08-31",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "demo.showpic security fix\n\nSanitize input data to prevent Reflected XSS problems",
    "type_of_change": "Modification",
    "filename_of_changes": "phpThumb.demo.showpic.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 79: function SafeStripSlashes($string) {",
        "// Line_Reference 80: \treturn (get_magic_quotes_gpc() ? stripslashes($string) : $string);",
        "// Line_Reference 81: }",
        "// Line_Reference 88: \t\t\t$additionalparameters[] = $key.'[]='.SafeStripSlashes($value2);",
        "// Line_Reference 91: \t\t$additionalparameters[] = $key.'='.SafeStripSlashes($value);",
        "// Line_Reference 94: //$imagesrc = $phpThumbLocation.implode('&', $additionalparameters);",
        "// Line_Reference 95: $imagesrc = phpThumbURL(implode($PHPTHUMB_CONFIG['config_high_security_url_separator'], $additionalparameters), $phpThumbLocation);",
        "// Line_Reference 98: echo 'var ns4;';",
        "// Line_Reference 99: echo 'var op5;';",
        "// Line_Reference 100: echo 'function setBrowserWindowSizeToImage() {';",
        "// Line_Reference 101: echo \t'if (!document.getElementById(\"imageimg\")) { return false; }';",
        "// Line_Reference 102: echo\t'sniffBrowsers();';",
        "// Line_Reference 103: echo \t'var imageW = getImageWidth(\"imageimg\");';",
        "// Line_Reference 104: echo \t'var imageH = getImageHeight(\"imageimg\");';",
        "// Line_Reference 111: echo \t\t'document.getElementById(\"showpicspan\").innerHTML = \"<iframe width=\\\"100%\\\" height=\\\"100%\\\" marginheight=\\\"0\\\" marginwidth=\\\"0\\\" frameborder=\\\"0\\\" scrolling=\\\"on\\\" src=\\\"'.$imagesrc.'\\\">Your browser does not support the IFRAME tag. Please use one that does (IE, Firefox, etc).<br><img src=\\\"'.$imagesrc.'\\\"><\\/iframe>\";';",
        "// Line_Reference 115: ?>",
        "// Line_Reference 116: ",
        "// Line_Reference 117: </head>",
        "// Line_Reference 119: <body style=\"margin: 0px;\" onLoad=\"setBrowserWindowSizeToImage();\"><div id=\"showpicspan\"><?php",
        "// Line_Reference 130: \techo 'Usage:<br><br><b>'.$_SERVER['PHP_SELF'].'?src=<i>filename</i>&title=<i>Picture+Title</i></b>';"
    ]
}
