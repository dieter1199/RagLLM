{
    "cve_id": "CVE-2012-1118",
    "cve_description": "The access_has_bug_level function in core/access_api.php in MantisBT before 1.2.9 does not properly restrict access when the private_bug_view_threshold is set to an array, which allows remote attackers to bypass intended restrictions and perform certain operations on private bug reports.",
    "cve_publish_date": "2012-06-29",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Fix bug in access_has_bug_level() for private issues\n\nWhen private_bug_threshold is defined as an array instead of a single\naccess level, e.g. array(0=>40, 1=>70, 2=>90) to prevent developers\nfrom seeing private bugs while granting that privilege to updaters,\naccess_has_bug_level() incorrectly returned true.\n\nThe consequence is that unwanted access to Private bugs was granted to\nusers who are allowed to view them, e.g. allowing them to delete or\nperform other restricted actions.\n\nFixes #10124",
    "type_of_change": "Modification",
    "filename_of_changes": "access_api.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 423: \t# If the bug is private and the user is not the reporter, then the",
        "// Line_Reference 424: \t#  the user must also have higher access than private_bug_threshold",
        "// Line_Reference 426: \t\t$p_access_level = max( $p_access_level, config_get( 'private_bug_threshold' ) );"
    ]
}
