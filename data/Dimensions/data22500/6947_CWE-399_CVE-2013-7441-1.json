{
    "cve_id": "CVE-2013-7441",
    "cve_description": "The modern style negotiation in Network Block Device (nbd-server) 2.9.22 through 3.3 allows remote attackers to cause a denial of service (root process termination) by (1) closing the connection during negotiation or (2) specifying a name for a non-existent export.",
    "cve_publish_date": "2015-05-29",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "nbd-server: handle modern-style negotiation in a child process\n\nPreviously, the modern style negotiation was carried out in the root\nserver (listener) process before forking the actual client handler. This\nmade it possible for a malfunctioning or evil client to terminate the\nroot process simply by querying a non-existent export or aborting in the\nmiddle of the negotation process (caused SIGPIPE in the server).\n\nThis commit moves the negotiation process to the child to keep the root\nprocess up and running no matter what happens during the negotiation.\n\nSee http://sourceforge.net/mailarchive/message.php?msg_id=30410146\n\nSigned-off-by: Tuomas Räsänen <tuomasjjrasanen@tjjr.fi>",
    "type_of_change": "Modification",
    "filename_of_changes": "nbd-server.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "157",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 2428: \t\t\tint net;",
        "// Line_Reference 2436: \t\t\t\tCLIENT *client;",
        "// Line_Reference 2438: \t\t\t\tif((net=accept(sock, (struct sockaddr *) &addrin, &addrinlen)) < 0) {",
        "// Line_Reference 2439: \t\t\t\t\terr_nonfatal(\"accept: %m\");",
        "// Line_Reference 2440: \t\t\t\t\tcontinue;",
        "// Line_Reference 2441: \t\t\t\t}",
        "// Line_Reference 2442: \t\t\t\tclient = negotiate(net, NULL, servers, NEG_INIT | NEG_MODERN);",
        "// Line_Reference 2443: \t\t\t\tif(!client) {",
        "// Line_Reference 2444: \t\t\t\t\tclose(net);",
        "// Line_Reference 2445: \t\t\t\t\tcontinue;",
        "// Line_Reference 2446: \t\t\t\t}",
        "// Line_Reference 2447: \t\t\t\thandle_connection(servers, net, client->server, client);"
    ]
}
