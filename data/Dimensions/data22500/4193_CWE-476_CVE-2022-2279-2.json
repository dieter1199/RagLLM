{
    "cve_id": "CVE-2022-2279",
    "cve_description": "NULL Pointer Dereference in GitHub repository bfabiszewski/libmobi prior to 0.11.",
    "cve_publish_date": "2022-07-01",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix undefined behavior when passing null to strdup",
    "type_of_change": "Modification",
    "filename_of_changes": "opf.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1155:                 opf->metadata->x_meta->dictionary_in_lang = calloc(OPF_META_MAX_TAGS, sizeof(char*));",
        "// Line_Reference 1156:                 if (opf->metadata->x_meta->dictionary_in_lang == NULL) {",
        "// Line_Reference 1157:                     debug_print(\"%s\\n\", \"Memory allocation failed\");",
        "// Line_Reference 1158:                     return MOBI_MALLOC_FAILED;",
        "// Line_Reference 1159:                 }",
        "// Line_Reference 1161:                 opf->metadata->x_meta->dictionary_in_lang[0] = strdup(mobi_get_locale_string(dict_lang_in));",
        "// Line_Reference 1166:                 opf->metadata->x_meta->dictionary_out_lang = calloc(OPF_META_MAX_TAGS, sizeof(char*));",
        "// Line_Reference 1167:                 if (opf->metadata->x_meta->dictionary_out_lang == NULL) {",
        "// Line_Reference 1168:                     debug_print(\"%s\\n\", \"Memory allocation failed\");",
        "// Line_Reference 1169:                     return MOBI_MALLOC_FAILED;",
        "// Line_Reference 1171:                 uint32_t dict_lang_in = *m->mh->dict_output_lang;",
        "// Line_Reference 1172:                 opf->metadata->x_meta->dictionary_out_lang[0] = strdup(mobi_get_locale_string(dict_lang_in));"
    ]
}
