{
    "cve_id": "CVE-2016-15035",
    "cve_description": "A vulnerability was found in Doc2k RE-Chat 1.0. It has been classified as problematic. This affects an unknown part of the file js_on_radio-emergency.de_/re_chat.js. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. The patch is named bd17d497ddd3bab4ef9c6831c747c37cc016c570. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-238155.",
    "cve_publish_date": "2023-08-28",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "XSS #2\n\nErweiterte Ausgabevalidierung für die normalen Chatfunktionen. Siehe https://www.owasp.org/index.php/XSS\r\nEventuelle Überlegung die Validierung der Datentelegramme serverseitig durchzuführen.",
    "type_of_change": "Modification",
    "filename_of_changes": "re_chat.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 104: \t\t\t\t\t\t\tjQuery('#messages').append(jQuery('<div>').addClass('iArtChatMessageItem').addClass('reChatInfo').html('('+data.zeitpunkt+') Willkommen '+data.username+' im Radio-Emergency.de Chat'));",
        "// Line_Reference 152: \t\t\t\t\t\t\tjQuery('#messages').append(jQuery('<div>').addClass('iArtChatMessageItem').addClass('reChatInfo').html('('+data.zeitpunkt+') Willkommen '+data.username+' im Radio-Emergency.de Chat'));",
        "// Line_Reference 184: \t\t\t\t\t    alert('Der Benutzername \"'+data.username+'\" ist bereits in Verwendung');",
        "// Line_Reference 193: \t\t\t\t\t    alert('Der Benutzername \"'+data.username+'\" ist ein geschützter Name des RE-Teams');",
        "// Line_Reference 253: \t\t        \t\t\tjQuery('#messages').append(jQuery('<div>').addClass('iArtChatMessageItem').html('('+msg.zeitpunkt+') <img src=\"http://radio-emergency.de/img/user_'+msg.sex+'_'+msg.istEinAdmin+'.png\" /> '+msg.username+': <span style=\"color:'+msg.farbe+'; font-weight:'+msg.weight+'; font-style:'+msg.style+'\">'+msg.message+'</span>'));",
        "// Line_Reference 282: \t\t\t\t\t\t\t\t\tvar mitdemda = msg.username;",
        "// Line_Reference 342: \t\t\t\t\t\t\t\t\t\tjQuery('#iArt_privChat_'+mitdemda.replace(/ /g, '_').replace(/[^a-z0-9A-Z_]/g, '-')).find('.messages').append(jQuery('<div>').addClass('iArtChatMessageItem').html('('+msg.zeitpunkt+') <img src=\"http://radio-emergency.de/img/user_'+msg.sex+'_'+msg.istEinAdmin+'.png\" /> '+iArt_ChangeMarkup(msg.username, false)+': <span style=\"color:'+msg.farbe+'; font-weight:'+msg.weight+'; font-style:'+msg.style+'\">'+iArt_ChangeMarkup(msg.message, true)+'</span>'));",
        "// Line_Reference 365: \t\t\t\t\t\t\t\t\t\tjQuery('#iArt_privChat_'+msg.fuerden.replace(/ /g, '_').replace(/[^a-z0-9A-Z_]/g, '-')).find('.messages').append(jQuery('<div>').addClass('iArtChatMessageItem').html('('+msg.zeitpunkt+') <img src=\"http://radio-emergency.de/img/user_'+msg.sex+'_'+msg.istEinAdmin+'.png\" /> '+iArt_ChangeMarkup(msg.username, false)+': <span style=\"color:'+msg.farbe+'; font-weight:'+msg.weight+'; font-style:'+msg.style+'\">'+iArt_ChangeMarkup(msg.message, true)+'</span>'));",
        "// Line_Reference 380: \t\t\t\t\t\tjQuery('#iArt_privChat_'+data.benutzer.replace(/ /g, '_').replace(/[^a-z0-9A-Z_]/g, '-')).find('.messages').append(jQuery('<div>').addClass('iArtChatMessageItem').html('('+data.zeitpunkt+') CHATSYSTEM: <span style=\"color:#f00; font-weight:bold;\">--> Nachricht nicht übermittelt da \"'+data.benutzer+'\" nicht mehr online ist! <--</span><br /> --> '+data.message+' <--'));",
        "// Line_Reference 390: \t\t\t\t    \t\tjQuery('#messages').append(jQuery('<div>').addClass('iArtChatMessageItem').addClass('reChatInfo').html('('+data.zeitpunkt+') '+data.username+' hat den Chat betreten'));",
        "// Line_Reference 401: \t\t\t\t\t\t\tjQuery('#messages').append(jQuery('<div>').addClass('iArtChatMessageItem').addClass('reChatInfo').html('('+data.zeitpunkt+') '+data.username+' hat den Chat verlassen'));"
    ]
}
