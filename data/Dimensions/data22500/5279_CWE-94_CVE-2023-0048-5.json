{
    "cve_id": "CVE-2023-0048",
    "cve_description": "Code Injection in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-04",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "Validating/sanitizing user input (#327)\n\n* Better validating log filepath\r\n\r\n* improving configuration read/write function\r\n\r\n* SMTP configuration parameter validation\r\n\r\n* Input validation/sanitization fixes\r\n\r\n* minor fix",
    "type_of_change": "Modification",
    "filename_of_changes": "config_write.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "80",
    "number_of_lines_deleted_vulnerable_to_cve": "46",
    "vulnerable_lines": [
        "// Line_Reference 17:  * Description:",
        "// Line_Reference 18:  * \t\twrites configuration information from the $configValues array to daloradius.conf",
        "// Line_Reference 20:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 25: $configFile = dirname(__FILE__).'/daloradius.conf.php';",
        "// Line_Reference 28: $fp = fopen($configFile, \"w\");",
        "// Line_Reference 29: if ($fp) {",
        "// Line_Reference 30: \tfwrite($fp,",
        "// Line_Reference 31: \t\t\"<?php\\n\".",
        "// Line_Reference 32: \t\t\"/*\\n\".",
        "// Line_Reference 33: \t\t\" *********************************************************************************************************\\n\".",
        "// Line_Reference 34: \t\t\" * daloRADIUS - RADIUS Web Platform\\n\".",
        "// Line_Reference 35: \t\t\" * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\\n\".",
        "// Line_Reference 36: \t\t\" *\\n\".",
        "// Line_Reference 37: \t\t\" * This program is free software; you can redistribute it and/or\\n\".",
        "// Line_Reference 38: \t\t\" * modify it under the terms of the GNU General Public License\\n\".",
        "// Line_Reference 39: \t\t\" * as published by the Free Software Foundation; either version 2\\n\".",
        "// Line_Reference 40: \t\t\" * of the License, or (at your option) any later version.\\n\".",
        "// Line_Reference 41: \t\t\" *\\n\".",
        "// Line_Reference 42: \t\t\" * You should have received a copy of the GNU General Public License\\n\".",
        "// Line_Reference 43: \t\t\" * along with this program; if not, write to the Free Software\\n\".",
        "// Line_Reference 44: \t\t\" * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\\n\".",
        "// Line_Reference 45: \t\t\" *\\n\".",
        "// Line_Reference 46: \t\t\" *********************************************************************************************************\\n\".",
        "// Line_Reference 47: \t\t\" * Description:\\n\".",
        "// Line_Reference 48: \t\t\" *              daloRADIUS Configuration File\\n\".",
        "// Line_Reference 49: \t\t\" *\\n\".",
        "// Line_Reference 50: \t\t\" * Modification Date:\\n\".",
        "// Line_Reference 51: \t\t\" *              $date\\n\".",
        "// Line_Reference 52: \t\t\" *********************************************************************************************************\\n\".",
        "// Line_Reference 53: \t\t\" */\\n\".",
        "// Line_Reference 54: \t\t\"\\n\\n\");",
        "// Line_Reference 55: \tforeach ($configValues as $_configOption => $_configElem) {",
        "// Line_Reference 56: \t\tif (is_array($configValues[$_configOption])) {",
        "// Line_Reference 57: \t\t\t$var = \"\\$configValues['\" . $_configOption . \"'] = \\t\\t\";",
        "// Line_Reference 58: \t\t\t$var .= var_export($configValues[$_configOption], true);",
        "// Line_Reference 59: \t\t\t$var .= \";\\n\";",
        "// Line_Reference 60: \t\t\tfwrite($fp, $var);",
        "// Line_Reference 61: \t\t} else",
        "// Line_Reference 62: \t        fwrite($fp, \"\\$configValues['\" . $_configOption . \"'] = '\" . $configValues[$_configOption] . \"';\\n\");",
        "// Line_Reference 63: \t}",
        "// Line_Reference 64: \tfwrite($fp, \"\\n\\n?>\");",
        "// Line_Reference 65: \tfclose($fp);",
        "// Line_Reference 66: \t$successMsg = \"Updated database settings for configuration file\";",
        "// Line_Reference 67: } else {",
        "// Line_Reference 68: \t$failureMsg = \"Could not open the file for writing: <b>$configFile</b>",
        "// Line_Reference 69: \t<br/>Check file permissions. The file should be writable by the webserver's user/group\";"
    ]
}
