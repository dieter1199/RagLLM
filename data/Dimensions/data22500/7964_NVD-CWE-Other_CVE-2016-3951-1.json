{
    "cve_id": "CVE-2016-3951",
    "cve_description": "Double free vulnerability in drivers/net/usb/cdc_ncm.c in the Linux kernel before 4.5 allows physically proximate attackers to cause a denial of service (system crash) or possibly have unspecified other impact by inserting a USB device with an invalid USB descriptor.",
    "cve_publish_date": "2016-05-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "cdc_ncm: do not call usbnet_link_change from cdc_ncm_bind\n\nusbnet_link_change will call schedule_work and should be\navoided if bind is failing. Otherwise we will end up with\nscheduled work referring to a netdev which has gone away.\n\nInstead of making the call conditional, we can just defer\nit to usbnet_probe, using the driver_info flag made for\nthis purpose.\n\nFixes: 8a34b0ae8778 (\"usbnet: cdc_ncm: apply usbnet_link_change\")\nReported-by: Andrey Konovalov <andreyknvl@gmail.com>\nSuggested-by: Linus Torvalds <torvalds@linux-foundation.org>\nSigned-off-by: Bj√∏rn Mork <bjorn@mork.no>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "cdc_ncm.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 991: \tint ret;",
        "// Line_Reference 992: ",
        "// Line_Reference 1001: \tret = cdc_ncm_bind_common(dev, intf, CDC_NCM_DATA_ALTSETTING_NCM, 0);",
        "// Line_Reference 1002: ",
        "// Line_Reference 1003: \t/*",
        "// Line_Reference 1004: \t * We should get an event when network connection is \"connected\" or",
        "// Line_Reference 1005: \t * \"disconnected\". Set network connection in \"disconnected\" state",
        "// Line_Reference 1006: \t * (carrier is OFF) during attach, so the IP network stack does not",
        "// Line_Reference 1007: \t * start IPv6 negotiation and more.",
        "// Line_Reference 1008: \t */",
        "// Line_Reference 1009: \tusbnet_link_change(dev, 0, 0);",
        "// Line_Reference 1010: \treturn ret;",
        "// Line_Reference 1593: \t.flags = FLAG_POINTTOPOINT | FLAG_NO_SETINT | FLAG_MULTI_PACKET,",
        "// Line_Reference 1606: \t\t\t| FLAG_WWAN,",
        "// Line_Reference 1619: \t\t\t| FLAG_WWAN | FLAG_NOARP,"
    ]
}
