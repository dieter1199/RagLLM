{
    "cve_id": "CVE-2015-1792",
    "cve_description": "The do_free_upto function in crypto/cms/cms_smime.c in OpenSSL before 0.9.8zg, 1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of service (infinite loop) via vectors that trigger a NULL value of a BIO data structure, as demonstrated by an unrecognized X.660 OID for a hash function.",
    "cve_publish_date": "2015-06-12",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "Canonicalise input in CMS_verify.\n\nIf content is detached and not binary mode translate the input to\nCRLF format. Before this change the input was verified verbatim\nwhich lead to a discrepancy between sign and verify.",
    "type_of_change": "Modification",
    "filename_of_changes": "cms_smime.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "73",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 63: static int cms_copy_content(BIO *out, BIO *in, unsigned int flags)",
        "// Line_Reference 65: \tunsigned char buf[4096];",
        "// Line_Reference 66: \tint r = 0, i;",
        "// Line_Reference 67: \tBIO *tmpout = NULL;",
        "// Line_Reference 68: ",
        "// Line_Reference 70: \t\ttmpout = BIO_new(BIO_s_null());",
        "// Line_Reference 73: \t\ttmpout = BIO_new(BIO_s_mem());",
        "// Line_Reference 74: \t\tBIO_set_mem_eof_return(tmpout, 0);",
        "// Line_Reference 77: \t\ttmpout = out;",
        "// Line_Reference 145: \t\twhile (f != upto);",
        "// Line_Reference 326: \tBIO *cmsbio = NULL, *tmpin = NULL;",
        "// Line_Reference 409: ",
        "// Line_Reference 411: \tcmsbio=CMS_dataInit(cms, tmpin);",
        "// Line_Reference 412: \tif (!cmsbio)",
        "// Line_Reference 413: \t\tgoto err;",
        "// Line_Reference 415: \tif (!cms_copy_content(out, cmsbio, flags))",
        "// Line_Reference 416: \t\tgoto err;",
        "// Line_Reference 435: ",
        "// Line_Reference 436: \tif (dcont && (tmpin == dcont))",
        "// Line_Reference 437: \t\tdo_free_upto(cmsbio, dcont);",
        "// Line_Reference 439: \t\tBIO_free_all(cmsbio);"
    ]
}
