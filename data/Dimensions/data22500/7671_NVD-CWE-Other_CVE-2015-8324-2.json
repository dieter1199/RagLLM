{
    "cve_id": "CVE-2015-8324",
    "cve_description": "The ext4 implementation in the Linux kernel before 2.6.34 does not properly track the initialization of certain data structures, which allows physically proximate attackers to cause a denial of service (NULL pointer dereference and panic) via a crafted USB device, related to the ext4_fill_super function.",
    "cve_publish_date": "2016-05-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "ext4: use ext4_get_block_write in buffer write\n\nAllocate uninitialized extent before ext4 buffer write and\nconvert the extent to initialized after io completes.\nThe purpose is to make sure an extent can only be marked\ninitialized after it has been written with new data so\nwe can safely drop the i_mutex lock in ext4 DIO read without\nexposing stale data. This helps to improve multi-thread DIO\nread performance on high-speed disks.\n\nSkip the nobh and data=journal mount cases to make things simple for now.\n\nSigned-off-by: Jiaying Zhang <jiayingz@google.com>\nSigned-off-by: \"Theodore Ts'o\" <tytso@mit.edu>",
    "type_of_change": "Modification",
    "filename_of_changes": "extents.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 1622: \tif (ex && (flag != EXT4_GET_BLOCKS_PRE_IO)",
        "// Line_Reference 1743: \tif (flag != EXT4_GET_BLOCKS_PRE_IO)",
        "// Line_Reference 3068: \tif (flags == EXT4_GET_BLOCKS_PRE_IO) {",
        "// Line_Reference 3084: \tif (flags == EXT4_GET_BLOCKS_CONVERT) {",
        "// Line_Reference 3354: \t\t * io_end structure was created for every async",
        "// Line_Reference 3355: \t\t * direct IO write to the middle of the file.",
        "// Line_Reference 3356: \t\t * To avoid unecessary convertion for every aio dio rewrite",
        "// Line_Reference 3357: \t\t * to the mid of file, here we flag the IO that is really",
        "// Line_Reference 3358: \t\t * need the convertion.",
        "// Line_Reference 3362: \t\tif (flags == EXT4_GET_BLOCKS_PRE_IO) {"
    ]
}
