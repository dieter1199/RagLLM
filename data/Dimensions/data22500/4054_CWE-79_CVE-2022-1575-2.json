{
    "cve_id": "CVE-2022-1575",
    "cve_description": "Arbitrary Code Execution through Sanitizer Bypass in GitHub repository jgraph/drawio prior to 18.0.0. - Arbitrary (remote) code execution in the desktop app. - Stored XSS in the web app.",
    "cve_publish_date": "2022-05-05",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "18.0.0 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Graph.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "61",
    "vulnerable_lines": [
        "// Line_Reference 4: // Workaround for allowing target=\"_blank\" in HTML sanitizer",
        "// Line_Reference 5: // see https://code.google.com/p/google-caja/issues/detail?can=2&q=&colspec=ID%20Type%20Status%20Priority%20Owner%20Summary&groupby=&sort=&id=1296",
        "// Line_Reference 6: if (typeof html4 !== 'undefined')",
        "// Line_Reference 7: {",
        "// Line_Reference 8: \thtml4.ATTRIBS['a::target'] = 0;",
        "// Line_Reference 9: \thtml4.ATTRIBS['source::src'] = 0;",
        "// Line_Reference 10: \thtml4.ATTRIBS['video::src'] = 0;",
        "// Line_Reference 11: \t// Would be nice for tooltips but probably a security risk...",
        "// Line_Reference 12: \t//html4.ATTRIBS['video::autoplay'] = 0;",
        "// Line_Reference 13: \t//html4.ATTRIBS['video::autobuffer'] = 0;",
        "// Line_Reference 14: }",
        "// Line_Reference 15: ",
        "// Line_Reference 1673:  * Sanitizes the given HTML markup.",
        "// Line_Reference 1677: \t// Uses https://code.google.com/p/google-caja/wiki/JsHtmlSanitizer",
        "// Line_Reference 1678: \t// NOTE: Original minimized sanitizer was modified to support",
        "// Line_Reference 1679: \t// data URIs for images, mailto and special data:-links.",
        "// Line_Reference 1680: \t// LATER: Add MathML to whitelisted tags",
        "// Line_Reference 1681: \tfunction urlX(link)",
        "// Line_Reference 1682: \t{",
        "// Line_Reference 1683: \t\tif (link != null && link.toString().toLowerCase().substring(0, 11) !== 'javascript:')",
        "// Line_Reference 1684: \t\t{",
        "// Line_Reference 1685: \t\t\treturn link;",
        "// Line_Reference 1686: \t\t}",
        "// Line_Reference 1687: ",
        "// Line_Reference 1688: \t\treturn null;",
        "// Line_Reference 1689: \t};",
        "// Line_Reference 1690:     function idX(id) { return id };",
        "// Line_Reference 1691: ",
        "// Line_Reference 1692: \treturn html_sanitize(value, urlX, idX);",
        "// Line_Reference 1696:  * Removes all script tags and attributes starting with on.",
        "// Line_Reference 1700: \t// Removes all attributes starting with on",
        "// Line_Reference 1701: \tvar all = div.getElementsByTagName('*');",
        "// Line_Reference 1702: ",
        "// Line_Reference 1703: \tfor (var i = 0; i < all.length; i++)",
        "// Line_Reference 1704: \t{",
        "// Line_Reference 1705: \t\tfor (var j = 0; j < all[i].attributes.length; j++)",
        "// Line_Reference 1706: \t\t{",
        "// Line_Reference 1707: \t\t\tvar attr = all[i].attributes[j];",
        "// Line_Reference 1708: ",
        "// Line_Reference 1709: \t\t\tif (attr.name.length > 2 && attr.name.toLowerCase().substring(0, 2) == 'on')",
        "// Line_Reference 1710: \t\t\t{",
        "// Line_Reference 1711: \t\t\t\tall[i].removeAttribute(attr.name);",
        "// Line_Reference 1712: \t\t\t}",
        "// Line_Reference 1713: \t    }",
        "// Line_Reference 1714: \t}",
        "// Line_Reference 1715: ",
        "// Line_Reference 1716: \tfunction removeAllTags(tagName)",
        "// Line_Reference 1717: \t{",
        "// Line_Reference 1718: \t\tvar nodes = div.getElementsByTagName(tagName);",
        "// Line_Reference 1719: ",
        "// Line_Reference 1720: \t\twhile (nodes.length > 0)",
        "// Line_Reference 1721: \t\t{",
        "// Line_Reference 1722: \t\t\tnodes[0].parentNode.removeChild(nodes[0]);",
        "// Line_Reference 1723: \t\t}",
        "// Line_Reference 1724: \t};",
        "// Line_Reference 1725: ",
        "// Line_Reference 1726: \tremoveAllTags('meta');",
        "// Line_Reference 1727: \tremoveAllTags('script');",
        "// Line_Reference 1728: \tremoveAllTags('metadata');",
        "// Line_Reference 13737: \t\t\t\t\t\t\tthis.linkHint.appendChildGraph.createRemoveIcon(mxResources.get('removeIt',",
        "// Line_Reference 13742: \t\t\t\t\t\t\t}));"
    ]
}
