{
    "cve_id": "CVE-2013-4470",
    "cve_description": "The Linux kernel before 3.12, when UDP Fragmentation Offload (UFO) is enabled, does not properly initialize certain data structures, which allows local users to cause a denial of service (memory corruption and system crash) or possibly gain privileges via a crafted application that uses the UDP_CORK option in a setsockopt system call and sends both short and long packets, related to the ip_ufo_append_data function in net/ipv4/ip_output.c and the ip6_ufo_append_data function in net/ipv6/ip6_output.c.",
    "cve_publish_date": "2013-11-04",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "ip_output: do skb ufo init for peeked non ufo skb as well\n\nNow, if user application does:\nsendto len<mtu flag MSG_MORE\nsendto len>mtu flag 0\nThe skb is not treated as fragmented one because it is not initialized\nthat way. So move the initialization to fix this.\n\nintroduced by:\ncommit e89e9cf539a28df7d0eb1d0a545368e9920b34ac \"[IPv4/IPv6]: UFO Scatter-gather approach\"\n\nSigned-off-by: Jiri Pirko <jiri@resnulli.us>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip_output.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 775: \t\tskb->ip_summed = CHECKSUM_PARTIAL;",
        "// Line_Reference 778: \t\t/* specify the length of each IP datagram fragment */",
        "// Line_Reference 779: \t\tskb_shinfo(skb)->gso_size = maxfraglen - fragheaderlen;",
        "// Line_Reference 780: \t\tskb_shinfo(skb)->gso_type = SKB_GSO_UDP;"
    ]
}
