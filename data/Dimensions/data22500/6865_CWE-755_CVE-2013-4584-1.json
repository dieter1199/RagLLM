{
    "cve_id": "CVE-2013-4584",
    "cve_description": "Perdition before 2.2 may have weak security when handling outbound connections, caused by an error in the STARTTLS IMAP and POP server. ssl_outgoing_ciphers not being applied to STARTTLS connections",
    "cve_publish_date": "2019-11-15",
    "cwe_id": "CWE-755",
    "cwe_name": "Improper Handling of Exceptional Conditions",
    "cwe_description": "The product does not handle or incorrectly handles an exceptional condition.",
    "commit_message": "Use specified ciphers for outgoing STARTLS connections\n\nPerdition(8) says:\n\n        --ssl_outgoing_ciphers STRING:\n\n              Cipher list when making outgoing SSL or TLS connections as\n              per ciphers(1). If empty (\"\") then openssl's default will\n              be used.  (default \"\")\n\nHowever, this is only the case for outgoing connections that do not use\nSTARTTLS (the perdition terminology is confusing here, since what it\ncalls \"TLS\" actually means \"start as cleartext, negotiate to encrypted\nvia STARTTLS\" and what it calls \"SSL\" actually means \"start SSL or TLS\nsession, run service inside that\").\n\n\nThis is a security concern because it means that perdition is not\nobeying the specifications of the administrator, and may accept weaker\nciphersuites than instructed on its backhaul connections.\n\nConsider the case where an administrator wants to offer relatively\npromiscuous IMAP connections to their end users -- if the user's MUA\nonly has some weak cipher suite or cleartext IMAP, we want to accept the\nweak ciphersuite as better than nothing.  However, the admin's backend\nIMAP servers are all under her control, and she knows that they are\ncapable of stronger ciphersuites.  in this case, ssl_listen_ciphers will\nallow weak ciphers, and ssl_outgoing_ciphers will be strict and require\nhigh security, to at least protect the link between perdition and the\nbackend IMAP server.\n\nHowever, if this outgoing connection happens to use IMAP+STARTTLS\ninstead of IMAPS, the bug described here will offer weak ciphersuites to\nthe backend IMAP server.\n\nThis is CVE-2013-4584\nThis is Debian Bug #729028\n\nSigned-off-by: Simon Horman <horms@verge.net.au>",
    "type_of_change": "Modification",
    "filename_of_changes": "perdition.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 988: \t\t      opt.ssl_ca_path, opt.ssl_listen_ciphers, servername);"
    ]
}
