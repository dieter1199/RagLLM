{
    "cve_id": "CVE-2013-5313",
    "cve_description": "Cross-site request forgery (CSRF) vulnerability in core/admin/modules/users/update.php in BigTree CMS 4.0 RC2 and earlier allows remote attackers to hijack the authentication of administrators for requests that modify arbitrary user accounts via an edit user action.",
    "cve_publish_date": "2013-08-19",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Fixed a Cross-Site Request Forgery exploit that would allow logged-in BigTree admins hitting a malicious page to automatically create / update users.",
    "type_of_change": "Modification",
    "filename_of_changes": "update.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 2: \t$perms = json_decode($_POST[\"permissions\"],true);",
        "// Line_Reference 3: \t$_POST[\"permissions\"] = array(\"page\" => $perms[\"Page\"],\"module\" => $perms[\"Module\"],\"resources\" => $perms[\"Resource\"],\"module_gbp\" => $perms[\"ModuleGBP\"]);",
        "// Line_Reference 4: \t$_POST[\"alerts\"] = json_decode($_POST[\"alerts\"],true);",
        "// Line_Reference 5: \t$success = $admin->updateUser($_POST[\"id\"],$_POST);",
        "// Line_Reference 6: ",
        "// Line_Reference 7: \tif (!$success) {",
        "// Line_Reference 8: \t\t$_SESSION[\"bigtree_admin\"][\"update_user\"] = $_POST;",
        "// Line_Reference 9: \t\t$admin->growl(\"Users\",\"Update Failed\",\"error\");",
        "// Line_Reference 10: \t\tBigTree::redirect(ADMIN_ROOT.\"users/edit/\".end($bigtree[\"path\"]).\"/\");",
        "// Line_Reference 12: ",
        "// Line_Reference 13: \t$admin->growl(\"Users\",\"Updated User\");",
        "// Line_Reference 14: ",
        "// Line_Reference 15: \tBigTree::redirect(ADMIN_ROOT.\"users/\");"
    ]
}
