{
    "cve_id": "CVE-2017-7184",
    "cve_description": "The xfrm_replay_verify_len function in net/xfrm/xfrm_user.c in the Linux kernel through 4.10.6 does not validate certain size data after an XFRM_MSG_NEWAE update, which allows local users to obtain root privileges or cause a denial of service (heap-based out-of-bounds access) by leveraging the CAP_NET_ADMIN capability, as demonstrated during a Pwn2Own competition at CanSecWest 2017 for the Ubuntu 16.10 linux-image-* package 4.8.0.41.52.",
    "cve_publish_date": "2017-03-19",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "xfrm_user: validate XFRM_MSG_NEWAE incoming ESN size harder\n\nKees Cook has pointed out that xfrm_replay_state_esn_len() is subject to\nwrapping issues.  To ensure we are correctly ensuring that the two ESN\nstructures are the same size compare both the overall size as reported\nby xfrm_replay_state_esn_len() and the internal length are the same.\n\nCVE-2017-7184\nSigned-off-by: Andy Whitcroft <apw@canonical.com>\nAcked-by: Steffen Klassert <steffen.klassert@secunet.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfrm_user.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 415: \tif (nla_len(rp) < ulen || xfrm_replay_state_esn_len(replay_esn) != ulen)"
    ]
}
