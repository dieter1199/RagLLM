{
    "cve_id": "CVE-2014-5353",
    "cve_description": "The krb5_ldap_get_password_policy_from_dn function in plugins/kdb/ldap/libkdb_ldap/ldap_pwd_policy.c in MIT Kerberos 5 (aka krb5) before 1.13.1, when the KDC uses LDAP, allows remote authenticated users to cause a denial of service (daemon crash) via a successful LDAP query with no results, as demonstrated by using an incorrect object type for a password policy.",
    "cve_publish_date": "2014-12-16",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix LDAP misused policy name crash [CVE-2014-5353]\n\nIn krb5_ldap_get_password_policy_from_dn, if LDAP_SEARCH returns\nsuccessfully with no results, return KRB5_KDB_NOENTRY instead of\nreturning success with a zeroed-out policy object.  This fixes a null\ndereference when an admin attempts to use an LDAP ticket policy name\nas a password policy name.\n\nCVE-2014-5353:\n\nIn MIT krb5, when kadmind is configured to use LDAP for the KDC\ndatabase, an authenticated remote attacker can cause a NULL dereference\nby attempting to use a named ticket policy object as a password policy\nfor a principal.  The attacker needs to be authenticated as a user who\nhas the elevated privilege for setting password policy by adding or\nmodifying principals.\n\nQueries to LDAP scoped to the krbPwdPolicy object class will correctly\nnot return entries of other classes, such as ticket policy objects, but\nmay return success with no returned elements if an object with the\nrequested DN exists in a different object class.  In this case, the\nroutine to retrieve a password policy returned success with a password\npolicy object that consisted entirely of zeroed memory.  In particular,\naccesses to the policy name will dereference a NULL pointer.  KDC\noperation does not access the policy name field, but most kadmin\noperations involving the principal with incorrect password policy\nwill trigger the crash.\n\nThanks to Patrik Kis for reporting this problem.\n\nCVSSv2 Vector: AV:N/AC:M/Au:S/C:N/I:N/A:C/E:H/RL:OF/RC:C\n\n[kaduk@mit.edu: CVE description and CVSS score]\n\nticket: 8051 (new)\ntarget_version: 1.13.1\ntags: pullup",
    "type_of_change": "Modification",
    "filename_of_changes": "ldap_pwd_policy.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 317:     if (ent != NULL) {",
        "// Line_Reference 318:         if ((st = populate_policy(context, ld, ent, pol_name, *policy)) != 0)",
        "// Line_Reference 319:             goto cleanup;"
    ]
}
