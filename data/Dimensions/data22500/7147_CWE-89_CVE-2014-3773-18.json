{
    "cve_id": "CVE-2014-3773",
    "cve_description": "Multiple SQL injection vulnerabilities in TeamPass before 2.1.20 allow remote attackers to execute arbitrary SQL commands via the login parameter in a (1) send_pw_by_email or (2) generate_new_password action in sources/main.queries.php; iDisplayStart parameter to (3) datatable.logs.php or (4) a file in source/datatable/; or iDisplayLength parameter to (5) datatable.logs.php or (6) a file in source/datatable/; or allow remote authenticated users to execute arbitrary SQL commands via a sSortDir_ parameter to (7) datatable.logs.php or (8) a file in source/datatable/.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Security/API (beta) improvements",
    "type_of_change": "Modification",
    "filename_of_changes": "datatable.logs.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 44:         $sLimit = \"LIMIT \". mysql_real_escape_string($_GET['iDisplayStart']) .\", \"",
        "// Line_Reference 45:                 . mysql_real_escape_string($_GET['iDisplayLength']) ;",
        "// Line_Reference 50:     if (isset($_GET['iSortCol_0'])) {",
        "// Line_Reference 52:         for ($i=0; $i<intval($_GET['iSortingCols']); $i++) {",
        "// Line_Reference 53:             if ($_GET[ 'bSortable_'.intval($_GET['iSortCol_'.$i]) ] == \"true\") {",
        "// Line_Reference 54:                 $sOrder .= $aColumns[ intval(mysql_real_escape_string($_GET['iSortCol_'.$i])) ].\"",
        "// Line_Reference 55:                     \".mysql_real_escape_string($_GET['sSortDir_'.$i]) .\", \";",
        "// Line_Reference 56:             }",
        "// Line_Reference 57:         }"
    ]
}
