{
    "cve_id": "CVE-2014-8117",
    "cve_description": "softmagic.c in file before 5.21 does not properly limit recursion, which allows remote attackers to cause a denial of service (CPU consumption or crash) via unspecified vectors.",
    "cve_publish_date": "2014-12-17",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "- reduce recursion level from 20 to 10 and make a symbolic constant for it.\n- pull out the guts of saving and restoring the output buffer into functions\n  and take care not to overwrite the error message if an error happened.",
    "type_of_change": "Modification",
    "filename_of_changes": "softmagic.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 35: FILE_RCSID(\"@(#)$File: softmagic.c,v 1.196 2014/11/07 15:24:14 christos Exp $\")",
        "// Line_Reference 1220: \tuint32_t soffset, offset = ms->offset;",
        "// Line_Reference 1223: \tchar *sbuf, *rbuf;",
        "// Line_Reference 1227: \tif (recursion_level >= 20) {",
        "// Line_Reference 1674: \t\tsbuf = ms->o.buf;",
        "// Line_Reference 1675: \t\tsoffset = ms->offset;",
        "// Line_Reference 1676: \t\tms->o.buf = NULL;",
        "// Line_Reference 1677: \t\tms->offset = 0;",
        "// Line_Reference 1682: \t\trbuf = ms->o.buf;",
        "// Line_Reference 1683: \t\tms->o.buf = sbuf;",
        "// Line_Reference 1684: \t\tms->offset = soffset;",
        "// Line_Reference 1702: \t\tsbuf = m->value.s;",
        "// Line_Reference 1703: \t\tif (*sbuf == '^') {",
        "// Line_Reference 1704: \t\t\tsbuf++;",
        "// Line_Reference 1707: \t\tif (file_magicfind(ms, sbuf, &ml) == -1) {",
        "// Line_Reference 1708: \t\t\tfile_error(ms, 0, \"cannot find entry `%s'\", sbuf);"
    ]
}
