{
    "cve_id": "CVE-2022-3004",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository yetiforcecompany/yetiforcecrm prior to 6.4.0.",
    "cve_publish_date": "2022-09-20",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Improved worflow panel",
    "type_of_change": "Modification",
    "filename_of_changes": "Step2.tpl",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 11: \t\t  class=\"tpl-Settings-Workflows-Step2 form-horizontal\">",
        "// Line_Reference 12: \t\t<input type=\"hidden\" name=\"module\" value=\"Workflows\"/>",
        "// Line_Reference 13: \t\t<input type=\"hidden\" name=\"action\" value=\"Save\"/>",
        "// Line_Reference 14: \t\t<input type=\"hidden\" name=\"parent\" value=\"Settings\"/>",
        "// Line_Reference 15: \t\t<input type=\"hidden\" class=\"step\" value=\"2\"/>",
        "// Line_Reference 16: \t\t<input type=\"hidden\" name=\"summary\" value=\"{$WORKFLOW_MODEL->get('summary')}\"/>",
        "// Line_Reference 17: \t\t<input type=\"hidden\" name=\"record\" value=\"{$WORKFLOW_MODEL->get('record')}\"/>",
        "// Line_Reference 18: \t\t<input type=\"hidden\" name=\"module_name\" value=\"{$WORKFLOW_MODEL->get('module_name')}\"/>",
        "// Line_Reference 19: \t\t<input type=\"hidden\" name=\"execution_condition\" value=\"{$WORKFLOW_MODEL->get('execution_condition')}\"/>",
        "// Line_Reference 20: \t\t<input type=\"hidden\" name=\"conditions\" id=\"advanced_filter\" value=''/>",
        "// Line_Reference 22: \t\t\t   value=\"{\\App\\Purifier::encodeHtml(\\App\\Json::encode($WORKFLOW_MODEL->get('conditions')))}\"/>",
        "// Line_Reference 23: \t\t<input type=\"hidden\" name=\"filtersavedinnew\" value=\"{$WORKFLOW_MODEL->get('filtersavedinnew')}\"/>",
        "// Line_Reference 24: \t\t<input type=\"hidden\" name=\"schtypeid\" value=\"{$WORKFLOW_MODEL->get('schtypeid')}\"/>",
        "// Line_Reference 25: \t\t<input type=\"hidden\" name=\"schtime\" value=\"{$WORKFLOW_MODEL->get('schtime')}\"/>",
        "// Line_Reference 26: \t\t<input type=\"hidden\" name=\"schdate\" value=\"{$WORKFLOW_MODEL->get('schdate')}\"/>",
        "// Line_Reference 27: \t\t<input type=\"hidden\" name=\"params\" value=\"{\\App\\Purifier::encodeHtml($WORKFLOW_MODEL->get('params'))}\"/>",
        "// Line_Reference 29: \t\t\t   value=\"{\\App\\Purifier::encodeHtml(\\App\\Json::encode($WORKFLOW_MODEL->get('schdayofweek')))}\"/>",
        "// Line_Reference 31: \t\t\t   value=\"{\\App\\Purifier::encodeHtml(\\App\\Json::encode($WORKFLOW_MODEL->get('schdayofmonth')))}\"/>",
        "// Line_Reference 33: \t\t\t   value=\"{\\App\\Purifier::encodeHtml($WORKFLOW_MODEL->get('schannualdates'))}\"/>",
        "// Line_Reference 45: \t\t\t\t\t\t<span class=\"col-md-6\"><input type=\"radio\" name=\"conditionstype\" class=\"alignMiddle\" checked=\"\"/>&nbsp;&nbsp;<span",
        "// Line_Reference 46: \t\t\t\t\t\t\t\t\tclass=\"alignMiddle\">{\\App\\Language::translate('LBL_USE_EXISTING_CONDITIONS',$QUALIFIED_MODULE)}</span></span>",
        "// Line_Reference 48: \t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"alignMiddle recreate\"/>&nbsp;&nbsp;<span",
        "// Line_Reference 49: \t\t\t\t\t\t\t\t\tclass=\"alignMiddle\">{\\App\\Language::translate('LBL_RECREATE_CONDITIONS',$QUALIFIED_MODULE)}</span></span>",
        "// Line_Reference 51: \t\t\t\t\t<br/>",
        "// Line_Reference 56: \t\t\t\t\t\t<strong>{\\App\\Language::translate('LBL_CHOOSE_FILTER_CONDITIONS',$MODULE)}</strong></h5>",
        "// Line_Reference 64: \t\t<br/>",
        "// Line_Reference 85: \t\t<br/><br/>"
    ]
}
