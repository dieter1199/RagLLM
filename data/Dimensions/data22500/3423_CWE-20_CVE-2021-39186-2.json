{
    "cve_id": "CVE-2021-39186",
    "cve_description": "GlobalNewFiles is a MediaWiki extension maintained by Miraheze. Prior to commit number cee254e1b158cdb0ddbea716b1d3edc31fa4fb5d, the username column of the GlobalNewFiles special page is vulnerable to a stored XSS. Commit number cee254e1b158cdb0ddbea716b1d3edc31fa4fb5d contains a patch. As a workaround, one may disallow <,> (or other characters required to insert html/js) from being used in account names so an XSS is not possible.",
    "cve_publish_date": "2021-09-01",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "SECURITY: Fix XSS issues GlobalNewFilesPager\n\nFix XSS issues in GlobalNewFilesPager by using MediaWiki's LinkRenderer\nand Html utilities instead of constructing (unescaped) HTML messages\ndirectly.\n\nFor more details, see https://phabricator.miraheze.org/T7935.",
    "type_of_change": "Modification",
    "filename_of_changes": "GlobalNewFilesPager.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 6: \tfunction __construct() {",
        "// Line_Reference 9: \t\tif ( $this->getRequest()->getText( 'sort', 'files_date' ) == 'files_date' ) {",
        "// Line_Reference 14: ",
        "// Line_Reference 15: \t\tparent::__construct( $this->getContext() );",
        "// Line_Reference 39: \t\t$wiki = $row->files_dbname;",
        "// Line_Reference 40: ",
        "// Line_Reference 49: \t\t\t\t$formatted = \"<img src=\\\"{$row->files_url}\\\" style=\\\"width:135px;height:135px;\\\">\";",
        "// Line_Reference 52: \t\t\t\t$formatted = \"<a href=\\\"{$row->files_page}\\\">{$row->files_name}</a>\";",
        "// Line_Reference 55: \t\t\t\t$formatted = \"<a href=\\\"/wiki/Special:CentralAuth/{$row->files_user}\\\">{$row->files_user}</a>\";"
    ]
}
