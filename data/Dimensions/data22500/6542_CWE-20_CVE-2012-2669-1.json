{
    "cve_id": "CVE-2012-2669",
    "cve_description": "The main function in tools/hv/hv_kvp_daemon.c in hypervkvpd, as distributed in the Linux kernel before 3.4.5, does not validate the origin of Netlink messages, which allows local users to spoof Netlink communication via a crafted connector message.",
    "cve_publish_date": "2012-12-27",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Tools: hv: verify origin of netlink connector message\n\nThe SuSE security team suggested to use recvfrom instead of recv to be\ncertain that the connector message is originated from kernel.\n\nCVE-2012-2669\n\nSigned-off-by: Olaf Hering <olaf@aepfle.de>\nSigned-off-by: Marcus Meissner <meissner@suse.de>\nSigned-off-by: Sebastian Krahmer <krahmer@suse.de>\nSigned-off-by: K. Y. Srinivasan <kys@microsoft.com>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "hv_kvp_daemon.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 708: \t\tlen = recv(fd, kvp_recv_buffer, sizeof(kvp_recv_buffer), 0);",
        "// Line_Reference 710: \t\tif (len < 0) {",
        "// Line_Reference 711: \t\t\tsyslog(LOG_ERR, \"recv failed; error:%d\", len);"
    ]
}
