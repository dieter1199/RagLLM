{
    "cve_id": "CVE-2016-10270",
    "cve_description": "LibTIFF 4.0.7 allows remote attackers to cause a denial of service (heap-based buffer over-read) or possibly have unspecified other impact via a crafted TIFF image, related to \"READ of size 8\" and libtiff/tif_read.c:523:22.",
    "cve_publish_date": "2017-03-24",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "* libtiff/tif_dirread.c: modify ChopUpSingleUncompressedStrip() to\ninstanciate compute ntrips as TIFFhowmany_32(td->td_imagelength, rowsperstrip),\ninstead of a logic based on the total size of data. Which is faulty is\nthe total size of data is not sufficient to fill the whole image, and thus\nresults in reading outside of the StripByCounts/StripOffsets arrays when\nusing TIFFReadScanline().\nReported by Agostino Sarubbo.\nFixes http://bugzilla.maptools.org/show_bug.cgi?id=2608.\n\n* libtiff/tif_strip.c: revert the change in TIFFNumberOfStrips() done\nfor http://bugzilla.maptools.org/show_bug.cgi?id=2587 / CVE-2016-9273 since\nthe above change is a better fix that makes it unnecessary.",
    "type_of_change": "Modification",
    "filename_of_changes": "tif_strip.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 66:     /* If the value was already computed and store in td_nstrips, then return it,",
        "// Line_Reference 67:        since ChopUpSingleUncompressedStrip might have altered and resized the",
        "// Line_Reference 68:        since the td_stripbytecount and td_stripoffset arrays to the new value",
        "// Line_Reference 69:        after the initial affectation of td_nstrips = TIFFNumberOfStrips() in",
        "// Line_Reference 70:        tif_dirread.c ~line 3612.",
        "// Line_Reference 71:        See http://bugzilla.maptools.org/show_bug.cgi?id=2587 */",
        "// Line_Reference 72:     if( td->td_nstrips )",
        "// Line_Reference 73:         return td->td_nstrips;",
        "// Line_Reference 74: "
    ]
}
