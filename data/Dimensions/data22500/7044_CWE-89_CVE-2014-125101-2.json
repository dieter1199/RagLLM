{
    "cve_id": "CVE-2014-125101",
    "cve_description": "A vulnerability classified as critical has been found in Portfolio Gallery Plugin up to 1.1.8 on WordPress. This affects an unknown part. The manipulation leads to sql injection. It is possible to initiate the attack remotely. Upgrading to version 1.1.9 is able to address this issue. The identifier of the patch is 58ed88243e17df766036f4857041edaf358076d3. It is recommended to upgrade the affected component. The identifier VDB-230085 was assigned to this vulnerability.",
    "cve_publish_date": "2023-05-28",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "SQL Injection bag has fixed in Portfolio Gallery\n\ngit-svn-id: https://plugins.svn.wordpress.org/portfolio-gallery/trunk@993521 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "portfolios_view.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "185",
    "vulnerable_lines": [
        "// Line_Reference 600: ",
        "// Line_Reference 601: ",
        "// Line_Reference 602: function html_popup_posts($ord_elem, $count_ord,$images,$row,$cat_row, $rowim, $rowsld, $paramssld, $rowsposts, $rowsposts8, $postsbycat){",
        "// Line_Reference 603: \tglobal $wpdb;",
        "// Line_Reference 604: ",
        "// Line_Reference 605: ?>",
        "// Line_Reference 606: \t\t\t<style>",
        "// Line_Reference 607: \t\t\t\thtml.wp-toolbar {",
        "// Line_Reference 608: \t\t\t\t\tpadding:0px !important;",
        "// Line_Reference 609: \t\t\t\t}",
        "// Line_Reference 610: \t\t\t\t#wpadminbar,#adminmenuback,#screen-meta, .update-nag,#dolly {",
        "// Line_Reference 611: \t\t\t\t\tdisplay:none;",
        "// Line_Reference 612: \t\t\t\t}",
        "// Line_Reference 613: \t\t\t\t#wpbody-content {",
        "// Line_Reference 614: \t\t\t\t\tpadding-bottom:30px;",
        "// Line_Reference 615: \t\t\t\t}",
        "// Line_Reference 616: \t\t\t\t#adminmenuwrap {display:none !important;}",
        "// Line_Reference 617: \t\t\t\t.auto-fold #wpcontent, .auto-fold #wpfooter {",
        "// Line_Reference 618: \t\t\t\t\tmargin-left: 0px;",
        "// Line_Reference 619: \t\t\t\t}",
        "// Line_Reference 620: \t\t\t\t#wpfooter {display:none;}",
        "// Line_Reference 621: \t\t\t</style>",
        "// Line_Reference 622: \t\t\t<script type=\"text/javascript\">",
        "// Line_Reference 623: \t\t\t\tjQuery(document).ready(function() {",
        "// Line_Reference 624: ",
        "// Line_Reference 625: \t\t\t\t\tjQuery('.huge-it-insert-post-button').on('click', function() {",
        "// Line_Reference 626: \t\t\t\t\t\tvar ID1 = jQuery('#huge-it-add-posts-params').val();",
        "// Line_Reference 627: \t\t\t\t\t\tif(ID1==\"\"){alert(\"Please select images to insert into portfolio.\");return false;}",
        "// Line_Reference 628: ",
        "// Line_Reference 629: \t\t\t\t\t\twindow.parent.uploadID.val(ID1);",
        "// Line_Reference 630: ",
        "// Line_Reference 631: \t\t\t\t\t\ttb_remove();",
        "// Line_Reference 632: \t\t\t\t\t\tjQuery(\"#save-buttom\").click();",
        "// Line_Reference 633: ",
        "// Line_Reference 634: \t\t\t\t\t});",
        "// Line_Reference 635: ",
        "// Line_Reference 636: \t\t\t\t\tjQuery('.huge-it-post-checked').change(function(){",
        "// Line_Reference 637: \t\t\t\t\t\tif(jQuery(this).is(':checked')){",
        "// Line_Reference 638: \t\t\t\t\t\t\tjQuery(this).addClass('active');",
        "// Line_Reference 639: \t\t\t\t\t\t\tjQuery(this).parent().addClass('active');",
        "// Line_Reference 640: \t\t\t\t\t\t}else {",
        "// Line_Reference 641: \t\t\t\t\t\t\tjQuery(this).removeClass('active');",
        "// Line_Reference 642: \t\t\t\t\t\t\tjQuery(this).parent().removeClass('active');",
        "// Line_Reference 643: \t\t\t\t\t\t}",
        "// Line_Reference 644: ",
        "// Line_Reference 645: \t\t\t\t\t\tvar inputval=\"\";",
        "// Line_Reference 646: \t\t\t\t\t\tjQuery('#huge-it-add-posts-params').val(\"\");",
        "// Line_Reference 647: \t\t\t\t\t\tjQuery('.huge-it-post-checked').each(function(){",
        "// Line_Reference 648: \t\t\t\t\t\t\tif(jQuery(this).is(':checked')){",
        "// Line_Reference 649: \t\t\t\t\t\t\t\tinputval+=jQuery(this).val()+\";\";",
        "// Line_Reference 650: \t\t\t\t\t\t\t}",
        "// Line_Reference 651: \t\t\t\t\t\t});",
        "// Line_Reference 652: \t\t\t\t\t\tjQuery('#huge-it-add-posts-params').val(inputval);",
        "// Line_Reference 653: \t\t\t\t\t});",
        "// Line_Reference 654: ",
        "// Line_Reference 655: ",
        "// Line_Reference 656: \t\t\t\t\tjQuery(\"#huge-it-categories-list\").change(function(){",
        "// Line_Reference 657: \t\t\t\t\t\tvar currentCategoryID=jQuery(this).val();",
        "// Line_Reference 658: ",
        "// Line_Reference 659: \t\t\t\t\t\tjQuery('#huge-it-posts-list li').not(\"#huge-it-posts-list-heading\").css({\"display\":\"none\"});",
        "// Line_Reference 660: \t\t\t\t\t\tjQuery('li[data-id*=\"'+currentCategoryID+'\"]').css({\"display\":\"block\"});",
        "// Line_Reference 661: ",
        "// Line_Reference 662: \t\t\t\t\t});",
        "// Line_Reference 663: \t\t\t\t\t//jQuery(\"#huge-it-categories-list\").change();",
        "// Line_Reference 664: ",
        "// Line_Reference 665: \t\t\t\t\tjQuery('#huge_it_portfolio_add_posts_wrap .view-type-block a').click(function(){",
        "// Line_Reference 666: \t\t\t\t\t\tjQuery('#huge_it_portfolio_add_posts_wrap .view-type-block a').removeClass('active');",
        "// Line_Reference 667: \t\t\t\t\t\tjQuery(this).addClass('active');",
        "// Line_Reference 668: \t\t\t\t\t\tvar strtype=jQuery(this).attr('href').replace('#','');",
        "// Line_Reference 669: \t\t\t\t\t\tjQuery('#huge-it-posts-list').removeClass('list').removeClass('thumbs');",
        "// Line_Reference 670: \t\t\t\t\t\tjQuery('#huge-it-posts-list').addClass(strtype);",
        "// Line_Reference 671: \t\t\t\t\t\treturn false;",
        "// Line_Reference 672: \t\t\t\t\t});",
        "// Line_Reference 673: ",
        "// Line_Reference 674: ",
        "// Line_Reference 675: \t\t\t\t\tjQuery('.updated').css({\"display\":\"none\"});",
        "// Line_Reference 676: \t\t\t\t<?php\tif($_GET[\"closepop\"] == 1){ ?>",
        "// Line_Reference 677: \t\t\t\t\tjQuery(\"#closepopup\").click();",
        "// Line_Reference 678: \t\t\t\t\tself.parent.location.reload();",
        "// Line_Reference 679: \t\t\t\t<?php\t} ?>",
        "// Line_Reference 680: \t\t\t\t});",
        "// Line_Reference 681: ",
        "// Line_Reference 682: \t\t\t</script>",
        "// Line_Reference 683: \t\t\t<a id=\"closepopup\"  onclick=\" parent.eval('tb_remove()')\" style=\"display:none;\" > [X] </a>",
        "// Line_Reference 684: ",
        "// Line_Reference 685: ",
        "// Line_Reference 686: \t<div id=\"huge_it_portfolio_add_posts\">",
        "// Line_Reference 687: \t\t\t\t\t<div id=\"huge_it_portfolio_add_posts_wrap\">",
        "// Line_Reference 688: \t\t\t\t\t\t<h2>Add post</h2>",
        "// Line_Reference 689: \t\t\t\t\t\t<div class=\"control-panel\">",
        "// Line_Reference 690: \t\t\t\t\t\t<form method=\"post\"  onkeypress=\"doNothing()\" action=\"admin.php?page=portfolios_huge_it_portfolio&task=popup_posts&id=<?php echo $_GET['id']; ?>\" id=\"huge-it-category-form\" name=\"admin_form\">",
        "// Line_Reference 691: \t\t\t\t\t\t\t<label for=\"huge-it-categories-list\">Select Category <select id=\"huge-it-categories-list\" name=\"iframecatid\" onchange=\"this.form.submit()\">",
        "// Line_Reference 692: ",
        "// Line_Reference 693: \t\t\t\t\t\t\t <?php $categories = get_categories(  ); ?>",
        "// Line_Reference 694: ",
        "// Line_Reference 695: \t\t\t\t\t\t\t<?php\t foreach ($categories as $strcategories){",
        "// Line_Reference 696: \t\t\t\t\t\t\tif(isset($_POST[\"iframecatid\"])){",
        "// Line_Reference 697: ?>",
        "// Line_Reference 698: \t\t\t\t\t\t\t\t <option value=\"<?php echo $strcategories->cat_ID; ?>\" <?php if($strcategories->cat_ID == $_POST[\"iframecatid\"]){echo 'selected=\"selected\"';} ?>><?php echo $strcategories->cat_name; ?></option>';",
        "// Line_Reference 699: ",
        "// Line_Reference 700: \t\t\t\t\t\t\t<?php\t}",
        "// Line_Reference 701: else",
        "// Line_Reference 702: {",
        "// Line_Reference 703: ?>",
        "// Line_Reference 704: \t\t\t\t\t\t\t\t<option value=\"<?php echo $strcategories->cat_ID; ?>\"><?php echo $strcategories->cat_name; ?></option>';",
        "// Line_Reference 705: <?php",
        "// Line_Reference 706: }\t\t\t\t\t\t\t}",
        "// Line_Reference 707: \t\t\t\t\t\t\t?>",
        "// Line_Reference 708: \t\t\t\t\t\t\t</select></label>",
        "// Line_Reference 709: \t\t\t\t\t\t\t</form>",
        "// Line_Reference 710: \t\t\t\t\t\t\t<form method=\"post\"  onkeypress=\"doNothing()\" action=\"admin.php?page=portfolios_huge_it_portfolio&task=popup_posts&id=<?php echo $_GET['id']; ?>&closepop=1\" id=\"admin_form\" name=\"admin_form\">",
        "// Line_Reference 711: \t\t\t\t\t\t\t<button class='save-portfolio-options button-primary huge-it-insert-post-button' id='huge-it-insert-post-button-top'>Insert Posts</button>",
        "// Line_Reference 712: \t\t\t\t\t\t\t<label for=\"huge-it-description-length\">Description Length <input id=\"huge-it-description-length\" type=\"text\" name=\"posthuge-it-description-length\" value=\"<?php echo $row->published; ?>\" placeholder=\"Description length\" /></label>",
        "// Line_Reference 713: \t\t\t\t\t\t\t<div class=\"view-type-block\">",
        "// Line_Reference 714: \t\t\t\t\t\t\t\t<a class=\"view-type list active\" href=\"#list\">View List</a>",
        "// Line_Reference 715: \t\t\t\t\t\t\t\t<a class=\"view-type thumbs\" href=\"#thumbs\">View List</a>",
        "// Line_Reference 716: \t\t\t\t\t\t\t</div>",
        "// Line_Reference 717: \t\t\t\t\t\t</div>",
        "// Line_Reference 718: \t\t\t\t\t\t<div style=\"clear:both;\"></div>",
        "// Line_Reference 719: \t\t\t\t\t\t<ul id=\"huge-it-posts-list\" class=\"list\">",
        "// Line_Reference 720: \t\t\t\t\t\t\t<li id=\"huge-it-posts-list-heading\" class=\"hascolor\">",
        "// Line_Reference 721: \t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-image\">Image</div>",
        "// Line_Reference 722: \t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-title\">Title</div>",
        "// Line_Reference 723: \t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-description\">",
        "// Line_Reference 724: \t\t\t\t\t\t\t\t\tDescription",
        "// Line_Reference 725: ",
        "// Line_Reference 726: \t\t\t\t\t\t\t\t</div>",
        "// Line_Reference 727: \t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-link\">Link</div>",
        "// Line_Reference 728: \t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-category\">Category</div>",
        "// Line_Reference 729: \t\t\t\t\t\t\t</li>",
        "// Line_Reference 730: \t\t\t\t\t\t\t<?php",
        "// Line_Reference 731: ",
        "// Line_Reference 732: ",
        "// Line_Reference 733: ",
        "// Line_Reference 734: \t\t\t\t\t\t\t$strx=1;",
        "// Line_Reference 735: \t\t\t\t\t\t\tforeach($rowsposts8 as $rowspostspop1){",
        "// Line_Reference 736: \t\t\t\t\t\t\t\t $query=$wpdb->prepare(\"SELECT * FROM \".$wpdb->prefix.\"posts where post_type = 'post' and post_status = 'publish' and ID = %d  order by ID ASC\", $rowspostspop1->object_id);",
        "// Line_Reference 737: \t\t\t\t\t\t\t$rowspostspop=$wpdb->get_results($query);",
        "// Line_Reference 738: \t\t\t\t\t\t\t//print_r($rowspostspop);",
        "// Line_Reference 739: ",
        "// Line_Reference 740: ",
        "// Line_Reference 741: \t\t\t\t\t\t\t\t$post_categories =  wp_get_post_categories( $rowspostspop[0]->ID, $rowspostspop[0]->ID );",
        "// Line_Reference 742: \t\t\t\t\t\t\t\t$cats = array();",
        "// Line_Reference 743: ",
        "// Line_Reference 744: ",
        "// Line_Reference 745: \t\t\t\t\t\t\t\tforeach($post_categories as $c){",
        "// Line_Reference 746: \t\t\t\t\t\t\t\t\t$cat = get_category( $c );",
        "// Line_Reference 747: \t\t\t\t\t\t\t\t\t$cats[] = array( 'name' => $cat->name, 'slug' => $cat->slug, 'id' => $cat->term_id );",
        "// Line_Reference 748: \t\t\t\t\t\t\t\t\t//echo\t$cat->slug;",
        "// Line_Reference 749: \t\t\t\t\t\t\t\t}",
        "// Line_Reference 750: \t\t\t\t\t\t\t\tif(get_the_post_thumbnail($rowspostspop[0]->ID, 'thumbnail') != ''){",
        "// Line_Reference 751: \t\t\t\t\t\t\t\t\t$strx++;",
        "// Line_Reference 752: \t\t\t\t\t\t\t\t\t$hascolor=\"\";",
        "// Line_Reference 753: \t\t\t\t\t\t\t\t\tif($strx%2==0){$hascolor='class=\"hascolor\"';}",
        "// Line_Reference 754: \t\t\t\t\t\t\t?>",
        "// Line_Reference 755: ",
        "// Line_Reference 756: \t\t\t\t\t\t\t\t<li <?php echo $hascolor; ?>>",
        "// Line_Reference 757: \t\t\t\t\t\t\t\t\t<input type=\"checkbox\" class=\"huge-it-post-checked\"  value=\"<?php echo $rowspostspop[0]->ID; ?>\">",
        "// Line_Reference 758: \t\t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-image\"><?php echo get_the_post_thumbnail($rowspostspop[0]->ID, 'thumbnail'); ?></div>",
        "// Line_Reference 759: \t\t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-title\"><?php echo $rowspostspop[0]->post_title;\t?></div>",
        "// Line_Reference 760: \t\t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-description\"><?php echo\t$rowspostspop[0]->post_content;\t?></div>",
        "// Line_Reference 761: \t\t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-link\"><?php echo\t$rowspostspop[0]->guid; ?></div>",
        "// Line_Reference 762: \t\t\t\t\t\t\t\t\t<div class=\"huge-it-posts-list-category\"><?php echo\t$cat->slug;\t?></div>",
        "// Line_Reference 763: \t\t\t\t\t\t\t\t</li>",
        "// Line_Reference 764: \t\t\t\t\t\t\t<?php }",
        "// Line_Reference 765: \t\t\t\t\t\t\t\t}\t?>",
        "// Line_Reference 766: \t\t\t\t\t\t</ul>",
        "// Line_Reference 767: \t\t\t\t\t\t<input id=\"huge-it-add-posts-params\" type=\"hidden\" name=\"popupposts\" value=\"\" />",
        "// Line_Reference 768: \t\t\t\t\t\t<div class=\"clear\"></div>",
        "// Line_Reference 769: \t\t\t\t\t\t<button class='save-portfolio-options button-primary huge-it-insert-post-button' id='huge-it-insert-post-button-bottom'>Insert Posts</button>",
        "// Line_Reference 770: \t\t\t\t\t\t</form>",
        "// Line_Reference 771: ",
        "// Line_Reference 772: \t\t\t\t\t</div>",
        "// Line_Reference 773: \t\t\t\t</div>",
        "// Line_Reference 774: ",
        "// Line_Reference 775: ",
        "// Line_Reference 776: \t<?php",
        "// Line_Reference 777: ",
        "// Line_Reference 778: ",
        "// Line_Reference 779: ",
        "// Line_Reference 780: ",
        "// Line_Reference 781: }",
        "// Line_Reference 782: ?>",
        "// Line_Reference 783: ",
        "// Line_Reference 784: "
    ]
}
