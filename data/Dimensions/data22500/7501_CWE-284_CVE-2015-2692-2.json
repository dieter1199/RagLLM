{
    "cve_id": "CVE-2015-2692",
    "cve_description": "AdBlock before 2.21 allows remote attackers to block arbitrary resources on arbitrary websites and to disable arbitrary blocking filters.",
    "cve_publish_date": "2017-06-08",
    "cwe_id": "CWE-284",
    "cwe_name": "Improper Access Control",
    "cwe_description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
    "commit_message": "Release new version 2.21\n\n+2.21:\n+- Removed the Norwegian filter list since it is no longer active. (#489)\n+- For each subscribe filter list, added the last update timestamp to debug data. (#482)\n+- Added the malware notification setting to debug data. (#458)\n+- Added additional CSS to whitelist/blacklist dialogs to avoid display issues on some websites. (#460)\n+- Removed an unnecessary call to sendResponse. (#484)\n+- Added a user confirmation prompt when subscribing to a new filter lists using the ABP syntax. (#486)\n+- Fixed an issue when the request URL didn't contain a '.' (#500)\n+- Updated the Chrome web store description.(#501)\n+",
    "type_of_change": "Modification",
    "filename_of_changes": "background.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 307:             var pos = url.pathname.lastIndexOf('.');",
        "// Line_Reference 308:             if (pos === -1) {",
        "// Line_Reference 309:                 return type;",
        "// Line_Reference 312:         var ext = url.pathname.slice(pos) + '.';",
        "// Line_Reference 313:         if ('.eot.ttf.otf.svg.woff.woff2.'.indexOf(ext) !== -1) {",
        "// Line_Reference 314:             return 'font';",
        "// Line_Reference 315:         }",
        "// Line_Reference 316:         // Still need this because often behind-the-scene requests are wrongly",
        "// Line_Reference 317:         // categorized as 'other'",
        "// Line_Reference 318:         if ('.ico.png.gif.jpg.jpeg.webp.'.indexOf(ext) !== -1) {",
        "// Line_Reference 319:             return 'image';",
        "// Line_Reference 320:         }",
        "// Line_Reference 321:         // https://code.google.com/p/chromium/issues/detail?id=410382",
        "// Line_Reference 322:         if (type === 'other') {",
        "// Line_Reference 323:             return 'object';",
        "// Line_Reference 324:         }",
        "// Line_Reference 1339:           if (get_subscriptions[id].subscribed)"
    ]
}
