{
    "cve_id": "CVE-2016-3156",
    "cve_description": "The IPv4 implementation in the Linux kernel before 4.5.2 mishandles destruction of device objects, which allows guest OS users to cause a denial of service (host OS networking outage) by arranging for a large number of IP addresses.",
    "cve_publish_date": "2016-04-27",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "ipv4: Don't do expensive useless work during inetdev destroy.\n\nWhen an inetdev is destroyed, every address assigned to the interface\nis removed.  And in this scenerio we do two pointless things which can\nbe very expensive if the number of assigned interfaces is large:\n\n1) Address promotion.  We are deleting all addresses, so there is no\n   point in doing this.\n\n2) A full nf conntrack table purge for every address.  We only need to\n   do this once, as is already caught by the existing\n   masq_dev_notifier so masq_inet_event() can skip this.\n\nReported-by: Solar Designer <solar@openwall.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\nTested-by: Cyrill Gorcunov <gorcunov@openvz.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "nf_nat_masquerade_ipv4.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 111: \tstruct net_device *dev = ((struct in_ifaddr *)ptr)->ifa_dev->dev;",
        "// Line_Reference 114: \tnetdev_notifier_info_init(&info, dev);"
    ]
}
