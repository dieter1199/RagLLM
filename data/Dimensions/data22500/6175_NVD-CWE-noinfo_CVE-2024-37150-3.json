{
    "cve_id": "CVE-2024-37150",
    "cve_description": "An issue in `.npmrc` support in Deno 1.44.0 was discovered where Deno would send `.npmrc` credentials for the scope to the tarball URL when the registry provided URLs for a tarball on a different domain. All users relying on .npmrc are potentially affected by this vulnerability if their private registry references tarball URLs at a different domain. This includes usage of deno install subcommand, auto-install for npm: specifiers and LSP usage. It is recommended to upgrade to Deno 1.44.1 and if your private registry ever serves tarballs at a different domain to rotate your registry credentials.",
    "cve_publish_date": "2024-06-06",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(npm): use configured auth for tarball urls instead of scope auth (#24111)\n\nDeno was using the scope auth for the tarball urls, which is not always\r\ncorrect. We are going to do a release immediately for this issue.",
    "type_of_change": "Modification",
    "filename_of_changes": "tarball.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "34",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 141:       let registry_config =",
        "// Line_Reference 142:         tarball_cache.npmrc.get_registry_config(&package_nv.name).clone();",
        "// Line_Reference 164:       let maybe_auth_header =",
        "// Line_Reference 165:         maybe_auth_header_for_npm_registry(&registry_config);",
        "// Line_Reference 168:       let maybe_bytes = tarball_cache.http_client_provider",
        "// Line_Reference 170:         .download_with_progress(&dist.tarball, maybe_auth_header, &guard)",
        "// Line_Reference 171:         .await?;"
    ]
}
