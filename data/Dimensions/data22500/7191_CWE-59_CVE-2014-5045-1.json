{
    "cve_id": "CVE-2014-5045",
    "cve_description": "The mountpoint_last function in fs/namei.c in the Linux kernel before 3.15.8 does not properly maintain a certain reference count during attempts to use the umount system call in conjunction with a symlink, which allows local users to cause a denial of service (memory consumption or use-after-free) or possibly have unspecified other impact via the umount program.",
    "cve_publish_date": "2014-08-01",
    "cwe_id": "CWE-59",
    "cwe_name": "Improper Link Resolution Before File Access ('Link Following')",
    "cwe_description": "The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",
    "commit_message": "fs: umount on symlink leaks mnt count\n\nCurrently umount on symlink blocks following umount:\n\n/vz is separate mount\n\n# ls /vz/ -al | grep test\ndrwxr-xr-x.  2 root root       4096 Jul 19 01:14 testdir\nlrwxrwxrwx.  1 root root         11 Jul 19 01:16 testlink -> /vz/testdir\n# umount -l /vz/testlink\numount: /vz/testlink: not mounted (expected)\n\n# lsof /vz\n# umount /vz\numount: /vz: device is busy. (unexpected)\n\nIn this case mountpoint_last() gets an extra refcount on path->mnt\n\nSigned-off-by: Vasily Averin <vvs@openvz.org>\nAcked-by: Ian Kent <raven@themaw.net>\nAcked-by: Jeff Layton <jlayton@primarydata.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Christoph Hellwig <hch@lst.de>",
    "type_of_change": "Modification",
    "filename_of_changes": "namei.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 2259: \tpath->mnt = mntget(nd->path.mnt);"
    ]
}
