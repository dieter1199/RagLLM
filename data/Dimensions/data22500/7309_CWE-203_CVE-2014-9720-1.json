{
    "cve_id": "CVE-2014-9720",
    "cve_description": "Tornado before 3.2.2 sends arbitrary responses that contain a fixed CSRF token and may be sent with HTTP compression, which makes it easier for remote attackers to conduct a BREACH attack and determine this token via a series of crafted requests.",
    "cve_publish_date": "2020-01-24",
    "cwe_id": "CWE-203",
    "cwe_name": "Observable Discrepancy",
    "cwe_description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.",
    "commit_message": "Change the xsrf cookie format to be masked with a random salt.\n\nThis protects against the BREACH attack.",
    "type_of_change": "Modification",
    "filename_of_changes": "web.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "51",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 75: import uuid",
        "// Line_Reference 85: from tornado.util import bytes_type, import_object, ObjectDict, raise_exc_info, unicode_type",
        "// Line_Reference 1074:             token = self.get_cookie(\"_xsrf\")",
        "// Line_Reference 1075:             if not token:",
        "// Line_Reference 1076:                 token = binascii.b2a_hex(os.urandom(16))",
        "// Line_Reference 1078:                 self.set_cookie(\"_xsrf\", token, expires_days=expires_days)",
        "// Line_Reference 1079:             self._xsrf_token = token",
        "// Line_Reference 1108:         if not _time_independent_equals(utf8(self.xsrf_token), utf8(token)):"
    ]
}
