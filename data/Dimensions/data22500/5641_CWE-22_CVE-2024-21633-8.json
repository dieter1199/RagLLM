{
    "cve_id": "CVE-2024-21633",
    "cve_description": "Apktool is a tool for reverse engineering Android APK files. In versions 2.9.1 and prior, Apktool infers resource files' output path according to their resource names which can be manipulated by attacker to place files at desired location on the system Apktool runs on. Affected environments are those in which an attacker may write/overwrite any file that user has write access, and either user name is known or cwd is under user folder. Commit d348c43b24a9de350ff6e5bd610545a10c1fc712 contains a patch for this issue.",
    "cve_publish_date": "2024-01-03",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Prevent arbitrary file writes with malicious resource names. (#3484)\n\n* refactor: rename sanitize function\r\n\r\n* fix: expose getDir\r\n\r\n* fix: safe handling of untrusted resource names\r\n\r\n - fixes: GHSA-2hqv-2xv4-5h5w\r\n\r\n* test: sample file for GHSA-2hqv-2xv4-5h5w\r\n\r\n* refactor: avoid detection of absolute files for resource check\r\n\r\n* chore: enable info mode on gradle\r\n\r\n* test: skip test on windows\r\n\r\n* chore: debug windows handling\r\n\r\n* fix: normalize entry with file separators\r\n\r\n* fix: normalize filepath after cleansing\r\n\r\n* chore: Android paths are not OS specific\r\n\r\n* refactor: use java.nio for path traversal checking\r\n\r\n* chore: align path separator on Windows for Zip files\r\n\r\n* chore: rework towards basic directory traversal\r\n\r\n* chore: remove '--info' on build.yml",
    "type_of_change": "Modification",
    "filename_of_changes": "ZipUtils.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 60:                 final String cleanedPath = BrutIO.sanitizeUnknownFile(folder, file.getPath().substring(prefixLength));",
        "// Line_Reference 61:                 final ZipEntry zipEntry = new ZipEntry(BrutIO.normalizePath(cleanedPath));"
    ]
}
