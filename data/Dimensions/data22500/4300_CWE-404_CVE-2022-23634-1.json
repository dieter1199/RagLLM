{
    "cve_id": "CVE-2022-23634",
    "cve_description": "Puma is a Ruby/Rack web server built for parallelism. Prior to `puma` version `5.6.2`, `puma` may not always call `close` on the response body. Rails, prior to version `7.0.2.2`, depended on the response body being closed in order for its `CurrentAttributes` implementation to work correctly. The combination of these two behaviors (Puma not closing the body + Rails' Executor implementation) causes information leakage. This problem is fixed in Puma versions 5.6.2 and 4.3.11. This problem is fixed in Rails versions 7.02.2, 6.1.4.6, 6.0.4.6, and 5.2.6.2. Upgrading to a patched Rails _or_ Puma version fixes the vulnerability.",
    "cve_publish_date": "2022-02-11",
    "cwe_id": "CWE-404",
    "cwe_name": "Improper Resource Shutdown or Release",
    "cwe_description": "The product does not release or incorrectly releases a resource before it is made available for re-use.",
    "commit_message": "Ensure `close` is called on the response body no matter what\n\nAnother fallout from https://github.com/puma/puma/pull/2809 is that\nin some cases the `res_body.close` wasn't called because some previous code\nraised.\n\nFor Rails apps it means CurrentAttributes and a few other important\nstates aren't reset properly.\n\nThis is being improved on the Rails side too, but I believe it would\nbe good to harden this on the puma side as well.",
    "type_of_change": "Modification",
    "filename_of_changes": "request.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 174:         uncork_socket io",
        "// Line_Reference 175: ",
        "// Line_Reference 176:         body.close",
        "// Line_Reference 177:         client.tempfile.unlink if client.tempfile",
        "// Line_Reference 178:         res_body.close if res_body.respond_to? :close"
    ]
}
