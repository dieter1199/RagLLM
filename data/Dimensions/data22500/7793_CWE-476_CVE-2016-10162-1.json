{
    "cve_id": "CVE-2016-10162",
    "cve_description": "The php_wddx_pop_element function in ext/wddx/wddx.c in PHP 7.0.x before 7.0.15 and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via an inapplicable class name in a wddxPacket XML document, leading to mishandling in a wddx_deserialize call.",
    "cve_publish_date": "2017-01-24",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix bug #73831 - NULL Pointer Dereference while unserialize php object",
    "type_of_change": "Modification",
    "filename_of_changes": "wddx.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 911: ",
        "// Line_Reference 970: \t\t\t\t\t\t\tobject_init_ex(&obj, pce);",
        "// Line_Reference 971: ",
        "// Line_Reference 972: \t\t\t\t\t\t\t/* Merge current hashtable with object's default properties */",
        "// Line_Reference 973: \t\t\t\t\t\t\tzend_hash_merge(Z_OBJPROP(obj),",
        "// Line_Reference 974: \t\t\t\t\t\t\t\t\t\t\tZ_ARRVAL(ent2->data),",
        "// Line_Reference 975: \t\t\t\t\t\t\t\t\t\t\tzval_add_ref, 0);",
        "// Line_Reference 976: ",
        "// Line_Reference 977: \t\t\t\t\t\t\tif (incomplete_class) {",
        "// Line_Reference 978: \t\t\t\t\t\t\t\tphp_store_class_name(&obj, Z_STRVAL(ent1->data), Z_STRLEN(ent1->data));",
        "// Line_Reference 980: ",
        "// Line_Reference 981: \t\t\t\t\t\t\t/* Clean up old array entry */",
        "// Line_Reference 982: \t\t\t\t\t\t\tzval_ptr_dtor(&ent2->data);",
        "// Line_Reference 983: ",
        "// Line_Reference 984: \t\t\t\t\t\t\t/* Set stack entry to point to the newly created object */",
        "// Line_Reference 985: \t\t\t\t\t\t\tZVAL_COPY_VALUE(&ent2->data, &obj);"
    ]
}
