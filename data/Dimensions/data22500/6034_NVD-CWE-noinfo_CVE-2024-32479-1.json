{
    "cve_id": "CVE-2024-32479",
    "cve_description": "LibreNMS is an open-source, PHP/MySQL/SNMP-based network monitoring system. Prior to version 24.4.0, there is improper sanitization on the `Service` template name, which can lead to stored Cross-site Scripting. Version 24.4.0 fixes this vulnerability.",
    "cve_publish_date": "2024-04-22",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix JS injection in Service Templates (#15954)\n\nYou can't put user data in any \"onwhatever\" attributes, there is no way to sanitize it there.\r\nUse data attributes instead.",
    "type_of_change": "Modification",
    "filename_of_changes": "index.blade.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 20:                             onclick=\"applyAll_st(this, '{{ route('services.templates.applyAll') }}')\">",
        "// Line_Reference 52:                                 <button type=\"button\" title=\"{{ __('Apply Services for this Service Template') }}\" class=\"btn btn-success btn-sm\" aria-label=\"{{ __('Apply') }}\"",
        "// Line_Reference 53:                                     onclick=\"apply_st(this, '{{ $template->name }}', '{{ $template->id }}', '{{ route('services.templates.apply', $template->id) }}')\">",
        "// Line_Reference 54:                                     <i class=\"fa fa-refresh\" aria-hidden=\"true\"></i></button>",
        "// Line_Reference 55:                                 <button type=\"button\" title=\"{{ __('Remove Services for this Service Template') }}\" class=\"btn btn-warning btn-sm\" aria-label=\"{{ __('Remove') }}\"",
        "// Line_Reference 56:                                     onclick=\"remove_st(this, '{{ $template->name }}', '{{ $template->id }}', '{{ route('services.templates.remove', $template->id) }}')\">",
        "// Line_Reference 57:                                     <i class=\"fa fa-ban\" aria-hidden=\"true\"></i></button>",
        "// Line_Reference 58:                                 <a type=\"button\" title=\"{{ __('Edit Service Template') }}\" class=\"btn btn-primary btn-sm\" aria-label=\"{{ __('Edit') }}\"",
        "// Line_Reference 59:                                     href=\"{{ route('services.templates.edit', $template->id) }}\">",
        "// Line_Reference 60:                                     <i class=\"fa fa-pencil\" aria-hidden=\"true\"></i></a>",
        "// Line_Reference 61:                                 <button type=\"button\" class=\"btn btn-danger btn-sm\" title=\"{{ __('Delete Service Template') }}\" aria-label=\"{{ __('Delete') }}\"",
        "// Line_Reference 62:                                     onclick=\"delete_st(this, '{{ $template->name }}', '{{ $template->id }}', '{{ route('services.templates.destroy', $template->id) }}')\">",
        "// Line_Reference 63:                                     <i class=\"fa fa-trash\" aria-hidden=\"true\"></i></button>",
        "// Line_Reference 154:         function apply_st(button, name, id, url) {",
        "// Line_Reference 168:         function applyAll_st(button, url) {",
        "// Line_Reference 182:         function remove_st(button, name, id, url) {",
        "// Line_Reference 198:         function delete_st(button, name, id, url) {"
    ]
}
