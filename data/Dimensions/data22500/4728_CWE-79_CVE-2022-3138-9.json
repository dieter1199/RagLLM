{
    "cve_id": "CVE-2022-3138",
    "cve_description": "Cross-site Scripting (XSS) - Generic in GitHub repository jgraph/drawio prior to 20.3.0.",
    "cve_publish_date": "2022-09-08",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.3.0 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Minimal.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "91",
    "number_of_lines_deleted_vulnerable_to_cve": "106",
    "vulnerable_lines": [
        "// Line_Reference 52: ",
        "// Line_Reference 53: \t\t\t\t\treturn format;",
        "// Line_Reference 134: \t\t}",
        "// Line_Reference 380:     \t\telt.style.cssText = 'position:relative;margin-right:4px;cursor:pointer;display:' + elt.style.display;",
        "// Line_Reference 389:         \telt.style.cssFloat = 'right';",
        "// Line_Reference 390:         \telt.setAttribute('title', mxResources.get('changeUser'));",
        "// Line_Reference 395: ",
        "// Line_Reference 407: \t\t\t\t\t// icon.style.cursor = 'default';",
        "// Line_Reference 411: \t\t\t\t\tvar status = mxResources.get('realtimeCollaboration');",
        "// Line_Reference 416: \t\t\t\t\t\tstatus += ' (' + mxResources.get('online') + ')';",
        "// Line_Reference 424: \t\t\t\t\t\t\tstatus += ' (' + err.message + ')';",
        "// Line_Reference 428: \t\t\t\t\t\t\tstatus += ' (' + mxResources.get('disconnected') + ')';",
        "// Line_Reference 432: \t\t\t\t\ticon.setAttribute('title', status);",
        "// Line_Reference 433: \t\t\t\t\telt.style.paddingRight = '4px';",
        "// Line_Reference 448:     \t\tvar elt = this.shareButton;",
        "// Line_Reference 449:     \t\telt.style.cssText = 'display:inline-block;position:relative;box-sizing:border-box;margin-right:4px;cursor:pointer;';",
        "// Line_Reference 450:     \t\telt.className = 'geToolbarButton';",
        "// Line_Reference 451:     \t\telt.innerText = '';",
        "// Line_Reference 452: \t\t\telt.style.backgroundImage = 'url(' + Editor.shareImage + ')';",
        "// Line_Reference 453:         \telt.style.backgroundPosition = 'center center';",
        "// Line_Reference 454:         \telt.style.backgroundRepeat = 'no-repeat';",
        "// Line_Reference 455:         \telt.style.backgroundSize = '24px 24px';",
        "// Line_Reference 456:         \telt.style.height = '24px';",
        "// Line_Reference 457:         \telt.style.width = '24px';",
        "// Line_Reference 458: ",
        "// Line_Reference 459: \t\t\t// Share button hidden via CSS to enable notifications button",
        "// Line_Reference 460: \t\t\tif (urlParams['sketch'] == '1')",
        "// Line_Reference 461: \t\t\t{",
        "// Line_Reference 462: \t\t\t\tthis.shareButton.style.display = 'none';",
        "// Line_Reference 463: \t\t\t}",
        "// Line_Reference 464: \t\t}",
        "// Line_Reference 465: ",
        "// Line_Reference 466: \t\tif (this.buttonContainer != null)",
        "// Line_Reference 467: \t\t{",
        "// Line_Reference 468: \t\t\tthis.buttonContainer.style.marginTop = '-2px';",
        "// Line_Reference 469: \t\t\tthis.buttonContainer.style.paddingTop = '4px';",
        "// Line_Reference 685:         \tthis.formatWindow.window.setVisible(false);",
        "// Line_Reference 686:         \tthis.formatWindow.window.destroy();",
        "// Line_Reference 692:         \tthis.actions.outlineWindow.window.setVisible(false);",
        "// Line_Reference 693:         \tthis.actions.outlineWindow.window.destroy();",
        "// Line_Reference 699:         \tthis.actions.layersWindow.window.setVisible(false);",
        "// Line_Reference 706:         \tthis.menus.tagsWindow.window.setVisible(false);",
        "// Line_Reference 707:         \tthis.menus.tagsWindow.window.destroy();",
        "// Line_Reference 713:         \tthis.menus.findWindow.window.setVisible(false);",
        "// Line_Reference 714:         \tthis.menus.findWindow.window.destroy();",
        "// Line_Reference 720:         \tthis.menus.findReplaceWindow.window.setVisible(false);",
        "// Line_Reference 721:         \tthis.menus.findReplaceWindow.window.destroy();",
        "// Line_Reference 773:         var graph = ui.editor.graph;",
        "// Line_Reference 779: ",
        "// Line_Reference 783:         ui.actions.put('importCsv', new Action(mxResources.get('csv') + '...', function()",
        "// Line_Reference 784:         {",
        "// Line_Reference 785:             graph.popupMenuHandler.hideMenu();",
        "// Line_Reference 786:             ui.showImportCsvDialog();",
        "// Line_Reference 787:         }));",
        "// Line_Reference 788:         ui.actions.put('importText', new Action(mxResources.get('text') + '...', function()",
        "// Line_Reference 789:         {",
        "// Line_Reference 790:             var dlg = new ParseDialog(ui, 'Insert from Text');",
        "// Line_Reference 791:             ui.showDialog(dlg.container, 620, 420, true, false);",
        "// Line_Reference 792:             dlg.init();",
        "// Line_Reference 793:         }));",
        "// Line_Reference 794:         ui.actions.put('formatSql', new Action(mxResources.get('formatSql') + '...', function()",
        "// Line_Reference 795:         {",
        "// Line_Reference 796:             var dlg = new ParseDialog(ui, 'Insert from Text', 'formatSql');",
        "// Line_Reference 797:             ui.showDialog(dlg.container, 620, 420, true, false);",
        "// Line_Reference 798:             dlg.init();",
        "// Line_Reference 799:         }));",
        "// Line_Reference 800: ",
        "// Line_Reference 801:         ui.actions.put('toggleShapes', new Action(mxResources.get((urlParams['sketch'] == '1') ?",
        "// Line_Reference 802: \t\t\t'moreShapes' : 'shapes') + '...', function()",
        "// Line_Reference 1142: \t\t\tif (langMenu != null)",
        "// Line_Reference 1210:         })));",
        "// Line_Reference 1211: ",
        "// Line_Reference 1212:         this.put('insertAdvanced', new Menu(mxUtils.bind(this, function(menu, parent)",
        "// Line_Reference 1213:         {",
        "// Line_Reference 1214:             ui.menus.addMenuItems(menu, ['importText', 'plantUml', 'mermaid', '-',",
        "// Line_Reference 1215: \t\t\t\t'formatSql', 'importCsv', '-', 'createShape', 'editDiagram'], parent);",
        "// Line_Reference 1216:         })));",
        "// Line_Reference 1217: ",
        "// Line_Reference 1218:         (mxUtils.bind(this, function()",
        "// Line_Reference 1219:         {",
        "// Line_Reference 1938: ",
        "// Line_Reference 2025: \t\t\tui.buttonContainer.style.position = '';",
        "// Line_Reference 2026: \t\t\tui.buttonContainer.style.paddingRight = '0px';",
        "// Line_Reference 2357: \t\t\t\t\t'box-shadow:0px 0px 3px 1px #d1d1d1;padding:6px 0px 6px 6px;border-bottom:1px solid lightgray;' +",
        "// Line_Reference 2513: \t\t        createGroup([appElt, addMenuItem(mxResources.get('shapes'), ui.actions.get('toggleShapes').funct, null,",
        "// Line_Reference 2520: \t\t        var elt = addMenu('insert', true, (small) ? insertImage : null);",
        "// Line_Reference 2521: \t        \tcreateGroup([elt, addMenuItem(mxResources.get('delete'), ui.actions.get('delete').funct,",
        "// Line_Reference 2523: \t\t        \t(small) ? Editor.trashImage : null)], (small) ? 60 : null);",
        "// Line_Reference 2525: \t\t        if (iw >= 411)",
        "// Line_Reference 2526: \t\t        {",
        "// Line_Reference 2527: \t\t\t        createGroup([undoElt, redoElt], 60);",
        "// Line_Reference 2529: \t\t\t        if (iw >= 520)",
        "// Line_Reference 2530: \t\t\t        {",
        "// Line_Reference 2531: \t\t\t\t        createGroup([fitElt,",
        "// Line_Reference 2532: \t\t\t\t\t        (iw >= 640) ? addMenuItem('', zoomInAction.funct, true, mxResources.get('zoomIn') + ' (' + Editor.ctrlKey + ' +)',",
        "// Line_Reference 2534: \t\t\t\t\t        (iw >= 640) ? addMenuItem('', zoomOutAction.funct, true, mxResources.get('zoomOut') + ' (' + Editor.ctrlKey + ' -)',",
        "// Line_Reference 2536: \t\t\t        }",
        "// Line_Reference 2537: \t\t        }",
        "// Line_Reference 2555: \t        var langMenu = ui.menus.get('language');",
        "// Line_Reference 2564: \t\t\t\t\telt.setAttribute('title', mxResources.get('language'));",
        "// Line_Reference 2567: \t\t        \telt.style.backgroundPosition = 'center center';",
        "// Line_Reference 2568: \t\t        \telt.style.backgroundRepeat = 'no-repeat';",
        "// Line_Reference 2569: \t\t        \telt.style.backgroundSize = '24px 24px';",
        "// Line_Reference 2571: \t\t        \telt.style.height = '24px';",
        "// Line_Reference 2572: \t\t        \telt.style.width = '24px';",
        "// Line_Reference 2576: \t\t\t\t\telt.style.top = (urlParams['embed'] == '1') ? '12px' : '11px';"
    ]
}
