{
    "cve_id": "CVE-2014-8335",
    "cve_description": "(1) wp-dbmanager.php and (2) database-manage.php in the WP-DBManager (aka Database Manager) plugin before 2.7.2 for WordPress place credentials on the mysqldump command line, which allows local users to obtain sensitive information by listing the process.",
    "cve_publish_date": "2018-01-05",
    "cwe_id": "CWE-255",
    "cwe_name": "Credentials Management Errors",
    "cwe_description": "Weaknesses in this category are related to the management of credentials.",
    "commit_message": "Uses escapeshellcmd() and do not allow LOAD_FILE inside queries",
    "type_of_change": "Modification",
    "filename_of_changes": "wp-dbmanager.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 63: \tglobal $wpdb;",
        "// Line_Reference 90: \t\t\t$backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force --host=\"'.$backup['host'].'\" --user=\"'.DB_USER.'\" --password=\"'.$backup['password'].'\"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.' | gzip > '.$brace.$backup['filepath'].$brace;",
        "// Line_Reference 94: \t\t\t$backup['command'] = $brace.$backup['mysqldumppath'].$brace.' --force --host=\"'.$backup['host'].'\" --user=\"'.DB_USER.'\" --password=\"'.$backup['password'].'\"'.$backup['port'].$backup['sock'].' --add-drop-table --skip-lock-tables '.DB_NAME.' > '.$brace.$backup['filepath'].$brace;",
        "// Line_Reference 97: \t\tif( !empty( $backup_email ) )",
        "// Line_Reference 220: \tif(substr(PHP_OS, 0, 3) == 'WIN') {",
        "// Line_Reference 223: \t\t$fp = fopen($tmpnam, 'w');",
        "// Line_Reference 224: \t\tfwrite($fp, $command);",
        "// Line_Reference 225: \t\tfclose($fp);",
        "// Line_Reference 226: \t\tsystem($tmpnam.' > NUL', $error);",
        "// Line_Reference 227: \t\tunlink($tmpnam);",
        "// Line_Reference 229: \t\tpassthru($command, $error);"
    ]
}
