{
    "cve_id": "CVE-2022-3608",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.2.0-alpha.",
    "cve_publish_date": "2022-10-19",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "feat(backup): added verification of backup files",
    "type_of_change": "Modification",
    "filename_of_changes": "backup.export.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 52:     $tables = $tableNames = $faqConfig->getDb()->getTableNames(Database::getTablePrefix());",
        "// Line_Reference 53:     $tablePrefix = (Database::getTablePrefix() !== '') ? Database::getTablePrefix() . '.phpmyfaq' : 'phpmyfaq';",
        "// Line_Reference 55:     $majorVersion = substr($faqConfig->getVersion(), 0, 3);",
        "// Line_Reference 85:     $text[] = '-- pmf' . $majorVersion . ': ' . $tableNames;",
        "// Line_Reference 86:     $text[] = '-- DO NOT REMOVE THE FIRST LINE!';",
        "// Line_Reference 87:     $text[] = '-- pmftableprefix: ' . Database::getTablePrefix();",
        "// Line_Reference 88:     $text[] = '-- DO NOT REMOVE THE LINES ABOVE!';",
        "// Line_Reference 89:     $text[] = '-- Otherwise this backup will be broken.';",
        "// Line_Reference 90: ",
        "// Line_Reference 93:             $header = sprintf(",
        "// Line_Reference 94:                 'Content-Disposition: attachment; filename=%s',",
        "// Line_Reference 95:                 urlencode(",
        "// Line_Reference 96:                     sprintf(",
        "// Line_Reference 97:                         '%s-data.%s.sql',",
        "// Line_Reference 98:                         $tablePrefix,",
        "// Line_Reference 99:                         date('Y-m-d-H-i-s')",
        "// Line_Reference 100:                     )",
        "// Line_Reference 101:                 )",
        "// Line_Reference 102:             );",
        "// Line_Reference 103:             $httpHelper->addExtraHeader($header);",
        "// Line_Reference 104:             foreach (explode(' ', $tableNames) as $table) {",
        "// Line_Reference 105:                 echo implode(\"\\r\\n\", $text);",
        "// Line_Reference 106:                 if ('' !== $table) {",
        "// Line_Reference 107:                     $text = $dbHelper->buildInsertQueries('SELECT * FROM ' . $table, $table);",
        "// Line_Reference 108:                 }",
        "// Line_Reference 112:             $header = sprintf(",
        "// Line_Reference 113:                 'Content-Disposition: attachment; filename=%s',",
        "// Line_Reference 114:                 urlencode(",
        "// Line_Reference 115:                     sprintf(",
        "// Line_Reference 116:                         '%s-logs.%s.sql',",
        "// Line_Reference 117:                         $tablePrefix,",
        "// Line_Reference 118:                         date('Y-m-d-H-i-s')",
        "// Line_Reference 119:                     )",
        "// Line_Reference 120:                 )",
        "// Line_Reference 121:             );",
        "// Line_Reference 122:             $httpHelper->addExtraHeader($header);",
        "// Line_Reference 123:             foreach (explode(' ', $tableNames) as $table) {",
        "// Line_Reference 124:                 echo implode(\"\\r\\n\", $text);",
        "// Line_Reference 125:                 if ('' !== $table) {",
        "// Line_Reference 126:                     $text = $dbHelper->buildInsertQueries('SELECT * FROM ' . $table, $table);",
        "// Line_Reference 127:                 }"
    ]
}
