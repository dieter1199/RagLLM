{
    "cve_id": "CVE-2013-5634",
    "cve_description": "arch/arm/kvm/arm.c in the Linux kernel before 3.10 on the ARM platform, when KVM is used, allows host OS users to cause a denial of service (NULL pointer dereference, OOPS, and host OS crash) or possibly have unspecified other impact by omitting vCPU initialization before a KVM_GET_REG_LIST ioctl call.",
    "cve_publish_date": "2013-09-25",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "ARM: KVM: prevent NULL pointer dereferences with KVM VCPU ioctl\n\nSome ARM KVM VCPU ioctls require the vCPU to be properly initialized\nwith the KVM_ARM_VCPU_INIT ioctl before being used with further\nrequests. KVM_RUN checks whether this initialization has been\ndone, but other ioctls do not.\nNamely KVM_GET_REG_LIST will dereference an array with index -1\nwithout initialization and thus leads to a kernel oops.\nFix this by adding checks before executing the ioctl handlers.\n\n [ Removed superflous comment from static function - Christoffer ]\n\nChanges from v1:\n * moved check into a static function with a meaningful name\n\nSigned-off-by: Andre Przywara <andre.przywara@linaro.org>\nSigned-off-by: Christoffer Dall <cdall@cs.columbia.edu>",
    "type_of_change": "Modification",
    "filename_of_changes": "arm.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 511: \t/* Make sure they initialize the vcpu with KVM_ARM_VCPU_INIT */",
        "// Line_Reference 512: \tif (unlikely(vcpu->arch.target < 0))"
    ]
}
