{
    "cve_id": "CVE-2015-8970",
    "cve_description": "crypto/algif_skcipher.c in the Linux kernel before 4.4.2 does not verify that a setkey operation has been performed on an AF_ALG socket before an accept system call is processed, which allows local users to cause a denial of service (NULL pointer dereference and system crash) via a crafted application that does not supply a key, related to the lrw_crypt function in crypto/lrw.c.",
    "cve_publish_date": "2016-11-28",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "crypto: algif_skcipher - Require setkey before accept(2)\n\nSome cipher implementations will crash if you try to use them\nwithout calling setkey first.  This patch adds a check so that\nthe accept(2) call will fail with -ENOKEY if setkey hasn't been\ndone on the socket yet.\n\nCc: stable@vger.kernel.org\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\nTested-by: Dmitry Vyukov <dvyukov@google.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "algif_skcipher.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "41",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 753: \treturn crypto_alloc_skcipher(name, type, mask);",
        "// Line_Reference 758: \tcrypto_free_skcipher(private);",
        "// Line_Reference 763: \treturn crypto_skcipher_setkey(private, key, keylen);",
        "// Line_Reference 795: \tunsigned int len = sizeof(*ctx) + crypto_skcipher_reqsize(private);",
        "// Line_Reference 801: \tctx->iv = sock_kmalloc(sk, crypto_skcipher_ivsize(private),",
        "// Line_Reference 808: \tmemset(ctx->iv, 0, crypto_skcipher_ivsize(private));",
        "// Line_Reference 821: \tskcipher_request_set_tfm(&ctx->req, private);"
    ]
}
