{
    "cve_id": "CVE-2024-28235",
    "cve_description": "Contao is an open source content management system. Starting in version 4.9.0 and prior to versions 4.13.40 and 5.3.4, when checking for broken links on protected pages, Contao sends the cookie header to external urls as well, the passed  options for the http client are used for all requests. Contao versions 4.13.40 and 5.3.4 have a patch for this issue. As a workaround, disable crawling protected pages.",
    "cve_publish_date": "2024-04-09",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-9jh5-qf84-x6pr\n\n* Ensure confidential headers are not leaked to external URIs when crawling\n\n* CS\n\n---------\n\nCo-authored-by: Leo Feyer <1192057+leofeyer@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "Factory.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "81",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 51:     public function __construct(Connection $connection, ContaoFramework $framework, array $additionalUris = [], array $defaultHttpClientOptions = [])",
        "// Line_Reference 166:         return HttpClient::create(",
        "// Line_Reference 167:             array_merge_recursive(",
        "// Line_Reference 168:                 [",
        "// Line_Reference 169:                     'headers' => [",
        "// Line_Reference 170:                         'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',",
        "// Line_Reference 171:                         'user-agent' => self::USER_AGENT,",
        "// Line_Reference 172:                     ],",
        "// Line_Reference 173:                     'max_duration' => 10, // Ignore requests that take longer than 10 seconds",
        "// Line_Reference 175:                 array_merge_recursive($this->getDefaultHttpClientOptions(), $options)",
        "// Line_Reference 176:             )"
    ]
}
