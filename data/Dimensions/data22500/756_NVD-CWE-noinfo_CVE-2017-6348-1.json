{
    "cve_id": "CVE-2017-6348",
    "cve_description": "The hashbin_delete function in net/irda/irqueue.c in the Linux kernel before 4.9.13 improperly manages lock dropping, which allows local users to cause a denial of service (deadlock) via crafted operations on IrDA devices.",
    "cve_publish_date": "2017-03-01",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "irda: Fix lockdep annotations in hashbin_delete().\n\nA nested lock depth was added to the hasbin_delete() code but it\ndoesn't actually work some well and results in tons of lockdep splats.\n\nFix the code instead to properly drop the lock around the operation\nand just keep peeking the head of the hashbin queue.\n\nReported-by: Dmitry Vyukov <dvyukov@google.com>\nTested-by: Dmitry Vyukov <dvyukov@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "irqueue.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 386: #ifdef CONFIG_LOCKDEP",
        "// Line_Reference 387: static int hashbin_lock_depth = 0;",
        "// Line_Reference 388: #endif",
        "// Line_Reference 399: \tif ( hashbin->hb_type & HB_LOCK ) {",
        "// Line_Reference 400: \t\tspin_lock_irqsave_nested(&hashbin->hb_spinlock, flags,",
        "// Line_Reference 401: \t\t\t\t\t hashbin_lock_depth++);",
        "// Line_Reference 402: \t}",
        "// Line_Reference 409: \t\tqueue = dequeue_first((irda_queue_t**) &hashbin->hb_queue[i]);",
        "// Line_Reference 410: \t\twhile (queue ) {",
        "// Line_Reference 411: \t\t\tif (free_func)",
        "// Line_Reference 412: \t\t\t\t(*free_func)(queue);",
        "// Line_Reference 413: \t\t\tqueue = dequeue_first(",
        "// Line_Reference 414: \t\t\t\t(irda_queue_t**) &hashbin->hb_queue[i]);",
        "// Line_Reference 423: \tif ( hashbin->hb_type & HB_LOCK) {",
        "// Line_Reference 425: #ifdef CONFIG_LOCKDEP",
        "// Line_Reference 426: \t\thashbin_lock_depth--;",
        "// Line_Reference 427: #endif",
        "// Line_Reference 428: \t}"
    ]
}
