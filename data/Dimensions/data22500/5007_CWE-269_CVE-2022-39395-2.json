{
    "cve_id": "CVE-2022-39395",
    "cve_description": "Vela is a Pipeline Automation (CI/CD) framework built on Linux container technology written in Golang. In Vela Server and Vela Worker prior to version 0.16.0 and Vela UI prior to version 0.17.0, some default configurations for Vela allow exploitation and container breakouts. Users should upgrade to Server 0.16.0, Worker 0.16.0, and UI 0.17.0 to fix the issue. After upgrading, Vela administrators will need to explicitly change the default settings to configure Vela as desired. Some of the fixes will interrupt existing workflows and will require Vela administrators to modify default settings. However, not applying the patch (or workarounds) will continue existing risk exposure. Some workarounds are available. Vela administrators can adjust the worker's `VELA_RUNTIME_PRIVILEGED_IMAGES` setting to be explicitly empty, leverage the `VELA_REPO_ALLOWLIST` setting on the server component to restrict access to a list of repositories that are allowed to be enabled, and/or audit enabled repositories and disable pull_requests if they are not needed.",
    "cve_publish_date": "2022-11-10",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "Merge pull request from GHSA-5m7g-pj8w-7593\n\n* fix(allowlist)!: modify repo allowlist behavior\n\n* setting allow pull to false on create repo endpoint by default\n\nCo-authored-by: ecrupper <easton.crupper12@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "repo.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 156: \t\t// default events to push and pull_request",
        "// Line_Reference 157: \t\tr.SetAllowPull(true)",
        "// Line_Reference 1047: // allowlist are allowed to enable repos. If the allowlist is",
        "// Line_Reference 1048: // empty then any repo can be enabled.",
        "// Line_Reference 1050: \t// if the allowlist is not set or empty allow any repo to be enabled",
        "// Line_Reference 1051: \tif len(allowlist) == 0 {"
    ]
}
