{
    "cve_id": "CVE-2017-5576",
    "cve_description": "Integer overflow in the vc4_get_bcl function in drivers/gpu/drm/vc4/vc4_gem.c in the VideoCore DRM driver in the Linux kernel before 4.9.7 allows local users to cause a denial of service or possibly have unspecified other impact via a crafted size value in a VC4_SUBMIT_CL ioctl call.",
    "cve_publish_date": "2017-02-06",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "drm/vc4: Fix an integer overflow in temporary allocation layout.\n\nWe copy the unvalidated ioctl arguments from the user into kernel\ntemporary memory to run the validation from, to avoid a race where the\nuser updates the unvalidate contents in between validating them and\ncopying them into the validated BO.\n\nHowever, in setting up the layout of the kernel side, we failed to\ncheck one of the additions (the roundup() for shader_rec_offset)\nagainst integer overflow, allowing a nearly MAX_UINT value of\nbin_cl_size to cause us to under-allocate the temporary space that we\nthen copy_from_user into.\n\nReported-by: Murray McAllister <murray.mcallister@insomniasec.com>\nSigned-off-by: Eric Anholt <eric@anholt.net>\nFixes: d5b1a78a772f (\"drm/vc4: Add support for drawing 3D frames.\")",
    "type_of_change": "Modification",
    "filename_of_changes": "vc4_gem.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 597: \tif (uniforms_offset < shader_rec_offset ||"
    ]
}
