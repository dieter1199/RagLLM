{
    "cve_id": "CVE-2015-7578",
    "cve_description": "Cross-site scripting (XSS) vulnerability in the rails-html-sanitizer gem before 1.0.3 for Ruby on Rails 4.2.x and 5.x allows remote attackers to inject arbitrary web script or HTML via crafted tag attributes.",
    "cve_publish_date": "2016-02-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Define a less permissive list of tags and attributes\n\nAnd use it by default.\n\nThe new sanitizer were being a lot more permissive that we had in Rails\nuntil the version 4.2.\n\nThis was also allowing arbritary data attributes by default what can\nlead to CSRF and XSS attacks.\n\nNow data attributes need to be explicitly allowed.\n\nCVE-2015-7578",
    "type_of_change": "Modification",
    "filename_of_changes": "sanitizer_test.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 155:     assert_sanitized \"a b c<script language=\\\"Javascript\\\">blah blah blah</script>d e f\", \"a b cd e f\"",
        "// Line_Reference 176:       assert_sanitized \"start <#{tag_name} title=\\\"1\\\" onclick=\\\"foo\\\">foo <bad>bar</bad> baz</#{tag_name}> end\", %(start <#{tag_name} title=\"1\">foo bar baz</#{tag_name}> end)",
        "// Line_Reference 181:     assert_sanitized %(<a href=\"foo\" onclick=\"bar\"><script>baz</script></a>), %(<a href=\\\"foo\\\"></a>)",
        "// Line_Reference 185:     assert_sanitized %(<video src=\"videofile.ogg\" autoplay  poster=\"posterimage.jpg\"></video>), %(<video src=\"videofile.ogg\" poster=\"posterimage.jpg\"></video>)",
        "// Line_Reference 186:     assert_sanitized %(<video src=\"videofile.ogg\" poster=javascript:alert(1)></video>), %(<video src=\"videofile.ogg\"></video>)",
        "// Line_Reference 312:     assert_sanitized %(<IMG \"\"\"><SCRIPT>alert(\"XSS\")</SCRIPT>\">), \"<img>\\\"&gt;\"",
        "// Line_Reference 489: ",
        "// Line_Reference 491:     Rails::Html::WhiteListSanitizer.allowed_tags = nil",
        "// Line_Reference 497: ",
        "// Line_Reference 499:     Rails::Html::WhiteListSanitizer.allowed_attributes = nil"
    ]
}
