{
    "cve_id": "CVE-2024-34462",
    "cve_description": "Alinto SOGo through 5.10.0 allows XSS during attachment preview.",
    "cve_publish_date": "2024-05-04",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(vulnerability): prevent cross-site scripting when previewing attachments",
    "type_of_change": "Modification",
    "filename_of_changes": "SOGoMailBodyPart.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 503:     {",
        "// Line_Reference 504:       response = error; /* return 304 or 416 */",
        "// Line_Reference 505:     }",
        "// Line_Reference 507:     {",
        "// Line_Reference 508: //   [self debugWithFormat: @\"should fetch body part: %@\",",
        "// Line_Reference 510:       data = [self fetchBLOB];",
        "// Line_Reference 511:       if (data)",
        "// Line_Reference 512: \t{",
        "// Line_Reference 513: //   [self debugWithFormat:@\"  fetched %d bytes: %@\", [data length],",
        "// Line_Reference 514: // \t[self partInfo]];",
        "// Line_Reference 515: ",
        "// Line_Reference 516: \t  response = [localContext response];",
        "// Line_Reference 517: \t  mimeType = [self davContentType];",
        "// Line_Reference 518: \t  if ([mimeType isEqualToString: @\"application/x-xpinstall\"])",
        "// Line_Reference 519: \t    mimeType = @\"application/octet-stream\";",
        "// Line_Reference 520:           else if (!asAttachment)",
        "// Line_Reference 521:             mimeType = [self contentTypeForBodyPartInfo: [self partInfo]];",
        "// Line_Reference 522: ",
        "// Line_Reference 523: \t  [response setHeader: mimeType forKey: @\"content-type\"];",
        "// Line_Reference 524: \t  [response setHeader: [NSString stringWithFormat:@\"%d\", (int)[data length]]",
        "// Line_Reference 525: \t\t    forKey: @\"content-length\"];",
        "// Line_Reference 526: ",
        "// Line_Reference 527: \t  if (asAttachment)",
        "// Line_Reference 528: \t    {",
        "// Line_Reference 529: \t      fileName = [self filename];",
        "// Line_Reference 530: \t      if ([fileName length])",
        "// Line_Reference 531: \t\t[response setHeader: [NSString stringWithFormat: @\"attachment; filename*=\\\"utf-8''%@\\\"\",",
        "// Line_Reference 532: \t\t\t\t\t       [fileName stringByEscapingURL]]",
        "// Line_Reference 533: \t\t\t     forKey: @\"content-disposition\"];",
        "// Line_Reference 534: \t    }",
        "// Line_Reference 535: ",
        "// Line_Reference 536: \t  etag = [self davEntityTag];",
        "// Line_Reference 537: \t  if (etag)",
        "// Line_Reference 538: \t    [response setHeader: etag forKey: @\"etag\"];",
        "// Line_Reference 539: ",
        "// Line_Reference 540: \t  [response setContent: data];",
        "// Line_Reference 541: \t}",
        "// Line_Reference 543: \tresponse = [NSException exceptionWithHTTPStatus: 404 /* not found */",
        "// Line_Reference 544: \t\t\t\treason: @\"did not find body part\"];",
        "// Line_Reference 545:     }"
    ]
}
