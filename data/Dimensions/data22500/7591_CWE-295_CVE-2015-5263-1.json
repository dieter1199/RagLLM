{
    "cve_id": "CVE-2015-5263",
    "cve_description": "pulp-consumer-client 2.4.0 through 2.6.3 does not check the server's TLS certificate signatures when retrieving the server's public key upon registration.",
    "cve_publish_date": "2017-09-25",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "convert consumer register to bindings",
    "type_of_change": "Modification",
    "filename_of_changes": "cli.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 94: def download(url, location):",
        "// Line_Reference 96:     Download files to the specified location.",
        "// Line_Reference 97:     :param url: The file URL.",
        "// Line_Reference 98:     :type url: str",
        "// Line_Reference 99:     :param location: The absolute path to where the downloaded",
        "// Line_Reference 100:         file is to be stored.",
        "// Line_Reference 101:     :type location: str",
        "// Line_Reference 103:     request = urllib2.urlopen(url)",
        "// Line_Reference 105:         content = request.read()",
        "// Line_Reference 107:         try:",
        "// Line_Reference 108:             fp.write(content)",
        "// Line_Reference 109:         finally:",
        "// Line_Reference 110:             fp.close()",
        "// Line_Reference 112:         request.close()",
        "// Line_Reference 115: def update_server_key(conf):",
        "// Line_Reference 117:     Download the server's RSA key and store in the location",
        "// Line_Reference 118:     specified in the configuration.",
        "// Line_Reference 119:     :param conf: The consumer configuration object.",
        "// Line_Reference 120:     :type conf: dict",
        "// Line_Reference 122:     host = conf['server']['host']",
        "// Line_Reference 123:     location = conf['server']['rsa_pub']",
        "// Line_Reference 124:     url = 'https://%s/pulp/static/rsa_pub.key' % host",
        "// Line_Reference 126:         os.makedirs(os.path.dirname(location))",
        "// Line_Reference 127:     except OSError, e:",
        "// Line_Reference 128:         if e.errno != errno.EEXIST:",
        "// Line_Reference 129:             raise",
        "// Line_Reference 130:     download(url, location)",
        "// Line_Reference 204:         # download server public key",
        "// Line_Reference 205: ",
        "// Line_Reference 206:         try:",
        "// Line_Reference 207:             update_server_key(self.context.config)",
        "// Line_Reference 208:         except Exception, e:",
        "// Line_Reference 209:             msg = _('Download server RSA key failed [%(e)s]' % {'e': e})",
        "// Line_Reference 210:             self.prompt.render_failure_message(msg)",
        "// Line_Reference 211: ",
        "// Line_Reference 253:             try:",
        "// Line_Reference 254:                 update_server_key(self.context.config)",
        "// Line_Reference 255:             except Exception, e:",
        "// Line_Reference 256:                 msg = _('Download server RSA key failed [%(e)s]' % {'e': e})",
        "// Line_Reference 257:                 self.prompt.render_failure_message(msg)"
    ]
}
