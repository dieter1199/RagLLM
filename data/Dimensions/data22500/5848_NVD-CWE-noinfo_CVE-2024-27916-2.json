{
    "cve_id": "CVE-2024-27916",
    "cve_description": "Minder is a software supply chain security platform. Prior to version 0.0.33, a Minder user can use the endpoints `GetRepositoryByName`, `DeleteRepositoryByName`, and `GetArtifactByName` to access any repository in the database, irrespective of who owns the repo and any permissions present. The database query checks by repo owner, repo name and provider name (which is always `github`). These query values are not distinct for the particular user - as long as the user has valid credentials and a provider, they can set the repo owner/name to any value they want and the server will return information on this repo. Version 0.0.33 contains a patch for this issue.",
    "cve_publish_date": "2024-03-21",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-v627-69v2-xx37\n\nFixes #GHSA-v627-69v2-xx37\n\nChange GetRepositoryByRepoName query to include project ID. This enforces that\nthe user can only access the repos in the project they authorized with.\nThis fixes a security issue where several API endpoints allowed any\nauthenticated user to manipulate any repo in the DB, irrespective of who\nowned it.",
    "type_of_change": "Modification",
    "filename_of_changes": "repositories.sql.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 191: SELECT id, provider, project_id, repo_owner, repo_name, repo_id, is_private, is_fork, webhook_id, webhook_url, deploy_url, clone_url, created_at, updated_at, default_branch FROM repositories WHERE provider = $1 AND repo_owner = $2 AND repo_name = $3",
        "// Line_Reference 195: \tProvider  string `json:\"provider\"`",
        "// Line_Reference 196: \tRepoOwner string `json:\"repo_owner\"`",
        "// Line_Reference 197: \tRepoName  string `json:\"repo_name\"`",
        "// Line_Reference 201: \trow := q.db.QueryRowContext(ctx, getRepositoryByRepoName, arg.Provider, arg.RepoOwner, arg.RepoName)"
    ]
}
