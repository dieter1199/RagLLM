{
    "cve_id": "CVE-2021-3992",
    "cve_description": "kimai2 is vulnerable to Improper Access Control",
    "cve_publish_date": "2021-12-01",
    "cwe_id": "CWE-639",
    "cwe_name": "Authorization Bypass Through User-Controlled Key",
    "cwe_description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
    "commit_message": "improve permissison handling in invoice screen (#2965)",
    "type_of_change": "Modification",
    "filename_of_changes": "InvoiceControllerTest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 210:     public function testPrintAction()",
        "// Line_Reference 238:         $action = '/invoice/preview/1/' . $id . '?' . http_build_query($params);",
        "// Line_Reference 246:     public function testCreateActionAsAdminWithDownloadAndStatusChangeAndDelete()",
        "// Line_Reference 355: ",
        "// Line_Reference 356:         // this does not delete the invoice, because the token is wrong",
        "// Line_Reference 357:         $this->request($client, '/invoice/delete/' . $id . '/fghfkjhgkjhg');",
        "// Line_Reference 358:         $this->assertIsRedirect($client, '/invoice/show');",
        "// Line_Reference 359:         $client->followRedirect();",
        "// Line_Reference 360:         $this->assertTrue($client->getResponse()->isSuccessful());"
    ]
}
