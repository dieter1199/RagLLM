{
    "cve_id": "CVE-2018-15858",
    "cve_description": "Unchecked NULL pointer usage when handling invalid aliases in CopyKeyAliasesToKeymap in xkbcomp/keycodes.c in xkbcommon before 0.8.1 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file.",
    "cve_publish_date": "2018-08-25",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "keycodes: don't try to copy zero key aliases\n\nMove the aliases copy to within the (num_key_aliases > 0) block.\n\nPassing info->aliases into this fuction with invalid aliases will\ncause log messages but num_key_aliases stays on 0. The key_aliases array\nis never allocated and remains NULL. We then loop through the aliases, causing\na null-pointer dereference.\n\nSigned-off-by: Peter Hutterer <peter.hutterer@who-t.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "keycodes.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 599:     }",
        "// Line_Reference 601:     i = 0;",
        "// Line_Reference 602:     darray_foreach(alias, info->aliases) {",
        "// Line_Reference 603:         if (alias->real != XKB_ATOM_NONE) {",
        "// Line_Reference 604:             key_aliases[i].alias = alias->alias;",
        "// Line_Reference 605:             key_aliases[i].real = alias->real;",
        "// Line_Reference 606:             i++;"
    ]
}
