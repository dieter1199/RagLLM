{
    "cve_id": "CVE-2024-3028",
    "cve_description": "mintplex-labs/anything-llm is vulnerable to improper input validation, allowing attackers to read and delete arbitrary files on the server. By manipulating the 'logo_filename' parameter in the 'system-preferences' API endpoint, an attacker can construct requests to read sensitive files or the application's '.env' file, and even delete files by setting the 'logo_filename' to the path of the target file and invoking the 'remove-logo' API endpoint. This vulnerability is due to the lack of proper sanitization of user-supplied input.",
    "cve_publish_date": "2024-04-16",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "norm path logo",
    "type_of_change": "Modification",
    "filename_of_changes": "logo.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 24:     customLogoPath = path.join(basePath, currentLogoFilename);",
        "// Line_Reference 55:     ? path.join(process.env.STORAGE_DIR, \"assets\", originalFilename)",
        "// Line_Reference 56:     : path.join(__dirname, `../../storage/assets/${originalFilename}`);",
        "// Line_Reference 58:     ? path.join(process.env.STORAGE_DIR, \"assets\", newFilename)",
        "// Line_Reference 59:     : path.join(__dirname, `../../storage/assets/${newFilename}`);",
        "// Line_Reference 68:     ? path.join(process.env.STORAGE_DIR, `assets/${logoFilename}`)",
        "// Line_Reference 69:     : path.join(__dirname, `../../storage/assets/${logoFilename}`);"
    ]
}
