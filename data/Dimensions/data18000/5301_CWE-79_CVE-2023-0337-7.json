{
    "cve_id": "CVE-2023-0337",
    "cve_description": "Cross-site Scripting (XSS) - Reflected in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-17",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed acct and hs management (#341)\n\n* Fixed bugs in some accounting related feature\r\n\r\n* Fixed hs management ui components",
    "type_of_change": "Modification",
    "filename_of_changes": "acct-date.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "66",
    "number_of_lines_deleted_vulnerable_to_cve": "39",
    "vulnerable_lines": [
        "// Line_Reference 35:     $username = (array_key_exists('username', $_GET) && isset($_GET['username']))",
        "// Line_Reference 36:                     ? str_replace(\"%\", \"\", $_GET['username']) : \"\";",
        "// Line_Reference 39:     $startdate = (array_key_exists('startdate', $_GET) && isset($_GET['startdate']) &&",
        "// Line_Reference 40:                   preg_match(DATE_REGEX, $_GET['startdate'], $m) !== false &&",
        "// Line_Reference 42:                ? $_GET['startdate'] : \"\";",
        "// Line_Reference 44:     $enddate = (array_key_exists('enddate', $_GET) && isset($_GET['enddate']) &&",
        "// Line_Reference 45:                 preg_match(DATE_REGEX, $_GET['enddate'], $m) !== false &&",
        "// Line_Reference 47:              ? $_GET['enddate'] : \"\";",
        "// Line_Reference 83:                     \"nasipaddress\" => t('all','NASIPAddress'),",
        "// Line_Reference 88:     $orderBy = (array_key_exists('orderBy', $_GET) && isset($_GET['orderBy']) &&",
        "// Line_Reference 92:     $orderType = (array_key_exists('orderType', $_GET) && isset($_GET['orderType']) &&",
        "// Line_Reference 172:                 setupNumbering($numrows, $rowsPerPage, $pageNum, $orderBy, $orderType);",
        "// Line_Reference 191:     <tbody>",
        "// Line_Reference 193:             $simple_td_format = '<td>%s</td>';",
        "// Line_Reference 197:                 foreach ($row as $i => $value) {",
        "// Line_Reference 198:                     $row[$i] = htmlspecialchars($value, ENT_QUOTES, 'UTF-8');",
        "// Line_Reference 199:                 }",
        "// Line_Reference 201:                 echo \"<tr>\";",
        "// Line_Reference 202:                 printf($simple_td_format, $row[0]);",
        "// Line_Reference 204:                 $onclick = \"javascript:ajaxGeneric('include/management/retHotspotInfo.php','retHotspotGeneralStat','divContainerHotspotInfo'\"",
        "// Line_Reference 205:                          . sprintf(\",'hotspot=%s');return false;\", $row[1]);",
        "// Line_Reference 208:                                    $li_style, urlencode($row[1]), t('Tooltip','HotspotEdit'))",
        "// Line_Reference 214:                 printf('<td><a class=\"tablenovisit\" href=\"#\" onclick=\"%s\" ' . \"tooltipText='%s'>%s</a></td>\",",
        "// Line_Reference 215:                        $onclick, $tooltip, $row[1]);",
        "// Line_Reference 218:                          . sprintf(\"'username=%s');return false;\", $row[2]);",
        "// Line_Reference 219:                 $tooltip = sprintf('<a class=\"toolTip\" href=\"mng-edit.php?username=%s\">%s</a>', $row[2], t('Tooltip','UserEdit'))",
        "// Line_Reference 221:                 printf('<td><a class=\"tablenovisit\" href=\"#\" onclick=\"%s\" ' . \"tooltipText='%s'>%s</a></td>\",",
        "// Line_Reference 222:                        $onclick, $tooltip, $row[2]);",
        "// Line_Reference 224:                 printf($simple_td_format, $row[3]);",
        "// Line_Reference 225:                 printf($simple_td_format, $row[4]);",
        "// Line_Reference 226:                 printf($simple_td_format, $row[5]);",
        "// Line_Reference 228:                 printf($simple_td_format, time2str($row[6]));",
        "// Line_Reference 229:                 printf($simple_td_format, toxbyte($row[7]));",
        "// Line_Reference 230:                 printf($simple_td_format, toxbyte($row[8]));",
        "// Line_Reference 231:                 printf($simple_td_format, $row[9]);",
        "// Line_Reference 232:                 printf($simple_td_format, $row[10]);",
        "// Line_Reference 233: ",
        "// Line_Reference 234:                 echo \"</tr>\";",
        "// Line_Reference 235: "
    ]
}
