{
    "cve_id": "CVE-2024-2417",
    "cve_description": "The User Registration â€“ Custom Registration Form, Login Form, and User Profile WordPress Plugin plugin for WordPress is vulnerable to privilege escalation due to a missing capability check on the form_save_action() function in all versions up to, and including, 3.1.5. This makes it possible for authenticated attackers, with subscriber-level access and above, to update the registration form and make the default registration role administrator. This subsequently allows the attacker to register an account as an administrator on the site.",
    "cve_publish_date": "2024-05-02",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Security - Vulnerability issue while saving form and removing profile picture",
    "type_of_change": "Modification",
    "filename_of_changes": "class-ur-ajax.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 57: \t\t\t'profile_pic_remove'        => true,",
        "// Line_Reference 1127: \t\tif ( file_exists( get_attached_file( $attachment_id ) ) && ! unlink( get_attached_file( $attachment_id ) ) ) {",
        "// Line_Reference 1133: \t\t}",
        "// Line_Reference 1134: ",
        "// Line_Reference 1135: \t\t$user_id = get_current_user_id();",
        "// Line_Reference 1137: \t\tif ( $user_id > 0 ) {",
        "// Line_Reference 1138: \t\t\tupdate_user_meta( $user_id, 'user_registration_profile_pic_url', '' );"
    ]
}
