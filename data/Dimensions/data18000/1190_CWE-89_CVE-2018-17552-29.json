{
    "cve_id": "CVE-2018-17552",
    "cve_description": "SQL Injection in login.php in Naviwebs Navigate CMS 2.8 allows remote attackers to bypass authentication via the navigate-user cookie.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "* security fix: replace string filtering by parameterization in almost all queries",
    "type_of_change": "Modification",
    "filename_of_changes": "list.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "78",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 251:                                           search_nwdi.website = ' . protect($website->id) . ' AND",
        "// Line_Reference 258:                                             search_npi.website = ' . protect($website->id) . ' AND",
        "// Line_Reference 270:                                           search_nwdi.website = ' . protect($website->id) . ' AND",
        "// Line_Reference 277:                                             search_npi.website = ' . protect($website->id) . ' AND",
        "// Line_Reference 357: \t\t\t WHERE s.id IN('.implode(\",\", $categories).')",
        "// Line_Reference 358: \t\t\t   AND s.website = '.$website->id.'",
        "// Line_Reference 360: \t\t\t   AND (s.date_published = 0 OR s.date_published < '.core_time().')",
        "// Line_Reference 361: \t\t\t   AND (s.date_unpublish = 0 OR s.date_unpublish > '.core_time().')",
        "// Line_Reference 367: \t\t\t   AND d.lang = '.protect($current['lang']).'",
        "// Line_Reference 373: \t\t\tOFFSET '.$offset",
        "// Line_Reference 577: \t\t\t WHERE p.category IN('.implode(\",\", $categories).')",
        "// Line_Reference 578: \t\t\t   AND p.website = '.$website->id.'",
        "// Line_Reference 583: \t\t\t   AND (s.date_published = 0 OR s.date_published < '.core_time().')",
        "// Line_Reference 584: \t\t\t   AND (s.date_unpublish = 0 OR s.date_unpublish > '.core_time().')",
        "// Line_Reference 592: \t\t\t   AND d.lang = '.protect($current['lang']).'",
        "// Line_Reference 601:         $DB->query($query);",
        "// Line_Reference 649:                      WHERE i.category IN('.implode(\",\", $categories).')",
        "// Line_Reference 650:                        AND i.website = '.$website->id.'",
        "// Line_Reference 652:                        AND (i.date_published = 0 OR i.date_published < '.core_time().')",
        "// Line_Reference 653:                        AND (i.date_unpublish = 0 OR i.date_unpublish > '.core_time().')",
        "// Line_Reference 655:                        AND (s.date_published = 0 OR s.date_published < '.core_time().')",
        "// Line_Reference 656:                        AND (s.date_unpublish = 0 OR s.date_unpublish > '.core_time().')",
        "// Line_Reference 664:                        AND d.lang = '.protect($current['lang']).'",
        "// Line_Reference 668:                      LIMIT 1",
        "// Line_Reference 669:                 ');",
        "// Line_Reference 761:              WHERE website = '.protect($website->id).'",
        "// Line_Reference 817: \t\t\t WHERE i.category IN('.implode(\",\", $categories).')",
        "// Line_Reference 818: \t\t\t   AND i.website = '.$website->id.'",
        "// Line_Reference 821: \t\t\t   AND (i.date_published = 0 OR i.date_published < '.core_time().')",
        "// Line_Reference 822: \t\t\t   AND (i.date_unpublish = 0 OR i.date_unpublish > '.core_time().')",
        "// Line_Reference 824: \t\t\t   AND (s.date_published = 0 OR s.date_published < '.core_time().')",
        "// Line_Reference 825: \t\t\t   AND (s.date_unpublish = 0 OR s.date_unpublish > '.core_time().')",
        "// Line_Reference 833: \t\t\t   AND d.lang = '.protect($current['lang']).'",
        "// Line_Reference 842: \t\t$DB->query($query);",
        "// Line_Reference 867:     // now we have all elements that will be shown in the list",
        "// Line_Reference 1212:                         ' category = '.protect($item->id).' AND",
        "// Line_Reference 1213:                           website = '.protect($item->website).' AND",
        "// Line_Reference 1218:                         ');",
        "// Line_Reference 1281: \t\t                    $email = $DB->query_single('email', 'nv_webusers', 'id = '.protect($item->user));",
        "// Line_Reference 1283: \t\t\t                    $gravatar_hash = md5( strtolower( trim( $item->email ) ) );"
    ]
}
