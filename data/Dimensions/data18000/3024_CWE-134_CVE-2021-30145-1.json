{
    "cve_id": "CVE-2021-30145",
    "cve_description": "A format string vulnerability in mpv through 0.33.0 allows user-assisted remote attackers to achieve code execution via a crafted m3u playlist file.",
    "cve_publish_date": "2021-05-18",
    "cwe_id": "CWE-134",
    "cwe_name": "Use of Externally-Controlled Format String",
    "cwe_description": "The product uses a function that accepts a format string as an argument, but the format string originates from an external source.",
    "commit_message": "demux_mf: improve format string processing\n\nBefore this commit, the user could specify a printf format string\nwhich wasn't verified, and could result in:\n- Undefined behavior due to missing or non-matching arguments.\n- Buffer overflow due to untested result length.\n\nThe offending code was added at commit 103a9609 (2002, mplayer svn):\ngit-svn-id: svn://svn.mplayerhq.hu/mplayer/trunk@4566 b3059339-0415-0410-9bf9-f77b7e298cf2\n\nIt moved around but was not modified meaningfully until now.\n\nNow we reject all conversion specifiers at the format except %%\nand a simple subset of the valid specifiers. Also, we now use\nsnprintf to avoid buffer overflow.\n\nThe format string is provided by the user as part of mf:// URI.\n\nReport and initial patch by Stefan Schiller.\nPatch reviewed by @jeeb, @sfan5, Stefan Schiller.",
    "type_of_change": "Modification",
    "filename_of_changes": "demux_mf.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 124:     char *fname = talloc_size(mf, strlen(filename) + 32);",
        "// Line_Reference 154:         sprintf(fname, filename, count++);"
    ]
}
