{
    "cve_id": "CVE-2022-1353",
    "cve_description": "A vulnerability was found in the pfkey_register function in net/key/af_key.c in the Linux kernel. This flaw allows a local, unprivileged user to gain access to kernel memory, leading to a system crash or a leak of internal kernel information.",
    "cve_publish_date": "2022-04-29",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "af_key: add __GFP_ZERO flag for compose_sadb_supported in function pfkey_register\n\nAdd __GFP_ZERO flag for compose_sadb_supported in function pfkey_register\nto initialize the buffer of supp_skb to fix a kernel-info-leak issue.\n1) Function pfkey_register calls compose_sadb_supported to request\na sk_buff. 2) compose_sadb_supported calls alloc_sbk to allocate\na sk_buff, but it doesn't zero it. 3) If auth_len is greater 0, then\ncompose_sadb_supported treats the memory as a struct sadb_supported and\nbegins to initialize. But it just initializes the field sadb_supported_len\nand field sadb_supported_exttype without field sadb_supported_reserved.\n\nReported-by: TCS Robot <tcs_robot@tencent.com>\nSigned-off-by: Haimin Zhang <tcs_kernel@tencent.com>\nSigned-off-by: Steffen Klassert <steffen.klassert@secunet.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "af_key.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1702: \tsupp_skb = compose_sadb_supported(hdr, GFP_KERNEL);"
    ]
}
