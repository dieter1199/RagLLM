{
    "cve_id": "CVE-2022-4665",
    "cve_description": "Unrestricted Upload of File with Dangerous Type in GitHub repository ampache/ampache prior to 5.5.6.",
    "cve_publish_date": "2022-12-23",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "think we good now",
    "type_of_change": "Modification",
    "filename_of_changes": "Art.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 406:                 $new_pic       = array('data' => $source, 'mime' => $mime,",
        "// Line_Reference 407:                     'picturetypeid' => $current_picturetypeid, 'description' => $description);",
        "// Line_Reference 417:                                 $ndata['attached_picture'][] = array('data' => $apics[0]['data'], 'description' => $apics[0]['description'],",
        "// Line_Reference 418:                                     'mime' => $apics[0]['mime'], 'picturetypeid' => $apics[0]['picturetypeid']);",
        "// Line_Reference 431:                                 $ndata['attached_picture'][$apicsId]  = array('data' => $apics[$apicsId]['data'], 'mime' => $apics[$apicsId][$apic_mimetype],",
        "// Line_Reference 432:                                 'picturetypeid' => $apics[$apicsId][$apic_typeid], 'description' => $apics[$apicsId]['description']);",
        "// Line_Reference 514:             $minw = (AmpConfig::get('album_art_min_width')) ? AmpConfig::get('album_art_min_width') : 0;",
        "// Line_Reference 515:             $maxw = (AmpConfig::get('album_art_max_width')) ? AmpConfig::get('album_art_max_width') : 0;",
        "// Line_Reference 516:             $minh = (AmpConfig::get('album_art_min_height')) ? AmpConfig::get('album_art_min_height') : 0;",
        "// Line_Reference 517:             $maxh = (AmpConfig::get('album_art_max_height')) ? AmpConfig::get('album_art_max_height') : 0;",
        "// Line_Reference 630:      * @param string $name",
        "// Line_Reference 632:     private static function read_from_images($name = 'blankalbum.png')",
        "// Line_Reference 1501:             if (Core::get_global('user')->has_access(50) || (Core::get_global('user')->has_access(25) && Core::get_global('user')->id == $libitem->get_user_owner())) {"
    ]
}
