def run_cmd_in_pty(cmd, print_cmd=True, print_output=True, columns=120):
:param cmd: The command to execute, including the options, e.g. "ls -al"
:type cmd: string
class PexpectSizedWindowSpawn(pexpect.spawn):
# https://github.com/pexpect/pexpect/issues/134
def setwinsize(self, rows, cols):
super(PexpectSizedWindowSpawn, self).setwinsize(0, columns)
process = PexpectSizedWindowSpawn(cmd[0], cmd[1:], env={"LC_ALL": "C"}, timeout=None)
# The setting of window size is super unreliable
process.setwinsize(0, columns)
process.close()  # Per the pexpect API, this is necessary in order to get the return code
return_code = process.exitstatus
