if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_LENGTH option, length %u != 4]", opt_len));
bp += sizeof(uint16_t);
opts_len -= 4;
if (opt_len != 16) {
ND_PRINT((ndo, "[Bad OPT_FRAGMENT option, length %u != 16]", opt_len));
bp += sizeof(uint32_t);
bp += sizeof(uint32_t);
bp += sizeof(uint32_t);
opts_len -= 16;
opt_len -= sizeof(uint32_t);	/* option header */
if (opt_len < sizeof(uint32_t)) {
ND_TCHECK2(*bp, sizeof(uint32_t));
bp += sizeof(uint32_t);
opt_len -= sizeof(uint32_t);
opts_len -= sizeof(uint32_t);
if (opt_len != 8) {
ND_PRINT((ndo, "[Bad OPT_JOIN option, length %u != 8]", opt_len));
bp += sizeof(uint32_t);
opts_len -= 8;
if (opt_len != 12) {
ND_PRINT((ndo, "[Bad OPT_NAK_BO_IVL option, length %u != 12]", opt_len));
bp += sizeof(uint32_t);
bp += sizeof(uint32_t);
opts_len -= 12;
if (opt_len != 12) {
ND_PRINT((ndo, "[Bad OPT_NAK_BO_RNG option, length %u != 12]", opt_len));
bp += sizeof(uint32_t);
bp += sizeof(uint32_t);
opts_len -= 12;
bp += (2 * sizeof(uint16_t));
if (opt_len != 4 + sizeof(struct in_addr)) {
ND_PRINT((ndo, "[Bad OPT_REDIRECT option, length %u != 4 + address size]", opt_len));
opts_len -= 4 + sizeof(struct in_addr);
if (opt_len != 4 + sizeof(struct in6_addr)) {
ND_PRINT((ndo, "[Bad OPT_REDIRECT option, length %u != 4 + address size]", opt_len));
opts_len -= 4 + sizeof(struct in6_addr);
if (opt_len != 8) {
ND_PRINT((ndo, "[Bad OPT_PARITY_PRM option, length %u != 8]", opt_len));
bp += sizeof(uint32_t);
opts_len -= 8;
if (opt_len != 8) {
ND_PRINT((ndo, "[Bad OPT_PARITY_GRP option, length %u != 8]", opt_len));
bp += sizeof(uint32_t);
opts_len -= 8;
if (opt_len != 8) {
ND_PRINT((ndo, "[Bad OPT_CURR_TGSIZE option, length %u != 8]", opt_len));
bp += sizeof(uint32_t);
opts_len -= 8;
if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_NBR_UNREACH option, length %u != 4]", opt_len));
opts_len -= 4;
if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_SYN option, length %u != 4]", opt_len));
opts_len -= 4;
if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_FIN option, length %u != 4]", opt_len));
opts_len -= 4;
if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_RST option, length %u != 4]", opt_len));
opts_len -= 4;
if (opt_len != 4) {
ND_PRINT((ndo, "[Bad OPT_CRQST option, length %u != 4]", opt_len));
opts_len -= 4;
bp += sizeof(uint32_t);
bp += (2 * sizeof(uint16_t));
if (opt_len != 12 + sizeof(struct in_addr)) {
ND_PRINT((ndo, "[Bad OPT_PGMCC_DATA option, length %u != 12 + address size]", opt_len));
opts_len -= 12 + sizeof(struct in_addr);
if (opt_len != 12 + sizeof(struct in6_addr)) {
ND_PRINT((ndo, "[Bad OPT_PGMCC_DATA option, length %u != 12 + address size]", opt_len));
opts_len -= 12 + sizeof(struct in6_addr);
bp += sizeof(uint32_t);
bp += (2 * sizeof(uint16_t));
if (opt_len != 12 + sizeof(struct in_addr)) {
ND_PRINT((ndo, "[Bad OPT_PGMCC_DATA option, length %u != 12 + address size]", opt_len));
opts_len -= 12 + sizeof(struct in_addr);
if (opt_len != 12 + sizeof(struct in6_addr)) {
ND_PRINT((ndo, "[Bad OPT_PGMCC_DATA option, length %u != 12 + address size]", opt_len));
opts_len -= 12 + sizeof(struct in6_addr);