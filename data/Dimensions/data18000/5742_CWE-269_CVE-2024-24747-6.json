{
    "cve_id": "CVE-2024-24747",
    "cve_description": "MinIO is a High Performance Object Storage. When someone creates an access key, it inherits the permissions of the parent key. Not only for `s3:*` actions, but also `admin:*` actions. Which means unless somewhere above in the access-key hierarchy, the `admin` rights are denied, access keys will be able to simply override their own `s3` permissions to something more permissive. The vulnerability is fixed in RELEASE.2024-01-31T20-20-33Z.",
    "cve_publish_date": "2024-01-31",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "fix: permission checks for editing access keys (#18928)\n\nWith this change, only a user with `UpdateServiceAccountAdminAction`\r\npermission is able to edit access keys.\r\n\r\nWe would like to let a user edit their own access keys, however the\r\nfeature needs to be re-designed for better security and integration with\r\nexternal systems like AD/LDAP and OpenID.\r\n\r\nThis change prevents privilege escalation via service accounts.",
    "type_of_change": "Modification",
    "filename_of_changes": "sts-handlers_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 912: \t// 4. Check that svc account can restrict the policy, and that the",
        "// Line_Reference 913: \t// session policy can be updated.",
        "// Line_Reference 914: \tc.assertSvcAccSessionPolicyUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 915: ",
        "// Line_Reference 916: \t// 4. Check that service account's secret key and account status can be",
        "// Line_Reference 917: \t// updated.",
        "// Line_Reference 918: \tc.assertSvcAccSecretKeyAndStatusUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 919: ",
        "// Line_Reference 1104: \t// 4. Check that svc account can restrict the policy, and that the",
        "// Line_Reference 1105: \t// session policy can be updated.",
        "// Line_Reference 1106: \tc.assertSvcAccSessionPolicyUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1107: ",
        "// Line_Reference 1108: \t// 4. Check that service account's secret key and account status can be",
        "// Line_Reference 1109: \t// updated.",
        "// Line_Reference 1110: \tc.assertSvcAccSecretKeyAndStatusUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1111: ",
        "// Line_Reference 1361: \t// 4. Check that svc account can restrict the policy, and that the",
        "// Line_Reference 1362: \t// session policy can be updated.",
        "// Line_Reference 1363: \tc.assertSvcAccSessionPolicyUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1364: ",
        "// Line_Reference 1365: \t// 4. Check that service account's secret key and account status can be",
        "// Line_Reference 1366: \t// updated.",
        "// Line_Reference 1367: \tc.assertSvcAccSecretKeyAndStatusUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1368: ",
        "// Line_Reference 1661: \t// 4. Check that svc account can restrict the policy, and that the",
        "// Line_Reference 1662: \t// session policy can be updated.",
        "// Line_Reference 1663: \tc.assertSvcAccSessionPolicyUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1664: ",
        "// Line_Reference 1665: \t// 4. Check that service account's secret key and account status can be",
        "// Line_Reference 1666: \t// updated.",
        "// Line_Reference 1667: \tc.assertSvcAccSecretKeyAndStatusUpdate(ctx, s, userAdmClient, value.AccessKeyID, bucket)",
        "// Line_Reference 1668: "
    ]
}
