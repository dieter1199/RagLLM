{
    "cve_id": "CVE-2022-3910",
    "cve_description": "Use After Free vulnerability in Linux Kernel allows Privilege Escalation. An improper Update of Reference Count in io_uring leads to Use-After-Free and Local Privilege Escalation.\nWhen io_msg_ring was invoked with a fixed file, it called io_fput_file() which improperly decreased its reference count (leading to Use-After-Free and Local Privilege Escalation). Fixed files are permanently registered to the ring, and should not be put separately.\n\nWe recommend upgrading past commit  https://github.com/torvalds/linux/commit/fc7222c3a9f56271fba02aabbfbae999042f1679 https://github.com/torvalds/linux/commit/fc7222c3a9f56271fba02aabbfbae999042f1679 \n",
    "cve_publish_date": "2022-11-22",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "io_uring/msg_ring: check file type before putting\n\nIf we're invoked with a fixed file, follow the normal rules of not\ncalling io_fput_file(). Fixed files are permanently registered to the\nring, and do not need putting separately.\n\nCc: stable@vger.kernel.org\nFixes: aa184e8671f0 (\"io_uring: don't attempt to IOPOLL for MSG_RING requests\")\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
    "type_of_change": "Modification",
    "filename_of_changes": "msg_ring.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 168: \tio_put_file(req->file);"
    ]
}
