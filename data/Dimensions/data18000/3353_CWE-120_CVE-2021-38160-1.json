{
    "cve_id": "CVE-2021-38160",
    "cve_description": "In drivers/char/virtio_console.c in the Linux kernel before 5.13.4, data corruption or loss can be triggered by an untrusted device that supplies a buf->len value exceeding the buffer size. NOTE: the vendor indicates that the cited data corruption is not a vulnerability in any existing use case; the length validation was added solely for robustness in the face of anomalous host OS behavior",
    "cve_publish_date": "2021-08-07",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "virtio_console: Assure used length from device is limited\n\nThe buf->len might come from an untrusted device. This\nensures the value would not exceed the size of the buffer\nto avoid data corruption or loss.\n\nSigned-off-by: Xie Yongji <xieyongji@bytedance.com>\nAcked-by: Jason Wang <jasowang@redhat.com>\nLink: https://lore.kernel.org/r/20210525125622.1203-1-xieyongji@bytedance.com\nSigned-off-by: Michael S. Tsirkin <mst@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "virtio_console.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 478: \t\tbuf->len = len;",
        "// Line_Reference 1712: \t\tbuf->len = len;"
    ]
}
