{
    "cve_id": "CVE-2022-4558",
    "cve_description": "A vulnerability was found in Alinto SOGo up to 5.7.1. It has been classified as problematic. This affects an unknown part of the file SoObjects/SOGo/NSString+Utilities.m of the component Folder/Mail Handler. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 5.8.0 is able to address this issue. The name of the patch is 1e0f5f00890f751e84d67be4f139dd7f00faa5f3. It is recommended to upgrade the affected component. The identifier VDB-215961 was assigned to this vulnerability.",
    "cve_publish_date": "2022-12-16",
    "cwe_id": "CWE-707",
    "cwe_name": "Improper Neutralization",
    "cwe_description": "The product does not ensure or incorrectly ensures that structured messages or data are well-formed and that certain security properties are met before being read from an upstream component or sent to a downstream component.",
    "commit_message": "fix(security): Security fix for WSTG-INPV-02. Add XSS protection on folders and mail title / content",
    "type_of_change": "Modification",
    "filename_of_changes": "NSString+Utilities.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "49",
    "number_of_lines_deleted_vulnerable_to_cve": "33",
    "vulnerable_lines": [
        "// Line_Reference 901:   NSString *result, *text;",
        "// Line_Reference 902:   NSScanner *theScanner;",
        "// Line_Reference 903:   NSError *error;",
        "// Line_Reference 904: ",
        "// Line_Reference 905:   text = nil;",
        "// Line_Reference 906:   error = nil;",
        "// Line_Reference 907:   result = [NSString stringWithString: self];",
        "// Line_Reference 908: ",
        "// Line_Reference 909:   if (stripHTMLCode) {",
        "// Line_Reference 910:     // Author : https://www.codercrunch.com/question/1251681838/how-remove-html-tags-string-ios",
        "// Line_Reference 911:     theScanner = [NSScanner scannerWithString: result];",
        "// Line_Reference 912:     while ([theScanner isAtEnd] == NO) {",
        "// Line_Reference 913:       // find start of tag",
        "// Line_Reference 914:       [theScanner scanUpToString: @\"<\" intoString: NULL];",
        "// Line_Reference 915:       // find end of tag",
        "// Line_Reference 916:       [theScanner scanUpToString: @\">\" intoString: &text];",
        "// Line_Reference 917:       // replace the found tag with a space",
        "// Line_Reference 918:       //(you can filter multi-spaces out later if you wish)",
        "// Line_Reference 919:       result = [result stringByReplacingOccurrencesOfString:",
        "// Line_Reference 920:               [NSString stringWithFormat: @\"%@>\", text]",
        "// Line_Reference 921:               withString: @\" \"];",
        "// Line_Reference 922:     }",
        "// Line_Reference 923:   } else {",
        "// Line_Reference 924:     // Clean XSS",
        "// Line_Reference 925:     // Examples of injection : https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polygot",
        "// Line_Reference 926: ",
        "// Line_Reference 927:     // NSRegularExpression is not implemented in old GNUStep versions (ubuntu trusty)",
        "// Line_Reference 928:     if (NSClassFromString(@\"NSRegularExpression\")) {",
        "// Line_Reference 929:       NSRegularExpression *regex = nil;",
        "// Line_Reference 970:     }",
        "// Line_Reference 971:   }",
        "// Line_Reference 972: ",
        "// Line_Reference 973:   return result;"
    ]
}
