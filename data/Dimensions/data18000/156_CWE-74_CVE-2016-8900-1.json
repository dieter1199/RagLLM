{
    "cve_id": "CVE-2016-8900",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a Object Injection vulnerability in framework/modules/core/controllers/expTagController.php related to change_tags.",
    "cve_publish_date": "2019-05-24",
    "cwe_id": "CWE-74",
    "cwe_name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
    "cwe_description": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "addressController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 25: \tpublic $useractions = array(",
        "// Line_Reference 27:     );",
        "// Line_Reference 33:     protected $add_permissions = array(",
        "// Line_Reference 34:         'import' => 'Import External Addresses',",
        "// Line_Reference 35: //        'export' => 'Export External Addresses'",
        "// Line_Reference 62: ",
        "// Line_Reference 78: ",
        "// Line_Reference 90: ",
        "// Line_Reference 114: \t\t\tif ($count == 0)",
        "// Line_Reference 126:             //user is not logged in, but allow anonymous checkout is enabled so we'll check",
        "// Line_Reference 130:             $this->params['is_shipping'] = 1;",
        "// Line_Reference 133: \t\texpHistory::back();",
        "// Line_Reference 135: ",
        "// Line_Reference 141:         {",
        "// Line_Reference 150:                 if ($address->is_shipping)",
        "// Line_Reference 165: ",
        "// Line_Reference 172:         $db->setUniqueFlag($object, 'addresses', $this->params['is_what'], \"user_id=\" . $user->id);",
        "// Line_Reference 174:         expHistory::back();",
        "// Line_Reference 176: ",
        "// Line_Reference 182: ",
        "// Line_Reference 183:         $gr = new geoRegion();",
        "// Line_Reference 185: ",
        "// Line_Reference 191: ",
        "// Line_Reference 202:             $gc->active = true;",
        "// Line_Reference 203:             $gc->save();",
        "// Line_Reference 209:             $gc = new geoCountry($this->params['country_default']);",
        "// Line_Reference 210:             $db->setUniqueFlag($gc,'geo_country','is_default','id=' . $gc->id);",
        "// Line_Reference 211:             $gc->refresh();",
        "// Line_Reference 220:             $gr->save();"
    ]
}
