{
    "cve_id": "CVE-2024-21495",
    "cve_description": "Versions of the package github.com/greenpau/caddy-security before 1.0.42 are vulnerable to Insecure Randomness due to using an insecure random number generation library which could possibly be predicted via a brute-force search. Attackers could use the potentially predictable nonce value used for authentication purposes in the OAuth flow to conduct OAuth replay attacks. In addition, insecure randomness is used while generating multifactor authentication (MFA) secrets and creating API keys in the database package.",
    "cve_publish_date": "2024-02-17",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "security: addresses insecure randomness finding\n\nSee also: https://github.com/greenpau/caddy-security/issues/265",
    "type_of_change": "Modification",
    "filename_of_changes": "random.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 19: \t\"math/rand\"",
        "// Line_Reference 20: \t\"time\"",
        "// Line_Reference 36: var seed *rand.Rand = rand.New(",
        "// Line_Reference 37: \trand.NewSource(time.Now().UnixNano()),",
        "// Line_Reference 38: )",
        "// Line_Reference 40: func gen(length int, charset string) string {",
        "// Line_Reference 42: \tfor i := range b {",
        "// Line_Reference 43: \t\tb[i] = charset[seed.Intn(len(charset))]",
        "// Line_Reference 53: \treturn gen(i, charset)",
        "// Line_Reference 59: \tvar i int",
        "// Line_Reference 61: \t\ti = rand.Intn(a-b) + b",
        "// Line_Reference 63: \t\ti = rand.Intn(b-a) + a",
        "// Line_Reference 78: \tvar i int",
        "// Line_Reference 80: \t\ti = rand.Intn(a-b) + b",
        "// Line_Reference 82: \t\ti = rand.Intn(b-a) + a"
    ]
}
