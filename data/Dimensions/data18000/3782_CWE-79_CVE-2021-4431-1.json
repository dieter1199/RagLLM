{
    "cve_id": "CVE-2021-4431",
    "cve_description": "A vulnerability classified as problematic has been found in msyk FMDataAPI up to 22. Affected is an unknown function of the file FMDataAPI_Sample.php. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 23 is able to address this issue. The patch is identified as 3bd1709a8f7b1720529bf5dfc9855ad609f436cf. It is recommended to upgrade the affected component. VDB-244494 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix XSS in FMDataAPI_Sample.php",
    "type_of_change": "Modification",
    "filename_of_changes": "FMDataAPI_Sample.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "53",
    "vulnerable_lines": [
        "// Line_Reference 45:     echo \"Product Info: {$pInfo}<hr>\";",
        "// Line_Reference 47:     echo \"Database Names: {$pInfo}<hr>\";",
        "// Line_Reference 49:     echo \"Layout Names: {$pInfo}<hr>\";",
        "// Line_Reference 51:     echo \"Script Names: {$pInfo}<hr>\";",
        "// Line_Reference 54:     echo \"Layout Metadata: {$pInfo}<hr>\";",
        "// Line_Reference 57:     echo \"Layout Metadata (Old): {$pInfo}<hr>\";",
        "// Line_Reference 65:     echo \"HTTP Status: {$fmdb->httpStatus()}<hr>\";",
        "// Line_Reference 69:     echo \"Error Code: {$fmdb->errorCode()}<hr>\";",
        "// Line_Reference 70:     echo \"Error Message: {$fmdb->errorMessage()}<hr>\";",
        "// Line_Reference 73:     echo \"Target Table: {$fmdb->getTargetTable()}<hr>\";",
        "// Line_Reference 74:     echo \"Total Count: {$fmdb->getTotalCount()}<hr>\";",
        "// Line_Reference 75:     echo \"Found Count: {$fmdb->getFoundCount()}<hr>\";",
        "// Line_Reference 76:     echo \"Returned Count: {$fmdb->getReturnedCount()}<hr>\";",
        "// Line_Reference 84:         echo \"Target Table: {$result->getTargetTable()}<hr>\";",
        "// Line_Reference 85:         echo \"Total Count: {$result->getTotalCount()}<hr>\";",
        "// Line_Reference 86:         echo \"Found Count: {$result->getFoundCount()}<hr>\";",
        "// Line_Reference 87:         echo \"Returned Count: {$result->getReturnedCount()}<hr>\";",
        "// Line_Reference 89:             echo \"id: {$record->id},\";",
        "// Line_Reference 90:             echo \"name: {$record->name},\";",
        "// Line_Reference 91:             echo \"mail: {$record->mail}<hr>\";",
        "// Line_Reference 99:             $contacts = $record->contact_to;",
        "// Line_Reference 102:             echo \"Target Table: {$contacts->getTargetTable()}<hr>\";",
        "// Line_Reference 103:             echo \"Total Count: {$contacts->getTotalCount()}<hr>\";",
        "// Line_Reference 104:             echo \"Found Count: {$contacts->getFoundCount()}<hr>\";",
        "// Line_Reference 105:             echo \"Returned Count: {$contacts->getReturnedCount()}<hr>\";",
        "// Line_Reference 113:                 echo \"[PORTAL(contact_to)] id: {$item->field(\"id\", \"contact_to\")},\";",
        "// Line_Reference 114:                 echo \"summary: {$item->field(\"summary\", \"contact_to\")}<hr>\";",
        "// Line_Reference 130:             echo \"id: {$result->id},\";",
        "// Line_Reference 131:             echo \"name: {$result->name},\";",
        "// Line_Reference 132:             echo \"mail: {$result->mail}<hr>\";",
        "// Line_Reference 133:             $contacts = $result->contact_to;",
        "// Line_Reference 136:                 echo \"[PORTAL(contact_to)] id: {$contacts->field(\"id\", \"contact_to\")},\";",
        "// Line_Reference 137:                 echo \"summary: {$contacts->field(\"summary\", \"contact_to\")}<hr>\";",
        "// Line_Reference 152:             echo \"f3: {$record->f3},\";",
        "// Line_Reference 153:             echo \"f7: {$record->f7},\";",
        "// Line_Reference 154:             echo \"f8: {$record->f8}<hr>\";",
        "// Line_Reference 165:             echo \"f3: {$record->f3},\";",
        "// Line_Reference 166:             echo \"f7: {$record->f7},\";",
        "// Line_Reference 167:             echo \"f8: {$record->f8}<hr>\";",
        "// Line_Reference 177:         echo \"Script Error: {$fmdb->person_layout->getScriptError()}<hr>\";",
        "// Line_Reference 178:         echo \"Script Result: {$fmdb->person_layout->getScriptResult()}<hr>\";",
        "// Line_Reference 182:         echo \"Script Error: {$fmdb->person_layout->getScriptErrorPrerequest()}<hr>\";",
        "// Line_Reference 183:         echo \"Script Result: {$fmdb->person_layout->getScriptResultPrerequest()}<hr>\";",
        "// Line_Reference 187:         echo \"Script Error: {$fmdb->person_layout->getScriptError()}<hr>\";",
        "// Line_Reference 188:         echo \"Script Result: {$fmdb->person_layout->getScriptResult()}<hr>\";",
        "// Line_Reference 192:         echo \"Script Error: {$fmdb->person_layout->getScriptError()}<hr>\";",
        "// Line_Reference 193:         echo \"Script Result: {$fmdb->person_layout->getScriptResult()}<hr>\";",
        "// Line_Reference 206:     echo \"Target Table(getRecord): {$result->getTargetTable()}<hr>\";",
        "// Line_Reference 207:     echo \"Total Count(getRecord): {$result->getTotalCount()}<hr>\";",
        "// Line_Reference 208:     echo \"Found Count(getRecord): {$result->getFoundCount()}<hr>\";",
        "// Line_Reference 209:     echo \"Returned Count(getRecord): {$result->getReturnedCount()}<hr>\";",
        "// Line_Reference 213:             echo \"vc1: {$record->vc1}<hr>\";",
        "// Line_Reference 269:     echo '<div><h3>例外発生</h3>', $e->getMessage(), \"<div>\";"
    ]
}
