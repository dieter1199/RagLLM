{
    "cve_id": "CVE-2024-27100",
    "cve_description": "Discourse is an open source platform for community discussion. In affected versions the endpoints for suspending users, silencing users and exporting CSV files weren't enforcing limits on the sizes of the parameters that they accept. This could lead to excessive resource consumption which could render an instance inoperable. A site could be disrupted by either a malicious moderator on the same site or a malicious staff member on another site in the same multisite cluster. This issue is patched in the latest stable, beta and tests-passed versions of Discourse. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-03-15",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "SECURITY: Prevent large staff actions causing DoS\n\nThis commit operates at three levels of abstraction:\n\n 1. We want to prevent user history rows from being unbounded in size.\n    This commit adds rails validations to limit the sizes of columns on\n    user_histories,\n\n 2. However, we don't want to prevent certain actions from being\n    completed if these columns are too long. In those cases, we truncate\n    the values that are given and store the truncated versions,\n\n 3. For endpoints that perform staff actions, we can further control\n    what is permitted by explicitly validating the params that are given\n    before attempting the action,",
    "type_of_change": "Modification",
    "filename_of_changes": "staff_action_logger.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 41:     attrs[:details] = details.map { |r| \"#{r[0]}: #{r[1]}\" }.join(\"\\n\")",
        "// Line_Reference 83:       \"raw: #{deleted_post.raw}\",",
        "// Line_Reference 108:       details << \"raw: #{first_post.raw}\"",
        "// Line_Reference 182:         details: \"#{opts[:old_raw]}\\n\\n---\\n\\n#{post.raw}\",",
        "// Line_Reference 264: ",
        "// Line_Reference 268:       params(opts).merge(",
        "// Line_Reference 271:         previous_value: old_json,",
        "// Line_Reference 272:         new_value: new_json,",
        "// Line_Reference 280:       params(opts).merge(",
        "// Line_Reference 283:         previous_value: theme_json(theme),",
        "// Line_Reference 807:       \"raw: #{reviewable.payload[\"raw\"]}\","
    ]
}
