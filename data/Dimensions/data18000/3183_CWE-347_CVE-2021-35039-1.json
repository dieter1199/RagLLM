{
    "cve_id": "CVE-2021-35039",
    "cve_description": "kernel/module.c in the Linux kernel before 5.12.14 mishandles Signature Verification, aka CID-0c18f29aae7c. Without CONFIG_MODULE_SIG, verification that a kernel module is signed, for loading via init_module, does not occur for a module.sig_enforce=1 command-line argument.",
    "cve_publish_date": "2021-07-07",
    "cwe_id": "CWE-347",
    "cwe_name": "Improper Verification of Cryptographic Signature",
    "cwe_description": "The product does not verify, or incorrectly verifies, the cryptographic signature for data.",
    "commit_message": "module: limit enabling module.sig_enforce\n\nIrrespective as to whether CONFIG_MODULE_SIG is configured, specifying\n\"module.sig_enforce=1\" on the boot command line sets \"sig_enforce\".\nOnly allow \"sig_enforce\" to be set when CONFIG_MODULE_SIG is configured.\n\nThis patch makes the presence of /sys/module/module/parameters/sig_enforce\ndependent on CONFIG_MODULE_SIG=y.\n\nFixes: fda784e50aac (\"module: export module signature enforcement status\")\nReported-by: Nayna Jain <nayna@linux.ibm.com>\nTested-by: Mimi Zohar <zohar@linux.ibm.com>\nTested-by: Jessica Yu <jeyu@kernel.org>\nSigned-off-by: Mimi Zohar <zohar@linux.ibm.com>\nSigned-off-by: Jessica Yu <jeyu@kernel.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "module.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 282: void set_module_sig_enforced(void)",
        "// Line_Reference 283: {",
        "// Line_Reference 284: \tsig_enforce = true;",
        "// Line_Reference 285: }",
        "// Line_Reference 286: "
    ]
}
