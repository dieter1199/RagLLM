{
    "cve_id": "CVE-2021-26788",
    "cve_description": "Oryx Embedded CycloneTCP 1.7.6 to 2.0.0, fixed in 2.0.2, is affected by incorrect input validation, which may cause a denial of service (DoS). To exploit the vulnerability, an attacker needs to have TCP connectivity to the target system. Receiving a maliciously crafted TCP packet from an unauthenticated endpoint is sufficient to trigger the bug.",
    "cve_publish_date": "2021-03-08",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Version 2.0.2",
    "type_of_change": "Modification",
    "filename_of_changes": "dhcp_common.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "46",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 9:  * Copyright (C) 2010-2020 Oryx Embedded SARL. All rights reserved.",
        "// Line_Reference 28:  * @version 2.0.0",
        "// Line_Reference 70:       //Jump to next the next option",
        "// Line_Reference 87:       //Jump to next the next option",
        "// Line_Reference 111:    uint_t i;",
        "// Line_Reference 115:    if(length < sizeof(DhcpMessage))",
        "// Line_Reference 116:       return NULL;",
        "// Line_Reference 117:    //Get the length of the options field",
        "// Line_Reference 118:    length -= sizeof(DhcpMessage);",
        "// Line_Reference 119: ",
        "// Line_Reference 120:    //Parse DHCP options",
        "// Line_Reference 121:    for(i = 0; i < length; i++)",
        "// Line_Reference 123:       //Point to the current option",
        "// Line_Reference 124:       option = (DhcpOption *) (message->options + i);",
        "// Line_Reference 125: ",
        "// Line_Reference 126:       //Pad option detected?",
        "// Line_Reference 127:       if(option->code == DHCP_OPT_PAD)",
        "// Line_Reference 128:          continue;",
        "// Line_Reference 129:       //End option detected?",
        "// Line_Reference 130:       if(option->code == DHCP_OPT_END)",
        "// Line_Reference 131:          break;",
        "// Line_Reference 132:       //Check option length",
        "// Line_Reference 133:       if((i + 1) >= length || (i + 1 + option->length) >= length)",
        "// Line_Reference 134:          break;",
        "// Line_Reference 135: ",
        "// Line_Reference 136:       //Current option code matches the specified one?",
        "// Line_Reference 137:       if(option->code == optionCode)",
        "// Line_Reference 138:          return option;",
        "// Line_Reference 139: ",
        "// Line_Reference 140:       //Jump to the next option",
        "// Line_Reference 141:       i += option->length + 1;",
        "// Line_Reference 144:    //Specified option code not found"
    ]
}
