{
    "cve_id": "CVE-2022-39249",
    "cve_description": "Matrix Javascript SDK is the Matrix Client-Server SDK for JavaScript. Prior to version 19.7.0, an attacker cooperating with a malicious homeserver can construct messages appearing to have come from another person. Such messages will be marked with a grey shield on some platforms, but this may be missing in others. This attack is possible due to the matrix-js-sdk implementing a too permissive key forwarding strategy on the receiving end. Starting with version 19.7.0, the default policy for accepting key forwards has been made more strict in the matrix-js-sdk. matrix-js-sdk will now only accept forwarded keys in response to previously issued requests and only from own, verified devices. The SDK now sets a `trusted` flag on the decrypted message upon decryption, based on whether the key used to decrypt the message was received from a trusted source. Clients need to ensure that messages decrypted with a key with `trusted = false` are decorated appropriately, for example, by showing a warning for such messages. This attack requires coordination between a malicious homeserver and an attacker, and those who trust your homeservers do not need a workaround.",
    "cve_publish_date": "2022-09-28",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "Resolve multiple CVEs\n\nCVE-2022-39249\nCVE-2022-39250\nCVE-2022-39251\nCVE-2022-39236",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 2403:         const forwardingChain = event.getForwardingCurve25519KeyChain();",
        "// Line_Reference 2404:         if (forwardingChain.length > 0) {",
        "// Line_Reference 2405:             // we got the key this event from somewhere else",
        "// Line_Reference 2406:             // TODO: check if we can trust the forwarders.",
        "// Line_Reference 2407:             return null;",
        "// Line_Reference 2408:         }",
        "// Line_Reference 2409: ",
        "// Line_Reference 2481:         const forwardingChain = event.getForwardingCurve25519KeyChain();",
        "// Line_Reference 2482:         if (forwardingChain.length > 0 || event.isKeySourceUntrusted()) {"
    ]
}
