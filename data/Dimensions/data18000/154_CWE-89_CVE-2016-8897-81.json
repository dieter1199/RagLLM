{
    "cve_id": "CVE-2016-8897",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a sql injection vulnerability in framework/modules/help/controllers/helpController.php.",
    "cve_publish_date": "2019-05-23",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "importexportController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "58",
    "number_of_lines_deleted_vulnerable_to_cve": "51",
    "vulnerable_lines": [
        "// Line_Reference 38:     //protected $permissions = array_merge(array(\"test\"=>'Test'), array('copyProduct'=>\"Copy Product\"));",
        "// Line_Reference 39:     protected $add_permissions = array(",
        "// Line_Reference 40:         'import' => 'Import Data',",
        "// Line_Reference 41:         'export' => 'Export Data'",
        "// Line_Reference 42:     );",
        "// Line_Reference 360:         //eDebug($this->params,true);",
        "// Line_Reference 400:         //eDebug($data);",
        "// Line_Reference 401:         $source = '';",
        "// Line_Reference 404:             $dataset[$value] = '';",
        "// Line_Reference 407: ",
        "// Line_Reference 414: ",
        "// Line_Reference 418:             $extAddy = new external_address();",
        "// Line_Reference 425:                 $extAddy->lastname = $bName[2];",
        "// Line_Reference 430:                 $extAddy->lastname = '';",
        "// Line_Reference 435:                 $extAddy->lastname = $bName[1];",
        "// Line_Reference 437: ",
        "// Line_Reference 440:             $extAddy->address2 = $data[6];",
        "// Line_Reference 441:             $extAddy->address2 = $data[6];",
        "// Line_Reference 442:             $extAddy->city = $data[7];",
        "// Line_Reference 443: ",
        "// Line_Reference 447:             $extAddy->state = $state->id;",
        "// Line_Reference 448:             $extAddy->zip = str_ireplace(\"'\",'',$data[9]);",
        "// Line_Reference 449:             $extAddy->phone = $data[20];",
        "// Line_Reference 450:             $extAddy->email = $data[21];",
        "// Line_Reference 452: ",
        "// Line_Reference 453: ",
        "// Line_Reference 458:                 $extAddy->is_shipping = 1;",
        "// Line_Reference 459:                 $extAddy->save(false);",
        "// Line_Reference 462:             {",
        "// Line_Reference 464:                 $extAddy->is_shipping = 0;",
        "// Line_Reference 465:                 $extAddy->save(false);",
        "// Line_Reference 466: ",
        "// Line_Reference 467:                 $extAddy = new external_address();",
        "// Line_Reference 474:                     $extAddy->lastname = $sName[2];",
        "// Line_Reference 479:                     $extAddy->lastname = '';",
        "// Line_Reference 484:                     $extAddy->lastname = $sName[1];",
        "// Line_Reference 486: ",
        "// Line_Reference 489:                 $extAddy->address2 = $data[15];",
        "// Line_Reference 490:                 $extAddy->city = $data[16];",
        "// Line_Reference 491: ",
        "// Line_Reference 495:                 $extAddy->state = $state->id;",
        "// Line_Reference 496:                 $extAddy->zip = str_ireplace(\"'\",'',$data[18]);",
        "// Line_Reference 497:                 $extAddy->phone = $data[20];",
        "// Line_Reference 498:                 $extAddy->email = $data[21];",
        "// Line_Reference 501:                 $extAddy->source = $source;",
        "// Line_Reference 502: ",
        "// Line_Reference 505: ",
        "// Line_Reference 508: ",
        "// Line_Reference 509:         }",
        "// Line_Reference 510: ",
        "// Line_Reference 527:         }"
    ]
}
