{
    "cve_id": "CVE-2020-15900",
    "cve_description": "A memory corruption issue was found in Artifex Ghostscript 9.50 and 9.52. Use of a non-standard PostScript operator can allow overriding of file access controls. The 'rsearch' calculation for the 'post' size resulted in a size that was too large, and could underflow to max uint32_t. This was fixed in commit 5d499272b95a6b890a1397e11d20937de000d31b.",
    "cve_publish_date": "2020-07-28",
    "cwe_id": "CWE-191",
    "cwe_name": "Integer Underflow (Wrap or Wraparound)",
    "cwe_description": "The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result.",
    "commit_message": "Bug 702582, CVE 2020-15900 Memory Corruption in Ghostscript 9.52\n\nFix the 'rsearch' calculation for the 'post' size to give the correct\nsize.  Previous calculation would result in a size that was too large,\nand could underflow to max uint32_t. Also fix 'rsearch' to return the\ncorrect 'pre' string with empty string match.\n\nA future change may 'undefine' this undocumented, non-standard operator\nduring initialization as we do with the many other non-standard internal\nPostScript operators and procedures.",
    "type_of_change": "Modification",
    "filename_of_changes": "zstring.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 145:     op->value.bytes = ptr;",
        "// Line_Reference 146:     r_set_size(op, size);",
        "// Line_Reference 148:     op[-1] = *op1;",
        "// Line_Reference 149:     r_set_size(op - 1, ptr - op[-1].value.bytes);",
        "// Line_Reference 150:     op1->value.bytes = ptr + size;",
        "// Line_Reference 151:     r_set_size(op1, count + (!forward ? (size - 1) : 0));"
    ]
}
