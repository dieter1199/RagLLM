{
    "cve_id": "CVE-2017-12146",
    "cve_description": "The driver_override implementation in drivers/base/platform.c in the Linux kernel before 4.12.1 allows local users to gain privileges by leveraging a race condition between a read operation and a store operation that involve different overrides.",
    "cve_publish_date": "2017-09-08",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "driver core: platform: fix race condition with driver_override\n\nThe driver_override implementation is susceptible to race condition when\ndifferent threads are reading vs storing a different driver override.\nAdd locking to avoid race condition.\n\nFixes: 3d713e0e382e (\"driver core: platform: add device binding path 'driver_override'\")\nCc: stable@vger.kernel.org\nSigned-off-by: Adrian Salido <salidoa@google.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "platform.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 869: \tchar *driver_override, *old = pdev->driver_override, *cp;",
        "// Line_Reference 899: \treturn sprintf(buf, \"%s\\n\", pdev->driver_override);"
    ]
}
