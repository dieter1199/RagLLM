{
    "cve_id": "CVE-2022-23475",
    "cve_description": "daloRADIUS is an open source RADIUS web management application. daloRadius 1.3 and prior are vulnerable to a combination cross site scripting (XSS) and cross site request forgery (CSRF) vulnerability which leads to account takeover in the mng-del.php file because of an unescaped variable reflected in the DOM on line 116. This issue has been addressed in commit `ec3b4a419e`. Users are advised to manually apply the commit in order to mitigate this issue. Users may also mitigate this issue with in two parts 1) The CSRF vulnerability can be mitigated  by making the daloRadius session cookie to samesite=Lax or by the implimentation of a CSRF token in all forms. 2) The XSS vulnerability may be mitigated by escaping it or by introducing a Content-Security policy.\n\n\n",
    "cve_publish_date": "2022-12-06",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Improvements to PDF ticket printing and security issues fix/mitigation (#297)\n\n* Improved notification and ticket printing features\r\n\r\n* minor template fixes\r\n\r\n* fixed redirection on checklogin\r\n\r\n* addressed some security issues",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "notificationsWelcome.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "76",
    "number_of_lines_deleted_vulnerable_to_cve": "54",
    "vulnerable_lines": [
        "// Line_Reference 1: <?php",
        "// Line_Reference 18:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 23: \trequire_once(dirname(__FILE__).\"/../../notifications/processNotificationWelcome.php\");",
        "// Line_Reference 24: ",
        "// Line_Reference 25: \tif (!empty($email))",
        "// Line_Reference 26: \t\t$invoice_email = $email;",
        "// Line_Reference 27: \telse if (!empty($bi_emailinvoice))",
        "// Line_Reference 28: \t\t$invoice_email = $bi_emailinvoice;",
        "// Line_Reference 29: \telse if (!empty($bi_email))",
        "// Line_Reference 30: \t\t$invoice_email = $bi_email;",
        "// Line_Reference 31: \telse",
        "// Line_Reference 32: \t\t$invoice_email = \"\";",
        "// Line_Reference 33: ",
        "// Line_Reference 34: \tif (!empty($mobilephone))",
        "// Line_Reference 35: \t\t$invoice_phone = $mobilephone;",
        "// Line_Reference 36: \telse if (!empty($workphone))",
        "// Line_Reference 37: \t\t$invoice_phone = $workphone;",
        "// Line_Reference 38: \telse if (!empty($homephone))",
        "// Line_Reference 39: \t\t$invoice_phone = $homephone;",
        "// Line_Reference 40: \telse",
        "// Line_Reference 41: \t\t$invoice_phone = \"Unavailable\";",
        "// Line_Reference 42: ",
        "// Line_Reference 43: \t$invoice_address = \"\";",
        "// Line_Reference 44: \tif (!empty($ui_address))",
        "// Line_Reference 45: \t\t$invoice_address = $ui_address;",
        "// Line_Reference 46: ",
        "// Line_Reference 47: \tif (!empty($ui_city))",
        "// Line_Reference 48: \t\t$invoice_address .= \", \".$ui_city;",
        "// Line_Reference 49: ",
        "// Line_Reference 50: \tif (!empty($ui_state))",
        "// Line_Reference 51: \t\t$invoice_address .= \"<br/>\".$ui_state;",
        "// Line_Reference 52: ",
        "// Line_Reference 53: \tif (!empty($ui_zip))",
        "// Line_Reference 54: \t\t$invoice_address .= \" \".$ui_zip;",
        "// Line_Reference 55: ",
        "// Line_Reference 56: \tif (empty($invoice_address))",
        "// Line_Reference 57: \t\t$invoice_address = \"Unavailable\";",
        "// Line_Reference 58: ",
        "// Line_Reference 59: \t$customerInfo = array();",
        "// Line_Reference 60: \t$customerInfo['customer_name'] = $firstname .\" \".$lastname;",
        "// Line_Reference 61: \t$customerInfo['customer_address'] = $invoice_address;",
        "// Line_Reference 62: ",
        "// Line_Reference 63: \t$customerInfo['customer_phone'] = $invoice_phone;",
        "// Line_Reference 64: \t$customerInfo['customer_email'] = $invoice_email;",
        "// Line_Reference 65: \t$customerInfo['service_plan_name'] = $planName;",
        "// Line_Reference 66: ",
        "// Line_Reference 67: \t$smtpInfo['host'] = $configValues['CONFIG_MAIL_SMTPADDR'];",
        "// Line_Reference 68: \t$smtpInfo['port'] = $configValues['CONFIG_MAIL_SMTPPORT'];",
        "// Line_Reference 69: \t$smtpInfo['auth'] = $configValues['CONFIG_MAIL_SMTPAUTH'];",
        "// Line_Reference 70: \t$from = $configValues['CONFIG_MAIL_SMTPFROM'];",
        "// Line_Reference 71: ",
        "// Line_Reference 72: \t@sendWelcomeNotification($customerInfo, $smtpInfo, $from);",
        "// Line_Reference 73: ",
        "// Line_Reference 74: ?>"
    ]
}
