{
    "cve_id": "CVE-2020-25781",
    "cve_description": "An issue was discovered in file_download.php in MantisBT before 2.24.3. Users without access to view private issue notes are able to download the (supposedly private) attachments linked to these notes by accessing the corresponding file download URL directly.",
    "cve_publish_date": "2020-09-30",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "Check ability to download attachments at bugnote level\n\nThis prevents users authorized to download attachments but not to view\nprivate bugnotes, from accessing files attached to a private note via\n`file_download.php?file_id={FILE_ID}&type=bug` (CVE-2020-25781).\n\nIncludes some minor code cleanup in file_get_visible_attachments():\n- use a foreach loop\n- reuse variables instead of derefenrcing array\n\nFixes #27039",
    "type_of_change": "Modification",
    "filename_of_changes": "file_download.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 113: \t\tif( !file_can_download_bug_attachments( $v_bug_id, (int)$v_user_id ) ) {"
    ]
}
