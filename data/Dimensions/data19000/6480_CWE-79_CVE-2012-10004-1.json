{
    "cve_id": "CVE-2012-10004",
    "cve_description": "A vulnerability was found in backdrop-contrib Basic Cart on Drupal. It has been classified as problematic. Affected is the function basic_cart_checkout_form_submit of the file basic_cart.cart.inc. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.x-1.1.1 is able to address this issue. The patch is identified as a10424ccd4b3b4b433cf33b73c1ad608b11890b4. It is recommended to upgrade the affected component. VDB-217950 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-01-11",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "XSS issue, drupal mail instead of mail system",
    "type_of_change": "Modification",
    "filename_of_changes": "basic_cart.admin.inc",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "47",
    "vulnerable_lines": [
        "// Line_Reference 28:   $form['content_type']['types'] = array(",
        "// Line_Reference 41:   $form['messages']['admin_subject'] = array(",
        "// Line_Reference 48:   $form['messages']['admin_message'] = array(",
        "// Line_Reference 55:   $form['messages']['send_user_message'] = array(",
        "// Line_Reference 61:   $form['messages']['user_subject'] = array(",
        "// Line_Reference 68:   $form['messages']['user_message'] = array(",
        "// Line_Reference 81:   $form['thank_you']['thank_you_title'] = array(",
        "// Line_Reference 88:   $form['thank_you']['thank_you_message'] = array(",
        "// Line_Reference 95:   $form['save'] = array(",
        "// Line_Reference 96:     '#type' => 'submit',",
        "// Line_Reference 97:     '#value' => t('Save configuration'),",
        "// Line_Reference 98:   );",
        "// Line_Reference 99: ",
        "// Line_Reference 100:   return $form;",
        "// Line_Reference 101: }",
        "// Line_Reference 102: ",
        "// Line_Reference 103: ",
        "// Line_Reference 104: /**",
        "// Line_Reference 105:  * Callback for the admin configuration page submit function",
        "// Line_Reference 106:  */",
        "// Line_Reference 107: function basic_cart_admin_content_type_submit($form_id, $form_state) {",
        "// Line_Reference 108:   $types = $form_state['values']['types'];",
        "// Line_Reference 109:   $selected_types = array();",
        "// Line_Reference 110:   foreach ($types as $type) {",
        "// Line_Reference 111:     if (!empty($type)) {",
        "// Line_Reference 112:       $selected_types[] = $type;",
        "// Line_Reference 113:     }",
        "// Line_Reference 114:   }",
        "// Line_Reference 115: ",
        "// Line_Reference 116:   // Content types.",
        "// Line_Reference 117:   variable_set('basic_cart_content_types', $selected_types);",
        "// Line_Reference 118: ",
        "// Line_Reference 119:   // Admin message.",
        "// Line_Reference 120:   variable_set('basic_cart_admin_message', $form_state['values']['admin_message']);",
        "// Line_Reference 121:   variable_set('basic_cart_admin_subject', $form_state['values']['admin_subject']);",
        "// Line_Reference 122: ",
        "// Line_Reference 123:   // User message.",
        "// Line_Reference 124:   variable_set('basic_cart_send_user_message', $form_state['values']['send_user_message']);",
        "// Line_Reference 125:   variable_set('basic_cart_user_message', $form_state['values']['user_message']);",
        "// Line_Reference 126:   variable_set('basic_cart_user_subject', $form_state['values']['user_subject']);",
        "// Line_Reference 127: ",
        "// Line_Reference 128:   // Thank you message.",
        "// Line_Reference 129:   variable_set('basic_cart_thank_you_title', $form_state['values']['thank_you_title']);",
        "// Line_Reference 130:   variable_set('basic_cart_thank_you_message', $form_state['values']['thank_you_message']);",
        "// Line_Reference 131: ",
        "// Line_Reference 132:   // Message.",
        "// Line_Reference 133:   drupal_set_message(t('The configuration options have been saved.'));"
    ]
}
