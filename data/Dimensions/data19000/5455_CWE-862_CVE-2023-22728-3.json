{
    "cve_id": "CVE-2023-22728",
    "cve_description": "Silverstripe Framework is the Model-View-Controller framework that powers the Silverstripe content management system. Prior to version 4.12.15, the GridField print view incorrectly validates the permission of DataObjects potentially allowing a content author to view records they are not authorised to access. Users should upgrade to Silverstripe Framework 4.12.15 or above to address the issue.",
    "cve_publish_date": "2023-04-26",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "[CVE-2023-22728] Check canView before printing from GridField",
    "type_of_change": "Modification",
    "filename_of_changes": "GridFieldPrintButton.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 231:             $itemRow = new ArrayList();",
        "// Line_Reference 233:             foreach ($printColumns as $field => $label) {",
        "// Line_Reference 234:                 $value = $gridFieldColumnsComponent",
        "// Line_Reference 235:                     ? strip_tags($gridFieldColumnsComponent->getColumnContent($gridField, $item, $field))",
        "// Line_Reference 236:                     : $gridField->getDataFieldValue($item, $field);",
        "// Line_Reference 238:                 $itemRow->push(new ArrayData([",
        "// Line_Reference 239:                     \"CellString\" => $value,",
        "// Line_Reference 242: ",
        "// Line_Reference 243:             $itemRows->push(new ArrayData([",
        "// Line_Reference 244:                 \"ItemRow\" => $itemRow",
        "// Line_Reference 245:             ]));"
    ]
}
