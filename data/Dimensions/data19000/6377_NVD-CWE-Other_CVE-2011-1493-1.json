{
    "cve_id": "CVE-2011-1493",
    "cve_description": "Array index error in the rose_parse_national function in net/rose/rose_subr.c in the Linux kernel before 2.6.39 allows remote attackers to cause a denial of service (heap memory corruption) or possibly have unspecified other impact by composing FAC_NATIONAL_DIGIS data that specifies a large number of digipeaters, and then sending this data to a ROSE socket.",
    "cve_publish_date": "2012-06-21",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "ROSE: prevent heap corruption with bad facilities\n\nWhen parsing the FAC_NATIONAL_DIGIS facilities field, it's possible for\na remote host to provide more digipeaters than expected, resulting in\nheap corruption.  Check against ROSE_MAX_DIGIS to prevent overflows, and\nabort facilities parsing on failure.\n\nAdditionally, when parsing the FAC_CCITT_DEST_NSAP and\nFAC_CCITT_SRC_NSAP facilities fields, a remote host can provide a length\nof less than 10, resulting in an underflow in a memcpy size, causing a\nkernel panic due to massive heap corruption.  A length of greater than\n20 results in a stack overflow of the callsign array.  Abort facilities\nparsing on these invalid length values.\n\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nCc: stable@kernel.org\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "rose_subr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 293: \t\t\t\t\tif (pt[6] & AX25_HBIT)",
        "// Line_Reference 295: \t\t\t\t\telse"
    ]
}
