{
    "cve_id": "CVE-2021-38711",
    "cve_description": "In gitit before 0.15.0.0, the Export feature can be exploited to leak information from files.",
    "cve_publish_date": "2021-08-16",
    "cwe_id": "CWE-552",
    "cwe_name": "Files or Directories Accessible to External Parties",
    "cwe_description": "The product makes files or directories accessible to unauthorized actors, even though they should not be.",
    "commit_message": "Remove the Export feature.\n\nThis feature is a security risk; it provided multiple\nvectors by which contents of files could be exposed.\n\nAPI change: remove Network.Gitit.Export.",
    "type_of_change": "Modification",
    "filename_of_changes": "Layout.hs",
    "code_language": "Haskell",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 34: import Network.Gitit.Export (exportFormats)",
        "// Line_Reference 39: import Data.Maybe (isNothing, isJust, fromJust)",
        "// Line_Reference 114:                    T.setAttribute \"exportbox\"",
        "// Line_Reference 115:                        (renderHtmlFragment $  exportBox base' cfg page rev) .",
        "// Line_Reference 125: exportBox :: String -> Config -> String -> Maybe String -> Html",
        "// Line_Reference 126: exportBox base' cfg page rev | not (isSourceCode page) =",
        "// Line_Reference 127:   gui (base' ++ urlForPage page) ! [identifier \"exportbox\"] <<",
        "// Line_Reference 128:     ([ textfield \"revision\" ! [thestyle \"display: none;\",",
        "// Line_Reference 129:          value (fromJust rev)] | isJust rev ] ++",
        "// Line_Reference 130:      [ select ! [name \"format\"] <<",
        "// Line_Reference 131:          map ((\\f -> option ! [value f] << f) . fst) (exportFormats cfg)",
        "// Line_Reference 132:      , primHtmlChar \"nbsp\"",
        "// Line_Reference 133:      , submit \"export\" \"Export\" ])",
        "// Line_Reference 134: exportBox _ _ _ _ = noHtml",
        "// Line_Reference 135: "
    ]
}
