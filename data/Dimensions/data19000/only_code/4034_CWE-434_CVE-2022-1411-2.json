$result = explode(',', $contents, 2);
$contentType = $isBase64 = false;
if (2 === \count($result)) {
[$metadata, $data] = $result;
foreach (explode(';', $metadata) as $cur) {
if ('base64' === $cur) {
$isBase64 = true;
} elseif ('data:' === substr($cur, 0, 5)) {
$contentType = str_replace('data:', '', $cur);
}
}
} else {
$data = $result[0];
}
$data = rawurldecode($data);
$rawData = $isBase64 ? base64_decode($data) : $data;
if (\strlen($rawData) < 12) {
Log::error('Incorrect content value: ' . $contents, __CLASS__);
return false;
}
$fileInstance = static::loadFromContent($rawData, false, array_merge($param, ['mimeType' => $contentType]));
'crmid' => 0