$tmp_file = sys_get_temp_dir() . DIRECTORY_SEPARATOR . $query['code'] . '.zip';
@core_file_curl($url, $tmp_file);
if(@filesize($tmp_file) == 0)
@unlink($tmp_file);
// core file curl failed, try using file_get_contents...
$tmp = @file_get_contents($url);
if(!empty($tmp))
{
@file_put_contents($tmp_file, $tmp);
}
unset($tmp);
if(@filesize($tmp_file) > 0)
// uncompress ZIP and copy it to the themes dir
@mkdir(NAVIGATE_PATH.'/themes/'.$query['code']);
$zip = new ZipArchive();
$zip_open_status = $zip->open($tmp_file);
if($zip_open_status === TRUE)
$zip->extractTo(NAVIGATE_PATH.'/themes/'.$query['code']);
$zip->close();
$layout->navigate_notification(t(374, "Item installed successfully."), false);
else // zip extraction failed
$layout->navigate_notification('ERROR '.$zip_open_status, true, true);
$error = true;
title: "'.t(56, "Unexpected error").'"
// don't break, we want to show the themes grid right now (theme_upload by browser upload won't trigger)
