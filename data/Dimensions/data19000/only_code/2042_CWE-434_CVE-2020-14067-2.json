$tmp_file = sys_get_temp_dir().DIRECTORY_SEPARATOR.$query['code'].'.zip';
@core_file_curl($url, $tmp_file);
if(@filesize($tmp_file) == 0)
@unlink($tmp_file);
// core file curl failed, try using file_get_contents...
$tmp = @file_get_contents($url);
if(!empty($tmp))
{
@file_put_contents($tmp_file, $tmp);
}
unset($tmp);
if(@filesize($tmp_file) > 0)
// uncompress ZIP and copy it to the extensions dir
@mkdir(NAVIGATE_PATH.'/plugins/'.$query['code']);
$zip = new ZipArchive();
$zip_open_status = $zip->open($tmp_file);
if($zip_open_status === TRUE)
$zip->extractTo(NAVIGATE_PATH.'/plugins/'.$query['code']);
$zip->close();
$layout->navigate_notification(t(374, "Item installed successfully."), false);
else // zip extraction failed
$layout->navigate_notification('ERROR '.$zip_open_status, true, true);
$error = true;
title: "'.t(56, "Unexpected error").'"
// don't break, we want to show the themes grid right now (theme_upload by browser upload won't trigger)
$(window).on("load", function()
{
$(".navigrid-item-buttonset").each(function(i, el)
{
$(el).hide().css("visibility", "visible");
$(el).fadeIn();
$(".navigrid-extensions-disable").addClass("ui-corner-right");
});
});
function navitable_quicksearch(value)
{
$(".navigrid-item").hide();
if(value=="")
$(".navigrid-item").show();
else
{
$(".navigrid-item").each(function(i, el)
{
var item_text = $(el).text().toLowerCase();
if( item_text.indexOf(value.toLowerCase()) >= 0 )
$(el).fadeIn();
});
}
}
$("#extension-upload-button").on("click", function()
{
$("#extension-upload-button").parent().find("form").remove();
$("#extension-upload-button").after(\'<form action="?fid=extensions&act=extension_upload" enctype="multipart/form-data" method="post"><input type="file" name="extension-upload" style=" display: none;" /><input type="hidden" id="_nv_csrf_token" name="_nv_csrf_token" value="\'+navigatecms.csrf_token+\'" /></form>\');
$("#extension-upload-button").next().find("input").on("change", function()
{
if($(this).val()!="")
$(this).parent().submit();
});
$("#extension-upload-button").next().find("input").trigger("click");
return false;
});
