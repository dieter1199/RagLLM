{
    "cve_id": "CVE-2016-6561",
    "cve_description": "illumos smbsrv NULL pointer dereference allows system crash.",
    "cve_publish_date": "2017-03-31",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "7483 SMB flush on pipe triggers NULL pointer dereference in module smbsrv\nReviewed by: Gordon Ross <gwr@nexenta.com>\nReviewed by: Matt Barden <matt.barden@nexenta.com>\nReviewed by: Evan Layton <evan.layton@nexenta.com>\nReviewed by: Dan McDonald <danmcd@omniti.com>\nApproved by: Gordon Ross <gwr@nexenta.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "smb_flush.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 43: static void smb_flush_file(struct smb_request *sr, struct smb_ofile *ofile);",
        "// Line_Reference 44: ",
        "// Line_Reference 93: ",
        "// Line_Reference 94: \t\tsmb_flush_file(sr, sr->fid_ofile);",
        "// Line_Reference 101: \t\t\tsmb_flush_file(sr, file);",
        "// Line_Reference 111: ",
        "// Line_Reference 112: ",
        "// Line_Reference 113: /*",
        "// Line_Reference 114:  * smb_flush_file",
        "// Line_Reference 115:  *",
        "// Line_Reference 116:  * If writes on this file are not synchronous, flush it using the NFSv3",
        "// Line_Reference 117:  * commit interface.",
        "// Line_Reference 118:  */",
        "// Line_Reference 119: static void",
        "// Line_Reference 120: smb_flush_file(struct smb_request *sr, struct smb_ofile *ofile)",
        "// Line_Reference 121: {",
        "// Line_Reference 122: \tsr->user_cr = smb_ofile_getcred(ofile);",
        "// Line_Reference 123: ",
        "// Line_Reference 124: \tif ((ofile->f_node->flags & NODE_FLAGS_WRITE_THROUGH) == 0)",
        "// Line_Reference 125: \t\t(void) smb_fsop_commit(sr, sr->user_cr, ofile->f_node);",
        "// Line_Reference 126: }"
    ]
}
