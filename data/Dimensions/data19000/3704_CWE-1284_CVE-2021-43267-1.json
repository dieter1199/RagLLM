{
    "cve_id": "CVE-2021-43267",
    "cve_description": "An issue was discovered in net/tipc/crypto.c in the Linux kernel before 5.14.16. The Transparent Inter-Process Communication (TIPC) functionality allows remote attackers to exploit insufficient validation of user-supplied sizes for the MSG_CRYPTO message type.",
    "cve_publish_date": "2021-11-02",
    "cwe_id": "CWE-1284",
    "cwe_name": "Improper Validation of Specified Quantity in Input",
    "cwe_description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
    "commit_message": "tipc: fix size validations for the MSG_CRYPTO type\n\nThe function tipc_crypto_key_rcv is used to parse MSG_CRYPTO messages\nto receive keys from other nodes in the cluster in order to decrypt any\nfurther messages from them.\nThis patch verifies that any supplied sizes in the message body are\nvalid for the received message.\n\nFixes: 1ef6f7c9390f (\"tipc: add automatic session key exchange\")\nSigned-off-by: Max VA <maxv@sentinelone.com>\nAcked-by: Ying Xue <ying.xue@windriver.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "crypto.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 2293: \t\tgoto exit;",
        "// Line_Reference 2300: \t\tgoto exit;",
        "// Line_Reference 2304: \tskey->keylen = ntohl(*((__be32 *)(data + TIPC_AEAD_ALG_NAME)));",
        "// Line_Reference 2309: \t/* Sanity check */",
        "// Line_Reference 2310: \tif (unlikely(size != tipc_aead_key_size(skey))) {",
        "// Line_Reference 2311: \t\tkfree(skey);",
        "// Line_Reference 2312: \t\tskey = NULL;",
        "// Line_Reference 2313: \t\tgoto exit;",
        "// Line_Reference 2314: \t}",
        "// Line_Reference 2315: ",
        "// Line_Reference 2322: exit:"
    ]
}
