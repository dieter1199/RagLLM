{
    "cve_id": "CVE-2020-12141",
    "cve_description": "An out-of-bounds read in the SNMP stack in Contiki-NG 4.4 and earlier allows an attacker to cause a denial of service and potentially disclose information via crafted SNMP packets to snmp_ber_decode_string_len_buffer in os/net/app-layer/snmp/snmp-ber.c.",
    "cve_publish_date": "2021-10-19",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Refactored SNMP engine after vulnerabilities",
    "type_of_change": "Modification",
    "filename_of_changes": "snmp-message.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 2:  * Copyright (C) 2019 Yago Fontoura do Rosario <yago.rosario@hotmail.com.br>",
        "// Line_Reference 35:  *      An implementation of the Simple Network Management Protocol (RFC 3411-3418)",
        "// Line_Reference 48: #include \"snmp.h\"",
        "// Line_Reference 50: #define SNMP_DATA_TYPE_TIME_TICKS               0x43",
        "// Line_Reference 51: #define SNMP_DATA_TYPE_NO_SUCH_INSTANCE         0x81",
        "// Line_Reference 52: #define SNMP_DATA_TYPE_END_OF_MIB_VIEW          0x82",
        "// Line_Reference 54: #define SNMP_DATA_TYPE_PDU_GET_REQUEST          0xA0",
        "// Line_Reference 55: #define SNMP_DATA_TYPE_PDU_GET_NEXT_REQUEST     0xA1",
        "// Line_Reference 56: #define SNMP_DATA_TYPE_PDU_GET_RESPONSE         0xA2",
        "// Line_Reference 57: #define SNMP_DATA_TYPE_PDU_SET_REQUEST          0xA3",
        "// Line_Reference 58: #define SNMP_DATA_TYPE_PDU_TRAP                 0xA4",
        "// Line_Reference 59: #define SNMP_DATA_TYPE_PDU_GET_BULK             0xA5",
        "// Line_Reference 64:  * @param out A pointer to the end of the buffer",
        "// Line_Reference 65:  * @param out_len A pointer to the buffer length",
        "// Line_Reference 68:  * @param varbinds_length The number of varbinds",
        "// Line_Reference 72: unsigned char *",
        "// Line_Reference 73: snmp_message_encode(unsigned char *out, uint32_t *out_len, snmp_header_t *header,",
        "// Line_Reference 74:                     snmp_varbind_t *varbinds, uint32_t varbinds_length);",
        "// Line_Reference 78:  * @param buf A pointer to the beginning of the buffer",
        "// Line_Reference 79:  * @param buf_len A pointer to the buffer length",
        "// Line_Reference 82:  * @param varbinds_length A pointer to the number of varbinds",
        "// Line_Reference 86: uint8_t *",
        "// Line_Reference 87: snmp_message_decode(uint8_t *buf, uint32_t buf_len, snmp_header_t *header,",
        "// Line_Reference 88:                     snmp_varbind_t *varbinds, uint32_t *varbinds_length);"
    ]
}
