{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "CalendarModal.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 5: include 'ConfigInc.php';",
        "// Line_Reference 14: $connection = new mysqli($DatabaseServer, $DatabaseUsername, $DatabasePassword, $DatabaseName, $DatabasePort);",
        "// Line_Reference 15: $_REQUEST['event_id'] = mysqli_real_escape_string($connection, optional_param('event_id', '', PARAM_DATA));",
        "// Line_Reference 40: echo '<label class=\"control-label\">Date : ' . $_REQUEST['school_date'] . '&nbsp;</label>';",
        "// Line_Reference 45:     echo '<label class=\"control-label\">' . _title . ' : &nbsp;</label>';",
        "// Line_Reference 46:     echo (User('PROFILE') == 'admin' ? TextInputModal($RET[1]['TITLE'], 'values[TITLE]', '', 'id=title placeholder=\"' . _enterTitle . '\"') : $RET[1]['TITLE']);",
        "// Line_Reference 50:     echo '<label class=\"control-label\">' . _title . ' : &nbsp;</label>';",
        "// Line_Reference 52:     echo (User('PROFILE') == 'admin' ? '<input class=\"form-control\" id=\"values[TITLE]\" name=\"values[TITLE]\" value=\"' . $RET[1]['TITLE'] . '\" placeholder=\"' . _enterTitle . '\" size=\"10\" type=\"text\">' : $RET[1]['TITLE']);",
        "// Line_Reference 57:     echo '<div class=\"form-group\"><label class=\"control-label\">' . _teacher . ' : &nbsp;</label>' . (User('PROFILE') == 'admin' ? TextAreaInput($RET[1]['STAFF_ID'], 'values[STAFF_ID]', '', 'placeholder=\"' . _enterTeacher . '\"') : $RET[1]['STAFF_ID']) . '</div>';",
        "// Line_Reference 61:     echo '<div class=\"form-group\"><label class=\"control-label\">' . _assignedDate . ' : &nbsp;</label>' . (User('PROFILE') == 'admin' ? TextAreaInput($RET[1]['ASSIGNED_DATE'], 'values[ASSIGNED_DATE]', '', 'placeholder=\"' . _enterAssignedDate . '\"') : $RET[1]['ASSIGNED_DATE']) . '</div>';",
        "// Line_Reference 65:     echo '<div class=\"form-group\"><label class=\"control-label\">' . _dueDate . ' : &nbsp;</label>' . (User('PROFILE') == 'admin' ? TextAreaInput($RET[1]['DUE_DATE'], 'values[DUE_DATE]', '', 'placeholder=\"' . _enterDueDate . '\"') : $RET[1]['DUE_DATE']) . '</div>';",
        "// Line_Reference 68: echo '<label class=\"control-label\">' . _notes . ' : &nbsp;</label>';",
        "// Line_Reference 74: echo (User('PROFILE') == 'admin' ? '<input class=\"form-control\" id=\"values[DESCRIPTION]\" name=\"values[DESCRIPTION]\" value=\"' . $RET[1]['DESCRIPTION'] . '\" placeholder=\"' . _enterNotes . '\" size=\"10\" type=\"textArea\">' : $RET[1]['DESCRIPTION']);",
        "// Line_Reference 78: if (User('PROFILE') == 'admin') {",
        "// Line_Reference 79:     if ($_REQUEST['event_id'] != 'new') {",
        "// Line_Reference 80:         if ($RET[1]['CALENDAR_ID'] == 0)",
        "// Line_Reference 81:             $RET[1]['CALENDAR_ID'] = 1;",
        "// Line_Reference 82:         else",
        "// Line_Reference 83:             $RET[1]['CALENDAR_ID'] = 0;",
        "// Line_Reference 94:     echo '<INPUT type=submit class=\"btn btn-primary\" name=button value=' . _save . ' >';",
        "// Line_Reference 97:         echo '<INPUT type=submit name=button class=\"btn btn-white\" value=' . _delete . ' >';"
    ]
}
