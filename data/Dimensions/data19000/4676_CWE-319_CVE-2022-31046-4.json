{
    "cve_id": "CVE-2022-31046",
    "cve_description": "TYPO3 is an open source web content management system. Prior to versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, and 11.5.11, the export functionality fails to limit the result set to allowed columns of a particular database table. This way, authenticated users can export internal details of database tables they already have access to. TYPO3 versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, 11.5.11 fix the problem described above. In order to address this issue, access to mentioned export functionality is completely denied for regular backend users.",
    "cve_publish_date": "2022-06-14",
    "cwe_id": "CWE-319",
    "cwe_name": "Cleartext Transmission of Sensitive Information",
    "cwe_description": "The product transmits sensitive or security-critical data in cleartext in a communication channel that can be sniffed by unauthorized actors.",
    "commit_message": "[SECURITY] Restrict export functionality to allowed users\n\nThe import functionality of the import/export module is already\nrestricted to admin users or users, who explicitly have access through\nthe user TSConfig setting \"options.impexp.enableImportForNonAdminUser\".\n\nThe export functionality has the following security drawbacks:\n\n* Export for editors is not limited on field level\n* The \"Save to filename\" functionality saves to a shared folder, which\n  other editors with different access rights may have access to.\n\nBoth issues are not easy to resolve and also the target audience for\nthe Import/Export functionality are mainly TYPO3 admins.\n\nTherefore, now also the export functionality is restricted to TYPO3\nadmin users and to users, who explicitly have access through the new\nuser TSConfig setting \"options.impexp.enableExportForNonAdminUser\".\n\nAdditionally, the contents of the temporary \"importexport\" folder in\nfile storages is now only visible to users who have access to the\nexport functionality.\n\nIn general, it is recommended to only install the Import/Export\nextension when the functionality is required.\n\nResolves: #94951\nReleases: main, 11.5, 10.4\nChange-Id: Iae020baf051aeec0613366687aa8ebcbf9b3d8b2\nSecurity-Bulletin: TYPO3-CORE-SA-2022-001\nSecurity-References: CVE-2022-31046\nReviewed-on: https://review.typo3.org/c/Packages/TYPO3.CMS/+/74902\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "UsersCest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 55:     public function doNotShowImportInContextMenuForNonAdminUser(ApplicationTester $I, PageTree $pageTree): void",
        "// Line_Reference 68:         $I->seeElement($this->contextMenuExport);",
        "// Line_Reference 77:     public function showImportInContextMenuForNonAdminUserIfFlagSet(ApplicationTester $I): void",
        "// Line_Reference 82:         $this->setUserTsConfig($I, 2, 'options.impexp.enableImportForNonAdminUser = 1');",
        "// Line_Reference 88:         $I->seeElement($this->contextMenuExport);"
    ]
}
