{
    "cve_id": "CVE-2024-25636",
    "cve_description": "Misskey is an open source, decentralized social media platform with ActivityPub support. Prior to version 2024.2.0, when fetching remote Activity Streams objects, Misskey doesn't check that the response from the remote server has a `Content-Type` header value of the Activity Streams media type, which allows a threat actor to upload a crafted Activity Streams document to a remote server and make a Misskey instance fetch it, if the remote server accepts arbitrary user uploads. The vulnerability allows a threat actor to impersonate and take over an account on a remote server that satisfies all of the following properties: allows the threat actor to register an account; accepts arbitrary user-uploaded documents and places them on the same domain as legitimate Activity Streams actors; and serves user-uploaded document in response to requests with an `Accept` header value of the Activity Streams media type. Version 2024.2.0 contains a patch for the issue.",
    "cve_publish_date": "2024-02-19",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "Merge pull request from GHSA-qqrm-9grj-6v32\n\n* maybe ok\n\n* fix\n\n* test wip\n\n* :v:\n\n* fix\n\n* if (res.ok)\n\n* validateContentTypeSetAsJsonLD\n\n* 条件を考慮し直す\n\n* その他の+json接尾辞が付いているメディアタイプも受け容れる\n\n* https://github.com/misskey-dev/misskey-ghsa-qqrm-9grj-6v32/pull/1#discussion_r1490999009\n\n* add `; profile=\"https://www.w3.org/ns/activitystreams\"`\n\n* application/ld+json;",
    "type_of_change": "Modification",
    "filename_of_changes": "activitypub.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 206: \t\t\trendererService.renderAnnounce(null, {"
    ]
}
