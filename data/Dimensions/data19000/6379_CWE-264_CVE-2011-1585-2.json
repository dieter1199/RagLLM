{
    "cve_id": "CVE-2011-1585",
    "cve_description": "The cifs_find_smb_ses function in fs/cifs/connect.c in the Linux kernel before 2.6.36 does not properly determine the associations between users and sessions, which allows local users to bypass CIFS share authentication by leveraging a mount of a share by a different user.",
    "cve_publish_date": "2013-06-08",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "cifs: clean up cifs_find_smb_ses (try #2)\n\nThis patch replaces the earlier patch by the same name. The only\ndifference is that MAX_PASSWORD_SIZE has been increased to attempt to\nmatch the limits that windows enforces.\n\nDo a better job of matching sessions by authtype. Matching by username\nfor a Kerberos session is incorrect, and anonymous sessions need special\nhandling.\n\nAlso, in the case where we do match by username, we also need to match\nby password. That ensures that someone else doesn't \"borrow\" an existing\nsession without needing to know the password.\n\nFinally, passwords can be longer than 16 bytes. Bump MAX_PASSWORD_SIZE\nto 512 to match the size that the userspace mount helper allows.\n\nSigned-off-by: Jeff Layton <jlayton@redhat.com>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "connect.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1647: cifs_find_smb_ses(struct TCP_Server_Info *server, char *username)",
        "// Line_Reference 1649: \tstruct list_head *tmp;",
        "// Line_Reference 1653: \tlist_for_each(tmp, &server->smb_ses_list) {",
        "// Line_Reference 1654: \t\tses = list_entry(tmp, struct cifsSesInfo, smb_ses_list);",
        "// Line_Reference 1655: \t\tif (strncmp(ses->userName, username, MAX_USERNAME_SIZE))",
        "// Line_Reference 1656: \t\t\tcontinue;",
        "// Line_Reference 1657: ",
        "// Line_Reference 1699: \tses = cifs_find_smb_ses(server, volume_info->username);"
    ]
}
