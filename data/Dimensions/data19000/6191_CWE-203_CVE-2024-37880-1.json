{
    "cve_id": "CVE-2024-37880",
    "cve_description": "The Kyber reference implementation before 9b8d306, when compiled by LLVM Clang through 18.x with some common optimization options, has a timing side channel that allows attackers to recover an ML-KEM 512 secret key in minutes. This occurs because poly_frommsg in poly.c does not prevent Clang from emitting a vulnerable secret-dependent branch.",
    "cve_publish_date": "2024-06-10",
    "cwe_id": "CWE-203",
    "cwe_name": "Observable Discrepancy",
    "cwe_description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.",
    "commit_message": "Fixed secret-dependent branch in poly_frommsg introduced by recent versions of clang with some flags (Thanks to Antoon Purnal for pointing this out!)",
    "type_of_change": "Modification",
    "filename_of_changes": "poly.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 169:   int16_t mask;",
        "// Line_Reference 177:       mask = -(int16_t)((msg[i] >> j)&1);",
        "// Line_Reference 178:       r->coeffs[8*i+j] = mask & ((KYBER_Q+1)/2);"
    ]
}
