{
    "cve_id": "CVE-2017-14141",
    "cve_description": "The wiki_decode Developer System Helper function in the admin panel in Kaltura before 13.2.0 allows remote attackers to conduct PHP object injection attacks and execute arbitrary PHP code via a crafted serialized object.",
    "cve_publish_date": "2017-09-19",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "remove unsafe unserialize",
    "type_of_change": "Modification",
    "filename_of_changes": "kalturaAction.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 456:   \t$cookie = $this->getContext()->getRequest()->getCookie('userzone');",
        "// Line_Reference 457:   \t$length = strlen($cookie);",
        "// Line_Reference 458:   \tif ($length <= 0)",
        "// Line_Reference 459:   \t\treturn null;",
        "// Line_Reference 460: ",
        "// Line_Reference 461:   \t$serialized_data = substr($cookie, 0, $length - 32);",
        "// Line_Reference 462:   \t$hash_signiture = substr($cookie, $length - 32);",
        "// Line_Reference 463: ",
        "// Line_Reference 464:   \t// check the signiture",
        "// Line_Reference 465:   \tif (md5($serialized_data . $this->cookieSecret) != $hash_signiture)",
        "// Line_Reference 466:   \t\treturn null;",
        "// Line_Reference 467: ",
        "// Line_Reference 468:   \t$userzone_data = unserialize(base64_decode($serialized_data));",
        "// Line_Reference 469: ",
        "// Line_Reference 470:   \treturn array($userzone_data['id'], $userzone_data['email'], $userzone_data['screenname']);"
    ]
}
