{
    "cve_id": "CVE-2022-4766",
    "cve_description": "A vulnerability was found in dolibarr_project_timesheet up to 4.5.5. It has been declared as problematic. This vulnerability affects unknown code of the component Form Handler. The manipulation leads to cross-site request forgery. The attack can be initiated remotely. Upgrading to version 4.5.6.a is able to address this issue. The name of the patch is 082282e9dab43963e6c8f03cfaddd7921de377f4. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216880.",
    "cve_publish_date": "2022-12-27",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "csrf token in all form",
    "type_of_change": "Modification",
    "filename_of_changes": "TimesheetUserTasks.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 1064:     //$tail = '&wlm='.$this->whitelistmode;",
        "// Line_Reference 1071: //     $Nav .= '<a id = \"navPrev\" onClick = \"loadXMLTimesheet(\\''.getStartDate($this->date_start, -1).'\\', 0);';",
        "// Line_Reference 1077: //  if ($ajax)",
        "// Line_Reference 1078: //  {",
        "// Line_Reference 1079:     //    $Nav .= '<form name = \"goToDate\" onsubmit = \"return toDateHandler();\" action=\"?action=goToDate&wlm='.$this->whitelistmode.'\" method = \"POST\">'.\"\\n\\t\\t\\t\";",
        "// Line_Reference 1080:     //} else{",
        "// Line_Reference 1081:         $Nav .= '<form name = \"goToDate\" action=\"?action=goToDate'.$tail.'\" method = \"POST\" >'.\"\\n\\t\\t\\t\";",
        "// Line_Reference 1082:     //}",
        "// Line_Reference 1085:     //if ($ajax)",
        "// Line_Reference 1086: //    {",
        "// Line_Reference 1087:     //    $Nav .= '<a id = \"navNext\" onClick = \"loadXMLTimesheet(\\''.getStartDate($this->date_start, 1).'\\', 0);';",
        "// Line_Reference 1088:     //} else{",
        "// Line_Reference 1089:         $Nav .= '<a href=\"?dateStart='.getStartDate($this->date_start, 1).$tail;",
        "// Line_Reference 1090:     //}"
    ]
}
