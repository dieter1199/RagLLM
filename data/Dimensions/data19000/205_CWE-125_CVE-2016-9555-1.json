{
    "cve_id": "CVE-2016-9555",
    "cve_description": "The sctp_sf_ootb function in net/sctp/sm_statefuns.c in the Linux kernel before 4.8.8 lacks chunk-length checking for the first chunk, which allows remote attackers to cause a denial of service (out-of-bounds slab access) or possibly have unspecified other impact via crafted SCTP data.",
    "cve_publish_date": "2016-11-28",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "sctp: validate chunk len before actually using it\n\nAndrey Konovalov reported that KASAN detected that SCTP was using a slab\nbeyond the boundaries. It was caused because when handling out of the\nblue packets in function sctp_sf_ootb() it was checking the chunk len\nonly after already processing the first chunk, validating only for the\n2nd and subsequent ones.\n\nThe fix is to just move the check upwards so it's also validated for the\n1st chunk.\n\nReported-by: Andrey Konovalov <andreyknvl@google.com>\nTested-by: Andrey Konovalov <andreyknvl@google.com>\nSigned-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>\nReviewed-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Neil Horman <nhorman@tuxdriver.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "sm_statefuns.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 3456: \t\t/* Report violation if chunk len overflows */",
        "// Line_Reference 3457: \t\tch_end = ((__u8 *)ch) + SCTP_PAD4(ntohs(ch->length));",
        "// Line_Reference 3458: \t\tif (ch_end > skb_tail_pointer(skb))",
        "// Line_Reference 3459: \t\t\treturn sctp_sf_violation_chunklen(net, ep, asoc, type, arg,",
        "// Line_Reference 3460: \t\t\t\t\t\t  commands);",
        "// Line_Reference 3461: "
    ]
}
