{
    "cve_id": "CVE-2017-16525",
    "cve_description": "The usb_serial_console_disconnect function in drivers/usb/serial/console.c in the Linux kernel before 4.13.8 allows local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via a crafted USB device, related to disconnection and failed setup.",
    "cve_publish_date": "2017-11-04",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "USB: serial: console: fix use-after-free on disconnect\n\nA clean-up patch removing two redundant NULL-checks from the console\ndisconnect handler inadvertently also removed a third check. This could\nlead to the struct usb_serial being prematurely freed by the console\ncode when a driver accepts but does not register any ports for an\ninterface which also lacks endpoint descriptors.\n\nFixes: 0e517c93dc02 (\"USB: serial: console: clean up sanity checks\")\nCc: stable <stable@vger.kernel.org>     # 4.11\nReported-by: Andrey Konovalov <andreyknvl@google.com>\nAcked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Johan Hovold <johan@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "console.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 268: \tif (serial->port[0] == usbcons_info.port) {"
    ]
}
