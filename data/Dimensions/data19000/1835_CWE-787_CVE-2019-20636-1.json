{
    "cve_id": "CVE-2019-20636",
    "cve_description": "In the Linux kernel before 5.4.12, drivers/input/input.c has out-of-bounds writes via a crafted keycode table, as demonstrated by input_set_keycode, aka CID-cb222aed03d7.",
    "cve_publish_date": "2020-04-08",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Input: add safety guards to input_set_keycode()\n\nIf we happen to have a garbage in input device's keycode table with values\ntoo big we'll end up doing clear_bit() with offset way outside of our\nbitmaps, damaging other objects within an input device or even outside of\nit. Let's add sanity checks to the returned old keycodes.\n\nReported-by: syzbot+c769968809f9359b07aa@syzkaller.appspotmail.com\nReported-by: syzbot+76f3a30e88d256644c78@syzkaller.appspotmail.com\nLink: https://lore.kernel.org/r/20191207212757.GA245964@dtor-ws\nSigned-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "input.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 881: \t__clear_bit(*old_keycode, dev->keybit);",
        "// Line_Reference 882: \t__set_bit(ke->keycode, dev->keybit);",
        "// Line_Reference 883: ",
        "// Line_Reference 884: \tfor (i = 0; i < dev->keycodemax; i++) {",
        "// Line_Reference 885: \t\tif (input_fetch_keycode(dev, i) == *old_keycode) {",
        "// Line_Reference 886: \t\t\t__set_bit(*old_keycode, dev->keybit);",
        "// Line_Reference 887: \t\t\tbreak; /* Setting the bit twice is useless, so break */",
        "// Line_Reference 946: \tif (test_bit(EV_KEY, dev->evbit) &&",
        "// Line_Reference 947: \t    !is_event_supported(old_keycode, dev->keybit, KEY_MAX) &&",
        "// Line_Reference 948: \t    __test_and_clear_bit(old_keycode, dev->key)) {"
    ]
}
