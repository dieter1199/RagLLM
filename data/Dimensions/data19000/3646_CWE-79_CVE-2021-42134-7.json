{
    "cve_id": "CVE-2021-42134",
    "cve_description": "The Unicorn framework before 0.36.1 for Django allows XSS via a component. NOTE: this issue exists because of an incomplete fix for CVE-2021-42053.",
    "cve_publish_date": "2021-10-11",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "More complete handling for preventing XSS attacks.",
    "type_of_change": "Modification",
    "filename_of_changes": "unicorn_view.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 13: from django.utils.html import conditional_escape",
        "// Line_Reference 344:         safe_fields = []",
        "// Line_Reference 345:         # Keep a list of fields that are safe to not sanitize from `frontend_context_variables`",
        "// Line_Reference 346:         if hasattr(self, \"Meta\") and hasattr(self.Meta, \"safe\"):",
        "// Line_Reference 347:             if isinstance(self.Meta.safe, Sequence):",
        "// Line_Reference 348:                 for field_name in self.Meta.safe:",
        "// Line_Reference 349:                     if field_name in frontend_context_variables:",
        "// Line_Reference 350:                         safe_fields.append(field_name)",
        "// Line_Reference 351: ",
        "// Line_Reference 375:         for (",
        "// Line_Reference 376:             frontend_context_variable_key,",
        "// Line_Reference 377:             frontend_context_variable_value,",
        "// Line_Reference 378:         ) in frontend_context_variables.items():",
        "// Line_Reference 379:             if (",
        "// Line_Reference 380:                 isinstance(frontend_context_variable_value, str)",
        "// Line_Reference 381:                 and frontend_context_variable_key not in safe_fields",
        "// Line_Reference 382:             ):",
        "// Line_Reference 383:                 frontend_context_variables[frontend_context_variable_key] = escape(",
        "// Line_Reference 384:                     frontend_context_variable_value",
        "// Line_Reference 385:                 )",
        "// Line_Reference 386: "
    ]
}
