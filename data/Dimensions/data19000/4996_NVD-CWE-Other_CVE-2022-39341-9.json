{
    "cve_id": "CVE-2022-39341",
    "cve_description": "OpenFGA is an authorization/permission engine. Versions prior to version 0.2.4 are vulnerable to authorization bypass under certain conditions. Users who have wildcard (`*`) defined on tupleset relations in their authorization model are vulnerable. Version 0.2.4 contains a patch for this issue.",
    "cve_publish_date": "2022-10-25",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Merge pull request from GHSA-vj4m-83m8-xpw5\n\n* fix: return error if wildcard is encountered in ttu evaluation\n\n* chore: address one of maria's comments\n\n* chore: fix public facing error message and test name\n\n* fix: return error if '*' encountered in tupleset relation in Expand",
    "type_of_change": "Modification",
    "filename_of_changes": "expand.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "47",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 61: func (query *ExpandQuery) resolveUserset(ctx context.Context, store, modelID string, userset *openfgapb.Userset, tk *openfgapb.TupleKey, metadata *utils.ResolutionMetadata) (*openfgapb.UsersetTree_Node, error) {",
        "// Line_Reference 71: \t\treturn query.resolveTupleToUserset(ctx, store, us.TupleToUserset, tk, metadata)",
        "// Line_Reference 155: func (query *ExpandQuery) resolveTupleToUserset(ctx context.Context, store string, userset *openfgapb.TupleToUserset, tk *openfgapb.TupleKey, metadata *utils.ResolutionMetadata) (*openfgapb.UsersetTree_Node, error) {",
        "// Line_Reference 160: \t\tObject:   tk.GetObject(),",
        "// Line_Reference 161: \t\tRelation: userset.GetTupleset().GetRelation(),"
    ]
}
