{
    "cve_id": "CVE-2021-41083",
    "cve_description": "Dada Mail is a web-based e-mail list management system. In affected versions a bad actor could give someone a carefully crafted web page via email, SMS, etc, that - when visited, allows them control of the list control panel as if the bad actor was logged in themselves. This includes changing any mailing list password, as well as the Dada Mail Root Password - which could effectively shut out actual list owners of the mailing list and allow the bad actor complete and unfettered control of your mailing list. This vulnerability also affects profile logins. For this vulnerability to work, the target of the bad actor would need to be logged into the list control panel themselves. This CSRF vulnerability in Dada Mail affects all versions of Dada Mail v11.15.1 and below. Although we know of no known CSRF exploits that have happened in the wild, this vulnerability has been confirmed by our testing, and by a third party. Users are advised to update to version 11.16.0.",
    "cve_publish_date": "2021-09-20",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "This adds CSRF protection to the profiles.",
    "type_of_change": "Modification",
    "filename_of_changes": "App.pm",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "47",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 15089:     if (   $DADA::Config::PROFILE_OPTIONS->{enabled} != 1) {",
        "// Line_Reference 15093: ",
        "// Line_Reference 15094:     if ( $DADA::Config::PROFILE_OPTIONS->{enabled} != 1 ) {",
        "// Line_Reference 15095:         return $self->default();",
        "// Line_Reference 15096:     }",
        "// Line_Reference 15112: ",
        "// Line_Reference 15121:             my $scrn              = '';",
        "// Line_Reference 15183:                 -email    => xss_filter( scalar $q->param('login_email') ),",
        "// Line_Reference 15184:                 -password => xss_filter( scalar $q->param('login_password') ),",
        "// Line_Reference 15192:                     -email => xss_filter( scalar $q->param('login_email') ),",
        "// Line_Reference 15193:                     -password =>",
        "// Line_Reference 15194:                       xss_filter( scalar $q->param('login_password') ),",
        "// Line_Reference 15195:                 },",
        "// Line_Reference 15404:     if ( $prof_sess->is_logged_in( { -cgi_obj => $q } ) ) {",
        "// Line_Reference 15405:         my $email = $prof_sess->get( { -cgi_obj => $q } );",
        "// Line_Reference 15410:         my $prof = DADA::Profile->new( { -email => $email } );",
        "// Line_Reference 15411:         my $dpf = DADA::Profile::Fields->new( { -email => $email } );",
        "// Line_Reference 15617:                     -email   => $email,",
        "// Line_Reference 15685:                     { -email => $email, -mid => '00000000000000' } );",
        "// Line_Reference 15698:                         -email => $email,",
        "// Line_Reference 15725:                         'profile.email'   => $email,",
        "// Line_Reference 15752:                           gravatar_img_url( { -email => $email, } ),",
        "// Line_Reference 16017:                     -email   => $profile_info->{'profile.update_email'},",
        "// Line_Reference 16018:                     -no_pass => 1,"
    ]
}
