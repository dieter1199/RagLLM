{
    "cve_id": "CVE-2021-36082",
    "cve_description": "ntop nDPI 3.4 has a stack-based buffer overflow in processClientServerHello.",
    "cve_publish_date": "2021-07-01",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Added further checks",
    "type_of_change": "Modification",
    "filename_of_changes": "tls.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 1372:       ja3_str_len = snprintf(ja3_str, sizeof(ja3_str), \"%u,\", ja3.server.tls_handshake_version);",
        "// Line_Reference 1374:       for(i=0; i<ja3.server.num_cipher; i++) {",
        "// Line_Reference 1375: \trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\", (i > 0) ? \"-\" : \"\", ja3.server.cipher[i]);",
        "// Line_Reference 1380:       rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \",\");",
        "// Line_Reference 1381:       if(rc > 0 && ja3_str_len + rc < JA3_STR_LEN) ja3_str_len += rc;",
        "// Line_Reference 1382: ",
        "// Line_Reference 1385:       for(i=0; i<ja3.server.num_tls_extension; i++) {",
        "// Line_Reference 1386: \tint rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\", (i > 0) ? \"-\" : \"\", ja3.server.tls_extension[i]);",
        "// Line_Reference 1392: \tfor(i=0; i<ja3.server.num_elliptic_curve_point_format; i++) {",
        "// Line_Reference 1393: \t  rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\",",
        "// Line_Reference 1398: \tif(ja3.server.alpn[0] != '\\0') {",
        "// Line_Reference 1399: \t  rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \",%s\", ja3.server.alpn);",
        "// Line_Reference 1985: \t      ja3_str_len = snprintf(ja3_str, sizeof(ja3_str), \"%u,\", ja3.client.tls_handshake_version);",
        "// Line_Reference 1988: \t\trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\",",
        "// Line_Reference 1993: \t      rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \",\");",
        "// Line_Reference 1999: \t\trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\",",
        "// Line_Reference 2004: \t      rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \",\");",
        "// Line_Reference 2010: \t\trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\",",
        "// Line_Reference 2015: \t      rc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \",\");",
        "// Line_Reference 2019: \t\trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len, \"%s%u\",",
        "// Line_Reference 2025: \t\trc = snprintf(&ja3_str[ja3_str_len], sizeof(ja3_str)-ja3_str_len,"
    ]
}
