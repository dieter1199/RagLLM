{
    "cve_id": "CVE-2021-36080",
    "cve_description": "GNU LibreDWG 0.12.3.4163 through 0.12.3.4191 has a double-free in bit_chain_free (called from dwg_encode_MTEXT and dwg_encode_add_object).",
    "cve_publish_date": "2021-07-01",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "encode: avoid hdl_dat double-free\n\nIn case of an handle overflow, such as num_reactors.\nFixes oss-fuzz issue 31724.",
    "type_of_change": "Modification",
    "filename_of_changes": "encode.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 833:     Bit_Chain *str_dat = dat; /* a ref */                                     \\",
        "// Line_Reference 839:         if (hdl_dat != dat)                                                   \\",
        "// Line_Reference 844:     if (error & DWG_ERR_VALUEOUTOFBOUNDS && hdl_dat != dat)                   \\",
        "// Line_Reference 845:       bit_chain_free (hdl_dat);                                               \\",
        "// Line_Reference 849:         Bit_Chain *dat, Bit_Chain *hdl_dat, Bit_Chain *str_dat,               \\",
        "// Line_Reference 850:         Dwg_Object *restrict obj)                                             \\",
        "// Line_Reference 856:     Dwg_Entity_##token *_obj = _ent->tio.token;                               \\",
        "// Line_Reference 864:     if (hdl_dat != dat)                                                       \\",
        "// Line_Reference 894:     if (error & DWG_ERR_VALUEOUTOFBOUNDS && hdl_dat != dat)                   \\",
        "// Line_Reference 918:     if (hdl_dat != dat)                                                       \\"
    ]
}
