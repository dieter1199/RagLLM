{
    "cve_id": "CVE-2022-3976",
    "cve_description": "A vulnerability has been found in MZ Automation libiec61850 up to 1.4 and classified as critical. This vulnerability affects unknown code of the file src/mms/iso_mms/client/mms_client_files.c of the component MMS File Services. The manipulation of the argument filename leads to path traversal. Upgrading to version 1.5 is able to address this issue. The name of the patch is 10622ba36bb3910c151348f1569f039ecdd8786f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-213556.",
    "cve_publish_date": "2022-11-13",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "- fixed path traversal vulnerability in MMS file services (LIB61850-357)",
    "type_of_change": "Modification",
    "filename_of_changes": "mms_client_files.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 74: ",
        "// Line_Reference 128:         MmsFileReadStateMachine* frsm = getFreeFrsm(connection);",
        "// Line_Reference 130:         if (frsm != NULL) {",
        "// Line_Reference 132:             MmsOutstandingCall obtainFileCall = mmsClient_getMatchingObtainFileRequest(connection, filename);",
        "// Line_Reference 134:             if (obtainFileCall) {",
        "// Line_Reference 136:                 if (DEBUG_MMS_CLIENT)",
        "// Line_Reference 137:                     printf(\"MMS_CLIENT: file open is matching obtain file request for file %s\\n\", filename);",
        "// Line_Reference 139:                 obtainFileCall->timeout = Hal_getTimeInMs() + connection->requestTimeout;",
        "// Line_Reference 140:             }",
        "// Line_Reference 142:             FileHandle fileHandle = mmsMsg_openFile(MmsConnection_getFilestoreBasepath(connection), filename, false);",
        "// Line_Reference 144:             if (fileHandle != NULL) {",
        "// Line_Reference 146:                 frsm->fileHandle = fileHandle;",
        "// Line_Reference 147:                 frsm->readPosition = filePosition;",
        "// Line_Reference 148:                 frsm->frsmId = getNextFrsmId(connection);",
        "// Line_Reference 149:                 frsm->obtainRequest = obtainFileCall;",
        "// Line_Reference 151:                 mmsMsg_createFileOpenResponse(MmsConnection_getFilestoreBasepath(connection),",
        "// Line_Reference 152:                         invokeId, response, filename, frsm);",
        "// Line_Reference 155:                 mmsMsg_createServiceErrorPdu(invokeId, response, MMS_ERROR_FILE_FILE_NON_EXISTENT);",
        "// Line_Reference 156: ",
        "// Line_Reference 158:         else",
        "// Line_Reference 159:             mmsMsg_createServiceErrorPdu(invokeId, response, MMS_ERROR_RESOURCE_OTHER);"
    ]
}
