{
    "cve_id": "CVE-2011-2521",
    "cve_description": "The x86_assign_hw_event function in arch/x86/kernel/cpu/perf_event.c in the Performance Events subsystem in the Linux kernel before 2.6.39 does not properly calculate counter values, which allows local users to cause a denial of service (panic) via the perf program.",
    "cve_publish_date": "2012-05-24",
    "cwe_id": "CWE-189",
    "cwe_name": "Numeric Errors",
    "cwe_description": "Weaknesses in this category are related to improper calculation or conversion of numbers.",
    "commit_message": "perf, x86: Fix Intel fixed counters base initialization\n\nThe following patch solves the problems introduced by Robert's\ncommit 41bf498 and reported by Arun Sharma. This commit gets rid\nof the base + index notation for reading and writing PMU msrs.\n\nThe problem is that for fixed counters, the new calculation for\nthe base did not take into account the fixed counter indexes,\nthus all fixed counters were read/written from fixed counter 0.\nAlthough all fixed counters share the same config MSR, they each\nhave their own counter register.\n\nWithout:\n\n $ task -e unhalted_core_cycles -e instructions_retired -e baclears noploop 1 noploop for 1 seconds\n\n  242202299 unhalted_core_cycles (0.00% scaling, ena=1000790892, run=1000790892)\n 2389685946 instructions_retired (0.00% scaling, ena=1000790892, run=1000790892)\n      49473 baclears             (0.00% scaling, ena=1000790892, run=1000790892)\n\nWith:\n\n $ task -e unhalted_core_cycles -e instructions_retired -e baclears noploop 1 noploop for 1 seconds\n\n 2392703238 unhalted_core_cycles (0.00% scaling, ena=1000840809, run=1000840809)\n 2389793744 instructions_retired (0.00% scaling, ena=1000840809, run=1000840809)\n      47863 baclears             (0.00% scaling, ena=1000840809, run=1000840809)\n\nSigned-off-by: Stephane Eranian <eranian@google.com>\nCc: peterz@infradead.org\nCc: ming.m.lin@intel.com\nCc: robert.richter@amd.com\nCc: asharma@fb.com\nCc: perfmon2-devel@lists.sf.net\nLKML-Reference: <20110319172005.GB4978@quad>\nSigned-off-by: Ingo Molnar <mingo@elte.hu>",
    "type_of_change": "Modification",
    "filename_of_changes": "perf_event.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 915: \t\thwc->event_base = MSR_ARCH_PERFMON_FIXED_CTR0;"
    ]
}
