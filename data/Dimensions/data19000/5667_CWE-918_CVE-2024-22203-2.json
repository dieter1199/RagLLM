{
    "cve_id": "CVE-2024-22203",
    "cve_description": "Whoogle Search is a self-hosted metasearch engine. In versions prior to 0.8.4, the `element` method in `app/routes.py` does not validate the user-controlled `src_type` and `element_url` variables and passes them to the `send` method which sends a GET request on lines 339-343 in `request.py`, which leads to a server-side request forgery. This issue allows for crafting GET requests to internal and external resources on behalf of the server. For example, this issue would allow for accessing resources on the internal network that the server has access to, even though these resources may not be accessible on the internet. This issue is fixed in version 0.8.4.",
    "cve_publish_date": "2024-01-23",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "Validate urls in `element` and `window` endpoints\n\nDomains were previously not validated before being handled, leading to a\npotential scenario where someone could pass something like\n\"element_url=127.0.0.1:<port>/<resource>\" to access other resources on a\nmachine running Whoogle. This change ensures that the resource used in\nboth endpoints is a valid domain.\n\nThis also includes validation of config names to prevent names from\nincluding path values such as \"../../(etc)\".",
    "type_of_change": "Modification",
    "filename_of_changes": "routes.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 426:         if 'name' in request.args:",
        "// Line_Reference 427:             config_pkl = os.path.join(",
        "// Line_Reference 428:                 app.config['CONFIG_PATH'],",
        "// Line_Reference 429:                 request.args.get('name'))",
        "// Line_Reference 447:                     request.args.get('name')), 'wb'))",
        "// Line_Reference 488:     empty_gif = base64.b64decode(",
        "// Line_Reference 489:         'R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==')"
    ]
}
