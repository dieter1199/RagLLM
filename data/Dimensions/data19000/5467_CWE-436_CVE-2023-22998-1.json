{
    "cve_id": "CVE-2023-22998",
    "cve_description": "In the Linux kernel before 6.0.3, drivers/gpu/drm/virtio/virtgpu_object.c misinterprets the drm_gem_shmem_get_sg_table return value (expects it to be NULL in the error case, whereas it is actually an error pointer).",
    "cve_publish_date": "2023-02-28",
    "cwe_id": "CWE-436",
    "cwe_name": "Interpretation Conflict",
    "cwe_description": "Product A handles inputs or steps differently than Product B, which causes A to perform incorrect actions based on its perception of B's state.",
    "commit_message": "drm/virtio: Fix NULL vs IS_ERR checking in virtio_gpu_object_shmem_init\n\nSince drm_prime_pages_to_sg() function return error pointers.\nThe drm_gem_shmem_get_sg_table() function returns error pointers too.\nUsing IS_ERR() to check the return value to fix this.\n\nFixes: 2f2aa13724d5 (\"drm/virtio: move virtio_gpu_mem_entry initialization to new function\")\nSigned-off-by: Miaoqian Lin <linmq006@gmail.com>\nLink: http://patchwork.freedesktop.org/patch/msgid/20220602104223.54527-1-linmq006@gmail.com\nSigned-off-by: Gerd Hoffmann <kraxel@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "virtgpu_object.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 171: \tif (!shmem->pages) {",
        "// Line_Reference 173: \t\treturn -EINVAL;"
    ]
}
