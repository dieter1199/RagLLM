{
    "cve_id": "CVE-2023-1065",
    "cve_description": "This vulnerability in the Snyk Kubernetes Monitor can result in irrelevant data being posted to a Snyk Organization, which could in turn obfuscate other, relevant, security issues. It does not expose the user of the integration to any direct security risk and no user data can be leaked. To exploit the vulnerability the attacker does not need to be authenticated to Snyk but does need to know the target's Integration ID (which may or may not be the same as the Organization ID, although this is an unpredictable UUID in either case).",
    "cve_publish_date": "2023-02-28",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "feat: call authenticated snyk API endpoints with token\n\nBREAKING CHANGE: use a service account API token to perform\nauthenticated requests to snyk API.",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "46",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 58:   return await retryRequest(req.method, req.url, req.payload);",
        "// Line_Reference 72:         url: `${upstreamUrl}/api/v1/dependency-graph`,",
        "// Line_Reference 103:         url: `${upstreamUrl}/api/v1/scan-results`,",
        "// Line_Reference 139:       url: `${upstreamUrl}/api/v1/workload`,",
        "// Line_Reference 175:       `${upstreamUrl}/api/v1/policy`,",
        "// Line_Reference 210:     const query = `userLocator=${userLocator}&cluster=${cluster}&namespace=${namespace}&type=${type}&name=${name}&agentId=${agentId}`;",
        "// Line_Reference 213:       url: `${upstreamUrl}/api/v1/workload?${query}`,",
        "// Line_Reference 351:       url: `${upstreamUrl}/api/v1/cluster`,",
        "// Line_Reference 397:       url: `${upstreamUrl}/api/v1/runtime-results`,"
    ]
}
