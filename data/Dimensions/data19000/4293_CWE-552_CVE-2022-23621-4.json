{
    "cve_id": "CVE-2022-23621",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions any user with SCRIPT right can read any file located in the XWiki WAR (for example xwiki.cfg and xwiki.properties) through XWiki#invokeServletAndReturnAsString as `$xwiki.invokeServletAndReturnAsString(\"/WEB-INF/xwiki.cfg\")`. This issue has been patched in XWiki versions 12.10.9, 13.4.3 and 13.7-rc-1. Users are advised to update. The only workaround is to limit SCRIPT right.",
    "cve_publish_date": "2022-02-09",
    "cwe_id": "CWE-552",
    "cwe_name": "Files or Directories Accessible to External Parties",
    "cwe_description": "The product makes files or directories accessible to unauthorized actors, even though they should not be.",
    "commit_message": "XWIKI-18870: Unexpected behavior of XWiki#invokeServletAndReturnAsString",
    "type_of_change": "Modification",
    "filename_of_changes": "XWiki.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1013:     /**",
        "// Line_Reference 1014:      * Designed to include dynamic content, such as Servlets or JSPs, inside Velocity templates; works by creating a",
        "// Line_Reference 1015:      * RequestDispatcher, buffering the output, then returning it as a string.",
        "// Line_Reference 1016:      *",
        "// Line_Reference 1017:      * @param url URL of the servlet",
        "// Line_Reference 1018:      * @return text result of the servlet",
        "// Line_Reference 1019:      */",
        "// Line_Reference 1020:     public String invokeServletAndReturnAsString(String url)",
        "// Line_Reference 1021:     {",
        "// Line_Reference 1022:         return this.xwiki.invokeServletAndReturnAsString(url, getXWikiContext());",
        "// Line_Reference 1023:     }",
        "// Line_Reference 1024: "
    ]
}
