{
    "cve_id": "CVE-2017-1001000",
    "cve_description": "The register_routes function in wp-includes/rest-api/endpoints/class-wp-rest-posts-controller.php in the REST API in WordPress 4.7.x before 4.7.2 does not require an integer identifier, which allows remote attackers to modify arbitrary pages via a request for wp-json/wp/v2/posts followed by a numeric value and a non-numeric value, as demonstrated by the wp-json/wp/v2/posts/123?id=123helloworld URI.",
    "cve_publish_date": "2017-04-03",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "REST API: Unify object access handling for simplicity.\n\nRather than repeating ourselves, unifying the access into a single method keeps everything tidy. While we're at it, add in additional schema handling for common parameters.\n\nSee #38792.\nBuilt from https://develop.svn.wordpress.org/trunk@39954\n\n\ngit-svn-id: http://core.svn.wordpress.org/trunk@39891 1a063a9b-81f0-0310-95a4-ce76da25c4cd",
    "type_of_change": "Modification",
    "filename_of_changes": "class-wp-rest-comments-controller.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "60",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 312: \t\t$id = (int) $request['id'];",
        "// Line_Reference 313: ",
        "// Line_Reference 314: \t\t$comment = get_comment( $id );",
        "// Line_Reference 315: ",
        "// Line_Reference 316: \t\tif ( ! $comment ) {",
        "// Line_Reference 317: \t\t\treturn true;",
        "// Line_Reference 347: \t\t$id = (int) $request['id'];",
        "// Line_Reference 348: ",
        "// Line_Reference 349: \t\t$comment = get_comment( $id );",
        "// Line_Reference 350: \t\tif ( empty( $comment ) ) {",
        "// Line_Reference 351: \t\t\treturn new WP_Error( 'rest_comment_invalid_id', __( 'Invalid comment ID.' ), array( 'status' => 404 ) );",
        "// Line_Reference 352: \t\t}",
        "// Line_Reference 353: ",
        "// Line_Reference 354: \t\tif ( ! empty( $comment->comment_post_ID ) ) {",
        "// Line_Reference 355: \t\t\t$post = get_post( $comment->comment_post_ID );",
        "// Line_Reference 356: \t\t\tif ( empty( $post ) ) {",
        "// Line_Reference 357: \t\t\t\treturn new WP_Error( 'rest_post_invalid_id', __( 'Invalid post ID.' ), array( 'status' => 404 ) );",
        "// Line_Reference 358: \t\t\t}",
        "// Line_Reference 634: \t\t$id = (int) $request['id'];",
        "// Line_Reference 635: ",
        "// Line_Reference 636: \t\t$comment = get_comment( $id );",
        "// Line_Reference 637: ",
        "// Line_Reference 638: \t\tif ( $comment && ! $this->check_edit_permission( $comment ) ) {",
        "// Line_Reference 655: \t\t$id = (int) $request['id'];",
        "// Line_Reference 656: ",
        "// Line_Reference 657: \t\t$comment = get_comment( $id );",
        "// Line_Reference 658: ",
        "// Line_Reference 659: \t\tif ( empty( $comment ) ) {",
        "// Line_Reference 660: \t\t\treturn new WP_Error( 'rest_comment_invalid_id', __( 'Invalid comment ID.' ), array( 'status' => 404 ) );",
        "// Line_Reference 753: \t\t$id      = (int) $request['id'];",
        "// Line_Reference 754: \t\t$comment = get_comment( $id );",
        "// Line_Reference 755: ",
        "// Line_Reference 756: \t\tif ( ! $comment ) {",
        "// Line_Reference 757: \t\t\treturn new WP_Error( 'rest_comment_invalid_id', __( 'Invalid comment ID.' ), array( 'status' => 404 ) );",
        "// Line_Reference 776: \t\t$id    = (int) $request['id'];",
        "// Line_Reference 777: \t\t$force = isset( $request['force'] ) ? (bool) $request['force'] : false;",
        "// Line_Reference 778: ",
        "// Line_Reference 779: \t\t$comment = get_comment( $id );",
        "// Line_Reference 780: ",
        "// Line_Reference 781: \t\tif ( empty( $comment ) ) {",
        "// Line_Reference 782: \t\t\treturn new WP_Error( 'rest_comment_invalid_id', __( 'Invalid comment ID.' ), array( 'status' => 404 ) );"
    ]
}
