{
    "cve_id": "CVE-2022-24865",
    "cve_description": "HumHub is an Open Source Enterprise Social Network. In affected versions users who are forced to change their password by an administrator may retrieve other users' data. This issue has been resolved by commit `eb83de20`. It is recommended that the HumHub is upgraded to 1.11.0, 1.10.4 or 1.9.4. There are no known workarounds for this issue.",
    "cve_publish_date": "2022-04-20",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Fix must change password (#5638)\n\n* Fix must change password\r\n\r\n* Update CHANGELOG.md (#5638)\r\n\r\n* Improve access validation\r\n\r\n* Update CHANGELOG.md\r\n\r\nCo-authored-by: Lucas Bartholemy <luke-@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "AccessControl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 14: use yii\\helpers\\Url;",
        "// Line_Reference 16: use yii\\web\\Response;",
        "// Line_Reference 154:                 return call_user_func([$this, $this->controllerAccess->codeCallback]);",
        "// Line_Reference 156:                 return $this->loginRequired();",
        "// Line_Reference 220:      * @return bool forces user login",
        "// Line_Reference 226: ",
        "// Line_Reference 227:         return false;",
        "// Line_Reference 231:      * @return Response Redirect user to force to change password",
        "// Line_Reference 237:             return Yii::$app->getResponse()->redirect(Url::toRoute(Yii::$app->user->mustChangePasswordRoute));",
        "// Line_Reference 243:      *",
        "// Line_Reference 244:      * @return Response Redirect to home page",
        "// Line_Reference 254:             return Yii::$app->getResponse()->redirect(['/user/auth/login']);"
    ]
}
