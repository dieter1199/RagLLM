{
    "cve_id": "CVE-2016-9395",
    "cve_description": "The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.",
    "cve_publish_date": "2017-03-23",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "The generation of the configuration file jas_config.h has been completely\nreworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.",
    "type_of_change": "Modification",
    "filename_of_changes": "jas_config2.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 73: #define\tuchar\t\tunsigned char",
        "// Line_Reference 74: #define\tushort\t\tunsigned short",
        "// Line_Reference 75: #define\tuint\t\tunsigned int",
        "// Line_Reference 76: #define\tulong\t\tunsigned long",
        "// Line_Reference 77: #undef longlong",
        "// Line_Reference 78: #define\tlonglong\tlong long",
        "// Line_Reference 79: #undef ulonglong",
        "// Line_Reference 80: #define\tulonglong\tunsigned long long",
        "// Line_Reference 81: /*#define\tssize_t\t\tint*/",
        "// Line_Reference 82: ",
        "// Line_Reference 84: #define\tHAVE_LIMITS_H\t\t1",
        "// Line_Reference 88: #define\tHAVE_STDLIB_H\t\t1",
        "// Line_Reference 89: #define\tHAVE_STDDEF_H\t\t1"
    ]
}
