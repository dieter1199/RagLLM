{
    "cve_id": "CVE-2021-41137",
    "cve_description": "Minio is a Kubernetes native application for cloud storage. All users on release `RELEASE.2021-10-10T16-53-30Z` are affected by a vulnerability that involves bypassing policy restrictions on regular users. Normally, checkKeyValid() should return owner true for rootCreds. In the affected version, policy restriction did not work properly for users who did not have service (svc) or security token service (STS) accounts. This issue is fixed in `RELEASE.2021-10-13T00-23-17Z`. A downgrade back to release `RELEASE.2021-10-08T23-58-24Z` is available as a workaround.",
    "cve_publish_date": "2021-10-13",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "checkKeyValid() should return owner true for rootCreds (#13422)\n\nLooks like policy restriction was not working properly\r\nfor normal users when they are not svc or STS accounts.\r\n\r\n- svc accounts are now properly fixed to get\r\n  right permissions when its inherited, so\r\n  we do not have to set 'owner = true'\r\n\r\n- sts accounts have always been using right\r\n  permissions, do not need an explicit lookup\r\n\r\n- regular users always have proper policy mapping",
    "type_of_change": "Modification",
    "filename_of_changes": "signature-v4-utils.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 34: \tiampolicy \"github.com/minio/pkg/iam/policy\"",
        "// Line_Reference 153: \tvar owner = true",
        "// Line_Reference 154: \tvar cred = globalActiveCred",
        "// Line_Reference 169: \tif len(claims) > 0 {",
        "// Line_Reference 170: \t\tcred.Claims = claims",
        "// Line_Reference 171: ",
        "// Line_Reference 172: \t\t// Now check if we have a sessionPolicy.",
        "// Line_Reference 173: \t\tif _, ok := claims[iampolicy.SessionPolicyName]; ok {",
        "// Line_Reference 174: \t\t\towner = false",
        "// Line_Reference 175: \t\t} else {",
        "// Line_Reference 176: \t\t\towner = cred.AccessKey == cred.ParentUser",
        "// Line_Reference 177: \t\t}",
        "// Line_Reference 178: \t}",
        "// Line_Reference 179: "
    ]
}
