{
    "cve_id": "CVE-2020-15679",
    "cve_description": "An OAuth session fixation vulnerability existed in the VPN login flow, where an attacker could craft a custom login URL, convince a VPN user to login via that URL, and obtain authenticated access as that user. This issue is limited to cases where attacker and victim are sharing the same source IP and could allow the ability to view session states and disconnect VPN sessions. This vulnerability affects Mozilla VPN iOS 1.0.7 < (929), Mozilla VPN Windows < 1.2.2, and Mozilla VPN Android 1.1.0 < (1360).",
    "cve_publish_date": "2022-12-22",
    "cwe_id": "CWE-384",
    "cwe_name": "Session Fixation",
    "cwe_description": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
    "commit_message": "PGAND-410 Resolve oauth session fixation on iOS (#272)\n\n* update login flow with PKCE\r\n\r\n* fix MockGuardianAPI",
    "type_of_change": "Modification",
    "filename_of_changes": "GuardianURLRequest.swift",
    "code_language": "Swift",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 34:     static func urlRequest(with urlString: String,",
        "// Line_Reference 35:                            type: HttpMethod,",
        "// Line_Reference 36:                            queryParameters: [String: String]? = nil,",
        "// Line_Reference 37:                            httpHeaderParams: [String: String]? = nil,",
        "// Line_Reference 38:                            body: Data? = nil) -> URLRequest {",
        "// Line_Reference 39:         var urlComponent = URLComponents(string: urlString)!",
        "// Line_Reference 40:         if let queryParameters = queryParameters {",
        "// Line_Reference 41:             let queryItems = queryParameters.map { URLQueryItem(name: $0.key, value: $0.value) }",
        "// Line_Reference 42:             urlComponent.queryItems = queryItems",
        "// Line_Reference 43:         }",
        "// Line_Reference 44: ",
        "// Line_Reference 45:         var urlRequest = URLRequest(url: urlComponent.url!)"
    ]
}
