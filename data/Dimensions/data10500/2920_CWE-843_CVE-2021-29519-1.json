{
    "cve_id": "CVE-2021-29519",
    "cve_description": "TensorFlow is an end-to-end open source platform for machine learning. The API of `tf.raw_ops.SparseCross` allows combinations which would result in a `CHECK`-failure and denial of service. This is because the implementation(https://github.com/tensorflow/tensorflow/blob/3d782b7d47b1bf2ed32bd4a246d6d6cadc4c903d/tensorflow/core/kernels/sparse_cross_op.cc#L114-L116) is tricked to consider a tensor of type `tstring` which in fact contains integral elements. Fixing the type confusion by preventing mixing `DT_STRING` and `DT_INT64` types solves this issue. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.",
    "cve_publish_date": "2021-05-14",
    "cwe_id": "CWE-843",
    "cwe_name": "Access of Resource Using Incompatible Type ('Type Confusion')",
    "cwe_description": "The product allocates or initializes a resource such as a pointer, object, or variable using one type, but it later accesses that resource using a type that is incompatible with the original type.",
    "commit_message": "Fix `tf.raw_ops.SparseCross` failing CHECK.\n\nPiperOrigin-RevId: 368701671\nChange-Id: Id805729dd9ba0bda36e4bb309408129b55fb649d",
    "type_of_change": "Modification",
    "filename_of_changes": "sparse_cross_op.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "48",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 463:                      const OpInputList& dense_list_in) {",
        "// Line_Reference 714:     OP_REQUIRES_OK(context, ValidateInput(indices_list_in, values_list_in,",
        "// Line_Reference 715:                                           shapes_list_in, dense_list_in));",
        "// Line_Reference 776:     OP_REQUIRES_OK(context, ValidateInput(indices_list_in, values_list_in,",
        "// Line_Reference 777:                                           shapes_list_in, dense_list_in));",
        "// Line_Reference 835:     OP_REQUIRES_OK(context, ValidateInput(indices_list_in, values_list_in,",
        "// Line_Reference 836:                                           shapes_list_in, dense_list_in));"
    ]
}
