{
    "cve_id": "CVE-2018-7998",
    "cve_description": "In libvips before 8.6.3, a NULL function pointer dereference vulnerability was found in the vips_region_generate function in region.c, which allows remote attackers to cause a denial of service or possibly have unspecified other impact via a crafted image file. This occurs because of a race condition involving a failed delayed load and other worker threads.",
    "cve_publish_date": "2018-03-09",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "fix a crash with delayed load\n\nIf a delayed load failed, it could leave the pipeline only half-set up.\nSebsequent threads could then segv.\n\nSet a load-has-failed flag and test before generate.\n\nSee https://github.com/jcupitt/libvips/issues/893",
    "type_of_change": "Modification",
    "filename_of_changes": "foreign.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 822: \t\tif( class->load( load ) ||",
        "// Line_Reference 823: \t\t\tvips_image_pio_input( load->real ) )",
        "// Line_Reference 824: \t\t\treturn( NULL );",
        "// Line_Reference 825: ",
        "// Line_Reference 826: \t\t/* ->header() read the header into @out, load has read the",
        "// Line_Reference 833: \t\tif( !vips_foreign_load_iscompat( load->real, out ) )"
    ]
}
