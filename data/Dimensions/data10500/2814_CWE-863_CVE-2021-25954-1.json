{
    "cve_id": "CVE-2021-25954",
    "cve_description": "In “Dolibarr” application, 2.8.1 to 13.0.4 don’t restrict or incorrectly restricts access to a resource from an unauthorized actor. A low privileged attacker can modify the Private Note which only an administrator has rights to do, the affected field is at “/adherents/note.php?id=1” endpoint.",
    "cve_publish_date": "2021-08-09",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Fix vulnerabiity: External users can set a public note",
    "type_of_change": "Modification",
    "filename_of_changes": "actions_setnotes.inc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 70: } elseif ($action == 'setnote_private' && !empty($permissionnote) && !GETPOST('cancel', 'alpha')) {",
        "// Line_Reference 71: \t// Set public note",
        "// Line_Reference 72: \tif (empty($action) || !is_object($object) || empty($id)) {",
        "// Line_Reference 73: \t\tdol_print_error('', 'Include of actions_setnotes.inc.php was done but required variable was not set before');",
        "// Line_Reference 74: \t}",
        "// Line_Reference 75: \tif (empty($object->id)) {",
        "// Line_Reference 76: \t\t$object->fetch($id); // Fetch may not be already done",
        "// Line_Reference 77: \t}",
        "// Line_Reference 78: \t$result = $object->update_note(dol_html_entity_decode(GETPOST('note_private', 'restricthtml'), ENT_QUOTES | ENT_HTML5), '_private');",
        "// Line_Reference 79: \tif ($result < 0) {",
        "// Line_Reference 80: \t\tsetEventMessages($object->error, $object->errors, 'errors');"
    ]
}
