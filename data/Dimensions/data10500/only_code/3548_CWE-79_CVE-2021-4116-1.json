* @param array $path
public static function loadFromPath($path)
$instance->name = basename($path);
$instance->name = $name;
* @param bool|string $type
public function validate($type = false)
Log::error("Error: {$e->getMessage()} | {$this->getName()} | {$this->getSize()}", __CLASS__);
* @param bool|string $type
public function validateAndSecure($type = false): bool
if ('image' === $this->getShortMimeType(0) && static::secureImage($this)) {
throw new \App\Exceptions\DangerousFile('ERR_FILE_PHP_CODE_INJECTION');
if (
if (
$imageSize
&& (empty($imageInfo['APP1']) || 0 === strpos($imageInfo['APP1'], 'Exif'))
&& ($exifdata = exif_read_data($this->path)) && !$this->validateImageMetadata($exifdata)
) {
throw new \App\Exceptions\DangerousFile('ERR_FILE_PHP_CODE_INJECTION');
* Validate image metadata.
* @param mixed $data
private function validateImageMetadata($data)
if (!$this->validateImageMetadata($value)) {
return false;
return true;
if (!static::secureImage($file)) {
public static function secureImage(self $file): bool