{
    "cve_id": "CVE-2017-10911",
    "cve_description": "The make_response function in drivers/block/xen-blkback/blkback.c in the Linux kernel before 4.11.8 allows guest OS users to obtain sensitive information from host OS (or other guest OS) kernel memory by leveraging the copying of uninitialized padding fields in Xen block-interface response structures, aka XSA-216.",
    "cve_publish_date": "2017-07-05",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "xen-blkback: don't leak stack data via response ring\n\nRather than constructing a local structure instance on the stack, fill\nthe fields directly on the shared ring, just like other backends do.\nBuild on the fact that all response structure flavors are actually\nidentical (the old code did make this assumption too).\n\nThis is XSA-216.\n\nCc: stable@vger.kernel.org\n\nSigned-off-by: Jan Beulich <jbeulich@suse.com>\nReviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>\nSigned-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "blkback.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 1436: \tstruct blkif_response  resp;",
        "// Line_Reference 1441: \tresp.id        = id;",
        "// Line_Reference 1442: \tresp.operation = op;",
        "// Line_Reference 1443: \tresp.status    = st;",
        "// Line_Reference 1444: ",
        "// Line_Reference 1450: \t\tmemcpy(RING_GET_RESPONSE(&blk_rings->native, blk_rings->native.rsp_prod_pvt),",
        "// Line_Reference 1451: \t\t       &resp, sizeof(resp));",
        "// Line_Reference 1454: \t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_32, blk_rings->x86_32.rsp_prod_pvt),",
        "// Line_Reference 1455: \t\t       &resp, sizeof(resp));",
        "// Line_Reference 1458: \t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_64, blk_rings->x86_64.rsp_prod_pvt),",
        "// Line_Reference 1459: \t\t       &resp, sizeof(resp));"
    ]
}
