{
    "cve_id": "CVE-2019-18198",
    "cve_description": "In the Linux kernel before 5.3.4, a reference count usage error in the fib6_rule_suppress() function in the fib6 suppression feature of net/ipv6/fib6_rules.c, when handling the FIB_LOOKUP_NOREF flag, can be exploited by a local attacker to corrupt memory, aka CID-ca7a03c41753.",
    "cve_publish_date": "2019-10-18",
    "cwe_id": "CWE-772",
    "cwe_name": "Missing Release of Resource after Effective Lifetime",
    "cwe_description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed.",
    "commit_message": "ipv6: do not free rt if FIB_LOOKUP_NOREF is set on suppress rule\n\nCommit 7d9e5f422150 removed references from certain dsts, but accounting\nfor this never translated down into the fib6 suppression code. This bug\nwas triggered by WireGuard users who use wg-quick(8), which uses the\n\"suppress-prefix\" directive to ip-rule(8) for routing all of their\ninternet traffic without routing loops. The test case added here\ncauses the reference underflow by causing packets to evaluate a suppress\nrule.\n\nFixes: 7d9e5f422150 (\"ipv6: convert major tx path to use RT6_LOOKUP_F_DST_NOREF\")\nSigned-off-by: Jason A. Donenfeld <Jason@zx2c4.com>\nAcked-by: Wei Wang <weiwan@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "fib6_rules.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 290: \tip6_rt_put(rt);"
    ]
}
