{
    "cve_id": "CVE-2020-15237",
    "cve_description": "In Shrine before version 3.3.0, when using the `derivation_endpoint` plugin, it's possible for the attacker to use a timing attack to guess the signature of the derivation URL. The problem has been fixed by comparing sent and calculated signature in constant time, using `Rack::Utils.secure_compare`. Users using the `derivation_endpoint` plugin are urged to upgrade to Shrine 3.3.0 or greater. A possible workaround is provided in the linked advisory.",
    "cve_publish_date": "2020-10-05",
    "cwe_id": "CWE-203",
    "cwe_name": "Observable Discrepancy",
    "cwe_description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.",
    "commit_message": "Securely compare signature in derivation_endpoint\n\nUsing regular string comparison when comparing signature has different\nperformance depending on how much of the string matched, which can make\nderivation_endpoint susceptible to timing attacks. We avoid that by\nusing `Rack::Utils.secure_compare` instead.\n\nBig thanks to @esparta for reporting this.",
    "type_of_change": "Modification",
    "filename_of_changes": "derivation_endpoint.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 742:       elsif signature != generate_signature(string)"
    ]
}
