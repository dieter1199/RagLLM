{
    "cve_id": "CVE-2018-20030",
    "cve_description": "An error when processing the EXIF_IFD_INTEROPERABILITY and EXIF_IFD_EXIF tags within libexif version 0.6.21 can be exploited to exhaust available CPU resources.",
    "cve_publish_date": "2019-02-20",
    "cwe_id": "CWE-400",
    "cwe_name": "Uncontrolled Resource Consumption",
    "cwe_description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
    "commit_message": "Improve deep recursion detection in exif_data_load_data_content.\n\nThe existing detection was still vulnerable to pathological cases\ncausing DoS by wasting CPU. The new algorithm takes the number of tags\ninto account to make it harder to abuse by cases using shallow recursion\nbut with a very large number of tags.  This improves on commit 5d28011c\nwhich wasn't sufficient to counter this kind of case.\n\nThe limitation in the previous fix was discovered by Laurent Delosieres,\nSecunia Research at Flexera (Secunia Advisory SA84652) and is assigned\nthe identifier CVE-2018-20030.",
    "type_of_change": "Modification",
    "filename_of_changes": "exif-data.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 360:  * \\param[in] recursion_depth number of times this function has been",
        "// Line_Reference 361:  * recursively called without returning",
        "// Line_Reference 366: \t\t\t     unsigned int ds, unsigned int offset, unsigned int recursion_depth)",
        "// Line_Reference 381: \tif (recursion_depth > 12) {",
        "// Line_Reference 383: \t\t\t  \"Deep recursion detected!\");",
        "// Line_Reference 425: \t\t\t\texif_data_load_data_content (data, EXIF_IFD_EXIF, d, ds, o, recursion_depth + 1);",
        "// Line_Reference 429: \t\t\t\texif_data_load_data_content (data, EXIF_IFD_GPS, d, ds, o, recursion_depth + 1);",
        "// Line_Reference 433: \t\t\t\texif_data_load_data_content (data, EXIF_IFD_INTEROPERABILITY, d, ds, o, recursion_depth + 1);"
    ]
}
