{
    "cve_id": "CVE-2022-3065",
    "cve_description": "Improper Access Control in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "shapes-14-6-5.min.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 2054: function mxCabinetsCabinet(a,d,e,b){mxShape.call(this);this.bounds=a;this.fill=d;this.stroke=e;this.strokewidth=null!=b?b:1}mxUtils.extend(mxCabinetsCabinet,mxShape);mxCabinetsCabinet.prototype.cst={HAS_STAND:\"hasStand\",CABINET:\"mxgraph.cabinets.cabinet\"};mxCabinetsCabinet.prototype.customProperties=[{name:\"hasStand\",dispName:\"Has Stand\",type:\"bool\",defVal:!0}];",
        "// Line_Reference 2055: mxCabinetsCabinet.prototype.paintVertexShape=function(a,d,e,b,c){a.translate(d,e);this.background(a,0,0,b,c);a.setShadow(!1);this.foreground(a,0,0,b,c)};mxCabinetsCabinet.prototype.background=function(a,d,e,b,c){a.rect(0,0,b,c);a.fillAndStroke()};",
        "// Line_Reference 3013: mxRackRackCabinet.prototype.paintVertexShape=function(a,d,e,b,c){var f=parseFloat(mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.UNIT_NUM,\"12\")),g=parseFloat(mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.UNIT_HEIGHT,\"14.8\")),h=parseFloat(mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.TEXT_SIZE,\"12\")),k=mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.NUMBER_DISPLAY,mxRackRackCabinet.prototype.cst.ON);k===mxRackRackCabinet.prototype.cst.ON?a.translate(d+",
        "// Line_Reference 3014: 2*h,e):a.translate(d,e);c=f*g+42;this.background(a,b,c,h);a.setShadow(!1);this.foreground(a,b,c,h);k===mxRackRackCabinet.prototype.cst.ON&&this.sideText(a,b,c,f,g,h)};mxRackRackCabinet.prototype.background=function(a,d,e,b){a.setFillColor(\"#ffffff\");a.rect(0,0,180,e);a.fillAndStroke()};",
        "// Line_Reference 3015: mxRackRackCabinet.prototype.foreground=function(a,d,e,b){a.setFillColor(\"#f4f4f4\");a.rect(0,0,180,21);a.fillAndStroke();a.rect(0,e-21,180,21);a.fillAndStroke();a.rect(0,21,9,e-42);a.fillAndStroke();a.rect(171,21,9,e-42);a.fillAndStroke();a.ellipse(2.5,7.5,6,6);a.stroke();a.ellipse(171.5,7.5,6,6);a.stroke();a.ellipse(2.5,e-13.5,6,6);a.stroke();a.ellipse(171.5,e-13.5,6,6);a.stroke()};",
        "// Line_Reference 3016: mxRackRackCabinet.prototype.sideText=function(a,d,e,b,c,f){d=mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.TEXT_COLOR,\"#666666\");var g=mxUtils.getValue(this.style,mxRackRackCabinet.prototype.cst.NUM_DIR,mxRackRackCabinet.prototype.cst.DIR_DESC);a.setFontSize(f);a.setFontColor(d);if(g===mxRackRackCabinet.prototype.cst.DIR_ASC)for(d=0;d<b;d++)a.text(-f,21+.5*c+d*c,0,0,(d+1).toString(),mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,0,null,0,0,0);else for(d=0;d<b;d++)a.text(-f,e-21-.5*",
        "// Line_Reference 3017: c-d*c,0,0,(d+1).toString(),mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,0,null,0,0,0);a.setStrokeColor(\"#dddddd\");a.begin();for(d=0;d<b+1;d++)a.moveTo(-2*f,21+d*c),a.lineTo(0,21+d*c);a.stroke()};function mxRackHorCableDuct1U(a,d,e,b){mxShape.call(this);this.bounds=a;this.fill=d;this.stroke=e;this.strokewidth=null!=b?b:1}mxUtils.extend(mxRackHorCableDuct1U,mxShape);mxRackHorCableDuct1U.prototype.cst={SHAPE_RACK_HOR_CABLE_DUCT_1U:\"mxgraph.rackGeneral.horCableDuct1U\"};"
    ]
}
