{
    "cve_id": "CVE-2024-2213",
    "cve_description": "An issue was discovered in zenml-io/zenml versions up to and including 0.55.4. Due to improper authentication mechanisms, an attacker with access to an active user session can change the account password without needing to know the current password. This vulnerability allows for unauthorized account takeover by bypassing the standard password change verification process. The issue was fixed in version 0.56.3.",
    "cve_publish_date": "2024-06-06",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "Check old password during password change and add missing CLI commands (#2587)\n\n* Check old password during password change and add missing CLI commands\r\n\r\n* Fix docstrings\r\n\r\n* Ask to re-enter password during CLI password change\r\n\r\n* Auto-update of E2E template\r\n\r\n* Auto-update of LLM Finetuning template\r\n\r\n* Auto-update of NLP template\r\n\r\n---------\r\n\r\nCo-authored-by: GitHub Actions <actions@github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "user_management.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "148",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 26: from zenml.exceptions import EntityExistsError, IllegalOperationError",
        "// Line_Reference 207: @click.option(",
        "// Line_Reference 208:     \"--password\",",
        "// Line_Reference 209:     \"-p\",",
        "// Line_Reference 210:     \"updated_password\",",
        "// Line_Reference 211:     type=str,",
        "// Line_Reference 212:     required=False,",
        "// Line_Reference 213:     help=\"New user password.\",",
        "// Line_Reference 214: )",
        "// Line_Reference 238:     updated_password: Optional[str] = None,",
        "// Line_Reference 249:         updated_password: The name of the user to create.",
        "// Line_Reference 263:                 f\"Currently user `{current_user.name}` is an admin. Are you sure you want to make them a regular user?\"",
        "// Line_Reference 279:             updated_password=updated_password,"
    ]
}
