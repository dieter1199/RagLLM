{
    "cve_id": "CVE-2023-0790",
    "cve_description": "Uncaught Exception in GitHub repository thorsten/phpmyfaq prior to 3.1.11.\n\n",
    "cve_publish_date": "2023-02-12",
    "cwe_id": "CWE-248",
    "cwe_name": "Uncaught Exception",
    "cwe_description": "An exception is thrown from a function, but it is not caught.",
    "commit_message": "fix: added missing check on email address",
    "type_of_change": "Modification",
    "filename_of_changes": "user.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 117:             $userData['display_name'] = Filter::filterInput(INPUT_POST, 'display_name', FILTER_UNSAFE_RAW, '');",
        "// Line_Reference 118:             $userData['email'] = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL, '');",
        "// Line_Reference 119:             $userData['last_modified'] = Filter::filterInput(INPUT_POST, 'last_modified', FILTER_UNSAFE_RAW, '');",
        "// Line_Reference 124:             $user = new User($faqConfig);",
        "// Line_Reference 125:             $user->getUserById($userId, true);",
        "// Line_Reference 127:             $stats = $user->getStatus();",
        "// Line_Reference 129:             // set new password an send email if user is switched to active",
        "// Line_Reference 130:             if ($stats == 'blocked' && $userStatus == 'active') {",
        "// Line_Reference 131:                 if (!$user->activateUser()) {",
        "// Line_Reference 132:                     $userStatus = 'invalid_status';",
        "// Line_Reference 134:             }",
        "// Line_Reference 135: ",
        "// Line_Reference 136:             // Set super-admin flag",
        "// Line_Reference 137:             $user->setSuperAdmin($isSuperAdmin);",
        "// Line_Reference 139:             if (",
        "// Line_Reference 140:                 !$user->userdata->set(array_keys($userData), array_values($userData)) ||",
        "// Line_Reference 141:                 !$user->setStatus($userStatus)",
        "// Line_Reference 142:             ) {",
        "// Line_Reference 143:                 $message .= sprintf('<p class=\"alert alert-danger\">%s</p>', $PMF_LANG['ad_msg_mysqlerr']);",
        "// Line_Reference 144:             } else {",
        "// Line_Reference 145:                 $message .= sprintf(",
        "// Line_Reference 146:                     '<p class=\"alert alert-success\">%s <strong>%s</strong> %s</p>',",
        "// Line_Reference 147:                     $PMF_LANG['ad_msg_savedsuc_1'],",
        "// Line_Reference 148:                     Strings::htmlentities($user->getLogin(), ENT_QUOTES),",
        "// Line_Reference 149:                     $PMF_LANG['ad_msg_savedsuc_2']",
        "// Line_Reference 150:                 );",
        "// Line_Reference 151:                 $message .= '<script>updateUser(' . $userId . ');</script>';"
    ]
}
