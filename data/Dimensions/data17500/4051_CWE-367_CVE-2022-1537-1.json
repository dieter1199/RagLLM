{
    "cve_id": "CVE-2022-1537",
    "cve_description": "file.copy operations in GruntJS are vulnerable to a TOCTOU race condition leading to arbitrary file write in GitHub repository gruntjs/grunt prior to 1.5.3. This vulnerability is capable of arbitrary file writes which can lead to local privilege escalation to the GruntJS user if a lower-privileged user has write access to both source and destination directories as the lower-privileged user can create a symlink to the GruntJS user's .bashrc file or replace /etc/shadow file if the GruntJS user is root.",
    "cve_publish_date": "2022-05-10",
    "cwe_id": "CWE-367",
    "cwe_name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
    "cwe_description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
    "commit_message": "Patch up race condition in symlink copying.",
    "type_of_change": "Modification",
    "filename_of_changes": "file.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 297:   if (file.isLink(destpath)) {",
        "// Line_Reference 298:     // in case destpath is a symlink, avoid following the symlink, instead overwrite it later",
        "// Line_Reference 299:     fs.unlinkSync(destpath);",
        "// Line_Reference 300:   }",
        "// Line_Reference 301: ",
        "// Line_Reference 341:   if (contents === false) {",
        "// Line_Reference 342:     grunt.verbose.writeln('Write aborted.');"
    ]
}
