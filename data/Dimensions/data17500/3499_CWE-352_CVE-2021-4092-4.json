{
    "cve_id": "CVE-2021-4092",
    "cve_description": "yetiforcecrm is vulnerable to Cross-Site Request Forgery (CSRF)",
    "cve_publish_date": "2021-12-11",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Added minor improvements",
    "type_of_change": "Modification",
    "filename_of_changes": "PasswordModalFooter.tpl",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 3: <!-- tpl-Users-Modals-PasswordModalFooter -->",
        "// Line_Reference 4: <div class=\"modal-footer\">",
        "// Line_Reference 5: \t{if ($MODE === 'massReset' || $MODE === 'reset') &&  $ACTIVE_SMTP}",
        "// Line_Reference 6: \t\t<button class=\"btn btn-success\" type=\"submit\" name=\"saveButton\"",
        "// Line_Reference 7: \t\t\t\t{if App\\Config::main('systemMode') === 'demo'}disabled=\"disabled\"{/if}>",
        "// Line_Reference 8: \t\t\t<span class=\"fas fa-redo-alt mr-2\"></span><strong>{\\App\\Language::translate('BTN_RESET_PASSWORD', $MODULE_NAME)}</strong>",
        "// Line_Reference 9: \t\t</button>",
        "// Line_Reference 10: \t{/if}",
        "// Line_Reference 11: \t{if $MODE === 'change'}",
        "// Line_Reference 12: \t\t<button class=\"btn btn-success\" type=\"submit\" name=\"saveButton\"",
        "// Line_Reference 13: \t\t\t\t{if App\\Config::main('systemMode') === 'demo'}disabled=\"disabled\"{/if}>",
        "// Line_Reference 14: \t\t\t<span class=\"fas fa-redo-alt mr-2\"></span><strong>{\\App\\Language::translate('LBL_CHANGE_PASSWORD', $MODULE_NAME)}</strong>",
        "// Line_Reference 15: \t\t</button>",
        "// Line_Reference 16: \t{/if}",
        "// Line_Reference 17: \t{if $LOCK_EXIT}",
        "// Line_Reference 18: \t\t<a class=\"btn btn-danger\" role=\"button\" href=\"index.php?module=Users&amp;parent=Settings&amp;action=Logout\">",
        "// Line_Reference 19: \t\t\t<span class=\"fas fa-power-off mr-2\"></span><strong>{\\App\\Language::translate('LBL_SIGN_OUT', $MODULE_NAME)}</strong>",
        "// Line_Reference 20: \t\t</a>",
        "// Line_Reference 21: \t{else}",
        "// Line_Reference 22: \t\t<button class=\"btn btn-danger\" type=\"reset\" data-dismiss=\"modal\">",
        "// Line_Reference 23: \t\t\t<span class=\"fas fa-times mr-2\"></span><strong>{\\App\\Language::translate('LBL_CANCEL', $MODULE_NAME)}</strong>",
        "// Line_Reference 24: \t\t</button>",
        "// Line_Reference 25: \t{/if}",
        "// Line_Reference 26: </div>",
        "// Line_Reference 27: </form>",
        "// Line_Reference 28: <!-- /tpl-Users-Modals-PasswordModalFooter -->"
    ]
}
