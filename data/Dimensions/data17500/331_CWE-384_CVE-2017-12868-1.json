{
    "cve_id": "CVE-2017-12868",
    "cve_description": "The secureCompare method in lib/SimpleSAML/Utils/Crypto.php in SimpleSAMLphp 1.14.13 and earlier, when used with PHP before 5.6, allows attackers to conduct session fixation attacks or possibly bypass authentication by leveraging missing character conversions before an XOR operation.",
    "cve_publish_date": "2017-09-01",
    "cwe_id": "CWE-384",
    "cwe_name": "Session Fixation",
    "cwe_description": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
    "commit_message": "bugfix: SimpleSAML\\Utils\\Crypto returns true for different strings using PHP < 5.6.\n\nThe reason was the lack of conversion to integer for each character of the strings before applying the XOR operator to them. The operator returns always an empty string when applied to two characters, and applying a binary-wise OR between 0 and an empty string, yields 0. Therefore, $diff is always 0, and the function returns true for every two strings with same length, regardless of their contents.",
    "type_of_change": "Modification",
    "filename_of_changes": "Crypto.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 407:         for ($i = 0; $i < $len; ++$i) {",
        "// Line_Reference 408:             $diff |= $known[$i] ^ $user[$i];"
    ]
}
