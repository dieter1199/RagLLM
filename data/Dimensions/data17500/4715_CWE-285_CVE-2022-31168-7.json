{
    "cve_id": "CVE-2022-31168",
    "cve_description": "Zulip is an open source team chat tool. Due to an incorrect authorization check in Zulip Server 5.4 and earlier, a member of an organization could craft an API call that grants organization administrator privileges to one of their bots. The vulnerability is fixed in Zulip Server 5.5. Members who don’t own any bots, and lack permission to create them, can’t exploit the vulnerability. As a workaround for the vulnerability, an organization administrator can restrict the `Who can create bots` permission to administrators only, and change the ownership of existing bots.",
    "cve_publish_date": "2022-07-22",
    "cwe_id": "CWE-285",
    "cwe_name": "Improper Authorization",
    "cwe_description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "CVE-2022-31168: Fix authorization check for changing bot roles.\n\nDue to an incorrect authorization check in Zulip Server 5.4 and\nearlier, a member of an organization could craft an API call that\ngrants organization administrator privileges to one of their bots.\n\nSigned-off-by: Anders Kaseorg <anders@zulip.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "users.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 194:         # grant/remove the role in question.  access_user_by_id has",
        "// Line_Reference 195:         # already verified we're an administrator; here we enforce",
        "// Line_Reference 196:         # that only owners can toggle the is_realm_owner flag."
    ]
}
