{
    "cve_id": "CVE-2022-24782",
    "cve_description": "Discourse is an open source discussion platform. Versions 2.8.2 and prior in the `stable` branch, 2.9.0.beta3 and prior in the `beta` branch, and 2.9.0.beta3 and prior in the `tests-passed` branch are vulnerable to a data leak. Users can request an export of their own activity. Sometimes, due to category settings, they may have category membership for a secure category. The name of this secure category is shown to the user in the export. The same thing occurs when the user's post has been moved to a secure category. A patch for this issue is available in the `main` branch of Discourse's GitHub repository and is anticipated to be part of future releases.",
    "cve_publish_date": "2022-03-24",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "SECURITY: Hide private categories in user activity export (#16273)\n\nIn some of the user's own activity export data,\r\nwe sometimes showed a secure category's name or\r\nexposed the existence of a secure category.",
    "type_of_change": "Modification",
    "filename_of_changes": "export_user_archive.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 264:         .select(:category_id, :notification_level, :last_seen_at)",
        "// Line_Reference 266:         yield [",
        "// Line_Reference 267:           cu.category_id,",
        "// Line_Reference 268:           piped_category_name(cu.category_id),",
        "// Line_Reference 269:           NotificationLevels.all[cu.notification_level],",
        "// Line_Reference 270:           cu.last_seen_at",
        "// Line_Reference 271:         ]",
        "// Line_Reference 272:       end",
        "// Line_Reference 411:     def piped_category_name(category_id)",
        "// Line_Reference 412:       return \"-\" unless category_id",
        "// Line_Reference 413:       category = Category.find_by(id: category_id)",
        "// Line_Reference 414:       return \"#{category_id}\" unless category",
        "// Line_Reference 436:       topic_data = Topic.with_deleted.find_by(id: user_archive['topic_id']) if topic_data.nil?",
        "// Line_Reference 439:       categories = piped_category_name(topic_data.category_id)"
    ]
}
