{
    "cve_id": "CVE-2022-41921",
    "cve_description": "Discourse is an open-source discussion platform. Prior to version 2.9.0.beta13, users can post chat messages of an unlimited length, which can cause a denial of service for other users when posting huge amounts of text. Users should upgrade to version 2.9.0.beta13, where a limit has been introduced. No known workarounds are available.",
    "cve_publish_date": "2022-11-28",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "SECURITY: Limit chat message char length (#19207)\n\nOnly allow maximum of 6000 characters for chat messages when they\r\nare created or edited. A hidden setting can control this limit,\r\n6000 is the default.\r\n\r\nThere is also a migration here to truncate any existing messages to\r\n6000 characters if the message is already over that and if the\r\nchat_messages table exists. We also set cooked_version to NULL\r\nfor those messages so we can identify them for rebake.",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "incoming_chat_webhooks_controller.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 4:   WEBHOOK_MAX_MESSAGE_LENGTH = 2000",
        "// Line_Reference 83:     return if message.length <= WEBHOOK_MAX_MESSAGE_LENGTH",
        "// Line_Reference 85:             \"Body cannot be over #{WEBHOOK_MAX_MESSAGE_LENGTH} characters\","
    ]
}
