{
    "cve_id": "CVE-2022-23620",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions AbstractSxExportURLFactoryActionHandler#processSx does not escape anything from SSX document references when serializing it on filesystem, it is possible to for the HTML export process to contain reference elements containing filesystem syntax like \"../\", \"./\". or \"/\" in general. The referenced elements are not properly escaped. This issue has been resolved in version 13.6-rc-1. This issue can be worked around by limiting or disabling document export.",
    "cve_publish_date": "2022-02-09",
    "cwe_id": "CWE-116",
    "cwe_name": "Improper Encoding or Escaping of Output",
    "cwe_description": "The product prepares a structured message for communication with another component, but encoding or escaping of the data is either missing or done incorrectly. As a result, the intended structure of the message is not preserved.",
    "commit_message": "XWIKI-18819: It's possible to save pretty much anything anywhere by creating and using an SSX/JSX containing \"../\" in its reference",
    "type_of_change": "Modification",
    "filename_of_changes": "AbstractSxExportURLFactoryActionHandler.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 103:             return processSx(spaceNames, name, queryString, context, exportContext);",
        "// Line_Reference 109:     private URL processSx(List<String> spaceNames, String name, String queryString, XWikiContext context,",
        "// Line_Reference 131:         String targetPath = String.format(\"%s/%s/%s\", getSxPrefix(), StringUtils.join(spaceNames, '/'), name);",
        "// Line_Reference 149:         for (String spaceName : spaceNames) {",
        "// Line_Reference 150:             path.append(encodeURLPart(spaceName));",
        "// Line_Reference 151:             path.append(URL_PATH_SEPARATOR);",
        "// Line_Reference 152:         }",
        "// Line_Reference 153:         path.append(encodeURLPart(name));",
        "// Line_Reference 164:         // We know we're inside a SX file located at \"<S|J>sx/<Space>/<Page>/<s|j>sx<NNN>.<css|js>\". Inside this CSS",
        "// Line_Reference 166:         // 3 levels up (\"../../../\").",
        "// Line_Reference 171:             exportContext.setDocParentLevels(3);"
    ]
}
