{
    "cve_id": "CVE-2021-21403",
    "cve_description": "In github.com/kongchuanhujiao/server before version 1.3.21 there is an authentication Bypass by Primary Weakness vulnerability. All users are impacted. This is fixed in version 1.3.21.",
    "cve_publish_date": "2021-03-26",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "重构：优化验证码生成逻辑，最小化权责",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 5: \t\"math/rand\"",
        "// Line_Reference 6: \t\"strconv\"",
        "// Line_Reference 7: \t\"time\"",
        "// Line_Reference 8: ",
        "// Line_Reference 25: ",
        "// Line_Reference 30: \trand.Seed(time.Now().UnixNano())",
        "// Line_Reference 31: \tc := strconv.FormatFloat(rand.Float64(), 'f', -1, 64)[2:6]",
        "// Line_Reference 32: ",
        "// Line_Reference 34: \t\tmessage.NewTextMessage(\"您的验证码是：\" + c + \"，请勿泄露给他人。有效期5分钟\").",
        "// Line_Reference 38: \taccount.WriteCode(id, c)",
        "// Line_Reference 39: ",
        "// Line_Reference 40: \tgo func() {",
        "// Line_Reference 41: \t\ttimer := time.NewTimer(5 * time.Minute)",
        "// Line_Reference 42: \t\tdefer timer.Stop()",
        "// Line_Reference 43: \t\t<-timer.C",
        "// Line_Reference 44: \t\taccount.DeleteCode(id)",
        "// Line_Reference 45: \t}()",
        "// Line_Reference 46: "
    ]
}
