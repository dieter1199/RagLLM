{
    "cve_id": "CVE-2020-28491",
    "cve_description": "This affects the package com.fasterxml.jackson.dataformat:jackson-dataformat-cbor from 0 and before 2.11.4, from 2.12.0-rc1 and before 2.12.1. Unchecked allocation of byte buffer can cause a java.lang.OutOfMemoryError exception.",
    "cve_publish_date": "2021-02-18",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "Fix eager allocation aspect of #186",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "CBORParser.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "89",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 1709:     private int _readAndWriteBytes(OutputStream out, int total) throws IOException",
        "// Line_Reference 1715:                 loadMoreGuaranteed();",
        "// Line_Reference 2428: ",
        "// Line_Reference 2433:         if (len >= 0) {",
        "// Line_Reference 2437:             byte[] b = new byte[len];",
        "// Line_Reference 2438:             if (_inputPtr >= _inputEnd) {",
        "// Line_Reference 2439:                 loadMoreGuaranteed();",
        "// Line_Reference 2441:             int ptr = 0;",
        "// Line_Reference 2442:             while (true) {",
        "// Line_Reference 2443:                 int toAdd = Math.min(len, _inputEnd - _inputPtr);",
        "// Line_Reference 2444:                 System.arraycopy(_inputBuffer, _inputPtr, b, ptr, toAdd);",
        "// Line_Reference 2445:                 _inputPtr += toAdd;",
        "// Line_Reference 2446:                 ptr += toAdd;",
        "// Line_Reference 2447:                 len -= toAdd;",
        "// Line_Reference 2448:                 if (len <= 0) {",
        "// Line_Reference 2449:                     return b;",
        "// Line_Reference 2450:                 }",
        "// Line_Reference 2451:                 loadMoreGuaranteed();",
        "// Line_Reference 2471:             len = _decodeExplicitLength(ch & 0x1F);",
        "// Line_Reference 2478:                     loadMoreGuaranteed();",
        "// Line_Reference 2489: ",
        "// Line_Reference 2638:             /* 08-Sep-2014, tatu: As per [Issue#5], there are codecs",
        "// Line_Reference 2639:              *   (f.ex. Perl module \"CBOR::XS\") that use Binary data...",
        "// Line_Reference 2640:              */",
        "// Line_Reference 3207:     protected final boolean loadMore() throws IOException",
        "// Line_Reference 3228:     protected final void loadMoreGuaranteed() throws IOException {"
    ]
}
