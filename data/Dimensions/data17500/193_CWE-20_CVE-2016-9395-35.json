{
    "cve_id": "CVE-2016-9395",
    "cve_description": "The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.",
    "cve_publish_date": "2017-03-23",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "The generation of the configuration file jas_config.h has been completely\nreworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.",
    "type_of_change": "Modification",
    "filename_of_changes": "jp2_dec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 228: \tif (dec->ihdr->data.ihdr.numcmpts != JAS_CAST(uint,",
        "// Line_Reference 242: \tfor (i = 1; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {",
        "// Line_Reference 265: \t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(uint, jas_image_numcmpts(",
        "// Line_Reference 272: \t\t\tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image));",
        "// Line_Reference 327: \t  JAS_CAST(uint, jas_image_numcmpts(dec->image));",
        "// Line_Reference 333: \t\t\tif (dec->cmap->data.cmap.ents[i].cmptno >= JAS_CAST(uint,",
        "// Line_Reference 394: \tfor (i = 0; i < JAS_CAST(uint, jas_image_numcmpts(dec->image)); ++i) {"
    ]
}
