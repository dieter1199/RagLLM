{
    "cve_id": "CVE-2023-6753",
    "cve_description": "Path Traversal in GitHub repository mlflow/mlflow prior to 2.9.2.",
    "cve_publish_date": "2023-12-13",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Fix for windows traversal attack (#10647)\n\nSigned-off-by: Ben Wilson <benjamin.wilson@databricks.com>\r\nSigned-off-by: Ben Wilson <39283302+BenWilson2@users.noreply.github.com>\r\nCo-authored-by: Harutaka Kawamura <hkawamura0130@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "http_dataset_source.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 2: import posixpath",
        "// Line_Reference 61:         path = urlparse(self.url).path",
        "// Line_Reference 62:         content_disposition = resp.headers.get(\"Content-Disposition\")",
        "// Line_Reference 63:         if content_disposition is not None and (",
        "// Line_Reference 64:             file_name := next(re.finditer(r\"filename=(.+)\", content_disposition), None)",
        "// Line_Reference 65:         ):",
        "// Line_Reference 66:             # NB: If the filename is quoted, unquote it",
        "// Line_Reference 67:             basename = file_name[1].strip(\"'\\\"\")",
        "// Line_Reference 68:             if _is_path(basename):",
        "// Line_Reference 69:                 raise MlflowException.invalid_parameter_value(",
        "// Line_Reference 70:                     f\"Invalid filename in Content-Disposition header: {basename}. \"",
        "// Line_Reference 71:                     \"It must be a file name, not a path.\"",
        "// Line_Reference 72:                 )",
        "// Line_Reference 73:         elif path is not None and len(posixpath.basename(path)) > 0:",
        "// Line_Reference 74:             basename = posixpath.basename(path)",
        "// Line_Reference 75:         else:"
    ]
}
