{
    "cve_id": "CVE-2018-7254",
    "cve_description": "The ParseCaffHeaderConfig function of the cli/caff.c file of WavPack 5.1.0 allows a remote attacker to cause a denial-of-service (global buffer over-read), or possibly trigger a buffer overflow or incorrect memory allocation, via a maliciously crafted CAF file.",
    "cve_publish_date": "2018-02-19",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "issue #28, fix buffer overflows and bad allocs on corrupt CAF files",
    "type_of_change": "Modification",
    "filename_of_changes": "caff.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 92: static const char TMH_full [] = { 1,2,3,13,9,10,5,6,12,14,15,16,17,9,4,18,7,8,19,20,21 };",
        "// Line_Reference 93: static const char TMH_std [] = { 1,2,3,11,8,9,5,6,10,12,13,14,15,7,4,16 };",
        "// Line_Reference 277:             CAFChannelLayout *caf_channel_layout = malloc ((size_t) caf_chunk_header.mChunkSize);",
        "// Line_Reference 279:             if (caf_chunk_header.mChunkSize < sizeof (CAFChannelLayout) ||",
        "// Line_Reference 280:                 !DoReadFile (infile, caf_channel_layout, (uint32_t) caf_chunk_header.mChunkSize, &bcount) ||",
        "// Line_Reference 498:             int bytes_to_copy = (uint32_t) caf_chunk_header.mChunkSize;",
        "// Line_Reference 499:             char *buff = malloc (bytes_to_copy);"
    ]
}
