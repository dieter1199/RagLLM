{
    "cve_id": "CVE-2018-15854",
    "cve_description": "Unchecked NULL pointer usage in xkbcommon before 0.8.1 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file, because geometry tokens were desupported incorrectly.",
    "cve_publish_date": "2018-08-25",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "xkbcomp: fix crashes in the parser when geometry tokens appear\n\nIn the XKB format, floats and various keywords can only be used in the\nxkb_geometry section. xkbcommon removed support xkb_geometry, but still\nparses it for backward compatibility. As part of ignoring it, the float\nAST node and various keywords were removed, and instead NULL was\nreturned by their parsing actions. However, the rest of the code does\nnot handle NULLs, and so when they appear crashes usually ensue.\n\nTo fix this, restore the float AST node and the ignored keywords. None\nof the evaluating code expects them, so nice error are displayed.\n\nCaught with the afl fuzzer.\n\nSigned-off-by: Ran Benita <ran234@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "parser.y",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 594:                         { $$ = XKB_ATOM_NONE; }",
        "// Line_Reference 596:                         { $$ = XKB_ATOM_NONE; }",
        "// Line_Reference 598:                         { $$ = XKB_ATOM_NONE; }",
        "// Line_Reference 600:                         { $$ = XKB_ATOM_NONE; }",
        "// Line_Reference 690:                         { $$ = NULL; }"
    ]
}
