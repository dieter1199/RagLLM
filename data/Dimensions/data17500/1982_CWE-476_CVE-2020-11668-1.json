{
    "cve_id": "CVE-2020-11668",
    "cve_description": "In the Linux kernel before 5.6.1, drivers/media/usb/gspca/xirlink_cit.c (aka the Xirlink camera USB driver) mishandles invalid descriptors, aka CID-a246b4d54770.",
    "cve_publish_date": "2020-04-09",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "media: xirlink_cit: add missing descriptor sanity checks\n\nMake sure to check that we have two alternate settings and at least one\nendpoint before accessing the second altsetting structure and\ndereferencing the endpoint arrays.\n\nThis specifically avoids dereferencing NULL-pointers or corrupting\nmemory when a device does not have the expected descriptors.\n\nNote that the sanity check in cit_get_packet_size() is not redundant as\nthe driver is mixing looking up altsettings by index and by number,\nwhich may not coincide.\n\nFixes: 659fefa0eb17 (\"V4L/DVB: gspca_xirlink_cit: Add support for camera with a bcd version of 0.01\")\nFixes: 59f8b0bf3c12 (\"V4L/DVB: gspca_xirlink_cit: support bandwidth changing for devices with 1 alt setting\")\nCc: stable <stable@vger.kernel.org>     # 2.6.37\nCc: Hans de Goede <hdegoede@redhat.com>\nSigned-off-by: Johan Hovold <johan@kernel.org>\nSigned-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>\nSigned-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "xirlink_cit.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 2645: \talt = &gspca_dev->dev->actconfig->intf_cache[0]->altsetting[1];"
    ]
}
