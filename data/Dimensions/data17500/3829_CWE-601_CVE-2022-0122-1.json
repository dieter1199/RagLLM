{
    "cve_id": "CVE-2022-0122",
    "cve_description": "forge is vulnerable to URL Redirection to Untrusted Site",
    "cve_publish_date": "2022-01-06",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "Remove forge.util.parseUrl.\n\n- Switch URL parsing to the WHATWG URL Standard `URL` API.\n- Older browser or Node.js usage of related code might now require a URL\n  polyfill.",
    "type_of_change": "Modification",
    "filename_of_changes": "http.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 36:     client.url.scheme + '.' +",
        "// Line_Reference 37:     client.url.host + '.' +",
        "// Line_Reference 124:       host: client.url.host,",
        "// Line_Reference 313:         host: client.url.host,",
        "// Line_Reference 408:  *     socketPool: the flash socket pool to use.",
        "// Line_Reference 444:   var url = http.parseUrl(options.url);",
        "// Line_Reference 445:   if(!url) {",
        "// Line_Reference 472:     secure: (url.scheme === 'https'),",
        "// Line_Reference 500:       if(cn === null || client.url.host !== cn.value) {",
        "// Line_Reference 515:       virtualHost: options.virtualHost || url.host,",
        "// Line_Reference 555:       options.request.setField('Host', client.url.fullHost);",
        "// Line_Reference 1310: /**",
        "// Line_Reference 1311:  * Parses the scheme, host, and port from an http(s) url.",
        "// Line_Reference 1312:  *",
        "// Line_Reference 1313:  * @param str the url string.",
        "// Line_Reference 1314:  *",
        "// Line_Reference 1315:  * @return the parsed url object or null if the url is invalid.",
        "// Line_Reference 1316:  */",
        "// Line_Reference 1317: http.parseUrl = forge.util.parseUrl;",
        "// Line_Reference 1318: ",
        "// Line_Reference 1339:       url = http.parseUrl(url);",
        "// Line_Reference 1342:     // add '.' to front of URL host to match against domain",
        "// Line_Reference 1343:     var host = '.' + url.host;"
    ]
}
