{
    "cve_id": "CVE-2021-3830",
    "cve_description": "btcpayserver is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cve_publish_date": "2021-09-26",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Add CSP at the website level (#2863)",
    "type_of_change": "Modification",
    "filename_of_changes": "ContentSecurityPolicies.cs",
    "code_language": "C#",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 90:                 List<string> values = new List<string>();",
        "// Line_Reference 96:                 foreach (var i in authorized)",
        "// Line_Reference 97:                 {",
        "// Line_Reference 98:                     values.Add(i);",
        "// Line_Reference 99:                 }",
        "// Line_Reference 108:             authorized.Clear();",
        "// Line_Reference 111: ",
        "// Line_Reference 112:         readonly HashSet<string> authorized = new HashSet<string>();",
        "// Line_Reference 113:         internal void AddAllAuthorized(string v)",
        "// Line_Reference 114:         {",
        "// Line_Reference 115:             authorized.Add(v);",
        "// Line_Reference 116:         }",
        "// Line_Reference 117: ",
        "// Line_Reference 118:         public IEnumerable<string> Authorized => authorized;"
    ]
}
