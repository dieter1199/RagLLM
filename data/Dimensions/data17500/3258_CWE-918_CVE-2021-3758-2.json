{
    "cve_id": "CVE-2021-3758",
    "cve_description": "bookstack is vulnerable to Server-Side Request Forgery (SSRF)",
    "cve_publish_date": "2021-09-02",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "Added untrusted server fetching control\n\nWKHTMLtoPDF provides limited control for external fetching\nso that will now be disabled by default unless\nALLOW_UNTRUSTED_SERVER_FETCHING=true is specifically set.\nThis new option will also control DOMPDF fetching.",
    "type_of_change": "Modification",
    "filename_of_changes": "dompdf.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 40:         'DOMPDF_FONT_DIR' => storage_path('fonts/'),  // advised by dompdf (https://github.com/dompdf/dompdf/pull/782)",
        "// Line_Reference 50:         'DOMPDF_FONT_CACHE' => storage_path('fonts/'),",
        "// Line_Reference 59:         'DOMPDF_TEMP_DIR' => sys_get_temp_dir(),",
        "// Line_Reference 73:         'DOMPDF_CHROOT' => realpath(base_path()),",
        "// Line_Reference 84:         'DOMPDF_UNICODE_ENABLED' => true,",
        "// Line_Reference 89:         'DOMPDF_ENABLE_FONTSUBSETTING' => false,",
        "// Line_Reference 118:         'DOMPDF_PDF_BACKEND' => 'CPDF',",
        "// Line_Reference 144:         'DOMPDF_DEFAULT_MEDIA_TYPE' => 'print',",
        "// Line_Reference 153:         'DOMPDF_DEFAULT_PAPER_SIZE' => 'a4',",
        "// Line_Reference 162:         'DOMPDF_DEFAULT_FONT' => 'dejavu sans',",
        "// Line_Reference 197:         'DOMPDF_DPI' => 96,",
        "// Line_Reference 211:         'DOMPDF_ENABLE_PHP' => false,",
        "// Line_Reference 221:         'DOMPDF_ENABLE_JAVASCRIPT' => false,",
        "// Line_Reference 240:         'DOMPDF_ENABLE_REMOTE' => true,",
        "// Line_Reference 245:         'DOMPDF_FONT_HEIGHT_RATIO' => 1.1,",
        "// Line_Reference 254:         'DOMPDF_ENABLE_CSS_FLOAT' => true,",
        "// Line_Reference 259:         'DOMPDF_ENABLE_HTML5PARSER' => true,"
    ]
}
