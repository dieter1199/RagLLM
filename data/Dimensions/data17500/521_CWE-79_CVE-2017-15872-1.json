{
    "cve_id": "CVE-2017-15872",
    "cve_description": "phpwcms 1.8.9 has XSS in include/inc_tmpl/admin.edituser.tmpl.php and include/inc_tmpl/admin.newuser.tmpl.php via the username (aka new_login) field.",
    "cve_publish_date": "2017-10-24",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix stored XSS as reported by Chirag Savla\n\nIt's a pretty old problem – a beginner's mistake in programming. Damn. As far I can see no huge problem because of CSRF and you need to be logged in to the backend. But it wasn't well done from my side.\n\nIf you have older installations check the html() function which were added. Older releases do not know html() – use html_specialchars() instead.",
    "type_of_change": "Modification",
    "filename_of_changes": "admin.edituser.tmpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 139:             <td align=\"right\"><strong style=\"color:#FF3300\"><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>",
        "// Line_Reference 140:             <td><strong style=\"color:#FF3300\"><?php echo nl2br(chop($user_err)) ?></strong></td>",
        "// Line_Reference 148:             <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" class=\"width250 f11b\" value=\"<?php echo $new_login ?>\" size=\"30\" maxlength=\"30\" autocomplete=\"off\"></td>",
        "// Line_Reference 153:             <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" class=\"width250 f11b\" value=\"<?php echo $new_password ?>\" size=\"30\" maxlength=\"50\" autocomplete=\"off\"></td>",
        "// Line_Reference 158:             <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" class=\"width250 f11b\" value=\"<?php echo $new_email ?>\" size=\"30\" maxlength=\"150\"></td>",
        "// Line_Reference 163:             <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" class=\"width250 f11b\" value=\"<?php echo $new_name ?>\" size=\"30\" maxlength=\"80\"></td>",
        "// Line_Reference 171:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?>></td>",
        "// Line_Reference 173:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?>></td>",
        "// Line_Reference 175:                   <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?>></td>",
        "// Line_Reference 187:                   <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?>></td>",
        "// Line_Reference 198:                   <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked(1, $set_user_admin); ?>></td>",
        "// Line_Reference 199:                   <td><label for=\"form_admin\"><?php echo $BL['be_admin_usr_ifadmin'] ?> <strong style=\"color:#FF0000\">!!!</strong></label></td>",
        "// Line_Reference 208:                   <td><input name=\"verification_email\" type=\"checkbox\" id=\"verification_email\" value=\"1\"<?php is_checked(1, $send_verification); ?>></td>",
        "// Line_Reference 242:                 <input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_ebutton'] ?>\">",
        "// Line_Reference 244:                 <input name=\"form_uid\" type=\"hidden\" value=\"<?php echo $new_user_id ?>\" />",
        "// Line_Reference 264: ",
        "// Line_Reference 265: ?>"
    ]
}
