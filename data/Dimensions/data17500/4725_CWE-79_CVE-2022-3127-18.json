{
    "cve_id": "CVE-2022-3127",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-05",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "mxClient.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 1: var mxClient={VERSION:\"20.2.7\",IS_IE:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"MSIE\"),IS_IE11:null!=navigator.userAgent&&!!navigator.userAgent.match(/Trident\\/7\\./),IS_EDGE:null!=navigator.userAgent&&!!navigator.userAgent.match(/Edge\\//),IS_EM:\"spellcheck\"in document.createElement(\"textarea\")&&8==document.documentMode,VML_PREFIX:\"v\",OFFICE_PREFIX:\"o\",IS_NS:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"Mozilla/\")&&0>navigator.userAgent.indexOf(\"MSIE\")&&0>navigator.userAgent.indexOf(\"Edge/\"),",
        "// Line_Reference 443: mxStencil.prototype.computeAspect=function(a,b,c,d,e,f){a=b;b=d/this.w0;var g=e/this.h0;if(f=f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH){g=d/this.h0;b=e/this.w0;var k=(d-e)/2;a+=k;c-=k}\"fixed\"==this.aspect&&(b=g=Math.min(b,g),f?(a+=(e-this.w0*b)/2,c+=(d-this.h0*g)/2):(a+=(d-this.w0*b)/2,c+=(e-this.h0*g)/2));return new mxRectangle(a,c,b,g)};",
        "// Line_Reference 451: c.getAttribute(\"dashed\"));else if(\"dashpattern\"==g){if(c=c.getAttribute(\"pattern\"),null!=c){c=c.split(\" \");n=[];for(m=0;m<c.length;m++)0<c[m].length&&n.push(Number(c[m])*p);c=n.join(\" \");a.setDashPattern(c)}}else\"strokecolor\"==g?a.setStrokeColor(c.getAttribute(\"color\")):\"linecap\"==g?a.setLineCap(c.getAttribute(\"cap\")):\"linejoin\"==g?a.setLineJoin(c.getAttribute(\"join\")):\"miterlimit\"==g?a.setMiterLimit(Number(c.getAttribute(\"limit\"))):\"fillcolor\"==g?a.setFillColor(c.getAttribute(\"color\")):\"alpha\"==",
        "// Line_Reference 452: g?a.setAlpha(c.getAttribute(\"alpha\")):\"fillalpha\"==g?a.setAlpha(c.getAttribute(\"alpha\")):\"strokealpha\"==g?a.setAlpha(c.getAttribute(\"alpha\")):\"fontcolor\"==g?a.setFontColor(c.getAttribute(\"color\")):\"fontstyle\"==g?a.setFontStyle(c.getAttribute(\"style\")):\"fontfamily\"==g?a.setFontFamily(c.getAttribute(\"family\")):\"fontsize\"==g&&a.setFontSize(Number(c.getAttribute(\"size\"))*p);!e||\"fillstroke\"!=g&&\"fill\"!=g&&\"stroke\"!=g||a.setShadow(!1)}};"
    ]
}
