readBodyToFile(response, output_stream, max_size)
except SynapseError:
# This can happen e.g. because the body is too large.
raise
class _ReadBodyToFileProtocol(protocol.Protocol):
self.deferred.errback(
SynapseError(
502,
"Requested file is too large > %r bytes" % (self.max_size,),
Codes.TOO_LARGE,
)
)
def readBodyToFile(
response.deliverBody(_ReadBodyToFileProtocol(stream, d, max_size))