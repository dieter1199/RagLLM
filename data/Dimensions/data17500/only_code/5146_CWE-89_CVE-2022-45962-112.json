if(isset($_SESSION['student_id']) && $_SESSION['student_id'] != '')
{
if (count($_REQUEST['mp_arr']) && count($_REQUEST['st_arr'])) {
//    if (count($_REQUEST['mp_arr']) && count($_REQUEST['unused'])) {
//        $st_list = '\'' . implode('\',\'', $_REQUEST['unused']) . '\'';
if (($_REQUEST['elements']['period_absences'] == 'Y' && !$_REQUEST['elements']['grade_type']) || ($_REQUEST['elements']['period_absences'] == 'Y' && $_REQUEST['elements']['grade_type'] && $_REQUEST['elements']['percents'] ))
$extra['SELECT'] .=",sg1.weighted_gp as GPA";
if (($_REQUEST['elements']['comments'] == 'Y' && !$_REQUEST['elements']['grade_type'] ) || ($_REQUEST['elements']['comments'] == 'Y' && $_REQUEST['elements']['grade_type'] && $_REQUEST['elements']['percents']))
if (($_REQUEST['elements']['comments'] == 'Y') || ($_REQUEST['elements']['comments'] == 'Y' && $_REQUEST['elements']['percents'] )) {
if ((($_REQUEST['elements']['mp_tardies'] == 'Y' || $_REQUEST['elements']['ytd_tardies'] == 'Y') && !$_REQUEST['elements']['grade_type']) || (($_REQUEST['elements']['mp_tardies'] == 'Y' || $_REQUEST['elements']['ytd_tardies'] == 'Y') && $_REQUEST['elements']['grade_type'] && $_REQUEST['elements']['percents'] )) {
$columns = array('COURSE_TITLE' =>_course);
$columns += array('TEACHER' =>_teacher);
echo "<tr><td width=105>" . DrawLogo() . "</td><td  style=\"font-size:15px; font-weight:bold; padding-top:20px;\">" . GetSchool(UserSchool()) . ' (' . $cur_session . ')' . "<div style=\"font-size:12px;\">"._studentReportCard."</div></td><td align=right style=\"padding-top:20px\">" . ProperDate(DBDate()) . "<br \>"._poweredByOpenSis."</td></tr><tr><td colspan=3 style=\"border-top:1px solid #333;\">&nbsp;</td></tr></table>";
$comments_arr_key = count($all_commentsA_RET) > 0;
$commentc='';
$commentc=$mps[$last_mp][1]['COMMENT_TITLE'];
$total_grade_point += ($mps[$mpkey][1]['WEIGHTED_GP'] * $mps[$mpkey][1]['CREDIT_ATTEMPTED'] );
}
elseif ($mps[key($mps)][1]['UNWEIGHTED_GP']) {
$mpkey = key($mps);
$total_grade_point += ($mps[$mpkey][1]['UNWEIGHTED_GP'] * $mps[$mpkey][1]['CREDIT_ATTEMPTED'] );
//                                               if(count($config_RET))
//			foreach($config_RET as $title=>$value)
//                        {
//                                $unused_var=explode('_',$value[1]['VALUE']);
//                                $programconfig[$staff_id][$title] =$unused_var[0];
////				$programconfig[$staff_id][$title] = rtrim($value[1]['VALUE'],'_'.$course_period_id);
//                        }
//		else
//			$programconfig[$staff_id] = true;
}
else {
//                                                        if($_SESSION['ROUNDING']=='UP')
//                                                            $mps[$mp][1]['GRADE_PERCENT'] = ceil($mps[$mp][1]['GRADE_PERCENT']);
//                                                    elseif($_SESSION['ROUNDING']=='DOWN')
//                                                            $mps[$mp][1]['GRADE_PERCENT'] = floor($mps[$mp][1]['GRADE_PERCENT']);
//                                                    elseif($_SESSION['ROUNDING']=='NORMAL')
//                                                            $mps[$mp][1]['GRADE_PERCENT'] = round($mps[$mp][1]['GRADE_PERCENT']);
//
if($commentc!='')
$grades_RET[$i]['COMMENT'] .= $sep .$commentc;
//   $grades_RET[$i]['COMMENT'] .= $sep . $mps[$last_mp][1]['COMMENT_TITLE'];
echo '<tr><td><strong>'._studentName.' :</strong></td>';
echo '<tr><td><strong>'._studentId.' :</strong></td>';
echo '<tr><td><strong>'._alternateId.' :</strong></td>';
echo '<tr><td><strong>'._studentGrade.' :</strong></td>';
$mp_absences = '<strong>'._dailyAbsencesThis.' ' . GetMP($last_mp, 'TITLE') . ' :</strong> ' . $count;
echo '<td><strong>'._yearToDateDailyAbsences.' :</strong> ' . $count.'</td>';
echo '<td align="right">'.$mp_absences.'</td>';
ListOutputPrint($grades_RET, $columns, '', '', array(), array(), array('print' =>false));
$personalizations = array('^n' => ($mps[key($mps)][1]['NICKNAME'] ? $mps[key($mps)][1]['NICKNAME'] : $mps[key($mps)][1]['FIRST_NAME']),
'^s' => ($gender == 'M' ? 'his' : ($gender == 'F' ? 'her' : 'his/her')));
echo '<TABLE width=100%><TR><TD colspan=2><b>'._explanationOfCommentCodes.'</b></TD>';
} echo '<br/><br/>';
DrawBC(""._gradebook." > " . ProgramTitle());
echo "<FORM action=ForExport.php?modname=" . strip_tags(trim($_REQUEST[modname])) . "&modfunc=save&include_inactive=" . strip_tags(trim($_REQUEST[include_inactive])) . "&_openSIS_PDF=true&head_html=Student+Report+Card method=POST target=_blank>";
$extra['extra_header_left'] = '<h5 class="text-primary no-margin-top">'._includeOnReportCard.':</h5>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[teacher] value=Y CHECKED><span></span>'._teacher.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[signature] value=Y><span></span>'._includeSignatureLine.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[comments] value=Y CHECKED><span></span>'._comments.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[percents] value=Y><span></span>'._percents.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[ytd_absences] value=Y CHECKED><span></span>'._yearToDateDailyAbsences.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[mp_absences] value=Y' . (GetMP(UserMP(), 'SORT_ORDER') != 1 ? ' CHECKED' : '') . '><span></span>'._dailyAbsencesThisMarkingPeriod.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4 form-inline"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[ytd_tardies] value=Y><span></span>'._otherAttendanceYearToDate.' :</label></div> <SELECT name="ytd_tardies_code" class="form-control input-xs">';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4 form-inline"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-success switch-xs"><label><INPUT type=checkbox name=elements[mp_tardies] value=Y><span></span>'._otherAttendanceThisMarkingPeriod.':</label></div> <SELECT class="form-control input-xs" name="mp_tardies_code">';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[period_absences] value=Y><span></span>'._periodByPeriodAbsences.'</label></div></div></div>';
$extra['extra_header_left'] .= '<div class="col-md-6 col-lg-4"><div class="form-group"><div class="checkbox checkbox-switch switch-success switch-xs"><label><INPUT type=checkbox name=elements[gpa] value=Y><span></span>'._gpa.'</label></div></div></div>';
$extra['extra_header_left'] .= '<h5 class="text-primary">'._markingPeriods.'</h5>';
$qtr1=$qtr['MARKING_PERIOD_ID'];
$extra['extra_header_left'] .= '<label class="checkbox-inline"><INPUT class="styled" type=checkbox name=mp_arr[] value=E' . $qtr1 . ' onclick="reportCardGpaChk();">' . GetMP($qtr1, 'SHORT_NAME') . ' Exam</label>';
}
$extra['link'] = array('FULL_NAME' =>false);
if(isset($_SESSION['student_id']) && $_SESSION['student_id'] != '')
{
//    $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller checked onclick="checkAll(this.form,this.form.controller.checked,\'st_arr\');"><A>');
$extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick="checkAll(this.form,this.form.controller.checked,\'st_arr\');"><A>');
//    $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick="checkAllDtMod(this,\'st_arr\');"><A>');
echo '<div class="text-right p-b-20 p-r-20"><INPUT type=submit class="btn btn-primary" value=\''._createReportCardsForSelectedStudents.'\'></div>';
echo '<h4 class="modal-title">'._chooseCourse.'</h4>';
echo '<h6>' . count($subjects_RET) . ((count($subjects_RET) == 1) ? ' '._subjectWas : ' '._subjectsWere) . ' '._found.'.</h6>';
echo '<table class="table table-bordered"><thead><tr class="alpha-grey"><th>'._subject.'</th></tr></thead><tbody>';
function _makeChooseCheckbox($value, $title) {
return '<INPUT type=checkbox name=st_arr[] value=' . $value . '>';
//    return "<input name=unused_var[$THIS_RET[STUDENT_ID]] value=" . $THIS_RET[STUDENT_ID] . "  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\"st_arr[$THIS_RET[STUDENT_ID]]\",this,$THIS_RET[STUDENT_ID]);' />";
function _makeTeacher($teacher, $column) {
?>
