{
    "cve_id": "CVE-2022-39388",
    "cve_description": "Istio is an open platform to connect, manage, and secure microservices. In versions on the 1.15.x branch prior to 1.15.3, a user can impersonate any workload identity within the service mesh if they have localhost access to the Istiod control plane. Version 1.15.3 contains a patch for this issue. There are no known workarounds.",
    "cve_publish_date": "2022-11-10",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "add xfcc authenticator (#39405)\n\n* add xfcc authenticator\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* go mod\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* lint\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add license\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* fix\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* fix folder\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add copying file\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* remove COPYING\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address review comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add cidr authenticator\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* lint\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* minor changes\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add more comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* update based on review comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* fix test\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* review comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add authentication manager\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* add test\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* fix test\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* fix test\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>\n\n* address comments\n\nSigned-off-by: Rama Chavali <rama.rao@salesforce.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "auth.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 21: \t\"strings\"",
        "// Line_Reference 35: \t\"Authenticate plain text requests - used if Istiod is behind a gateway handling TLS\").Get()",
        "// Line_Reference 59: \tauthFailMsgs := []string{}",
        "// Line_Reference 60: \tfor _, authn := range s.Authenticators {",
        "// Line_Reference 61: \t\tu, err := authn.Authenticate(ctx)",
        "// Line_Reference 62: \t\t// If one authenticator passes, return",
        "// Line_Reference 63: \t\tif u != nil && u.Identities != nil && err == nil {",
        "// Line_Reference 64: \t\t\treturn u.Identities, nil",
        "// Line_Reference 65: \t\t}",
        "// Line_Reference 66: \t\tauthFailMsgs = append(authFailMsgs, fmt.Sprintf(\"Authenticator %s: %v\", authn.AuthenticatorType(), err))",
        "// Line_Reference 67: \t}",
        "// Line_Reference 69: \tlog.Errorf(\"Failed to authenticate client from %s: %s\", peerInfo.Addr.String(), strings.Join(authFailMsgs, \"; \"))"
    ]
}
