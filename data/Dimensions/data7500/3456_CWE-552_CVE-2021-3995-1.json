{
    "cve_id": "CVE-2021-3995",
    "cve_description": "A logic error was found in the libmount library of util-linux in the function that allows an unprivileged user to unmount a FUSE filesystem. This flaw allows an unprivileged local attacker to unmount FUSE filesystems that belong to certain other users who have a UID that is a prefix of the UID of the attacker in its string form. An attacker may use this flaw to cause a denial of service to applications that use the affected filesystems.",
    "cve_publish_date": "2022-08-23",
    "cwe_id": "CWE-552",
    "cwe_name": "Files or Directories Accessible to External Parties",
    "cwe_description": "The product makes files or directories accessible to unauthorized actors, even though they should not be.",
    "commit_message": "libmount: fix UID check for FUSE umount [CVE-2021-3995]\n\nImproper UID check allows an unprivileged user to unmount FUSE\nfilesystems of users with similar UID.\n\nSigned-off-by: Karel Zak <kzak@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "context_umount.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 455: \tchar *user_id = NULL;",
        "// Line_Reference 456: \tsize_t sz;",
        "// Line_Reference 457: \tuid_t uid;",
        "// Line_Reference 458: \tchar uidstr[sizeof(stringify_value(ULONG_MAX))];",
        "// Line_Reference 475: ",
        "// Line_Reference 476: \tif (mnt_optstr_get_option(optstr, \"user_id\", &user_id, &sz) != 0)",
        "// Line_Reference 477: \t\treturn 0;",
        "// Line_Reference 478: ",
        "// Line_Reference 479: \tif (sz == 0 || user_id == NULL)",
        "// Line_Reference 496: \tsnprintf(uidstr, sizeof(uidstr), \"%lu\", (unsigned long) uid);",
        "// Line_Reference 497: \treturn strncmp(user_id, uidstr, sz) == 0;"
    ]
}
