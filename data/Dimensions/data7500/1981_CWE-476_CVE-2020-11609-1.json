{
    "cve_id": "CVE-2020-11609",
    "cve_description": "An issue was discovered in the stv06xx subsystem in the Linux kernel before 5.6.1. drivers/media/usb/gspca/stv06xx/stv06xx.c and drivers/media/usb/gspca/stv06xx/stv06xx_pb0100.c mishandle invalid descriptors, as demonstrated by a NULL pointer dereference, aka CID-485b06aadb93.",
    "cve_publish_date": "2020-04-07",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "media: stv06xx: add missing descriptor sanity checks\n\nMake sure to check that we have two alternate settings and at least one\nendpoint before accessing the second altsetting structure and\ndereferencing the endpoint arrays.\n\nThis specifically avoids dereferencing NULL-pointers or corrupting\nmemory when a device does not have the expected descriptors.\n\nNote that the sanity checks in stv06xx_start() and pb0100_start() are\nnot redundant as the driver is mixing looking up altsettings by index\nand by number, which may not coincide.\n\nFixes: 8668d504d72c (\"V4L/DVB (12082): gspca_stv06xx: Add support for st6422 bridge and sensor\")\nFixes: c0b33bdc5b8d (\"[media] gspca-stv06xx: support bandwidth changing\")\nCc: stable <stable@vger.kernel.org>     # 2.6.31\nCc: Hans de Goede <hdegoede@redhat.com>\nSigned-off-by: Johan Hovold <johan@kernel.org>\nSigned-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>\nSigned-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "stv06xx.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 313: \talt = &gspca_dev->dev->actconfig->intf_cache[0]->altsetting[1];"
    ]
}
