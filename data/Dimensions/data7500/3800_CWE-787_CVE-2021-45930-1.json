{
    "cve_id": "CVE-2021-45930",
    "cve_description": "Qt SVG in Qt 5.0.0 through 5.15.2 and 6.0.0 through 6.2.1 has an out-of-bounds write in QtPrivate::QCommonArrayOps<QPainterPath::Element>::growAppend (called from QPainterPath::addPath and QPathClipper::intersect).",
    "cve_publish_date": "2022-01-01",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Do stricter error checking when parsing path nodes\n\nThe SVG spec mandates that path parsing should terminate on the first\nerror encountered, and an error be reported. To improve the handling\nof corrupt files, implement such error handling, and also limit the\nnumber of QPainterPath elements to a reasonable range.\n\nFixes: QTBUG-96044\nPick-to: 6.2 5.15 5.12\nChange-Id: Ic5e65d6b658516d6f1317c72de365c8c7ad81891\nReviewed-by: Allan Sandfeld Jensen <allan.jensen@qt.io>\nReviewed-by: Robert LÃ¶hning <robert.loehning@qt.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "qsvghandler.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "34",
    "vulnerable_lines": [
        "// Line_Reference 1605:     while (str != end) {",
        "// Line_Reference 1622:         while (count > 0) {",
        "// Line_Reference 1628:                     num++;",
        "// Line_Reference 1629:                     count--;",
        "// Line_Reference 1646:                     num++;",
        "// Line_Reference 1647:                     count--;",
        "// Line_Reference 1673:                     num++;",
        "// Line_Reference 1674:                     count--;",
        "// Line_Reference 1687:                     num++;",
        "// Line_Reference 1688:                     count--;",
        "// Line_Reference 1728:                     num += count;",
        "// Line_Reference 1729:                     count = 0;",
        "// Line_Reference 1745:                     num += count;",
        "// Line_Reference 1746:                     count = 0;",
        "// Line_Reference 1762:                     num += count;",
        "// Line_Reference 1763:                     count = 0;",
        "// Line_Reference 1784:                     num += count;",
        "// Line_Reference 1785:                     count = 0;",
        "// Line_Reference 1806:                     num += count;",
        "// Line_Reference 1807:                     count = 0;",
        "// Line_Reference 1822:                     num += count;",
        "// Line_Reference 1823:                     count = 0;",
        "// Line_Reference 1838:                     num += count;",
        "// Line_Reference 1839:                     count = 0;",
        "// Line_Reference 1859:                     num += count;",
        "// Line_Reference 1860:                     count = 0;",
        "// Line_Reference 1880:                     num += count;",
        "// Line_Reference 1881:                     count = 0;",
        "// Line_Reference 1903:                     num += count;",
        "// Line_Reference 1904:                     count = 0;",
        "// Line_Reference 1925:                 return false;",
        "// Line_Reference 1930:     return true;",
        "// Line_Reference 2988:     //XXX do error handling",
        "// Line_Reference 2989:     parsePathDataFast(data, qpath);"
    ]
}
