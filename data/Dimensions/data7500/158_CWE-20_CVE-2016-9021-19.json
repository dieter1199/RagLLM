{
    "cve_id": "CVE-2016-9021",
    "cve_description": "Exponent CMS before 2.6.0 has improper input validation in storeController.php.",
    "cve_publish_date": "2020-12-31",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "second effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...), thanks to felixk3y",
    "type_of_change": "Modification",
    "filename_of_changes": "cartController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 77:                     /*if ($quantity < $child->minimum_order_quantity)",
        "// Line_Reference 79:                         flash('message', $child->title . \" - \" . $child->model . \" has a minimum order quantity of \" . $child->minimum_order_quantity .",
        "// Line_Reference 82: ",
        "// Line_Reference 174:                 //$newqty = $item->product->updateQuantity($this->params['value']);",
        "// Line_Reference 220:                 //}",
        "// Line_Reference 221:                 /*eDebug($item->quantity);",
        "// Line_Reference 222:                 eDebug($item->product->quantity);",
        "// Line_Reference 223:                 eDebug($qCheck);",
        "// Line_Reference 246:                         /*$updates->message = $item->products_name.' only has '.$item->product->quantity.' on hand. You can not add any more to your cart.';",
        "// Line_Reference 305:             //to something other than 0, then we have, but we'll set the estimtae to shipping_total to",
        "// Line_Reference 313:             //{",
        "// Line_Reference 335:                 // get all current discount codes that are valid and applied",
        "// Line_Reference 706:             // save out the cart total to the database",
        "// Line_Reference 1072:         $discount = $discount->getCouponByName($this->params['coupon_code']);",
        "// Line_Reference 1076:             //redirect_to(array('controller'=>'cart', 'action'=>'checkout'));",
        "// Line_Reference 1103:         //redirect_to(array('controller'=>'cart', 'action'=>'checkout'));",
        "// Line_Reference 1144:         //group items by type and id",
        "// Line_Reference 1148:         //eDebug($order,true);",
        "// Line_Reference 1188: ",
        "// Line_Reference 1189: ",
        "// Line_Reference 1190:         $options = array();",
        "// Line_Reference 1193: ",
        "// Line_Reference 1201:                     $cost = $selected_option->updown == '+' ? $cost : $cost * -1;",
        "// Line_Reference 1215: "
    ]
}
