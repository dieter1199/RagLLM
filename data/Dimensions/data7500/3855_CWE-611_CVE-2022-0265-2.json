{
    "cve_id": "CVE-2022-0265",
    "cve_description": "Improper Restriction of XML External Entity Reference in GitHub repository hazelcast/hazelcast in 5.1-BETA-1.",
    "cve_publish_date": "2022-03-03",
    "cwe_id": "CWE-611",
    "cwe_name": "Improper Restriction of XML External Entity Reference",
    "cwe_description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
    "commit_message": "Add helper method to XmlUtil to enable XXE protection in the SAXParserFactory and XMLInputFactory (#20407)",
    "type_of_change": "Modification",
    "filename_of_changes": "XmlUtil.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "69",
    "number_of_lines_deleted_vulnerable_to_cve": "44",
    "vulnerable_lines": [
        "// Line_Reference 44:  * Utility class for XML processing.",
        "// Line_Reference 71:         setFeature(dbf, \"http://apache.org/xml/features/disallow-doctype-decl\");",
        "// Line_Reference 169:             if (Boolean.getBoolean(SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES)) {",
        "// Line_Reference 170:                 LOGGER.warning(\"Enabling XXE protection failed. The attribute \" + attributeName",
        "// Line_Reference 171:                         + \" is not supported by the TransformerFactory. The \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 172:                         + \" system property is used so the XML processing continues in the UNSECURE mode\"",
        "// Line_Reference 173:                         + \" with XXE protection disabled!!!\");",
        "// Line_Reference 174:             } else {",
        "// Line_Reference 175:                 LOGGER.severe(\"Enabling XXE protection failed. The attribute \" + attributeName",
        "// Line_Reference 176:                         + \" is not supported by the TransformerFactory. This usually mean an outdated XML processor\"",
        "// Line_Reference 177:                         + \" is present on the classpath (e.g. Xerces, Xalan). If you are not able to resolve the issue by\"",
        "// Line_Reference 178:                         + \" fixing the classpath, the \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 179:                         + \" system property can be used to disable XML External Entity protections.\"",
        "// Line_Reference 180:                         + \" We don't recommend disabling the XXE as such the XML processor configuration is unsecure!!!\", iae);",
        "// Line_Reference 181:                 throw iae;",
        "// Line_Reference 182:             }",
        "// Line_Reference 190:             if (Boolean.getBoolean(SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES)) {",
        "// Line_Reference 191:                 LOGGER.warning(\"Enabling XXE protection failed. The feature \" + featureName",
        "// Line_Reference 192:                         + \" is not supported by the DocumentBuilderFactory. The \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 193:                         + \" system property is used so the XML processing continues in the UNSECURE mode\"",
        "// Line_Reference 194:                         + \" with XXE protection disabled!!!\");",
        "// Line_Reference 195:             } else {",
        "// Line_Reference 196:                 LOGGER.severe(\"Enabling XXE protection failed. The feature \" + featureName",
        "// Line_Reference 197:                         + \" is not supported by the DocumentBuilderFactory. This usually mean an outdated XML processor\"",
        "// Line_Reference 198:                         + \" is present on the classpath (e.g. Xerces, Xalan). If you are not able to resolve the issue by\"",
        "// Line_Reference 199:                         + \" fixing the classpath, the \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 200:                         + \" system property can be used to disable XML External Entity protections.\"",
        "// Line_Reference 201:                         + \" We don't recommend disabling the XXE as such the XML processor configuration is unsecure!!!\", e);",
        "// Line_Reference 202:                 throw e;",
        "// Line_Reference 203:             }",
        "// Line_Reference 211:             if (Boolean.getBoolean(SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES)) {",
        "// Line_Reference 212:                 LOGGER.warning(\"Enabling XXE protection failed. The property \" + propertyName",
        "// Line_Reference 213:                         + \" is not supported by the SchemaFactory. The \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 214:                         + \" system property is used so the XML processing continues in the UNSECURE mode\"",
        "// Line_Reference 215:                         + \" with XXE protection disabled!!!\");",
        "// Line_Reference 216:             } else {",
        "// Line_Reference 217:                 LOGGER.severe(\"Enabling XXE protection failed. The property \" + propertyName",
        "// Line_Reference 218:                         + \" is not supported by the SchemaFactory. This usually mean an outdated XML processor\"",
        "// Line_Reference 219:                         + \" is present on the classpath (e.g. Xerces, Xalan). If you are not able to resolve the issue by\"",
        "// Line_Reference 220:                         + \" fixing the classpath, the \" + SYSTEM_PROPERTY_IGNORE_XXE_PROTECTION_FAILURES",
        "// Line_Reference 221:                         + \" system property can be used to disable XML External Entity protections.\"",
        "// Line_Reference 222:                         + \" We don't recommend disabling the XXE as such the XML processor configuration is unsecure!!!\", e);",
        "// Line_Reference 223:                 throw e;",
        "// Line_Reference 224:             }"
    ]
}
