{
    "cve_id": "CVE-2021-21245",
    "cve_description": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, AttachmentUploadServlet also saves user controlled data (`request.getInputStream()`) to a user specified location (`request.getHeader(\"File-Name\")`). This issue may lead to arbitrary file upload which can be used to upload a WebShell to OneDev server. This issue is addressed in 4.0.3 by only allowing uploaded file to be in attachments folder. The webshell issue is not possible as OneDev never executes files in attachments folder.",
    "cve_publish_date": "2021-01-15",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "Fix the issue that uploaded file can be stored anywhere OneDev has write\npermissions over",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "InsertUrlPanel.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 405: \t\t\t\t\t\tattachmentName = attachmentSupport.saveAttachment(upload.getClientFileName(), is);"
    ]
}
