function createWebSocketUrl (options, request) {
const source = new URL(request.url, 'http://127.0.0.1')
const target = new URL(
options.rewritePrefix || options.prefix || source.pathname,
options.upstream
)
target.search = source.search
return target
}
function setupWebSocketProxy (fastify, options) {
path: options.prefix,
const url = createWebSocketUrl(options, request)
const rewritePrefix = opts.rewritePrefix || ''
setupWebSocketProxy(fastify, opts)
