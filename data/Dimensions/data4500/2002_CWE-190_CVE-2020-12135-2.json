{
    "cve_id": "CVE-2020-12135",
    "cve_description": "bson before 0.8 incorrectly uses int rather than size_t for many variables, parameters, and return values. In particular, the bson_ensure_space() parameter bytesNeeded could have an integer overflow via properly constructed bson input.",
    "cve_publish_date": "2020-04-24",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "don't mix up int and size_t (first pass to fix that)",
    "type_of_change": "Modification",
    "filename_of_changes": "bson.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 138:     int stack[32];        /**< A stack used to keep track of nested BSON elements. */",
        "// Line_Reference 173: MONGO_EXPORT int bson_buffer_size( const bson *b );",
        "// Line_Reference 605: int bson_ensure_space( bson *b, const int bytesNeeded );",
        "// Line_Reference 720: MONGO_EXPORT int bson_append_string_n( bson *b, const char *name, const char *str, int len );",
        "// Line_Reference 743: MONGO_EXPORT int bson_append_symbol_n( bson *b, const char *name, const char *str, int len );",
        "// Line_Reference 767: MONGO_EXPORT int bson_append_code_n( bson *b, const char *name, const char *str, int len );",
        "// Line_Reference 792: MONGO_EXPORT int bson_append_code_w_scope_n( bson *b, const char *name, const char *code, int size, const bson *scope );",
        "// Line_Reference 805: MONGO_EXPORT int bson_append_binary( bson *b, const char *name, char type, const char *str, int len );",
        "// Line_Reference 980: MONGO_EXPORT void *bson_malloc( int size );",
        "// Line_Reference 993: void *bson_realloc( void *ptr, int size );"
    ]
}
