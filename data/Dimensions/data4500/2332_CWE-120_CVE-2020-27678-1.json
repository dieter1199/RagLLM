{
    "cve_id": "CVE-2020-27678",
    "cve_description": "An issue was discovered in illumos before 2020-10-22, as used in OmniOS before r151030by, r151032ay, and r151034y and SmartOS before 20201022. There is a buffer overflow in parse_user_name in lib/libpam/pam_framework.c.",
    "cve_publish_date": "2020-10-26",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "13242 parse_user_name in PAM is sloppy\nReviewed by: Alex Wilson <alex@cooperi.net>\nApproved by: Gordon Ross <gordon.w.ross@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "pam_framework.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 27:  * Copyright (c) 2019, Joyent, Inc.",
        "// Line_Reference 659: \t\tif ((*ptr == ' ') || (*ptr == '\\t'))",
        "// Line_Reference 661: \t\telse {",
        "// Line_Reference 669: \tif ((*ret_username = malloc(index + 1)) == NULL)",
        "// Line_Reference 671: \t(void) strcpy(*ret_username, username);"
    ]
}
