{
    "cve_id": "CVE-2021-21296",
    "cve_description": "Fleet is an open source osquery manager. In Fleet before version 3.7.0 a malicious actor with a valid node key can send a badly formatted request that causes the Fleet server to exit, resulting in denial of service. This is possible only while a live query is currently ongoing. We believe the impact of this vulnerability to be low given the requirement that the actor has a valid node key. There is no information disclosure, privilege escalation, or code execution. The issue is fixed in Fleet 3.7.0.",
    "cve_publish_date": "2021-02-10",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Merge pull request from GHSA-xwh8-9p3f-3x45\n\n- Fix the specific case that caused panic.\n- Add panic handler around entire live query results handler. This will\n  prevent similar issues from causing crashes in the future.\n\nNote that other endpoints already have panic handling but this one is\nspecial due to the use of websockets.",
    "type_of_change": "Modification",
    "filename_of_changes": "service_campaigns.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 166: \t// add the \"host_hostname\" field to every row.",
        "// Line_Reference 167: \tmapHostnameRows := func(hostname string, rows []map[string]string) {",
        "// Line_Reference 168: \t\tfor _, row := range rows {",
        "// Line_Reference 169: \t\t\trow[\"host_hostname\"] = hostname",
        "// Line_Reference 233: \t\t\t\tmapHostnameRows(res.Host.HostName, res.Rows)"
    ]
}
