{
    "cve_id": "CVE-2020-15233",
    "cve_description": "ORY Fosite is a security first OAuth2 & OpenID Connect framework for Go. In Fosite from version 0.30.2 and before version 0.34.1, there is an issue in which an an attacker can override the registered redirect URL by performing an OAuth flow and requesting a redirect URL that is to the loopback adapter. Attackers can provide both custom URL query parameters to their loopback redirect URL, as well as actually overriding the host of the registered redirect URL. These attacks are only applicable in scenarios where the attacker has access over the loopback interface. This vulnerability has been patched in ORY Fosite v0.34.1.",
    "cve_publish_date": "2020-10-02",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "fix: make redirect URL checking more strict\n\nThe OAuth 2.0 Client's Redirect URL and the Redirect URL used in the OAuth 2.0 flow do not check if the query string is equal:\n\n1. Registering a client with allowed redirect URL `https://example.com/callback`\n2. Performing OAuth2 flow and requesting redirect URL `https://example.com/callback?bar=foo`\n3. Instead of an error, the browser is redirected to `https://example.com/callback?bar=foo` with a potentially successful OAuth2 response.\n\nAdditionally, matching Redirect URLs used `strings.ToLower` normalization:\n\n1. Registering a client with allowed redirect URL `https://example.com/callback`\n2. Performing OAuth2 flow and requesting redirect URL `https://example.com/CALLBACK`\n3. Instead of an error, the browser is redirected to `https://example.com/CALLBACK ` with a potentially successful OAuth2 response.\n\nThis patch addresses all of these issues and adds regression tests to keep the implementation secure in future releases.",
    "type_of_change": "Modification",
    "filename_of_changes": "authorize_helper_test.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "43",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 140: \t\t{",
        "// Line_Reference 141: \t\t\tclient:   &DefaultClient{RedirectURIs: []string{\"https://bar.Com/cb\"}},",
        "// Line_Reference 142: \t\t\turl:      \"https://bar.com/cb\",",
        "// Line_Reference 143: \t\t\tisError:  false,",
        "// Line_Reference 144: \t\t\texpected: \"https://bar.com/cb\",",
        "// Line_Reference 145: \t\t},",
        "// Line_Reference 146: \t\t{",
        "// Line_Reference 147: \t\t\tclient:   &DefaultClient{RedirectURIs: []string{\"https://bar.com/cb\"}},",
        "// Line_Reference 148: \t\t\turl:      \"https://bar.Com/cb\",",
        "// Line_Reference 149: \t\t\tisError:  false,",
        "// Line_Reference 150: \t\t\texpected: \"https://bar.Com/cb\",",
        "// Line_Reference 151: \t\t},",
        "// Line_Reference 160: \t\t\tisError:  false,",
        "// Line_Reference 171: \t\t\tisError:  false,",
        "// Line_Reference 182: \t\t\tisError:  false,",
        "// Line_Reference 188: \t\t\tisError:  false,",
        "// Line_Reference 199: \t\t\tisError:  false,",
        "// Line_Reference 205: \t\t\tisError:  false,",
        "// Line_Reference 220: \t\tassert.Equal(t, c.isError, err != nil, \"%d: %s\", k, err)"
    ]
}
