{
    "cve_id": "CVE-2014-9422",
    "cve_description": "The check_rpcsec_auth function in kadmin/server/kadm_rpc_svc.c in kadmind in MIT Kerberos 5 (aka krb5) through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 allows remote authenticated users to bypass a kadmin/* authorization check and obtain administrative access by leveraging access to a two-component principal with an initial \"kadmind\" substring, as demonstrated by a \"ka/x\" principal.",
    "cve_publish_date": "2015-02-19",
    "cwe_id": "CWE-284",
    "cwe_name": "Improper Access Control",
    "cwe_description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
    "commit_message": "Fix kadmind server validation [CVE-2014-9422]\n\n[MITKRB5-SA-2015-001] In kadmind's check_rpcsec_auth(), use\ndata_eq_string() instead of strncmp() to check components of the\nserver principal, so that we don't erroneously match left substrings\nof \"kadmin\", \"history\", or the realm.\n\nticket: 8057 (new)\ntarget_version: 1.13.1\ntags: pullup",
    "type_of_change": "Modification",
    "filename_of_changes": "kadm_rpc_svc.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 7: #include <k5-platform.h>",
        "// Line_Reference 299:      if (strncmp(handle->params.realm, realm->data, realm->length) == 0",
        "// Line_Reference 300: \t && strncmp(\"kadmin\", c1->data, c1->length) == 0) {",
        "// Line_Reference 301: ",
        "// Line_Reference 302: \t  if (strncmp(\"history\", c2->data, c2->length) == 0)",
        "// Line_Reference 303: \t       goto fail_princ;",
        "// Line_Reference 304: \t  else",
        "// Line_Reference 305: \t       success = 1;",
        "// Line_Reference 306:      }"
    ]
}
