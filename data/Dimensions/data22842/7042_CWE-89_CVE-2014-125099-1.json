{
    "cve_id": "CVE-2014-125099",
    "cve_description": "A vulnerability has been found in I Recommend This Plugin up to 3.7.2 on WordPress and classified as critical. Affected by this vulnerability is an unknown functionality of the file dot-irecommendthis.php. The manipulation leads to sql injection. The attack can be launched remotely. Upgrading to version 3.7.3 is able to address this issue. The identifier of the patch is 058b3ef5c7577bf557557904a53ecc8599b13649. It is recommended to upgrade the affected component. The identifier VDB-226309 was assigned to this vulnerability.",
    "cve_publish_date": "2023-04-20",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fixed a Possible SQL injection vulnerability reported by [Oskar Adin](https://github.com/osadi) and fixed by [Danny van Kooten](https://twitter.com/DannyvanKooten).\n\ngit-svn-id: https://plugins.svn.wordpress.org/i-recommend-this/trunk@996218 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "dot-irecommendthis.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "55",
    "number_of_lines_deleted_vulnerable_to_cve": "38",
    "vulnerable_lines": [
        "// Line_Reference 6:  * Version: 3.7.2",
        "// Line_Reference 674: \t\t    // get our variable from $atts",
        "// Line_Reference 675: \t\t    extract(shortcode_atts(array(",
        "// Line_Reference 676: \t\t        'container' => 'li',",
        "// Line_Reference 677: \t\t        'number' => '10',",
        "// Line_Reference 678: \t\t        'post_type' => 'post',",
        "// Line_Reference 679: \t\t        'year' => '',",
        "// Line_Reference 680: \t\t        'monthnum' => '',",
        "// Line_Reference 681: \t\t        'show_count' => '1',",
        "// Line_Reference 682: \t\t    ), $atts));",
        "// Line_Reference 684: \t\t    global $wpdb;",
        "// Line_Reference 686: \t\t    $request = \"SELECT * FROM $wpdb->posts, $wpdb->postmeta\";",
        "// Line_Reference 687: \t\t    $request .= \" WHERE $wpdb->posts.ID = $wpdb->postmeta.post_id\";",
        "// Line_Reference 689: \t\t    if ($year != '') {",
        "// Line_Reference 690: \t\t        $request .= \" AND YEAR(post_date) = '$year'\";",
        "// Line_Reference 691: \t\t    }",
        "// Line_Reference 693: \t\t    if ($monthnum != '') {",
        "// Line_Reference 694: \t\t        $request .= \" AND MONTH(post_date) = '$monthnum'\";",
        "// Line_Reference 695: \t\t    }",
        "// Line_Reference 697: \t\t    $request .= \" AND post_status='publish' AND post_type='$post_type' AND meta_key='_recommended'\";",
        "// Line_Reference 698: \t\t    $request .= \" ORDER BY $wpdb->postmeta.meta_value+0 DESC LIMIT $number\";",
        "// Line_Reference 699: \t\t    $posts = $wpdb->get_results($request);",
        "// Line_Reference 701: \t\t    $return = '';",
        "// Line_Reference 704: \t\t    foreach ($posts as $item) {",
        "// Line_Reference 705: \t\t        $post_title = stripslashes($item->post_title);",
        "// Line_Reference 706: \t\t        $permalink = get_permalink($item->ID);",
        "// Line_Reference 707: \t\t        $post_count = $item->meta_value;",
        "// Line_Reference 709: \t\t        $return .= '<' . $container . '>';",
        "// Line_Reference 710: \t\t        $return .= '<a href=\"' . $permalink . '\" title=\"' . $post_title.'\" rel=\"nofollow\">' . $post_title . '</a> ';",
        "// Line_Reference 712: \t\t        if ( $show_count == '1') {",
        "// Line_Reference 713: \t\t            $return .= '<span class=\"votes\">' . $post_count . '</span> ';",
        "// Line_Reference 714: \t\t        }",
        "// Line_Reference 716: \t\t        //$return .= get_the_post_thumbnail($item->ID, 'showcase-thumbnail');",
        "// Line_Reference 717: \t\t        $return .= '</' . $container . '>';",
        "// Line_Reference 719: \t\t    }",
        "// Line_Reference 720: \t\t    return $return;",
        "// Line_Reference 869: \t    $columns['likes'] = 'likes';",
        "// Line_Reference 886:     add_action('manage_posts_custom_column', 'dot_column_content', 10, 2);"
    ]
}
