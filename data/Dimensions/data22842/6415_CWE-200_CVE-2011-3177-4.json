{
    "cve_id": "CVE-2011-3177",
    "cve_description": "The YaST2 network created files with world readable permissions which could have allowed local users to read sensitive material out of network configuration files, like passwords for wireless networks.",
    "cve_publish_date": "2017-09-08",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "- ini-agent: added Write(.section_private.SECTION, BOOLEAN) (bnc#713661, CVE-2011-3177)\n- system agent: added  Write(.target.string, [filename, mode],  content)\n\nsvn merge -r66758:66764 http://svn.opensuse.org/svn/yast/branches/SuSE-Code-11-SP2-Branch/core\n\nsvn path=/trunk/core/; revision=67117",
    "type_of_change": "Modification",
    "filename_of_changes": "IniParser.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 968: \t\t\t// ensure that the directories exist",
        "// Line_Reference 969: \t\t\tPathname pn (filename);",
        "// Line_Reference 970: \t\t\tPathInfo::assert_dir (pn.dirname ());",
        "// Line_Reference 971: \t\t\tofstream of(filename.c_str());",
        "// Line_Reference 972: \t\t\tif (!of.good())",
        "// Line_Reference 973: \t\t\t{",
        "// Line_Reference 974: \t\t\t    bugs++;",
        "// Line_Reference 975: \t\t\t    y2error (\"Can not open file %s for write\", filename.c_str());",
        "// Line_Reference 976: \t\t\t    continue;",
        "// Line_Reference 977: \t\t\t}",
        "// Line_Reference 978: \t\t\twrite_helper (s, of, 0);",
        "// Line_Reference 979: \t\t\ts.clean();",
        "// Line_Reference 980: \t\t\tof.close ();",
        "// Line_Reference 1000: \t// ensure that the directories exist",
        "// Line_Reference 1001: \tPathname pn (file);",
        "// Line_Reference 1002: \tPathInfo::assert_dir (pn.dirname ());",
        "// Line_Reference 1003: \tofstream of(file.c_str());",
        "// Line_Reference 1004: \tif (!of.good())",
        "// Line_Reference 1005: \t{",
        "// Line_Reference 1006: \t    y2error (\"Can not open file %s for write\", file.c_str());",
        "// Line_Reference 1007: \t    return -1;",
        "// Line_Reference 1008: \t}",
        "// Line_Reference 1009: ",
        "// Line_Reference 1010: \twrite_helper (inifile, of, 0);",
        "// Line_Reference 1011: ",
        "// Line_Reference 1012: \tof.close();",
        "// Line_Reference 1015:     inifile.clean ();"
    ]
}
