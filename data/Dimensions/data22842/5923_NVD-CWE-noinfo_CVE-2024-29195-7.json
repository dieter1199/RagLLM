{
    "cve_id": "CVE-2024-29195",
    "cve_description": "The azure-c-shared-utility is a C library for AMQP/MQTT communication to Azure Cloud Services. This library may be used by the Azure IoT C SDK for communication between IoT Hub and IoT Hub devices. An attacker can cause an integer wraparound or under-allocation or heap buffer overflow due to vulnerabilities in parameter checking mechanism, by exploiting the buffer length parameter in Azure C SDK, which may lead to remote code execution. Requirements for RCE are 1. Compromised Azure account allowing malformed payloads to be sent to the device via IoT Hub service, 2. By passing IoT hub service max message payload limit of 128KB, and 3. Ability to overwrite code space with remote code. Fixed in commit https://github.com/Azure/azure-c-shared-utility/commit/1129147c38ac02ad974c4c701a1e01b2141b9fe2.",
    "cve_publish_date": "2024-03-26",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Add malloc size checks (#652)\n\n* Add malloc size checks\r\n\r\n* Update adapters/socketio_berkeley.c\r\n\r\nCo-authored-by: Valerie Avva Lim <54871851+vaavva@users.noreply.github.com>\r\n\r\n* Update adapters/string_utils.c\r\n\r\nCo-authored-by: Valerie Avva Lim <54871851+vaavva@users.noreply.github.com>\r\n\r\n* PR review\r\n\r\n---------\r\n\r\nCo-authored-by: Valerie Avva Lim <54871851+vaavva@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "socketio_berkeley.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "47",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 129:                 if ((result = malloc(sizeof(char) * (strlen((char*)value) + 1))) == NULL)",
        "// Line_Reference 321:     else if ((result->name = (char*)malloc(sizeof(char) * (strlen(ifr->ifr_name) + 1))) == NULL)",
        "// Line_Reference 334:         if ((result->mac_address = (char*)malloc(sizeof(char) * MAC_ADDRESS_STRING_LENGTH)) == NULL)",
        "// Line_Reference 336:             LogError(\"failed formatting mac address (malloc failed)\");",
        "// Line_Reference 352:         else if ((result->ip_address = (char*)malloc(sizeof(char) * (strlen(ip_address) + 1))) == NULL)",
        "// Line_Reference 745:                     result->hostname = (char*)malloc(strlen(socket_io_config->hostname) + 1);",
        "// Line_Reference 746:                     if (result->hostname != NULL)",
        "// Line_Reference 748:                         (void)strcpy(result->hostname, socket_io_config->hostname);",
        "// Line_Reference 1213:             else if ((socket_io_instance->target_mac_address = (char*)malloc(sizeof(char) * (strlen(value) + 1))) == NULL)"
    ]
}
