{
    "cve_id": "CVE-2015-1334",
    "cve_description": "attach.c in LXC 1.1.2 and earlier uses the proc filesystem in a container, which allows local container users to escape AppArmor or SELinux confinement by mounting a proc filesystem with a crafted (1) AppArmor profile or (2) SELinux label.",
    "cve_publish_date": "2015-08-12",
    "cwe_id": "CWE-17",
    "cwe_name": "DEPRECATED: Code",
    "cwe_description": "This entry has been deprecated.  It was originally used for organizing the Development View (CWE-699) and some other views, but it introduced unnecessary complexity and depth to the resulting tree.",
    "commit_message": "CVE-2015-1334: Don't use the container's /proc during attach\n\nA user could otherwise over-mount /proc and prevent the apparmor profile\nor selinux label from being written which combined with a modified\n/bin/sh or other commonly used binary would lead to unconfined code\nexecution.\n\nReported-by: Roman Fiedler\nSigned-off-by: St√©phane Graber <stgraber@ubuntu.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "attach.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "93",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 863: \t\t\t.exec_payload = exec_payload",
        "// Line_Reference 1041: \tif ((options->namespaces & CLONE_NEWNS) && (options->attach_flags & LXC_ATTACH_LSM)) {",
        "// Line_Reference 1043: \t\tint proc_mounted;",
        "// Line_Reference 1046: \t\tproc_mounted = mount_proc_if_needed(\"/\");",
        "// Line_Reference 1047: \t\tif (proc_mounted == -1) {",
        "// Line_Reference 1048: \t\t\tERROR(\"Error mounting a sane /proc\");",
        "// Line_Reference 1049: \t\t\trexit(-1);",
        "// Line_Reference 1050: \t\t}",
        "// Line_Reference 1051: \t\tret = lsm_process_label_set(init_ctx->lsm_label,",
        "// Line_Reference 1052: \t\t\t\tinit_ctx->container->lxc_conf, 0, on_exec);",
        "// Line_Reference 1053: \t\tif (proc_mounted)",
        "// Line_Reference 1054: \t\t\tumount(\"/proc\");",
        "// Line_Reference 1055: \t\tif (ret < 0) {"
    ]
}
