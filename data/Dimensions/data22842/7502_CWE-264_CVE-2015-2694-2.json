{
    "cve_id": "CVE-2015-2694",
    "cve_description": "The kdcpreauth modules in MIT Kerberos 5 (aka krb5) 1.12.x and 1.13.x before 1.13.2 do not properly track whether a client's request has been validated, which allows remote attackers to bypass an intended preauthentication requirement by providing (1) zero bytes of data or (2) an arbitrary realm name, related to plugins/preauth/otp/main.c and plugins/preauth/pkinit/pkinit_srv.c.",
    "cve_publish_date": "2015-05-25",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Prevent requires_preauth bypass [CVE-2015-2694]\n\nIn the OTP kdcpreauth module, don't set the TKT_FLG_PRE_AUTH bit until\nthe request is successfully verified.  In the PKINIT kdcpreauth\nmodule, don't respond with code 0 on empty input or an unconfigured\nrealm.  Together these bugs could cause the KDC preauth framework to\nerroneously treat a request as pre-authenticated.\n\nCVE-2015-2694:\n\nIn MIT krb5 1.12 and later, when the KDC is configured with PKINIT\nsupport, an unauthenticated remote attacker can bypass the\nrequires_preauth flag on a client principal and obtain a ciphertext\nencrypted in the principal's long-term key.  This ciphertext could be\nused to conduct an off-line dictionary attack against the user's\npassword.\n\n    CVSSv2 Vector: AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C\n\nticket: 8160 (new)\ntarget_version: 1.13.2\ntags: pullup\nsubject: requires_preauth bypass in PKINIT-enabled KDC [CVE-2015-2694]",
    "type_of_change": "Modification",
    "filename_of_changes": "pkinit_srv.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 304:         (*respond)(arg, 0, NULL, NULL, NULL);",
        "// Line_Reference 316:         (*respond)(arg, 0, NULL, NULL, NULL);"
    ]
}
