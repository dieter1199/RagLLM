{
    "cve_id": "CVE-2018-1000089",
    "cve_description": "Anymail django-anymail version version 0.2 through 1.3 contains a CWE-532, CWE-209 vulnerability in WEBHOOK_AUTHORIZATION setting value that can result in An attacker with access to error logs could fabricate email tracking events. This attack appear to be exploitable via If you have exposed your Django error reports, an attacker could discover your ANYMAIL_WEBHOOK setting and use this to post fabricated or malicious Anymail tracking/inbound events to your app. This vulnerability appears to have been fixed in v1.4.",
    "cve_publish_date": "2018-03-13",
    "cwe_id": "CWE-532",
    "cwe_name": "Insertion of Sensitive Information into Log File",
    "cwe_description": "Information written to log files can be of a sensitive nature and give valuable guidance to an attacker or expose sensitive user information.",
    "commit_message": "Security: rename WEBHOOK_AUTHORIZATION --> WEBHOOK_SECRET\n\nThis fixes a low severity security issue affecting Anymail v0.2--v1.3.\n\nDjango error reporting includes the value of your Anymail\nWEBHOOK_AUTHORIZATION setting. In a properly-configured deployment,\nthis should not be cause for concern. But if you have somehow exposed\nyour Django error reports (e.g., by mis-deploying with DEBUG=True or by\nsending error reports through insecure channels), anyone who gains\naccess to those reports could discover your webhook shared secret. An\nattacker could use this to post fabricated or malicious Anymail\ntracking/inbound events to your app, if you are using those Anymail\nfeatures.\n\nThe fix renames Anymail's webhook shared secret setting so that\nDjango's error reporting mechanism will [sanitize][0] it.\n\nIf you are using Anymail's event tracking and/or inbound webhooks, you\nshould upgrade to this release and change \"WEBHOOK_AUTHORIZATION\" to\n\"WEBHOOK_SECRET\" in the ANYMAIL section of your settings.py. You may\nalso want to [rotate the shared secret][1] value, particularly if you\nhave ever exposed your Django error reports to untrusted individuals.\n\nIf you are only using Anymail's EmailBackends for sending email and\nhave not set up Anymail's webhooks, this issue does not affect you.\n\nThe old WEBHOOK_AUTHORIZATION setting is still allowed in this release,\nbut will issue a system-check warning when running most Django\nmanagement commands. It will be removed completely in a near-future\nrelease, as a breaking change.\n\nThanks to Charlie DeTar (@yourcelf) for responsibly reporting this\nsecurity issue through private channels.\n\n[0]: https://docs.djangoproject.com/en/stable/ref/settings/#debug\n[1]: https://anymail.readthedocs.io/en/1.4/tips/securing_webhooks/#use-a-shared-authorization-secret",
    "type_of_change": "Modification",
    "filename_of_changes": "test_mandrill_webhooks.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 90:     @override_settings(ANYMAIL={})  # clear WEBHOOK_AUTHORIZATION from WebhookTestCase",
        "// Line_Reference 102:             \"WEBHOOK_AUTHORIZATION\": \"abcde:12345\",",
        "// Line_Reference 114:     @override_settings(ANYMAIL={'WEBHOOK_AUTHORIZATION': ['cred1:pass1', 'cred2:pass2']})"
    ]
}
