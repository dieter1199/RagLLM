{
    "cve_id": "CVE-2022-39379",
    "cve_description": "Fluentd collects events from various data sources and writes them to files, RDBMS, NoSQL, IaaS, SaaS, Hadoop and so on. A remote code execution (RCE) vulnerability in non-default configurations of Fluentd allows unauthenticated attackers to execute arbitrary code via specially crafted JSON payloads. Fluentd setups are only affected if the environment variable `FLUENT_OJ_OPTION_MODE` is explicitly set to `object`. Please note: The option FLUENT_OJ_OPTION_MODE was introduced in Fluentd version 1.13.2. Earlier versions of Fluentd are not affected by this vulnerability. This issue was patched in version 1.15.3. As a workaround do not use `FLUENT_OJ_OPTION_MODE=object`.",
    "cve_publish_date": "2022-11-02",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "Remove `object` from the available list of `FLUENT_OJ_OPTION_MODE`\n\nThere is less benefit by this option in actual, and it will instroduce\nserious security risk since it can execute arbitrary Ruby code.\nWe remove it since keeping it secure is difficult.\n\nref: GHSL-2022-067\n\nSigned-off-by: Takuro Ashie <ashie@clear-code.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "oj_options.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 14:       'mode': %i[strict null compat json rails object custom]"
    ]
}
