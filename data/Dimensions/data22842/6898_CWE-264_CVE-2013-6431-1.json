{
    "cve_id": "CVE-2013-6431",
    "cve_description": "The fib6_add function in net/ipv6/ip6_fib.c in the Linux kernel before 3.11.5 does not properly implement error-code encoding, which allows local users to cause a denial of service (NULL pointer dereference and system crash) by leveraging the CAP_NET_ADMIN capability for an IPv6 SIOCADDRT ioctl call.",
    "cve_publish_date": "2013-12-09",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "net: fib: fib6_add: fix potential NULL pointer dereference\n\nWhen the kernel is compiled with CONFIG_IPV6_SUBTREES, and we return\nwith an error in fn = fib6_add_1(), then error codes are encoded into\nthe return pointer e.g. ERR_PTR(-ENOENT). In such an error case, we\nwrite the error code into err and jump to out, hence enter the if(err)\ncondition. Now, if CONFIG_IPV6_SUBTREES is enabled, we check for:\n\n  if (pn != fn && pn->leaf == rt)\n    ...\n  if (pn != fn && !pn->leaf && !(pn->fn_flags & RTN_RTINFO))\n    ...\n\nSince pn is NULL and fn is f.e. ERR_PTR(-ENOENT), then pn != fn\nevaluates to true and causes a NULL-pointer dereference on further\nchecks on pn. Fix it, by setting both NULL in error case, so that\npn != fn already evaluates to false and no further dereference\ntakes place.\n\nThis was first correctly implemented in 4a287eba2 (\"IPv6 routing,\nNLM_F_* flag support: REPLACE and EXCL flags support, warn about\nmissing CREATE flag\"), but the bug got later on introduced by\n188c517a0 (\"ipv6: return errno pointers consistently for fib6_add_1()\").\n\nSigned-off-by: Daniel Borkmann <dborkman@redhat.com>\nCc: Lin Ming <mlin@ss.pku.edu.cn>\nCc: Matti Vaittinen <matti.vaittinen@nsn.com>\nCc: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Matti Vaittinen <matti.vaittinen@nsn.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip6_fib.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 828: "
    ]
}
