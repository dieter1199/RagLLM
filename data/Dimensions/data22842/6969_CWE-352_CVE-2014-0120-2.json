{
    "cve_id": "CVE-2014-0120",
    "cve_description": "Cross-site request forgery (CSRF) vulnerability in the admin terminal in Hawt.io allows remote attackers to hijack the authentication of arbitrary users for requests that run commands on the Karaf server, as demonstrated by running \"shutdown -f.\"",
    "cve_publish_date": "2017-12-29",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Add a LoginTokenServlet that plugins can use to fetch a token, and let's use it in hawtio-karaf-terminal.  Also handle cases where the terminal scope gets created a couple times.",
    "type_of_change": "Modification",
    "filename_of_changes": "TerminalServlet.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 11: import javax.security.auth.Subject;",
        "// Line_Reference 19: import java.security.AccessControlContext;",
        "// Line_Reference 20: import java.security.AccessController;",
        "// Line_Reference 48:         if (session == null) {",
        "// Line_Reference 49:           AccessControlContext acc = AccessController.getContext();",
        "// Line_Reference 50:           Subject subject = Subject.getSubject(acc);",
        "// Line_Reference 51:           if (subject == null) {",
        "// Line_Reference 54:           }",
        "// Line_Reference 55:           session = request.getSession(true);",
        "// Line_Reference 56:           session.setAttribute(\"subject\", subject);",
        "// Line_Reference 57:         } else {",
        "// Line_Reference 58:           Subject subject = (Subject) session.getAttribute(\"subject\");",
        "// Line_Reference 59:           if (subject == null) {",
        "// Line_Reference 60:             session.invalidate();",
        "// Line_Reference 63:           }"
    ]
}
