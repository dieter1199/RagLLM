{
    "cve_id": "CVE-2024-27306",
    "cve_description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. A XSS vulnerability exists on index pages for static file handling. This vulnerability is fixed in 3.9.4. We have always recommended using a reverse proxy server (e.g. nginx) for serving static files. Users following the recommendation are unaffected. Other users can disable `show_index` if unable to upgrade.",
    "cve_publish_date": "2024-04-18",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Escape filenames and paths in HTML when generating index pages (#8317) (#8319)\n\nCo-authored-by: J. Nick Koston <nick@koston.org>\r\n(cherry picked from commit ffbc43233209df302863712b511a11bdb6001b0f)",
    "type_of_change": "Modification",
    "filename_of_changes": "test_web_urldispatcher.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "110",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 17:     \"show_index,status,prefix,data\",",
        "// Line_Reference 19:         pytest.param(False, 403, \"/\", None, id=\"index_forbidden\"),",
        "// Line_Reference 24:             b\"<html>\\n<head>\\n<title>Index of /.</title>\\n\"",
        "// Line_Reference 25:             b\"</head>\\n<body>\\n<h1>Index of /.</h1>\\n<ul>\\n\"",
        "// Line_Reference 26:             b'<li><a href=\"/my_dir\">my_dir/</a></li>\\n'",
        "// Line_Reference 27:             b'<li><a href=\"/my_file\">my_file</a></li>\\n'",
        "// Line_Reference 28:             b\"</ul>\\n</body>\\n</html>\",",
        "// Line_Reference 29:             id=\"index_root\",",
        "// Line_Reference 35:             b\"<html>\\n<head>\\n<title>Index of /.</title>\\n\"",
        "// Line_Reference 36:             b\"</head>\\n<body>\\n<h1>Index of /.</h1>\\n<ul>\\n\"",
        "// Line_Reference 37:             b'<li><a href=\"/static/my_dir\">my_dir/</a></li>\\n'",
        "// Line_Reference 38:             b'<li><a href=\"/static/my_file\">my_file</a></li>\\n'",
        "// Line_Reference 39:             b\"</ul>\\n</body>\\n</html>\",",
        "// Line_Reference 75:     async with await client.get(prefix) as r:"
    ]
}
