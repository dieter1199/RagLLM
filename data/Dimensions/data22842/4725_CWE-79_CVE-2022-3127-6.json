{
    "cve_id": "CVE-2022-3127",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-05",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Minimal.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "64",
    "vulnerable_lines": [
        "// Line_Reference 775:         ui.actions.get('editDiagram').label = mxResources.get('formatXml') + '...';",
        "// Line_Reference 776:         ui.actions.get('createShape').label = mxResources.get('shape') + '...';",
        "// Line_Reference 777:         ui.actions.get('outline').label = mxResources.get('outline') + '...';",
        "// Line_Reference 778:         ui.actions.get('layers').label = mxResources.get('layers') + '...';",
        "// Line_Reference 779:         ui.actions.get('tags').label = mxResources.get('tags') + '...';",
        "// Line_Reference 780: \t\tui.actions.get('comments').label = mxResources.get('comments') + '...';",
        "// Line_Reference 781: ",
        "// Line_Reference 782:         var toggleSketchModeAction = ui.actions.put('toggleSketchMode', new Action(mxResources.get('sketch'), function(e)",
        "// Line_Reference 783:         {",
        "// Line_Reference 784: \t\t\tui.setSketchMode(!Editor.sketchMode);",
        "// Line_Reference 785:         }));",
        "// Line_Reference 786: ",
        "// Line_Reference 787: \t\ttoggleSketchModeAction.setToggleAction(true);",
        "// Line_Reference 788: \t\ttoggleSketchModeAction.setSelectedCallback(function() { return Editor.sketchMode; });",
        "// Line_Reference 789: ",
        "// Line_Reference 822:         var action = ui.actions.put('toggleFormat', new Action(mxResources.get('format') + '...', function()",
        "// Line_Reference 826: \t\taction.shortcut = ui.actions.get('formatPanel').shortcut;",
        "// Line_Reference 886: \t\t\t\tui.menus.addMenuItems(menu, ['save', 'rename',",
        "// Line_Reference 887: \t\t\t\t\t'makeCopy', 'moveToFolder'], parent);",
        "// Line_Reference 891: \t\t\t\tui.menus.addMenuItems(menu, ['save', 'saveAs', '-', 'rename'], parent);",
        "// Line_Reference 906: \t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 907: ",
        "// Line_Reference 908: \t\t\tif (file != null)",
        "// Line_Reference 910: \t\t\t\tif (file.isRevisionHistorySupported())",
        "// Line_Reference 911: \t\t\t\t{",
        "// Line_Reference 912: \t\t\t\t\tui.menus.addMenuItems(menu, ['revisionHistory'], parent);",
        "// Line_Reference 913: \t\t\t\t}",
        "// Line_Reference 914: ",
        "// Line_Reference 915: \t\t\t\tif (file.constructor == DriveFile)",
        "// Line_Reference 916: \t\t\t\t{",
        "// Line_Reference 917: \t\t\t\t\tui.menus.addMenuItems(menu, ['openFolder'], parent);",
        "// Line_Reference 918: \t\t\t\t}",
        "// Line_Reference 919: ",
        "// Line_Reference 920: \t\t\t\tif (!mxClient.IS_CHROMEAPP && !EditorUi.isElectronApp &&",
        "// Line_Reference 921: \t\t\t\t\t(file.constructor != LocalFile || file.fileHandle != null))",
        "// Line_Reference 922: \t\t\t\t{",
        "// Line_Reference 923: \t\t\t\t\tui.menus.addMenuItems(menu, ['synchronize'], parent);",
        "// Line_Reference 924: \t\t\t\t}",
        "// Line_Reference 927: \t\t\tui.menus.addMenuItems(menu, ['autosave'], parent);",
        "// Line_Reference 928: ",
        "// Line_Reference 931: \t\t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 932: ",
        "// Line_Reference 933: \t\t\t\tif (urlParams['sketch'] == '1' && ui.commentsSupported())",
        "// Line_Reference 934: \t\t\t\t{",
        "// Line_Reference 935: \t\t\t\t\tui.menus.addMenuItems(menu, ['comments'], parent);",
        "// Line_Reference 936: \t\t\t\t}",
        "// Line_Reference 937: ",
        "// Line_Reference 1031: ",
        "// Line_Reference 1033: ",
        "// Line_Reference 1043: \t\t\tif ((urlParams['embed'] == '1' || urlParams['sketch'] != '1' ||",
        "// Line_Reference 1044: \t\t\t\turlParams['noFileMenu'] == '1') && ui.commentsSupported())",
        "// Line_Reference 1046: \t\t\t\tui.menus.addMenuItems(menu, ['-', 'comments'], parent);",
        "// Line_Reference 1049: \t\t\tui.menus.addMenuItems(menu, ['-', 'findReplace',",
        "// Line_Reference 1050: \t\t\t\t'layers', 'tags', '-', 'pageSetup'], parent);",
        "// Line_Reference 1155: \t\t\tthis.addMenuItems(menu, ['-', 'pageScale', '-', 'ruler'], parent);",
        "// Line_Reference 1328: \t\t\tthis.formatWindow.window.setClosable(false);",
        "// Line_Reference 1338: \t\t\t\t\tthis.div.style.width = '90px';",
        "// Line_Reference 1339: \t\t\t\t\tthis.table.style.width = '90px';",
        "// Line_Reference 1340: \t\t\t\t\tthis.div.style.left = parseInt(this.div.style.left) + 150 + 'px';",
        "// Line_Reference 1344: ",
        "// Line_Reference 1345: \t\t\t\t\tthis.div.style.width = '240px';",
        "// Line_Reference 1346: \t\t\t\t\tthis.table.style.width = '240px';",
        "// Line_Reference 1347: \t\t\t\t\tthis.div.style.left = Math.max(0, parseInt(this.div.style.left) - 150) + 'px';",
        "// Line_Reference 1755: \t\t\tui.menus.addMenuItems(menu, ['outline', '-', 'fullscreen', 'toggleDarkMode'], parent);"
    ]
}
