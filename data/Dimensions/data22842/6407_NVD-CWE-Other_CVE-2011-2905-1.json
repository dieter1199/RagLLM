{
    "cve_id": "CVE-2011-2905",
    "cve_description": "Untrusted search path vulnerability in the perf_config function in tools/perf/util/config.c in perf, as distributed in the Linux kernel before 3.1, allows local users to overwrite arbitrary files via a crafted config file in the current working directory.",
    "cve_publish_date": "2013-03-01",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "perf tools: do not look at ./config for configuration\n\nIn addition to /etc/perfconfig and $HOME/.perfconfig, perf looks for\nconfiguration in the file ./config, imitating git which looks at\n$GIT_DIR/config.  If ./config is not a perf configuration file, it\nfails, or worse, treats it as a configuration file and changes behavior\nin some unexpected way.\n\n\"config\" is not an unusual name for a file to be lying around and perf\ndoes not have a private directory dedicated for its own use, so let's\njust stop looking for configuration in the cwd.  Callers needing\ncontext-sensitive configuration can use the PERF_CONFIG environment\nvariable.\n\nRequested-by: Christian Ohm <chr.ohm@gmx.net>\nCc: 632923@bugs.debian.org\nCc: Ben Hutchings <ben@decadent.org.uk>\nCc: Christian Ohm <chr.ohm@gmx.net>\nCc: Ingo Molnar <mingo@elte.hu>\nCc: Paul Mackerras <paulus@samba.org>\nCc: Peter Zijlstra <a.p.zijlstra@chello.nl>\nLink: http://lkml.kernel.org/r/20110805165838.GA7237@elie.gateway.2wire.net\nSigned-off-by: Jonathan Nieder <jrnieder@gmail.com>\nSigned-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "config.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 402: \tchar *repo_config = NULL;",
        "// Line_Reference 424: \trepo_config = perf_pathdup(\"config\");",
        "// Line_Reference 425: \tif (!access(repo_config, R_OK)) {",
        "// Line_Reference 426: \t\tret += perf_config_from_file(fn, repo_config, data);",
        "// Line_Reference 427: \t\tfound += 1;",
        "// Line_Reference 428: \t}",
        "// Line_Reference 429: \tfree(repo_config);"
    ]
}
