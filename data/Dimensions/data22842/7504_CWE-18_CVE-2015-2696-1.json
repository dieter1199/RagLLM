{
    "cve_id": "CVE-2015-2696",
    "cve_description": "lib/gssapi/krb5/iakerb.c in MIT Kerberos 5 (aka krb5) before 1.14 relies on an inappropriate context handle, which allows remote attackers to cause a denial of service (incorrect pointer read and process crash) via a crafted IAKERB packet that is mishandled during a gss_inquire_context call.",
    "cve_publish_date": "2015-11-09",
    "cwe_id": "CWE-18",
    "cwe_name": "DEPRECATED: Source Code",
    "cwe_description": "This entry has been deprecated.  It was originally used for organizing the Development View (CWE-699) and some other views, but it introduced unnecessary complexity and depth to the resulting tree.",
    "commit_message": "Fix IAKERB context aliasing bugs [CVE-2015-2696]\n\nThe IAKERB mechanism currently replaces its context handle with the\nkrb5 mechanism handle upon establishment, under the assumption that\nmost GSS functions are only called after context establishment.  This\nassumption is incorrect, and can lead to aliasing violations for some\nprograms.  Maintain the IAKERB context structure after context\nestablishment and add new IAKERB entry points to refer to it with that\ntype.  Add initiate and established flags to the IAKERB context\nstructure for use in gss_inquire_context() prior to context\nestablishment.\n\nCVE-2015-2696:\n\nIn MIT krb5 1.9 and later, applications which call\ngss_inquire_context() on a partially-established IAKERB context can\ncause the GSS-API library to read from a pointer using the wrong type,\ngenerally causing a process crash.  Java server applications using the\nnative JGSS provider are vulnerable to this bug.  A carefully crafted\nIAKERB packet might allow the gss_inquire_context() call to succeed\nwith attacker-determined results, but applications should not make\naccess control decisions based on gss_inquire_context() results prior\nto context establishment.\n\n    CVSSv2 Vector: AV:N/AC:M/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C\n\n[ghudson@mit.edu: several bugfixes, style changes, and edge-case\nbehavior changes; commit message and CVE description]\n\nticket: 8244\ntarget_version: 1.14\ntags: pullup",
    "type_of_change": "Modification",
    "filename_of_changes": "gssapi_krb5.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "94",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 354: static OM_uint32 KRB5_CALLCONV",
        "// Line_Reference 468: static OM_uint32 KRB5_CALLCONV",
        "// Line_Reference 937:     struct gss_config iakerb_mechanism = krb5_mechanism;",
        "// Line_Reference 938: ",
        "// Line_Reference 939:     /* IAKERB mechanism mirrors krb5, but with different context SPIs */",
        "// Line_Reference 940:     iakerb_mechanism.gss_accept_sec_context = iakerb_gss_accept_sec_context;",
        "// Line_Reference 941:     iakerb_mechanism.gss_init_sec_context   = iakerb_gss_init_sec_context;",
        "// Line_Reference 942:     iakerb_mechanism.gss_delete_sec_context = iakerb_gss_delete_sec_context;",
        "// Line_Reference 943:     iakerb_mechanism.gss_acquire_cred       = iakerb_gss_acquire_cred;",
        "// Line_Reference 944:     iakerb_mechanism.gssspi_acquire_cred_with_password",
        "// Line_Reference 945:                                     = iakerb_gss_acquire_cred_with_password;"
    ]
}
