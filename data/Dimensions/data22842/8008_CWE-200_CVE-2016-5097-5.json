{
    "cve_id": "CVE-2016-5097",
    "cve_description": "phpMyAdmin before 4.6.2 places tokens in query strings and does not arrange for them to be stripped before external navigation, which allows remote attackers to obtain sensitive information by reading (1) HTTP requests or (2) server logs.",
    "cve_publish_date": "2016-07-05",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Improve handling of logout\n\n- add separate script for handling logout\n- no longer require old_usr for all authentication methods\n  (this avoids potential information leak)\n- require valid token for logout\n\nSigned-off-by: Michal Čihař <michal@cihar.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "AuthenticationSignon.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 31:         } elseif (!empty($_REQUEST['old_usr'])",
        "// Line_Reference 32:             && !empty($GLOBALS['cfg']['Server']['LogoutURL'])",
        "// Line_Reference 33:         ) {",
        "// Line_Reference 34:             /* Perform logout to custom URL */",
        "// Line_Reference 35:             PMA_sendHeaderLocation($GLOBALS['cfg']['Server']['LogoutURL']);",
        "// Line_Reference 85:         /* Are we requested to do logout? */",
        "// Line_Reference 86:         $do_logout = !empty($_REQUEST['old_usr']);",
        "// Line_Reference 87: ",
        "// Line_Reference 120:                 if ($do_logout) {",
        "// Line_Reference 121:                     $PHP_AUTH_USER = '';",
        "// Line_Reference 122:                 } else {",
        "// Line_Reference 123:                     $PHP_AUTH_USER = $_SESSION['PMA_single_signon_user'];",
        "// Line_Reference 124:                 }",
        "// Line_Reference 127:                 if ($do_logout) {",
        "// Line_Reference 128:                     $PHP_AUTH_PW = '';",
        "// Line_Reference 129:                 } else {",
        "// Line_Reference 130:                     $PHP_AUTH_PW = $_SESSION['PMA_single_signon_password'];",
        "// Line_Reference 131:                 }"
    ]
}
