{
    "cve_id": "CVE-2017-9229",
    "cve_description": "An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A SIGSEGV occurs in left_adjust_char_head() during regular expression compilation. Invalid handling of reg->dmax in forward_search_range() could result in an invalid pointer dereference, normally as an immediate denial-of-service condition.",
    "cve_publish_date": "2017-05-24",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "fix #59 : access to invalid address by reg->dmax value",
    "type_of_change": "Modification",
    "filename_of_changes": "regexec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 3238:         *low = p - reg->dmax;",
        "// Line_Reference 3239:         if (*low > s) {",
        "// Line_Reference 3240:           *low = onigenc_get_right_adjust_char_head_with_prev(reg->enc, s,",
        "// Line_Reference 3241:                                           *low, (const UChar** )low_prev);",
        "// Line_Reference 3242:           if (low_prev && IS_NULL(*low_prev))",
        "// Line_Reference 3243:             *low_prev = onigenc_get_prev_char_head(reg->enc,",
        "// Line_Reference 3244:                                                    (pprev ? pprev : s), *low);",
        "// Line_Reference 3247:           if (low_prev)",
        "// Line_Reference 3248:             *low_prev = onigenc_get_prev_char_head(reg->enc,",
        "// Line_Reference 3249:                                                    (pprev ? pprev : str), *low);"
    ]
}
