{
    "cve_id": "CVE-2016-2069",
    "cve_description": "Race condition in arch/x86/mm/tlb.c in the Linux kernel before 4.4.1 allows local users to gain privileges by triggering access to a paging structure by a different CPU.",
    "cve_publish_date": "2016-04-27",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "x86/mm: Add barriers and document switch_mm()-vs-flush synchronization\n\nWhen switch_mm() activates a new PGD, it also sets a bit that\ntells other CPUs that the PGD is in use so that TLB flush IPIs\nwill be sent.  In order for that to work correctly, the bit\nneeds to be visible prior to loading the PGD and therefore\nstarting to fill the local TLB.\n\nDocument all the barriers that make this work correctly and add\na couple that were missing.\n\nSigned-off-by: Andy Lutomirski <luto@kernel.org>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Andy Lutomirski <luto@amacapital.net>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Brian Gerst <brgerst@gmail.com>\nCc: Dave Hansen <dave.hansen@linux.intel.com>\nCc: Denys Vlasenko <dvlasenk@redhat.com>\nCc: H. Peter Anvin <hpa@zytor.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Rik van Riel <riel@redhat.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: linux-mm@kvack.org\nCc: stable@vger.kernel.org\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "tlb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 191: \tif (current->active_mm != mm)",
        "// Line_Reference 231: \t\tif (current->mm)",
        "// Line_Reference 233: \t\telse"
    ]
}
