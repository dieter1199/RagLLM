{
    "cve_id": "CVE-2016-10009",
    "cve_description": "Untrusted search path vulnerability in ssh-agent.c in ssh-agent in OpenSSH before 7.4 allows remote attackers to execute arbitrary local PKCS#11 modules by leveraging control over a forwarded agent-socket.",
    "cve_publish_date": "2017-01-05",
    "cwe_id": "CWE-426",
    "cwe_name": "Untrusted Search Path",
    "cwe_description": "The product searches for critical resources using an externally-supplied search path that can point to resources that are not under the product's direct control.",
    "commit_message": "add a whitelist of paths from which ssh-agent will load (via\nssh-pkcs11-helper) a PKCS#11 module; ok markus@",
    "type_of_change": "Modification",
    "filename_of_changes": "ssh-agent.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 1: /* $OpenBSD: ssh-agent.c,v 1.214 2016/09/12 01:22:38 deraadt Exp $ */",
        "// Line_Reference 727: \tchar *provider = NULL, *pin;",
        "// Line_Reference 762: \tcount = pkcs11_add_provider(provider, pin, &keys);",
        "// Line_Reference 770: \t\t\tid->provider = xstrdup(provider);",
        "// Line_Reference 771: \t\t\tid->comment = xstrdup(provider); /* XXX */",
        "// Line_Reference 1160: \t    \"                 [-t life] [command [arg ...]]\\n\"",
        "// Line_Reference 1194: \twhile ((ch = getopt(ac, av, \"cDdksE:a:t:\")) != -1) {",
        "// Line_Reference 1388: \tif (pledge(\"stdio cpath unix id proc exec\", NULL) == -1)"
    ]
}
