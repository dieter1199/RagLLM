{
    "cve_id": "CVE-2017-7481",
    "cve_description": "Ansible before versions 2.3.1.0 and 2.4.0.0 fails to properly mark lookup-plugin results as unsafe. If an attacker could control the results of lookup() calls, they could inject Unicode strings to be parsed by the jinja2 templating system, resulting in code execution. By default, the jinja2 templating language is now marked as 'unsafe' and is not evaluated.",
    "cve_publish_date": "2018-07-19",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Fixing security issue with lookup returns not tainting the jinja2 environment\n\nCVE-2017-7481\n\nLookup returns wrap the result in unsafe, however when used through the\nstandard templar engine, this does not result in the jinja2 environment being\nmarked as unsafe as a whole. This means the lookup result looses the unsafe\nprotection and may become simple unicode strings, which can result in bad\nthings being re-templated.\n\nThis also adds a global lookup param and cfg options for lookups to allow\nunsafe returns, so users can force the previous (insecure) behavior.",
    "type_of_change": "Modification",
    "filename_of_changes": "__init__.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 591:             if ran:",
        "// Line_Reference 659:             new_context = t.new_context(jvars, shared=True)"
    ]
}
