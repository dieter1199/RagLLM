{
    "cve_id": "CVE-2022-31173",
    "cve_description": "Juniper is a GraphQL server library for Rust. Affected versions of Juniper are vulnerable to uncontrolled recursion resulting in a program crash. This issue has been addressed in version 0.15.10. Users are advised to upgrade. Users unable to upgrade should limit the recursion depth manually.",
    "cve_publish_date": "2022-08-01",
    "cwe_id": "CWE-674",
    "cwe_name": "Uncontrolled Recursion",
    "cwe_description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
    "commit_message": "Backport CVE-2022-31173 fix from GHSA-4rx6-g5vg-5f3j\n\nCo-authored-by: ilslv <ilya.solovyiov@gmail.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "no_unused_fragments.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 10: #[derive(Debug, Clone, PartialEq, Eq, Hash)]",
        "// Line_Reference 16: pub struct NoUnusedFragments<'a> {",
        "// Line_Reference 17:     spreads: HashMap<Scope<'a>, Vec<&'a str>>,",
        "// Line_Reference 18:     defined_fragments: HashSet<Spanning<&'a str>>,",
        "// Line_Reference 19:     current_scope: Option<Scope<'a>>,",
        "// Line_Reference 20: }",
        "// Line_Reference 21: ",
        "// Line_Reference 31:     fn find_reachable_fragments(&self, from: &Scope<'a>, result: &mut HashSet<&'a str>) {",
        "// Line_Reference 32:         if let Scope::Fragment(name) = *from {",
        "// Line_Reference 34:                 return;",
        "// Line_Reference 40:         if let Some(spreads) = self.spreads.get(from) {",
        "// Line_Reference 41:             for spread in spreads {",
        "// Line_Reference 42:                 self.find_reachable_fragments(&Scope::Fragment(spread), result)",
        "// Line_Reference 43:             }",
        "// Line_Reference 44:         }",
        "// Line_Reference 62:                 self.find_reachable_fragments(&Scope::Operation(op_name), &mut reachable);",
        "// Line_Reference 99:                 .entry(scope.clone())"
    ]
}
