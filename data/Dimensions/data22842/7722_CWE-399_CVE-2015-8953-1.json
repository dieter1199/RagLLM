{
    "cve_id": "CVE-2015-8953",
    "cve_description": "fs/overlayfs/copy_up.c in the Linux kernel before 4.2.6 uses an incorrect cleanup code path, which allows local users to cause a denial of service (dentry reference leak) via filesystem operations on a large file in a lower overlayfs layer.",
    "cve_publish_date": "2016-10-16",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "ovl: fix dentry reference leak\n\nIn ovl_copy_up_locked(), newdentry is leaked if the function exits through\nout_cleanup as this just to out after calling ovl_cleanup() - which doesn't\nactually release the ref on newdentry.\n\nThe out_cleanup segment should instead exit through out2 as certainly\nnewdentry leaks - and possibly upper does also, though this isn't caught\ngiven the catch of newdentry.\n\nWithout this fix, something like the following is seen:\n\n\tBUG: Dentry ffff880023e9eb20{i=f861,n=#ffff880023e82d90} still in use (1) [unmount of tmpfs tmpfs]\n\tBUG: Dentry ffff880023ece640{i=0,n=bigfile}  still in use (1) [unmount of tmpfs tmpfs]\n\nwhen unmounting the upper layer after an error occurred in copyup.\n\nAn error can be induced by creating a big file in a lower layer with\nsomething like:\n\n\tdd if=/dev/zero of=/lower/a/bigfile bs=65536 count=1 seek=$((0xf000))\n\nto create a large file (4.1G).  Overlay an upper layer that is too small\n(on tmpfs might do) and then induce a copy up by opening it writably.\n\nReported-by: Ulrich Obergfell <uobergfe@redhat.com>\nSigned-off-by: David Howells <dhowells@redhat.com>\nSigned-off-by: Miklos Szeredi <miklos@szeredi.hu>\nCc: <stable@vger.kernel.org> # v3.18+",
    "type_of_change": "Modification",
    "filename_of_changes": "copy_up.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 270: \tgoto out;"
    ]
}
