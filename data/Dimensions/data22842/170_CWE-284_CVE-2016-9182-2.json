{
    "cve_id": "CVE-2016-9182",
    "cve_description": "Exponent CMS 2.4 uses PHP reflection to call a method of a controller class, and then uses the method name to check user permission. But, the method name in PHP reflection is case insensitive, and Exponent CMS permits undefined actions to execute by default, so an attacker can use a capitalized method name to bypass the permission check, e.g., controller=expHTMLEditor&action=preview&editor=ckeditor and controller=expHTMLEditor&action=Preview&editor=ckeditor. An anonymous user will be rejected for the former but can access the latter.",
    "cve_publish_date": "2016-11-04",
    "cwe_id": "CWE-284",
    "cwe_name": "Improper Access Control",
    "cwe_description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
    "commit_message": "fix security vulnerability to bypass permissions using method name in wrong case, reported by fyth",
    "type_of_change": "Modification",
    "filename_of_changes": "expFramework.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 406:     if (array_key_exists($perm_action, $perms)) {",
        "// Line_Reference 409:                 flash('error', gt(\"You don't have permission to\").\" \".$perms[$perm_action]);",
        "// Line_Reference 416:     } elseif (array_key_exists($common_action, $perms)) {",
        "// Line_Reference 419:                 flash('error', gt(\"You don't have permission to\").\" \".$perms[$common_action]);",
        "// Line_Reference 426:     } elseif (array_key_exists($perm_action, $controller->requires_login)) {",
        "// Line_Reference 429:             $msg = empty($controller->requires_login[$perm_action]) ? gt(\"You must be logged in to perform this action\") : gt($controller->requires_login[$perm_action]);",
        "// Line_Reference 434:     } elseif (array_key_exists($common_action, $controller->requires_login)) {",
        "// Line_Reference 435:         // check if the action requires the user to at least be logged in",
        "// Line_Reference 437:             $msg = empty($controller->requires_login[$common_action]) ? gt(\"You must be logged in to perform this action\") : gt($controller->requires_login[$common_action]);"
    ]
}
