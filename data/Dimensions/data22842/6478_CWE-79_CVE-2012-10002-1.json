{
    "cve_id": "CVE-2012-10002",
    "cve_description": "A vulnerability was found in ahmyi RivetTracker. It has been declared as problematic. Affected by this vulnerability is the function changeColor of the file css.php. The manipulation of the argument set_css leads to cross site scripting. The attack can be launched remotely. The patch is named 45a0f33876d58cb7e4a0f17da149e58fc893b858. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217267.",
    "cve_publish_date": "2023-01-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "More security fixes:\n\ncss.php\n  Unfiltered $_POSTs everywhere!\n  Prevent XSS in Create CSS form entry [http://forums.rivetcode.com/viewtopic.php?f=9&t=342&p=1144#p1144]\n  Typo in create css file error message.\n  Needed to connect to database for cleaning function.\n\nedit_database.php\n  One line changed: a simple htmlentities() will take care of this for now.\n\nsanity.php, sanity_no_output.php\n  Changed obsolete code, no escape on queries.\n\nstatistics.php\n  Filtered yet another global array",
    "type_of_change": "Modification",
    "filename_of_changes": "css.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 47: \tif (copy(\"./css/\" . $_POST[\"set_css\"], \"./css/style.css\"))",
        "// Line_Reference 48: \t\techo \"<p class=\\\"success\\\">style.css file has been replaced with \" . $_POST[\"set_css\"] . \"</p>\";",
        "// Line_Reference 58: \tif (unlink(\"./css/\" . $_POST[\"delete_css\"]))",
        "// Line_Reference 59: \t\techo \"<p class=\\\"success\\\">\" . $_POST[\"delete_css\"] . \" has been deleted</p>\";",
        "// Line_Reference 62: \t\techo errorMessage() . \"Error: Unable to delete \" . $_POST[\"delete_css\"] . \", are you sure the permissions are correct?</p>\";",
        "// Line_Reference 71: \t\tif (!file_exists(\"./css/\" . $_POST[\"create_css\"]))",
        "// Line_Reference 73: \t\t\tif (copy(\"./css/style.css\", \"./css/\" . $_POST[\"create_css\"]))",
        "// Line_Reference 74: \t\t\t\techo \"<p class=\\\"success\\\">\" . $_POST[\"create_css\"] . \", was created successfuly</p>\";",
        "// Line_Reference 77: \t\t\t\techo errorMessage() . \"Error: Unabled to create \" . $_POST[\"create_css\"] . \", are you sure the permissions are correct?</p>\";",
        "// Line_Reference 83: \t\t\techo errorMessage() . \"Error: \" . $_POST[\"create_css\"] . \" already exists, please choose a different name</p>\";",
        "// Line_Reference 133: \t\t$filename = $_POST[\"create_css\"];",
        "// Line_Reference 135: \t\t$filename = $_POST[\"edit_css\"];",
        "// Line_Reference 156: \tif (is_writable(\"./css/\" . $_POST[\"hidden_filename\"]))",
        "// Line_Reference 159: \t\t$stream = fopen(\"./css/\" . $_POST[\"hidden_filename\"], \"w\");",
        "// Line_Reference 160: \t\tfwrite($stream, $_POST[\"file_contents\"]);",
        "// Line_Reference 162: \t\techo \"<p class=\\\"success\\\">\" . $_POST[\"hidden_filename\"] . \", was saved successfuly</p>\";",
        "// Line_Reference 172: \t\tif (copy(\"./css/\" . $_POST[\"hidden_filename\"], \"./css/style.css\"))",
        "// Line_Reference 173: \t\t\techo \"<p class=\\\"success\\\">style.css file has been replaced with \" . $_POST[\"hidden_filename\"] . \"</p>\";"
    ]
}
