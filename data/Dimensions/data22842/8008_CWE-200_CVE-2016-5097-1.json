{
    "cve_id": "CVE-2016-5097",
    "cve_description": "phpMyAdmin before 4.6.2 places tokens in query strings and does not arrange for them to be stripped before external navigation, which allows remote attackers to obtain sensitive information by reading (1) HTTP requests or (2) server logs.",
    "cve_publish_date": "2016-07-05",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Improve handling of logout\n\n- add separate script for handling logout\n- no longer require old_usr for all authentication methods\n  (this avoids potential information leak)\n- require valid token for logout\n\nSigned-off-by: Michal Čihař <michal@cihar.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "AuthenticationCookie.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 70:         /* Perform logout to custom URL */",
        "// Line_Reference 71:         if (! empty($_REQUEST['old_usr'])",
        "// Line_Reference 72:             && ! empty($GLOBALS['cfg']['Server']['LogoutURL'])",
        "// Line_Reference 73:         ) {",
        "// Line_Reference 74:             PMA_sendHeaderLocation($GLOBALS['cfg']['Server']['LogoutURL']);",
        "// Line_Reference 75:             if (defined('TESTSUITE')) {",
        "// Line_Reference 76:                 return true;",
        "// Line_Reference 77:             } else {",
        "// Line_Reference 78:                 exit;",
        "// Line_Reference 79:             }",
        "// Line_Reference 80:         }",
        "// Line_Reference 81: ",
        "// Line_Reference 298:         if (! empty($_REQUEST['old_usr'])) {",
        "// Line_Reference 299:             // The user wants to be logged out",
        "// Line_Reference 300:             // -> delete his choices that were stored in session",
        "// Line_Reference 301: ",
        "// Line_Reference 302:             // according to the PHP manual we should do this before the destroy:",
        "// Line_Reference 303:             //$_SESSION = array();",
        "// Line_Reference 304: ",
        "// Line_Reference 305:             if (! defined('TESTSUITE')) {",
        "// Line_Reference 306:                 session_destroy();",
        "// Line_Reference 307:             }",
        "// Line_Reference 308:             // -> delete password cookie(s)",
        "// Line_Reference 309:             if ($GLOBALS['cfg']['LoginCookieDeleteAll']) {",
        "// Line_Reference 310:                 foreach ($GLOBALS['cfg']['Servers'] as $key => $val) {",
        "// Line_Reference 311:                     $GLOBALS['PMA_Config']->removeCookie('pmaPass-' . $key);",
        "// Line_Reference 312:                     if (isset($_COOKIE['pmaPass-' . $key])) {",
        "// Line_Reference 313:                         unset($_COOKIE['pmaPass-' . $key]);",
        "// Line_Reference 314:                     }",
        "// Line_Reference 315:                 }",
        "// Line_Reference 316:             } else {",
        "// Line_Reference 317:                 $GLOBALS['PMA_Config']->removeCookie(",
        "// Line_Reference 318:                     'pmaPass-' . $GLOBALS['server']",
        "// Line_Reference 319:                 );",
        "// Line_Reference 320:                 if (isset($_COOKIE['pmaPass-' . $GLOBALS['server']])) {",
        "// Line_Reference 321:                     unset($_COOKIE['pmaPass-' . $GLOBALS['server']]);",
        "// Line_Reference 322:                 }",
        "// Line_Reference 323:             }",
        "// Line_Reference 324:         }",
        "// Line_Reference 325: "
    ]
}
