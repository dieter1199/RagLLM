{
    "cve_id": "CVE-2022-3979",
    "cve_description": "A vulnerability was found in NagVis up to 1.9.33 and classified as problematic. This issue affects the function checkAuthCookie of the file share/server/core/classes/CoreLogonMultisite.php. The manipulation of the argument hash leads to incorrect type conversion. The attack may be initiated remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. Upgrading to version 1.9.34 is able to address this issue. The identifier of the patch is 7574fd8a2903282c2e0d1feef5c4876763db21d5. It is recommended to upgrade the affected component. The identifier VDB-213557 was assigned to this vulnerability.",
    "cve_publish_date": "2022-11-13",
    "cwe_id": "CWE-704",
    "cwe_name": "Incorrect Type Conversion or Cast",
    "cwe_description": "The product does not correctly convert an object, resource, or structure from one type to a different type.",
    "commit_message": "Fix type juggling vulnerability\n\nPHP evaluates `!=` a bit loose on the type. So \"0000\" == \"0e5678\" is\ntrue in PHP. An attacker could send a zeroed cookie_hash `\"0\"*32` and\nonly need an collision with a calculated hash beginning with `0e`\nfollowed by only numbers.\n\nIn our tests (with auth.secret set to `stable`) a valid cookie is\n`cmkadmin:58191275:00000000000000000000000000000000`.\n\nFor a remote attacker this would have needed 58,191,275 guesses.",
    "type_of_change": "Modification",
    "filename_of_changes": "CoreLogonMultisite.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 117:         if ($cookieHash != $hash) {",
        "// Line_Reference 121:         // FIXME: Maybe renew the cookie here too",
        "// Line_Reference 122: "
    ]
}
