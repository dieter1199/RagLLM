{
    "cve_id": "CVE-2024-33904",
    "cve_description": "In plugins/HookSystem.cpp in Hyprland through 0.39.1 (before 28c8561), through a race condition, a local attacker can cause execution of arbitrary assembly code by writing to a predictable temporary file.",
    "cve_publish_date": "2024-04-29",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "hooksystem: use a random 700 directory for assembler",
    "type_of_change": "Modification",
    "filename_of_changes": "HookSystem.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 138:     std::ofstream ofs(\"/tmp/hypr/.hookcode.asm\", std::ios::trunc);",
        "// Line_Reference 141:     std::string ret = execAndGet(",
        "// Line_Reference 142:         \"cc -x assembler -c /tmp/hypr/.hookcode.asm -o /tmp/hypr/.hookbinary.o 2>&1 && objcopy -O binary -j .text /tmp/hypr/.hookbinary.o /tmp/hypr/.hookbinary2.o 2>&1\");",
        "// Line_Reference 144:     if (!std::filesystem::exists(\"/tmp/hypr/.hookbinary2.o\")) {",
        "// Line_Reference 145:         std::filesystem::remove(\"/tmp/hypr/.hookcode.asm\");",
        "// Line_Reference 146:         std::filesystem::remove(\"/tmp/hypr/.hookbinary.asm\");",
        "// Line_Reference 150:     std::ifstream ifs(\"/tmp/hypr/.hookbinary2.o\", std::ios::binary);",
        "// Line_Reference 153:     std::filesystem::remove(\"/tmp/hypr/.hookcode.asm\");",
        "// Line_Reference 154:     std::filesystem::remove(\"/tmp/hypr/.hookbinary.o\");",
        "// Line_Reference 155:     std::filesystem::remove(\"/tmp/hypr/.hookbinary2.o\");"
    ]
}
