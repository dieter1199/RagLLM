{
    "cve_id": "CVE-2012-3511",
    "cve_description": "Multiple race conditions in the madvise_remove function in mm/madvise.c in the Linux kernel before 3.4.5 allow local users to cause a denial of service (use-after-free and system crash) via vectors involving a (1) munmap or (2) close system call.",
    "cve_publish_date": "2012-10-04",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "mm: Hold a file reference in madvise_remove\n\nOtherwise the code races with munmap (causing a use-after-free\nof the vma) or with close (causing a use-after-free of the struct\nfile).\n\nThe bug was introduced by commit 90ed52ebe481 (\"[PATCH] holepunch: fix\nmmap_sem i_mutex deadlock\")\n\nCc: Hugh Dickins <hugh@veritas.com>\nCc: Miklos Szeredi <mszeredi@suse.cz>\nCc: Badari Pulavarty <pbadari@us.ibm.com>\nCc: Nick Piggin <npiggin@suse.de>\nCc: stable@vger.kernel.org\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "madvise.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 213: \tif (!vma->vm_file || !vma->vm_file->f_mapping",
        "// Line_Reference 214: \t\t|| !vma->vm_file->f_mapping->host) {",
        "// Line_Reference 224: \t/* filesystem's fallocate may need to take i_mutex */",
        "// Line_Reference 226: \terror = do_fallocate(vma->vm_file,"
    ]
}
