{
    "cve_id": "CVE-2024-5129",
    "cve_description": "A Privilege Escalation Vulnerability exists in lunary-ai/lunary version 1.2.2, where any user can delete any datasets due to missing authorization checks. The vulnerability is present in the dataset deletion functionality, where the application fails to verify if the user requesting the deletion has the appropriate permissions. This allows unauthorized users to send a DELETE request to the server and delete any dataset by specifying its ID. The issue is located in the datasets.delete function within the datasets index file.",
    "cve_publish_date": "2024-06-06",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: authorization delete dataset (#204)",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 123: datasets.delete(\"/:id\", async (ctx: Context) => {",
        "// Line_Reference 124:   const { id } = ctx.params",
        "// Line_Reference 126:   await sql`delete from dataset where id = ${id}`",
        "// Line_Reference 128:   ctx.status = 200",
        "// Line_Reference 129: })"
    ]
}
