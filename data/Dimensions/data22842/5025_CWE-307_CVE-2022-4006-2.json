{
    "cve_id": "CVE-2022-4006",
    "cve_description": "A vulnerability, which was classified as problematic, has been found in WBCE CMS. Affected by this issue is the function increase_attempts of the file wbce/framework/class.login.php of the component Header Handler. The manipulation of the argument X-Forwarded-For leads to improper restriction of excessive authentication attempts. The attack may be launched remotely. The name of the patch is d394ba39a7bfeb31eda797b6195fd90ef74b2e75. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-213716.",
    "cve_publish_date": "2022-11-15",
    "cwe_id": "CWE-307",
    "cwe_name": "Improper Restriction of Excessive Authentication Attempts",
    "cwe_description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it more susceptible to brute force attacks.",
    "commit_message": "fix for #524\n\nusually, ip addresses with multiple failed login attempts should be\nblocked. An attacker could bypass this by sending an X-forwarded-for\nheader and change that IP with each attempt. Since REMMOTE_ADDR\nis harder to fake we should first check that one and only if that one is\nnot set for some reason, rely on other variables.",
    "type_of_change": "Modification",
    "filename_of_changes": "class.login.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 413:         $ipaddress = '';",
        "// Line_Reference 414:         if (isset($_SERVER['HTTP_CLIENT_IP'])) {",
        "// Line_Reference 424:         } elseif (isset($_SERVER['REMOTE_ADDR'])) {",
        "// Line_Reference 425:             $ipaddress = $this->get_server('REMOTE_ADDR');",
        "// Line_Reference 436:         } elseif (getenv('REMOTE_ADDR')) {",
        "// Line_Reference 437:             $ipaddress = getenv('REMOTE_ADDR');"
    ]
}
