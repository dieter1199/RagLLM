{
    "cve_id": "CVE-2012-4573",
    "cve_description": "The v1 API in OpenStack Glance Grizzly, Folsom (2012.2), and Essex (2012.1) allows remote authenticated users to delete arbitrary non-protected images via an image deletion request, a different vulnerability than CVE-2012-5482.",
    "cve_publish_date": "2012-11-11",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Delete from store after registry delete.\n\nBecause we rely on the registry to determine authorization in the glance\nv1 api, we must attempt a registry delete before deleting an image from\nthe image store.\n\nThis patch includes the test for the bug, which was posted separately\non the bug.\n\nFixes bug 1065187.\n\nChange-Id: I1a06b7c7421524066c684539e2f3516c4ed2c475",
    "type_of_change": "Modification",
    "filename_of_changes": "images.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 830:         status = 'deleted'",
        "// Line_Reference 838:                     status = 'pending_delete'",
        "// Line_Reference 843: ",
        "// Line_Reference 844:             registry.update_image_metadata(req.context, id, {'status': status})",
        "// Line_Reference 845:             registry.delete_image_metadata(req.context, id)"
    ]
}
