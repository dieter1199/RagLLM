{
    "cve_id": "CVE-2013-5313",
    "cve_description": "Cross-site request forgery (CSRF) vulnerability in core/admin/modules/users/update.php in BigTree CMS 4.0 RC2 and earlier allows remote attackers to hijack the authentication of administrators for requests that modify arbitrary user accounts via an edit user action.",
    "cve_publish_date": "2013-08-19",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Fixed a Cross-Site Request Forgery exploit that would allow logged-in BigTree admins hitting a malicious page to automatically create / update users.",
    "type_of_change": "Modification",
    "filename_of_changes": "create.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 2: \t$admin->requireLevel(1);",
        "// Line_Reference 3: \t$id = $admin->createUser($_POST);",
        "// Line_Reference 5: \tif (!$id) {",
        "// Line_Reference 6: \t\t$_SESSION[\"bigtree_admin\"][\"create_user\"] = $_POST;",
        "// Line_Reference 7: \t\t$admin->growl(\"Users\",\"Creation Failed\",\"error\");",
        "// Line_Reference 8: \t\tBigTree::redirect(ADMIN_ROOT.\"users/add/\");",
        "// Line_Reference 10: ",
        "// Line_Reference 11: \t$admin->growl(\"Users\",\"Added User\");",
        "// Line_Reference 12: \tBigTree::redirect(ADMIN_ROOT.\"users/edit/$id/\");"
    ]
}
