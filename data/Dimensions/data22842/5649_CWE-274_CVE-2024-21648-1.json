{
    "cve_id": "CVE-2024-21648",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The rollback action is missing a right protection, a user can rollback to a previous version of the page to gain rights they don't have anymore. The problem has been patched in XWiki 14.10.17, 15.5.3 and 15.8-rc-1 by ensuring that the rights are checked before performing the rollback. ",
    "cve_publish_date": "2024-01-09",
    "cwe_id": "CWE-274",
    "cwe_name": "Improper Handling of Insufficient Privileges",
    "cwe_description": "The product does not handle or incorrectly handles when it has insufficient privileges to perform an operation, leading to resultant weaknesses.",
    "commit_message": "XWIKI-21257: Rollback is not triggering a UserUpdatingDocumentEvent\n\n  * Ensure that the rollback API properly calls the check method\n  * Back the changes in a unit test that check events triggered in\n    rollback",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "DeleteVersionsAction.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 68:             context.getWiki().deleteDocumentVersions(tdoc, v1.toString(), v2.toString(), context);"
    ]
}
