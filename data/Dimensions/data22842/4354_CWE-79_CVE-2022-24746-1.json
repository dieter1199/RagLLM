{
    "cve_id": "CVE-2022-24746",
    "cve_description": "Shopware is an open commerce platform based on the Symfony php Framework and the Vue javascript framework. In affected versions it is possible to inject code via the voucher code form. This issue has been patched in version 6.4.8.1. There are no known workarounds for this issue.",
    "cve_publish_date": "2022-03-09",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "NEXT-19276 - Add filtering to promotion and product codes",
    "type_of_change": "Modification",
    "filename_of_changes": "CartLineItemController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 35:     /**",
        "// Line_Reference 36:      * @var CartService",
        "// Line_Reference 37:      */",
        "// Line_Reference 38:     private $cartService;",
        "// Line_Reference 40:     /**",
        "// Line_Reference 41:      * @var PromotionItemBuilder",
        "// Line_Reference 42:      */",
        "// Line_Reference 43:     private $promotionItemBuilder;",
        "// Line_Reference 45:     /**",
        "// Line_Reference 46:      * @var SalesChannelRepositoryInterface",
        "// Line_Reference 47:      */",
        "// Line_Reference 48:     private $productRepository;",
        "// Line_Reference 50:     /**",
        "// Line_Reference 51:      * @var ProductLineItemFactory",
        "// Line_Reference 52:      */",
        "// Line_Reference 53:     private $productLineItemFactory;",
        "// Line_Reference 59:         ProductLineItemFactory $productLineItemFactory",
        "// Line_Reference 172:         $number = $request->request->get('number');",
        "// Line_Reference 186:             $this->addFlash(self::DANGER, $this->trans('error.productNotFound', ['%number%' => $number]));"
    ]
}
