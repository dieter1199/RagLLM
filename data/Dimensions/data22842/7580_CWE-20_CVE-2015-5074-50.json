{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "VisitAllPagesTest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "137",
    "number_of_lines_deleted_vulnerable_to_cve": "68",
    "vulnerable_lines": [
        "// Line_Reference 54:             print ('visiting page ' .$page.\"\\n\");",
        "// Line_Reference 56:             $this->assertNoPHPErrors ($page);",
        "// Line_Reference 62: \tpublic function testPages () {",
        "// Line_Reference 63:         $this->visitPages ( $this->allPages );",
        "// Line_Reference 64: \t}",
        "// Line_Reference 67:         // contacts",
        "// Line_Reference 76:         // accounts",
        "// Line_Reference 83:         // marketing",
        "// Line_Reference 93:         // leads",
        "// Line_Reference 99:         // opportunities",
        "// Line_Reference 105:         // services",
        "// Line_Reference 111:         // actions",
        "// Line_Reference 119:         // calendar",
        "// Line_Reference 124:         // docs",
        "// Line_Reference 133:         // workflow",
        "// Line_Reference 139:         // products",
        "// Line_Reference 144:         //'site/printRecord/1?modelClass=Product&pageTitle=Product%3A+Semiconductor',",
        "// Line_Reference 145:         // quotes",
        "// Line_Reference 158:         // media",
        "// Line_Reference 163:         // groups",
        "// Line_Reference 168:         // bug reports",
        "// Line_Reference 171:         // site",
        "// Line_Reference 176:         // profile",
        "// Line_Reference 185: ",
        "// Line_Reference 195:         // admin",
        "// Line_Reference 196:         'admin/index',",
        "// Line_Reference 197:         'admin/editRoleAccess',",
        "// Line_Reference 198:         'admin/manageRoles',",
        "// Line_Reference 199:         'admin/manageSessions',",
        "// Line_Reference 200:         'admin/setLeadRouting',",
        "// Line_Reference 201:         'admin/roundRobinRules',",
        "// Line_Reference 202:         'admin/workflowSettings',",
        "// Line_Reference 204:         'admin/setServiceRouting',",
        "// Line_Reference 205:         'studio/flowIndex',",
        "// Line_Reference 206:         'studio/importFlow',",
        "// Line_Reference 208:         'admin/updaterSettings',",
        "// Line_Reference 209:         'admin/manageModules',",
        "// Line_Reference 210:         'admin/createPage',",
        "// Line_Reference 211:         'admin/googleIntegration',",
        "// Line_Reference 212:         'admin/toggleDefaultLogo',",
        "// Line_Reference 213:         'admin/uploadLogo',",
        "// Line_Reference 214:         'admin/updater',",
        "// Line_Reference 215:         'admin/activitySettings',",
        "// Line_Reference 216:         'admin/publicInfo',",
        "// Line_Reference 217:         'admin/lockApp',",
        "// Line_Reference 218:         'admin/manageActionPublisherTabs',",
        "// Line_Reference 219:         'admin/x2CronSettings',",
        "// Line_Reference 221:         'admin/setDefaultTheme',",
        "// Line_Reference 222:         'admin/emailSetup',",
        "// Line_Reference 225:         'admin/importModels?model=X2Leads',",
        "// Line_Reference 230:         'admin/importModels?model=Contacts',",
        "// Line_Reference 231:         'admin/importModels?model=Accounts',",
        "// Line_Reference 232:         'admin/exportModels',",
        "// Line_Reference 233:         'admin/exportModels?model=Actions',",
        "// Line_Reference 234:         'admin/export',",
        "// Line_Reference 235:         'admin/import',",
        "// Line_Reference 236:         'admin/rollbackImport',",
        "// Line_Reference 237:         'admin/viewChangelog',",
        "// Line_Reference 239:         'admin/translationManager',",
        "// Line_Reference 240:         'admin/manageTags',",
        "// Line_Reference 241:         'admin/userViewLog',",
        "// Line_Reference 242:         'admin/createModule',",
        "// Line_Reference 243:         'admin/manageFields',",
        "// Line_Reference 245:         'admin/editor',",
        "// Line_Reference 246:         'admin/deleteModule',",
        "// Line_Reference 247:         'admin/importModule',",
        "// Line_Reference 248:         'admin/exportModule',",
        "// Line_Reference 250:         'admin/convertCustomModules',"
    ]
}
