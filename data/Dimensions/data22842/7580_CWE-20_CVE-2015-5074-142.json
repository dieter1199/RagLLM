{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "Profile.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "38",
    "vulnerable_lines": [
        "// Line_Reference 1000:             'center' => array(",
        "// Line_Reference 1001:                 'RecordViewChart' => array(",
        "// Line_Reference 1002:                     'title' => 'Record View Chart',",
        "// Line_Reference 1003:                     'minimize' => false,",
        "// Line_Reference 1004:                 ),",
        "// Line_Reference 1005:                 'InlineTags' => array(",
        "// Line_Reference 1006:                     'title' => 'Tags',",
        "// Line_Reference 1007:                     'minimize' => false,",
        "// Line_Reference 1008:                 ),",
        "// Line_Reference 1009:                 'WorkflowStageDetails' => array(",
        "// Line_Reference 1010:                     'title' => 'Process',",
        "// Line_Reference 1011:                     'minimize' => false,",
        "// Line_Reference 1012:                 ),",
        "// Line_Reference 1013:                 'InlineRelationships' => array(",
        "// Line_Reference 1014:                     'title' => 'Relationships',",
        "// Line_Reference 1015:                     'minimize' => false,",
        "// Line_Reference 1016:                 ),",
        "// Line_Reference 1017:             ),",
        "// Line_Reference 1076:             'hidden' => array(),",
        "// Line_Reference 1077:             'hiddenRight' => array(), // x2temp, should be merged into 'hidden' when widgets can be placed anywhere",
        "// Line_Reference 1082:                     $layout[$loc] = array_merge($layout[$loc],$data);",
        "// Line_Reference 1095: ",
        "// Line_Reference 1098:         $layoutWidgets = array_merge($layout[$position], $layout['hidden']);",
        "// Line_Reference 1099:         if ($position === 'center') {",
        "// Line_Reference 1100:             $initLayoutWidgets = array_merge($initLayout[$position], $initLayout['hidden']);",
        "// Line_Reference 1109:             //$layout[$position][$elem] = $initLayout[$position][$elem];",
        "// Line_Reference 1121:             } else if($position === 'center' && in_array ($elem, array_keys ($layout['hidden']))) {",
        "// Line_Reference 1122:                 unset($layout['hidden'][$elem]);",
        "// Line_Reference 1127: ",
        "// Line_Reference 1130:             if (in_array ($name, array_keys ($initLayout[$position])) &&",
        "// Line_Reference 1131:                 $initLayout[$position][$name]['title'] !== $arr['title']) {",
        "// Line_Reference 1133:                 $layout[$position][$name]['title'] = $initLayout[$position][$name]['title'];",
        "// Line_Reference 1137:         if ($position === 'center') {",
        "// Line_Reference 1138:             foreach($layout['hidden'] as $name=>$arr){",
        "// Line_Reference 1139:                 if (in_array ($name, array_keys ($initLayout[$position])) &&",
        "// Line_Reference 1140:                     $initLayout[$position][$name]['title'] !== $arr['title']) {",
        "// Line_Reference 1142:                     $layout['hidden'][$name]['title'] = $initLayout[$position][$name]['title'];",
        "// Line_Reference 1170:             $this->addRemoveLayoutElements('center', $layout, $initLayout);"
    ]
}
