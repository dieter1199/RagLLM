{
    "cve_id": "CVE-2016-10147",
    "cve_description": "crypto/mcryptd.c in the Linux kernel before 4.8.15 allows local users to cause a denial of service (NULL pointer dereference and system crash) by using an AF_ALG socket with an incompatible algorithm, as demonstrated by mcryptd(md5).",
    "cve_publish_date": "2017-01-18",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "crypto: mcryptd - Check mcryptd algorithm compatibility\n\nAlgorithms not compatible with mcryptd could be spawned by mcryptd\nwith a direct crypto_alloc_tfm invocation using a \"mcryptd(alg)\" name\nconstruct.  This causes mcryptd to crash the kernel if an arbitrary\n\"alg\" is incompatible and not intended to be used with mcryptd.  It is\nan issue if AF_ALG tries to spawn mcryptd(alg) to expose it externally.\nBut such algorithms must be used internally and not be exposed.\n\nWe added a check to enforce that only internal algorithms are allowed\nwith mcryptd at the time mcryptd is spawning an algorithm.\n\nLink: http://marc.info/?l=linux-crypto-vger&m=148063683310477&w=2\nCc: stable@vger.kernel.org\nReported-by: Mikulas Patocka <mpatocka@redhat.com>\nSigned-off-by: Tim Chen <tim.c.chen@linux.intel.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
    "type_of_change": "Modification",
    "filename_of_changes": "mcryptd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 257: static inline void mcryptd_check_internal(struct rtattr **tb, u32 *type,",
        "// Line_Reference 264: \t\treturn;",
        "// Line_Reference 265: \tif ((algt->type & CRYPTO_ALG_INTERNAL))",
        "// Line_Reference 266: \t\t*type |= CRYPTO_ALG_INTERNAL;",
        "// Line_Reference 267: \tif ((algt->mask & CRYPTO_ALG_INTERNAL))",
        "// Line_Reference 268: \t\t*mask |= CRYPTO_ALG_INTERNAL;",
        "// Line_Reference 495: \tmcryptd_check_internal(tb, &type, &mask);"
    ]
}
