{
    "cve_id": "CVE-2019-20892",
    "cve_description": "net-snmp before 5.8.1.pre1 has a double free in usm_free_usmStateReference in snmplib/snmpusm.c via an SNMPv3 GetBulk request. NOTE: this affects net-snmp packages shipped to end users by multiple Linux distributions, but might not affect an upstream release.",
    "cve_publish_date": "2020-06-25",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "libsnmp, USM: Introduce a reference count in struct usmStateReference\n\nThis patch fixes https://sourceforge.net/p/net-snmp/bugs/2956/.",
    "type_of_change": "Modification",
    "filename_of_changes": "snmp_client.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 408:     if (pdu->securityStateRef &&",
        "// Line_Reference 409:         pdu->command == SNMP_MSG_TRAP2) {",
        "// Line_Reference 410: ",
        "// Line_Reference 411:         netsnmp_assert(pdu->securityModel == SNMP_DEFAULT_SECMODEL);",
        "// Line_Reference 412:         ret = usm_clone_usmStateReference((struct usmStateReference *) pdu->securityStateRef,",
        "// Line_Reference 413:                 (struct usmStateReference **) &newpdu->securityStateRef );",
        "// Line_Reference 414: ",
        "// Line_Reference 415:         if (ret)",
        "// Line_Reference 416:         {",
        "// Line_Reference 422:     if ((sptr = find_sec_mod(newpdu->securityModel)) != NULL &&",
        "// Line_Reference 423:         sptr->pdu_clone != NULL) {",
        "// Line_Reference 424:         /*",
        "// Line_Reference 425:          * call security model if it needs to know about this",
        "// Line_Reference 426:          */",
        "// Line_Reference 427:         (*sptr->pdu_clone) (pdu, newpdu);",
        "// Line_Reference 428:     }",
        "// Line_Reference 429: "
    ]
}
