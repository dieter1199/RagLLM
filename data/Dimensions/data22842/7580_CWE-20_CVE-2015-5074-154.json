{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "Tags.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 100:     /**",
        "// Line_Reference 101:      * Strip out all instances of the delimeter in the tag",
        "// Line_Reference 102:      */",
        "// Line_Reference 103:     public function beforeSave() {",
        "// Line_Reference 104:         if(strpos($this->tag,self::DELIM) !== false) {",
        "// Line_Reference 105:             $this->tag = strtr($this->tag,array(self::DELIM => ''));",
        "// Line_Reference 106:         }",
        "// Line_Reference 107:         return true;",
        "// Line_Reference 108:     }",
        "// Line_Reference 109: ",
        "// Line_Reference 127:     public static function getTagLinks($model,$id,$limit = 0) {",
        "// Line_Reference 128: ",
        "// Line_Reference 130:             $limit = null;",
        "// Line_Reference 140:             $links[] = CHtml::link(CHtml::encode($tag->tag),array('/search/search','term'=>CHtml::encode($tag->tag)));",
        "// Line_Reference 142:         if(!empty($limit) && $tagCount > $limit)"
    ]
}
