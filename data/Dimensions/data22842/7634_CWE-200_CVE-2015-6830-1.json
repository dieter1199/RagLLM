{
    "cve_id": "CVE-2015-6830",
    "cve_description": "libraries/plugins/auth/AuthenticationCookie.class.php in phpMyAdmin 4.3.x before 4.3.13.2 and 4.4.x before 4.4.14.1 allows remote attackers to bypass a multiple-reCaptcha protection mechanism against brute-force credential guessing by providing a correct response to a single reCaptcha.",
    "cve_publish_date": "2015-09-14",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Fix reCaptcha bypass\n\nSigned-off-by: Madhura Jayaratne <madhura.cj@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "AuthenticationCookie.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "29",
    "vulnerable_lines": [
        "// Line_Reference 226:         // We already have one correct captcha.",
        "// Line_Reference 227:         $skip = false;",
        "// Line_Reference 228:         if (  isset($_SESSION['last_valid_captcha'])",
        "// Line_Reference 229:             && $_SESSION['last_valid_captcha']",
        "// Line_Reference 230:         ) {",
        "// Line_Reference 231:             $skip = true;",
        "// Line_Reference 232:         }",
        "// Line_Reference 233: ",
        "// Line_Reference 237:             && !$skip",
        "// Line_Reference 339:                 // $_SESSION array is not immediately emptied",
        "// Line_Reference 340:                 $_SESSION['last_valid_captcha'] = false;",
        "// Line_Reference 362:             // We already have one correct captcha.",
        "// Line_Reference 363:             $skip = false;",
        "// Line_Reference 364:             if (isset($_SESSION['last_valid_captcha'])",
        "// Line_Reference 365:                 && $_SESSION['last_valid_captcha']",
        "// Line_Reference 366:             ) {",
        "// Line_Reference 367:                 $skip = true;",
        "// Line_Reference 368:             }",
        "// Line_Reference 369: ",
        "// Line_Reference 373:                 && ! $skip",
        "// Line_Reference 391:                         $_SESSION['last_valid_captcha'] = false;",
        "// Line_Reference 393:                     } else {",
        "// Line_Reference 394:                         $_SESSION['last_valid_captcha'] = true;",
        "// Line_Reference 397:                     if (! isset($_SESSION['last_valid_captcha'])",
        "// Line_Reference 398:                         || ! $_SESSION['last_valid_captcha']",
        "// Line_Reference 399:                     ) {",
        "// Line_Reference 400:                         $conn_error = __('Please enter correct captcha!');",
        "// Line_Reference 401:                         return false;",
        "// Line_Reference 402:                     }"
    ]
}
