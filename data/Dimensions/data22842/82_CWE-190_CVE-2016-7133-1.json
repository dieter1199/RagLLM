{
    "cve_id": "CVE-2016-7133",
    "cve_description": "Zend/zend_alloc.c in PHP 7.x before 7.0.10, when open_basedir is enabled, mishandles huge realloc operations, which allows remote attackers to cause a denial of service (integer overflow) or possibly have unspecified other impact via a long pathname.",
    "cve_publish_date": "2016-09-12",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Fix bug #72742 - memory allocator fails to realloc small block to large one",
    "type_of_change": "Modification",
    "filename_of_changes": "zend_alloc.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1551: \t\t\tint old_bin_num, bin_num;",
        "// Line_Reference 1552: ",
        "// Line_Reference 1553: \t\t\told_bin_num = ZEND_MM_SRUN_BIN_NUM(info);",
        "// Line_Reference 1555: \t\t\tbin_num = ZEND_MM_SMALL_SIZE_TO_BIN(size);",
        "// Line_Reference 1556: \t\t\tif (old_bin_num == bin_num) {",
        "// Line_Reference 1558: \t\t\t\tdbg = zend_mm_get_debug_info(heap, ptr);",
        "// Line_Reference 1559: \t\t\t\tdbg->size = real_size;",
        "// Line_Reference 1560: \t\t\t\tdbg->filename = __zend_filename;",
        "// Line_Reference 1561: \t\t\t\tdbg->orig_filename = __zend_orig_filename;",
        "// Line_Reference 1562: \t\t\t\tdbg->lineno = __zend_lineno;",
        "// Line_Reference 1563: \t\t\t\tdbg->orig_lineno = __zend_orig_lineno;",
        "// Line_Reference 1565: \t\t\t\treturn ptr;"
    ]
}
