{
    "cve_id": "CVE-2017-8071",
    "cve_description": "drivers/hid/hid-cp2112.c in the Linux kernel 4.9.x before 4.9.9 uses a spinlock without considering that sleeping is possible in a USB HID request callback, which allows local users to cause a denial of service (deadlock) via unspecified vectors.",
    "cve_publish_date": "2017-04-23",
    "cwe_id": "CWE-404",
    "cwe_name": "Improper Resource Shutdown or Release",
    "cwe_description": "The product does not release or incorrectly releases a resource before it is made available for re-use.",
    "commit_message": "HID: cp2112: fix sleep-while-atomic\n\nA recent commit fixing DMA-buffers on stack added a shared transfer\nbuffer protected by a spinlock. This is broken as the USB HID request\ncallbacks can sleep. Fix this up by replacing the spinlock with a mutex.\n\nFixes: 1ffb3c40ffb5 (\"HID: cp2112: make transfer buffers DMA capable\")\nCc: stable <stable@vger.kernel.org>\t# 4.9\nSigned-off-by: Johan Hovold <johan@kernel.org>\nReviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "type_of_change": "Modification",
    "filename_of_changes": "hid-cp2112.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 171: \tspinlock_t lock;",
        "// Line_Reference 189: \tunsigned long flags;",
        "// Line_Reference 192: \tspin_lock_irqsave(&dev->lock, flags);",
        "// Line_Reference 216: \tspin_unlock_irqrestore(&dev->lock, flags);",
        "// Line_Reference 225: \tunsigned long flags;",
        "// Line_Reference 228: \tspin_lock_irqsave(&dev->lock, flags);",
        "// Line_Reference 240: \tspin_unlock_irqrestore(&dev->lock, flags);",
        "// Line_Reference 248: \tunsigned long flags;",
        "// Line_Reference 251: \tspin_lock_irqsave(&dev->lock, flags);",
        "// Line_Reference 265: \tspin_unlock_irqrestore(&dev->lock, flags);",
        "// Line_Reference 287: \tunsigned long flags;",
        "// Line_Reference 290: \tspin_lock_irqsave(&dev->lock, flags);",
        "// Line_Reference 311: \tspin_unlock_irqrestore(&dev->lock, flags);",
        "// Line_Reference 322: \tspin_unlock_irqrestore(&dev->lock, flags);",
        "// Line_Reference 1238: \tspin_lock_init(&dev->lock);"
    ]
}
