{
    "cve_id": "CVE-2021-40568",
    "cve_description": "A buffer overflow vulnerability exists in Gpac through 1.0.1 via a malformed MP4 file in the svc_parse_slice function in av_parsers.c, which allows attackers to cause a denial of service, even code execution and escalation of privileges.",
    "cve_publish_date": "2022-01-13",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "fixed #1900",
    "type_of_change": "Modification",
    "filename_of_changes": "av_parsers.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 4693: \t\t\t//gf_bs_read_int keeps returning 0 on EOS, so if no more bits available, rbsp was truncated otherwise code is broken in rbsp)",
        "// Line_Reference 4694: \t\t\t//we only test once nb_lead>=32 to avoid testing at each bit read",
        "// Line_Reference 4695: \t\t\tif (!gf_bs_available(bs)) {",
        "// Line_Reference 4696: \t\t\t\tGF_LOG(GF_LOG_ERROR, GF_LOG_CODING, (\"[Core] exp-golomb read failed, not enough bits in bitstream !\\n\"));",
        "// Line_Reference 4697: \t\t\t} else {",
        "// Line_Reference 4698: \t\t\t\tGF_LOG(GF_LOG_ERROR, GF_LOG_CODING, (\"[Core] corrupted exp-golomb code, %d leading zeros, max 31 allowed !\\n\", nb_lead));",
        "// Line_Reference 4699: \t\t\t}",
        "// Line_Reference 4700: \t\t\treturn 0;",
        "// Line_Reference 4702: ",
        "// Line_Reference 5788: \tif (pps_id > 255)"
    ]
}
