{
    "cve_id": "CVE-2022-0336",
    "cve_description": "The Samba AD DC includes checks when adding service principals names (SPNs) to an account to ensure that SPNs do not alias with those already in the database. Some of these checks are able to be bypassed if an account modification re-adds an SPN that was previously present on that account, such as one added when a computer is joined to a domain. An attacker who has the ability to write to an account can exploit this to perform a denial-of-service attack by adding an SPN that matches an existing service. Additionally, an attacker who can intercept traffic can impersonate existing services, resulting in a loss of confidentiality and integrity.",
    "cve_publish_date": "2022-08-29",
    "cwe_id": "CWE-276",
    "cwe_name": "Incorrect Default Permissions",
    "cwe_description": "During installation, installed file permissions are set to allow anyone to modify those files.",
    "commit_message": "CVE-2022-0336: s4/dsdb/samldb: Don't return early when an SPN is re-added to an object\n\nIf an added SPN already exists on an object, we still want to check the\nrest of the element values for conflicts.\n\nBUG: https://bugzilla.samba.org/show_bug.cgi?id=14950\n\nSigned-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>\nReviewed-by: Douglas Bagnall <douglas.bagnall@catalyst.net.nz>",
    "type_of_change": "Modification",
    "filename_of_changes": "samldb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 4009: \t\t\ttalloc_free(tmp_ctx);",
        "// Line_Reference 4010: \t\t\treturn LDB_SUCCESS;"
    ]
}
