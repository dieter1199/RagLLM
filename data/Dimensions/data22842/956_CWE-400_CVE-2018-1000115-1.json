{
    "cve_id": "CVE-2018-1000115",
    "cve_description": "Memcached version 1.5.5 contains an Insufficient Control of Network Message Volume (Network Amplification, CWE-406) vulnerability in the UDP support of the memcached server that can result in denial of service via network flood (traffic amplification of 1:50,000 has been reported by reliable sources). This attack appear to be exploitable via network connectivity to port 11211 UDP. This vulnerability appears to have been fixed in 1.5.6 due to the disabling of the UDP protocol by default.",
    "cve_publish_date": "2018-03-05",
    "cwe_id": "CWE-400",
    "cwe_name": "Uncontrolled Resource Consumption",
    "cwe_description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
    "commit_message": "disable UDP port by default\n\nAs reported, UDP amplification attacks have started to use insecure\ninternet-exposed memcached instances. UDP used to be a lot more popular as a\ntransport for memcached many years ago, but I'm not aware of many recent\nusers.\n\nTen years ago, the TCP connection overhead from many clients was relatively\nhigh (dozens or hundreds per client server), but these days many clients are\nbatched, or user fewer processes, or simply anre't worried about it.\n\nWhile changing the default to listen on localhost only would also help, the\ntrue culprit is UDP. There are many more use cases for using memcached over\nthe network than there are for using the UDP protocol.",
    "type_of_change": "Modification",
    "filename_of_changes": "memcached.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 225:     settings.udpport = 11211;",
        "// Line_Reference 7482:     if (tcp_specified && settings.port != 0 && !udp_specified) {",
        "// Line_Reference 7483:         settings.udpport = settings.port;",
        "// Line_Reference 7484:     } else if (udp_specified && settings.udpport != 0 && !tcp_specified) {"
    ]
}
