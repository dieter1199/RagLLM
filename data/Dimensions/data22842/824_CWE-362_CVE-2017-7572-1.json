{
    "cve_id": "CVE-2017-7572",
    "cve_description": "The _checkPolkitPrivilege function in serviceHelper.py in Back In Time (aka backintime) 1.1.18 and earlier uses a deprecated polkit authorization method (unix-process) that is subject to a race condition (time of check, time of use). With this authorization method, the owner of a process requesting a polkit operation is checked by polkitd via /proc/<pid>/status, by which time the requesting process may have been replaced by a different process with the same PID that has different privileges then the original requester.",
    "cve_publish_date": "2017-04-06",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "polkit CheckAuthorization: fix race condition in privilege authorization\n\nThe unix-process authorization subject is deprecated:\n\nhttps://www.freedesktop.org/software/polkit/docs/latest/PolkitUnixProcess.html#polkit-unix-process-new\n\nas it is subject to a race condition. A client process requesting\nauthorization can replace itself by a suid or otherwise root owned\nexecutable, thus granting the original non-privileged request\nprivileges.\n\nSee also:\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1002375\nhttps://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack/blob/master/2011/CVE-2011-1485/polkit-pwnage.c\n\nPolkit uses the real-uid of the process by now, thus mitigating the\nexploit using suid binaries. It is still possible, however, to exit the\nclient process and try to get a root program to get the same PID.\n\nIn worst case this would allow an unauthenticated user to get backintime\nor some other program to be executed via udev rules as root user.",
    "type_of_change": "Modification",
    "filename_of_changes": "serviceHelper.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 285:         info = SenderInfo(sender, conn)",
        "// Line_Reference 286: ",
        "// Line_Reference 287:         # get peer PID",
        "// Line_Reference 288:         pid = info.connectionPid()",
        "// Line_Reference 289: ",
        "// Line_Reference 295:                     ('unix-process', {'pid': dbus.UInt32(pid, variant_level=1),",
        "// Line_Reference 296:                     'start-time': dbus.UInt64(0, variant_level=1)}),"
    ]
}
