{
    "cve_id": "CVE-2015-7698",
    "cve_description": "icewind1991 SMB before 1.0.3 allows remote authenticated users to execute arbitrary SMB commands via shell metacharacters in the user argument in the (1) listShares function in Server.php or the (2) connect or (3) read function in Share.php.",
    "cve_publish_date": "2015-10-21",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "improve support for workgroups/domains",
    "type_of_change": "Modification",
    "filename_of_changes": "NativeShare.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 46: \t\t$user = $this->server->getUser();",
        "// Line_Reference 47: \t\tif (strpos($user, '/')) {",
        "// Line_Reference 48: \t\t\tlist($workgroup, $user) = explode('/', $user);",
        "// Line_Reference 49: \t\t} elseif (strpos($user, '\\\\')) {",
        "// Line_Reference 50: \t\t\tlist($workgroup, $user) = explode('\\\\', $user);",
        "// Line_Reference 51: \t\t} else {",
        "// Line_Reference 52: \t\t\t$workgroup = null;",
        "// Line_Reference 53: \t\t}",
        "// Line_Reference 54: \t\t$this->state->init($workgroup, $user, $this->server->getPassword());"
    ]
}
