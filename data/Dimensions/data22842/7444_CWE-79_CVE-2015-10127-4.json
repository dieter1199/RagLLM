{
    "cve_id": "CVE-2015-10127",
    "cve_description": "A vulnerability was found in PlusCaptcha Plugin up to 2.0.6 on WordPress and classified as problematic. Affected by this issue is some unknown functionality. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 2.0.14 is able to address this issue. The patch is identified as 1274afc635170daafd38306487b6bb8a01f78ecd. It is recommended to upgrade the affected component. VDB-248954 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-12-26",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Solver XSS\n\ngit-svn-id: https://plugins.svn.wordpress.org/pluscaptcha/trunk@1094241 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "admin.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "46",
    "number_of_lines_deleted_vulnerable_to_cve": "44",
    "vulnerable_lines": [
        "// Line_Reference 3: # Clean",
        "// Line_Reference 4: # Limpiar data",
        "// Line_Reference 5: function tags($tags){",
        "// Line_Reference 6: \t$tags = strip_tags($tags);",
        "// Line_Reference 7: \t$tags = stripslashes($tags);",
        "// Line_Reference 8: \t$tags = htmlentities($tags);",
        "// Line_Reference 9: \t$tags = addslashes($tags);",
        "// Line_Reference 10: \treturn trim($tags);",
        "// Line_Reference 11: }",
        "// Line_Reference 111:   if ((isset($_POST[$hidden_field_name])) && ($_POST[$hidden_field_name] == 'Y')) {",
        "// Line_Reference 119: \t  update_option('PlusCaptcha_feedback_quemejoraria', $_POST[\"PlusCaptcha_feedback_quemejoraria\"]);",
        "// Line_Reference 139:   $website = json_encode(empty($_POST['website']) ? \"http://{$_SERVER['SERVER_NAME']}/\" : $_POST['website']);",
        "// Line_Reference 140:   $email = json_encode($_POST['email']);",
        "// Line_Reference 151:   if (isset($_POST['language'])) {",
        "// Line_Reference 152:     $language = (int) $_POST['language'];",
        "// Line_Reference 155:   if (isset($_POST['category'])) {",
        "// Line_Reference 156:     $category = (int) $_POST['category'];",
        "// Line_Reference 159:   if (isset($_POST['site_category'])) {",
        "// Line_Reference 160:     $site_category = (int) $_POST['site_category'];",
        "// Line_Reference 163:   if (isset($_POST['gender'])) {",
        "// Line_Reference 164:     $gender = (int) $_POST['gender'];",
        "// Line_Reference 212:   if ((!$ignore_post) && (isset($_POST[$hidden_field_name])) && ($_POST[$hidden_field_name] == 'Y')) {",
        "// Line_Reference 217:       $opt_val = isset($_POST[$opt_name]) ? $_POST[$opt_name] : null;",
        "// Line_Reference 289:   $plscptf_options_submit['plscptf_user_email'] = $_REQUEST['plscptf_user_email'];",
        "// Line_Reference 290:   $plscptf_options_submit['plscptf_custom_email'] = $_REQUEST['plscptf_custom_email'];",
        "// Line_Reference 291:   $plscptf_options_submit['plscptf_select_email'] = $_REQUEST['plscptf_select_email'];",
        "// Line_Reference 292:   $plscptf_options_submit['plscptf_additions_options'] = isset($_REQUEST['plscptf_additions_options']) ? $_REQUEST['plscptf_additions_options'] : 0;",
        "// Line_Reference 311:     $plscptf_options_submit['plscptf_send_copy'] = isset($_REQUEST['plscptf_send_copy']) ? $_REQUEST['plscptf_send_copy'] : 0;",
        "// Line_Reference 312:     $plscptf_options_submit['plscptf_mail_method'] = $_REQUEST['plscptf_mail_method'];",
        "// Line_Reference 313:     $plscptf_options_submit['plscptf_from_field'] = $_REQUEST['plscptf_from_field'];",
        "// Line_Reference 314:     $plscptf_options_submit['plscptf_display_add_info'] = isset($_REQUEST['plscptf_display_add_info']) ? 1 : 0;",
        "// Line_Reference 315:     $plscptf_options_submit['plscptf_change_label'] = isset($_REQUEST['plscptf_change_label']) ? 1 : 0;",
        "// Line_Reference 317:       $plscptf_options_submit['plscptf_display_sent_from'] = isset($_REQUEST['plscptf_display_sent_from']) ? 1 : 0;",
        "// Line_Reference 318:       $plscptf_options_submit['plscptf_display_date_time'] = isset($_REQUEST['plscptf_display_date_time']) ? 1 : 0;",
        "// Line_Reference 319:       $plscptf_options_submit['plscptf_display_coming_from'] = isset($_REQUEST['plscptf_display_coming_from']) ? 1 : 0;",
        "// Line_Reference 320:       $plscptf_options_submit['plscptf_display_user_agent'] = isset($_REQUEST['plscptf_display_user_agent']) ? 1 : 0;",
        "// Line_Reference 328:       $plscptf_options_submit['plscptf_name_label'] = isset($_REQUEST['plscptf_name_label']) ? $_REQUEST['plscptf_name_label'] : $plscptf_options_submit['plscptf_name_label'];",
        "// Line_Reference 329:       $plscptf_options_submit['plscptf_email_label'] = isset($_REQUEST['plscptf_email_label']) ? $_REQUEST['plscptf_email_label'] : $plscptf_options_submit['plscptf_email_label'];",
        "// Line_Reference 330:       $plscptf_options_submit['plscptf_subject_label'] = isset($_REQUEST['plscptf_subject_label']) ? $_REQUEST['plscptf_subject_label'] : $plscptf_options_submit['plscptf_subject_label'];",
        "// Line_Reference 331:       $plscptf_options_submit['plscptf_message_label'] = isset($_REQUEST['plscptf_message_label']) ? $_REQUEST['plscptf_message_label'] : $plscptf_options_submit['plscptf_message_label'];",
        "// Line_Reference 338:     $plscptf_options_submit['plscptf_action_after_send'] = $_REQUEST['plscptf_action_after_send'];",
        "// Line_Reference 339:     $plscptf_options_submit['plscptf_thank_text'] = $_REQUEST['plscptf_thank_text'];",
        "// Line_Reference 340:     $plscptf_options_submit['plscptf_redirect_url'] = $_REQUEST['plscptf_redirect_url'];",
        "// Line_Reference 360:     if ( isset($_REQUEST['PlusCaptcha_form_contact']) ) {"
    ]
}
