{
    "cve_id": "CVE-2015-2830",
    "cve_description": "arch/x86/kernel/entry_64.S in the Linux kernel before 3.19.2 does not prevent the TS_COMPAT flag from reaching a user-mode task, which might allow local users to bypass the seccomp or audit protection mechanism via a crafted application that uses the (1) fork or (2) close system call, as demonstrated by an attack against seccomp before 3.16.",
    "cve_publish_date": "2015-05-27",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "x86/asm/entry/64: Remove a bogus 'ret_from_fork' optimization\n\n'ret_from_fork' checks TIF_IA32 to determine whether 'pt_regs' and\nthe related state make sense for 'ret_from_sys_call'.  This is\nentirely the wrong check.  TS_COMPAT would make a little more\nsense, but there's really no point in keeping this optimization\nat all.\n\nThis fixes a return to the wrong user CS if we came from int\n0x80 in a 64-bit task.\n\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Denys Vlasenko <dvlasenk@redhat.com>\nCc: H. Peter Anvin <hpa@zytor.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: <stable@vger.kernel.org>\nLink: http://lkml.kernel.org/r/4710be56d76ef994ddf59087aad98c000fbab9a4.1424989793.git.luto@amacapital.net\n[ Backported from tip:x86/asm. ]\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "entry_64.S",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 272: \ttestl $_TIF_IA32, TI_flags(%rcx)\t# 32-bit compat task needs IRET",
        "// Line_Reference 273: \tjnz  int_ret_from_sys_call",
        "// Line_Reference 274: ",
        "// Line_Reference 275: \tRESTORE_TOP_OF_STACK %rdi, -ARGOFFSET",
        "// Line_Reference 276: \tjmp ret_from_sys_call\t\t\t# go to the SYSRET fastpath"
    ]
}
