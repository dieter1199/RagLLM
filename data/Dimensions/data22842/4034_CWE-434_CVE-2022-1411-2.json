{
    "cve_id": "CVE-2022-1411",
    "cve_description": "Unrestructed file upload in GitHub repository yetiforcecompany/yetiforcecrm prior to 6.4.0. Attacker can send malicious files to the victims is able to retrieve the stored data from the web application without that data being made safe to render in the browser and steals victim's cookie leads to account takeover.",
    "cve_publish_date": "2022-05-05",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "Added validation to pasted files to the wysiwyg editor",
    "type_of_change": "Modification",
    "filename_of_changes": "File.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 884: \t\t$result = explode(',', $contents, 2);",
        "// Line_Reference 885: \t\t$contentType = $isBase64 = false;",
        "// Line_Reference 886: \t\tif (2 === \\count($result)) {",
        "// Line_Reference 887: \t\t\t[$metadata, $data] = $result;",
        "// Line_Reference 888: \t\t\tforeach (explode(';', $metadata) as $cur) {",
        "// Line_Reference 889: \t\t\t\tif ('base64' === $cur) {",
        "// Line_Reference 890: \t\t\t\t\t$isBase64 = true;",
        "// Line_Reference 891: \t\t\t\t} elseif ('data:' === substr($cur, 0, 5)) {",
        "// Line_Reference 892: \t\t\t\t\t$contentType = str_replace('data:', '', $cur);",
        "// Line_Reference 893: \t\t\t\t}",
        "// Line_Reference 894: \t\t\t}",
        "// Line_Reference 895: \t\t} else {",
        "// Line_Reference 896: \t\t\t$data = $result[0];",
        "// Line_Reference 897: \t\t}",
        "// Line_Reference 898: \t\t$data = rawurldecode($data);",
        "// Line_Reference 899: \t\t$rawData = $isBase64 ? base64_decode($data) : $data;",
        "// Line_Reference 900: \t\tif (\\strlen($rawData) < 12) {",
        "// Line_Reference 901: \t\t\tLog::error('Incorrect content value: ' . $contents, __CLASS__);",
        "// Line_Reference 902: \t\t\treturn false;",
        "// Line_Reference 903: \t\t}",
        "// Line_Reference 904: \t\t$fileInstance = static::loadFromContent($rawData, false, array_merge($param, ['mimeType' => $contentType]));",
        "// Line_Reference 1233: \t\t\t'crmid' => 0"
    ]
}
