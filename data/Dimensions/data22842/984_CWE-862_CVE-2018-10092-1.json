{
    "cve_id": "CVE-2018-10092",
    "cve_description": "The admin panel in Dolibarr before 7.0.2 might allow remote attackers to execute arbitrary commands by leveraging support for updating the antivirus command and parameters used to scan file uploads.",
    "cve_publish_date": "2018-05-22",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "FIX CVE-2018-10092",
    "type_of_change": "Modification",
    "filename_of_changes": "security_file.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 87: \t$res5=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_COMMAND\", trim(GETPOST('MAIN_ANTIVIRUS_COMMAND','none')),'chaine',0,'',$conf->entity);    // Use GETPOST none because we must accept \"",
        "// Line_Reference 88: \t$res6=dolibarr_set_const($db, \"MAIN_ANTIVIRUS_PARAM\", trim(GETPOST('MAIN_ANTIVIRUS_PARAM','none')),'chaine',0,'',$conf->entity);\t// Use GETPOST none because we must accept \"",
        "// Line_Reference 98: \t$file = $conf->admin->dir_temp . '/' . GETPOST('urlfile');\t// Do not use urldecode here ($_GET and $_REQUEST are already decoded by PHP).",
        "// Line_Reference 100: \tif ($ret) setEventMessages($langs->trans(\"FileWasRemoved\", GETPOST('urlfile')), null, 'mesgs');",
        "// Line_Reference 101: \telse setEventMessages($langs->trans(\"ErrorFailToDeleteFile\", GETPOST('urlfile')), null, 'errors');"
    ]
}
