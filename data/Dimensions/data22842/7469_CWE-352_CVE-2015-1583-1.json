{
    "cve_id": "CVE-2015-1583",
    "cve_description": "Multiple cross-site request forgery (CSRF) vulnerabilities in ATutor 2.2 allow remote attackers to hijack the authentication of administrators for requests that (1) create an administrator account via a request to mods/_core/users/admins/create.php or (2) create a user account via a request to mods/_core/users/create_user.php.",
    "cve_publish_date": "2020-03-02",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "5566 created a more general function to check referer, and updated create user and create admin to use it",
    "type_of_change": "Modification",
    "filename_of_changes": "create.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 18: if($_SERVER['HTTP_REFERER'] != $_SERVER['PHP_SELF']){",
        "// Line_Reference 19:     $referer_script = preg_replace('#'.$_base_href.'#', '', $_SERVER['HTTP_REFERER']);",
        "// Line_Reference 20:     if(!in_array($_pages[$referer_script], $_pages)){",
        "// Line_Reference 21:     echo \"not a valid referer\";",
        "// Line_Reference 22:     exit;",
        "// Line_Reference 23:     }",
        "// Line_Reference 24: }"
    ]
}
