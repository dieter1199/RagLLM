{
    "cve_id": "CVE-2014-1944",
    "cve_description": "Cross-site scripting (XSS) vulnerability in Ilch CMS 2.0 and earlier allows remote attackers to inject arbitrary web script or HTML via the text parameter to index.php/guestbook/index/newentry.",
    "cve_publish_date": "2014-03-09",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "adding bbcode , new html editor, change guestbook view",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "newentry.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "59",
    "vulnerable_lines": [
        "// Line_Reference 2: <p class=\"pull-right\">",
        "// Line_Reference 3:     <a href=\"<?php echo $this->getUrl(array('action' => 'index')); ?>\"",
        "// Line_Reference 4:        class=\"btn btn-small btn-primary\"",
        "// Line_Reference 5:        type=\"button\">",
        "// Line_Reference 6:         <?php echo $this->getTrans('back'); ?>",
        "// Line_Reference 7:     </a>",
        "// Line_Reference 8: </p>",
        "// Line_Reference 9: <div class=\"form-group\">",
        "// Line_Reference 10:     <form class=\"navbar-form navbar-left\"",
        "// Line_Reference 11:           action=\"<?php $this->getUrl(array('action' => 'newEntry')); ?>\"",
        "// Line_Reference 12:           method=\"post\">",
        "// Line_Reference 13:         <?php echo $this->getTokenField(); ?>",
        "// Line_Reference 14:         <p>",
        "// Line_Reference 15:             <?php echo $this->getTrans('name'); ?>*<br />",
        "// Line_Reference 17:                    name=\"name\"",
        "// Line_Reference 18:                    class=\"form-control\"",
        "// Line_Reference 19:                    placeholder=\"Name\"",
        "// Line_Reference 20:                    required />",
        "// Line_Reference 21:         </p>",
        "// Line_Reference 22:         <p>",
        "// Line_Reference 23:             <?php echo $this->getTrans('email'); ?><br />",
        "// Line_Reference 25:                    name=\"email\"",
        "// Line_Reference 26:                    class=\"form-control\"",
        "// Line_Reference 27:                    placeholder=\"E-Mail\" />",
        "// Line_Reference 28:         </p>",
        "// Line_Reference 29:         <p>",
        "// Line_Reference 30:             <?php echo $this->getTrans('page'); ?><br />",
        "// Line_Reference 31:             <input type=\"text\"",
        "// Line_Reference 32:                    name=\"homepage\"",
        "// Line_Reference 33:                    class=\"form-control\"",
        "// Line_Reference 34:                    placeholder=\"<?php echo $this->getTrans('page'); ?>\" />",
        "// Line_Reference 35:         </p>",
        "// Line_Reference 36:         <p>",
        "// Line_Reference 37:             <?php echo $this->getTrans('message'); ?>*<br />",
        "// Line_Reference 38:             <textarea id=\"guestbook_message\"",
        "// Line_Reference 39:                       name=\"text\"",
        "// Line_Reference 40:                       cols=\"40\"",
        "// Line_Reference 41:                       rows=\"5\"",
        "// Line_Reference 44:         </p>",
        "// Line_Reference 45:         <p>",
        "// Line_Reference 46:             <input type=\"submit\"",
        "// Line_Reference 47:                    name=\"saveEntry\"",
        "// Line_Reference 48:                    class=\"btn btn-small btn-primary\"",
        "// Line_Reference 49:                    value=\"<?php echo $this->getTrans('submit'); ?>\" />",
        "// Line_Reference 50:         </p>",
        "// Line_Reference 51:     </form>",
        "// Line_Reference 52: </div>",
        "// Line_Reference 53: ",
        "// Line_Reference 54: <script type=\"text/javascript\" src=\"<?php echo $this->getStaticUrl('js/tinymce/tinymce.min.js') ?>\"></script>",
        "// Line_Reference 55: <script>",
        "// Line_Reference 56:     tinymce.init",
        "// Line_Reference 57:     (",
        "// Line_Reference 58:         {",
        "// Line_Reference 59:             height: 400,",
        "// Line_Reference 60:             selector: \"#guestbook_message\",",
        "// Line_Reference 61:             plugins: \"image preview table\"",
        "// Line_Reference 62:         }",
        "// Line_Reference 63:     );",
        "// Line_Reference 64: </script>"
    ]
}
