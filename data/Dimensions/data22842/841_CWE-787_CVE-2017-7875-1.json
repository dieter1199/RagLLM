{
    "cve_id": "CVE-2017-7875",
    "cve_description": "In wallpaper.c in feh before v2.18.3, if a malicious client pretends to be the E17 window manager, it is possible to trigger an out-of-boundary heap write while receiving an IPC message. An integer overflow leads to a buffer overflow and/or a double free.",
    "cve_publish_date": "2017-04-14",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix double-free/OOB-write while receiving IPC data\n\nIf a malicious client pretends to be the E17 window manager, it is\npossible to trigger an out of boundary heap write while receiving an\nIPC message.\n\nThe length of the already received message is stored in an unsigned\nshort, which overflows after receiving 64 KB of data. It's comparably\nsmall amount of data and therefore achievable for an attacker.\n\nWhen len overflows, realloc() will either be called with a small value\nand therefore chars will be appended out of bounds, or len + 1 will be\nexactly 0, in which case realloc() behaves like free(). This could be\nabused for a later double-free attack as it's even possible to overwrite\nthe free information -- but this depends on the malloc implementation.\n\nSigned-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "wallpaper.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 798: \tstatic unsigned short len = 0;"
    ]
}
