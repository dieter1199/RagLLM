{
    "cve_id": "CVE-2018-1000119",
    "cve_description": "Sinatra rack-protection versions 1.5.4 and 2.0.0.rc3 and earlier contains a timing attack vulnerability in the CSRF token checking that can result in signatures can be exposed. This attack appear to be exploitable via network connectivity to the ruby application. This vulnerability appears to have been fixed in 1.5.5 and 2.0.0.",
    "cve_publish_date": "2018-03-07",
    "cwe_id": "CWE-203",
    "cwe_name": "Observable Discrepancy",
    "cwe_description": "The product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.",
    "commit_message": "Use secure_compare when checking CSRF token\n\nSince string comparisions may return early we want to use a constant\ntime comparsion function to protect the CSRF token against timing\nattacks. Rack::Utils provides a such function.",
    "type_of_change": "Modification",
    "filename_of_changes": "authenticity_token.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 26:           env['HTTP_X_CSRF_TOKEN'] == token ||",
        "// Line_Reference 27:           Request.new(env).params[options[:authenticity_param]] == token"
    ]
}
