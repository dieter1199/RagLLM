{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "AdminController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "74",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 2284:                         $status[$moduleName]['messages'][] = Yii::t('admin',",
        "// Line_Reference 2285:                             'Backup failed. Unable to write to backup directory.');",
        "// Line_Reference 3028:             // Save hidden condition in criteria to",
        "// Line_Reference 3061:                     $record->$fieldName = $record->$fieldName == 1 ? 'Public' : 'Private';",
        "// Line_Reference 3069:                 $recordAttributes = array_merge($recordAttributes, array(",
        "// Line_Reference 3070:                     'actionDescription' => $record->actionDescription",
        "// Line_Reference 3071:                 ));",
        "// Line_Reference 3773:         if ($model->hasAttribute('visibility')) {",
        "// Line_Reference 3774:             // Nobody every remembers to set visibility... set it for them",
        "// Line_Reference 3775:             if(empty($model->visibility) && ($model->visibility !== 0 && $model->visibility !== \"0\")",
        "// Line_Reference 3776:                     || $model->visibility == 'Public') {",
        "// Line_Reference 3777:                 $model->visibility = 1;",
        "// Line_Reference 3778:             } elseif($model->visibility == 'Private')",
        "// Line_Reference 3779:                 $model->visibility = 0;",
        "// Line_Reference 3780:         }",
        "// Line_Reference 4585:         $dropdowns = Dropdowns::model()->findAll();",
        "// Line_Reference 4606:         if (isset($_POST['Dropdowns'])) {",
        "// Line_Reference 4875:         if (isset($_GET['importId'])) {"
    ]
}
