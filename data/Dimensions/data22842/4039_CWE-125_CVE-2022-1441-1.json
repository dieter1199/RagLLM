{
    "cve_id": "CVE-2022-1441",
    "cve_description": "MP4Box is a component of GPAC-2.0.0, which is a widely-used third-party package on RPM Fusion. When MP4Box tries to parse a MP4 file, it calls the function `diST_box_read()` to read from video. In this function, it allocates a buffer `str` with fixed length. However, content read from `bs` is controllable by user, so is the length, which causes a buffer overflow.",
    "cve_publish_date": "2022-04-25",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "fixed #2175",
    "type_of_change": "Modification",
    "filename_of_changes": "box_code_3gpp.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1131: \tu32 i;",
        "// Line_Reference 1132: \tchar str[1024];",
        "// Line_Reference 1135: \ti=0;",
        "// Line_Reference 1136: \tstr[0]=0;",
        "// Line_Reference 1137: \twhile (1) {",
        "// Line_Reference 1138: \t\tstr[i] = gf_bs_read_u8(bs);",
        "// Line_Reference 1139: \t\tif (!str[i]) break;",
        "// Line_Reference 1140: \t\ti++;",
        "// Line_Reference 1141: \t}",
        "// Line_Reference 1142: \tISOM_DECREASE_SIZE(p, i);",
        "// Line_Reference 1143: ",
        "// Line_Reference 1144: \tp->content_script_types = gf_strdup(str);"
    ]
}
