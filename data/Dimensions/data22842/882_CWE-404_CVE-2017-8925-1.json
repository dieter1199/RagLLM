{
    "cve_id": "CVE-2017-8925",
    "cve_description": "The omninet_open function in drivers/usb/serial/omninet.c in the Linux kernel before 4.10.4 allows local users to cause a denial of service (tty exhaustion) by leveraging reference count mishandling.",
    "cve_publish_date": "2017-05-12",
    "cwe_id": "CWE-404",
    "cwe_name": "Improper Resource Shutdown or Release",
    "cwe_description": "The product does not release or incorrectly releases a resource before it is made available for re-use.",
    "commit_message": "USB: serial: omninet: fix reference leaks at open\n\nThis driver needlessly took another reference to the tty on open, a\nreference which was then never released on close. This lead to not just\na leak of the tty, but also a driver reference leak that prevented the\ndriver from being unloaded after a port had once been opened.\n\nFixes: 4a90f09b20f4 (\"tty: usb-serial krefs\")\nCc: stable <stable@vger.kernel.org>\t# 2.6.28\nSigned-off-by: Johan Hovold <johan@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "omninet.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 145: \tstruct usb_serial\t*serial = port->serial;",
        "// Line_Reference 146: \tstruct usb_serial_port\t*wport;",
        "// Line_Reference 147: ",
        "// Line_Reference 148: \twport = serial->port[1];",
        "// Line_Reference 149: \ttty_port_tty_set(&wport->port, tty);",
        "// Line_Reference 150: "
    ]
}
