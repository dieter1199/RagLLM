{
    "cve_id": "CVE-2021-32634",
    "cve_description": "Emissary is a distributed, peer-to-peer, data-driven workflow framework. Emissary 6.4.0 is vulnerable to Unsafe Deserialization of post-authenticated requests to the [`WorkSpaceClientEnqueue.action`](https://github.com/NationalSecurityAgency/emissary/blob/30c54ef16c6eb6ed09604a929939fb9f66868382/src/main/java/emissary/server/mvc/internal/WorkSpaceClientEnqueueAction.java) REST endpoint. This issue may lead to post-auth Remote Code Execution. This issue has been patched in version 6.5.0. As a workaround, one can disable network access to Emissary from untrusted sources.",
    "cve_publish_date": "2021-05-21",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "Merge pull request from GHSA-m5qf-gfmp-7638\n\n* Remove unsafe serialization from PayloadUtil\n\n* This code will likely be removed wholesale, but this change\n  should be used as a departure point for future development\n  if we end up re-implementing moveTo and friends.\n\n* Removed vestigial MoveTo related code.\n\n* Remove unsafe serialization in WorkSpace infra.\n\n* Favor DataInput/DataOutputStream over ObjectInput/ObjectOutputStream\n* Implement lightweight serialization in WorkBundle/WorkUnit\n\n* Updates to WorkBundle serDe, added tests.\n\n- set limit on number of WorkUnits per bundle. In practice these are\n  commonly less than 1024.\n- added null handling for WorkBundle/WorkUnit string fields.\n- confirmed readUTF/writeUTF has a limit ensuring strings will\n  be 65535 characters or less.\n\n* Minor cleanup to WorkBundleTest\n\n* Minor Change to WorkBundleTest\n\n* Formatting updates",
    "type_of_change": "Modification",
    "filename_of_changes": "PayloadUtilTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 124:     @Test",
        "// Line_Reference 125:     public void testByteSerialization() throws Exception {",
        "// Line_Reference 126:         final IBaseDataObject d = DataObjectFactory.getInstance(\"abc\".getBytes(), \"testfile\", Form.UNKNOWN);",
        "// Line_Reference 127:         final byte[] bytes = PayloadUtil.serializeToBytes(d);",
        "// Line_Reference 128:         final String s1 = new String(bytes);",
        "// Line_Reference 129:         assertTrue(\"Serializedion must include data from payload\", s1.indexOf(\"abc\") > -1);",
        "// Line_Reference 130:     }",
        "// Line_Reference 131: "
    ]
}
