{
    "cve_id": "CVE-2022-41967",
    "cve_description": "Dragonfly is a Java runtime dependency management library. Dragonfly v0.3.0-SNAPSHOT does not configure DocumentBuilderFactory to prevent XML external entity (XXE) attacks. This issue is patched in 0.3.1-SNAPSHOT. As a workaround, since Dragonfly only parses XML `SNAPSHOT` versions are being resolved, this vulnerability may be avoided by not trying to resolve `SNAPSHOT` versions.",
    "cve_publish_date": "2022-12-28",
    "cwe_id": "CWE-611",
    "cwe_name": "Improper Restriction of XML External Entity Reference",
    "cwe_description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
    "commit_message": "fix: CVE-2022-41967\n\nDragonfly v0.3.0-SNAPSHOT fails to properly configure the\nDocumentBuilderFactory to prevent XML enternal entity (XXE) attacks when\nparsing maven-metadata.xml files provided by external Maven repositories\nduring \"SNAPSHOT\" version resolution.\n\nThis patches CVE-2022-41967 by disabling features which may lead to XXE.\nIf you are currently using v0.3.0-SNAPSHOT it is STRONGLY advised to\nupdate Dragonfly to v0.3.1-SNAPSHOT just to be safe.",
    "type_of_change": "Modification",
    "filename_of_changes": "Dragonfly.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 50: \tprivate static final String VERSION = \"0.3.0-SNAPSHOT\";",
        "// Line_Reference 53: \tprivate final Path directory;",
        "// Line_Reference 54: \tprivate final Set<String> repositories;",
        "// Line_Reference 55: \tprivate final Consumer<Status> statusHandler;",
        "// Line_Reference 57: \tprivate final DependencyDownloader dependencyDownloader = new DependencyDownloader(this);",
        "// Line_Reference 58: \tprivate final DependencyRelocator dependencyRelocator;",
        "// Line_Reference 59: \tprivate final DependencyLoader dependencyLoader;",
        "// Line_Reference 77: \tpublic static String getVersion() {",
        "// Line_Reference 87: \tpublic CompletableFuture<Boolean> load(Dependency... dependencies) {",
        "// Line_Reference 140: \tpublic Path getDirectory() {",
        "// Line_Reference 144: \tpublic Set<String> getRepositories() {",
        "// Line_Reference 154: \tpublic DependencyDownloader getDependencyDownloader() {"
    ]
}
