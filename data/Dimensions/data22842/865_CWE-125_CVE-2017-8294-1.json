{
    "cve_id": "CVE-2017-8294",
    "cve_description": "libyara/re.c in the regex component in YARA 3.5.0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted rule that is mishandled in the yr_re_exec function.",
    "cve_publish_date": "2017-04-27",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix issue #646 (#648)\n\n* Fix issue #646 and some edge cases with wide regexps using \\b and \\B\r\n\r\n* Rename function IS_WORD_CHAR to _yr_re_is_word_char",
    "type_of_change": "Modification",
    "filename_of_changes": "re.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "79",
    "number_of_lines_deleted_vulnerable_to_cve": "31",
    "vulnerable_lines": [
        "// Line_Reference 1802: // Executes a regular expression",
        "// Line_Reference 1807: //   size_t input_size                - Input data size",
        "// Line_Reference 1813: //      RE_FLAGS_NOT_AT_START",
        "// Line_Reference 1831:     size_t input_size,",
        "// Line_Reference 1861:   #define prolog if (bytes_matched >= max_bytes_matched) \\",
        "// Line_Reference 1865:       }",
        "// Line_Reference 1867:   #define fail_if_error(e) switch (e) { \\",
        "// Line_Reference 1872:       }",
        "// Line_Reference 1890: ",
        "// Line_Reference 1891:   max_bytes_matched = (int) yr_min(input_size, RE_SCAN_LIMIT);",
        "// Line_Reference 1894:   // character_size is 2 and input_size is odd we are ignoring the",
        "// Line_Reference 1976:           match = IS_WORD_CHAR(*input);",
        "// Line_Reference 1983:           match = !IS_WORD_CHAR(*input);",
        "// Line_Reference 2031:           if (bytes_matched == 0 &&",
        "// Line_Reference 2032:               !(flags & RE_FLAGS_NOT_AT_START) &&",
        "// Line_Reference 2033:               !(flags & RE_FLAGS_BACKWARDS))",
        "// Line_Reference 2037:           else if (IS_WORD_CHAR(*(input - input_incr)) != IS_WORD_CHAR(*input))",
        "// Line_Reference 2038:             match = TRUE;",
        "// Line_Reference 2040:             match = FALSE;",
        "// Line_Reference 2051:             kill = input_size > (size_t) bytes_matched;",
        "// Line_Reference 2053:             kill = (flags & RE_FLAGS_NOT_AT_START) || (bytes_matched != 0);",
        "// Line_Reference 2060:                  input_size > (size_t) bytes_matched;",
        "// Line_Reference 2137:     if (flags & RE_FLAGS_WIDE &&",
        "// Line_Reference 2138:         bytes_matched < max_bytes_matched &&",
        "// Line_Reference 2139:         *(input + 1) != 0)",
        "// Line_Reference 2140:     {",
        "// Line_Reference 2141:       _yr_re_fiber_kill_all(&fibers, &storage->fiber_pool);",
        "// Line_Reference 2142:     }",
        "// Line_Reference 2143: ",
        "// Line_Reference 2167:     size_t input_size,",
        "// Line_Reference 2190:   int max_bytes_matched = input_size;"
    ]
}
