{
    "cve_id": "CVE-2024-34080",
    "cve_description": "MantisBT (Mantis Bug Tracker) is an open source issue tracker. If an issue references a note that belongs to another issue that the user doesn't have access to, then it gets hyperlinked. Clicking on the link gives an access denied error as expected, yet some information remains available via the link, link label, and tooltip. This can result in disclosure of the existence of the note, the note author name, the note creation timestamp, and the issue id the note belongs to. Version 2.26.2 contains a patch for the issue. No known workarounds are available.",
    "cve_publish_date": "2024-05-14",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix access level check for note links\n\nFixes #34434",
    "type_of_change": "Modification",
    "filename_of_changes": "string_api.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 423: \t\t\t\t\t\t\t$g_project_override = bug_get_field( $t_bug_id, 'project_id' );",
        "// Line_Reference 424: \t\t\t\t\t\t\tif(   access_compare_level(",
        "// Line_Reference 425: \t\t\t\t\t\t\t\t\t\tuser_get_access_level( auth_get_current_user_id(),",
        "// Line_Reference 426: \t\t\t\t\t\t\t\t\t\tbug_get_field( $t_bug_id, 'project_id' ) ),",
        "// Line_Reference 427: \t\t\t\t\t\t\t\t\t\tconfig_get( 'private_bugnote_threshold' )",
        "// Line_Reference 428: \t\t\t\t\t\t\t\t   )",
        "// Line_Reference 429: \t\t\t\t\t\t\t\t|| bugnote_get_field( $c_bugnote_id, 'reporter_id' ) == auth_get_current_user_id()",
        "// Line_Reference 430: \t\t\t\t\t\t\t\t|| bugnote_get_field( $c_bugnote_id, 'view_state' ) == VS_PUBLIC",
        "// Line_Reference 431: \t\t\t\t\t\t\t) {",
        "// Line_Reference 432: \t\t\t\t\t\t\t\t$g_project_override = null;",
        "// Line_Reference 433: \t\t\t\t\t\t\t\treturn $p_array[1] .",
        "// Line_Reference 434: \t\t\t\t\t\t\t\t\tstring_get_bugnote_view_link(",
        "// Line_Reference 435: \t\t\t\t\t\t\t\t\t\t$t_bug_id,",
        "// Line_Reference 436: \t\t\t\t\t\t\t\t\t\t$c_bugnote_id,",
        "// Line_Reference 437: \t\t\t\t\t\t\t\t\t\t(boolean)$p_detail_info,",
        "// Line_Reference 438: \t\t\t\t\t\t\t\t\t\t(boolean)$p_fqdn",
        "// Line_Reference 439: \t\t\t\t\t\t\t\t\t);"
    ]
}
