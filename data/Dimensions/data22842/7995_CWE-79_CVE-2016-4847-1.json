{
    "cve_id": "CVE-2016-4847",
    "cve_description": "Cross-site scripting (XSS) vulnerability in site/search.php in OSSEC Web UI before 0.9 allows remote attackers to inject arbitrary web script or HTML by leveraging an unanchored regex.",
    "cve_publish_date": "2017-04-20",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Unanchored regex would allow badness through.  This patch eliminates a\nXSS identified by JPCERT Reference number: JVN#58455472",
    "type_of_change": "Modification",
    "filename_of_changes": "search.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "36",
    "vulnerable_lines": [
        "// Line_Reference 12: ",
        "// Line_Reference 57:     if(preg_match('/[a-z0-9]+/', $_POST['searchid']))",
        "// Line_Reference 102: {",
        "// Line_Reference 110: {",
        "// Line_Reference 118: {",
        "// Line_Reference 119:     if((is_numeric($_POST['level'])) &&",
        "// Line_Reference 154:     $lcpattern = \"/^[0-9a-zA-Z.: _|^!>\\/\\\\-]{1,156}$/\";",
        "// Line_Reference 234: }",
        "// Line_Reference 301:     <td>From: &nbsp;<input type=\"text\" name=\"initdate\"",
        "// Line_Reference 303:     value=\"'.date('Y-m-d H:i', $u_init_time).'\" maxlength=\"16\"",
        "// Line_Reference 309:     value=\"'.date('Y-m-d H:i', $u_final_time).'\" maxlength=\"16\"",
        "// Line_Reference 317: echo '<tr><td><input type=\"radio\" name=\"monitoring\" value=\"1\" '.$rt_sk.'/></td>",
        "// Line_Reference 377: echo '</td></tr><tr><td>",
        "// Line_Reference 378:     Pattern: </td><td><input type=\"text\" name=\"strpattern\" size=\"16\"",
        "// Line_Reference 412: echo '</td></tr><tr><td>",
        "// Line_Reference 414:     <input type=\"text\" name=\"srcippattern\" size=\"16\" class=\"formText\"",
        "// Line_Reference 419:     User: </td><td><input type=\"text\" name=\"userpattern\" size=\"8\"",
        "// Line_Reference 423: echo '<tr><td>",
        "// Line_Reference 425:     <input type=\"text\" name=\"locationpattern\" size=\"16\" class=\"formText\"",
        "// Line_Reference 430:     Rule id: </td><td><input type=\"text\" name=\"rulepattern\" size=\"8\"",
        "// Line_Reference 440: /* Agent */",
        "// Line_Reference 442: ",
        "// Line_Reference 445:     <tr><td>",
        "// Line_Reference 460: button          :   \"i_trigger\",",
        "// Line_Reference 467: button          :   \"f_trigger\",",
        "// Line_Reference 500:                                    $USER_init, $USER_final,",
        "// Line_Reference 556: ",
        "// Line_Reference 566:     <input type=\"hidden\" name=\"initdate\"",
        "// Line_Reference 567:            value=\"'.date('Y-m-d H:i', $u_init_time).'\" />",
        "// Line_Reference 568:     <input type=\"hidden\" name=\"finaldate\"",
        "// Line_Reference 569:            value=\"'.date('Y-m-d H:i', $u_final_time).'\" />",
        "// Line_Reference 578:     <input type=\"hidden\" name=\"max_alerts_per_page\"",
        "// Line_Reference 583: {",
        "// Line_Reference 584: echo '",
        "// Line_Reference 589:            class=\"formText\" />",
        "// Line_Reference 596: if(!isset($output_list[0]{$real_page}) ||"
    ]
}
