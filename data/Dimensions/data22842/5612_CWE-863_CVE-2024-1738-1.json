{
    "cve_id": "CVE-2024-1738",
    "cve_description": "An incorrect authorization vulnerability exists in the lunary-ai/lunary repository, specifically within the evaluations.get route in the evaluations API endpoint. This vulnerability allows unauthorized users to retrieve the results of any organization's evaluation by simply knowing the evaluation ID, due to the lack of project ID verification in the SQL query. As a result, attackers can gain access to potentially private data contained within the evaluation results.",
    "cve_publish_date": "2024-04-16",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "fix: get evaluation result (#181)",
    "type_of_change": "Modification",
    "filename_of_changes": "index.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 127:   select",
        "// Line_Reference 128:     *,",
        "// Line_Reference 129:     p.id as prompt_id",
        "// Line_Reference 130:   from",
        "// Line_Reference 131:     evaluation_result er",
        "// Line_Reference 132:     left join dataset_prompt p on p.id = er.prompt_id",
        "// Line_Reference 133:     left join dataset_prompt_variation pv on pv.id = er.variation_id",
        "// Line_Reference 134:   where",
        "// Line_Reference 135:     er.evaluation_id = ${evaluationId}`"
    ]
}
