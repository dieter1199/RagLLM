{
    "cve_id": "CVE-2015-8631",
    "cve_description": "Multiple memory leaks in kadmin/server/server_stubs.c in kadmind in MIT Kerberos 5 (aka krb5) before 1.13.4 and 1.14.x before 1.14.1 allow remote authenticated users to cause a denial of service (memory consumption) via a request specifying a NULL principal name.",
    "cve_publish_date": "2016-02-13",
    "cwe_id": "CWE-772",
    "cwe_name": "Missing Release of Resource after Effective Lifetime",
    "cwe_description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed.",
    "commit_message": "Fix leaks in kadmin server stubs [CVE-2015-8631]\n\nIn each kadmind server stub, initialize the client_name and\nserver_name variables, and release them in the cleanup handler.  Many\nof the stubs will otherwise leak the client and server name if\nkrb5_unparse_name() fails.  Also make sure to free the prime_arg\nvariables in rename_principal_2_svc(), or we can leak the first one if\nunparsing the second one fails.  Discovered by Simo Sorce.\n\nCVE-2015-8631:\n\nIn all versions of MIT krb5, an authenticated attacker can cause\nkadmind to leak memory by supplying a null principal name in a request\nwhich uses one.  Repeating these requests will eventually cause\nkadmind to exhaust all available memory.\n\n    CVSSv2 Vector: AV:N/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C\n\nticket: 8343 (new)\ntarget_version: 1.14-next\ntarget_version: 1.13-next\ntags: pullup",
    "type_of_change": "Modification",
    "filename_of_changes": "server_stubs.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "77",
    "number_of_lines_deleted_vulnerable_to_cve": "74",
    "vulnerable_lines": [
        "// Line_Reference 337:     gss_buffer_desc             client_name, service_name;",
        "// Line_Reference 385:     gss_release_buffer(&minor_stat, &client_name);",
        "// Line_Reference 386:     gss_release_buffer(&minor_stat, &service_name);",
        "// Line_Reference 398:     gss_buffer_desc             client_name, service_name;",
        "// Line_Reference 447:     gss_release_buffer(&minor_stat, &client_name);",
        "// Line_Reference 448:     gss_release_buffer(&minor_stat, &service_name);",
        "// Line_Reference 460:     gss_buffer_desc                 client_name,",
        "// Line_Reference 461:         service_name;",
        "// Line_Reference 504:     gss_release_buffer(&minor_stat, &client_name);",
        "// Line_Reference 505:     gss_release_buffer(&minor_stat, &service_name);",
        "// Line_Reference 517:     gss_buffer_desc                 client_name,",
        "// Line_Reference 518:         service_name;",
        "// Line_Reference 564: exit_func:",
        "// Line_Reference 573:     char                        *prime_arg1,",
        "// Line_Reference 574:         *prime_arg2;",
        "// Line_Reference 575:     gss_buffer_desc             client_name,",
        "// Line_Reference 576:         service_name;",
        "// Line_Reference 662: exit_func:",
        "// Line_Reference 672:     gss_buffer_desc                 client_name,",
        "// Line_Reference 673:         service_name;",
        "// Line_Reference 724: exit_func:",
        "// Line_Reference 734:     gss_buffer_desc                 client_name,",
        "// Line_Reference 735:         service_name;",
        "// Line_Reference 782: exit_func:",
        "// Line_Reference 792:     gss_buffer_desc                 client_name,",
        "// Line_Reference 793:         service_name;",
        "// Line_Reference 845: exit_func:",
        "// Line_Reference 855:     gss_buffer_desc                 client_name,",
        "// Line_Reference 856:         service_name;",
        "// Line_Reference 914: exit_func:",
        "// Line_Reference 924:     gss_buffer_desc                 client_name,",
        "// Line_Reference 925:         service_name;",
        "// Line_Reference 974: exit_func:",
        "// Line_Reference 984:     gss_buffer_desc                 client_name,",
        "// Line_Reference 985:         service_name;",
        "// Line_Reference 1034: exit_func:",
        "// Line_Reference 1044:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1045:         service_name;",
        "// Line_Reference 1097: exit_func:",
        "// Line_Reference 1109:     gss_buffer_desc             client_name,",
        "// Line_Reference 1110:         service_name;",
        "// Line_Reference 1169: exit_func:",
        "// Line_Reference 1181:     gss_buffer_desc             client_name,",
        "// Line_Reference 1182:         service_name;",
        "// Line_Reference 1246: exit_func:",
        "// Line_Reference 1256:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1257:         service_name;",
        "// Line_Reference 1300: exit_func:",
        "// Line_Reference 1310:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1311:         service_name;",
        "// Line_Reference 1352: exit_func:",
        "// Line_Reference 1362:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1363:         service_name;",
        "// Line_Reference 1405: exit_func:",
        "// Line_Reference 1416:     gss_buffer_desc             client_name,",
        "// Line_Reference 1417:         service_name;",
        "// Line_Reference 1480: exit_func:",
        "// Line_Reference 1491:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1492:         service_name;",
        "// Line_Reference 1536: exit_func:",
        "// Line_Reference 1544:     gss_buffer_desc                client_name, service_name;",
        "// Line_Reference 1576: exit_func:",
        "// Line_Reference 1586:     gss_buffer_desc             client_name, service_name;",
        "// Line_Reference 1634: exit_func:",
        "// Line_Reference 1644:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1645:         service_name;",
        "// Line_Reference 1693: exit_func:",
        "// Line_Reference 1703:     gss_buffer_desc                 client_name,",
        "// Line_Reference 1704:         service_name;",
        "// Line_Reference 1749: exit_func:",
        "// Line_Reference 1757:     gss_buffer_desc            client_name,",
        "// Line_Reference 1758:         service_name;",
        "// Line_Reference 1800:     gss_release_buffer(&minor_stat, &client_name);",
        "// Line_Reference 1801:     gss_release_buffer(&minor_stat, &service_name);"
    ]
}
