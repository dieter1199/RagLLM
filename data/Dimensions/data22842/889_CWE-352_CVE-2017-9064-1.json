{
    "cve_id": "CVE-2017-9064",
    "cve_description": "In WordPress before 4.7.5, a Cross Site Request Forgery (CSRF) vulnerability exists in the filesystem credentials dialog because a nonce is not required for updating credentials.",
    "cve_publish_date": "2017-05-18",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Add nonce for updating file system credentials.\nBuilt from https://develop.svn.wordpress.org/trunk@40723\n\n\ngit-svn-id: http://core.svn.wordpress.org/trunk@40581 1a063a9b-81f0-0310-95a4-ce76da25c4cd",
    "type_of_change": "Modification",
    "filename_of_changes": "file.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 1095: \t$credentials['hostname'] = defined('FTP_HOST') ? FTP_HOST : (!empty($_POST['hostname']) ? wp_unslash( $_POST['hostname'] ) : $credentials['hostname']);",
        "// Line_Reference 1096: \t$credentials['username'] = defined('FTP_USER') ? FTP_USER : (!empty($_POST['username']) ? wp_unslash( $_POST['username'] ) : $credentials['username']);",
        "// Line_Reference 1097: \t$credentials['password'] = defined('FTP_PASS') ? FTP_PASS : (!empty($_POST['password']) ? wp_unslash( $_POST['password'] ) : '');",
        "// Line_Reference 1100: \t$credentials['public_key'] = defined('FTP_PUBKEY') ? FTP_PUBKEY : (!empty($_POST['public_key']) ? wp_unslash( $_POST['public_key'] ) : '');",
        "// Line_Reference 1101: \t$credentials['private_key'] = defined('FTP_PRIKEY') ? FTP_PRIKEY : (!empty($_POST['private_key']) ? wp_unslash( $_POST['private_key'] ) : '');",
        "// Line_Reference 1118: \t} elseif ( ! empty( $_POST['connection_type'] ) ) {",
        "// Line_Reference 1119: \t\t$credentials['connection_type'] = wp_unslash( $_POST['connection_type'] );",
        "// Line_Reference 1258: \tif ( isset( $_POST[ $field ] ) )",
        "// Line_Reference 1259: \t\techo '<input type=\"hidden\" name=\"' . esc_attr( $field ) . '\" value=\"' . esc_attr( wp_unslash( $_POST[ $field ] ) ) . '\" />';"
    ]
}
