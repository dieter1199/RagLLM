{
    "cve_id": "CVE-2017-9993",
    "cve_description": "FFmpeg before 2.8.12, 3.0.x and 3.1.x before 3.1.9, 3.2.x before 3.2.6, and 3.3.x before 3.3.2 does not properly restrict HTTP Live Streaming filename extensions and demuxer names, which allows attackers to read arbitrary files via crafted playlist data.",
    "cve_publish_date": "2017-06-28",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "avformat/hls: Check local file extensions\n\nThis reduces the attack surface of local file-system\ninformation leaking.\n\nIt prevents the existing exploit leading to an information leak. As\nwell as similar hypothetical attacks.\n\nLeaks of information from files and symlinks ending in common multimedia extensions\nare still possible. But files with sensitive information like private keys and passwords\ngenerally do not use common multimedia filename extensions.\nIt does not stop leaks via remote addresses in the LAN.\n\nThe existing exploit depends on a specific decoder as well.\nIt does appear though that the exploit should be possible with any decoder.\nThe problem is that as long as sensitive information gets into the decoder,\nthe output of the decoder becomes sensitive as well.\nThe only obvious solution is to prevent access to sensitive information. Or to\ndisable hls or possibly some of its feature. More complex solutions like\nchecking the path to limit access to only subdirectories of the hls path may\nwork as an alternative. But such solutions are fragile and tricky to implement\nportably and would not stop every possible attack nor would they work with all\nvalid hls files.\n\nDevelopers have expressed their dislike / objected to disabling hls by default as well\nas disabling hls with local files. There also where objections against restricting\nremote url file extensions. This here is a less robust but also lower\ninconvenience solution.\nIt can be applied stand alone or together with other solutions.\nlimiting the check to local files was suggested by nevcairiel\n\nThis recommits the security fix without the author name joke which was\noriginally requested by Nicolas.\n\nFound-by: Emil Lerner and Pavel Cheremushkin\nReported-by: Thierry Foucu <tfoucu@google.com>\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "hls.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 621:     if (!av_strstart(proto_name, \"http\", NULL) && !av_strstart(proto_name, \"file\", NULL))"
    ]
}
