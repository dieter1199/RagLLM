{
    "cve_id": "CVE-2024-35191",
    "cve_description": "Formie is a Craft CMS plugin for creating forms. Prior to 2.1.6, users with access to a form's settings can include malicious Twig code into fields that support Twig. These might be the Submission Title or the Success Message. This code will then be executed upon creating a submission, or rendering the text.  This has been fixed in Formie 2.1.6.",
    "cve_publish_date": "2024-05-20",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Change all instances of dynamic Twig to use safe, sandboxed environment to protect against potential security issues",
    "type_of_change": "Modification",
    "filename_of_changes": "SubmissionsController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 696:                 $url = $this->getView()->renderObjectTemplate($settings->pageRedirectUrl, $submission);",
        "// Line_Reference 1018:         $redirectUrl = Craft::$app->getView()->renderObjectTemplate($redirect, $submission);",
        "// Line_Reference 1192:         // Prevent users using long-hand Twig `{{` to prevent injection execution",
        "// Line_Reference 1193:         $submissionTitleFormat = str_replace(['{{', '}}'], ['', ''], $form->settings->submissionTitleFormat);",
        "// Line_Reference 1194: ",
        "// Line_Reference 1195:         $submission->title = Variables::getParsedValue($submissionTitleFormat, $submission, $form);"
    ]
}
