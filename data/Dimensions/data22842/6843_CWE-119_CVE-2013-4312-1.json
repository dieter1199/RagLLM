{
    "cve_id": "CVE-2013-4312",
    "cve_description": "The Linux kernel before 4.4.1 allows local users to bypass file-descriptor limits and cause a denial of service (memory consumption) by sending each descriptor over a UNIX socket before closing it, related to net/unix/af_unix.c and net/unix/garbage.c.",
    "cve_publish_date": "2016-02-08",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "unix: properly account for FDs passed over unix sockets\n\nIt is possible for a process to allocate and accumulate far more FDs than\nthe process' limit by sending them over a unix socket then closing them\nto keep the process' fd count low.\n\nThis change addresses this problem by keeping track of the number of FDs\nin flight per user and preventing non-privileged processes from having\nmore FDs in flight than their configured FD limit.\n\nReported-by: socketpair@gmail.com\nReported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>\nMitigates: CVE-2013-4312 (Linux 2.0+)\nSuggested-by: Linus Torvalds <torvalds@linux-foundation.org>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: Willy Tarreau <w@1wt.eu>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "af_unix.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 1545: \tif (unix_sock_count) {",
        "// Line_Reference 1546: \t\tfor (i = scm->fp->count - 1; i >= 0; i--)",
        "// Line_Reference 1547: \t\t\tunix_inflight(scm->fp->fp[i]);",
        "// Line_Reference 1548: \t}"
    ]
}
