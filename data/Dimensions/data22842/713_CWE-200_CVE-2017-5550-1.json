{
    "cve_id": "CVE-2017-5550",
    "cve_description": "Off-by-one error in the pipe_advance function in lib/iov_iter.c in the Linux kernel before 4.9.5 allows local users to obtain sensitive information from uninitialized heap-memory locations in opportunistic circumstances by reading from a pipe after an incorrect buffer-release decision.",
    "cve_publish_date": "2017-02-06",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "fix a fencepost error in pipe_advance()\n\nThe logics in pipe_advance() used to release all buffers past the new\nposition failed in cases when the number of buffers to release was equal\nto pipe->buffers.  If that happened, none of them had been released,\nleaving pipe full.  Worse, it was trivial to trigger and we end up with\npipe full of uninitialized pages.  IOW, it's an infoleak.\n\nCc: stable@vger.kernel.org # v4.9\nReported-by: \"Alan J. Wylie\" <alan@wylie.me.uk>\nTested-by: \"Alan J. Wylie\" <alan@wylie.me.uk>\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "iov_iter.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 736: \tstruct pipe_buffer *buf;",
        "// Line_Reference 737: \tint idx = i->idx;",
        "// Line_Reference 738: \tsize_t off = i->iov_offset, orig_sz;",
        "// Line_Reference 739: ",
        "// Line_Reference 742: \torig_sz = size;",
        "// Line_Reference 743: ",
        "// Line_Reference 746: \t\t\tsize += off - pipe->bufs[idx].offset;",
        "// Line_Reference 749: \t\t\tif (size <= buf->len)",
        "// Line_Reference 751: \t\t\tsize -= buf->len;",
        "// Line_Reference 754: \t\tbuf->len = size;",
        "// Line_Reference 756: \t\toff = i->iov_offset = buf->offset + size;",
        "// Line_Reference 757: \t}",
        "// Line_Reference 758: \tif (off)",
        "// Line_Reference 759: \t\tidx = next_idx(idx, pipe);",
        "// Line_Reference 760: \tif (pipe->nrbufs) {",
        "// Line_Reference 761: \t\tint unused = (pipe->curbuf + pipe->nrbufs) & (pipe->buffers - 1);",
        "// Line_Reference 762: \t\t/* [curbuf,unused) is in use.  Free [idx,unused) */",
        "// Line_Reference 763: \t\twhile (idx != unused) {",
        "// Line_Reference 764: \t\t\tpipe_buf_release(pipe, &pipe->bufs[idx]);",
        "// Line_Reference 765: \t\t\tidx = next_idx(idx, pipe);",
        "// Line_Reference 766: \t\t\tpipe->nrbufs--;",
        "// Line_Reference 767: \t\t}",
        "// Line_Reference 769: \ti->count -= orig_sz;"
    ]
}
