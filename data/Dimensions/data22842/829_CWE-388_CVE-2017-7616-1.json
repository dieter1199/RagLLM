{
    "cve_id": "CVE-2017-7616",
    "cve_description": "Incorrect error handling in the set_mempolicy and mbind compat syscalls in mm/mempolicy.c in the Linux kernel through 4.10.9 allows local users to obtain sensitive information from uninitialized stack data by triggering failure of a certain bitmap operation.",
    "cve_publish_date": "2017-04-10",
    "cwe_id": "CWE-388",
    "cwe_name": "7PK - Errors",
    "cwe_description": "This category represents one of the phyla in the Seven Pernicious Kingdoms vulnerability classification. It includes weaknesses that occur when an application does not properly handle errors that occur during processing. According to the authors of the Seven Pernicious Kingdoms, \"Errors and error handling represent a class of API. Errors related to error handling are so common that they deserve a special kingdom of their own. As with 'API Abuse,' there are two ways to introduce an error-related security vulnerability: the most common one is handling errors poorly (or not at all). The second is producing errors that either give out too much information (to possible attackers) or are difficult to handle.\"",
    "commit_message": "mm/mempolicy.c: fix error handling in set_mempolicy and mbind.\n\nIn the case that compat_get_bitmap fails we do not want to copy the\nbitmap to the user as it will contain uninitialized stack data and leak\nsensitive data.\n\nSigned-off-by: Chris Salls <salls@cs.ucsb.edu>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "mempolicy.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 1532: \tlong err = 0;",
        "// Line_Reference 1541: \t\terr = compat_get_bitmap(bm, nmask, nr_bits);",
        "// Line_Reference 1543: \t\terr |= copy_to_user(nm, bm, alloc_size);",
        "// Line_Reference 1546: \tif (err)",
        "// Line_Reference 1547: \t\treturn -EFAULT;",
        "// Line_Reference 1548: ",
        "// Line_Reference 1556: \tlong err = 0;",
        "// Line_Reference 1565: \t\terr = compat_get_bitmap(nodes_addr(bm), nmask, nr_bits);",
        "// Line_Reference 1567: \t\terr |= copy_to_user(nm, nodes_addr(bm), alloc_size);",
        "// Line_Reference 1570: \tif (err)",
        "// Line_Reference 1571: \t\treturn -EFAULT;",
        "// Line_Reference 1572: "
    ]
}
