scratch = newscratch = malloc(2 * data->set.buffer_size);