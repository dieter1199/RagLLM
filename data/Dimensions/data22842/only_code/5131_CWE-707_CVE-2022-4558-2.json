NSString *result, *text;
NSScanner *theScanner;
NSError *error;
text = nil;
error = nil;
result = [NSString stringWithString: self];
if (stripHTMLCode) {
// Author : https://www.codercrunch.com/question/1251681838/how-remove-html-tags-string-ios
theScanner = [NSScanner scannerWithString: result];
while ([theScanner isAtEnd] == NO) {
// find start of tag
[theScanner scanUpToString: @"<" intoString: NULL];
// find end of tag
[theScanner scanUpToString: @">" intoString: &text];
// replace the found tag with a space
//(you can filter multi-spaces out later if you wish)
result = [result stringByReplacingOccurrencesOfString:
[NSString stringWithFormat: @"%@>", text]
withString: @" "];
}
} else {
// Clean XSS
// Examples of injection : https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polygot
// NSRegularExpression is not implemented in old GNUStep versions (ubuntu trusty)
if (NSClassFromString(@"NSRegularExpression")) {
NSRegularExpression *regex = nil;
}
}
return result;
