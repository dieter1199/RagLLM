- (void)xmppStream:(XMPPStream *)sender didReceiveMessage:(XMPPMessage *)xmppMessage
{
[self storeMessage:xmppMessage stream:sender incoming:YES];
}
- (void)storeMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream incoming:(BOOL)incoming
{
if ([xmppMessage isMessageCarbon]) {
[self handleCarbonMessage:xmppMessage stream:stream];
} else {
[self handleMessage:xmppMessage stream:stream incoming:incoming];
}
}
- (void)handleMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream incoming:(BOOL)incoming;
- (void)handleCarbonMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream
BOOL incoming = NO;
XMPPMessage *forwardedMessage = [xmppMessage messageCarbonForwardedMessage];
if ([xmppMessage isReceivedMessageCarbon]) {
incoming = YES;
