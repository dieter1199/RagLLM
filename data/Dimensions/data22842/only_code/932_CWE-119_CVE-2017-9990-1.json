const uint8_t *end, *ptr = avpkt->data;
end = avpkt->data + avpkt->size;
while (memcmp(ptr, "/* XPM */", 9) && ptr < end - 9)
if (ptr >= end) {
size *= 94;
if (ptr + cpp > end)
if (ptr + cpp > end)