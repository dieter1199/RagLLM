struct ipv6_opt_hdr *exthdr =
(struct ipv6_opt_hdr *)(ipv6_hdr(skb) + 1);
while (offset + 1 <= packet_len) {
offset += ipv6_optlen(exthdr);
*nexthdr = &exthdr->nexthdr;
return offset;