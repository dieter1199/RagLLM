"regexp"
filter := func(URL, header string, allowList, denyList *regexp.Regexp) error {
if !allowList.MatchString(URL) {
return api.WrapError(
fmt.Errorf("'%s' does not match the expression from the allowed list", URL),
api.NewSentinelHttpError(
http.StatusForbidden,
fmt.Sprintf("Invalid '%s' header value: '%s' does not match the authorized URLs", header, URL),
),
)
if denyList.String() != "" && denyList.MatchString(URL) {
fmt.Errorf("'%s' matches the expression from the denied list", URL),
fmt.Sprintf("Invalid '%s' header value: '%s' does not match the authorized URLs", header, URL),
return nil
err := filter(webhookUrl, "Gotenberg-Webhook-Url", w.allowList, w.denyList)
err = filter(webhookErrorUrl, "Gotenberg-Webhook-Error-Url", w.errorAllowList, w.errorDenyList)