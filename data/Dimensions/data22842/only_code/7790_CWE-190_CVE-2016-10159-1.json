if (buffer + 4 > endbuffer) {
if (entry.filename_len + 20 > endbuffer - buffer) {