$_w = $w;
$fromfile = (isset($_GET['fromfile'])) ? $_GET['fromfile'] : '';
// control parameters and file existence
if (!isset($_GET['fromfile']) || $fromfile == '') {
ErrorPNG($ERR_716);
exit;
} elseif (!file_exists($_GET['fromfile']) && !fopen($_GET['fromfile'], 'r')) {
ErrorPNG($ERR_716);
exit;
}
$img = getimagesize($fromfile);
$img = @getimagesize($fromfile);
load_image($fromfile, $img['mime'], $image_type, $output_type);
imagecopyresampled($ou, $funcall($fromfile), 0, 0, 0, 0, $w, $h, $img[0], $img[1]);
$funcall($ou, UPLOAD_PATH . 'cache/' . $_w . '-' . md5($fromfile));
