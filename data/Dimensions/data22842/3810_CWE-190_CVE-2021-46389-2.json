{
    "cve_id": "CVE-2021-46389",
    "cve_description": "IIPImage High Resolution Streaming Image Server prior to commit 882925b295a80ec992063deffc2a3b0d803c3195 is affected by an integer overflow in iipsrv.fcgi through malformed HTTP query parameters.",
    "cve_publish_date": "2022-02-07",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Added verification that image has been set in SPECTRA.cc and check on the validity of the requested tile resolution in JTL.cc. Fixes a couple of the crash conditions reported in https://github.com/ruven/iipsrv/issues/223",
    "type_of_change": "Modification",
    "filename_of_changes": "SPECTRA.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 4:     Copyright (C) 2009-2021 Ruven Pillay.",
        "// Line_Reference 39:   int resolution, tile, x, y;",
        "// Line_Reference 49:   resolution = atoi( arg.substr(0,delimitter).c_str() );",
        "// Line_Reference 53:   tile = atoi( arg.substr(0,delimitter).c_str() );",
        "// Line_Reference 57:   x = atoi( arg.substr(0,delimitter).c_str() );",
        "// Line_Reference 61:   y = atoi( arg.substr(0,arg.length()).c_str() );"
    ]
}
