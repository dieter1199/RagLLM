{
    "cve_id": "CVE-2017-7277",
    "cve_description": "The TCP stack in the Linux kernel through 4.10.6 mishandles the SCM_TIMESTAMPING_OPT_STATS feature, which allows local users to obtain sensitive information from the kernel's internal socket data structures or cause a denial of service (out-of-bounds read) via crafted system calls, related to net/core/skbuff.c and net/socket.c.",
    "cve_publish_date": "2017-03-28",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "tcp: fix SCM_TIMESTAMPING_OPT_STATS for normal skbs\n\n__sock_recv_timestamp can be called for both normal skbs (for\nreceive timestamps) and for skbs on the error queue (for transmit\ntimestamps).\n\nCommit 1c885808e456\n(tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING)\nassumes any skb passed to __sock_recv_timestamp are from\nthe error queue, containing OPT_STATS in the content of the skb.\nThis results in accessing invalid memory or generating junk\ndata.\n\nTo fix this, set skb->pkt_type to PACKET_OUTGOING for packets\non the error queue. This is safe because on the receive path\non local sockets skb->pkt_type is never set to PACKET_OUTGOING.\nWith that, copy OPT_STATS from a packet, only if its pkt_type\nis PACKET_OUTGOING.\n\nFixes: 1c885808e456 (\"tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING\")\nReported-by: JongHwan Kim <zzoru007@gmail.com>\nSigned-off-by: Soheil Hassas Yeganeh <soheil@google.com>\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: Willem de Bruijn <willemb@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "socket.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 698: \t\tif (skb->len && (sk->sk_tsflags & SOF_TIMESTAMPING_OPT_STATS))"
    ]
}
