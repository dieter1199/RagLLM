{
    "cve_id": "CVE-2011-5097",
    "cve_description": "chef-server-api/app/controllers/cookbooks.rb in Chef Server in Chef before 0.9.18, and 0.10.x before 0.10.2, does not require administrative privileges for the update and destroy methods, which allows remote authenticated users to (1) upload cookbooks via a knife cookbook upload command or (2) delete cookbooks via a knife cookbook delete command.",
    "cve_publish_date": "2012-08-08",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Do not allow non-admins to upload or delete cookbooks.",
    "type_of_change": "Modification",
    "filename_of_changes": "env.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 139:   cmd = [KNIFE_CMD, \"cookbook\", \"upload\", \"-a\", \"-o\", INTEGRATION_COOKBOOKS, \"-u\", \"validator\", \"-k\", File.join(Dir.tmpdir, \"validation.pem\"), \"-c\", KNIFE_CONFIG]"
    ]
}
