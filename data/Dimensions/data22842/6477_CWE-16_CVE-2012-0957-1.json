{
    "cve_id": "CVE-2012-0957",
    "cve_description": "The override_release function in kernel/sys.c in the Linux kernel before 3.4.16 allows local users to obtain sensitive information from kernel stack memory via a uname system call in conjunction with a UNAME26 personality.",
    "cve_publish_date": "2012-12-21",
    "cwe_id": "CWE-16",
    "cwe_name": "Configuration",
    "cwe_description": "Weaknesses in this category are typically introduced during the configuration of the software.",
    "commit_message": "kernel/sys.c: fix stack memory content leak via UNAME26\n\nCalling uname() with the UNAME26 personality set allows a leak of kernel\nstack contents.  This fixes it by defensively calculating the length of\ncopy_to_user() call, making the len argument unsigned, and initializing\nthe stack buffer to zero (now technically unneeded, but hey, overkill).\n\nCVE-2012-0957\n\nReported-by: PaX Team <pageexec@freemail.hu>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: Andi Kleen <ak@linux.intel.com>\nCc: PaX Team <pageexec@freemail.hu>\nCc: Brad Spengler <spender@grsecurity.net>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "sys.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 1268: static int override_release(char __user *release, int len)",
        "// Line_Reference 1271: \tchar buf[65];",
        "// Line_Reference 1274: \t\tchar *rest = UTS_RELEASE;",
        "// Line_Reference 1286: \t\tsnprintf(buf, len, \"2.6.%u%s\", v, rest);",
        "// Line_Reference 1287: \t\tret = copy_to_user(release, buf, len);"
    ]
}
