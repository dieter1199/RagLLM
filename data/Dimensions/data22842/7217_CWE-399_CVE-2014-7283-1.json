{
    "cve_id": "CVE-2014-7283",
    "cve_description": "The xfs_da3_fixhashpath function in fs/xfs/xfs_da_btree.c in the xfs implementation in the Linux kernel before 3.14.2 does not properly compare btree hash values, which allows local users to cause a denial of service (filesystem corruption, and OOPS or panic) via operations on directories that have hash collisions, as demonstrated by rmdir operations.",
    "cve_publish_date": "2014-10-13",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "xfs: fix directory hash ordering bug\n\nCommit f5ea1100 (\"xfs: add CRCs to dir2/da node blocks\") introduced\nin 3.10 incorrectly converted the btree hash index array pointer in\nxfs_da3_fixhashpath(). It resulted in the the current hash always\nbeing compared against the first entry in the btree rather than the\ncurrent block index into the btree block's hash entry array. As a\nresult, it was comparing the wrong hashes, and so could misorder the\nentries in the btree.\n\nFor most cases, this doesn't cause any problems as it requires hash\ncollisions to expose the ordering problem. However, when there are\nhash collisions within a directory there is a very good probability\nthat the entries will be ordered incorrectly and that actually\nmatters when duplicate hashes are placed into or removed from the\nbtree block hash entry array.\n\nThis bug results in an on-disk directory corruption and that results\nin directory verifier functions throwing corruption warnings into\nthe logs. While no data or directory entries are lost, access to\nthem may be compromised, and attempts to remove entries from a\ndirectory that has suffered from this corruption may result in a\nfilesystem shutdown.  xfs_repair will fix the directory hash\nordering without data loss occuring.\n\n[dchinner: wrote useful a commit message]\n\ncc: <stable@vger.kernel.org>\nReported-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: Mark Tinguely <tinguely@sgi.com>\nReviewed-by: Ben Myers <bpm@sgi.com>\nSigned-off-by: Dave Chinner <david@fromorbit.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfs_da_btree.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1298: \t\tif (be32_to_cpu(btree->hashval) == lasthash)"
    ]
}
