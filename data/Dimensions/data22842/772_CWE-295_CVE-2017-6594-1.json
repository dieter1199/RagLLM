{
    "cve_id": "CVE-2017-6594",
    "cve_description": "The transit path validation code in Heimdal before 7.3 might allow attackers to bypass the capath policy protection mechanism by leveraging failure to add the previous hop realm to the transit path of issued tickets.",
    "cve_publish_date": "2017-08-28",
    "cwe_id": "CWE-295",
    "cwe_name": "Improper Certificate Validation",
    "cwe_description": "The product does not validate, or incorrectly validates, a certificate.",
    "commit_message": "Fix transit path validation CVE-2017-6594\n\nCommit f469fc6 (2010-10-02) inadvertently caused the previous hop realm\nto not be added to the transit path of issued tickets.  This may, in\nsome cases, enable bypass of capath policy in Heimdal versions 1.5\nthrough 7.2.\n\nNote, this may break sites that rely on the bug.  With the bug some\nincomplete [capaths] worked, that should not have.  These may now break\nauthentication in some cross-realm configurations.",
    "type_of_change": "Modification",
    "filename_of_changes": "krb5tgs.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 659: \t/* not us, so add the previous realm to transited set */",
        "// Line_Reference 801: \t\t\t\t krb5_principal_get_realm(context, krbtgt->entry.principal));"
    ]
}
