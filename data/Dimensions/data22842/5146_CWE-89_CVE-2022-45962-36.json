{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "DataImport.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 29: ",
        "// Line_Reference 33: include('Classes/PHPExcel.php');",
        "// Line_Reference 35: DrawBC(\"\"._schoolSetup.\" > \"._dataImport.\" >\" . ProgramTitle());",
        "// Line_Reference 54:         echo '<form enctype=\"multipart/form-data\" action=\"Modules.php?modname=' . $_REQUEST[modname] . '&action=insert&page_display=STUDENT_INFO\" method=\"POST\" onSubmit=\"return map_upload_validation();\">';",
        "// Line_Reference 66:         echo '<div class=\"panel-footer text-center\"><input type=\"submit\" class=\"btn btn-primary\" value=\"'._upload.'\" /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">'._cancel.'</a></div>';",
        "// Line_Reference 85:         echo '<form action=\"Modules.php?modname=' . $_REQUEST[modname] . '&action=display&page_display=STUDENT_INFO\" name=\"student_form\"  method=\"POST\">';",
        "// Line_Reference 98:         $inputFileType = PHPExcel_IOFactory::identify($inputFileName);",
        "// Line_Reference 99:         $objReader = PHPExcel_IOFactory::createReader($inputFileType);",
        "// Line_Reference 100:         $objReader->setReadDataOnly(true);",
        "// Line_Reference 108:         $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);  // here 5",
        "// Line_Reference 200:         echo '<div class=\"panel-footer text-center\"><input id=\"mapItStuBtnOne\" type=\"submit\" value=\"Map it\" class=\"btn btn-primary\" onClick=\"return valid_mapping_student('.$i.', this);\"  /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">Cancel</a></div>';",
        "// Line_Reference 207:         echo '<form action=\"Modules.php?modname='.$_REQUEST[modname].'&action=process&page_display=STUDENT_INFO\" name=\"STUDENT_INFO_CONFIRM\" method=\"POST\">';",
        "// Line_Reference 303:         echo '<div class=\"panel-footer text-center\"><input id=\"mapItStuBtnTwo\" type=\"submit\" value=\"'._confirm.'\" class=\"btn btn-primary\" onClick=\"return valid_mapping_student('.$i.', this);\" /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">Cancel</a></div>';",
        "// Line_Reference 305:         echo '</form>';",
        "// Line_Reference 306: ",
        "// Line_Reference 322: ",
        "// Line_Reference 323:         echo \"<script>ajax_progress('student');</script>\";",
        "// Line_Reference 333:     echo '<form enctype=\"multipart/form-data\" action=\"Modules.php?modname='.$_REQUEST[modname].'&action=insert&page_display=STAFF_INFO\" method=\"POST\" onSubmit=\"return map_upload_validation();\">';",
        "// Line_Reference 345:     echo '<div class=\"panel-footer text-center\"><input type=\"submit\" class=\"btn btn-primary\" value=\"'._upload.'\" /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">'._cancel.'</a></div>';",
        "// Line_Reference 364:         echo '<form action=\"Modules.php?modname=' . $_REQUEST[modname] . '&action=display&page_display=STAFF_INFO\" name=\"staff_form\"  method=\"POST\">';",
        "// Line_Reference 455:         echo '<div class=\"panel-footer text-center\"><input id=\"mapItStaBtnOne\" type=\"submit\" value=\"'._mapIt.'\" class=\"btn btn-primary\" onClick=\"return valid_mapping_staff('.$i.', this);\"  /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">'._cancel.'</a></div>';",
        "// Line_Reference 463:         echo '<form action=\"Modules.php?modname='.$_REQUEST[modname].'&action=process&page_display=STAFF_INFO\" name=\"STAFF_INFO_CONFIRM\" method=\"POST\">';",
        "// Line_Reference 534:         echo '<div class=\"panel-footer text-center\"><input id=\"mapItStaBtnTwo\" type=\"submit\" value=\"'._confirm.'\" class=\"btn btn-primary\" onClick=\"return valid_mapping_staff('.$i.', this);\" /> &nbsp; <a href=\"Modules.php?modname=' . $_REQUEST[modname] . '\" class=\"btn btn-default\">Cancel</a></div>';",
        "// Line_Reference 536:         echo '</form>';",
        "// Line_Reference 537: ",
        "// Line_Reference 568:     echo '<a href=Modules.php?modname=' . $_REQUEST[modname] . '&page_display=STUDENT_INFO><img src=\"modules/tools/assets/images/student.svg\" width=\"60%\" /><h4>'._importStudentData.'</h4></a>';",
        "// Line_Reference 575:     echo '<a href=Modules.php?modname=' . $_REQUEST[modname] . '&page_display=STAFF_INFO><img src=\"modules/tools/assets/images/faculty.svg\" width=\"60%\" /><h4>'._importStaffData.'</h4></a>';"
    ]
}
