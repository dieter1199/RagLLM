{
    "cve_id": "CVE-2016-10044",
    "cve_description": "The aio_mount function in fs/aio.c in the Linux kernel before 4.7.7 does not properly restrict execute access, which makes it easier for local users to bypass intended SELinux W^X policy restrictions, and consequently gain privileges, via an io_setup system call.",
    "cve_publish_date": "2017-02-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "aio: mark AIO pseudo-fs noexec\n\nThis ensures that do_mmap() won't implicitly make AIO memory mappings\nexecutable if the READ_IMPLIES_EXEC personality flag is set.  Such\nbehavior is problematic because the security_mmap_file LSM hook doesn't\ncatch this case, potentially permitting an attacker to bypass a W^X\npolicy enforced by SELinux.\n\nI have tested the patch on my machine.\n\nTo test the behavior, compile and run this:\n\n    #define _GNU_SOURCE\n    #include <unistd.h>\n    #include <sys/personality.h>\n    #include <linux/aio_abi.h>\n    #include <err.h>\n    #include <stdlib.h>\n    #include <stdio.h>\n    #include <sys/syscall.h>\n\n    int main(void) {\n        personality(READ_IMPLIES_EXEC);\n        aio_context_t ctx = 0;\n        if (syscall(__NR_io_setup, 1, &ctx))\n            err(1, \"io_setup\");\n\n        char cmd[1000];\n        sprintf(cmd, \"cat /proc/%d/maps | grep -F '/[aio]'\",\n            (int)getpid());\n        system(cmd);\n        return 0;\n    }\n\nIn the output, \"rw-s\" is good, \"rwxs\" is bad.\n\nSigned-off-by: Jann Horn <jann@thejh.net>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "aio.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 242: \treturn mount_pseudo(fs_type, \"aio:\", NULL, &ops, AIO_RING_MAGIC);"
    ]
}
