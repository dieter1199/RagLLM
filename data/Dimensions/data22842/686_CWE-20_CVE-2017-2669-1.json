{
    "cve_id": "CVE-2017-2669",
    "cve_description": "Dovecot before version 2.2.29 is vulnerable to a denial of service. When 'dict' passdb and userdb were used for user authentication, the username sent by the IMAP/POP3 client was sent through var_expand() to perform %variable expansion. Sending specially crafted %variable fields could result in excessive memory usage causing the process to crash (and restart), or excessive CPU usage causing all authentications to hang.",
    "cve_publish_date": "2018-06-21",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "auth: Do not double-expand key in passdb dict when authenticating\n\nBroken by 79042f8c",
    "type_of_change": "Modification",
    "filename_of_changes": "db-dict.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 416: \t\tret = var_expand(path, key->key->key, iter->var_expand_table, &error);",
        "// Line_Reference 417: \t\tif (ret <= 0) {",
        "// Line_Reference 418: \t\t\tauth_request_log_error(iter->auth_request, AUTH_SUBSYS_DB,",
        "// Line_Reference 419: \t\t\t\t\"Failed to expand key %s: %s\", key->key->key, error);",
        "// Line_Reference 420: \t\t\treturn -1;",
        "// Line_Reference 421: \t\t}"
    ]
}
