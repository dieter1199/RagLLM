{
    "cve_id": "CVE-2015-7990",
    "cve_description": "Race condition in the rds_sendmsg function in net/rds/sendmsg.c in the Linux kernel before 4.3.3 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by using a socket that was not properly bound.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-6937.",
    "cve_publish_date": "2015-12-28",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "RDS: fix race condition when sending a message on unbound socket\n\nSasha's found a NULL pointer dereference in the RDS connection code when\nsending a message to an apparently unbound socket.  The problem is caused\nby the code checking if the socket is bound in rds_sendmsg(), which checks\nthe rs_bound_addr field without taking a lock on the socket.  This opens a\nrace where rs_bound_addr is temporarily set but where the transport is not\nin rds_bind(), leading to a NULL pointer dereference when trying to\ndereference 'trans' in __rds_conn_create().\n\nVegard wrote a reproducer for this issue, so kindly ask him to share if\nyou're interested.\n\nI cannot reproduce the NULL pointer dereference using Vegard's reproducer\nwith this patch, whereas I could without.\n\nComplete earlier incomplete fix to CVE-2015-6937:\n\n  74e98eb08588 (\"RDS: verify the underlying transport exists before creating a connection\")\n\nCc: David S. Miller <davem@davemloft.net>\nCc: stable@vger.kernel.org\n\nReviewed-by: Vegard Nossum <vegard.nossum@oracle.com>\nReviewed-by: Sasha Levin <sasha.levin@oracle.com>\nAcked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com>\nSigned-off-by: Quentin Casasnovas <quentin.casasnovas@oracle.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "connection.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 189: \tif (trans == NULL) {",
        "// Line_Reference 190: \t\tkmem_cache_free(rds_conn_slab, conn);",
        "// Line_Reference 191: \t\tconn = ERR_PTR(-ENODEV);",
        "// Line_Reference 192: \t\tgoto out;",
        "// Line_Reference 193: \t}",
        "// Line_Reference 194: "
    ]
}
