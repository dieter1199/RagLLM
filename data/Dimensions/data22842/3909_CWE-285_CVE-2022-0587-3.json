{
    "cve_id": "CVE-2022-0587",
    "cve_description": "Improper Authorization in Packagist librenms/librenms prior to 22.2.0.",
    "cve_publish_date": "2022-02-15",
    "cwe_id": "CWE-285",
    "cwe_name": "Improper Authorization",
    "cwe_description": "The product does not perform or incorrectly performs an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "Moved some pages to be within admin route (#13782)\n\n* Moved plugin admin pages to be within admin route\r\n* Wrap html transports page in admin check\r\n* Moved Port group controller to be admin protected\r\n* fixed tests",
    "type_of_change": "Modification",
    "filename_of_changes": "alert-transports.inc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 3: // handle OAuth requests",
        "// Line_Reference 4: $request = request();  // grab the Request object",
        "// Line_Reference 6: if ($request->has('oauthtransport')) {",
        "// Line_Reference 7:     // make sure transport is safe",
        "// Line_Reference 8:     $validator = Validator::make($request->all(), ['oauthtransport' => 'required|alpha']);",
        "// Line_Reference 10:     if ($validator->passes()) {",
        "// Line_Reference 11:         $transport_name = $request->get('oauthtransport');",
        "// Line_Reference 12:         $class = \\LibreNMS\\Alert\\Transport::getClass($transport_name);",
        "// Line_Reference 13:         if (class_exists($class)) {",
        "// Line_Reference 14:             $transport = app($class);",
        "// Line_Reference 15:             if ($transport->handleOauth($request)) {",
        "// Line_Reference 16:                 flash()->addSuccess(\"$transport_name added successfully.\");",
        "// Line_Reference 17:             } else {",
        "// Line_Reference 18:                 flash()->addError(\"$transport_name was not added. Check the log for details.\");",
        "// Line_Reference 23:     // remove get variables otherwise things will get double added",
        "// Line_Reference 24:     echo '<script>window.history.replaceState(null, null, window.location.pathname);</script>';",
        "// Line_Reference 26: unset($request);",
        "// Line_Reference 27: ",
        "// Line_Reference 28: // print alert transports",
        "// Line_Reference 29: require_once 'includes/html/print-alert-transports.php';"
    ]
}
