{
    "cve_id": "CVE-2022-1339",
    "cve_description": "SQL injection in ElementController.php in GitHub repository pimcore/pimcore prior to 10.3.5. This vulnerability is capable of steal the data",
    "cve_publish_date": "2022-04-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Added Quote In Condition Filters",
    "type_of_change": "Modification",
    "filename_of_changes": "ElementController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 235:                 $value = $filter['value'];",
        "// Line_Reference 241:                     $conditions[] = '`user` IN (SELECT `id` FROM `users` WHERE `name` LIKE ' . $list->quote('%'.$filter['value'].'%') . ')';",
        "// Line_Reference 244:                         $maxTime = $filter['value'] + (86400 - 1); //specifies the top point of the range used in the condition",
        "// Line_Reference 245:                         $dateCondition = '`' . $filter[$propertyKey] . '` ' . ' BETWEEN ' . $db->quote($filter['value']) . ' AND ' . $db->quote($maxTime);",
        "// Line_Reference 248:                         $field = '`'.$filter[$propertyKey].'` ';",
        "// Line_Reference 249:                         $conditions[] = $field.$operator.' '.$db->quote($value);"
    ]
}
