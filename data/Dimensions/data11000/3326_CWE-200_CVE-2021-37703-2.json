{
    "cve_id": "CVE-2021-37703",
    "cve_description": "Discourse is an open-source platform for community discussion. In Discourse before versions 2.7.8 and 2.8.0.beta5, a user's read state for a topic such as the last read post number and the notification level is exposed.",
    "cve_publish_date": "2021-08-13",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "SECURITY: User's read state for topic is leaked to unauthorized clients.\n\nA user's read state for a topic such as the last read post number and the notification level is exposed.",
    "type_of_change": "Modification",
    "filename_of_changes": "topic_tracking_state.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 156:     tags = nil",
        "// Line_Reference 157:     tag_ids = nil",
        "// Line_Reference 158:     if include_tags_in_report?",
        "// Line_Reference 159:       tag_ids, tags = post.topic.tags.pluck(:id, :name).transpose",
        "// Line_Reference 162:     TopicUser",
        "// Line_Reference 163:       .tracking(post.topic_id)",
        "// Line_Reference 164:       .includes(user: :user_stat)",
        "// Line_Reference 191:       MessageBus.publish(self.unread_channel_key(tu.user_id), message.as_json, group_ids: group_ids)"
    ]
}
