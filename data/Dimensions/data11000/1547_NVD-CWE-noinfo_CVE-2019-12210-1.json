{
    "cve_id": "CVE-2019-12210",
    "cve_description": "In Yubico pam-u2f 1.0.7, when configured with debug and a custom debug log file is set using debug_file, that file descriptor is not closed when a new process is spawned. This leads to the file descriptor being inherited into the child process; the child process can then read from and write to it. This can leak sensitive information and also, if written to, be used to fill the disk or plant misinformation.",
    "cve_publish_date": "2019-06-04",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Do not leak file descriptor when doing exec\n\nWhen opening a custom debug file, the descriptor would stay\nopen when calling exec and leak to the child process.\n\nMake sure all files are opened with close-on-exec.\n\nThis fixes CVE-2019-12210.\n\nThanks to Matthias Gerstner of the SUSE Security Team for reporting\nthe issue.",
    "type_of_change": "Modification",
    "filename_of_changes": "pam-u2f.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 2:  *  Copyright (C) 2014-2018 Yubico AB - See COPYING",
        "// Line_Reference 79:         struct stat st;",
        "// Line_Reference 80:         FILE *file;",
        "// Line_Reference 81:         if(lstat(filename, &st) == 0) {",
        "// Line_Reference 82:           if(S_ISREG(st.st_mode)) {",
        "// Line_Reference 83:             file = fopen(filename, \"a\");",
        "// Line_Reference 84:             if(file != NULL) {",
        "// Line_Reference 85:               cfg->debug_file = file;",
        "// Line_Reference 86:             }",
        "// Line_Reference 320:     authpending_file_descriptor = open(cfg->authpending_file, O_RDONLY | O_CREAT, 0664);"
    ]
}
