{
    "cve_id": "CVE-2016-5733",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.16, 4.4.x before 4.4.15.7, and 4.6.x before 4.6.3 allow remote attackers to inject arbitrary web script or HTML via vectors involving (1) a crafted table name that is mishandled during privilege checking in table_row.phtml, (2) a crafted mysqld log_bin directive that is mishandled in log_selector.phtml, (3) the Transformation implementation, (4) AJAX error handling in js/ajax.js, (5) the Designer implementation, (6) the charts implementation in js/tbl_chart.js, or (7) the zoom-search implementation in rows_zoom.phtml.",
    "cve_publish_date": "2016-07-03",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Simplify and cleanup transformation plugins\n\nRemove PMA_transformation_global_html_replace which makes the code only\nmore confusing.\n\nAlso add escaping to browse transformations.\n\nSigned-off-by: Michal Čihař <michal@cihar.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "TextLinkTransformationsPlugin.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 17: /* For PMA_Transformation_globalHtmlReplace */",
        "// Line_Reference 18: require_once 'libraries/transformations.lib.php';",
        "// Line_Reference 19: ",
        "// Line_Reference 52: ",
        "// Line_Reference 55:         $transform_options = array(",
        "// Line_Reference 56:             'string' => '<a href=\"'",
        "// Line_Reference 57:                 . (isset($options[0]) ? $options[0] : '') . $append_part",
        "// Line_Reference 58:                 . '\" title=\"'",
        "// Line_Reference 59:                 . htmlspecialchars(isset($options[1]) ? $options[1] : '')",
        "// Line_Reference 60:                 . '\" target=\"_new\">'",
        "// Line_Reference 61:                 . htmlspecialchars(isset($options[1]) ? $options[1] : $buffer)",
        "// Line_Reference 62:                 . '</a>',",
        "// Line_Reference 63:         );",
        "// Line_Reference 64: ",
        "// Line_Reference 65:         return PMA_Transformation_globalHtmlReplace(",
        "// Line_Reference 66:             $buffer,",
        "// Line_Reference 67:             $transform_options",
        "// Line_Reference 68:         );"
    ]
}
