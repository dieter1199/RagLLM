{
    "cve_id": "CVE-2021-41118",
    "cve_description": "The DynamicPageList3 extension is a reporting tool for MediaWiki, listing category members and intersections with various formats and details. In affected versions unsanitised input of regular expression date within the parameters of the DPL parser function, allowed for the possibility of ReDoS (Regex Denial of Service). This has been resolved in version 3.3.6. If you are unable to update you may also set `$wgDplSettings['functionalRichness'] = 0;` or disable DynamicPageList3 to mitigate.",
    "cve_publish_date": "2021-10-04",
    "cwe_id": "CWE-400",
    "cwe_name": "Uncontrolled Resource Consumption",
    "cwe_description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
    "commit_message": "Major cleanup (#57)",
    "type_of_change": "Modification",
    "filename_of_changes": "Logger.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 2: /**",
        "// Line_Reference 3:  * DynamicPageList3",
        "// Line_Reference 4:  * DPL Logger Class",
        "// Line_Reference 5:  *",
        "// Line_Reference 6:  * @author\t\tIlyaHaykinson, Unendlich, Dangerville, Algorithmix, Theaitetos, Alexia E. Smith",
        "// Line_Reference 7:  * @license\t\tGPL-2.0-or-later",
        "// Line_Reference 8:  * @package\t\tDynamicPageList3",
        "// Line_Reference 9:  *",
        "// Line_Reference 10:  */",
        "// Line_Reference 21: \t/**",
        "// Line_Reference 22: \t * Function Documentation",
        "// Line_Reference 23: \t *",
        "// Line_Reference 24: \t * @access\tpublic",
        "// Line_Reference 25: \t * @return\tvoid",
        "// Line_Reference 26: \t */",
        "// Line_Reference 27: \tpublic function addMessage( $errorId ) {",
        "// Line_Reference 30: \t\treturn call_user_func_array( [ $this, 'msg' ], $args );",
        "// Line_Reference 36: \t * @access\tpublic",
        "// Line_Reference 37: \t * @param\tboolean\t[Optional] Clear the message buffer.",
        "// Line_Reference 38: \t * @return\tarray\tMessages in the order added.",
        "// Line_Reference 51: \t *",
        "// Line_Reference 52: \t * @access\tpublic",
        "// Line_Reference 53: \t * @param\tinteger\tMessage ID",
        "// Line_Reference 54: \t * @return\tstring",
        "// Line_Reference 61: \t\tif ( \\DynamicPageListHooks::getDebugLevel() >= $errorLevel ) {",
        "// Line_Reference 62: \t\t\tif ( \\DynamicPageListHooks::isLikeIntersection() ) {",
        "// Line_Reference 63: \t\t\t\tif ( $errorId == \\DynamicPageListHooks::FATAL_TOOMANYCATS ) {",
        "// Line_Reference 65: \t\t\t\t} elseif ( $errorId == \\DynamicPageListHooks::FATAL_TOOFEWCATS ) {",
        "// Line_Reference 67: \t\t\t\t} elseif ( $errorId == \\DynamicPageListHooks::WARN_NORESULTS ) {",
        "// Line_Reference 69: \t\t\t\t} elseif ( $errorId == \\DynamicPageListHooks::FATAL_NOSELECTION ) {",
        "// Line_Reference 76: \t\t\t$this->buffer[] = '<p>Extension:DynamicPageList (DPL), version ' . DPL_VERSION . ': ' . $text . '</p>';",
        "// Line_Reference 78: \t\treturn false;"
    ]
}
