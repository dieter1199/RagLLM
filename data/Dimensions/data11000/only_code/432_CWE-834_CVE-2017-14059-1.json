for (i = 0; i < st->duration; i++)