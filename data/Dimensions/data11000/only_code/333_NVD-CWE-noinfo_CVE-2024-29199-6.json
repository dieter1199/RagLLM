"""Validate unauthenticated users are not able to query anything by default."""
self.assertEqual(response.status_code, status.HTTP_200_OK)
self.assertIsInstance(response.data["data"]["racks"], list)
names = [item["name"] for item in response.data["data"]["racks"]]
self.assertEqual(names, [])
@override_settings(EXEMPT_VIEW_PERMISSIONS=["*"])
def test_graphql_api_no_token_exempt(self):
"""Validate unauthenticated users are able to query based on the exempt permissions."""
response = self.client.post(self.api_url, {"query": self.get_racks_query}, format="json")
self.assertEqual(response.status_code, status.HTTP_200_OK)
self.assertIsInstance(response.data["data"]["racks"], list)
names = [item["name"] for item in response.data["data"]["racks"]]
self.assertEqual(names, ["Rack 1-1", "Rack 1-2", "Rack 2-1", "Rack 2-2"])
