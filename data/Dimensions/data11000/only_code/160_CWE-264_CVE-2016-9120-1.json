static int ion_handle_put(struct ion_handle *handle)
ret = kref_put(&handle->ref, ion_handle_destroy);
static struct ion_handle *ion_handle_get_by_id(struct ion_client *client,
mutex_lock(&client->lock);
mutex_unlock(&client->lock);
void ion_free(struct ion_client *client, struct ion_handle *handle)
mutex_lock(&client->lock);
mutex_unlock(&client->lock);
ion_handle_put(handle);
handle = ion_handle_get_by_id(client, data.handle.handle);
if (IS_ERR(handle))
ion_free(client, handle);
ion_handle_put(handle);