{
    "cve_id": "CVE-2020-13112",
    "cve_description": "An issue was discovered in libexif before 0.6.22. Several buffer over-reads in EXIF MakerNote handling could lead to information disclosure and crashes. This is different from CVE-2020-0093.",
    "cve_publish_date": "2020-05-21",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix MakerNote tag size overflow issues at read time.\n\nCheck for a size overflow while reading tags, which ensures that the\nsize is always consistent for the given components and type of the\nentry, making checking further down superfluous.\n\nThis provides an alternate fix for\nhttps://sourceforge.net/p/libexif/bugs/125/ CVE-2016-6328 and for all\nthe MakerNote types. Likely, this makes both commits 41bd0423 and\n89e5b1c1 redundant as it ensures that MakerNote entries are well-formed\nwhen they're populated.\n\nSome improvements on top by Marcus Meissner <marcus@jet.franken.de>\n\nCVE-2020-13112",
    "type_of_change": "Modification",
    "filename_of_changes": "exif-mnote-data-olympus.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 248: \tif ((o2 + 10 < o2) || (o2 + 10 < 10) || (o2 + 10 > buf_size)) {",
        "// Line_Reference 303: \t\tif ((o2 + 4 < o2) || (o2 + 4 < 4) || (o2 + 4 > buf_size)) return;",
        "// Line_Reference 344: \t\tif ((o2 + 12 < o2) || (o2 + 12 < 12) || (o2 + 12 > buf_size)) return;",
        "// Line_Reference 402: \tif ((o2 + 2 < o2) || (o2 + 2 < 2) || (o2 + 2 > buf_size)) {",
        "// Line_Reference 426: \t\tif ((o + 12 < o) || (o + 12 < 12) || (o + 12 > buf_size)) {",
        "// Line_Reference 465: \t\t\t    if (dataofs + s > buf_size && n->version == sanyoV1) {",
        "// Line_Reference 474: \t\t\tif ((dataofs + s < dataofs) || (dataofs + s < s) ||",
        "// Line_Reference 475: \t\t\t    (dataofs + s > buf_size)) {"
    ]
}
