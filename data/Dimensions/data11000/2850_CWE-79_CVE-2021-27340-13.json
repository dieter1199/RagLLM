{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "DownloadWindow.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 37:     $downfile_info= DBGet(DBQuery('SELECT * FROM user_file_upload WHERE ID='.$down_id.''));",
        "// Line_Reference 38:         header(\"Cache-Control: public\");",
        "// Line_Reference 39:         header(\"Pragma: \");",
        "// Line_Reference 40:         header(\"Expires: 0\");",
        "// Line_Reference 41:         header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");",
        "// Line_Reference 42:         header(\"Cache-Control: private\",false); // required for certain browsers",
        "// Line_Reference 43:         header(\"Content-Length: \".$downfile_info[1]['SIZE'].\"\");",
        "// Line_Reference 44:         header(\"Content-Type: \".$downfile_info[1]['TYPE'].\"\");",
        "// Line_Reference 45: //        header(\"Content-Disposition: attachment; filename=\\\"\".str_replace(' ','_',$downfile_info[1]['NAME']).\"\\\";\");",
        "// Line_Reference 46:         header(\"Content-Disposition: attachment; filename=\\\"\".$downfile_info[1]['NAME'].\"\\\";\");",
        "// Line_Reference 47:         header(\"Content-Transfer-Encoding: binary\");",
        "// Line_Reference 48:         ob_clean();",
        "// Line_Reference 49:         flush();",
        "// Line_Reference 51:         exit;",
        "// Line_Reference 52: }",
        "// Line_Reference 53: else",
        "// Line_Reference 54: {",
        "// Line_Reference 55: header('Content-Disposition: attachment; filename=\"'.urldecode($_REQUEST['name']).'\" ');",
        "// Line_Reference 56: readfile('assets/'.urldecode($_REQUEST['filename']));"
    ]
}
