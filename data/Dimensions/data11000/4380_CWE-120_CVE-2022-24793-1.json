{
    "cve_id": "CVE-2022-24793",
    "cve_description": "PJSIP is a free and open source multimedia communication library written in C. A buffer overflow vulnerability in versions 2.12 and prior affects applications that use PJSIP DNS resolution. It doesn't affect PJSIP users who utilize an external resolver. This vulnerability is related to CVE-2023-27585. The difference is that this issue is in parsing the query record `parse_rr()`, while the issue in CVE-2023-27585 is in `parse_query()`. A patch is available in the `master` branch of the `pjsip/pjproject` GitHub repository. A workaround is to disable DNS resolution in PJSIP config (by setting `nameserver_count` to zero) or use an external resolver instead.",
    "cve_publish_date": "2022-04-06",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "Merge pull request from GHSA-p6g5-v97c-w5q4\n\n* Prevent heap buffer overflow when parsing DNS packets\n\n* Make sure packet parsing doesn't advance beyond max/end\n\n* Update checks\n\n* Remove  check\n\nCo-authored-by: sauwming <ming@teluu.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "dns.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 162: \t    /* Check that label length is valid */",
        "// Line_Reference 163: \t    if (pkt+label_len > max)",
        "// Line_Reference 173: ",
        "// Line_Reference 174: \t    if (p >= max)",
        "// Line_Reference 175: \t\treturn PJLIB_UTIL_EDNSINSIZE;",
        "// Line_Reference 225: \t    /* Check that label length is valid */",
        "// Line_Reference 226: \t    if (pkt+label_len > max)",
        "// Line_Reference 237: ",
        "// Line_Reference 238: \t    if (p >= max)",
        "// Line_Reference 239: \t\treturn PJLIB_UTIL_EDNSINSIZE;"
    ]
}
