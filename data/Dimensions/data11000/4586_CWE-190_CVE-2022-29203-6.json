{
    "cve_id": "CVE-2022-29203",
    "cve_description": "TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, the implementation of `tf.raw_ops.SpaceToBatchND` (in all backends such as XLA and handwritten kernels) is vulnerable to an integer overflow: The result of this integer overflow is used to allocate the output tensor, hence we get a denial of service via a `CHECK`-failure (assertion failure), as in TFSA-2021-198. Versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4 contain a patch for this issue.",
    "cve_publish_date": "2022-05-20",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Fix security vulnerability with SpaceToBatchNDOp.\n\nPiperOrigin-RevId: 445527615",
    "type_of_change": "Modification",
    "filename_of_changes": "spacetobatch_op.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 24: #include \"tensorflow/core/kernels/spacetobatch_functor.h\"",
        "// Line_Reference 25: ",
        "// Line_Reference 102:     block_shape_product *= block_shape[block_dim];",
        "// Line_Reference 134:   external_output_shape.AddDim(orig_input_tensor.dim_size(0) *",
        "// Line_Reference 135:                                block_shape_product);"
    ]
}
