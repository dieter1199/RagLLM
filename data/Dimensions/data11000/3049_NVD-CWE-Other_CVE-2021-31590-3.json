{
    "cve_id": "CVE-2021-31590",
    "cve_description": "PwnDoc all versions until 0.4.0 (2021-08-23) has incorrect JSON Webtoken handling, leading to incorrect access control. With a valid JSON Webtoken that is used for authentication and authorization, a user can keep his admin privileges even if he is downgraded to the \"user\" privilege. Even after a user's account is deleted, the user can still access the administration panel (and add or delete users) and has complete access to the system.",
    "cve_publish_date": "2021-07-19",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Update JWT generation\n\nJWT is now dynamic\nconfig files have moved",
    "type_of_change": "Modification",
    "filename_of_changes": "report-generator.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 12: var reportConfig = require('./report.json');",
        "// Line_Reference 22:     var settings = JSON.parse(fs.readFileSync(`${__basedir}/lib/app-settings.json`));"
    ]
}
