{
    "cve_id": "CVE-2021-37709",
    "cve_description": "Shopware is an open source eCommerce platform. Versions prior to 6.4.3.1 contain a vulnerability involving an insecure direct object reference of log files of the Import/Export feature. Version 6.4.3.1 contains a patch. As workarounds for older versions of 6.1, 6.2, and 6.3, corresponding security measures are also available via a plugin.",
    "cve_publish_date": "2021-08-16",
    "cwe_id": "CWE-639",
    "cwe_name": "Authorization Bypass Through User-Controlled Key",
    "cwe_description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
    "commit_message": "NEXT-15675 - Improve file download",
    "type_of_change": "Modification",
    "filename_of_changes": "DownloadService.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 21:     /**",
        "// Line_Reference 22:      * @var FilesystemInterface",
        "// Line_Reference 23:      */",
        "// Line_Reference 24:     private $filesystem;",
        "// Line_Reference 26:     /**",
        "// Line_Reference 27:      * @var EntityRepositoryInterface",
        "// Line_Reference 28:      */",
        "// Line_Reference 29:     private $fileRepository;",
        "// Line_Reference 37:     public function regenerateToken(Context $context, string $fileId): void",
        "// Line_Reference 40:             [['id' => $fileId, 'accessToken' => ImportExportFileEntity::generateAccessToken()]],",
        "// Line_Reference 48:         if ($entity->getAccessToken() !== $accessToken) {"
    ]
}
