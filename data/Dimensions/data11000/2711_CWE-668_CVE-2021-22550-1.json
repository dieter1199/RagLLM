{
    "cve_id": "CVE-2021-22550",
    "cve_description": "An attacker can modify the pointers in enclave memory to overwrite arbitrary memory addresses within the secure enclave. It is recommended to update past 0.6.3 or git commit https://github.com/google/asylo/commit/a47ef55db2337d29de19c50cd29b0deb2871d31c",
    "cve_publish_date": "2021-06-08",
    "cwe_id": "CWE-668",
    "cwe_name": "Exposure of Resource to Wrong Sphere",
    "cwe_description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.",
    "commit_message": "Fix vulnerability in UntrustedCacheMalloc\n\nThe pointer array is stored in untrusted memory, so we cannot trust the\nvalue even after validation. We should validate the pointer is pointing\nto untrusted memory after it's stored inside the enclave.\n\nPiperOrigin-RevId: 358474391\nChange-Id: I63cf6c251bdaf1b491dbf06cc0dcf77f7b141756",
    "type_of_change": "Modification",
    "filename_of_changes": "untrusted_cache_malloc.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 107:         if (!buffers[i] ||",
        "// Line_Reference 108:             !TrustedPrimitives::IsOutsideEnclave(buffers[i], kPoolEntrySize)) {",
        "// Line_Reference 109:           abort();",
        "// Line_Reference 111:         buffer_pool_.push(buffers[i]);"
    ]
}
