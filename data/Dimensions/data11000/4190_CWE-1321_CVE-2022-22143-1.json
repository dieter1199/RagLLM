{
    "cve_id": "CVE-2022-22143",
    "cve_description": "The package convict before 6.2.2 are vulnerable to Prototype Pollution via the convict function due to missing validation of parentKey. **Note:** This vulnerability derives from an incomplete fix of another [vulnerability](https://security.snyk.io/vuln/SNYK-JS-CONVICT-1062508)",
    "cve_publish_date": "2022-05-01",
    "cwe_id": "CWE-1321",
    "cwe_name": "Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')",
    "cwe_description": "The product receives input from an upstream component that specifies attributes that are to be initialized or updated in an object, but it does not properly control modifications of attributes of the object prototype.",
    "commit_message": "More complete fix against prototype pollution\n\nfirst addressed in https://github.com/mozilla/node-convict/pull/384",
    "type_of_change": "Modification",
    "filename_of_changes": "main.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 72: const ALLOWED_OPTION_STRICT = 'strict'",
        "// Line_Reference 73: const ALLOWED_OPTION_WARN = 'warn'",
        "// Line_Reference 74: ",
        "// Line_Reference 568:       if (!(parentKey == '__proto__' || parentKey == 'constructor' || parentKey == 'prototype')) {",
        "// Line_Reference 569:         const parent = walk(this._instance, parentKey, true)",
        "// Line_Reference 570:         parent[childKey] = v",
        "// Line_Reference 571:       }"
    ]
}
