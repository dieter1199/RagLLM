{
    "cve_id": "CVE-2022-3065",
    "cve_description": "Improper Access Control in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "GraphViewer.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "49",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 1127: \tvar initialCursor = this.graph.container.style.cursor;",
        "// Line_Reference 1281: \tfunction addButton(fn, imgSrc, tip, enabled)",
        "// Line_Reference 1283: \t\tvar a = document.createElement('div');",
        "// Line_Reference 1284: \t\ta.style.borderRight = '1px solid #d0d0d0';",
        "// Line_Reference 1285: \t\ta.style.padding = '3px 6px 3px 6px';",
        "// Line_Reference 1286: \t\tmxEvent.addListener(a, 'click', fn);",
        "// Line_Reference 1287: ",
        "// Line_Reference 1288: \t\tif (tip != null)",
        "// Line_Reference 1289: \t\t{",
        "// Line_Reference 1290: \t\t\ta.setAttribute('title', tip);",
        "// Line_Reference 1291: \t\t}",
        "// Line_Reference 1292: ",
        "// Line_Reference 1293: \t\ta.style.display = 'inline-block';",
        "// Line_Reference 1294: \t\tvar img = document.createElement('img');",
        "// Line_Reference 1295: \t\timg.setAttribute('border', '0');",
        "// Line_Reference 1296: \t\timg.setAttribute('src', imgSrc);",
        "// Line_Reference 1297: \t\timg.style.width = '18px';",
        "// Line_Reference 1298: ",
        "// Line_Reference 1299: \t\tif (enabled == null || enabled)",
        "// Line_Reference 1300: \t\t{",
        "// Line_Reference 1301: \t\t\tmxEvent.addListener(a, 'mouseenter', function()",
        "// Line_Reference 1302: \t\t\t{",
        "// Line_Reference 1303: \t\t\t\ta.style.backgroundColor = '#ddd';",
        "// Line_Reference 1304: \t\t\t});",
        "// Line_Reference 1305: ",
        "// Line_Reference 1306: \t\t\tmxEvent.addListener(a, 'mouseleave', function()",
        "// Line_Reference 1307: \t\t\t{",
        "// Line_Reference 1308: \t\t\t\ta.style.backgroundColor = '#eee';",
        "// Line_Reference 1309: \t\t\t});",
        "// Line_Reference 1310: ",
        "// Line_Reference 1311: \t\t\tmxUtils.setOpacity(img, 60);",
        "// Line_Reference 1312: \t\t\ta.style.cursor = 'pointer';",
        "// Line_Reference 1313: \t\t}",
        "// Line_Reference 1314: \t\telse",
        "// Line_Reference 1315: \t\t{",
        "// Line_Reference 1316: \t\t\tmxUtils.setOpacity(a, 30);",
        "// Line_Reference 1317: \t\t}",
        "// Line_Reference 1318: ",
        "// Line_Reference 1319: \t\ta.appendChild(img);",
        "// Line_Reference 1325: \t};"
    ]
}
