{
    "cve_id": "CVE-2017-15053",
    "cve_description": "TeamPass before 2.1.27.9 does not properly enforce manager access control when requesting roles.queries.php. It is then possible for a manager user to modify any arbitrary roles within the application, or delete any arbitrary role. To exploit the vulnerability, an authenticated attacker must have the manager rights on the application, then tamper with the requests sent directly, for example by changing the \"id\" parameter when invoking \"delete_role\" on roles.queries.php.",
    "cve_publish_date": "2017-11-27",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "2.1.27\n\nAdded filter in Roles page\nImprove truncating title in list of items",
    "type_of_change": "Modification",
    "filename_of_changes": "items.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 229:                 <table width=\"100%\" id=\"item_details_table\">';",
        "// Line_Reference 233:                     <td valign=\"top\" class=\"td_title\" colspan=\"2\">",
        "// Line_Reference 255:                         <div id=\"id_label\" style=\"display:inline; margin:4px 0px 0px 120px; \"></div>",
        "// Line_Reference 269:                     <td>",
        "// Line_Reference 277:                     <td>",
        "// Line_Reference 288:                     <td>",
        "// Line_Reference 297:                     <td>",
        "// Line_Reference 305:                     <td>",
        "// Line_Reference 313:                     <td>",
        "// Line_Reference 324:                     <td>",
        "// Line_Reference 332:                     <td>",
        "// Line_Reference 339:                     <tr>",
        "// Line_Reference 340:                         <td valign=\"top\" class=\"td_title\">&nbsp;<i class=\"fa fa-angle-right\"></i>&nbsp;'.$LANG['kbs'].' :</td>",
        "// Line_Reference 341:                         <td>",
        "// Line_Reference 342:                             <div id=\"id_kbs\" style=\"display:inline;\"></div><input type=\"hidden\" id=\"hid_kbs\" />",
        "// Line_Reference 343:                         </td>",
        "// Line_Reference 344:                     </tr>';",
        "// Line_Reference 351:                     <tr class=\"tr_fields hidden\" id=\"tr_catfield_'.$elem[0].'\">",
        "// Line_Reference 352:                         <td valign=\"top\" class=\"td_title\">&nbsp;<i class=\"fa fa-angle-right\"></i>&nbsp;'.$elem[1].' :</td>",
        "// Line_Reference 353:                         <td></td>",
        "// Line_Reference 354:                     </tr>';",
        "// Line_Reference 359:                         <td>';",
        "// Line_Reference 781:     <div style=\"display:none; padding:5px;\" id=\"div_formulaire_edition_item_info\" class=\"ui-state-default ui-corner-all\"></div>"
    ]
}
