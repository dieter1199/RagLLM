{
    "cve_id": "CVE-2022-0374",
    "cve_description": "Cross-site Scripting (XSS) - Stored in Packagist remdex/livehelperchat prior to 3.93v.",
    "cve_publish_date": "2022-01-26",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fx #1734",
    "type_of_change": "Modification",
    "filename_of_changes": "msg_obj_list.tpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 1: <?php",
        "// Line_Reference 2: ",
        "// Line_Reference 6: foreach ($messages as $msg ) : if ($msg->user_id > -1 || $msg->user_id == -2) :",
        "// Line_Reference 8: if ($lastOperatorId !== false && $lastOperatorId != $msg->user_id) {",
        "// Line_Reference 9:     $lastOperatorChanged = true;",
        "// Line_Reference 10: } else {",
        "// Line_Reference 11:     $lastOperatorChanged = false;",
        "// Line_Reference 12: }",
        "// Line_Reference 14: $lastOperatorId = $msg->user_id;",
        "// Line_Reference 16: if ($msg->meta_msg != '') {",
        "// Line_Reference 17:     $metaMessageData = json_decode($msg->meta_msg, true); $messageId = $msg->id;",
        "// Line_Reference 18: } else if (isset($metaMessageData)) {",
        "// Line_Reference 19:     unset($metaMessageData);",
        "// Line_Reference 20: }",
        "// Line_Reference 22: ?>",
        "// Line_Reference 23: <div class=\"message-row<?php echo $msg->user_id == 0 ? ' response' : ' message-admin'.($lastOperatorChanged == true ? ' operator-changes' : '')?>\" id=\"msg-<?php echo $msg->id?>\"><div class=\"msg-date\"><?php echo date(erLhcoreClassModule::$dateDateHourFormat,$msg->time);?></div><span class=\"usr-tit<?php echo $msg->user_id == 0 ? ' vis-tit' : ' op-tit'?>\"><?php echo $msg->user_id == 0 ? htmlspecialchars($chat->nick) : htmlspecialchars($msg->name_support) ?>:&nbsp;</span>",
        "// Line_Reference 25:     <?php $msgBody = $msg->msg; $paramsMessageRender = array('sender' => $msg->user_id);?>",
        "// Line_Reference 26:     <?php include(erLhcoreClassDesign::designtpl('lhchat/lists/msg_body.tpl.php'));?>",
        "// Line_Reference 28:     <?php if (isset($metaMessageData)) : ?>",
        "// Line_Reference 29:         <?php include(erLhcoreClassDesign::designtpl('lhgenericbot/message/meta_render.tpl.php'));?>",
        "// Line_Reference 30:     <?php endif; ?>",
        "// Line_Reference 31: </div>",
        "// Line_Reference 32: <?php endif; endforeach; ?>"
    ]
}
