{
    "cve_id": "CVE-2022-31889",
    "cve_description": "Cross Site Scripting (XSS) vulnerability in audit/templates/auditlogs.tmpl.php in osTicket osTicket-plugins before commit a7842d494889fd5533d13deb3c6a7789768795ae.",
    "cve_publish_date": "2023-04-05",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "xss: Audit Log\n\nThis mitigates a vulnerability discovered by the AppSec Research Team at\nCheckmarx where it's possible to perform XSS via the Audit Log plugin. This\nis due to not properly escaping the `state` and `type` URL params. This adds\n`Format::htmlchars()` to both params to ensure they are properly escaped.",
    "type_of_change": "Modification",
    "filename_of_changes": "auditlogs.tmpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 6:     $qs += array('type' => $_REQUEST['type']);",
        "// Line_Reference 10:   $type=$_REQUEST['type'];",
        "// Line_Reference 13:     $qs += array('state' => $_REQUEST['state']);",
        "// Line_Reference 17:   $state=$_REQUEST['state'];",
        "// Line_Reference 31: $order = AuditEntry::getOrder($_REQUEST['order']);"
    ]
}
