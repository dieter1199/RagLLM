struct pgpPkt pkt;
if (decodePkt(p, (pend - p), &pkt))
if (pkttype && pkt.tag != pkttype) {
digp = pgpDigParamsNew(pkt.tag);
if (pgpPrtPkt(&pkt, digp))
p += (pkt.body - pkt.head) + pkt.blen;
rc = (digp && (p == pend)) ? 0 : -1;