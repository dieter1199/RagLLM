// width of a string with a markup, without control chars
return string.unicode.width( str.replace( /\^\[[^\]]*]|\^(.)/g , ( match , second ) => {