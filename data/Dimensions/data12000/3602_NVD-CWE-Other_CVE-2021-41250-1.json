{
    "cve_id": "CVE-2021-41250",
    "cve_description": "Python discord bot is the community bot for the Python Discord community. In affected versions when a non-blacklisted URL and an otherwise triggering filter token is included in the same message the token filter does not trigger. This means that by including any non-blacklisted URL moderation filters can be bypassed. This issue has been resolved in commit 67390298852513d13e0213870e50fb3cff1424e0",
    "cve_publish_date": "2021-11-05",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Merge pull request from GHSA-j8c3-8x46-8pp6\n\n* Don't Exit Token Filtering Early On URLs\n\nThe token filtering function would exit early if it detected a URL\nwithin the message, but it made no extra checks to ensure there weren't\nother tokens within that message that would trigger it. This made\nsense when the filtering logic was written, but it's been modified since\nto introduce this bug.\n\nRegression tests included.\n\nSigned-off-by: Hassan Abouelela <hassan@hassanamr.com>\n\n* Links Advisory In Token Filter Tests\n\nAdds a link to the advisory with reasoning for the existence of the\n test.\n\nSigned-off-by: Hassan Abouelela <hassan@hassanamr.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "filtering.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 499:         # Make sure it's not a URL",
        "// Line_Reference 500:         if URL_RE.search(text):",
        "// Line_Reference 501:             return False, None",
        "// Line_Reference 502: "
    ]
}
