{
    "cve_id": "CVE-2020-24716",
    "cve_description": "OpenZFS before 2.0.0-rc1, when used on FreeBSD, allows execute permissions for all directories.",
    "cve_publish_date": "2020-08-27",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "FreeBSD: Fix UNIX permissions checking\n\nReviewed-by: Ryan Moeller <ryan@iXsystems.com>\r\nReviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>\r\nSigned-off-by: Matt Macy <mmacy@FreeBSD.org>\r\nCloses #10727",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "zfs_acl.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "34",
    "vulnerable_lines": [
        "// Line_Reference 2308: \tboolean_t owner = B_FALSE;",
        "// Line_Reference 2309: \tboolean_t groupmbr = B_FALSE;",
        "// Line_Reference 2311: \tuid_t uid = crgetuid(cr);",
        "// Line_Reference 2324: \tmutex_enter(&zdp->z_acl_lock);",
        "// Line_Reference 2325: \tif (FUID_INDEX(zdp->z_uid) != 0 || FUID_INDEX(zdp->z_gid) != 0) {",
        "// Line_Reference 2326: \t\tgoto out_slow;",
        "// Line_Reference 2327: \t}",
        "// Line_Reference 2328: ",
        "// Line_Reference 2329: \tif (uid == zdp->z_uid) {",
        "// Line_Reference 2330: \t\towner = B_TRUE;",
        "// Line_Reference 2331: \t\tif (zdp->z_mode & S_IXUSR) {",
        "// Line_Reference 2332: \t\t\tgoto out;",
        "// Line_Reference 2333: \t\t} else {",
        "// Line_Reference 2334: \t\t\tgoto out_slow;",
        "// Line_Reference 2335: \t\t}",
        "// Line_Reference 2336: \t}",
        "// Line_Reference 2337: \tif (groupmember(zdp->z_gid, cr)) {",
        "// Line_Reference 2338: \t\tgroupmbr = B_TRUE;",
        "// Line_Reference 2339: \t\tif (zdp->z_mode & S_IXGRP) {",
        "// Line_Reference 2340: \t\t\tgoto out;",
        "// Line_Reference 2341: \t\t} else {",
        "// Line_Reference 2342: \t\t\tgoto out_slow;",
        "// Line_Reference 2343: \t\t}",
        "// Line_Reference 2344: \t}",
        "// Line_Reference 2345: \tif (!owner && !groupmbr) {",
        "// Line_Reference 2346: \t\tif (zdp->z_mode & S_IXOTH) {",
        "// Line_Reference 2347: \t\t\tgoto out;",
        "// Line_Reference 2348: \t\t}",
        "// Line_Reference 2349: \t}",
        "// Line_Reference 2350: out:",
        "// Line_Reference 2351: \tmutex_exit(&zdp->z_acl_lock);",
        "// Line_Reference 2352: \treturn (0);",
        "// Line_Reference 2353: out_slow:",
        "// Line_Reference 2354: \tmutex_exit(&zdp->z_acl_lock);"
    ]
}
