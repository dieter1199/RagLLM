{
    "cve_id": "CVE-2020-4038",
    "cve_description": "GraphQL Playground (graphql-playground-html NPM package) before version 1.6.22 have a severe XSS Reflection attack vulnerability. All unsanitized user input passed into renderPlaygroundPage() method could trigger this vulnerability. This has been patched in graphql-playground-html version 1.6.22. Note that some of the associated dependent middleware packages are also affected including but not limited to graphql-playground-middleware-express before version 1.7.16, graphql-playground-middleware-koa before version 1.6.15, graphql-playground-middleware-lambda before version 1.7.17, and graphql-playground-middleware-hapi before 1.6.13.",
    "cve_publish_date": "2020-06-08",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Merge pull request from GHSA-4852-vrh7-28rf\n\n* fix: security vulnerability allowing XSS reflection with user input\n\n* fix: update docs, replace santize-html and sanitizeUrl with xss module",
    "type_of_change": "Modification",
    "filename_of_changes": "render-playground-page.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "49",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 77: const getCdnMarkup = ({ version, cdnUrl = '//cdn.jsdelivr.net/npm', faviconUrl }) => `",
        "// Line_Reference 78:     <link rel=\"stylesheet\" href=\"${cdnUrl}/graphql-playground-react${",
        "// Line_Reference 79:   version ? `@${version}` : ''",
        "// Line_Reference 80: }/build/static/css/index.css\" />",
        "// Line_Reference 81:     ${typeof faviconUrl === 'string' ? `<link rel=\"shortcut icon\" href=\"${faviconUrl}\" />` : ''}",
        "// Line_Reference 82:     ${faviconUrl === undefined ? `<link rel=\"shortcut icon\" href=\"${cdnUrl}/graphql-playground-react${",
        "// Line_Reference 83:       version ? `@${version}` : ''",
        "// Line_Reference 84:     }/build/favicon.png\" />` : ''}",
        "// Line_Reference 85:     <script src=\"${cdnUrl}/graphql-playground-react${",
        "// Line_Reference 86:   version ? `@${version}` : ''",
        "// Line_Reference 87: }/build/static/js/middleware.js\"></script>",
        "// Line_Reference 88: `",
        "// Line_Reference 97:     extendedOptions.subscriptionEndpoint = (options as any).subscriptionsEndpoint",
        "// Line_Reference 118:       extendedOptions.env === 'react' || extendedOptions.env === 'electron'",
        "// Line_Reference 119:         ? ''",
        "// Line_Reference 120:         : getCdnMarkup(extendedOptions)",
        "// Line_Reference 178: ",
        "// Line_Reference 179:         GraphQLPlayground.init(root, ${JSON.stringify(",
        "// Line_Reference 180:           extendedOptions,",
        "// Line_Reference 181:           null,",
        "// Line_Reference 182:           2,",
        "// Line_Reference 183:         )})"
    ]
}
