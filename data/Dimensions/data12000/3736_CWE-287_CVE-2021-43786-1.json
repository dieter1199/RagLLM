{
    "cve_id": "CVE-2021-43786",
    "cve_description": "Nodebb is an open source Node.js based forum software. In affected versions incorrect logic present in the token verification step unintentionally allowed master token access to the API. The vulnerability has been patch as of v1.18.5. Users are advised to upgrade as soon as possible.",
    "cve_publish_date": "2021-11-29",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "fix: token verify",
    "type_of_change": "Modification",
    "filename_of_changes": "authentication.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 47: \tlet { tokens = [] } = await meta.settings.get('core.api');",
        "// Line_Reference 48: \ttokens = tokens.reduce((memo, cur) => {",
        "// Line_Reference 49: \t\tmemo[cur.token] = cur.uid;",
        "// Line_Reference 50: \t\treturn memo;",
        "// Line_Reference 51: \t}, {});",
        "// Line_Reference 52: ",
        "// Line_Reference 53: \tconst uid = tokens[token];"
    ]
}
