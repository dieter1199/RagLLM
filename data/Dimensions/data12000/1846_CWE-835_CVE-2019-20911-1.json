{
    "cve_id": "CVE-2019-20911",
    "cve_description": "An issue was discovered in GNU LibreDWG through 0.9.3. Crafted input will lead to denial of service in bit_calc_CRC in bits.c, related to a for loop.",
    "cve_publish_date": "2020-07-16",
    "cwe_id": "CWE-835",
    "cwe_name": "Loop with Unreachable Exit Condition ('Infinite Loop')",
    "cwe_description": "The product contains an iteration or loop with an exit condition that cannot be reached, i.e., an infinite loop.",
    "commit_message": "cleanup tio.unknown\n\nnot needed anymore, we only have UNKNOWN_OBJ or UNKNOWN_ENT with full common\nentity_data.\nFixes GH #178 heap_overflow2",
    "type_of_change": "Modification",
    "filename_of_changes": "decode.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "60",
    "vulnerable_lines": [
        "// Line_Reference 5014: ",
        "// Line_Reference 5015:           // obj->unknown_off = obj->unknown_pos - restartpos;",
        "// Line_Reference 5016:           // LOG_TRACE(\"Unknown pos %lu, offset %lu\\n\", obj->unknown_pos,",
        "// Line_Reference 5017:           // obj->unknown_off);",
        "// Line_Reference 5035:               obj->supertype = DWG_SUPERTYPE_UNKNOWN;",
        "// Line_Reference 5041:           if (klass && !is_entity)",
        "// Line_Reference 5042:             {",
        "// Line_Reference 5043:               int err = dwg_decode_UNKNOWN_OBJ (dat, obj);",
        "// Line_Reference 5044:               error |= err;",
        "// Line_Reference 5045:               obj->supertype = DWG_SUPERTYPE_UNKNOWN;",
        "// Line_Reference 5046:               if (!dat)",
        "// Line_Reference 5047:                 return error;",
        "// Line_Reference 5048:               if (err >= DWG_ERR_CRITICAL)",
        "// Line_Reference 5049:                 *dat = abs_dat;",
        "// Line_Reference 5050:             }",
        "// Line_Reference 5051:           else if (klass) // is_entity",
        "// Line_Reference 5052:             {",
        "// Line_Reference 5053:               int err;",
        "// Line_Reference 5054: #if 0 && !defined(IS_RELEASE)",
        "// Line_Reference 5055:               if (strEQc(klass->dxfname, \"MULTILEADER\")) { //debug CED",
        "// Line_Reference 5056:                 char *mleader = bit_read_TF(dat, obj->size);",
        "// Line_Reference 5057:                 LOG_INSANE_TF(mleader, (int)obj->size)",
        "// Line_Reference 5058:                 bit_set_position(dat, restartpos);",
        "// Line_Reference 5059:                 free (mleader);",
        "// Line_Reference 5060:               }",
        "// Line_Reference 5061: #endif",
        "// Line_Reference 5062:               err = dwg_decode_UNKNOWN_ENT (dat, obj);",
        "// Line_Reference 5063:               error |= err;",
        "// Line_Reference 5064:               obj->supertype = DWG_SUPERTYPE_UNKNOWN;",
        "// Line_Reference 5065:               if (!dat)",
        "// Line_Reference 5066:                 return error;",
        "// Line_Reference 5067:               if (err >= DWG_ERR_CRITICAL)",
        "// Line_Reference 5068:                 *dat = abs_dat;",
        "// Line_Reference 5069:             }",
        "// Line_Reference 5070:           else // not a class",
        "// Line_Reference 5071:             {",
        "// Line_Reference 5072:               LOG_WARN (\"Unknown object, skipping eed/reactors/xdic\");",
        "// Line_Reference 5073:               SINCE (R_2000)",
        "// Line_Reference 5074:               {",
        "// Line_Reference 5075:                 obj->bitsize = bit_read_RL (dat);",
        "// Line_Reference 5076:                 LOG_TRACE (\"bitsize: \" FORMAT_RL \" [RL] @%lu.%u\\n\",",
        "// Line_Reference 5077:                            obj->bitsize, dat->byte-2, dat->bit);",
        "// Line_Reference 5078:                 if (obj->bitsize > obj->size * 8)",
        "// Line_Reference 5079:                   {",
        "// Line_Reference 5080:                     LOG_ERROR (\"Invalid bitsize \" FORMAT_RL \" => \" FORMAT_RL,",
        "// Line_Reference 5081:                                obj->bitsize, obj->size * 8);",
        "// Line_Reference 5082:                     obj->bitsize = obj->size * 8;",
        "// Line_Reference 5083:                     error |= DWG_ERR_VALUEOUTOFBOUNDS;",
        "// Line_Reference 5084:                   }",
        "// Line_Reference 5085:               }",
        "// Line_Reference 5086:               if (!bit_read_H (dat, &obj->handle))",
        "// Line_Reference 5087:                 {",
        "// Line_Reference 5088:                   LOG_TRACE (\"handle: \" FORMAT_H \" [H 5]\\n\",",
        "// Line_Reference 5089:                              ARGS_H (obj->handle));",
        "// Line_Reference 5090:                 }",
        "// Line_Reference 5091:               restartpos = dat->byte;",
        "// Line_Reference 5092:               obj->supertype = DWG_SUPERTYPE_UNKNOWN;",
        "// Line_Reference 5093:               obj->tio.unknown = bit_read_TF (dat, obj->size);",
        "// Line_Reference 5094:               dat->byte = restartpos;",
        "// Line_Reference 5095:             }"
    ]
}
