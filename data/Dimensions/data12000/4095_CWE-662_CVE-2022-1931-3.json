{
    "cve_id": "CVE-2022-1931",
    "cve_description": "Incorrect Synchronization in GitHub repository polonel/trudesk prior to 1.2.3.",
    "cve_publish_date": "2022-05-31",
    "cwe_id": "CWE-662",
    "cwe_name": "Improper Synchronization",
    "cwe_description": "The product utilizes multiple threads or processes to allow temporary access to a shared resource that can only be exclusive to one process at a time, but it does not properly synchronize these actions, which might cause simultaneous accesses of this resource by multiple threads or processes.",
    "commit_message": "fix(messages): validation check",
    "type_of_change": "Modification",
    "filename_of_changes": "messages.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "49",
    "number_of_lines_deleted_vulnerable_to_cve": "56",
    "vulnerable_lines": [
        "// Line_Reference 26:   var messagesPage = {}",
        "// Line_Reference 30:       var $messageScroller = $('#message-content.scrollable')",
        "// Line_Reference 31: ",
        "// Line_Reference 32:       var $messagesWrapper = $('#messages')",
        "// Line_Reference 33: ",
        "// Line_Reference 34:       var $scrollspy = $('#conversation-scrollspy')",
        "// Line_Reference 35: ",
        "// Line_Reference 36:       var $spinner = $scrollspy.find('i')",
        "// Line_Reference 37: ",
        "// Line_Reference 38:       var $searchBox = $('.search-box').find('input')",
        "// Line_Reference 39: ",
        "// Line_Reference 40:       var $nextPage = 2",
        "// Line_Reference 41: ",
        "// Line_Reference 42:       var $enabled = true",
        "// Line_Reference 43: ",
        "// Line_Reference 44:       var $loading = false",
        "// Line_Reference 45: ",
        "// Line_Reference 48:       var $recentMessages = {}",
        "// Line_Reference 49: ",
        "// Line_Reference 50:       var $convoId = $('#message-content[data-conversation-id]').attr('data-conversation-id')",
        "// Line_Reference 51: ",
        "// Line_Reference 52:       var $loggedInAccountId = window.trudeskSessionService.getUser()._id",
        "// Line_Reference 56:         var $li = $(target)",
        "// Line_Reference 60:         var convoId = $li.attr('data-conversation-id')",
        "// Line_Reference 90:           var item = $('ul > li[data-conversation-id=\"' + $convoId + '\"]')",
        "// Line_Reference 101:             var self = $(this)",
        "// Line_Reference 111:               var run = _.throttle(loadMoreMessages, 100)",
        "// Line_Reference 125:               var $convo = $('#message-content[data-conversation-id=\"' + response.conversation._id + '\"]')",
        "// Line_Reference 129:                 var $convoLI = $('#convo-list').find('li[data-conversation-id=\"' + response.conversation._id + '\"]')",
        "// Line_Reference 149:         var searchTerm = $searchBox.val().toLowerCase()",
        "// Line_Reference 171:             var messages = data.messages",
        "// Line_Reference 178:             var html = ''",
        "// Line_Reference 181:               var h = buildMessageHTML(m)",
        "// Line_Reference 185:             var stage = $('<div></div>')",
        "// Line_Reference 196:             var height = $(stage).outerHeight()",
        "// Line_Reference 213:         var html = ''",
        "// Line_Reference 214:         var loggedInAccountId = window.trudeskSessionService.getUser()._id",
        "// Line_Reference 216:         var left = true",
        "// Line_Reference 221:         var image = message.owner.image === undefined ? 'defaultProfile.jpg' : message.owner.image",
        "// Line_Reference 262:         var convoListItem = $('#convo-list').find('li[data-conversation-id=\"' + data.cid + '\"]')",
        "// Line_Reference 270:         var convoListItem = $('#convo-list').find('li[data-conversation-id=\"' + data.cid + '\"]')",
        "// Line_Reference 278:         var message = {",
        "// Line_Reference 285:         var html = buildMessageHTML(message)",
        "// Line_Reference 286:         var messageWrapper = $('#message-content[data-conversation-id=\"' + message.conversation + '\"]')",
        "// Line_Reference 291:         var convoListItem = $('li[data-conversation-id=\"' + data.conversation + '\"]')",
        "// Line_Reference 294:           var ul = convoListItem.parent('ul')",
        "// Line_Reference 295:           var li = ul.children('li')",
        "// Line_Reference 302:           var fromName = message.owner.fullname",
        "// Line_Reference 309:           var timezone = helpers.getTimezone()",
        "// Line_Reference 317:           var convoUL = $('#convo-list > ul.message-items')",
        "// Line_Reference 319:             var partner = message.owner",
        "// Line_Reference 323:             var newLI = buildConversationListItem({",
        "// Line_Reference 330:             var $injector = angular.injector(['ng', 'trudesk'])",
        "// Line_Reference 335:                 var $scope = convoUL.prepend(newLI).scope()",
        "// Line_Reference 348:         var html = ''",
        "// Line_Reference 359:         var imageUrl = 'defaultProfile.jpg'"
    ]
}
