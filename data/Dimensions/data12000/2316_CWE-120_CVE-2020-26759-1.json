{
    "cve_id": "CVE-2020-26759",
    "cve_description": "clickhouse-driver before 0.1.5 allows a malicious clickhouse server to trigger a crash or execute arbitrary code (on a database client) via a crafted server response, due to a buffer overflow.",
    "cve_publish_date": "2021-01-06",
    "cwe_id": "CWE-120",
    "cwe_name": "Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')",
    "cwe_description": "The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",
    "commit_message": "Fix read_varint overflow",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "varint.pyx",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 4: def write_varint(Py_ssize_t number, buf):",
        "// Line_Reference 8:     cdef Py_ssize_t i = 0",
        "// Line_Reference 9:     cdef unsigned char towrite",
        "// Line_Reference 10:     # Py_ssize_t checks integer on function call and",
        "// Line_Reference 11:     # raises OverflowError if integer overflows Py_ssize_t.",
        "// Line_Reference 12:     # Long enough for handling Py_ssize_t.",
        "// Line_Reference 16:         towrite = number & 0x7f",
        "// Line_Reference 19:             num_buf[i] = towrite | 0x80",
        "// Line_Reference 22:             num_buf[i] = towrite",
        "// Line_Reference 33:     cdef Py_ssize_t shift = 0",
        "// Line_Reference 34:     cdef Py_ssize_t result = 0",
        "// Line_Reference 35:     cdef unsigned char i"
    ]
}
