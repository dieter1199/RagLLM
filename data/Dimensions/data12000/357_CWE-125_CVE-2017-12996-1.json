{
    "cve_id": "CVE-2017-12996",
    "cve_description": "The PIMv2 parser in tcpdump before 4.9.2 has a buffer over-read in print-pim.c:pimv2_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-12996/PIMv2: Make sure PIM TLVs have the right length.\n\nWe do bounds checks based on the TLV length, so if the TLV's length is\ntoo short, and we don't check for that, we could end up fetching data\npast the end of the TLV - including past the length of the captured data\nin the packet.\n\nThis fixes a buffer over-read discovered by Forcepoint's security\nresearchers Otto Airamo & Antti Levom√§ki.\n\nAdd tests using the capture files supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-pim.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 733: \t\t\t\tunsigned_relts_print(ndo, EXTRACT_16BITS(bp));",
        "// Line_Reference 767: \t\t\t\tND_PRINT((ndo, \"0x%08x\", EXTRACT_32BITS(bp)));",
        "// Line_Reference 771: \t\t\t\tND_PRINT((ndo, \"v%d\", *bp));",
        "// Line_Reference 772: \t\t\t\tif (*(bp+1) != 0) {",
        "// Line_Reference 773: \t\t\t\t\tND_PRINT((ndo, \", interval \"));",
        "// Line_Reference 774: \t\t\t\t\tunsigned_relts_print(ndo, *(bp+1));",
        "// Line_Reference 775: \t\t\t\t}",
        "// Line_Reference 776: \t\t\t\tif (EXTRACT_16BITS(bp+2) != 0) {",
        "// Line_Reference 777: \t\t\t\t\tND_PRINT((ndo, \" ?0x%04x?\", EXTRACT_16BITS(bp+2)));"
    ]
}
