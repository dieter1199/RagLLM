{
    "cve_id": "CVE-2017-13052",
    "cve_description": "The CFM parser in tcpdump before 4.9.2 has a buffer over-read in print-cfm.c:cfm_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-13052/CFM: refine decoding of the Sender ID TLV\n\nIn cfm_network_addr_print() add a length argument and use it to validate\nthe input buffer.\n\nIn cfm_print() add a length check for MAC address chassis ID. Supply\ncfm_network_addr_print() with the length of its buffer and a correct\npointer to the buffer (it was off-by-one before). Change some error\nhandling blocks to skip to the next TLV in the current PDU rather than to\nstop decoding the PDU. Print the management domain and address contents,\nalthough in hex only so far.\n\nAdd some comments to clarify the code flow and to tell exact sections in\nIEEE standard documents. Add new error messages and make some existing\nmessages more specific.\n\nThis fixes a buffer over-read discovered by Bhargava Shastry,\nSecT/TU Berlin.\n\nAdd a test using the capture file supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-cfm.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 220:                        register const u_char *tptr)",
        "// Line_Reference 587:                 return;",
        "// Line_Reference 601:                     return;",
        "// Line_Reference 614:                     return;",
        "// Line_Reference 623:                     hexdump |= cfm_network_addr_print(ndo, tptr);",
        "// Line_Reference 649:                 return;",
        "// Line_Reference 659:                     return;",
        "// Line_Reference 669:                     ND_PRINT((ndo, \"\\n\\t  (TLV too short)\"));",
        "// Line_Reference 670:                     return;"
    ]
}
