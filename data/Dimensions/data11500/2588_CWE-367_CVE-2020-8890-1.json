{
    "cve_id": "CVE-2020-8890",
    "cve_description": "An issue was discovered in MISP before 2.4.121. It mishandled time skew (between the machine hosting the web server and the machine hosting the database) when trying to block a brute-force series of invalid requests.",
    "cve_publish_date": "2020-02-12",
    "cwe_id": "CWE-367",
    "cwe_name": "Time-of-check Time-of-use (TOCTOU) Race Condition",
    "cwe_description": "The product checks the state of a resource before using that resource, but the resource's state can change between the check and the use in a way that invalidates the results of the check. This can cause the product to perform invalid actions when the resource is in an unexpected state.",
    "commit_message": "fix: [security] brutefoce protection rules tightened\n\n- as reported by Dawid Czarnecki",
    "type_of_change": "Modification",
    "filename_of_changes": "Bruteforce.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 52:         $params = array('conditions' => array(",
        "// Line_Reference 53:                         'Bruteforce.ip' => $ip,",
        "// Line_Reference 54:                         'Bruteforce.username' => $username),);",
        "// Line_Reference 56:         if ($count >= Configure::read('SecureAuth.amount')) {"
    ]
}
