{
    "cve_id": "CVE-2022-3138",
    "cve_description": "Cross-site Scripting (XSS) - Generic in GitHub repository jgraph/drawio prior to 20.3.0.",
    "cve_publish_date": "2022-09-08",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.3.0 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Menus.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "67",
    "number_of_lines_deleted_vulnerable_to_cve": "56",
    "vulnerable_lines": [
        "// Line_Reference 316: ",
        "// Line_Reference 317: \t\ttoggleDarkModeAction.isEnabled = function()",
        "// Line_Reference 318: \t\t{",
        "// Line_Reference 319: \t\t\treturn mxSettings.getUi() != 'atlas';",
        "// Line_Reference 320: \t\t};",
        "// Line_Reference 1233: \t\t\t\tvar item = addLangItem('');",
        "// Line_Reference 1249: \t\t\t\tif (menubar != null && urlParams['noLangIcon'] != '1')",
        "// Line_Reference 1251: \t\t\t\t\tvar langMenu = this.get('language');",
        "// Line_Reference 1256: \t\t\t\t\t\telt.setAttribute('title', mxResources.get('language'));",
        "// Line_Reference 1258: \t\t\t\t\t\telt.style.width = '16px';",
        "// Line_Reference 1265: \t\t\t\t\t\telt.style.right = '17px';",
        "// Line_Reference 1267: \t\t\t\t\t\tif (uiTheme == 'atlas')",
        "// Line_Reference 1268: \t\t\t\t\t\t{",
        "// Line_Reference 1269: \t\t\t\t\t\t\telt.style.top = '6px';",
        "// Line_Reference 1270: \t\t\t\t\t\t\telt.style.right = '15px';",
        "// Line_Reference 1271: \t\t\t\t\t\t}",
        "// Line_Reference 1272: \t\t\t\t\t\telse if (uiTheme == 'min')",
        "// Line_Reference 1285: \t\t\t\t\t\ticon.style.backgroundSize = '19px 19px';",
        "// Line_Reference 1287: \t\t\t\t\t\ticon.style.height = '19px';",
        "// Line_Reference 1288: \t\t\t\t\t\ticon.style.width = '19px';",
        "// Line_Reference 1289: \t\t\t\t\t\ticon.style.marginTop = '2px';",
        "// Line_Reference 1292: \t\t\t\t\t\tmxUtils.setOpacity(elt, 40);",
        "// Line_Reference 1302: ",
        "// Line_Reference 1305: \t\t\t\t\t\t\telt.style.opacity = '0.85';",
        "// Line_Reference 2875: \t\t\tvar item = menu.addItem(mxResources.get('automatic'), null, function()",
        "// Line_Reference 2879: ",
        "// Line_Reference 2880: \t\t\tif (theme != 'kennedy' && theme != 'atlas' &&",
        "// Line_Reference 2881: \t\t\t\ttheme != 'dark' && theme != 'min' &&",
        "// Line_Reference 2882: \t\t\t\ttheme != 'sketch')",
        "// Line_Reference 2887: \t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 2888: ",
        "// Line_Reference 2889: \t\t\titem = menu.addItem(mxResources.get('default'), null, function()",
        "// Line_Reference 2891: \t\t\t\teditorUi.setCurrentTheme('kennedy');",
        "// Line_Reference 2893: ",
        "// Line_Reference 2894: \t\t\tif (theme == 'kennedy' || theme == 'dark')",
        "// Line_Reference 2918: ",
        "// Line_Reference 2919: \t\t\titem = menu.addItem(mxResources.get('sketch'), null, function()",
        "// Line_Reference 2920: \t\t\t{",
        "// Line_Reference 2921: \t\t\t\teditorUi.setCurrentTheme('sketch');",
        "// Line_Reference 2922: \t\t\t}, parent);",
        "// Line_Reference 2923: ",
        "// Line_Reference 2924: \t\t\tif (theme == 'sketch')",
        "// Line_Reference 2925: \t\t\t{",
        "// Line_Reference 2926: \t\t\t\tmenu.addCheckmark(item, Editor.checkmarkImage);",
        "// Line_Reference 2927: \t\t\t}",
        "// Line_Reference 2928: ",
        "// Line_Reference 2929: \t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 2930: ",
        "// Line_Reference 2931: \t\t\tif (urlParams['embedInline'] != '1' && Editor.isDarkMode() ||",
        "// Line_Reference 2932: \t\t\t\t(!mxClient.IS_IE && !mxClient.IS_IE11))",
        "// Line_Reference 2933: \t\t\t{",
        "// Line_Reference 2934: \t\t\t\tthis.addMenuItems(menu, ['toggleDarkMode'], parent);",
        "// Line_Reference 2935: \t\t\t}",
        "// Line_Reference 3961: \t\t\tif (urlParams['noLangIcon'] == '1')",
        "// Line_Reference 3964: \t\t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 3970: \t\t\t\tmenu.addSeparator(parent);"
    ]
}
