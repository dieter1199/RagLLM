{
    "cve_id": "CVE-2018-12018",
    "cve_description": "The GetBlockHeadersMsg handler in the LES protocol implementation in Go Ethereum (aka geth) before 1.8.11 may lead to an access violation because of an integer signedness error for the array index, which allows attackers to launch a Denial of Service attack by sending a packet with a -1 query.Skip value. The vulnerable remote node would be crashed by such an attack immediately, aka the EPoD (Ethereum Packet of Death) issue.",
    "cve_publish_date": "2018-07-05",
    "cwe_id": "CWE-129",
    "cwe_name": "Improper Validation of Array Index",
    "cwe_description": "The product uses untrusted input when calculating or using an array index, but the product does not validate or incorrectly validates the index to ensure the index references a valid position within the array.",
    "commit_message": "les: add Skip overflow check to GetBlockHeadersMsg handler (#16891)",
    "type_of_change": "Modification",
    "filename_of_changes": "handler.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 444: \t\t\tcase query.Origin.Hash != (common.Hash{}) && query.Reverse:",
        "// Line_Reference 455: \t\t\tcase query.Origin.Hash != (common.Hash{}) && !query.Reverse:",
        "// Line_Reference 457: \t\t\t\tif header := pm.blockchain.GetHeaderByNumber(origin.Number.Uint64() + query.Skip + 1); header != nil {",
        "// Line_Reference 458: \t\t\t\t\tif pm.blockchain.GetBlockHashesFromHash(header.Hash(), query.Skip+1)[query.Skip] == query.Origin.Hash {",
        "// Line_Reference 459: \t\t\t\t\t\tquery.Origin.Hash = header.Hash()",
        "// Line_Reference 463: \t\t\t\t} else {",
        "// Line_Reference 464: \t\t\t\t\tunknown = true"
    ]
}
