{
    "cve_id": "CVE-2021-3818",
    "cve_description": "grav is vulnerable to Reliance on Cookies without Validation and Integrity Checking",
    "cve_publish_date": "2021-09-27",
    "cwe_id": "CWE-565",
    "cwe_name": "Reliance on Cookies without Validation and Integrity Checking",
    "cwe_description": "The product relies on the existence or values of cookies when performing security-critical operations, but it does not properly ensure that the setting is valid for the associated user.",
    "commit_message": "Fixed `Session::setFlashCookieObject()` to use the same options as the main session cookie",
    "type_of_change": "Modification",
    "filename_of_changes": "Session.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 341:             $params = session_get_cookie_params();",
        "// Line_Reference 342: ",
        "// Line_Reference 343:             $cookie_options = array (",
        "// Line_Reference 344:                 'expires'  => time() - 42000,",
        "// Line_Reference 345:                 'path'     => $params['path'],",
        "// Line_Reference 346:                 'domain'   => $params['domain'],",
        "// Line_Reference 347:                 'secure'   => $params['secure'],",
        "// Line_Reference 348:                 'httponly' => $params['httponly'],",
        "// Line_Reference 349:                 'samesite' => $params['samesite']",
        "// Line_Reference 350:             );",
        "// Line_Reference 351: ",
        "// Line_Reference 357:                 $cookie_options",
        "// Line_Reference 466:      * @return void",
        "// Line_Reference 468:     protected function setCookie(): void",
        "// Line_Reference 472:         $cookie_options = array (",
        "// Line_Reference 473:             'expires'  => time() + $params['lifetime'],",
        "// Line_Reference 479:         );",
        "// Line_Reference 486:             $cookie_options"
    ]
}
