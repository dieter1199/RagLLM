{
    "cve_id": "CVE-2021-4430",
    "cve_description": "A vulnerability classified as problematic has been found in Ortus Solutions ColdBox Elixir 3.1.6. This affects an unknown part of the file src/defaultConfig.js of the component ENV Variable Handler. The manipulation leads to information disclosure. Upgrading to version 3.1.7 is able to address this issue. The identifier of the patch is a3aa62daea2e44c76d08d1eac63768cd928cd69e. It is recommended to upgrade the affected component. The identifier VDB-244485 was assigned to this vulnerability.",
    "cve_publish_date": "2023-11-06",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix security vulnerability that echoed out all ENV vars.\n\nIn a mistaken attempt to make defining ENV vars easier, Elixir\nwould define every ENV var using Webpack's `DefinePlugin`.\nThis was a mistake.  The entire ENV of the server generating the\nbundle would be serialized into an object and delivered in the\nJavaScript bundle.  This code has been removed.  You need to allow\nENV variables using the webpack's `DefinePlugin` or `EnvironmentPlugin`.\nTo make this easier, Elixir now has a `mix.env` method that forwards\nall arguments on to `EnvironmentPlugin`.",
    "type_of_change": "Modification",
    "filename_of_changes": "defaultConfig.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 10: const webpack = require(\"webpack\");",
        "// Line_Reference 118:         new webpack.DefinePlugin({",
        "// Line_Reference 119:             // stringify each value so webpack doesn't insert variables instead of strings",
        "// Line_Reference 120:             \"process.env\": Object.keys(process.env).reduce((obj, key) => {",
        "// Line_Reference 121:                 obj[key] = JSON.stringify(process.env[key]);",
        "// Line_Reference 122:                 return obj;",
        "// Line_Reference 123:             }, {})",
        "// Line_Reference 124:         })"
    ]
}
