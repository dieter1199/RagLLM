{
    "cve_id": "CVE-2016-8900",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a Object Injection vulnerability in framework/modules/core/controllers/expTagController.php related to change_tags.",
    "cve_publish_date": "2019-05-24",
    "cwe_id": "CWE-74",
    "cwe_name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
    "cwe_description": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "orderController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "54",
    "number_of_lines_deleted_vulnerable_to_cve": "52",
    "vulnerable_lines": [
        "// Line_Reference 25:     protected $add_permissions = array(",
        "// Line_Reference 26:         'showall'             => 'Manage',",
        "// Line_Reference 27:         'show'                => 'View Orders',",
        "// Line_Reference 28:         'setStatus'           => 'Change Status',",
        "// Line_Reference 29:         'edit_payment_info'   => 'Edit Payment Info',",
        "// Line_Reference 31:         'edit_address'        => 'Edit Address',",
        "// Line_Reference 33:         'edit_order_item'     => 'Edit Order Item',",
        "// Line_Reference 35:         'add_order_item'      => 'Add Order Item',",
        "// Line_Reference 36:         'save_new_order_item'=> 'Save New Order Item',",
        "// Line_Reference 37:         'edit_totals'         => 'Edit Totals',",
        "// Line_Reference 39:         'edit_invoice_id'     => 'Edit Invoice Id',",
        "// Line_Reference 41:         'update_sales_reps'   => 'Manage Sales Reps',",
        "// Line_Reference 42:         'quickfinder'=> 'Do a quick order lookup',",
        "// Line_Reference 43:         'edit_shipping_method'=> 'Edit Shipping Method',",
        "// Line_Reference 45:         'create_new_order'    => 'Create A New Order',",
        "// Line_Reference 47:         'createReferenceOrder'=> 'Create Reference Order',",
        "// Line_Reference 48:         'save_reference_order'=> 'Save Reference Order'",
        "// Line_Reference 69: ",
        "// Line_Reference 76:                     $db->delete('orderitems', 'orders_id='.$cart->id);",
        "// Line_Reference 78: ",
        "// Line_Reference 82:             }",
        "// Line_Reference 83: ",
        "// Line_Reference 250:         //viewing of the order?",
        "// Line_Reference 418:                     //eDebug($order['id'] . \": \" . $timer->mark());",
        "// Line_Reference 553: ",
        "// Line_Reference 881:             //eDebug($note,true);",
        "// Line_Reference 923:         // figure out what metadata to pass back based on the action",
        "// Line_Reference 960:         /*eDebug($this->params);",
        "// Line_Reference 1296:         //eDebug($order,true);",
        "// Line_Reference 1351:         //eDebug(expUnserialize($order->billingmethod[0]->billing_options));",
        "// Line_Reference 1352:         //eDebug(expUnserialize($order->billingmethod[0]->billingtransaction[0]->billing_options),true);",
        "// Line_Reference 1380:             //$newOi->products_tax = 0;",
        "// Line_Reference 1409:         //eDebug($order,true);",
        "// Line_Reference 1493:         //eDebug(expUnserialize($order->billingmethod[0]->billing_options));",
        "// Line_Reference 1494:         //eDebug(expUnserialize($order->billingmethod[0]->billingtransaction[0]->billing_options),true);",
        "// Line_Reference 1669:             //$oi->product->optiongroup = $parProd->optiongroup;",
        "// Line_Reference 1779:             /*if ($uif['is_required'] || (!$uif['is_required'] && strlen($params['user_input_fields'][$uifkey]) > 0))",
        "// Line_Reference 1783:                     //flash('error', 'test');",
        "// Line_Reference 1784:                     //redirect_to(array('controller'=>cart, 'action'=>'displayForm', 'form'=>'addToCart', 'product_id'=>$this->id, 'product_type'=>$this->product_type));",
        "// Line_Reference 1786: ",
        "// Line_Reference 1789:                     //flash('error', );",
        "// Line_Reference 1790:                     //redirect_to(array('controller'=>cart, 'action'=>'displayForm', 'form'=>'addToCart', 'product_id'=>$this->id, 'product_type'=>$this->product_type));",
        "// Line_Reference 1792:                 }",
        "// Line_Reference 1801:         //eDebug($oi);",
        "// Line_Reference 1859:             //we'll send over the product_id of the parent, along with id's and quantities of children we're adding",
        "// Line_Reference 2010: ",
        "// Line_Reference 2017:                 redirect_to(array('controller'=>'order','action'=>'show','id'=>$order[0]->id));",
        "// Line_Reference 2036:                 redirect_to(array('controller'=>'order','action'=>'show','id'=>$order->id));",
        "// Line_Reference 2045:             flashAndFlow('message','Invalid order number.');",
        "// Line_Reference 2074:                 //eDebug($tmpCart,true);",
        "// Line_Reference 2128:         $sql .= \"from \" . $db->prefix . \"addresses as a \"; //R JOIN \" .",
        "// Line_Reference 2151:         $sql .= \"from \" . $db->prefix . \"external_addresses as a \"; //R JOIN \" ."
    ]
}
