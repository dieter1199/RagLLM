{
    "cve_id": "CVE-2021-36222",
    "cve_description": "ec_verify in kdc/kdc_preauth_ec.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.18.4 and 1.19.x before 1.19.2 allows remote attackers to cause a NULL pointer dereference and daemon crash. This occurs because a return value is not properly managed in a certain situation.",
    "cve_publish_date": "2021-07-22",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fix KDC null deref on bad encrypted challenge\n\nThe function ec_verify() in src/kdc/kdc_preauth_ec.c contains a check\nto avoid further processing if the armor key is NULL.  However, this\ncheck is bypassed by a call to k5memdup0() which overwrites retval\nwith 0 if the allocation succeeds.  If the armor key is NULL, a call\nto krb5_c_fx_cf2_simple() will then dereference it, resulting in a\ncrash.  Add a check before the k5memdup0() call to avoid overwriting\nretval.\n\nCVE-2021-36222:\n\nIn MIT krb5 releases 1.16 and later, an unauthenticated attacker can\ncause a null dereference in the KDC by sending a request containing a\nPA-ENCRYPTED-CHALLENGE padata element without using FAST.\n\n[ghudson@mit.edu: trimmed patch; added test case; edited commit\nmessage]\n\nticket: 9007 (new)\ntags: pullup\ntarget_version: 1.19-next\ntarget_version: 1.18-next",
    "type_of_change": "Modification",
    "filename_of_changes": "kdc_preauth_ec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 90:     realmstr = k5memdup0(realm.data, realm.length, &retval);"
    ]
}
