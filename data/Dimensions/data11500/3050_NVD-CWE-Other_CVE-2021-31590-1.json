{
    "cve_id": "CVE-2021-31590",
    "cve_description": "PwnDoc all versions until 0.4.0 (2021-08-23) has incorrect JSON Webtoken handling, leading to incorrect access control. With a valid JSON Webtoken that is used for authentication and authorization, a user can keep his admin privileges even if he is downgraded to the \"user\" privilege. Even after a user's account is deleted, the user can still access the administration panel (and add or delete users) and has complete access to the system.",
    "cve_publish_date": "2021-07-19",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Update Session management using refresh token\n\nAdded refresh token with lifetime of 7 days\nToken has now a lifetime of 15min\nRefresh token is updated on the frontend each time application is loaded or every 14min\nEach refresh token is associated with a sessionId allowing to have multiple sessions on different devices",
    "type_of_change": "Modification",
    "filename_of_changes": "axios.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "47",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 8: export default ({ Vue }) => {",
        "// Line_Reference 10:   // Redirect to login if response is 401 (Unauthenticated)",
        "// Line_Reference 11:   axiosInstance.interceptors.response.use(response => {",
        "// Line_Reference 13:   }, error => {",
        "// Line_Reference 14:    if (error.response.status === 401) {",
        "// Line_Reference 15:      if (window.location.pathname !== '/login')",
        "// Line_Reference 16:       window.location = '/login'",
        "// Line_Reference 17:    }",
        "// Line_Reference 18:   return error",
        "// Line_Reference 19:   })",
        "// Line_Reference 22:   User.refreshToken()"
    ]
}
