{
    "cve_id": "CVE-2021-3920",
    "cve_description": "grav-plugin-admin is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cve_publish_date": "2021-11-19",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed unescaped messages in JSON responses",
    "type_of_change": "Modification",
    "filename_of_changes": "AdminBaseController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 274:                     $filename, 'Bad filename')",
        "// Line_Reference 294:                     $settings->destination)",
        "// Line_Reference 305:                     $filename, $this->upload_errors[$upload->file->error])",
        "// Line_Reference 343:                     $errors[] = 'The MIME type \"' . $mime . '\" for the file \"' . $filename . '\" is not an accepted.';",
        "// Line_Reference 351:                     $errors[] = 'The File Extension for the file \"' . $filename . '\" is not an accepted.';",
        "// Line_Reference 382:                 'message' => sprintf($this->admin::translate('PLUGIN_ADMIN.FILEUPLOAD_UNABLE_TO_MOVE', null), '',",
        "// Line_Reference 383:                     $tmp)"
    ]
}
