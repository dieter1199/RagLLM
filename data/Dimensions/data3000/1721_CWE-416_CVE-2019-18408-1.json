{
    "cve_id": "CVE-2019-18408",
    "cve_description": "archive_read_format_rar_read_data in archive_read_support_format_rar.c in libarchive before 3.4.0 has a use-after-free in a certain ARCHIVE_FAILED situation, related to Ppmd7_DecodeSymbol.",
    "cve_publish_date": "2019-10-24",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "RAR reader: fix use after free\n\nIf read_data_compressed() returns ARCHIVE_FAILED, the caller is allowed\nto continue with next archive headers. We need to set rar->start_new_table\nafter the ppmd7_context got freed, otherwise it won't be allocated again.\n\nReported by: OSS-Fuzz issue 2582",
    "type_of_change": "Modification",
    "filename_of_changes": "archive_read_support_format_rar.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1027:     if (ret != ARCHIVE_OK && ret != ARCHIVE_WARN)"
    ]
}
