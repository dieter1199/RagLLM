{
    "cve_id": "CVE-2016-7553",
    "cve_description": "The buf.pl script before 2.20 in Irssi before 0.8.20 uses weak permissions for the scrollbuffer dump file created between upgrades, which might allow local users to obtain sensitive information from private chat conversations by reading the file.",
    "cve_publish_date": "2017-02-27",
    "cwe_id": "CWE-275",
    "cwe_name": "Permission Issues",
    "cwe_description": "Weaknesses in this category are related to improper assignment or handling of permissions.",
    "commit_message": "Fix disclosure via filesystem\n\nbuf.pl restores the scrollbuffer between \"/upgrade\"s by writing the\ncontents to a file, and reading that after the new process was spawned.\nThrough that file, the contents of (private) chat conversations may leak to\nother users.\n\nCareful users with a limited umask (e.g. 077) are not affected by this bug.\nHowever, most Linux systems default to a umask of 022, meaning that files\nwritten without further restricting the permissions, are readable by any\nuser.\n\nThis patch sets a safer umask of 077 for the scrollbuffer dump, and will\nremove the temporary file after use to further reduce the attack surface.\nAdditionally, it will remove any remaining temporary scrollbuffer file left\nin place, like those written by previous versions of the script.",
    "type_of_change": "Modification",
    "filename_of_changes": "buf.pl",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 8: $VERSION = '2.13';",
        "// Line_Reference 16:     changed\t=> 'Mon May 13 19:41 CET 2002',",
        "// Line_Reference 17:     changes\t=> 'Severe formatting bug removed * oops, I ' .",
        "// Line_Reference 18:                    'exposed Irssi to ircII foolishness * sorry ' .",
        "// Line_Reference 19: \t\t   '** removed logging stuff (this is a fix)',",
        "// Line_Reference 43:     open BUF, q{>}, sprintf('%s/scrollbuffer', get_irssi_dir) or die $!;",
        "// Line_Reference 44:     print BUF join(\"\\0\", map $_->{server}->{address} . $_->{name}, channels), \"\\n\";",
        "// Line_Reference 60: \tprintf BUF \"%s:%s\\n%s\", $window->{refnum}, $lines, $buf;",
        "// Line_Reference 62:     close BUF;",
        "// Line_Reference 69:     open BUF, q{<}, sprintf('%s/scrollbuffer', get_irssi_dir) or die $!;",
        "// Line_Reference 70:     my @suppress = split /\\0/, <BUF>;",
        "// Line_Reference 76:     while (my $bla = <BUF>){",
        "// Line_Reference 82: \t    <BUF> for 1..$lines;",
        "// Line_Reference 89: \t$buf .= <BUF> for 1..$lines;"
    ]
}
