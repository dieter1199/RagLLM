{
    "cve_id": "CVE-2020-15130",
    "cve_description": "In SLPJS (npm package slpjs) before version 0.27.4, there is a vulnerability to false-positive validation outcomes for the NFT1 Child Genesis transaction type. A poorly implemented SLP wallet or opportunistic attacker could create a seemingly valid NFT1 child token without burning any of the NFT1 Group token type as is required by the NFT1 specification. This is fixed in version 0.27.4.",
    "cve_publish_date": "2020-07-30",
    "cwe_id": "CWE-697",
    "cwe_name": "Incorrect Comparison",
    "cwe_description": "The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses.",
    "commit_message": "critical update for NFT child genesis validation",
    "type_of_change": "Modification",
    "filename_of_changes": "localvalidator.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 213:                 let input_txid = txn.inputs[0].prevTxId.toString(\"hex\");",
        "// Line_Reference 214:                 let input_txhex = await this.retrieveRawTransaction(input_txid);",
        "// Line_Reference 215:                 let input_tx: Bitcore.Transaction = new Bitcore.Transaction(input_txhex);",
        "// Line_Reference 227:                 if (input_slpmsg.transactionType === SlpTransactionType.SEND &&",
        "// Line_Reference 228:                     (!input_slpmsg.sendOutputs![1].isGreaterThan(0)))",
        "// Line_Reference 229:                 {",
        "// Line_Reference 230:                     this.cachedValidations[txid].validity = false;",
        "// Line_Reference 231:                     this.cachedValidations[txid].waiting = false;",
        "// Line_Reference 232:                     this.cachedValidations[txid].invalidReason = \"NFT1 child's parent has SLP output that is not greater than zero.\";",
        "// Line_Reference 233:                     return this.cachedValidations[txid].validity!;",
        "// Line_Reference 234:                 } else if ((input_slpmsg.transactionType === SlpTransactionType.GENESIS ||",
        "// Line_Reference 235:                             input_slpmsg.transactionType === SlpTransactionType.MINT) &&",
        "// Line_Reference 236:                             !input_slpmsg.genesisOrMintQuantity!.isGreaterThan(0))",
        "// Line_Reference 237:                 {",
        "// Line_Reference 238:                     this.cachedValidations[txid].validity = false;",
        "// Line_Reference 239:                     this.cachedValidations[txid].waiting = false;",
        "// Line_Reference 240:                     this.cachedValidations[txid].invalidReason = \"NFT1 child's parent has SLP output that is not greater than zero.\";",
        "// Line_Reference 241:                     return this.cachedValidations[txid].validity!;"
    ]
}
