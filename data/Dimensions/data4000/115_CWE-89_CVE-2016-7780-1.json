{
    "cve_id": "CVE-2016-7780",
    "cve_description": "SQL injection vulnerability in cron/find_help.php in Exponent CMS 2.3.9 and earlier allows remote attackers to execute arbitrary SQL commands via the version parameter.",
    "cve_publish_date": "2017-03-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "second effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...), thanks to felixk3y",
    "type_of_change": "Modification",
    "filename_of_changes": "cartController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "24",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 77:                     /*if ($quantity < $child->minimum_order_quantity)",
        "// Line_Reference 79:                         flash('message', $child->title . \" - \" . $child->model . \" has a minimum order quantity of \" . $child->minimum_order_quantity .",
        "// Line_Reference 82: ",
        "// Line_Reference 174:                 //$newqty = $item->product->updateQuantity($this->params['value']);",
        "// Line_Reference 220:                 //}",
        "// Line_Reference 221:                 /*eDebug($item->quantity);",
        "// Line_Reference 222:                 eDebug($item->product->quantity);",
        "// Line_Reference 223:                 eDebug($qCheck);",
        "// Line_Reference 246:                         /*$updates->message = $item->products_name.' only has '.$item->product->quantity.' on hand. You can not add any more to your cart.';",
        "// Line_Reference 305:             //to something other than 0, then we have, but we'll set the estimtae to shipping_total to",
        "// Line_Reference 313:             //{",
        "// Line_Reference 335:                 // get all current discount codes that are valid and applied",
        "// Line_Reference 706:             // save out the cart total to the database",
        "// Line_Reference 1072:         $discount = $discount->getCouponByName($this->params['coupon_code']);",
        "// Line_Reference 1076:             //redirect_to(array('controller'=>'cart', 'action'=>'checkout'));",
        "// Line_Reference 1103:         //redirect_to(array('controller'=>'cart', 'action'=>'checkout'));",
        "// Line_Reference 1144:         //group items by type and id",
        "// Line_Reference 1148:         //eDebug($order,true);",
        "// Line_Reference 1188: ",
        "// Line_Reference 1189: ",
        "// Line_Reference 1190:         $options = array();",
        "// Line_Reference 1193: ",
        "// Line_Reference 1201:                     $cost = $selected_option->updown == '+' ? $cost : $cost * -1;",
        "// Line_Reference 1215: "
    ]
}
