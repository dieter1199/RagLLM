{
    "cve_id": "CVE-2019-20791",
    "cve_description": "OpenThread before 2019-12-13 has a stack-based buffer overflow in MeshCoP::Commissioner::GeneratePskc.",
    "cve_publish_date": "2020-04-28",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "[commissioner] use strnlen instead of strlen (#4404)",
    "type_of_change": "Modification",
    "filename_of_changes": "commissioner.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 258:     VerifyOrExit(strlen(aPskd) <= Dtls::kPskMaxLength, error = OT_ERROR_INVALID_ARGS);",
        "// Line_Reference 1106:     otError     error      = OT_ERROR_NONE;",
        "// Line_Reference 1107:     const char *saltPrefix = \"Thread\";",
        "// Line_Reference 1108:     uint8_t     salt[OT_PBKDF2_SALT_MAX_LEN];",
        "// Line_Reference 1109:     uint16_t    saltLen = 0;",
        "// Line_Reference 1110: ",
        "// Line_Reference 1111:     VerifyOrExit((strlen(aPassPhrase) >= OT_COMMISSIONING_PASSPHRASE_MIN_SIZE) &&",
        "// Line_Reference 1112:                      (strlen(aPassPhrase) <= OT_COMMISSIONING_PASSPHRASE_MAX_SIZE) &&",
        "// Line_Reference 1113:                      (strlen(aNetworkName) <= OT_NETWORK_NAME_MAX_SIZE),",
        "// Line_Reference 1117:     memcpy(salt, saltPrefix, strlen(saltPrefix));",
        "// Line_Reference 1118:     saltLen += static_cast<uint16_t>(strlen(saltPrefix));",
        "// Line_Reference 1123:     memcpy(salt + saltLen, aNetworkName, strlen(aNetworkName));",
        "// Line_Reference 1124:     saltLen += static_cast<uint16_t>(strlen(aNetworkName));",
        "// Line_Reference 1126:     otPbkdf2Cmac(reinterpret_cast<const uint8_t *>(aPassPhrase), static_cast<uint16_t>(strlen(aPassPhrase)),",
        "// Line_Reference 1127:                  reinterpret_cast<const uint8_t *>(salt), saltLen, 16384, OT_PSKC_MAX_SIZE, aPskc.m8);"
    ]
}
