{
    "cve_id": "CVE-2018-13094",
    "cve_description": "An issue was discovered in fs/xfs/libxfs/xfs_attr_leaf.c in the Linux kernel through 4.17.3. An OOPS may occur for a corrupted xfs image after xfs_da_shrink_inode() is called with a NULL bp.",
    "cve_publish_date": "2018-07-03",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "xfs: don't call xfs_da_shrink_inode with NULL bp\n\nxfs_attr3_leaf_create may have errored out before instantiating a buffer,\nfor example if the blkno is out of range.  In that case there is no work\nto do to remove it, and in fact xfs_da_shrink_inode will lead to an oops\nif we try.\n\nThis also seems to fix a flaw where the original error from\nxfs_attr3_leaf_create gets overwritten in the cleanup case, and it\nremoves a pointless assignment to bp which isn't used after this.\n\nBugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=199969\nReported-by: Xu, Wen <wen.xu@gatech.edu>\nTested-by: Xu, Wen <wen.xu@gatech.edu>\nSigned-off-by: Eric Sandeen <sandeen@redhat.com>\nReviewed-by: Darrick J. Wong <darrick.wong@oracle.com>\nSigned-off-by: Darrick J. Wong <darrick.wong@oracle.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfs_attr_leaf.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 794: \t\terror = xfs_da_shrink_inode(args, 0, bp);",
        "// Line_Reference 795: \t\tbp = NULL;",
        "// Line_Reference 796: \t\tif (error)"
    ]
}
