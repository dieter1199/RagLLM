{
    "cve_id": "CVE-2015-0204",
    "cve_description": "The ssl3_get_key_exchange function in s3_clnt.c in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k allows remote SSL servers to conduct RSA-to-EXPORT_RSA downgrade attacks and facilitate brute-force decryption by offering a weak ephemeral RSA key in a noncompliant role, related to the \"FREAK\" issue.  NOTE: the scope of this CVE is only client code based on OpenSSL, not EXPORT_RSA issues associated with servers or other TLS implementations.",
    "cve_publish_date": "2015-01-09",
    "cwe_id": "CWE-310",
    "cwe_name": "Cryptographic Issues",
    "cwe_description": "Weaknesses in this category are related to the design and implementation of data confidentiality and integrity. Frequently these deal with the use of encoding techniques, encryption libraries, and hashing algorithms. The weaknesses in this category could lead to a degradation of the quality data if they are not addressed.",
    "commit_message": "Only allow ephemeral RSA keys in export ciphersuites.\n\nOpenSSL clients would tolerate temporary RSA keys in non-export\nciphersuites. It also had an option SSL_OP_EPHEMERAL_RSA which\nenabled this server side. Remove both options as they are a\nprotocol violation.\n\nThanks to Karthikeyan Bhargavan for reporting this issue.\n(CVE-2015-0204)\nReviewed-by: Matt Caswell <matt@openssl.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "d1_srvr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 475: \t\t\t/* clear this, it may get reset by",
        "// Line_Reference 476: \t\t\t * send_server_key_exchange */",
        "// Line_Reference 477: \t\t\tif ((s->options & SSL_OP_EPHEMERAL_RSA)",
        "// Line_Reference 478: #ifndef OPENSSL_NO_KRB5",
        "// Line_Reference 479: \t\t\t\t&& !(alg_k & SSL_kKRB5)",
        "// Line_Reference 480: #endif /* OPENSSL_NO_KRB5 */",
        "// Line_Reference 481: \t\t\t\t)",
        "// Line_Reference 482: \t\t\t\t/* option SSL_OP_EPHEMERAL_RSA sends temporary RSA key",
        "// Line_Reference 483: \t\t\t\t * even when forbidden by protocol specs",
        "// Line_Reference 484: \t\t\t\t * (handshake may fail as clients are not required to",
        "// Line_Reference 485: \t\t\t\t * be able to handle this) */",
        "// Line_Reference 486: \t\t\t\ts->s3->tmp.use_rsa_tmp=1;",
        "// Line_Reference 487: \t\t\telse",
        "// Line_Reference 488: \t\t\t\ts->s3->tmp.use_rsa_tmp=0;",
        "// Line_Reference 492: \t\t\tif (s->s3->tmp.use_rsa_tmp"
    ]
}
