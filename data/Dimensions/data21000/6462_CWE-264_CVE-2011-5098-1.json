{
    "cve_id": "CVE-2011-5098",
    "cve_description": "chef-server-api/app/controllers/clients.rb in Chef Server in Chef before 0.9.20, and 0.10.x before 0.10.6, does not require administrative privileges for creating admin clients, which allows remote authenticated users to bypass intended access restrictions by leveraging read permission for the validation key and executing a knife client create command with the --admin option.",
    "cve_publish_date": "2012-08-08",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "CHEF-2649: Only allow admin clients to create admins (not validators)",
    "type_of_change": "Modification",
    "filename_of_changes": "clients.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 52:       # We can only get here if we're admin or the validator. Only",
        "// Line_Reference 53:       # allow creating admin clients if we're already an admin.",
        "// Line_Reference 54:       if @auth_user.admin",
        "// Line_Reference 55:         params[:admin] ||= params[:inflated_object].admin",
        "// Line_Reference 56:       else",
        "// Line_Reference 57:         params[:admin] = false",
        "// Line_Reference 58:       end"
    ]
}
