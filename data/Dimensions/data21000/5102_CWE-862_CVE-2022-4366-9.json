{
    "cve_id": "CVE-2022-4366",
    "cve_description": "Missing Authorization in GitHub repository lirantal/daloradius prior to master branch.",
    "cve_publish_date": "2022-12-08",
    "cwe_id": "CWE-862",
    "cwe_name": "Missing Authorization",
    "cwe_description": "The product does not perform an authorization check when an actor attempts to access a resource or perform an action.",
    "commit_message": "fix: introduced security fixes (#263)\n\n- dologin.php - validating user input and introduced CSRF token check\r\n- logging.php - preventing direct access to this file, which means redirecting to index.php when directly hitting this include file, (repeated for other exten. / include / etc. files), and optimized logging features\r\n- actionMessages.php and errorHandling.php same as logging.php\r\n- library/exten-* files - preventing direct access to these files, generalized the approach of looking for known file locations, improved user input validation (params such as limit, etc.), improved output (escaping logfile output, etc.)\r\n- in library/exten-server_info.php - i also have added new commands for retrieving network information and system distro/version\r\n- opendb.php - general code optimization (TODO prevent direct access to this file)\r\n- sessions.php - introduced new session handling (TODO prevent direct access to this file)\r\n- login.php - removed the default username hardcoded in the form, added the csrf_token\r\n- rep-* - user input validation, code optimization",
    "type_of_change": "Modification",
    "filename_of_changes": "exten-welcome_page.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 17:  * Description:",
        "// Line_Reference 18:  *\t\tdisplays a welcome page for the main index.php file",
        "// Line_Reference 20:  * Authors:\tLiran Tal <liran@enginx.com>",
        "// Line_Reference 21:  *          Miguel Garc√≠a <miguelvisgarcia@gmail.com>",
        "// Line_Reference 26: echo \"",
        "// Line_Reference 27: \t<center>",
        "// Line_Reference 28: ",
        "// Line_Reference 29: \t\t<h2> daloRADIUS Web Management Server </h2>",
        "// Line_Reference 30: \t\t<h3> \".t('all','daloRADIUSVersion').\" / \".$configValues['DALORADIUS_DATE'].\" </h3>",
        "// Line_Reference 31: \t\t<h4> <a href=\\\"mailto:liran.tal@gmail.com\\\"> Liran Tal </a> </h4>",
        "// Line_Reference 32: \t\t<br/><br/><br/>",
        "// Line_Reference 33: \t\t<img src='images/daloradius_logo.jpg' border=0 />",
        "// Line_Reference 34: \t</center>",
        "// Line_Reference 35: \";",
        "// Line_Reference 36: "
    ]
}
