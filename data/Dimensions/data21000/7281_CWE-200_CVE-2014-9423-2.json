{
    "cve_id": "CVE-2014-9423",
    "cve_description": "The svcauth_gss_accept_sec_context function in lib/rpc/svc_auth_gss.c in MIT Kerberos 5 (aka krb5) 1.11.x through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 transmits uninitialized interposer data to clients, which allows remote attackers to obtain sensitive information from process heap memory by sniffing the network for data in a handle field.",
    "cve_publish_date": "2015-02-19",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Fix gssrpc data leakage [CVE-2014-9423]\n\n[MITKRB5-SA-2015-001] In svcauth_gss_accept_sec_context(), do not copy\nbytes from the union context into the handle field we send to the\nclient.  We do not use this handle field, so just supply a fixed\nstring of \"xxxx\".\n\nIn gss_union_ctx_id_struct, remove the unused \"interposer\" field which\nwas causing part of the union context to remain uninitialized.\n\nticket: 8058 (new)\ntarget_version: 1.13.1\ntags: pullup",
    "type_of_change": "Modification",
    "filename_of_changes": "svc_auth_gss.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 68: /*",
        "// Line_Reference 69:  * from mit-krb5-1.2.1 mechglue/mglueP.h:",
        "// Line_Reference 70:  * Array of context IDs typed by mechanism OID",
        "// Line_Reference 71:  */",
        "// Line_Reference 72: typedef struct gss_union_ctx_id_t {",
        "// Line_Reference 73:   gss_OID     mech_type;",
        "// Line_Reference 74:   gss_ctx_id_t    internal_ctx_id;",
        "// Line_Reference 75: } gss_union_ctx_id_desc, *gss_union_ctx_id_t;",
        "// Line_Reference 76: ",
        "// Line_Reference 77: ",
        "// Line_Reference 242: \t/*",
        "// Line_Reference 243: \t * ANDROS: krb5 mechglue returns ctx of size 8 - two pointers,",
        "// Line_Reference 244: \t * one to the mechanism oid, one to the internal_ctx_id",
        "// Line_Reference 245: \t */",
        "// Line_Reference 246: \tif ((gr->gr_ctx.value = mem_alloc(sizeof(gss_union_ctx_id_desc))) == NULL) {",
        "// Line_Reference 247: \t\tfprintf(stderr, \"svcauth_gss_accept_context: out of memory\\n\");",
        "// Line_Reference 248: \t\tgoto errout;",
        "// Line_Reference 249: \t}",
        "// Line_Reference 250: \tmemcpy(gr->gr_ctx.value, gd->ctx, sizeof(gss_union_ctx_id_desc));",
        "// Line_Reference 251: \tgr->gr_ctx.length = sizeof(gss_union_ctx_id_desc);",
        "// Line_Reference 523: \t\t\tmem_free(gr.gr_ctx.value,",
        "// Line_Reference 524: \t\t\t\t sizeof(gss_union_ctx_id_desc));",
        "// Line_Reference 534: \t\tmem_free(gr.gr_ctx.value, sizeof(gss_union_ctx_id_desc));"
    ]
}
