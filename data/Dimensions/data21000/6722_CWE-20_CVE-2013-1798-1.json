{
    "cve_id": "CVE-2013-1798",
    "cve_description": "The ioapic_read_indirect function in virt/kvm/ioapic.c in the Linux kernel through 3.8.4 does not properly handle a certain combination of invalid IOAPIC_REG_SELECT and IOAPIC_REG_WINDOW operations, which allows guest OS users to obtain sensitive information from host OS memory or cause a denial of service (host OS OOPS) via a crafted application.",
    "cve_publish_date": "2013-03-22",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "KVM: Fix bounds checking in ioapic indirect register reads (CVE-2013-1798)\n\nIf the guest specifies a IOAPIC_REG_SELECT with an invalid value and follows\nthat with a read of the IOAPIC_REG_WINDOW KVM does not properly validate\nthat request.  ioapic_read_indirect contains an\nASSERT(redir_index < IOAPIC_NUM_PINS), but the ASSERT has no effect in\nnon-debug builds.  In recent kernels this allows a guest to cause a kernel\noops by reading invalid memory.  In older kernels (pre-3.3) this allows a\nguest to read from large ranges of host memory.\n\nTested: tested against apic unit tests.\n\nSigned-off-by: Andrew Honig <ahonig@google.com>\nSigned-off-by: Marcelo Tosatti <mtosatti@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "ioapic.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 77: \t\t\tASSERT(redir_index < IOAPIC_NUM_PINS);",
        "// Line_Reference 79: \t\t\tredir_content = ioapic->redirtbl[redir_index].bits;"
    ]
}
