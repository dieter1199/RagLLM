{
    "cve_id": "CVE-2012-2313",
    "cve_description": "The rio_ioctl function in drivers/net/ethernet/dlink/dl2k.c in the Linux kernel before 3.3.7 does not restrict access to the SIOCSMIIREG command, which allows local users to write data to an Ethernet adapter via an ioctl call.",
    "cve_publish_date": "2012-06-13",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "dl2k: Clean up rio_ioctl\n\nThe dl2k driver's rio_ioctl call has a few issues:\n- No permissions checking\n- Implements SIOCGMIIREG and SIOCGMIIREG using the SIOCDEVPRIVATE numbers\n- Has a few ioctls that may have been used for debugging at one point\n  but have no place in the kernel proper.\n\nThis patch removes all but the MII ioctls, renumbers them to use the\nstandard ones, and adds the proper permission check for SIOCSMIIREG.\n\nWe can also get rid of the dl2k-specific struct mii_data in favor of\nthe generic struct mii_ioctl_data.\n\nSince we have the phyid on hand, we can add the SIOCGMIIPHY ioctl too.\n\nMost of the MII code for the driver could probably be converted to use\nthe generic MII library but I don't have a device to test the results.\n\nReported-by: Stephan Mueller <stephan.mueller@atsec.com>\nSigned-off-by: Jeff Mahoney <jeffm@suse.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "dl2k.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 368: struct mii_data {",
        "// Line_Reference 369: \t__u16 reserved;",
        "// Line_Reference 370: \t__u16 reg_num;",
        "// Line_Reference 371: \t__u16 in_value;",
        "// Line_Reference 372: \t__u16 out_value;",
        "// Line_Reference 373: };",
        "// Line_Reference 374: "
    ]
}
