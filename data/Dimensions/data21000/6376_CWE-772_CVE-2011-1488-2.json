{
    "cve_id": "CVE-2011-1488",
    "cve_description": "A memory leak in rsyslog before 5.7.6 was found in the way deamon processed log messages are logged when $RepeatedMsgReduction was enabled. A local attacker could use this flaw to cause a denial of the rsyslogd daemon service by crashing the service via a sequence of repeated log messages sent within short periods of time.",
    "cve_publish_date": "2019-11-14",
    "cwe_id": "CWE-772",
    "cwe_name": "Missing Release of Resource after Effective Lifetime",
    "cwe_description": "The product does not release a resource after its effective lifetime has ended, i.e., after the resource is no longer needed.",
    "commit_message": "bugfix: fixed a memory leak and potential abort condition\n\nthis could happen if multiple rulesets were used and some output batches\ncontained messages belonging to more than one ruleset.\nfixes: http://bugzilla.adiscon.com/show_bug.cgi?id=226\nfixes: http://bugzilla.adiscon.com/show_bug.cgi?id=218",
    "type_of_change": "Modification",
    "filename_of_changes": "ruleset.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 176: \tCHKiRet(batchInit(&snglRuleBatch, pBatch->nElem));",
        "// Line_Reference 177: \tsnglRuleBatch.pbShutdownImmediate = pBatch->pbShutdownImmediate;",
        "// Line_Reference 178: ",
        "// Line_Reference 179: \twhile(1) { /* loop broken inside */",
        "// Line_Reference 183: ",
        "// Line_Reference 185: \t\t\tFINALIZE; /* everything processed */",
        "// Line_Reference 192: \t\t\t\tbatchCopyElem(&(snglRuleBatch.pElem[iNew++]), &(pBatch->pElem[i]));",
        "// Line_Reference 201: \t}",
        "// Line_Reference 202: \tbatchFree(&snglRuleBatch);"
    ]
}
