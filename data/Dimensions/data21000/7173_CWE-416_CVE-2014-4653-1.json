{
    "cve_id": "CVE-2014-4653",
    "cve_description": "sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 does not ensure possession of a read/write lock, which allows local users to cause a denial of service (use-after-free) and obtain sensitive information from kernel memory by leveraging /dev/snd/controlCX access.",
    "cve_publish_date": "2014-07-03",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "ALSA: control: Don't access controls outside of protected regions\n\nA control that is visible on the card->controls list can be freed at any time.\nThis means we must not access any of its memory while not holding the\ncontrols_rw_lock. Otherwise we risk a use after free access.\n\nSigned-off-by: Lars-Peter Clausen <lars@metafoo.de>\nAcked-by: Jaroslav Kysela <perex@perex.cz>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
    "type_of_change": "Modification",
    "filename_of_changes": "control.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 362: \tfor (idx = 0; idx < kcontrol->count; idx++, id.index++, id.numid++)",
        "// Line_Reference 427: \tfor (idx = 0; idx < kcontrol->count; idx++, id.index++, id.numid++)",
        "// Line_Reference 901: \t\t\tsnd_ctl_notify(card, SNDRV_CTL_EVENT_MASK_VALUE,",
        "// Line_Reference 902: \t\t\t\t       &control->id);",
        "// Line_Reference 1337: \t\t\tsnd_ctl_notify(card, SNDRV_CTL_EVENT_MASK_TLV, &kctl->id);"
    ]
}
