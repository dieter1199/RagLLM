{
    "cve_id": "CVE-2014-125061",
    "cve_description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in peel filebroker and classified as critical. Affected by this issue is the function select_transfer_status_desc of the file lib/common.rb. The manipulation leads to sql injection. The name of the patch is 91097e26a6c84d3208a351afaa52e0f62e5853ef. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217616. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "cve_publish_date": "2023-01-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "filter out transferred + sql injection fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "common.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 506:     @db.exec(\"INSERT into fb_file_status (transfer_id, filename, status_id, status_time) VALUES (#{transfer_id}, '#{file}', #{status_id}, '#{status_time}')\")",
        "// Line_Reference 510:     if @db.exec(\"SELECT * FROM fb_file_status WHERE transfer_id=#{transfer_id} AND filename='#{file}'\").count > 0",
        "// Line_Reference 511:       @db.exec(\"UPDATE fb_file_status SET status_id=#{status_id}, status_time='#{status_time}' WHERE transfer_id=#{transfer_id} AND filename='#{file}'\")",
        "// Line_Reference 748:       fb_file_status.transfer_id = #{transfer_id}",
        "// Line_Reference 750:     @db.exec(sql)"
    ]
}
