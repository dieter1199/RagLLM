{
    "cve_id": "CVE-2019-25105",
    "cve_description": "A vulnerability, which was classified as problematic, was found in dro.pm. This affects an unknown part of the file web/fileman.php. The manipulation of the argument secret/key leads to cross site scripting. It is possible to initiate the attack remotely. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The patch is named fa73c3a42bc5c246a1b8f815699ea241aef154bb. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-221763.",
    "cve_publish_date": "2023-02-26",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix reflected XSS in fileman.php (self discovered, no signs of exploitation... not that there would be much to exploit, given that there are no cookies or localstorage (i.e. there is no state you could get at))",
    "type_of_change": "Modification",
    "filename_of_changes": "fileman.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 20: \t\t\t$retval = \"$secret dro.pm/$key\";",
        "// Line_Reference 27: \t\t$secret = $db->escape_string($_GET['secret']);",
        "// Line_Reference 28: ",
        "// Line_Reference 29: \t\t$key = $db->query('SELECT `key` FROM `shorts` WHERE `secret` = \"' . $secret . '\"') or die('Database error 3984');",
        "// Line_Reference 31: \t\t\tdie(\"?secret=$secret not found\");",
        "// Line_Reference 41: \t$data = array('original_filename' => $_FILES['f']['name'], 'filename' => $key);",
        "// Line_Reference 43: \t$db->query('UPDATE `shorts` SET `expires` = ' . (time() + (12*3600)) . ', `type` = 2, `value` = \"' . $data . '\", expireAfterDownload = ' . $expireAfterDownload . ' WHERE `secret` = \"' . $secret . '\"') or die('Database error 29348');"
    ]
}
