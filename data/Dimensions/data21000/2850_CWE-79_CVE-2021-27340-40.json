{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "AddressInc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 2066:                 echo '<SCRIPT language=javascript>document.getElementById(\\'divvalues_portal_1\\').innerHTML=\"<input type=\\'checkbox\\' checked name=\\'primary_portal\\' value=\\'Y\\' id=\\'portal_1\\' onclick=\\'portal_toggle(1);\\' width=\\'25\\'>\"; document.getElementById(\"portal_div_1\").style.display = \"block\";</script>';",
        "// Line_Reference 2338:                     . 'var portal=document.getElementById(\\'portal_1\\'); if(portal!=null) { document.getElementById(\\'portal_1\\').checked= true; document.getElementById(\"portal_div_1\").style.display=\"block\"; document.getElementById(\\'values[people][PRIMARY][USER_NAME]\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';'",
        "// Line_Reference 2348:                     echo '<SCRIPT language=javascript>document.getElementById(\\'values[people][PRIMARY][FIRST_NAME]\\').value=\\'' . $people_info['FIRST_NAME'] . '\\';document.getElementById(\\'values[people][PRIMARY][RELATIONSHIP]\\').value=\\'' . $key . '\\';document.getElementById(\\'values[people][PRIMARY][LAST_NAME]\\').value=\\'' . $people_info['LAST_NAME'] . '\\';document.getElementById(\\'values[people][PRIMARY][HOME_PHONE]\\').value=\\'' . $people_info['HOME_PHONE'] . '\\';document.getElementById(\\'values[people][PRIMARY][WORK_PHONE]\\').value=\\'' . $people_info['WORK_PHONE'] . '\\';document.getElementById(\\'hidden_primary\\').value=\\'' . $sel_staff . '\\';document.getElementById(\\'values[people][PRIMARY][CELL_PHONE]\\').value=\\'' . $people_info['CELL_PHONE'] . '\\';document.getElementById(\\'values[people][PRIMARY][EMAIL]\\').value=\\'' . $people_info['EMAIL'] . '\\';document.getElementById(\\'portal_1\\').checked= false;document.getElementById(\\'values[people][PRIMARY][USER_NAME]\\').value=\\'\\';document.getElementById(\\'values[people][PRIMARY][PASSWORD]\\').value=\\'\\';document.getElementById(\\'portal_div_1\\').style.display=\\'none\\';</script>';",
        "// Line_Reference 2379:                     . 'var portal = document.getElementById(\\'portal_1\\'); if(portal!=null) { document.getElementById(\\'portal_1\\').checked= false;'",
        "// Line_Reference 2383:                     var pwd1=document.getElementById(\\'pwd1\\'); if(pwd1!=null) pwd1.innerHTML=\\'<INPUT class=form-control type=password name=values[people][PRIMARY][PASSWORD] id=values[people][PRIMARY][PASSWORD] class=cell_medium onkeyup=\"passwordStrengthMod(this.value,1);\" onblur=\"validate_password_mod(this.value,1);\"  /><span id=\"passwordStrength1\"></span> \\';document.getElementById(\\'portal_div_1\\').style.display= _none;} </script>';",
        "// Line_Reference 2544:                     echo '<SCRIPT language=javascript>document.getElementById(\\'values[people][SECONDARY][FIRST_NAME]\\').value=\\'' . $people_info['FIRST_NAME'] . '\\';document.getElementById(\\'values[people][SECONDARY][RELATIONSHIP]\\').value=\\'' . $key . '\\';document.getElementById(\\'values[people][SECONDARY][LAST_NAME]\\').value=\\'' . $people_info['LAST_NAME'] . '\\';document.getElementById(\\'values[people][SECONDARY][HOME_PHONE]\\').value=\\'' . $people_info['HOME_PHONE'] . '\\';document.getElementById(\\'hidden_secondary\\').value=\\'' . $sel_staff . '\\';document.getElementById(\\'values[people][SECONDARY][WORK_PHONE]\\').value=\\'' . $people_info['WORK_PHONE'] . '\\';document.getElementById(\\'values[people][SECONDARY][CELL_PHONE]\\').value=\\'' . $people_info['CELL_PHONE'] . '\\';document.getElementById(\\'values[people][SECONDARY][EMAIL]\\').value=\\'' . $people_info['EMAIL'] . '\\';document.getElementById(\\'portal_div_2\\').style.display=\\'block\\';document.getElementById(\\'portal_2\\').checked= true;document.getElementById(\\'values[people][SECONDARY][USER_NAME]\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';var pwd=document.getElementById(\\'values[people][SECONDARY][PASSWORD]\\'); var pwd2= pwd.cloneNode(false);pwd2.type=\\'password\\';pwd.parentNode.replaceChild(pwd2,pwd);document.getElementById(\\'values[people][SECONDARY][PASSWORD]\\').value=\\'' . $people_loginfo['PASSWORD'] . '\\';document.getElementById(\\'sec_prof_id\\').value=\\'' . $people_loginfo['PROFILE_ID'] . '\\';</script>';",
        "// Line_Reference 2572:                     . 'var portal=document.getElementById(\\'portal_2\\'); if(portal!=null) { document.getElementById(\\'portal_2\\').checked= true;document.getElementById(\\'values[people][SECONDARY][USER_NAME]\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';'",
        "// Line_Reference 2582:                     echo '<SCRIPT language=javascript>document.getElementById(\\'values[people][SECONDARY][FIRST_NAME]\\').value=\\'' . $people_info['FIRST_NAME'] . '\\';document.getElementById(\\'values[people][SECONDARY][RELATIONSHIP]\\').value=\\'' . $key . '\\';document.getElementById(\\'values[people][SECONDARY][LAST_NAME]\\').value=\\'' . $people_info['LAST_NAME'] . '\\';document.getElementById(\\'values[people][SECONDARY][HOME_PHONE]\\').value=\\'' . $people_info['HOME_PHONE'] . '\\';document.getElementById(\\'hidden_secondary\\').value=\\'' . $sel_staff . '\\';document.getElementById(\\'values[people][SECONDARY][WORK_PHONE]\\').value=\\'' . $people_info['WORK_PHONE'] . '\\';document.getElementById(\\'values[people][SECONDARY][CELL_PHONE]\\').value=\\'' . $people_info['CELL_PHONE'] . '\\';document.getElementById(\\'values[people][SECONDARY][EMAIL]\\').value=\\'' . $people_info['EMAIL'] . '\\';document.getElementById(\\'portal_div_2\\').style.display=\\'none\\';document.getElementById(\\'portal_2\\').checked= false;document.getElementById(\\'values[people][SECONDARY][USER_NAME]\\').value=\\'\\';document.getElementById(\\'values[people][SECONDARY][PASSWORD]\\').value=\\'\\';</script>';",
        "// Line_Reference 2609:                     . 'var portal=document.getElementById(\\'portal_2\\'); if(portal!=null) { document.getElementById(\\'portal_2\\').checked= false;'",
        "// Line_Reference 2622:                     echo '<SCRIPT language=javascript>document.getElementById(\\'values[people][OTHER][FIRST_NAME]\\').value=\\'' . $people_info['FIRST_NAME'] . '\\';document.getElementById(\\'values[people][OTHER][RELATIONSHIP]\\').value=\\'' . $key . '\\';document.getElementById(\\'values[people][OTHER][LAST_NAME]\\').value=\\'' . $people_info['LAST_NAME'] . '\\';document.getElementById(\\'values[people][OTHER][HOME_PHONE]\\').value=\\'' . $people_info['HOME_PHONE'] . '\\';document.getElementById(\\'values[people][OTHER][WORK_PHONE]\\').value=\\'' . $people_info['WORK_PHONE'] . '\\';document.getElementById(\\'hidden_other\\').value=\\'' . $sel_staff . '\\';document.getElementById(\\'values[people][OTHER][CELL_PHONE]\\').value=\\'' . $people_info['CELL_PHONE'] . '\\';document.getElementById(\\'values[people][OTHER][EMAIL]\\').value=\\'' . $people_info['EMAIL'] . '\\';document.getElementById(\\'portal_div_2\\').style.display=\\'block\\';document.getElementById(\\'portal_2\\').checked= true;document.getElementById(\\'values[people][OTHER][USER_NAME]\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';var pwd=document.getElementById(\\'values[people][OTHER][PASSWORD]\\'); var pwd2= pwd.cloneNode(false);pwd2.type=\\'password\\';pwd.parentNode.replaceChild(pwd2,pwd);document.getElementById(\\'values[people][OTHER][PASSWORD]\\').value=\\'' . $people_loginfo['PASSWORD'] . '\\';document.getElementById(\\'oth_prof_id\\').value=\\'' . $people_loginfo['PROFILE_ID'] . '\\';document.getElementById(\\'addn_hideShow\\').style.display =\\'block\\';document.getElementById(\\'ron\\').checked= true;document.getElementById(\\'values[student_address][OTHER][STREET_ADDRESS_1]\\').value=\\'' . $people_address['STREET_ADDRESS_1'] . '\\';document.getElementById(\\'values[student_address][OTHER][STREET_ADDRESS_2]\\').value=\\'' . $people_address['STREET_ADDRESS_2'] . '\\';document.getElementById(\\'values[student_address][OTHER][CITY]\\').value=\\'' . $people_address['CITY'] . '\\';document.getElementById(\\'values[student_address][OTHER][STATE]\\').value=\\'' . $people_address['STATE'] . '\\';document.getElementById(\\'values[student_address][OTHER][ZIPCODE]\\').value=\\'' . $people_address['ZIPCODE'] . '\\';' . ($people_address['BUS_PICKUP'] == 'Y' ? 'document.getElementById(\\'values[student_address][OTHER][BUS_PICKUP]\\').checked= true;' : '') . ($people_address['BUS_DROPOFF'] == 'Y' ? 'document.getElementById(\\'values[student_address][OTHER][BUS_DROPOFF]\\').checked= true;' : '') . 'document.getElementById(\\'oth_busno\\').value=\\'' . $people_address['BUS_NO'] . '\\';document.getElementById(\\'portal_2\\').checked= true;document.getElementById(\\'portal_div_2\\').style.display=\\'block\\';document.getElementById(\\'other_username\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';document.getElementById(\\'other_password\\').value=\\'' . $people_loginfo['PASSWORD'] . '\\';document.getElementById(\\'oth_prof_id\\').value=\\'' . $people_loginfo['PROFILE_ID'] . '\\';window.close();</script>';",
        "// Line_Reference 2643:                     . 'var portal=document.getElementById(\\'portal_2\\'); if(portal!=null) { document.getElementById(\\'portal_2\\').checked= true;document.getElementById(\\'values[people][OTHER][USER_NAME]\\').value=\\'' . $people_loginfo['USERNAME'] . '\\';'",
        "// Line_Reference 2677:                     . 'var portal=document.getElementById(\\'portal_2\\'); if(portal!=null) { document.getElementById(\\'portal_2\\').checked= false;'"
    ]
}
