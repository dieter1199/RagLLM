{
    "cve_id": "CVE-2023-0046",
    "cve_description": "Improper Restriction of Names for Files and Other Resources in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-04",
    "cwe_id": "CWE-641",
    "cwe_name": "Improper Restriction of Names for Files and Other Resources",
    "cwe_description": "The product constructs the name of a file or other resource using input from an upstream component, but it does not restrict or incorrectly restricts the resulting name.",
    "commit_message": "Better validating log filepath (#326)",
    "type_of_change": "Modification",
    "filename_of_changes": "config-logging.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "120",
    "number_of_lines_deleted_vulnerable_to_cve": "56",
    "vulnerable_lines": [
        "// Line_Reference 29: ",
        "// Line_Reference 40:     // if the form has been submitted we validate and store the configuration",
        "// Line_Reference 41:     if (array_key_exists('submit', $_POST) && isset($_POST['submit'])) {",
        "// Line_Reference 42: ",
        "// Line_Reference 43:         foreach ($param_label as $param => $label) {",
        "// Line_Reference 44:             if (array_key_exists($param, $_POST) && isset($_POST[$param]) &&",
        "// Line_Reference 45:                 in_array(strtolower($_POST[$param]), array(\"yes\", \"no\"))) {",
        "// Line_Reference 46:                 $configValues[$param] = $_POST[$param];",
        "// Line_Reference 49: ",
        "// Line_Reference 50:         if (array_key_exists('CONFIG_LOG_FILE', $_POST) && isset($_POST['CONFIG_LOG_FILE']) &&",
        "// Line_Reference 51:             is_writable($_POST['CONFIG_LOG_FILE'])) {",
        "// Line_Reference 52:             $configValues['CONFIG_LOG_FILE'] = $_POST['CONFIG_LOG_FILE'];",
        "// Line_Reference 53:         }",
        "// Line_Reference 54: ",
        "// Line_Reference 55:         include(\"library/config_write.php\");",
        "// Line_Reference 56:     }",
        "// Line_Reference 57: ",
        "// Line_Reference 58:     include(\"library/layout.php\");",
        "// Line_Reference 72: ",
        "// Line_Reference 73: ?>",
        "// Line_Reference 74: ",
        "// Line_Reference 75: <form name=\"loggingsettings\" method=\"POST\">",
        "// Line_Reference 76:     <fieldset>",
        "// Line_Reference 77:         <h302><?= t('title','Settings'); ?></h302>",
        "// Line_Reference 78:         <br>",
        "// Line_Reference 79: ",
        "// Line_Reference 80:         <ul>",
        "// Line_Reference 81: <?php",
        "// Line_Reference 83:         print_select_as_list_elem($name, $label, array(\"no\", \"yes\"), $configValues[$name]);",
        "// Line_Reference 85: ?>",
        "// Line_Reference 86: ",
        "// Line_Reference 87:             <li class=\"fieldset\">",
        "// Line_Reference 88:                 <label for=\"CONFIG_LOG_FILE\" class=\"form\"><?= t('all','FilenameLogging') ?></label>",
        "// Line_Reference 89:                 <input value=\"<?= $configValues['CONFIG_LOG_FILE'] ?>\" name=\"CONFIG_LOG_FILE\" id=\"CONFIG_LOG_FILE\">",
        "// Line_Reference 90:             </li>",
        "// Line_Reference 91: ",
        "// Line_Reference 92: ",
        "// Line_Reference 93:             <li class=\"fieldset\">",
        "// Line_Reference 94:                 <br/><hr><br/>",
        "// Line_Reference 95:                 <input type=\"submit\" name=\"submit\" value=\"<?= t('buttons','apply') ?>\" class=\"button\">",
        "// Line_Reference 96:             </li>",
        "// Line_Reference 97:         </ul>",
        "// Line_Reference 98:     </fieldset>",
        "// Line_Reference 99: </form>",
        "// Line_Reference 100: ",
        "// Line_Reference 101:         </div><!-- #contentnorightbar -->",
        "// Line_Reference 102: ",
        "// Line_Reference 103:         <div id=\"footer\">",
        "// Line_Reference 104: <?php",
        "// Line_Reference 106:     include('page-footer.php');",
        "// Line_Reference 107: ?>",
        "// Line_Reference 108:         </div><!-- #footer -->",
        "// Line_Reference 109:     </div>",
        "// Line_Reference 110: </div>",
        "// Line_Reference 112: </body>",
        "// Line_Reference 113: </html>"
    ]
}
