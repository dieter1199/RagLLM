{
    "cve_id": "CVE-2013-7137",
    "cve_description": "The \"remember me\" functionality in login.php in Burden before 1.8.1 allows remote attackers to bypass authentication and gain privileges by setting the burden_user_rememberme cookie to 1.",
    "cve_publish_date": "2014-01-26",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "Remove remember me until i can think of a better solution. Closes #2",
    "type_of_change": "Modification",
    "filename_of_changes": "login.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 20: ",
        "// Line_Reference 21: //If cookie is set, skip login",
        "// Line_Reference 22: if (isset($_COOKIE[\"burden_user_rememberme\"])) {",
        "// Line_Reference 23:     $id = $_COOKIE[\"burden_user_rememberme\"];",
        "// Line_Reference 24:     $getid = mysql_query(\"SELECT `id` FROM `Users` WHERE `id` = \\\"$id\\\"\");",
        "// Line_Reference 25:     if (mysql_num_rows($getid) == 0) {",
        "// Line_Reference 26:         header(\"Location: logout.php\");",
        "// Line_Reference 27:         exit;",
        "// Line_Reference 28:     }",
        "// Line_Reference 29:     $userinforesult = mysql_fetch_assoc($getid);",
        "// Line_Reference 30:     $_SESSION[\"burden_user\"] = $userinforesult[\"id\"];",
        "// Line_Reference 31: }",
        "// Line_Reference 126: <div class=\"control-group\">",
        "// Line_Reference 127: <div class=\"controls\">",
        "// Line_Reference 128: <label class=\"checkbox\">",
        "// Line_Reference 129: <input type=\"checkbox\" id=\"rememberme\" name=\"rememberme\"> Remember Me",
        "// Line_Reference 130: </label>",
        "// Line_Reference 131: </div>",
        "// Line_Reference 132: </div>"
    ]
}
