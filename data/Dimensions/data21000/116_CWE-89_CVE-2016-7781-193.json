{
    "cve_id": "CVE-2016-7781",
    "cve_description": "SQL injection vulnerability in framework/modules/blog/controllers/blogController.php in Exponent CMS 2.3.9 and earlier allows remote attackers to execute arbitrary SQL commands via the author parameter.",
    "cve_publish_date": "2017-03-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "reportController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "89",
    "number_of_lines_deleted_vulnerable_to_cve": "84",
    "vulnerable_lines": [
        "// Line_Reference 25:     protected $add_permissions = array(",
        "// Line_Reference 26:         'build_report' => 'Manage',",
        "// Line_Reference 29:         'order_report' => 'Generate Order Report',",
        "// Line_Reference 30:         'product_report' => 'Generate Product Report',",
        "// Line_Reference 34:         'batch_export' => 'Export Products',",
        "// Line_Reference 36:         'export_order_items' => 'Export Order Items File');",
        "// Line_Reference 342:             [date-startdate] =>",
        "// Line_Reference 343:             [time-h-startdate] =>",
        "// Line_Reference 344:             [time-m-startdate] =>",
        "// Line_Reference 346:             [date-enddate] =>",
        "// Line_Reference 347:             [time-h-enddate] =>",
        "// Line_Reference 348:             [time-m-enddate] =>",
        "// Line_Reference 364:             [order-range-num] =>",
        "// Line_Reference 366:             [order-price-num] =>",
        "// Line_Reference 367:             [pnam] =>",
        "// Line_Reference 368:             [sku] =>",
        "// Line_Reference 374:             [blshpname] =>",
        "// Line_Reference 375:             [email] =>",
        "// Line_Reference 377:             [zip] =>",
        "// Line_Reference 396:         //$items = $prod->find('all', 1, 'id DESC',25);",
        "// Line_Reference 397:         //$items = $order->find('all', 1, 'id DESC',25);",
        "// Line_Reference 461:         $geos = $geo->find('all');",
        "// Line_Reference 476:         //eDebug(strftime(\"%A, %d %B %Y\", mktime(0,0,0,(strftime(\"%m\")-1),1,strftime(\"%Y\"))));",
        "// Line_Reference 504:         //build",
        "// Line_Reference 688:             //get each calculator's id",
        "// Line_Reference 713:             [date-startdate] =>",
        "// Line_Reference 714:             [time-h-startdate] =>",
        "// Line_Reference 715:             [time-m-startdate] =>",
        "// Line_Reference 717:             [date-enddate] =>",
        "// Line_Reference 718:             [time-h-enddate] =>",
        "// Line_Reference 719:             [time-m-enddate] =>",
        "// Line_Reference 735:             [order-range-num] =>",
        "// Line_Reference 737:             [order-price-num] =>",
        "// Line_Reference 738:             [pnam] =>",
        "// Line_Reference 739:             [sku] =>",
        "// Line_Reference 745:             [blshpname] =>",
        "// Line_Reference 746:             [email] =>",
        "// Line_Reference 748:             [zip] =>",
        "// Line_Reference 775:         //$items = $prod->find('all', 1, 'id DESC',25);",
        "// Line_Reference 776:         //$items = $order->find('all', 1, 'id DESC',25);",
        "// Line_Reference 779:         //eDebug($sql . $sqlwhere);",
        "// Line_Reference 806:         //strftime(\"%a %d-%m-%Y\", get_first_day(3, 1, 2007)); Thursday, 1 April 2010",
        "// Line_Reference 947:             //$line = expString::outputField(\"SMC Inventory - Laurie\");",
        "// Line_Reference 1163:         //$items = $product->find('all', '', 'id', 25);",
        "// Line_Reference 1164:         //$page = new expPaginator();",
        "// Line_Reference 1165:         //eDebug($page,true);",
        "// Line_Reference 1200:                 'Invoice #'=>'invoice_id',",
        "// Line_Reference 1214:         //",
        "// Line_Reference 1215:         //",
        "// Line_Reference 1216:         // assign_to_template(array('page'=>$page));",
        "// Line_Reference 1223:         //echo \"1<br>\"; eDebug($str);",
        "// Line_Reference 1271:             //if HTML, then leave the single quotes alone, otheriwse replace w/ special Char",
        "// Line_Reference 1306:         //$str = str_replace(\",\",\"\\,\",$str);",
        "// Line_Reference 1542:             * description",
        "// Line_Reference 1543:             * id - SKU",
        "// Line_Reference 1544:             * link",
        "// Line_Reference 1545:             * price",
        "// Line_Reference 1546:             * title",
        "// Line_Reference 1547:             * brand - manufacturer",
        "// Line_Reference 1548:             * image link - fullsized image, up to 10, comma seperated",
        "// Line_Reference 1549:             * product type - category - \"Electronics > Audio > Audio Accessories MP3 Player Accessories\",\"Health & Beauty > Healthcare > Biometric Monitors > Pedometers\"",
        "// Line_Reference 1733:         $allOrderCount = $this->o->find('count','created_at >= ' . $this->tstart . ' AND created_at <= ' . $this->tend,null,null,null,true,false,$except,true);",
        "// Line_Reference 1738: ",
        "// Line_Reference 1741: ",
        "// Line_Reference 1747: ",
        "// Line_Reference 1748:         $ordersInCheckout = $this->o->find('count','created_at >= ' . $this->tstart . ' AND created_at <= ' . $this->tend . \" AND user_id != 0\",null,null,null,true,false,$except,true);",
        "// Line_Reference 1749: ",
        "// Line_Reference 1750:         //$ordersPurchased = $this->o->find('count','purchased >= ' . $this->tstart . ' AND purchased <= ' . $this->tend . \" AND user_id != 0 AND order_type_id = 1\",null,null,null,true,false,$except,true);",
        "// Line_Reference 1751:         //$ordersPurchased = $this->o->find('count','purchased >= ' . $this->tstart . ' AND purchased <= ' . $this->tend . \" AND user_id != 0\",null,null,null,true,false,$except,true);",
        "// Line_Reference 1752:         $ordersPurchased = $this->o->find('count','purchased >= ' . $this->tstart . ' AND purchased <= ' . $this->tend,null,null,null,true,false,$except,true);",
        "// Line_Reference 1753:         $orders = $this->o->find('all','purchased >= ' . $this->tstart . ' AND purchased <= ' . $this->tend,null,null,null,true,false,$except,true);",
        "// Line_Reference 1754: ",
        "// Line_Reference 1755:         eDebug(\"All:\" . $allOrderCount);",
        "// Line_Reference 1756:         eDebug(\"Carts w/ Items:\" . $allCartsWithItems);",
        "// Line_Reference 1757:         eDebug(\"Carts w/ Items in Checkout:\" . $ordersInCheckout);",
        "// Line_Reference 1758:         eDebug(\"Purchased:\" . $ordersPurchased);",
        "// Line_Reference 1759: ",
        "// Line_Reference 1764: ",
        "// Line_Reference 1765: ",
        "// Line_Reference 1766: ",
        "// Line_Reference 1767: ",
        "// Line_Reference 1771:         assign_to_template(array('prev_month'=>$this->prev_month, 'now_date'=>$this->now_date, 'now_hour'=>$this->now_hour, 'now_min'=>$this->now_min, 'now_ampm'=>$this->now_ampm, 'prev_hour'=>$this->prev_hour, 'prev_min'=>$this->prev_min, 'prev_ampm'=>$this->prev_ampm));",
        "// Line_Reference 1888:         /*OPTIONALLY ENCLOSED BY '\" . '\"' .",
        "// Line_Reference 2019:         /*OPTIONALLY ENCLOSED BY '\" . '\"' ."
    ]
}
