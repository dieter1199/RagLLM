{
    "cve_id": "CVE-2017-15195",
    "cve_description": "In Kanboard before 1.0.47, by altering form data, an authenticated user can edit swimlanes of a private project of another user.",
    "cve_publish_date": "2017-10-11",
    "cwe_id": "CWE-639",
    "cwe_name": "Authorization Bypass Through User-Controlled Key",
    "cwe_description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
    "commit_message": "Do not expose IDs in forms",
    "type_of_change": "Modification",
    "filename_of_changes": "CommentController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 16:     /**",
        "// Line_Reference 17:      * Get the current comment",
        "// Line_Reference 18:      *",
        "// Line_Reference 19:      * @access protected",
        "// Line_Reference 20:      * @return array",
        "// Line_Reference 21:      * @throws PageNotFoundException",
        "// Line_Reference 22:      * @throws AccessForbiddenException",
        "// Line_Reference 23:      */",
        "// Line_Reference 24:     protected function getComment()",
        "// Line_Reference 25:     {",
        "// Line_Reference 26:         $comment = $this->commentModel->getById($this->request->getIntegerParam('comment_id'));",
        "// Line_Reference 27: ",
        "// Line_Reference 28:         if (empty($comment)) {",
        "// Line_Reference 29:             throw new PageNotFoundException();",
        "// Line_Reference 30:         }",
        "// Line_Reference 31: ",
        "// Line_Reference 32:         if (! $this->userSession->isAdmin() && $comment['user_id'] != $this->userSession->getId()) {",
        "// Line_Reference 33:             throw new AccessForbiddenException();",
        "// Line_Reference 34:         }",
        "// Line_Reference 35: ",
        "// Line_Reference 36:         return $comment;",
        "// Line_Reference 37:     }",
        "// Line_Reference 38: ",
        "// Line_Reference 52: ",
        "// Line_Reference 53:         if (empty($values)) {",
        "// Line_Reference 54:             $values = array(",
        "// Line_Reference 55:                 'user_id' => $this->userSession->getId(),",
        "// Line_Reference 56:                 'task_id' => $task['id'],",
        "// Line_Reference 57:             );",
        "// Line_Reference 58:         }",
        "// Line_Reference 59: ",
        "// Line_Reference 109:         $comment = $this->getComment();",
        "// Line_Reference 133:         $this->getComment();",
        "// Line_Reference 160:         $comment = $this->getComment();",
        "// Line_Reference 178:         $comment = $this->getComment();"
    ]
}
