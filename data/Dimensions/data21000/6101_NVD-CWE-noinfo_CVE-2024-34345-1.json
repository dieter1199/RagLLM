{
    "cve_id": "CVE-2024-34345",
    "cve_description": "The CycloneDX JavaScript library contains the core functionality of OWASP CycloneDX for JavaScript. In 6.7.0, XML External entity injections were possible, when running the provided XML Validator on arbitrary input. This issue was fixed in version 6.7.1.",
    "cve_publish_date": "2024-05-14",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: revert to v6.6.1\n\nSigned-off-by: Jan Kowalleck <jan.kowalleck@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "Validation.XmlValidator.test.js",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "54",
    "vulnerable_lines": [
        "// Line_Reference 102: ",
        "// Line_Reference 103:     it('is not vulnerable to advisories/GHSA-mjr4-7xg5-pfvh', async () => {",
        "// Line_Reference 104:       /* report:",
        "// Line_Reference 105:       see https://github.com/advisories/GHSA-mjr4-7xg5-pfvh",
        "// Line_Reference 106:       see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061",
        "// Line_Reference 107:       */",
        "// Line_Reference 108:       const validator = new XmlValidator(version)",
        "// Line_Reference 109:       /* POC payload:",
        "// Line_Reference 110:       see https://research.jfrog.com/vulnerabilities/libxmljs2-attrs-type-confusion-rce-jfsa-2024-001034097/#poc",
        "// Line_Reference 111:        */",
        "// Line_Reference 112:       const input = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>",
        "// Line_Reference 113:         <!DOCTYPE note",
        "// Line_Reference 114:         [",
        "// Line_Reference 115:         <!ENTITY writer \"` + 'A'.repeat(0x1234) + `\">",
        "// Line_Reference 116:         ]>",
        "// Line_Reference 117:         <bom xmlns=\"http://cyclonedx.org/schema/bom/${version}\">",
        "// Line_Reference 118:           <components>",
        "// Line_Reference 119:             <component type=\"library\">",
        "// Line_Reference 120:               <name>&writer;</name><!-- << XML external entity (XXE) injection -->",
        "// Line_Reference 121:               <version>1.337</version>",
        "// Line_Reference 122:               ${version === '1.0' ? '<modified>false</modified>' : ''}",
        "// Line_Reference 123:             </component>",
        "// Line_Reference 124:           </components>",
        "// Line_Reference 125:         </bom>`",
        "// Line_Reference 126:       const validationError = await validator.validate(input)",
        "// Line_Reference 127:       assert.strictEqual(validationError, null)",
        "// Line_Reference 128:     })",
        "// Line_Reference 129: ",
        "// Line_Reference 130:     it('is not vulnerable to advisories/GHSA-78h3-pg4x-j8cv', async () => {",
        "// Line_Reference 131:       /* report:",
        "// Line_Reference 132:       see https://github.com/advisories/GHSA-78h3-pg4x-j8cv",
        "// Line_Reference 133:       see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061",
        "// Line_Reference 134:       */",
        "// Line_Reference 135:       const validator = new XmlValidator(version)",
        "// Line_Reference 136:       /* POC payload:",
        "// Line_Reference 137:       see https://research.jfrog.com/vulnerabilities/libxmljs2-namespaces-type-confusion-rce-jfsa-2024-001034098/#poc",
        "// Line_Reference 138:       */",
        "// Line_Reference 139:       const input = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>",
        "// Line_Reference 140:         <!DOCTYPE note",
        "// Line_Reference 141:         [",
        "// Line_Reference 142:         <!ENTITY writer PUBLIC \"` + 'A'.repeat(8) + 'B'.repeat(8) + 'C'.repeat(8) + 'D'.repeat(8) + 'P'.repeat(8) + `\" \"JFrog Security\">",
        "// Line_Reference 143:         ]>",
        "// Line_Reference 144:         <bom xmlns=\"http://cyclonedx.org/schema/bom/${version}\">",
        "// Line_Reference 145:           <components>",
        "// Line_Reference 146:             <component type=\"library\">",
        "// Line_Reference 147:               <name>&writer;</name><!-- << XML external entity (XXE) injection -->",
        "// Line_Reference 148:               <version>1.337</version>",
        "// Line_Reference 149:               ${version === '1.0' ? '<modified>false</modified>' : ''}",
        "// Line_Reference 150:             </component>",
        "// Line_Reference 151:           </components>",
        "// Line_Reference 152:         </bom>`",
        "// Line_Reference 153:       const validationError = await validator.validate(input)",
        "// Line_Reference 154:       assert.strictEqual(validationError, null)",
        "// Line_Reference 155:     })"
    ]
}
