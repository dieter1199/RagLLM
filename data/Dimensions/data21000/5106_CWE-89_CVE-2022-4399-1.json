{
    "cve_id": "CVE-2022-4399",
    "cve_description": "A vulnerability was found in TicklishHoneyBee nodau. It has been rated as critical. Affected by this issue is some unknown functionality of the file src/db.c. The manipulation of the argument value/name leads to sql injection. The name of the patch is 7a7d737a3929f335b9717ddbd31db91151b69ad2. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-215252.",
    "cve_publish_date": "2022-12-10",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Use parametetrized SQL statement\n\nMove to parametetrized SQL statement allows using chars like \"'\" in\nnotes and also avoid sql injection",
    "type_of_change": "Modification",
    "filename_of_changes": "db.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 288: \t\tr = asprintf(&sql, \"UPDATE nodau set text='%s' , encrypted='true' WHERE name='%s'\", value, name);",
        "// Line_Reference 289: \t\tfree(value);",
        "// Line_Reference 290: \t\tif (r < 0)",
        "// Line_Reference 293: \t\tif (asprintf(&sql, \"UPDATE nodau set text='%s' , encrypted='false' WHERE name='%s'\", value, name) < 0)",
        "// Line_Reference 298: \tr = sqlite3_exec(db_data.db, sql, NULL, 0, &db_data.error_msg);"
    ]
}
