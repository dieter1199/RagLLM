{
    "cve_id": "CVE-2014-3570",
    "cve_description": "The BN_sqr implementation in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k does not properly calculate the square of a BIGNUM value, which might make it easier for remote attackers to defeat cryptographic protection mechanisms via unspecified vectors, related to crypto/bn/asm/mips.pl, crypto/bn/asm/x86_64-gcc.c, and crypto/bn/bn_asm.c.",
    "cve_publish_date": "2015-01-09",
    "cwe_id": "CWE-310",
    "cwe_name": "Cryptographic Issues",
    "cwe_description": "Weaknesses in this category are related to the design and implementation of data confidentiality and integrity. Frequently these deal with the use of encoding techniques, encryption libraries, and hashing algorithms. The weaknesses in this category could lead to a degradation of the quality data if they are not addressed.",
    "commit_message": "Fix for CVE-2014-3570 (with minor bn_asm.c revamp).\n\nReviewed-by: Emilia Kasper <emilia@openssl.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "bntest.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "78",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 692: \tBIGNUM a,c,d,e;",
        "// Line_Reference 693: \tint i;",
        "// Line_Reference 695: \tBN_init(&a);",
        "// Line_Reference 696: \tBN_init(&c);",
        "// Line_Reference 697: \tBN_init(&d);",
        "// Line_Reference 698: \tBN_init(&e);",
        "// Line_Reference 702: \t\tBN_bntest_rand(&a,40+i*10,0,0);",
        "// Line_Reference 703: \t\ta.neg=rand_neg();",
        "// Line_Reference 704: \t\tBN_sqr(&c,&a,ctx);",
        "// Line_Reference 709: \t\t\t\tBN_print(bp,&a);",
        "// Line_Reference 711: \t\t\t\tBN_print(bp,&a);",
        "// Line_Reference 714: \t\t\tBN_print(bp,&c);",
        "// Line_Reference 717: \t\tBN_div(&d,&e,&c,&a,ctx);",
        "// Line_Reference 718: \t\tBN_sub(&d,&d,&a);",
        "// Line_Reference 719: \t\tif(!BN_is_zero(&d) || !BN_is_zero(&e))",
        "// Line_Reference 720: \t\t    {",
        "// Line_Reference 721: \t\t    fprintf(stderr,\"Square test failed!\\n\");",
        "// Line_Reference 722: \t\t    return 0;",
        "// Line_Reference 723: \t\t    }",
        "// Line_Reference 725: \tBN_free(&a);",
        "// Line_Reference 726: \tBN_free(&c);",
        "// Line_Reference 727: \tBN_free(&d);",
        "// Line_Reference 728: \tBN_free(&e);",
        "// Line_Reference 729: \treturn(1);"
    ]
}
