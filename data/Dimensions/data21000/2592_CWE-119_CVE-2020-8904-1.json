{
    "cve_id": "CVE-2020-8904",
    "cve_description": "An arbitrary memory overwrite vulnerability in the trusted memory of Asylo exists in versions prior to 0.6.0. As the ecall_restore function fails to validate the range of the output_len pointer, an attacker can manipulate the tmp_output_len value and write to an arbitrary location in the trusted (enclave) memory. We recommend updating Asylo to version 0.6.0 or later.",
    "cve_publish_date": "2020-08-12",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Check for output_len range in ecall_restore\n\nThis may cause vulnerablity if pointing to trusted memory.\n\nThis issue was reported by Qinkun Bao, Zhaofeng Chen, Mingshen Sun, and\nKang Li from Baidu Security.\n\nPiperOrigin-RevId: 322476223\nChange-Id: I8a6406e9f07a20582d4387bd9a3469dfa9cbcb12",
    "type_of_change": "Modification",
    "filename_of_changes": "ecalls.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 65:                                                               input_len)) {",
        "// Line_Reference 67:         \"ecall_restore: input found to not be in untrusted memory.\");"
    ]
}
