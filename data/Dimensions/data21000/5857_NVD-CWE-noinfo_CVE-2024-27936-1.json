{
    "cve_id": "CVE-2024-27936",
    "cve_description": "Deno is a JavaScript, TypeScript, and WebAssembly runtime with secure defaults. Starting in version 1.32.1 and prior to version 1.41.0 of the deno library, maliciously crafted permission request can show the spoofed permission prompt by inserting a broken ANSI escape sequence into the request contents. Deno is stripping any ANSI escape sequences from the permission prompt, but permissions given to the program are based on the contents that contain the ANSI escape sequences. Any Deno program can spoof the content of the interactive permission prompt by inserting a broken ANSI code, which allows a malicious Deno program to display the wrong file path or program name to the user. Version 1.41.0 of the deno library contains a patch for the issue.",
    "cve_publish_date": "2024-03-21",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "feat(core): highlight unprintable chars in permission prompts (#22468)\n\nIf we strip out unprintable chars, we don't see the full filename being\r\nrequested by permission prompts. Instead, we highlight and escape them\r\nto make them visible.",
    "type_of_change": "Modification",
    "filename_of_changes": "prompter.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 14: /// Helper function to strip ansi codes and ASCII control characters.",
        "// Line_Reference 15: fn strip_ansi_codes_and_ascii_control(s: &str) -> std::borrow::Cow<str> {",
        "// Line_Reference 16:   console_static_text::ansi::strip_ansi_codes(s)",
        "// Line_Reference 17:     .chars()",
        "// Line_Reference 18:     .filter(|c| !c.is_ascii_control())",
        "// Line_Reference 19:     .collect()",
        "// Line_Reference 252:     let message = strip_ansi_codes_and_ascii_control(message);",
        "// Line_Reference 253:     let name = strip_ansi_codes_and_ascii_control(name);",
        "// Line_Reference 254:     let api_name = api_name.map(strip_ansi_codes_and_ascii_control);"
    ]
}
