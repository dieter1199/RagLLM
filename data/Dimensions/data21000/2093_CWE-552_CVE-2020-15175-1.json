{
    "cve_id": "CVE-2020-15175",
    "cve_description": "In GLPI before version 9.5.2, the `?pluginimage.send.php?` endpoint allows a user to specify an image from a plugin. The parameters can be maliciously crafted to instead delete the .htaccess file for the files directory. Any user becomes able to read all the files and folders contained in “/files/”. Some of the sensitive information that is compromised are the user sessions, logs, and more. An attacker would be able to get the Administrators session token and use that to authenticate. The issue is patched in version 9.5.2.",
    "cve_publish_date": "2020-10-07",
    "cwe_id": "CWE-552",
    "cwe_name": "Files or Directories Accessible to External Parties",
    "cwe_description": "The product makes files or directories accessible to unauthorized actors, even though they should not be.",
    "commit_message": "Merge pull request from GHSA-rm52-jx9h-rwcp\n\n- Prevent removal of any plugin file from unauthenticated user\n- Prevent access to files outside plugins directories\n- Prevent access to files from inactive plugins\n- Limit access to images and fix content-type\n- Add changelog entry",
    "type_of_change": "Modification",
    "filename_of_changes": "pluginimage.send.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 46: if (!isset($_GET[\"name\"]) || !isset($_GET[\"plugin\"])) {",
        "// Line_Reference 54:     || (basename($_GET[\"plugin\"]) != $_GET[\"plugin\"])) {",
        "// Line_Reference 60: $Path = GLPI_PLUGIN_DOC_DIR.\"/\".$_GET[\"plugin\"].\"/\";",
        "// Line_Reference 67: header(\"Content-type: image/png\");",
        "// Line_Reference 69: if (file_exists($Path.$_GET[\"name\"])) {",
        "// Line_Reference 70:    readfile($Path.$_GET[\"name\"]);",
        "// Line_Reference 71:    if (isset($_GET[\"clean\"])) {",
        "// Line_Reference 72:       unlink($Path.$_GET[\"name\"]);",
        "// Line_Reference 73:    }"
    ]
}
