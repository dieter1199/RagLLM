{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "AnomalousGrades.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 32: echo \"<FORM action=Modules.php?modname=\".strip_tags(trim($_REQUEST[modname])).\" method=POST>\";",
        "// Line_Reference 33: DrawHeaderHome('<INPUT type=checkbox name=include_inactive value=Y'.($_REQUEST['include_inactive']=='Y'?\" CHECKED onclick='document.location.href=\\\"\".PreparePHP_SELF($tmp_REQUEST).\"&include_inactive=\\\";'\":\" onclick='document.location.href=\\\"\".PreparePHP_SELF($tmp_REQUEST).\"&include_inactive=Y\\\";'\").'>'._includeInactiveStudents.':');",
        "// Line_Reference 42: $extra['SELECT'] .= ',(SELECT POINTS FROM gradebook_grades WHERE STUDENT_ID=s.STUDENT_ID AND ASSIGNMENT_ID=ga.ASSIGNMENT_ID) AS POINTS';",
        "// Line_Reference 43: $extra['SELECT'] .= ',(SELECT COMMENT FROM gradebook_grades WHERE STUDENT_ID=s.STUDENT_ID AND ASSIGNMENT_ID=ga.ASSIGNMENT_ID) AS COMMENT';",
        "// Line_Reference 45: $extra['WHERE'] = 'AND ((SELECT POINTS FROM gradebook_grades WHERE STUDENT_ID=s.STUDENT_ID AND ASSIGNMENT_ID=ga.ASSIGNMENT_ID) IS NULL AND (ga.ASSIGNED_DATE IS NULL OR CURRENT_DATE>=ga.ASSIGNED_DATE) AND (ga.DUE_DATE IS NULL OR CURRENT_DATE>=ga.DUE_DATE) OR (SELECT POINTS FROM gradebook_grades WHERE STUDENT_ID=s.STUDENT_ID AND ASSIGNMENT_ID=ga.ASSIGNMENT_ID)<0 OR (SELECT POINTS FROM gradebook_grades WHERE STUDENT_ID=s.STUDENT_ID AND ASSIGNMENT_ID=ga.ASSIGNMENT_ID)>ga.POINTS*'.$max_allowed.') AND ((ga.COURSE_ID=\\''.$course_id.'\\' AND ga.STAFF_ID=\\''.User('STAFF_ID').'\\') OR ga.COURSE_PERIOD_ID=\\''.$course_period_id.'\\') AND (ga.MARKING_PERIOD_ID=\\''.UserMP().'\\' OR ga.MARKING_PERIOD_ID=\\''.$full_year_mp.'\\') AND ga.COURSE_PERIOD_ID=\\''.$course_period_id.'\\' AND gt.ASSIGNMENT_TYPE_ID=ga.ASSIGNMENT_TYPE_ID';",
        "// Line_Reference 65: \t\treturn '<FONT class=red>'._missing.'</FONT>';",
        "// Line_Reference 67: \t\treturn '<FONT color=#00a000>'._excused.'</FONT>';",
        "// Line_Reference 69: \t\treturn '<FONT class=red>'._negative.'!</FONT>';",
        "// Line_Reference 71: \t\treturn '<FONT color=#0000ff>'._extraCredit.'</FONT>';"
    ]
}
