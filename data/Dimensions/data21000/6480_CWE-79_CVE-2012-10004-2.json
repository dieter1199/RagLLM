{
    "cve_id": "CVE-2012-10004",
    "cve_description": "A vulnerability was found in backdrop-contrib Basic Cart on Drupal. It has been classified as problematic. Affected is the function basic_cart_checkout_form_submit of the file basic_cart.cart.inc. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.x-1.1.1 is able to address this issue. The patch is identified as a10424ccd4b3b4b433cf33b73c1ad608b11890b4. It is recommended to upgrade the affected component. VDB-217950 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-01-11",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "XSS issue, drupal mail instead of mail system",
    "type_of_change": "Modification",
    "filename_of_changes": "basic_cart.cart.inc",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "31",
    "vulnerable_lines": [
        "// Line_Reference 241:   $my_module = 'basic_cart';",
        "// Line_Reference 242:   $my_mail_token = 'checkout';",
        "// Line_Reference 243:   $from = variable_get('site_mail');",
        "// Line_Reference 244: ",
        "// Line_Reference 245:   $message = array(",
        "// Line_Reference 246:     'id' => $my_module . '_' . $my_mail_token,",
        "// Line_Reference 247:     'to' => $from,",
        "// Line_Reference 248:     'subject' => variable_get('basic_cart_admin_subject'),",
        "// Line_Reference 249:     'body' => $message_html,",
        "// Line_Reference 250:     'headers' => array(",
        "// Line_Reference 251:       'From' => $from,",
        "// Line_Reference 252:       'Sender' => $from,",
        "// Line_Reference 253:       'Return-Path' => $from,",
        "// Line_Reference 254:     ),",
        "// Line_Reference 255:   );",
        "// Line_Reference 256:   $system = drupal_mail_system($my_module, $my_mail_token);",
        "// Line_Reference 258:   if ($system->mail($message)) {",
        "// Line_Reference 267:     $message = array(",
        "// Line_Reference 268:       'id' => $my_module . '_' . $my_mail_token,",
        "// Line_Reference 269:       'to' => $form_state['values']['basic_cart_checkout_email'],",
        "// Line_Reference 270:       'subject' => variable_get('basic_cart_user_subject'),",
        "// Line_Reference 271:       'body' => $message_html,",
        "// Line_Reference 272:       'headers' => array(",
        "// Line_Reference 273:         'From' => $from,",
        "// Line_Reference 274:         'Sender' => $from,",
        "// Line_Reference 275:         'Return-Path' => $from,",
        "// Line_Reference 276:       ),",
        "// Line_Reference 277:     );",
        "// Line_Reference 278:     $system = drupal_mail_system($my_module, $my_mail_token);",
        "// Line_Reference 279:     if ($system->mail($message)) {",
        "// Line_Reference 300:   return nl2br($message);"
    ]
}
