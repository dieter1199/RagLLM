{
    "cve_id": "CVE-2022-0238",
    "cve_description": "phoronix-test-suite is vulnerable to Cross-Site Request Forgery (CSRF)",
    "cve_publish_date": "2022-01-16",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "phoromatic: Additional input sanitization / validation",
    "type_of_change": "Modification",
    "filename_of_changes": "phoromatic_systems.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 55: \t\tif(!PHOROMATIC_USER_IS_VIEWER && !empty($PATH[0]) && isset($_POST['maintenance_mode']))",
        "// Line_Reference 70: \t\tif(!PHOROMATIC_USER_IS_VIEWER && !empty($PATH[0]) && isset($_POST['tick_thread_reboot']))",
        "// Line_Reference 78: \t\tif(!PHOROMATIC_USER_IS_VIEWER && !empty($PATH[0]) && isset($_POST['tick_thread_halt']))",
        "// Line_Reference 202: \t\t\t\t\t$main .= '<p><form action=\"' . $_SERVER['REQUEST_URI'] . '\" name=\"update_groups\" method=\"post\"><input type=\"hidden\" name=\"maintenance_mode\" value=\"' . $mm_val . '\" /><input type=\"submit\" value=\"' . $mm_str . '\" onclick=\"' . $mm_onclick . '\" style=\"float: left; margin: 0 20px 5px 0;\" /></form> Putting the system into maintenance mode will power up the system (if supported and applicable) and cause the Phoronix Test Suite Phoromatic client to idle and block all testing until the mode has been disabled. If a test is already running on the system, the maintenance mode will not be entered until after the testing has completed. The maintenance mode can be used if wishing to update the system software or carry out other tasks without interfering with the Phoromatic client process. Once disabled, the Phoronix Test Suite will continue to function as normal.</p>';",
        "// Line_Reference 206: \t\t\t\t\t\t$main .= '<p><form action=\"' . $_SERVER['REQUEST_URI'] . '\" name=\"update_groups\" method=\"post\"><input type=\"hidden\" name=\"tick_thread_reboot\" value=\"1\" /><input type=\"submit\" value=\"Reboot System\" style=\"float: left; margin: 0 20px 5px 0;\" /></form> If the system is currently powered up and connected to the Phoromatic Server, this will send a message to the system to issue a reboot -- in case the system is hung on a test or you wish to otherwise manually reboot the server.</p>';",
        "// Line_Reference 208: \t\t\t\t\t\t$main .= '<p><form action=\"' . $_SERVER['REQUEST_URI'] . '\" name=\"update_groups\" method=\"post\"><input type=\"hidden\" name=\"tick_thread_halt\" value=\"1\" /><input type=\"submit\" value=\"Halt Testing\" style=\"float: left; margin: 0 20px 5px 0;\" /></form> If the system is currently powered up and running a test/benchmark via the Phoromatic Server, this will tell the system to halt the testing prematurely as soon as the currently-active test has finished. The results successfully ran will then be uploaded to the Phoromatic Server.</p>';"
    ]
}
