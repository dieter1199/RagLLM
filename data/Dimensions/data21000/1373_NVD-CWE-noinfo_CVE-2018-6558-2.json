{
    "cve_id": "CVE-2018-6558",
    "cve_description": "The pam_fscrypt module in fscrypt before 0.2.4 may incorrectly restore primary and supplementary group IDs to the values associated with the root user, which allows attackers to gain privileges via a successful login through certain applications that use Linux-PAM (aka pam).",
    "cve_publish_date": "2018-08-23",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Ensure keyring privilege changes are reversible\n\nThis change makes sure that, when we set the ruid and euid in order to\nget the user keyring linked into the current process keyring, we will\nalways be able to reverse these changes (using a suid of 0).\n\nThis fixes an issue where \"su <user>\" would result in a system error\nwhen called by an unprivileged user. It also explains exactly how and\nwhy we are making these privilege changes.",
    "type_of_change": "Modification",
    "filename_of_changes": "privileges.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 145: func setUids(ruid, euid int) error {",
        "// Line_Reference 146: \tres, err := C.setreuid(C.uid_t(ruid), C.uid_t(euid))",
        "// Line_Reference 147: \tlog.Printf(\"setreuid(%d, %d) = %d (errno %v)\", ruid, euid, res, err)",
        "// Line_Reference 148: \tif res == 0 {",
        "// Line_Reference 149: \t\treturn nil",
        "// Line_Reference 151: \treturn errors.Wrapf(err.(syscall.Errno), \"setting uids\")"
    ]
}
