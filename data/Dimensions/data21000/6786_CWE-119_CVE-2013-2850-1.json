{
    "cve_id": "CVE-2013-2850",
    "cve_description": "Heap-based buffer overflow in the iscsi_add_notunderstood_response function in drivers/target/iscsi/iscsi_target_parameters.c in the iSCSI target subsystem in the Linux kernel through 3.9.4 allows remote attackers to cause a denial of service (memory corruption and OOPS) or possibly execute arbitrary code via a long key that is not properly handled during construction of an error-response packet.",
    "cve_publish_date": "2013-06-07",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "iscsi-target: fix heap buffer overflow on error\n\nIf a key was larger than 64 bytes, as checked by iscsi_check_key(), the\nerror response packet, generated by iscsi_add_notunderstood_response(),\nwould still attempt to copy the entire key into the packet, overflowing\nthe structure on the heap.\n\nRemote preauthentication kernel memory corruption was possible if a\ntarget was configured and listening on the network.\n\nCVE-2013-2850\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: stable@vger.kernel.org\nSigned-off-by: Nicholas Bellinger <nab@linux-iscsi.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "iscsi_target_parameters.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 761: \tstrncpy(extra_response->key, key, strlen(key) + 1);",
        "// Line_Reference 762: \tstrncpy(extra_response->value, NOTUNDERSTOOD,",
        "// Line_Reference 763: \t\t\tstrlen(NOTUNDERSTOOD) + 1);",
        "// Line_Reference 1632: \t\t\t\tchar *tmpptr = key + strlen(key);",
        "// Line_Reference 1633: \t\t\t\t*tmpptr = '=';"
    ]
}
