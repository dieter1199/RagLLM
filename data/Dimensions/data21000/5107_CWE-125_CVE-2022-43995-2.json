{
    "cve_id": "CVE-2022-43995",
    "cve_description": "Sudo 1.8.0 through 1.9.12, with the crypt() password backend, contains a plugins/sudoers/auth/passwd.c array-out-of-bounds error that can result in a heap-based buffer over-read. This can be triggered by arbitrary local users with access to Sudo by entering a password of seven characters or fewer. The impact could vary depending on the system libraries, compiler, and processor architecture.",
    "cve_publish_date": "2022-11-02",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Fix CVE-2022-43995, potential heap overflow for passwords < 8 characters.\nStarting with sudo 1.8.0 the plaintext password buffer is dynamically\nsized so it is not safe to assume that it is at least 9 bytes in size.\nFound by Hugo Lefeuvre (University of Manchester) with ConfFuzz.",
    "type_of_change": "Modification",
    "filename_of_changes": "passwd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 66:     char sav, *epass;",
        "// Line_Reference 78:      * If this turns out not to be safe we will have to use OS #ifdef's (sigh).",
        "// Line_Reference 80:     sav = pass[8];",
        "// Line_Reference 82:     if (pw_len == DESLEN || HAS_AGEINFO(pw_epasswd, pw_len))",
        "// Line_Reference 83: \tpass[8] = '\\0';",
        "// Line_Reference 91:     pass[8] = sav;"
    ]
}
