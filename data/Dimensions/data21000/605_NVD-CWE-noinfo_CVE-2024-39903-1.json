{
    "cve_id": "CVE-2024-39903",
    "cve_description": "Solara is a pure Python, React-style framework for scaling Jupyter and web apps. A Local File Inclusion (LFI) vulnerability was identified in widgetti/solara, in version <1.35.1, which was fixed in version 1.35.1. This vulnerability arises from the application's failure to properly validate URI fragments for directory traversal sequences such as '../' when serving static files. An attacker can exploit this flaw by manipulating the fragment part of the URI to read arbitrary files on the local file system.",
    "cve_publish_date": "2024-07-12",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "fix: CVE followup, do not serve relative files\n\nWe still served files above the directory of intent.\nWe now test all endpoint, using both starlette and flask to\nmake sure this will not happen again.",
    "type_of_change": "Modification",
    "filename_of_changes": "cdn_helper.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 2: import os",
        "// Line_Reference 30:     # We use os.path.normpath() because we do not want to follow symlinks",
        "// Line_Reference 31:     # in editable installs, since some packages are symlinked",
        "// Line_Reference 32:     if not os.path.normpath(cache_path).startswith(os.path.normpath(base_cache_dir)):",
        "// Line_Reference 33:         logger.warning(",
        "// Line_Reference 34:             \"Trying to read from outside of cache directory: %s is not a subdir of %s (%s - %s)\",",
        "// Line_Reference 35:             cache_path,",
        "// Line_Reference 36:             base_cache_dir,",
        "// Line_Reference 37:             os.path.normpath(cache_path),",
        "// Line_Reference 38:             os.path.normpath(base_cache_dir),",
        "// Line_Reference 39:         )"
    ]
}
