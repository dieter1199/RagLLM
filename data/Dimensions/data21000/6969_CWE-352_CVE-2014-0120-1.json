{
    "cve_id": "CVE-2014-0120",
    "cve_description": "Cross-site request forgery (CSRF) vulnerability in the admin terminal in Hawt.io allows remote attackers to hijack the authentication of arbitrary users for requests that run commands on the Karaf server, as demonstrated by running \"shutdown -f.\"",
    "cve_publish_date": "2017-12-29",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Add a LoginTokenServlet that plugins can use to fetch a token, and let's use it in hawtio-karaf-terminal.  Also handle cases where the terminal scope gets created a couple times.",
    "type_of_change": "Modification",
    "filename_of_changes": "LoginServlet.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 3: import java.io.IOException;",
        "// Line_Reference 4: import java.io.PrintWriter;",
        "// Line_Reference 5: import java.security.AccessControlContext;",
        "// Line_Reference 6: import java.security.AccessController;",
        "// Line_Reference 7: import java.security.Principal;",
        "// Line_Reference 8: import java.util.ArrayList;",
        "// Line_Reference 9: import java.util.GregorianCalendar;",
        "// Line_Reference 10: import java.util.HashMap;",
        "// Line_Reference 11: import java.util.List;",
        "// Line_Reference 12: import java.util.Map;",
        "// Line_Reference 13: import java.util.Set;",
        "// Line_Reference 21: ",
        "// Line_Reference 22: import io.hawt.system.ConfigManager;",
        "// Line_Reference 23: import io.hawt.system.Helpers;",
        "// Line_Reference 24: import org.jolokia.converter.Converters;",
        "// Line_Reference 25: import org.jolokia.converter.json.JsonConvertOptions;",
        "// Line_Reference 26: import org.slf4j.Logger;",
        "// Line_Reference 27: import org.slf4j.LoggerFactory;",
        "// Line_Reference 37:     Converters converters = new Converters();",
        "// Line_Reference 38:     JsonConvertOptions options = JsonConvertOptions.DEFAULT;",
        "// Line_Reference 39:     ConfigManager config;",
        "// Line_Reference 78:             returnPrincipals(subject, out);",
        "// Line_Reference 115:         returnPrincipals(subject, out);",
        "// Line_Reference 118:     private void returnPrincipals(Subject subject, PrintWriter out) {"
    ]
}
