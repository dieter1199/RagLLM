{
    "cve_id": "CVE-2019-19379",
    "cve_description": "In app/Controller/TagsController.php in MISP 2.4.118, users can bypass intended restrictions on tagging data.",
    "cve_publish_date": "2019-11-28",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: [security] tightened checks for restricting users from tagging data they shouldn't be allowed to tag\n\nAs reported by Christophe Vandeplas",
    "type_of_change": "Modification",
    "filename_of_changes": "TagsController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "41",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 863:     private function __findObjectByUuid($object_uuid, &$type)",
        "// Line_Reference 866:         $object = $this->Event->find('first', array(",
        "// Line_Reference 867:             'conditions' => array(",
        "// Line_Reference 868:                 'Event.uuid' => $object_uuid,",
        "// Line_Reference 869:             ),",
        "// Line_Reference 870:             'fields' => array('Event.orgc_id', 'Event.id'),",
        "// Line_Reference 871:             'recursive' => -1",
        "// Line_Reference 877:                 !$this->userRole['perm_tagger'] &&",
        "// Line_Reference 878:                 $object['Event']['orgc_id'] != $this->Auth->user('org_id')",
        "// Line_Reference 880:                 throw new MethodNotAllowedException('Invalid Target.');",
        "// Line_Reference 884:             $object = $this->Event->Attribute->find('first', array(",
        "// Line_Reference 885:                 'conditions' => array(",
        "// Line_Reference 886:                     'Attribute.uuid' => $object_uuid,",
        "// Line_Reference 887:                 ),",
        "// Line_Reference 888:                 'fields' => array('Attribute.id'),",
        "// Line_Reference 889:                 'recursive' => -1,",
        "// Line_Reference 890:                 'contain' => array('Event.orgc_id')",
        "// Line_Reference 891:             ));",
        "// Line_Reference 893:                 if (!$this->_isSiteAdmin() && !$this->userRole['perm_tagger'] && $object['Event']['orgc_id'] != $this->Auth->user('org_id')) {",
        "// Line_Reference 894:                     throw new MethodNotAllowedException('Invalid Target.');",
        "// Line_Reference 897:                 throw new MethodNotAllowedException('Invalid Target.');",
        "// Line_Reference 935:         if (!is_bool($local)) {",
        "// Line_Reference 936:             throw new InvalidArgumentException('Invalid local flag');",
        "// Line_Reference 939:         $object = $this->__findObjectByUuid($uuid, $objectType);",
        "// Line_Reference 1041:         $object = $this->__findObjectByUuid($uuid, $objectType);",
        "// Line_Reference 1043:             throw new MethodNotAllowedException('Invalid Target.');"
    ]
}
