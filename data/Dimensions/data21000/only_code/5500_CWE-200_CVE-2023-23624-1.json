result = result.where(<<~SQL, name: @options[:exclude_tag]) if @options[:exclude_tag].present?
topics.id NOT IN (
SELECT topic_tags.topic_id
FROM topic_tags
INNER JOIN tags ON tags.id = topic_tags.tag_id
WHERE tags.name = :name
)
SQL