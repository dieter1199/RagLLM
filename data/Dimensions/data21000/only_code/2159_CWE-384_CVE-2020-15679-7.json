internal class Entry : System.Windows.Application
/// <summary>
/// Global value that is used to indicate if there is already an instance of the application running.
/// </summary>
private static readonly Mutex RunOnceMutex = new Mutex(false, string.Concat(@"Local\", ProductConstants.GUID));
if (args.Count() == 1)
if (!RunOnceMutex.WaitOne(TimeSpan.Zero, true))
// Already running, attempt to send a "show" command to the already running process before exiting
var runningWindow = User32.FindWindow(ProductConstants.TrayWindowClassName, string.Empty);
if (runningWindow != IntPtr.Zero)
User32.SendMessage(runningWindow, User32.WmShow, IntPtr.Zero, string.Empty);
Environment.Exit(1);
Manager.Initialize();
