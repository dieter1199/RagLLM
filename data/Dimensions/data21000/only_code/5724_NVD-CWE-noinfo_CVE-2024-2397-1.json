const void *sb, *se;
b = (u_char *)nd_malloc(ndo, caplen);
if (b == NULL)
return;
* Change the end pointer, so bounds checks work.
* Change the pointer to packet data to help debugging.
sb = ndo->ndo_packetp;
se = ndo->ndo_snapend;
ndo->ndo_packetp = b;
ndo->ndo_snapend = t;
ndo->ndo_packetp = sb;
ndo->ndo_snapend = se;
ndo->ndo_packetp = sb;
ndo->ndo_snapend = se;