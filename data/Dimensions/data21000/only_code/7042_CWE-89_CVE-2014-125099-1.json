* Version: 3.7.2
// get our variable from $atts
extract(shortcode_atts(array(
'container' => 'li',
'number' => '10',
'post_type' => 'post',
'year' => '',
'monthnum' => '',
'show_count' => '1',
), $atts));
global $wpdb;
$request = "SELECT * FROM $wpdb->posts, $wpdb->postmeta";
$request .= " WHERE $wpdb->posts.ID = $wpdb->postmeta.post_id";
if ($year != '') {
$request .= " AND YEAR(post_date) = '$year'";
}
if ($monthnum != '') {
$request .= " AND MONTH(post_date) = '$monthnum'";
}
$request .= " AND post_status='publish' AND post_type='$post_type' AND meta_key='_recommended'";
$request .= " ORDER BY $wpdb->postmeta.meta_value+0 DESC LIMIT $number";
$posts = $wpdb->get_results($request);
$return = '';
foreach ($posts as $item) {
$post_title = stripslashes($item->post_title);
$permalink = get_permalink($item->ID);
$post_count = $item->meta_value;
$return .= '<' . $container . '>';
$return .= '<a href="' . $permalink . '" title="' . $post_title.'" rel="nofollow">' . $post_title . '</a> ';
if ( $show_count == '1') {
$return .= '<span class="votes">' . $post_count . '</span> ';
}
//$return .= get_the_post_thumbnail($item->ID, 'showcase-thumbnail');
$return .= '</' . $container . '>';
}
return $return;
$columns['likes'] = 'likes';
add_action('manage_posts_custom_column', 'dot_column_content', 10, 2);