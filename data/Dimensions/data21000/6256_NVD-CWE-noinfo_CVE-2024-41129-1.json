{
    "cve_id": "CVE-2024-41129",
    "cve_description": "The ops library is a Python framework for developing and testing Kubernetes and machine charms. The issue here is that ops passes the secret content as one of the args via CLI. This issue may affect any of the charms that are using: Juju (>=3.0), Juju secrets and not correctly capturing and processing `subprocess.CalledProcessError`. This vulnerability is fixed in 2.15.0.",
    "cve_publish_date": "2024-07-22",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: use temp dir for secret data (#1290)\n\nChange the mechanism used to pass secret values from ops to hook tools\r\nfrom command line to files in temporary directory.\r\n\r\nRemoves the 2MB total secret size limit imposed by command line length\r\n\r\nHook tool calls juju agent which in turn reads these files, I've\r\nconfirmed with the Juju team that juju agent and charm code are run as\r\nthe same user.",
    "type_of_change": "Modification",
    "filename_of_changes": "model.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 3601:         if content is not None:",
        "// Line_Reference 3602:             # The content has already been validated with Secret._validate_content",
        "// Line_Reference 3603:             for k, v in content.items():",
        "// Line_Reference 3604:                 args.append(f'{k}={v}')",
        "// Line_Reference 3605:         self._run_for_secret('secret-set', *args)",
        "// Line_Reference 3628:         # The content has already been validated with Secret._validate_content",
        "// Line_Reference 3629:         for k, v in content.items():",
        "// Line_Reference 3630:             args.append(f'{k}={v}')",
        "// Line_Reference 3631:         result = self._run('secret-add', *args, return_output=True)"
    ]
}
