{
    "cve_id": "CVE-2013-4592",
    "cve_description": "Memory leak in the __kvm_set_memory_region function in virt/kvm/kvm_main.c in the Linux kernel before 3.9 allows local users to cause a denial of service (memory consumption) by leveraging certain device access to trigger movement of memory slots.",
    "cve_publish_date": "2013-11-20",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "KVM: Fix iommu map/unmap to handle memory slot moves\n\nThe iommu integration into memory slots expects memory slots to be\nadded or removed and doesn't handle the move case.  We can unmap\nslots from the iommu after we mark them invalid and map them before\ninstalling the final memslot array.  Also re-order the kmemdup vs\nmap so we don't leave iommu mappings if we get ENOMEM.\n\nReviewed-by: Gleb Natapov <gleb@redhat.com>\nSigned-off-by: Alex Williamson <alex.williamson@redhat.com>\nSigned-off-by: Marcelo Tosatti <mtosatti@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "kvm_main.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 840: \t/* map/unmap the pages in iommu page table */",
        "// Line_Reference 841: \tif (npages) {",
        "// Line_Reference 842: \t\tr = kvm_iommu_map_pages(kvm, &new);",
        "// Line_Reference 843: \t\tif (r)",
        "// Line_Reference 844: \t\t\tgoto out_free;",
        "// Line_Reference 845: \t} else",
        "// Line_Reference 846: \t\tkvm_iommu_unmap_pages(kvm, &old);",
        "// Line_Reference 847: "
    ]
}
