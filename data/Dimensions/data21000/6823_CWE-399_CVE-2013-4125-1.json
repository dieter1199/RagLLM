{
    "cve_id": "CVE-2013-4125",
    "cve_description": "The fib6_add_rt2node function in net/ipv6/ip6_fib.c in the IPv6 stack in the Linux kernel through 3.10.1 does not properly handle Router Advertisement (RA) messages in certain circumstances involving three routes that initially qualified for membership in an ECMP route set until a change occurred for one of the first two routes, which allows remote attackers to cause a denial of service (system crash) via a crafted sequence of messages.",
    "cve_publish_date": "2013-07-15",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "ipv6: only static routes qualify for equal cost multipathing\n\nStatic routes in this case are non-expiring routes which did not get\nconfigured by autoconf or by icmpv6 redirects.\n\nTo make sure we actually get an ecmp route while searching for the first\none in this fib6_node's leafs, also make sure it matches the ecmp route\nassumptions.\n\nv2:\na) Removed RTF_EXPIRE check in dst.from chain. The check of RTF_ADDRCONF\n   already ensures that this route, even if added again without\n   RTF_EXPIRES (in case of a RA announcement with infinite timeout),\n   does not cause the rt6i_nsiblings logic to go wrong if a later RA\n   updates the expiration time later.\n\nv3:\na) Allow RTF_EXPIRES routes to enter the ecmp route set. We have to do so,\n   because an pmtu event could update the RTF_EXPIRES flag and we would\n   not count this route, if another route joins this set. We now filter\n   only for RTF_GATEWAY|RTF_ADDRCONF|RTF_DYNAMIC, which are flags that\n   don't get changed after rt6_info construction.\n\nCc: Nicolas Dichtel <nicolas.dichtel@6wind.com>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip6_fib.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 694: \t\t\tif (rt->rt6i_flags & RTF_GATEWAY &&",
        "// Line_Reference 695: \t\t\t    !(rt->rt6i_flags & RTF_EXPIRES) &&",
        "// Line_Reference 696: \t\t\t    !(iter->rt6i_flags & RTF_EXPIRES))",
        "// Line_Reference 718: \t\t\tif (sibling->rt6i_metric == rt->rt6i_metric) {"
    ]
}
