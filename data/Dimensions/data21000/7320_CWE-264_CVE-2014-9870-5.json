{
    "cve_id": "CVE-2014-9870",
    "cve_description": "The Linux kernel before 3.11 on ARM platforms, as used in Android before 2016-08-05 on Nexus 5 and 7 (2013) devices, does not properly consider user-space access to the TPIDRURW register, which allows local users to gain privileges via a crafted application, aka Android internal bug 28749743 and Qualcomm internal bug CR561044.",
    "cve_publish_date": "2016-08-06",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "ARM: 7735/2: Preserve the user r/w register TPIDRURW on context switch and fork\n\nSince commit 6a1c53124aa1 the user writeable TLS register was zeroed to\nprevent it from being used as a covert channel between two tasks.\n\nThere are more and more applications coming to Windows RT,\nWine could support them, but mostly they expect to have\nthe thread environment block (TEB) in TPIDRURW.\n\nThis patch preserves that register per thread instead of clearing it.\nUnlike the TPIDRURO, which is already switched, the TPIDRURW\ncan be updated from userspace so needs careful treatment in the case that we\nmodify TPIDRURW and call fork(). To avoid this we must always read\nTPIDRURW in copy_thread.\n\nSigned-off-by: Andr√© Hentschel <nerv@dawncrow.de>\nSigned-off-by: Will Deacon <will.deacon@arm.com>\nSigned-off-by: Jonathan Austin <jonathan.austin@arm.com>\nSigned-off-by: Russell King <rmk+kernel@arm.linux.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "tls.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 5: \t.macro set_tls_none, tp, tmp1, tmp2",
        "// Line_Reference 8: \t.macro set_tls_v6k, tp, tmp1, tmp2",
        "// Line_Reference 10: \tmov\t\\tmp1, #0",
        "// Line_Reference 11: \tmcr\tp15, 0, \\tmp1, c13, c0, 2\t@ clear user r/w TLS register",
        "// Line_Reference 14: \t.macro set_tls_v6, tp, tmp1, tmp2",
        "// Line_Reference 19: \tmcrne\tp15, 0, \\tp, c13, c0, 3\t\t@ yes, set TLS register",
        "// Line_Reference 20: \tmovne\t\\tmp1, #0",
        "// Line_Reference 21: \tmcrne\tp15, 0, \\tmp1, c13, c0, 2\t@ clear user r/w TLS register",
        "// Line_Reference 25: \t.macro set_tls_software, tp, tmp1, tmp2",
        "// Line_Reference 34: #define set_tls\t\tset_tls_none",
        "// Line_Reference 38: #define set_tls\t\tset_tls_v6",
        "// Line_Reference 42: #define set_tls\t\tset_tls_v6k",
        "// Line_Reference 46: #define set_tls\t\tset_tls_software"
    ]
}
