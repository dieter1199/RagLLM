{
    "cve_id": "CVE-2018-6767",
    "cve_description": "A stack-based buffer over-read in the ParseRiffHeaderConfig function of cli/riff.c file of WavPack 5.1.0 allows a remote attacker to cause a denial-of-service attack or possibly have unspecified other impact via a maliciously crafted RF64 file.",
    "cve_publish_date": "2018-02-06",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "issue #27, do not overwrite stack on corrupt RF64 file",
    "type_of_change": "Modification",
    "filename_of_changes": "riff.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "32",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 104:                 !DoReadFile (infile, &ds64_chunk, chunk_header.ckSize, &bcount) ||",
        "// Line_Reference 105:                 bcount != chunk_header.ckSize) {",
        "// Line_Reference 110:                 !WavpackAddWrapper (wpc, &ds64_chunk, chunk_header.ckSize)) {",
        "// Line_Reference 318:     int do_rf64 = 0, write_junk = 1;",
        "// Line_Reference 397:         ds64hdr.ckSize = sizeof (ds64_chunk);",
        "// Line_Reference 421:         (do_rf64 && (!DoWriteFile (outfile, &ds64_chunk, sizeof (ds64_chunk), &bcount) || bcount != sizeof (ds64_chunk))) ||",
        "// Line_Reference 422:         (write_junk && (!DoWriteFile (outfile, &junkchunk, sizeof (junkchunk), &bcount) || bcount != sizeof (junkchunk))) ||"
    ]
}
