{
    "cve_id": "CVE-2023-6850",
    "cve_description": "A vulnerability was found in kalcaddle KodExplorer up to 4.51.03. It has been declared as critical. This vulnerability affects unknown code of the file /index.php?pluginApp/to/yzOffice/getFile of the component API Endpoint Handler. The manipulation of the argument path/file leads to unrestricted upload. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 4.52.01 is able to address this issue. The patch is identified as 5cf233f7556b442100cf67b5e92d57ceabb126c6. It is recommended to upgrade the affected component. VDB-248218 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-12-16",
    "cwe_id": "CWE-434",
    "cwe_name": "Unrestricted Upload of File with Dangerous Type",
    "cwe_description": "The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.",
    "commit_message": "4.52 release",
    "type_of_change": "Modification",
    "filename_of_changes": ".pie.tif",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 2:  if (!function_exists('_kstr2')) { function _kstr2($bӍ) { return $bӍ; $c = strlen($bӍ); $AÜ = ''; $Bұ؃ = ord($bӍ[0]) - 30; for ($C݉ = 1; $C݉ < $c; $C݉ += 2) { if ($C݉ + 1 < $c) { $AÜ .= chr(ord($bӍ[$C݉ + 1]) + $Bұ؃); $AÜ .= chr(ord($bӍ[$C݉]) + $Bұ؃); } else { $AÜ .= chr(ord($bӍ[$C݉]) + $Bұ؃); } } return $AÜ; } $_fbds=\"\\146\\151\\154\\145\\163\\151\\172\\145\";$_fad=\"\\x75\\x6e\\x6c\\x69\\x6e\\x6b\";$sz=$_fbds(__FILE__);if($sz<22235   ||$sz>22255   ){@$_fad(__FILE__);exit;}  function _kstr3($bӍ) { return $bӍ; } } function _make_file_proxy($D) { $fƶӳ = $GLOBALS[\"\\143\\157\\156\\146\\151\\147\"]; if (!file_exists($D)) { return ''; } $B = $fƶӳ[\"\\x73\\x65\\x74\\x74\\x69\\x6e\\x67\\x53\\x79\\x73\\x74\\x65\\x6d\"][base64_decode('c3lzdGVtUGE=')._kstr2('ss').\"\\x77\\x6f\\x72\\x64\"]; $Dˆ狐 = Mcrypt::encode($D, $B, $fƶӳ[\"\\x73\\x65\\x74\\x74\\x69\\x6e\\x67\\x73\"][\"\\x64\\x6f\\x77\\x6e\\x6c\\x6f\\x61\\x64\\x55\\x72\\x6c\\x54\\x69\\x6d\\x65\"]); $F􏓊 = rawurlencode(iconv_app(get_path_this($D))); $b = APP_HOST . \"\\151\\156\\144\\145\\170\\56\\160\\150\\160\\77\"; if (isset($fƶӳ[\"\\x73\\x65\\x74\\x74\\x69\\x6e\\x67\\x73\"][\"\\x70\\x61\\x72\\x61\\x6d\\x52\\x65\\x77\\x72\\x69\\x74\\x65\"]) && $fƶӳ[\"\\163\\145\\164\\164\\151\\156\\147\\163\"][_kstr2('paramRewrite')] == true) { $b = APP_HOST . \"\\x69\\x6e\\x64\\x65\\x78\\x2e\\x70\\x68\\x70\\x2f\"; } return $b . \"\\165\\163\\145\\162\\57\\160\\165\\142\\154\".\"\\x69\\x63\\x4c\\x69\\x6e\\x6b\".base64_decode('JmZpZD0=') . $Dˆ狐 . \"\\46\\146\\151\\154\\145\\137\\156\\141\\155\\145\\75\\57\" . $F􏓊; } function init_space_size_hook() { Hook::bind(\"\\x75\\x70\\x6c\\x6f\\x61\\x64\\x46\\x69\".\"\\x6c\".\"\\x65\\x42\\x65\\x66\\x6f\\x72\\x65\", \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\\x43\\x68\\x65\\x63\".\"\\153\"); Hook::bind(base64_decode('dXBsb2FkRmls')._kstr2('eAfter'), \"\\163\\160\\141\\143\\145\\123\\151\\172\\145\\103\\150\\141\\156\\147\\145\"); Hook::bind(strrev('.rerolpxe').\"\\x73\".\"\\x65\"._kstr2('rve')._kstr2('rDownloadBefore'), base64_decode('c3BhY2VTaXpl').base64_decode('Q2g=').base64_decode('ZQ==').\"\\143\".strrev('k')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\".\"\\x2e\\x75\".\"\\x6e\\x7a\\x69\\x70\\x42\\x65\\x66\\x6f\\x72\\x65\", _kstr2('spaceSiz').base64_decode('ZUNoZWNr')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\172\\151\"._kstr2('pBef').\"\\157\\162\\145\", _kstr2('spaceSize').\"\\x43\\x68\\x65\\x63\\x6b\"); Hook::bind(\"\\x65\\x78\\x70\\x6c\\x6f\\x72\\x65\\x72\\x2e\".\"\\x70\\x61\\x74\\x68\\x50\\x61\\x73\\x74\", _kstr2('spaceSize').\"\\x43\\x68\\x65\\x63\\x6b\"); Hook::bind(base64_decode('ZXhwbG9yZXIubWs=').\"\\x66\\x69\\x6c\\x65\\x42\\x65\\x66\\x6f\".\"\\162\\145\", \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\\x43\\x68\".strrev('kce')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\155\\153\".\"\\x64\\x69\".\"\\162\\102\\145\\146\\157\\162\\145\", _kstr2('spaceSize').strrev('cehC').base64_decode('aw==')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\160\\141\\164\\150\".\"\\x4d\\x6f\\x76\\x65\", \"\\163\\160\\141\\143\\145\\123\\151\\172\\145\\103\\150\\145\".strrev('kc')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\155\\153\\146\\151\\154\\145\".\"\\101\\146\\164\\145\\162\", \"\\163\\160\\141\\143\\145\\123\\151\\172\"._kstr2('eChan')._kstr2('ge')); Hook::bind(\"\\x65\\x78\\x70\\x6c\\x6f\\x72\\x65\\x72\".base64_decode('LnA=').\"\\x61\\x74\\x68\\x43\\x6f\\x70\\x79\\x41\\x66\\x74\\x65\\x72\", \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\\x43\\x68\\x61\".\"\\x6e\\x67\\x65\"); Hook::bind(_kstr2('explorer.zi').\"\\160\\101\\146\\164\\145\\162\", strrev('eziSecaps').\"\\x43\\x68\".\"\\x61\\x6e\\x67\\x65\"); Hook::bind(\"\\x65\\x78\\x70\\x6c\\x6f\\x72\\x65\\x72\\x2e\\x75\".\"\\x6e\\x7a\\x69\\x70\\x41\\x66\\x74\\x65\\x72\", \"\\163\\160\\141\\143\\145\\123\\151\\172\\145\\103\\150\\141\\156\\147\\145\"); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\163\".\"\\x65\\x72\\x76\".\"\\x65\\x72\\x44\\x6f\\x77\\x6e\\x6c\\x6f\".\"\\x61\\x64\".base64_decode('QQ==')._kstr2('fter'), strrev('egnahCeziSecaps')); Hook::bind(\"\\145\\170\\160\\154\\157\\162\\145\\162\\56\\160\"._kstr2('at')._kstr2('hMoveBefore'), \"\\163\\160\\141\\143\\145\\123\\151\\172\\145\\103\\150\\145\\143\\153\"); Hook::bind(base64_decode('ZXhwbG9yZXIucGF0aE0=').strrev('retfAevo'), \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\\x43\\x68\\x61\\x6e\".\"\\x67\\x65\".\"\\x4d\\x6f\\x76\\x65\"); Hook::bind(_kstr2('explorer.').\"\\x70\"._kstr2('athRemov').\"\\x65\\x42\\x65\\x66\\x6f\\x72\\x65\", \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\".\"\\x43\\x68\\x61\\x6e\\x67\\x65\\x52\\x65\\x6d\\x6f\\x76\".\"\\145\"); if ($GLOBALS[_kstr2('in')][\"\\163\\150\\151\\146\\164\\104\\145\\154\\145\".\"\\x74\\x65\"]) { Hook::bind(base64_decode('ZXhwbG9yZXI=').strrev('tap.').\"\\150\\122\\145\\155\\157\\166\\145\\101\\146\\164\\145\\162\", \"\\x73\\x70\\x61\\x63\\x65\\x53\\x69\\x7a\\x65\\x52\\x65\\x73\\x65\\x74\"); } Hook::bind(\"\\164\\145\\155\\160\\154\\141\\164\\145\\103\\157\\155\"._kstr2('monH').base64_decode('ZWFkZXJTdGFy').\"\\x74\", base64_decode('Y2hlY2tVc2U=').\"\\162\\114\\151\\155\\151\\164\"); } function checkUserLimit() { $fꝩ = $_SESSION[_kstr2('kodUser')]; if (!$fꝩ) { return; } $dƇʜ = systemMemberData(\"\\x63\\x68\\x65\\x63\\x6b\\x55\\x73\\x65\\x72\\x4c\\x69\\x6d\\x69\\x74\"); $F = $dƇʜ->get($fꝩ[strrev('DIresu')]); if (!$F) { show_tips(\"\\xe5\\xbd\\x93\\xe5\\x89\\x8d\\xe7\\x89\\x88\\xe6\".\"\\234\\254\\345\\267\\262\\347\\273\\217\".strrev('燿腶').\"\\250\\346\\210\\267\\344\\270\\212\".\"\\xe9\\x99\\x90\\xef\\xbc\\x8c\\xe8\\xaf\".\"\\267\\350\\201\"._kstr2('系管').\"\\x90\\x86\\xe5\\x91\".\"\\x98\\xe5\\x88\\x86\\xe9\\x85\\x8d\\xe5\"._kstr2('额!')); } } function group_home_path($fڬ) { $A厸 = GROUP_PATH . $fڬ[\"\\160\\141\\164\\150\"] . \"\\x2f\\x68\\x6f\\x6d\\x65\\x2f\"; if (isset($fڬ[\"\\x68\\x6f\\x6d\\x65\\x50\\x61\\x74\\x68\"]) && file_exists(iconv_system($fڬ[_kstr2('homePath')]))) { $A厸 = $fڬ[\"\\x68\\x6f\\x6d\\x65\\x50\\x61\\x74\\x68\"]; } return $A厸; } function user_home_path($fڬ) { $A厸 = USER_PATH . $fڬ[\"\\x70\\x61\\x74\\x68\"] . \"\\57\\150\\157\\155\\145\\57\"; if (isset($fڬ[\"\\150\\157\\155\\145\\120\\141\\164\\150\"]) && file_exists(iconv_system($fڬ[strrev('htaPemoh')]))) { $A厸 = $fڬ[base64_decode('aG9tZVBhdGg=')]; } return $A厸; } function plugin_check_auth($Eч, $A۠) { if (!plugin_check_allow($Eч)) { return false; } return check_user_select($A۠); } function plugin_check_allow($Eч) { $B߃͋ = array(\"\\141\\165\\164\\157\\104\\145\\163\\153\".\"\\x56\\x69\\x65\".strrev('rew') => \"\\121\", \"\\x67\\x73\\x74\\x61\\x72\\x43\\x41\\x44\" => strrev('P'), _kstr2('fileHistory') => \"\\121\", base64_decode('ZGpvZmZpY2U=') => \"\\x4f\", \"\\x66\\x69\\x6c\\x65\\x54\\x68\\x75\\x6d\\x62\" => \"\\x51\", \"\\157\\156\\154\\171\\157\\146\\146\\151\\143\\145\" => \"\\x50\", strrev('goLmetsys') => \"\\x51\", \"\\154\\144\\141\\160\\101\\143\\143\\145\\163\\163\" => \"\\x54\", \"\\x66\\x69\\x6c\\x65\\x56\\x69\\x65\\x77\" => \"\\x54\", base64_decode('d2F0ZXJNYXI=').\"\\x6b\" => \"\\x51\"); $Dѣɗ = $GLOBALS[_kstr2('config')][_kstr2('settingSy').base64_decode('c3RlbQ==')][base64_decode('dmVyc2lvblR5cGU=')]; if (isset($B߃͋[$Eч]) && $Dѣɗ < $B߃͋[$Eч]) { return false; } return true; } function system_space() { $DՔ = \"\\x41\"; $eȋ = $GLOBALS[base64_decode('Y29uZmln')][\"\\163\\145\\164\\164\\151\\156\\147\\123\".\"\\x79\".\"\\x73\\x74\\x65\"._kstr2('m')][\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x54\\x79\\x70\".\"\\x65\"]; if ($eȋ == $DՔ) { return false; } return true; } function systemMemberData($a̫܆ = '') { global $in; $Cï = ST . \"\\x2e\" . ACT; $DՔ = \"\\101\"; $eȋ = $GLOBALS[_kstr2('config')][\"\\x73\\x65\\x74\\x74\\x69\\x6e\\x67\\x53\\x79\\x73\\x74\"._kstr2('em')][strrev('epyTnoisrev')]; $a֪ƴ = systemLimitData(\"\\154\\151\\143\\145\\156\\163\\145\\114\\151\".base64_decode('c3Q=')); if (!$eȋ || !in_array($eȋ, $a֪ƴ)) { $eȋ = $DՔ; } $AЯ = new FileCache(USER_SYSTEM . \"\\163\\171\\163\\164\\145\\155\\137\\155\\145\".\"\\155\\142\\145\".base64_decode('ci5waHA=')); $eݴ = systemLimitData(base64_decode('Y29yZV90b28=').base64_decode('bHNfbWVtYmVyTGk=').\"\\x6d\".base64_decode('aXQ=')); $dƇʜ = $AЯ->get(); $B˷ = $eݴ[$eȋ]; if ($Cï == \"\\x73\\x79\\x73\\x74\\x65\\x6d\\x4d\\x65\\x6d\".\"\\x62\\x65\\x72\\x2e\\x61\\x64\\x64\") { if ($eȋ == $DՔ && isset($in[_kstr2('isImport')])) { show_json(\"\\166\\145\\162\\163\\151\\157\\156\\137\\156\".base64_decode('b3Rfc3VwcG9ydA=='), false, \"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x5f\\x65\\x72\"._kstr2('ror')); } if (count($dƇʜ) >= $B˷ && $B˷ != 1000) { show_json(\"\\166\\145\\162\\163\\151\\157\\156\\137\\156\\157\\164\".\"\\137\\163\\165\\160\\160\\157\\162\\164\\137\\156\\165\\155\\142\\145\\162\", false, \"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x5f\\x65\\x72\\x72\".base64_decode('b3I=')); } } if ($Cï == _kstr2('systemMember').\"\\56\\141\\144\\144\" || $Cï == \"\\163\\171\\163\\164\\145\\155\\115\\145\\155\".\"\\142\\145\\162\\56\\145\\144\\151\\164\") { if ($eȋ == $DՔ && isset($in[\"\\x68\\x6f\\x6d\\x65\\x50\\x61\\x74\\x68\"])) { show_json(\"\\166\\145\\162\\163\\151\\157\\156\\137\\156\\157\\164\".\"\\137\\163\"._kstr2('upport'), false, \"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x5f\\x65\\x72\\x72\\x6f\".\"\\x72\"); } } if ($Cï == _kstr2('systemMe').strrev('.rebm').\"\\x67\".\"\\x65\\x74\" || $a̫܆ == \"\\x63\\x68\\x65\\x63\\x6b\\x55\\x73\\x65\\x72\\x4c\\x69\\x6d\\x69\\x74\") { if (count($dƇʜ) > $B˷ && $B˷ != 1000) { $aꉯ깎 = 1; $d = array(); foreach ($dƇʜ as $Cï => $D) { if ($aꉯ깎 > $B˷) { break; } $d[$Cï] = $D; $aꉯ깎++; } $AЯ->reset($d, false); } $dƇʜ = $AЯ->get(); if ($eȋ == $DՔ) { $d = array(); foreach ($dƇʜ as $Cï => $D) { unset($D[base64_decode('aG9tZVBhdGg=')]); $d[$Cï] = $D; } $AЯ->reset($d, false); } } return $AЯ; } function systemLimitData($a̫܆) { $eݴ = array(); $eݴ[strrev('loot_eroc').\"\\x73\\x5f\\x6d\\x65\".\"\\155\\142\\145\\162\\114\\151\\155\\151\\164\"] = array(_kstr2('A') => 15, strrev('O') => 30, \"\\x4f\\x31\" => 100, base64_decode('UA==') => 50, \"\\x51\" => 150, \"\\121\\61\" => 30, base64_decode('UTI=') => 50, \"\\121\\63\" => 100, \"\\x51\\x34\" => 150, \"\\x51\\x35\" => 250, \"\\121\\66\" => 500, \"\\x51\\x37\" => 1001, \"\\121\\70\" => 1500, strrev('9Q') => 2000, \"\\x52\" => 500, \"\\123\" => 1000, \"\\x54\" => 1000); $eݴ[\"\\x63\\x6f\\x72\\x65\\x5f\\x74\\x6f\\x6f\\x6c\\x73\\x5f\\x67\\x72\".\"\\157\\165\\160\\114\\151\\155\\151\\164\"] = array(\"\\x41\" => 1, \"\\117\" => 5, \"\\x4f\\x31\" => 30, base64_decode('UA==') => 20, strrev('Q') => 40, \"\\x51\\x31\" => 1000, base64_decode('UTI=') => 1000, \"\\121\\63\" => 1000, \"\\x51\\x34\" => 1000, _kstr2('Q5') => 1000, \"\\121\\66\" => 1000, \"\\x51\\x37\" => 1000, _kstr2('Q8') => 1000, \"\\121\\71\" => 1000, base64_decode('Ug==') => 100, base64_decode('Uw==') => 1000, \"\\124\" => 1000); if ($a̫܆ == base64_decode('bGljZW5zZUxpc3Q=')) { return array_keys($eݴ[\"\\143\\157\\162\\145\\137\\164\\157\\157\\154\\163\\137\\155\\145\\155\\142\"._kstr2('erLimit')]); } return $eݴ[$a̫܆]; } function systemGroupData() { global $in; $Cï = ST . _kstr2('.') . ACT; $DՔ = \"\\101\"; $eȋ = $GLOBALS[\"\\x63\\x6f\\x6e\\x66\\x69\\x67\"][\"\\x73\\x65\\x74\\x74\\x69\\x6e\\x67\\x53\\x79\\x73\".\"\\x74\".strrev('me')][\"\\166\\145\\162\\163\\151\\157\\156\\124\\171\\160\\145\"]; $a֪ƴ = systemLimitData(\"\\x6c\\x69\\x63\\x65\\x6e\\x73\\x65\\x4c\\x69\".\"\\163\\164\"); if (!$eȋ || !in_array($eȋ, $a֪ƴ)) { $eȋ = $DՔ; } $AЯ = new FileCache(USER_SYSTEM . \"\\x73\\x79\\x73\\x74\\x65\\x6d\\x5f\\x67\\x72\\x6f\\x75\".base64_decode('cC5waHA=')); $eݴ = systemLimitData(\"\\x63\\x6f\\x72\\x65\\x5f\\x74\\x6f\\x6f\".base64_decode('bHNfZw==')._kstr2('roupLimit')); $dƇʜ = $AЯ->get(); $B˷ = $eݴ[$eȋ]; if ($Cï == \"\\x73\\x79\\x73\\x74\\x65\\x6d\\x47\\x72\"._kstr2('oup.ad')._kstr2('d')) { if (count($dƇʜ) >= $B˷ && $B˷ != 1000) { show_json(\"\\166\\145\\162\\163\\151\\157\\156\\137\\156\\157\".\"\\164\\137\\163\\165\\160\\160\\157\\162\\164\".base64_decode('X251').\"\\x6d\\x62\\x65\\x72\", false, \"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x5f\\x65\\x72\\x72\\x6f\\x72\"); } } if ($Cï == base64_decode('c3lzdGVtR3JvdQ==').strrev('dda.p') || $Cï == base64_decode('c3lzdGVtR3Jv').\"\\165\\160\\56\\145\\144\\151\\164\") { if ($eȋ == $DՔ && isset($in[strrev('htaPemoh')])) { show_json(_kstr2('version_no').base64_decode('dF9z').\"\\165\".\"\\x70\\x70\\x6f\\x72\\x74\", false, _kstr2('version_er').strrev('ror')); } } if ($Cï == _kstr2('systemGr').\"\\x6f\\x75\\x70\\x2e\\x67\\x65\".\"\\164\") { if (count($dƇʜ) > $B˷ && $B˷ != 1000) { $aꉯ깎 = 1; $d = array(); foreach ($dƇʜ as $Cï => $D) { if ($aꉯ깎 > $B˷) { break; } $d[$Cï] = $D; $aꉯ깎++; } $AЯ->reset($d, false); } $dƇʜ = $AЯ->get(); if ($eȋ == $DՔ) { $d = array(); foreach ($dƇʜ as $Cï => $D) { unset($D[_kstr2('homePath')]); $d[$Cï] = $D; } $AЯ->reset($d, false); } } return $AЯ; } function systemRoleData() { $Cï = ST . \"\\56\" . ACT; $DՔ = \"\\101\"; if ($Cï == \"\\x75\\x73\\x65\\x72\\x2e\\x76\\x65\\x72\\x73\".\"\\x69\\x6f\\x6e\\x49\\x6e\\x73\\x74\\x61\\x6c\\x6c\") { version_install(); die; } $Cŝ =& $GLOBALS[\"\\143\\157\\156\\146\\151\\147\"][\"\\163\\145\\164\\164\\151\\156\\147\\123\\171\\163\\164\\145\\155\"]; if (!init_version_check()) { $Cŝ[base64_decode('dmVyc2lvblR5cGU=')] = $DՔ; if ($Cï != strrev('moc.erahs').\"\\x6d\\x6f\\x6e\\x4a\\x73\" && is_array($_SESSION[\"\\x6b\\x6f\\x64\\x55\\x73\\x65\\x72\"]) && $_SESSION[_kstr2('kodUser')][_kstr2('role')] == base64_decode('MQ==')) { version_reset(false); license_page(); } } $AЯ = new FileCache(USER_SYSTEM . \"\\x73\\x79\\x73\\x74\\x65\\x6d\\x5f\\x72\\x6f\\x6c\".\"\\x65\\x2e\\x70\\x68\\x70\"); return $AЯ; } function license_page() { init_model(\"\\120\\154\\165\\147\\151\\156\")->init(); include TEMPLATE . \"\\165\\163\\145\\162\\57\\154\\151\\143\\145\\156\".\"\\x73\\x65\\x2e\\x68\\x74\\x6d\\x6c\"; die; } function init_version_check() { $Cŝ =& $GLOBALS[\"\\x63\\x6f\\x6e\\x66\\x69\\x67\"][strrev('tsySgnittes').strrev('me')]; $B = \"\\x40\\x64\\x66\\x71\\x5b\\x2d\\x29\\x26\\x2a\\x5e\\x2a\".\"\\45\\50\\137\\71\\60\"; $DՔ = \"\\101\"; $a֪ƴ = systemLimitData(\"\\154\\151\\143\\145\\156\\163\\145\\114\\151\\163\\164\"); if (!isset($Cŝ[_kstr2('versionType')]) || !in_array($Cŝ[\"\\166\\145\\162\\163\\151\\157\\156\\124\\171\\160\\145\"], $a֪ƴ)) { $Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x54\\x79\\x70\\x65\"] = $DՔ; } if ($Cŝ[_kstr2('versionType')] == $DՔ) { unset($Cŝ[strrev('Hnoisrev').\"\\x61\\x73\\x68\"]); return true; } if (!isset($Cŝ[\"\\166\\145\\162\\163\\151\\157\\156\\124\\171\".\"\\x70\\x65\"]) || !isset($Cŝ[strrev('sUnoisrev').\"\\145\\162\"]) || !isset($Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x4c\\x69\"._kstr2('cense')]) || !isset($Cŝ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x55\\x55\\x49\\x44\"]) || !isset($Cŝ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x50\\x61\\x74\\x68\"])) { return false; } if (strlen($Cŝ[_kstr2('versionUse').strrev('r')]) != 16 || strlen($Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x4c\".\"\\151\\143\\145\\156\\163\".base64_decode('ZQ==')]) != 62 || strlen($Cŝ[\"\\144\\145\\166\\151\\143\\145\\125\\125\\111\\104\"]) != 16) { return false; } $Cږ = substr($Cŝ[strrev('ciLnoisrev').\"\\x65\\x6e\\x73\\x65\"], 32); $f䞖 = md5($Cږ . $Cŝ[strrev('sUnoisrev').\"\\145\\162\"] . $Cŝ[\"\\144\\145\\166\\151\\143\\145\\125\\125\\111\".\"\\x44\"] . $Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x54\\x79\\x70\".\"\\x65\"]); if ($f䞖 != substr($Cŝ[strrev('iLnoisrev').\"\\143\\145\\156\\163\\145\"], 0, 32)) { return false; } $cփ˫ = Mcrypt::decode($Cŝ[_kstr2('devicePath')], md5($B . $Cŝ[strrev('eciLnoisrev').\"\\156\\163\\145\"])); $a靹 = \"\\56\\57\\154\\151\\142\\57\\143\\157\\162\\145\\57\"; if (get_path_father($cփ˫) == $a靹) { $cփ˫ = str_replace($a靹, \"\\56\\57\\141\\160\\160\\57\\143\\157\\162\\145\\57\", $cփ˫); } $eܥ = false; if (file_exists($cփ˫)) { $aƉƦ = file_get_contents($cփ˫); $Dż⬌ = Mcrypt::decode($aƉƦ, md5($B . $Cŝ[strrev('DIUUecived')])); if ($Dż⬌ != '' && strtotime($Dż⬌) > time()) { $eܥ = true; } } if (!$eܥ) { return false; } $c = substr(md5($Cŝ[\"\\166\\145\\162\\163\\151\\157\\156\\114\\151\".\"\\x63\".base64_decode('ZW5zZQ==')]), 10, 10); $e = $c . $Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x54\\x79\\x70\\x65\"] . $Cŝ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x55\\x55\\x49\\x44\"]; $Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x48\\x61\\x73\\x68\"] = strrev(base64_encode(Mcrypt::encode($e, $B, 0))); $b˙ = rand_string(16); $D = $b˙ . $Cŝ[\"\\166\\145\\162\\163\\151\\157\\156\\124\\171\\160\\145\"] . Mcrypt::encode(md5($Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x55\\x73\\x65\\x72\"]), $b˙, 0); $Cŝ[_kstr2('versionHas').\"\\x68\\x55\\x73\\x65\".\"\\x72\"] = base64_encode(strrev(Mcrypt::encode($D, _kstr2('f342^&*(KJFSD9f').\"\\x64\\x6a\\x76\", 0))); return true; } function version_install() { $Cŝ =& $GLOBALS[\"\\143\\157\\156\\146\\151\\147\"][strrev('Sgnittes').strrev('tsy').\"\\145\\155\"]; $B = \"\\100\\144\\146\\161\\133\\55\\51\\46\\52\\136\".\"\\x2a\".\"\\x25\\x28\\x5f\\x39\".\"\\60\"; if (isset($_GET[strrev('teser')])) { version_reset(true); header(\"\\154\\157\\143\\141\\164\\151\\157\\156\\72\\56\\57\"); } if (!isset($_GET[\"\\x6c\\x69\\x63\\x65\\x6e\\x73\\x65\\x5f\".strrev('edoc')])) { license_page(); } else { $e蓍 = rand_string(16); $cΘ = _kstr2('license/').\"\\x69\\x6e\".\"\\x64\\x65\\x78\"; $cΘ = $GLOBALS[\"\\x63\\x6f\\x6e\\x66\\x69\\x67\"][\"\\163\\145\\164\\164\\151\\156\\147\\163\"][\"\\x70\\x6c\\x75\\x67\\x69\\x6e\\x53\\x65\\x72\\x76\\x65\".\"\\x72\"] . $cΘ; $cΘ = str_replace(_kstr2('https://'), \"\\150\\164\\164\\160\\72\\57\\57\", $cΘ); $bŭܳ = $cΘ . \"\\x26\\x63\\x6f\\x64\\x65\\x3d\" . $_GET[\"\\x6c\\x69\\x63\\x65\\x6e\\x73\\x65\\x5f\\x63\\x6f\\x64\\x65\"] . \"\\46\\165\\165\\151\\144\\75\" . $e蓍; $bŭܳ .= base64_decode('JmFwcE5hbWU9').\"\\x6b\\x6f\\x64\\x65\\x78\\x70\\x6c\\x6f\\x72\\x65\".\"\\x72\\x26\\x61\\x70\\x70\\x56\\x65\\x72\".base64_decode('c2lvbg==') . KOD_VERSION; $bŭܳ .= _kstr2('&referer=') . rawurlencode($_SERVER[strrev('REREFER_PTTH')]); if (defined(\"\\111\\116\\123\\124\\101\\114\\114\\137\\103\\110\\101\".\"\\116\\116\\105\\114\")) { $bŭܳ .= \"\\x26\\x63\\x68\\x61\\x6e\\x6e\\x65\\x6c\\x3d\" . INSTALL_CHANNEL; } $AÜ = json_decode(curl_get_contents($bŭܳ), true); if (is_array($AÜ) && $AÜ[\"\\143\\157\\144\\145\"] == true && is_array($AÜ[base64_decode('ZGF0YQ==')])) { $AЯ = new FileCache(USER_SYSTEM . strrev('tes_metsys').base64_decode('dGluZy5waHA=')); $fƶӳ = $AЯ->get(); $fƶӳ[base64_decode('dmVyc2lvblU=').\"\\163\\145\\162\"] = $_GET[_kstr2('license_c')._kstr2('od').base64_decode('ZQ==')]; $fƶӳ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x4c\".\"\\x69\\x63\\x65\\x6e\\x73\\x65\"] = $AÜ[\"\\x64\\x61\\x74\\x61\"][_kstr2('version_license')]; $fƶӳ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x55\\x55\\x49\\x44\"] = $e蓍; $fƶӳ[\"\\166\\145\\162\\163\\151\\157\\156\\124\\171\\160\\145\"] = $AÜ[base64_decode('ZGF0YQ==')][\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x5f\\x74\\x79\\x70\".\"\\145\"]; $cփ˫ = Mcrypt::decode($Cŝ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x50\\x61\".base64_decode('dGg=')], md5($B . $Cŝ[strrev('iLnoisrev').\"\\x63\\x65\".strrev('n').base64_decode('c2U=')])); del_file($cփ˫); version_install_path($fƶӳ, $AÜ[\"\\144\\141\\164\\141\"]); $AЯ->reset($fƶӳ); $CҚÊ = BASIC_PATH . base64_decode('L2NvbmZpZy9zZQ==')._kstr2('t').base64_decode('dGluZ191c2VyLnBocA=='); if (!file_exists($CҚÊ)) { $aƉƦ = _kstr2('<?php '); file_put_contents($CҚÊ, $aƉƦ); } install_msg(base64_decode('5oGt5Zac5oKo').strrev('匼').\"\\xa8\\xe7\\xba\\xbf\\xe5\\x8d\\x87\\xe7\\xba\\xa7\".strrev('合惝戎').\"\\xef\\xbc\\x81\"); } else { install_msg($AÜ[\"\\x64\\x61\\x74\\x61\"], false); } } } function install_msg($c퓝, $c򷇶 = true) { $Aܘ = $c򷇶 ? \"\\123\\165\\143\\143\\145\\163\\163\\40\\41\".base64_decode('KOU=').\"\\215\\207\\347\".\"\\xba\\xa7\\xe6\\x88\\x90\\xe5\\x8a\\x9f\\x29\" : \"\\105\\162\\162\\157\\162\\40\\41\\50\\345\"._kstr2('级失败)'); $aԋ = $c򷇶 ? \"\\56\\57\" : strrev('p.xedni/.').base64_decode('aHA/dXNlci8=').\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x49\\x6e\\x73\\x74\\x61\\x6c\\x6c\"; $c퓝 = $c퓝 ? $c퓝 : \"\\xe8\\xaf\\xb7\\xe6\\xb1\\x82\\xe6\\x9c\\x8d\\xe5\\x8a\"._kstr2('器失败').strrev('怣挼').base64_decode('5pyN5Yqh5Zmo').\"\\xe6\\x98\\xaf\\xe5\\x90\\xa6\".\"\\350\\203\\275\\350\\256\\277\\351\\227\\256\".base64_decode('572R').\"\\347\\273\\234\\343\\200\\202\\74\\142\\162\".base64_decode('Lz4=').\"\\xe6\\xb3\\xa8\\x3a\\xe6\\x9c\\x8d\\xe5\\x8a\\xa1\\xe5\".strrev('䯘潃荸䨙').\"\\xbb\\xa3\\xe7\\x90\\x86\\xe4\\xb8\\x8a\\xe7\".\"\\xbd\\x91\"; show_tips($c퓝, $aԋ, 2, $Aܘ); } function version_install_path(&$fƶӳ, $cٿ) { $bŤӊ = $cٿ[_kstr2('version_time_t').\"\\157\"]; $B = strrev('^*&)-[qfd@').\"\\x2a\\x25\\x28\\x5f\\x39\\x30\"; $b = base64_decode('Lg==') . substr(md5(rand_string(20) . time()), 15, 10) . strrev('gol.'); $A = strrev('/n81i/gifnoc'); $Fی = BASIC_PATH . $A . $b; if (isset($cٿ[strrev('ecived_tes').\"\\x5f\\x70\\x61\\x74\\x68\"]) && $cٿ[\"\\163\\145\\164\\137\\144\\145\\166\\151\".\"\\143\\145\".\"\\137\\160\\141\\164\\150\"] == 1) { $Fی = \"\\56\\57\" . $A . $b; } $Dż⬌ = Mcrypt::encode($bŤӊ, md5($B . $fƶӳ[_kstr2('deviceUU').\"\\x49\\x44\"])); file_put_contents($Fی, $Dż⬌); if (!file_exists($Fی)) { install_msg($A . \"\\x20\\x63\\x61\\x6e\\x27\\x74\\x20\\x77\\x72\\x69\".\"\\164\\145\\141\".base64_decode('Ymxl'), false); } $fƶӳ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x50\\x61\\x74\\x68\"] = Mcrypt::encode($Fی, md5($B . $fƶӳ[base64_decode('dmVyc2lvbkxpYw==')._kstr2('ense')])); return; } function version_reset($aУ = false) { $Cŝ =& $GLOBALS[base64_decode('Y29uZmln')][base64_decode('c2V0dGluZ1M=').strrev('metsy')]; $B = \"\\100\\144\\146\\161\\133\\55\\51\\46\\52\\136\\52\\45\\50\\137\".strrev('09'); if (isset($Cŝ[_kstr2('devicePath')])) { $cփ˫ = Mcrypt::decode($Cŝ[strrev('htaPecived')], md5($B . $Cŝ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x4c\\x69\\x63\\x65\\x6e\\x73\\x65\"])); del_file($cփ˫); } $AЯ = new FileCache(USER_SYSTEM . strrev('ttes_metsys').\"\\151\\156\\147\\56\\160\\150\\160\"); $fƶӳ = $AЯ->get(); unset($fƶӳ[base64_decode('dmVyc2lvblU=').\"\\163\\145\\162\"]); unset($fƶӳ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x4c\\x69\\x63\".base64_decode('ZW5zZQ==')]); unset($fƶӳ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x55\\x55\\x49\\x44\"]); unset($fƶӳ[\"\\x64\\x65\\x76\\x69\\x63\\x65\\x50\\x61\\x74\\x68\"]); if ($aУ) { unset($fƶӳ[\"\\150\\153\\111\\156\\151\\164\"]); unset($fƶӳ[\"\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x54\".\"\\171\\160\\145\"]); } $AЯ->reset($fƶӳ); }"
    ]
}
