{
    "cve_id": "CVE-2016-6561",
    "cve_description": "illumos smbsrv NULL pointer dereference allows system crash.",
    "cve_publish_date": "2017-03-31",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "7483 SMB flush on pipe triggers NULL pointer dereference in module smbsrv\nReviewed by: Gordon Ross <gwr@nexenta.com>\nReviewed by: Matt Barden <matt.barden@nexenta.com>\nReviewed by: Evan Layton <evan.layton@nexenta.com>\nReviewed by: Dan McDonald <danmcd@omniti.com>\nApproved by: Gordon Ross <gwr@nexenta.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "smb2_flush.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 26: \tsmb_ofile_t *of = NULL;",
        "// Line_Reference 54: \tof = sr->fid_ofile;",
        "// Line_Reference 56: \t/*",
        "// Line_Reference 57: \t * XXX - todo:",
        "// Line_Reference 58: \t * Flush named pipe should drain writes.",
        "// Line_Reference 59: \t */",
        "// Line_Reference 60: \tif ((of->f_node->flags & NODE_FLAGS_WRITE_THROUGH) == 0)",
        "// Line_Reference 61: \t\t(void) smb_fsop_commit(sr, of->f_cr, of->f_node);"
    ]
}
