{
    "cve_id": "CVE-2017-18174",
    "cve_description": "In the Linux kernel before 4.7, the amd_gpio_remove function in drivers/pinctrl/pinctrl-amd.c calls the pinctrl_unregister function, leading to a double free.",
    "cve_publish_date": "2018-02-11",
    "cwe_id": "CWE-415",
    "cwe_name": "Double Free",
    "cwe_description": "The product calls free() twice on the same memory address, potentially leading to modification of unexpected memory locations.",
    "commit_message": "pinctrl/amd: Drop pinctrl_unregister for devm_ registered device\n\nIt's not necessary to unregister pin controller device registered\nwith devm_pinctrl_register() and using pinctrl_unregister() leads\nto a double free.\n\nFixes: 3bfd44306c65 (\"pinctrl: amd: Add support for additional GPIO\")\nSigned-off-by: Wei Yongjun <weiyongjun1@huawei.com>\nSigned-off-by: Linus Walleij <linus.walleij@linaro.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "pinctrl-amd.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 839: \tpinctrl_unregister(gpio_dev->pctrl);"
    ]
}
