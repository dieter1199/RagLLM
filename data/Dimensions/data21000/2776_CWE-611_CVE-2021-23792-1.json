{
    "cve_id": "CVE-2021-23792",
    "cve_description": "The package com.twelvemonkeys.imageio:imageio-metadata before 3.7.1 are vulnerable to XML External Entity (XXE) Injection due to an insecurely initialized XML parser for reading XMP Metadata. An attacker can exploit this vulnerability if they are able to supply a file (e.g. when an online profile picture is processed) with a malicious XMP segment. If the XMP metadata of the uploaded image is parsed, then the XXE vulnerability is triggered.",
    "cve_publish_date": "2022-05-06",
    "cwe_id": "CWE-611",
    "cwe_name": "Improper Restriction of XML External Entity Reference",
    "cwe_description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
    "commit_message": "Avoid fetching external resources in XMPReader.",
    "type_of_change": "Modification",
    "filename_of_changes": "XMPReader.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "54",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 33: import com.twelvemonkeys.imageio.metadata.Directory;",
        "// Line_Reference 34: import com.twelvemonkeys.imageio.metadata.Entry;",
        "// Line_Reference 35: import com.twelvemonkeys.imageio.metadata.MetadataReader;",
        "// Line_Reference 36: import com.twelvemonkeys.imageio.util.IIOUtil;",
        "// Line_Reference 37: import com.twelvemonkeys.lang.Validate;",
        "// Line_Reference 46: import javax.imageio.IIOException;",
        "// Line_Reference 47: import javax.imageio.stream.ImageInputStream;",
        "// Line_Reference 48: import javax.xml.parsers.DocumentBuilder;",
        "// Line_Reference 49: import javax.xml.parsers.DocumentBuilderFactory;",
        "// Line_Reference 50: import javax.xml.parsers.ParserConfigurationException;",
        "// Line_Reference 51: import java.io.IOException;",
        "// Line_Reference 52: import java.util.*;",
        "// Line_Reference 70:         DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
        "// Line_Reference 71:         factory.setNamespaceAware(true);",
        "// Line_Reference 72: ",
        "// Line_Reference 82: //            XMLSerializer serializer = new XMLSerializer(System.err, System.getProperty(\"file.encoding\"));",
        "// Line_Reference 83: //            serializer.serialize(document);",
        "// Line_Reference 84: ",
        "// Line_Reference 95:             throw new RuntimeException(e); // TODO: Or IOException?",
        "// Line_Reference 112:         Map<String, List<Entry>> subdirs = new LinkedHashMap<String, List<Entry>>();",
        "// Line_Reference 130:                     dir = new ArrayList<Entry>();",
        "// Line_Reference 142:                     Map<String, List<Entry>> subsubdirs = new LinkedHashMap<String, List<Entry>>();",
        "// Line_Reference 164:         List<Directory> entries = new ArrayList<Directory>(subdirs.size());",
        "// Line_Reference 182:         List<Entry> entries = new ArrayList<Entry>();",
        "// Line_Reference 207:                 dir = new ArrayList<Entry>();",
        "// Line_Reference 219:                 Map<String, Object> alternatives = new LinkedHashMap<String, Object>();",
        "// Line_Reference 233:                 List<Object> seq = new ArrayList<Object>();"
    ]
}
