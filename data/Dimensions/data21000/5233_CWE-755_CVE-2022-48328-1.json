{
    "cve_id": "CVE-2022-48328",
    "cve_description": "app/Controller/Component/IndexFilterComponent.php in MISP before 2.4.167 mishandles ordered_url_params and additional_delimiters.",
    "cve_publish_date": "2023-02-20",
    "cwe_id": "CWE-755",
    "cwe_name": "Improper Handling of Exceptional Conditions",
    "cwe_description": "The product does not handle or incorrectly handles an exceptional condition.",
    "commit_message": "chg: [cleanup] indexfilter unused leftover functionality reworked",
    "type_of_change": "Modification",
    "filename_of_changes": "IndexFilterComponent.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 49:                 if (",
        "// Line_Reference 50:                     isset($options['ordered_url_params'][$p]) &&",
        "// Line_Reference 51:                     (!in_array(strtolower((string)$options['ordered_url_params'][$p]), array('null', '0', false, 'false', null)))",
        "// Line_Reference 52:                 ) {",
        "// Line_Reference 53:                     $data[$p] = $options['ordered_url_params'][$p];",
        "// Line_Reference 54:                     $data[$p] = str_replace(';', ':', $data[$p]);",
        "// Line_Reference 55:                 }",
        "// Line_Reference 70:         if (!empty($options['additional_delimiters'])) {",
        "// Line_Reference 71:             if (!is_array($options['additional_delimiters'])) {",
        "// Line_Reference 72:                 $options['additional_delimiters'] = array($options['additional_delimiters']);",
        "// Line_Reference 73:             }",
        "// Line_Reference 74:             foreach ($data as $k => $v) {",
        "// Line_Reference 75:                 $found = false;",
        "// Line_Reference 76:                 foreach ($options['additional_delimiters'] as $delim) {",
        "// Line_Reference 77:                     if (strpos($v, $delim) !== false) {",
        "// Line_Reference 78:                         $found = true;",
        "// Line_Reference 79:                         break;",
        "// Line_Reference 80:                     }",
        "// Line_Reference 81:                 }",
        "// Line_Reference 82:                 if ($found) {",
        "// Line_Reference 83:                     $data[$k] = explode($options['additional_delimiters'][0], str_replace($options['additional_delimiters'], $options['additional_delimiters'][0], $v));",
        "// Line_Reference 84:                     foreach ($data[$k] as $k2 => $value) {",
        "// Line_Reference 85:                         $data[$k][$k2] = trim($data[$k][$k2]);",
        "// Line_Reference 86:                     }",
        "// Line_Reference 87:                 }",
        "// Line_Reference 88:             }",
        "// Line_Reference 89:         }"
    ]
}
