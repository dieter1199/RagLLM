{
    "cve_id": "CVE-2023-1390",
    "cve_description": "A remote denial of service vulnerability was found in the Linux kernelâ€™s TIPC kernel module. The while loop in tipc_link_xmit() hits an unknown state while attempting to parse SKBs, which are not in the queue. Sending two small UDP packets to a system with a UDP bearer results in the CPU utilization for the system to instantly spike to 100%, causing a denial of service condition.",
    "cve_publish_date": "2023-03-16",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "tipc: fix NULL deref in tipc_link_xmit()\n\nThe buffer list can have zero skb as following path:\ntipc_named_node_up()->tipc_node_xmit()->tipc_link_xmit(), so\nwe need to check the list before casting an &sk_buff.\n\nFault report:\n [] tipc: Bulk publication failure\n [] general protection fault, probably for non-canonical [#1] PREEMPT [...]\n [] KASAN: null-ptr-deref in range [0x00000000000000c8-0x00000000000000cf]\n [] CPU: 0 PID: 0 Comm: swapper/0 Kdump: loaded Not tainted 5.10.0-rc4+ #2\n [] Hardware name: Bochs ..., BIOS Bochs 01/01/2011\n [] RIP: 0010:tipc_link_xmit+0xc1/0x2180\n [] Code: 24 b8 00 00 00 00 4d 39 ec 4c 0f 44 e8 e8 d7 0a 10 f9 48 [...]\n [] RSP: 0018:ffffc90000006ea0 EFLAGS: 00010202\n [] RAX: dffffc0000000000 RBX: ffff8880224da000 RCX: 1ffff11003d3cc0d\n [] RDX: 0000000000000019 RSI: ffffffff886007b9 RDI: 00000000000000c8\n [] RBP: ffffc90000007018 R08: 0000000000000001 R09: fffff52000000ded\n [] R10: 0000000000000003 R11: fffff52000000dec R12: ffffc90000007148\n [] R13: 0000000000000000 R14: 0000000000000000 R15: ffffc90000007018\n [] FS:  0000000000000000(0000) GS:ffff888037400000(0000) knlGS:000[...]\n [] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n [] CR2: 00007fffd2db5000 CR3: 000000002b08f000 CR4: 00000000000006f0\n\nFixes: af9b028e270fd (\"tipc: make media xmit call outside node spinlock context\")\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: Hoang Le <hoang.h.le@dektech.com.au>\nLink: https://lore.kernel.org/r/20210108071337.3598-1-hoang.h.le@dektech.com.au\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "link.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 1033: \tstruct tipc_msg *hdr = buf_msg(skb_peek(list));",
        "// Line_Reference 1041: \tint imp = msg_importance(hdr);"
    ]
}
