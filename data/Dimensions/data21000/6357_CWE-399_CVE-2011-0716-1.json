{
    "cve_id": "CVE-2011-0716",
    "cve_description": "The br_multicast_add_group function in net/bridge/br_multicast.c in the Linux kernel before 2.6.38, when a certain Ethernet bridge configuration is used, allows local users to cause a denial of service (memory corruption and system crash) by sending IGMP packets to a local interface.",
    "cve_publish_date": "2012-06-21",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "bridge: Fix mglist corruption that leads to memory corruption\n\nThe list mp->mglist is used to indicate whether a multicast group\nis active on the bridge interface itself as opposed to one of the\nconstituent interfaces in the bridge.\n\nUnfortunately the operation that adds the mp->mglist node to the\nlist neglected to check whether it has already been added.  This\nleads to list corruption in the form of nodes pointing to itself.\n\nNormally this would be quite obvious as it would cause an infinite\nloop when walking the list.  However, as this list is never actually\nwalked (which means that we don't really need it, I'll get rid of\nit in a subsequent patch), this instead is hidden until we perform\na delete operation on the affected nodes.\n\nAs the same node may now be pointed to by more than one node, the\ndelete operations can then cause modification of freed memory.\n\nThis was observed in practice to cause corruption in 512-byte slabs,\nmost commonly leading to crashes in jbd2.\n\nThanks to Josef Bacik for pointing me in the right direction.\n\nReported-by: Ian Page Hands <ihands@redhat.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "br_multicast.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 722: \t\thlist_add_head(&mp->mglist, &br->mglist);"
    ]
}
