{
    "cve_id": "CVE-2021-30014",
    "cve_description": "There is a integer overflow in media_tools/av_parsers.c in the hevc_parse_slice_segment function in GPAC 1.0.1 which results in a crash.",
    "cve_publish_date": "2021-04-19",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "add safety in avc/hevc/vvc sps/pps/vps ID check - cf #1720 #1721 #1722",
    "type_of_change": "Modification",
    "filename_of_changes": "av_parsers.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 5118: \tif (sps_id >= 32) {",
        "// Line_Reference 5119: \t\treturn -1;",
        "// Line_Reference 5120: \t}",
        "// Line_Reference 5121: \tif (sps_id < 0) {",
        "// Line_Reference 5450: \tif (pps_id >= 255) {",
        "// Line_Reference 5458: \tif (pps->sps_id >= 32) {",
        "// Line_Reference 6846: \tif (pps_id >= 64)",
        "// Line_Reference 7669: \tif (vps_id >= 16) return -1;",
        "// Line_Reference 7898: \tif (vps_id >= 16) {",
        "// Line_Reference 8213: \tif (pps->sps_id >= 16) {",
        "// Line_Reference 9363: \tif (vps_id >= 16) return -1;",
        "// Line_Reference 9454: \tif (sps_id >= 16) {",
        "// Line_Reference 9458: \tif (vps_id >= 16) {",
        "// Line_Reference 9660: \tif (pps->sps_id >= 16) {",
        "// Line_Reference 9728: \tif (pps_id >= 64)"
    ]
}
