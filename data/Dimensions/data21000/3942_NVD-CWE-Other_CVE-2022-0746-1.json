{
    "cve_id": "CVE-2022-0746",
    "cve_description": "Business Logic Errors in GitHub repository dolibarr/dolibarr prior to 16.0.",
    "cve_publish_date": "2022-02-25",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Fix #hunterb812ea22-0c02-46fe-b89f-04519dfb1ebd",
    "type_of_change": "Modification",
    "filename_of_changes": "card.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 405: \t\t\t\t$object->login = GETPOST(\"login\", 'alphanohtml');",
        "// Line_Reference 409: \t\t\t\tif (!empty($user->admin)) {",
        "// Line_Reference 410: \t\t\t\t\t$object->admin = GETPOST(\"admin\", \"int\"); // admin flag can only be set/unset by an admin user. A test is also done later when forging sql request",
        "// Line_Reference 1859: \t\t\t\t\t\tprint '<div class=\"inline-block divButAction\"><a class=\"butAction\" href=\"'.$_SERVER['PHP_SELF'].'?id='.$object->id.'&amp;action=password\">'.$langs->trans(\"ReinitPassword\").'</a></div>';",
        "// Line_Reference 1867: \t\t\t\t\t\t\tprint '<div class=\"inline-block divButAction\"><a class=\"butAction\" href=\"'.$_SERVER['PHP_SELF'].'?id='.$object->id.'&amp;action=passwordsend\">'.$langs->trans(\"SendNewPassword\").'</a></div>';",
        "// Line_Reference 1882: \t\t\t\t\tprint '<div class=\"inline-block divButAction\"><a class=\"butActionDelete\" href=\"'.$_SERVER['PHP_SELF'].'?action=disable&id='.$object->id.'&token='.newToken().'\">'.$langs->trans(\"DisableUser\").'</a></div>';"
    ]
}
