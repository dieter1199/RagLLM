{
    "cve_id": "CVE-2013-10020",
    "cve_description": "A vulnerability, which was classified as problematic, was found in MMDeveloper A Forms Plugin up to 1.4.2 on WordPress. This affects an unknown part of the file a-forms.php. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.4.3 is able to address this issue. The identifier of the patch is 3e693197bd69b7173cc16d8d2e0a7d501a2a0b06. It is recommended to upgrade the affected component. The identifier VDB-222609 was assigned to this vulnerability.",
    "cve_publish_date": "2023-03-10",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed yet another issue with critical cross-site scripting. I've forced SiteLock to check and check, and I think its finally fixed.\n\ngit-svn-id: https://plugins.svn.wordpress.org/a-forms/trunk@758898 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "a-forms.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "50",
    "number_of_lines_deleted_vulnerable_to_cve": "54",
    "vulnerable_lines": [
        "// Line_Reference 23: Version: 1.4.2",
        "// Line_Reference 225:     update_option(\"aform_current_css_file\", esc_html($_POST[\"css_file_selection\"]));",
        "// Line_Reference 226:     echo(@file_get_contents(get_template_directory().\"/aforms_css/\".esc_html($_POST[\"css_file_selection\"])));",
        "// Line_Reference 234:   $section = tom_get_row_by_id(\"a_form_sections\", \"*\", \"ID\", esc_html($_POST[\"section_id\"]));",
        "// Line_Reference 235:   tom_insert_record(\"a_form_fields\", array(\"field_order\" => esc_html($_POST[\"field_order\"]), \"section_id\" => esc_html($_POST[\"section_id\"]), \"form_id\" => $section->form_id));",
        "// Line_Reference 283:   if (esc_html(tom_get_query_string_value(\"a_form_page\")) == \"fields\") {",
        "// Line_Reference 284:     if (esc_html($_GET[\"action\"]) == \"delete\") {",
        "// Line_Reference 292:     tom_update_record_by_id(\"a_form_sections\", array(\"section_order\" => esc_html($_POST[\"section_order\"])), \"ID\", esc_html($_POST[\"ID\"]));",
        "// Line_Reference 295:     tom_update_record_by_id(\"a_form_fields\", array(\"field_order\" => esc_html($_POST[\"field_order\"]), \"section_id\" => esc_html($_POST[\"section_id\"])), \"FID\", esc_html($_POST[\"FID\"]));",
        "// Line_Reference 312:       $action = esc_html($_POST[\"action\"]);",
        "// Line_Reference 331:     echo(\"<div class='updated below-h2'><p>\".esc_html($_GET[\"message\"]).\"</p></div>\");",
        "// Line_Reference 337:       $a_form = tom_get_row_by_id(\"a_form_forms\", \"*\", \"ID\", esc_html($_GET[\"id\"])); ?>",
        "// Line_Reference 350:     if (esc_html($_GET[\"action\"]) == \"new\") {",
        "// Line_Reference 420:     echo(\"<div class='updated below-h2'><p>\".esc_html($_GET[\"message\"]).\"</p></div>\");",
        "// Line_Reference 426:       $a_form = tom_get_row_by_id(\"a_form_sections\", \"*\", \"ID\", esc_html($_GET[\"id\"])); ?>",
        "// Line_Reference 437:     if (esc_html($_GET[\"action\"]) == \"new\") {",
        "// Line_Reference 587:   <?php if (esc_html(tom_get_query_string_value(\"id\")) != \"\") {",
        "// Line_Reference 588:     if (esc_html(tom_get_query_string_value(\"action\")) != \"view\") { ?>",
        "// Line_Reference 605:         $page_no = esc_html($_GET[\"a_form_tracks_page\"]);",
        "// Line_Reference 608:       $where_sql = \"form_id=\".esc_html($_GET[\"id\"]);",
        "// Line_Reference 609:       if (esc_html(tom_get_query_string_value(\"search_text\")) != \"\") {",
        "// Line_Reference 610:         $where_sql .= \" AND content LIKE '%\".esc_html($_POST[\"search_text\"]).\"%'\";",
        "// Line_Reference 613:       if ((esc_html(tom_get_query_string_value(\"search_date_from\")) != null) && (esc_html(tom_get_query_string_value(\"search_date_to\")) != null)) {",
        "// Line_Reference 614:         $where_sql .= \" AND (created_at BETWEEN '\".esc_html(tom_get_query_string_value(\"search_date_from\")).\" 00:00:00' AND '\".esc_html(tom_get_query_string_value(\"search_date_to\")).\" 23:59:59')\";",
        "// Line_Reference 615:       } else if (esc_html(tom_get_query_string_value(\"search_date_from\")) != null) {",
        "// Line_Reference 616:         $where_sql .= \" AND created_at > '\".esc_html(tom_get_query_string_value(\"search_date_from\")).\" 00:00:00'\";",
        "// Line_Reference 617:       } else if (esc_html(tom_get_query_string_value(\"search_date_to\")) != null) {",
        "// Line_Reference 618:         $where_sql .= \" AND created_at < '\".esc_html(tom_get_query_string_value(\"search_date_to\")).\" 23:59:59'\";",
        "// Line_Reference 622:       $fields = tom_get_results(\"a_form_fields\", \"*\", \"form_id=\".esc_html($_GET[\"id\"]), array());",
        "// Line_Reference 627:         tom_generate_datatable_pagination(\"a_form_tracks\", $total_tracks, $limit_clause, esc_html($_GET[\"a_form_tracks_page\"]), \"?page=a-forms/a-forms-tracking.php&action=show&id=\".esc_html($_GET[\"id\"]).\"&search_text=\".esc_html(tom_get_query_string_value(\"search_text\")).\"&search_date_from=\".esc_html(tom_get_query_string_value(\"search_date_from\")).\"&search_date_to=\".esc_html(tom_get_query_string_value(\"search_date_to\")), \"ASC\", \"top\");",
        "// Line_Reference 653:                   echo(preg_replace(\"/, $/\", \"\", $content));",
        "// Line_Reference 673:       echo \"<p><textarea rows='40' cols='160'>\".$view->content.\"</textarea></p>\";",
        "// Line_Reference 704:       $section_index = esc_html($_POST[\"send_a_form_section\"]);",
        "// Line_Reference 722:       foreach ($_POST as $key => $value) {",
        "// Line_Reference 723:         $_POST[$key] = esc_attr(esc_html($value));",
        "// Line_Reference 724:       }",
        "// Line_Reference 725: ",
        "// Line_Reference 734:         $attachment_urls = explode(\"::\", esc_html($_POST[\"a_form_attachment_urls\"]));",
        "// Line_Reference 747:             if (esc_html($_POST[$form_name.$field_name.\"_\".$i]) != \"\") {",
        "// Line_Reference 748:               $content = str_replace('\\\"', \"\\\"\", esc_html($_POST[$form_name.$field_name.\"_\".$i]));",
        "// Line_Reference 771:             if (esc_html($_POST[\"a_form_attachment_urls\"]) != \"\") {",
        "// Line_Reference 772:               $records = explode(\"::\", esc_html($_POST[\"a_form_attachment_urls\"]));",
        "// Line_Reference 783:           $content = str_replace('\\\"', \"\\\"\", esc_html($_POST[$form_name.$field_name]));",
        "// Line_Reference 806:               esc_html($_POST[aform_field_name($form, \"captcha_first_number\")])",
        "// Line_Reference 808:               esc_html($_POST[aform_field_name($form, \"captcha_second_number\")])",
        "// Line_Reference 810:             == esc_html($_POST[aform_field_name($form, \"captcha\")])",
        "// Line_Reference 825:         if (esc_html($_POST[\"action\"]) == \"Send\") {",
        "// Line_Reference 833:             $from_name = esc_html($_POST[$form_name.str_replace(\" \", \"_\", strtolower($row->field_label))]);",
        "// Line_Reference 837:             $user_email = esc_html($_POST[$form_name.str_replace(\" \", \"_\", strtolower($row->field_label))]);",
        "// Line_Reference 842:               $subject .= \" - \".esc_html($_POST[$form_name.str_replace(\" \", \"_\", strtolower($row->field_label))]);",
        "// Line_Reference 889:               tom_insert_record(\"a_form_tracks\", array(\"created_at\" => $current_datetime, \"form_id\" => esc_html($_POST[\"send_a_form\"]), \"content\" => $email_content, \"track_type\" => \"Successful Email\", \"referrer_url\" => $_SERVER[\"HTTP_REFERER\"], \"fields_array\" => serialize($field_values)));",
        "// Line_Reference 898:               tom_insert_record(\"a_form_tracks\", array(\"created_at\" => $current_datetime, \"form_id\" => esc_html($_POST[\"send_a_form\"]), \"content\" => \"Error Message: \".$mail_message.\".\\n\\nContent: \".$email_content, \"track_type\" => \"Failed Email\", \"referrer_url\" => $_SERVER[\"HTTP_REFERER\"], \"fields_array\" => serialize($field_values)));",
        "// Line_Reference 923:     if (esc_html($_POST[\"action\"]) == \"Next\") {",
        "// Line_Reference 930:     if (esc_html($_POST[\"action\"]) == \"Back\") {"
    ]
}
