{
    "cve_id": "CVE-2021-31294",
    "cve_description": "Redis before 6cbea7d allows a replica to cause an assertion failure in a primary server by sending a non-administrative command (specifically, a SET command). NOTE: this was fixed for Redis 6.2.x and 7.x in 2021. Versions before 6.2 were not intended to have safety guarantees related to this.",
    "cve_publish_date": "2023-07-15",
    "cwe_id": "CWE-617",
    "cwe_name": "Reachable Assertion",
    "cwe_description": "The product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.",
    "commit_message": "Prevent replicas from sending commands that interact with keyspace (#8868)\n\nThis solves an issue reported in #8712 in which a replica would bypass\r\nthe client write pause check and cause an assertion due to executing a\r\nwrite command during failover.\r\n\r\nThe fact is that we don't expect replicas to execute any command other\r\nthan maybe REPLCONF and PING, etc. but matching against the ADMIN\r\ncommand flag is insufficient, so instead i just block keyspace access\r\nfor now.",
    "type_of_change": "Modification",
    "filename_of_changes": "server.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 4197: \t  c->cmd->proc != resetCommand &&"
    ]
}
