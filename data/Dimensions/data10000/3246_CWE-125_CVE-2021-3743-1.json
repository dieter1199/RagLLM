{
    "cve_id": "CVE-2021-3743",
    "cve_description": "An out-of-bounds (OOB) memory read flaw was found in the Qualcomm IPC router protocol in the Linux kernel. A missing sanity check allows a local attacker to gain access to out-of-bounds memory, leading to a system crash or a leak of internal kernel information. The highest threat from this vulnerability is to system availability.",
    "cve_publish_date": "2022-03-04",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "net: qrtr: fix another OOB Read in qrtr_endpoint_post\n\nThis check was incomplete, did not consider size is 0:\n\n\tif (len != ALIGN(size, 4) + hdrlen)\n                    goto err;\n\nif size from qrtr_hdr is 0, the result of ALIGN(size, 4)\nwill be 0, In case of len == hdrlen and size == 0\nin header this check won't fail and\n\n\tif (cb->type == QRTR_TYPE_NEW_SERVER) {\n                /* Remote node endpoint can bridge other distant nodes */\n                const struct qrtr_ctrl_pkt *pkt = data + hdrlen;\n\n                qrtr_node_assign(node, le32_to_cpu(pkt->server.node));\n        }\n\nwill also read out of bound from data, which is hdrlen allocated block.\n\nFixes: 194ccc88297a (\"net: qrtr: Support decoding incoming v2 packets\")\nFixes: ad9d24c9429e (\"net: qrtr: fix OOB Read in qrtr_endpoint_post\")\nSigned-off-by: Xiaolong Huang <butterflyhuangxx@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "qrtr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 496: \tif (len != ALIGN(size, 4) + hdrlen)"
    ]
}
