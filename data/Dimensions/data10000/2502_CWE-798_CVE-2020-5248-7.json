{
    "cve_id": "CVE-2020-5248",
    "cve_description": "GLPI before before version 9.4.6 has a vulnerability involving a default encryption key. GLPIKEY is public and is used on every instance. This means anyone can decrypt sensitive data stored using this key. It is possible to change the key before installing GLPI. But on existing instances, data must be reencrypted with the new key. Problem is we can not know which columns or rows in the database are using that; espcially from plugins. Changing the key without updating data would lend in bad password sent from glpi; but storing them again from the UI will work.",
    "cve_publish_date": "2020-05-12",
    "cwe_id": "CWE-798",
    "cwe_name": "Use of Hard-coded Credentials",
    "cwe_description": "The product contains hard-coded credentials, such as a password or cryptographic key.",
    "commit_message": "Deprecate GLPIKEY usage\n\nCVE-2020-5248\n\nDeprecate GLPIKEY usage, and replace it with key file per instance.\nAdd a command to generate new key, and update database.\nAdd plugins hooks to register fields or configuration entries to be\nhandled when updating db.",
    "type_of_change": "Modification",
    "filename_of_changes": "mailcollector.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 61:                $input[\"passwd\"] = Toolbox::encrypt(stripslashes($input[\"passwd\"]), GLPIKEY);"
    ]
}
