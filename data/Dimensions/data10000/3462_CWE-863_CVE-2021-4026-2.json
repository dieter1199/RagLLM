{
    "cve_id": "CVE-2021-4026",
    "cve_description": "bookstack is vulnerable to Improper Access Control",
    "cve_publish_date": "2021-11-30",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Fixed related permissions query not considering drafts\n\nPage-related items added on drafts could be visible in certain scenarios\nsince the applied permissions query filters would not consider\npage draft visibility.\nThis commit alters queries on related items to apply such filtering.\n\nIncluded test to cover API scenario.\nThanks to @haxatron for reporting.",
    "type_of_change": "Modification",
    "filename_of_changes": "Handler.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 78:     protected function renderApiException(Exception $e): JsonResponse",
        "// Line_Reference 80:         $code = $e->getCode() === 0 ? 500 : $e->getCode();"
    ]
}
