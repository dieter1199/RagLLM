{
    "cve_id": "CVE-2022-25643",
    "cve_description": "seatd-launch in seatd 0.6.x before 0.6.4 allows removing files with escalated privileges when installed setuid root. The attack vector is a user-supplied socket pathname.",
    "cve_publish_date": "2022-02-24",
    "cwe_id": "CWE-668",
    "cwe_name": "Exposure of Resource to Wrong Sphere",
    "cwe_description": "The product exposes a resource to the wrong control sphere, providing unintended actors with inappropriate access to the resource.",
    "commit_message": "seatd-launch: Remove socket path command line arg\n\nThis should not need to be configured, so remove the argument. If\ndownstream prefers a different folder, the location can be made\ncompile-time configurable like for seatd itself.",
    "type_of_change": "Modification",
    "filename_of_changes": "seatd-launch.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 18: \t\t\t    \"  -h\t\tShow this help message\\n\"",
        "// Line_Reference 19: \t\t\t    \"  -s <path>\tWhere to create the seatd socket\\n\"",
        "// Line_Reference 20: \t\t\t    \"  -v\t\tShow the version number\\n\"",
        "// Line_Reference 24: \tchar *sockpath = NULL;",
        "// Line_Reference 25: \twhile ((c = getopt(argc, argv, \"vhs:\")) != -1) {",
        "// Line_Reference 27: \t\tcase 's':",
        "// Line_Reference 28: \t\t\tsockpath = optarg;",
        "// Line_Reference 29: \t\t\tbreak;",
        "// Line_Reference 50: \tchar sockbuf[256];",
        "// Line_Reference 51: \tif (sockpath == NULL) {",
        "// Line_Reference 52: \t\tsprintf(sockbuf, \"/tmp/seatd.%d.sock\", getpid());",
        "// Line_Reference 53: \t\tsockpath = sockbuf;",
        "// Line_Reference 54: \t}"
    ]
}
