{
    "cve_id": "CVE-2022-0820",
    "cve_description": "Cross-site Scripting (XSS) - Stored in GitHub repository orchardcms/orchardcore prior to 1.3.0.",
    "cve_publish_date": "2022-03-11",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fix missing permission checks and encoding. (#11344)",
    "type_of_change": "Modification",
    "filename_of_changes": "SeoContentDriver.cs",
    "code_language": "C#",
    "number_of_lines_added_for_mitigation": "51",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 31:             IShortcodeService shortcodeService",
        "// Line_Reference 65:                 _pageTitleBuilder.SetFixedTitle(new HtmlString(await RenderAsync(aspect.PageTitle, contentItem)));",
        "// Line_Reference 73:                     Content = await RenderAsync(aspect.MetaDescription, contentItem)",
        "// Line_Reference 82:                     Content = await RenderAsync(aspect.MetaKeywords, contentItem)",
        "// Line_Reference 100:                     Content = await RenderAsync(aspect.MetaRobots, contentItem)",
        "// Line_Reference 108:                     await RenderAsync(customMetaTag.Name, contentItem),",
        "// Line_Reference 109:                     await RenderAsync(customMetaTag.Property, contentItem),",
        "// Line_Reference 110:                     await RenderAsync(customMetaTag.Content, contentItem),",
        "// Line_Reference 111:                     await RenderAsync(customMetaTag.HttpEquiv, contentItem),",
        "// Line_Reference 112:                     await RenderAsync(customMetaTag.Charset, contentItem)));",
        "// Line_Reference 121:                     Content = await RenderAsync(aspect.OpenGraphType, contentItem)",
        "// Line_Reference 130:                     Content = await RenderAsync(aspect.OpenGraphTitle, contentItem)",
        "// Line_Reference 139:                     Content = await RenderAsync(aspect.OpenGraphDescription, contentItem)",
        "// Line_Reference 148:                     Content = await RenderAsync(aspect.OpenGraphImage, contentItem)",
        "// Line_Reference 157:                     Content = await RenderAsync(aspect.OpenGraphImageAlt, contentItem)",
        "// Line_Reference 166:                     Content = await RenderAsync(aspect.OpenGraphUrl, contentItem)",
        "// Line_Reference 175:                     Content = await RenderAsync(aspect.OpenGraphSiteName, contentItem)",
        "// Line_Reference 184:                     Content = await RenderAsync(aspect.OpenGraphAppId, contentItem)",
        "// Line_Reference 193:                     Content = await RenderAsync(aspect.OpenGraphLocale, contentItem)",
        "// Line_Reference 203:                     Content = await RenderAsync(aspect.TwitterCard, contentItem)",
        "// Line_Reference 212:                     Content = await RenderAsync(aspect.TwitterSite, contentItem)",
        "// Line_Reference 221:                     Content = await RenderAsync(aspect.TwitterTitle, contentItem)",
        "// Line_Reference 230:                     Content = await RenderAsync(aspect.TwitterDescription, contentItem)",
        "// Line_Reference 239:                     Content = await RenderAsync(aspect.TwitterImage, contentItem)",
        "// Line_Reference 248:                     Content = await RenderAsync(aspect.TwitterImageAlt, contentItem)",
        "// Line_Reference 257:                     Content = await RenderAsync(aspect.TwitterCreator, contentItem)",
        "// Line_Reference 266:                     Content = await RenderAsync(aspect.TwitterUrl, contentItem)",
        "// Line_Reference 272:                 _resourceManager.RegisterHeadScript(new HtmlString($\"<script type=\\\"application/ld+json\\\">\\n{aspect.GoogleSchema}\\n</script>\"));",
        "// Line_Reference 277: ",
        "// Line_Reference 278:         private ValueTask<string> RenderAsync(string template, ContentItem contentItem)",
        "// Line_Reference 279:             => _shortcodeService.ProcessAsync(template,",
        "// Line_Reference 280:                     new Context",
        "// Line_Reference 281:                     {",
        "// Line_Reference 282:                         [\"ContentItem\"] = contentItem",
        "// Line_Reference 283:                     });"
    ]
}
