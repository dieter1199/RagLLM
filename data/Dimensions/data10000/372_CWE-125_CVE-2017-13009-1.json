{
    "cve_id": "CVE-2017-13009",
    "cve_description": "The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-13009/IPv6 mobility: Add a bounds check.\n\nThis fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.\n\nAdd a test using the capture file supplied by the reporter(s).\n\nWhile we're at it:\n\nAdd a comment giving the RFC for IPv6 mobility headers.\n\nClean up some bounds checks to make it clearer what they're checking, by\nmatching the subsequent EXTRACT_ calls or memcpy.\n\nFor the binding update, if none of the flag bits are set, don't check\nthe individual flag bits.",
    "type_of_change": "Modification",
    "filename_of_changes": "print-mobility.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 244: \t\t\tND_TCHECK2(*mh, hlen + 8);",
        "// Line_Reference 258: \t\t\tND_TCHECK2(*mh, hlen + 8);",
        "// Line_Reference 266: \t\t\tND_TCHECK2(*mh, hlen + 8);",
        "// Line_Reference 278: \t\tND_TCHECK2(*mh, hlen + 1);",
        "// Line_Reference 279: \t\tif (bp[hlen] & 0xf0)",
        "// Line_Reference 281: \t\tif (bp[hlen] & 0x80)",
        "// Line_Reference 282: \t\t\tND_PRINT((ndo, \"A\"));",
        "// Line_Reference 283: \t\tif (bp[hlen] & 0x40)",
        "// Line_Reference 284: \t\t\tND_PRINT((ndo, \"H\"));",
        "// Line_Reference 285: \t\tif (bp[hlen] & 0x20)",
        "// Line_Reference 286: \t\t\tND_PRINT((ndo, \"L\"));",
        "// Line_Reference 287: \t\tif (bp[hlen] & 0x10)",
        "// Line_Reference 288: \t\t\tND_PRINT((ndo, \"K\"));",
        "// Line_Reference 293: \t\tND_TCHECK2(*mh, hlen + 2);",
        "// Line_Reference 305: \t\tND_TCHECK2(*mh, hlen + 2);",
        "// Line_Reference 308: \t\tND_TCHECK2(*mh, hlen + 2);",
        "// Line_Reference 318: \t\tND_TCHECK2(*mh, hlen + 16);"
    ]
}
