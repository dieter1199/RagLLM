{
    "cve_id": "CVE-2021-3917",
    "cve_description": "A flaw was found in the coreos-installer, where it writes the Ignition config to the target system with world-readable access permissions. This flaw allows a local attacker to have read access to potentially sensitive data. The highest threat from this vulnerability is to confidentiality.",
    "cve_publish_date": "2022-08-23",
    "cwe_id": "CWE-276",
    "cwe_name": "Incorrect Default Permissions",
    "cwe_description": "During installation, installed file permissions are set to allow anyone to modify those files.",
    "commit_message": "install: restrict access permissions on /boot/ignition{,/config.ign}\n\nThe Ignition config may contain secrets.  Don't expose it, or anything in\nits parent directory, to unprivileged processes.\n\nhttps://github.com/coreos/fedora-coreos-tracker/issues/889",
    "type_of_change": "Modification",
    "filename_of_changes": "install.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 19: use std::fs::{copy as fscopy, create_dir_all, read_dir, File, OpenOptions};",
        "// Line_Reference 21: use std::os::unix::fs::FileTypeExt;",
        "// Line_Reference 251:     create_dir_all(&config_dest).context(\"creating Ignition config directory\")?;"
    ]
}
