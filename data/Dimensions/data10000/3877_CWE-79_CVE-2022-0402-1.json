{
    "cve_id": "CVE-2022-0402",
    "cve_description": "The Super Forms - Drag & Drop Form Builder WordPress plugin before 6.0.4 does not escape the bob_czy_panstwa_sprawa_zostala_rozwiazana parameter before outputting it back in an attribute via the super_language_switcher AJAX action, leading to a Reflected Cross-Site Scripting. The action is also lacking CSRF, making the attack easier to perform against any user.",
    "cve_publish_date": "2024-01-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fix PHP parse error",
    "type_of_change": "Modification",
    "filename_of_changes": "class-ajax.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 45:             'upload_files'                    => true,",
        "// Line_Reference 46:             'submit_form'                    => true,",
        "// Line_Reference 115: ",
        "// Line_Reference 361:             'i18n' => sanitize_text_field($_POST['i18n']),",
        "// Line_Reference 362:             'parameters' => $_POST['parameters']",
        "// Line_Reference 367:         $translations = SUPER_Common::get_form_translations($atts['id']);",
        "// Line_Reference 368:         if(is_array($translations)){",
        "// Line_Reference 369:             if( !empty($translations[$atts['i18n']]) && !empty($translations[$atts['i18n']]['rtl']) ){",
        "// Line_Reference 370:                 if($translations[$atts['i18n']]['rtl']=='true'){",
        "// Line_Reference 371:                     $rtl = true;",
        "// Line_Reference 372:                 }",
        "// Line_Reference 2411:         // Temporarily deprecated till found a solution with caching plugins",
        "// Line_Reference 2412:         // // @since 4.6.0 - Check if ajax request is valid based on nonce field",
        "// Line_Reference 2413:         // if ( !wp_verify_nonce( $_POST['super_ajax_nonce'], 'super_submit_' . $form_id ) ) {",
        "// Line_Reference 2414:         //     SUPER_Common::output_message(",
        "// Line_Reference 2415:         //         $error = true,",
        "// Line_Reference 2416:         //         esc_html__( 'Failed to verify nonce! You either do not have permission to submit this form or caching is enabled. If caching is enabled make sure to exclude this page from being cached.', 'super-forms' )",
        "// Line_Reference 2417:         //     );",
        "// Line_Reference 2418:         // }",
        "// Line_Reference 2419:         // check_ajax_referer( 'super_submit_' . $form_id, 'super_ajax_nonce' );",
        "// Line_Reference 2420: "
    ]
}
