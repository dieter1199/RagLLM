{
    "cve_id": "CVE-2022-1723",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository jgraph/drawio prior to 18.0.6.",
    "cve_publish_date": "2022-05-17",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "18.0.6 release",
    "type_of_change": "Modification",
    "filename_of_changes": "integrate.min.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 471: window.STYLE_PATH=window.STYLE_PATH||\"styles\";window.CSS_PATH=window.CSS_PATH||\"styles\";window.OPEN_FORM=window.OPEN_FORM||\"open.html\";window.mxBasePath=window.mxBasePath||\"mxgraph\";window.mxImageBasePath=window.mxImageBasePath||\"mxgraph/images\";window.mxLanguage=window.mxLanguage||urlParams.lang;window.mxLanguages=window.mxLanguages||[\"de\",\"se\"];var mxClient={VERSION:\"18.0.5\",IS_IE:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"MSIE\"),IS_IE11:null!=navigator.userAgent&&!!navigator.userAgent.match(/Trident\\/7\\./),IS_EDGE:null!=navigator.userAgent&&!!navigator.userAgent.match(/Edge\\//),IS_EM:\"spellcheck\"in document.createElement(\"textarea\")&&8==document.documentMode,VML_PREFIX:\"v\",OFFICE_PREFIX:\"o\",IS_NS:null!=navigator.userAgent&&0<=navigator.userAgent.indexOf(\"Mozilla/\")&&0>navigator.userAgent.indexOf(\"MSIE\")&&0>navigator.userAgent.indexOf(\"Edge/\"),",
        "// Line_Reference 2870: Graph.sanitizeHtml=function(a,c){return DOMPurify.sanitize(a,{ADD_ATTR:[\"target\"],FORBID_TAGS:[\"form\"],ALLOWED_URI_REGEXP:/^(?:(?:https?|mailto|tel|callto|data):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i})};Graph.sanitizeSvg=function(a){return DOMPurify.sanitize(a,{IN_PLACE:!0})};",
        "// Line_Reference 2871: Graph.clipSvgDataUri=function(a,c){if(!mxClient.IS_IE&&!mxClient.IS_IE11&&null!=a&&\"data:image/svg+xml;base64,\"==a.substring(0,26))try{var f=document.createElement(\"div\");f.style.position=\"absolute\";f.style.visibility=\"hidden\";var e=decodeURIComponent(escape(atob(a.substring(26)))),g=e.indexOf(\"<svg\");if(0<=g){f.innerHTML=e.substring(g);Graph.sanitizeSvg(f);var d=f.getElementsByTagName(\"svg\");if(0<d.length){if(c||null!=d[0].getAttribute(\"preserveAspectRatio\")){document.body.appendChild(f);try{e=c=",
        "// Line_Reference 2872: 1;var k=d[0].getAttribute(\"width\"),n=d[0].getAttribute(\"height\");k=null!=k&&\"%\"!=k.charAt(k.length-1)?parseFloat(k):NaN;n=null!=n&&\"%\"!=n.charAt(n.length-1)?parseFloat(n):NaN;var u=d[0].getAttribute(\"viewBox\");if(null!=u&&!isNaN(k)&&!isNaN(n)){var m=u.split(\" \");4<=u.length&&(c=parseFloat(m[2])/k,e=parseFloat(m[3])/n)}var r=d[0].getBBox();0<r.width&&0<r.height&&(f.getElementsByTagName(\"svg\")[0].setAttribute(\"viewBox\",r.x+\" \"+r.y+\" \"+r.width+\" \"+r.height),f.getElementsByTagName(\"svg\")[0].setAttribute(\"width\",",
        "// Line_Reference 2900: Graph.prototype.openLink=function(a,c,f){var e=window;try{if(\"_self\"==c&&window!=window.top)window.location.href=a;else if(a.substring(0,this.baseUrl.length)==this.baseUrl&&\"#\"==a.charAt(this.baseUrl.length)&&\"_top\"==c&&window==window.top){var g=a.split(\"#\")[1];window.location.hash==\"#\"+g&&(window.location.hash=\"\");window.location.hash=g}else e=window.open(a,null!=c?c:\"_blank\"),null==e||f||(e.opener=null)}catch(d){}return e};",
        "// Line_Reference 3219: null);mxEvent.consume(G)})))}if(null!=z)for(B=0;B<z.length;B++){var D=document.createElement(\"div\");D.style.marginTop=null!=t||0<B?\"6px\":\"0px\";D.appendChild(this.graph.createLinkForHint(z[B].getAttribute(\"href\"),mxUtils.getTextContent(z[B])));this.linkHint.appendChild(D)}}}catch(G){}};mxEdgeHandler.prototype.updateLinkHint=mxVertexHandler.prototype.updateLinkHint;var Xa=mxEdgeHandler.prototype.init;mxEdgeHandler.prototype.init=function(){Xa.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,",
        "// Line_Reference 3220: function(){return this.state.view.graph.connectionHandler.isEnabled()});var t=mxUtils.bind(this,function(){null!=this.linkHint&&(this.linkHint.style.display=1==this.graph.getSelectionCount()?\"\":\"none\");null!=this.labelShape&&(this.labelShape.node.style.display=this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells?\"\":\"none\")});this.changeHandler=mxUtils.bind(this,function(D,G){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell),this.graph.getLinksForState(this.state));",
        "// Line_Reference 3221: t();this.redrawHandles()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.changeHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);var z=this.graph.getLinkForCell(this.state.cell),B=this.graph.getLinksForState(this.state);if(null!=z||null!=B&&0<B.length)this.updateLinkHint(z,B),this.redrawHandles()};var Ya=mxConnectionHandler.prototype.init;mxConnectionHandler.prototype.init=function(){Ya.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,",
        "// Line_Reference 3222: function(){return this.graph.connectionHandler.isEnabled()})};var bb=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){if(null!=this.moveHandles)for(var t=0;t<this.moveHandles.length;t++)this.moveHandles[t].style.left=this.moveHandles[t].rowState.x+this.moveHandles[t].rowState.width-5+\"px\",this.moveHandles[t].style.top=this.moveHandles[t].rowState.y+this.moveHandles[t].rowState.height/2-6+\"px\";if(null!=this.cornerHandles){t=this.getSelectionBorderInset();var z=",
        "// Line_Reference 3223: this.cornerHandles,B=z[0].bounds.height/2;z[0].bounds.x=this.state.x-z[0].bounds.width/2+t;z[0].bounds.y=this.state.y-B+t;z[0].redraw();z[1].bounds.x=z[0].bounds.x+this.state.width-2*t;z[1].bounds.y=z[0].bounds.y;z[1].redraw();z[2].bounds.x=z[0].bounds.x;z[2].bounds.y=this.state.y+this.state.height-2*t;z[2].redraw();z[3].bounds.x=z[1].bounds.x;z[3].bounds.y=z[2].bounds.y;z[3].redraw();for(t=0;t<this.cornerHandles.length;t++)this.cornerHandles[t].node.style.display=1==this.graph.getSelectionCount()?",
        "// Line_Reference 11697: (function(){var b=new mxObjectCodec(new ChangeGridColor,[\"ui\"]);b.beforeDecode=function(f,l,d){d.ui=f.ui;return l};mxCodecRegistry.register(b)})();(function(){EditorUi.VERSION=\"18.0.5\";EditorUi.compactUi=\"atlas\"!=uiTheme;Editor.isDarkMode()&&(mxGraphView.prototype.gridColor=mxGraphView.prototype.defaultDarkGridColor);EditorUi.enableLogging=\"1\"!=urlParams.stealth&&\"1\"!=urlParams.lockdown&&(/.*\\.draw\\.io$/.test(window.location.hostname)||/.*\\.diagrams\\.net$/.test(window.location.hostname))&&\"support.draw.io\"!=window.location.hostname;EditorUi.drawHost=window.DRAWIO_BASE_URL;EditorUi.lightboxHost=window.DRAWIO_LIGHTBOX_URL;EditorUi.lastErrorMessage="
    ]
}
