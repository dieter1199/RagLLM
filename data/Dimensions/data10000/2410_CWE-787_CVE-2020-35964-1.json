{
    "cve_id": "CVE-2020-35964",
    "cve_description": "track_header in libavformat/vividas.c in FFmpeg 4.3.1 has an out-of-bounds write because of incorrect extradata packing.",
    "cve_publish_date": "2021-01-03",
    "cwe_id": "CWE-787",
    "cwe_name": "Out-of-bounds Write",
    "cwe_description": "The product writes data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "avformat/vividas: improve extradata packing checks in track_header()\n\nFixes: out of array accesses\nFixes: 26622/clusterfuzz-testcase-minimized-ffmpeg_dem_VIVIDAS_fuzzer-6581200338288640\n\nFound-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "vividas.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 382:             int xd_size = 0;",
        "// Line_Reference 396:                 xd_size += len;",
        "// Line_Reference 399:             ret = ff_alloc_extradata(st->codecpar, 64 + xd_size + xd_size / 255);",
        "// Line_Reference 408:                 if (delta > data_len[j]) {",
        "// Line_Reference 409:                     return AVERROR_INVALIDDATA;",
        "// Line_Reference 410:                 }"
    ]
}
