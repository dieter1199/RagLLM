{
    "cve_id": "CVE-2022-2566",
    "cve_description": "A heap out-of-bounds memory write exists in FFMPEG since version 5.1. The size calculation in `build_open_gop_key_points()` goes through all entries in the loop and adds `sc->ctts_data[i].count` to `sc->sample_offsets_count`. This can lead to an integer overflow resulting in a small allocation with `av_calloc()`. An attacker can cause remote code execution via a malicious mp4 file. We recommend upgrading past commit c953baa084607dd1d84c3bfcce3cf6a87c3e6e05",
    "cve_publish_date": "2022-09-23",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "avformat/mov: Check count sums in build_open_gop_key_points()\n\nFixes: ffmpeg.md\nFixes: Out of array access\nFixes: CVE-2022-2566\n\nFound-by: Andy Nguyen <theflow@google.com>\nFound-by: 3pvd <3pvd@google.com>\nReviewed-by: Andy Nguyen <theflow@google.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "mov.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 3970:     for (uint32_t i = 0; i < sc->ctts_count; i++)",
        "// Line_Reference 3990:         if (sc->sync_group[i].index == cra_index)"
    ]
}
