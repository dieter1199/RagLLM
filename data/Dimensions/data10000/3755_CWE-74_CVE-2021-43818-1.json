{
    "cve_id": "CVE-2021-43818",
    "cve_description": "lxml is a library for processing XML and HTML in the Python language. Prior to version 4.6.5, the HTML Cleaner in lxml.html lets certain crafted script content pass through, as well as script content in SVG files embedded using data URIs. Users that employ the HTML cleaner in a security relevant context should upgrade to lxml 4.6.5 to receive a patch. There are no known workarounds available.",
    "cve_publish_date": "2021-12-13",
    "cwe_id": "CWE-74",
    "cwe_name": "Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')",
    "cwe_description": "The product constructs all or part of a command, data structure, or record using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify how it is parsed or interpreted when it is sent to a downstream component.",
    "commit_message": "Cleaner: Remove SVG image data URLs since they can embed script content.\n\nReported as GHSL-2021-1038",
    "type_of_change": "Modification",
    "filename_of_changes": "clean.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 78: _is_image_dataurl = re.compile(",
        "// Line_Reference 79:     r'^data:image/.+;base64', re.I).search",
        "// Line_Reference 81:     r'(?:javascript|jscript|livescript|vbscript|data|about|mocha):',",
        "// Line_Reference 82:     re.I).search",
        "// Line_Reference 84:     if _is_image_dataurl(s):",
        "// Line_Reference 85:         return None",
        "// Line_Reference 86:     return _is_possibly_malicious_scheme(s)",
        "// Line_Reference 89: # FIXME: should data: be blocked?"
    ]
}
