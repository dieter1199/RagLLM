{
    "cve_id": "CVE-2021-21243",
    "cve_description": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, a Kubernetes REST endpoint exposes two methods that deserialize untrusted data from the request body. These endpoints do not enforce any authentication or authorization checks. This issue may lead to pre-auth RCE. This issue was fixed in 4.0.3 by not using deserialization at KubernetesResource side.",
    "cve_publish_date": "2021-01-15",
    "cwe_id": "CWE-502",
    "cwe_name": "Deserialization of Untrusted Data",
    "cwe_description": "The product deserializes untrusted data without sufficiently verifying that the resulting data will be valid.",
    "commit_message": "Do not deserialize data from job nodes in Kubernetes resource to avoid\nsecurity vulnerability",
    "type_of_change": "Modification",
    "filename_of_changes": "KubernetesResource.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 76:     public byte[] allocateJobCaches(byte[] cacheAllocationRequestBytes) {",
        "// Line_Reference 77: \t\tCacheAllocationRequest allocationRequest = (CacheAllocationRequest) SerializationUtils",
        "// Line_Reference 78: \t\t\t\t.deserialize(cacheAllocationRequestBytes);",
        "// Line_Reference 80: \t\t\t\tgetJobToken(), allocationRequest.getCurrentTime(), allocationRequest.getInstances()));",
        "// Line_Reference 86: \tpublic void reportJobCaches(byte[] cacheInstanceBytes) {",
        "// Line_Reference 87: \t\t@SuppressWarnings(\"unchecked\")",
        "// Line_Reference 88: \t\tCollection<CacheInstance> cacheInstances = (Collection<CacheInstance>) SerializationUtils",
        "// Line_Reference 89: \t\t\t\t.deserialize(cacheInstanceBytes);"
    ]
}
