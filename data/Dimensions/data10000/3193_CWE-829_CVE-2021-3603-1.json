{
    "cve_id": "CVE-2021-3603",
    "cve_description": "PHPMailer 6.4.1 and earlier contain a vulnerability that can result in untrusted code being called (if such code is injected into the host project's scope by other means). If the $patternselect parameter to validateAddress() is set to 'php' (the default, defined by PHPMailer::$validator), and the global namespace contains a function called php, it will be called in preference to the built-in validator of the same name. Mitigated in PHPMailer 6.5.0 by denying the use of simple strings as validator function names.",
    "cve_publish_date": "2021-06-17",
    "cwe_id": "CWE-829",
    "cwe_name": "Inclusion of Functionality from Untrusted Control Sphere",
    "cwe_description": "The product imports, requires, or includes executable functionality (such as a library) from a source that is outside of the intended control sphere.",
    "commit_message": "Deny string-based callables altogether",
    "type_of_change": "Modification",
    "filename_of_changes": "PHPMailer.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1340:         //Don't allow overriding built-in validators with callables",
        "// Line_Reference 1341:         if (",
        "// Line_Reference 1342:             is_callable($patternselect) &&",
        "// Line_Reference 1343:             //It's callable and not a string, or it's a string callable that's not a built-in pattern",
        "// Line_Reference 1344:             (!is_string($patternselect) || !in_array(strtolower($patternselect), ['php', 'pcre', 'pcre8', 'html5']))",
        "// Line_Reference 1345:         ) {"
    ]
}
