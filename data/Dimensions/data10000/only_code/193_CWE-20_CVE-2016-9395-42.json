*
typedef struct {
size_t max_size;
} jpg_dec_importopts_t;
typedef enum {
OPT_MAXSIZE,
} optid_t;
{OPT_MAXSIZE, "max_size"},
opts->max_size = 0;
opts->max_size = atoi(jas_tvparser_getval(tvp));
size_t size;
if (opts.max_size) {
if (!jas_safe_size_mul(cinfo.output_width, cinfo.output_height,
&size) ||
!jas_safe_size_mul(size, cinfo.output_components, &size)) {
goto error;
}
if (size > opts.max_size) {
jas_eprintf("image is too large\n");
goto error;
}
}
