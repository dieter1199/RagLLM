{
    "cve_id": "CVE-2022-1285",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository gogs/gogs prior to 0.12.8.",
    "cve_publish_date": "2022-06-01",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "webhook: revalidate local hostname before each delivery (#6988)",
    "type_of_change": "Modification",
    "filename_of_changes": "webhook.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 122: func validateWebhook(actor *db.User, l macaron.Locale, w *db.Webhook) (field, msg string, ok bool) {",
        "// Line_Reference 123: \tif !actor.IsAdmin {",
        "// Line_Reference 124: \t\t// ðŸš¨ SECURITY: Local addresses must not be allowed by non-admins to prevent SSRF,",
        "// Line_Reference 125: \t\t// see https://github.com/gogs/gogs/issues/5366 for details.",
        "// Line_Reference 126: \t\tpayloadURL, err := url.Parse(w.URL)",
        "// Line_Reference 127: \t\tif err != nil {",
        "// Line_Reference 128: \t\t\treturn \"PayloadURL\", l.Tr(\"repo.settings.webhook.err_cannot_parse_payload_url\", err), false",
        "// Line_Reference 129: \t\t}",
        "// Line_Reference 130: ",
        "// Line_Reference 131: \t\tif netutil.IsLocalHostname(payloadURL.Hostname(), conf.Security.LocalNetworkAllowlist) {",
        "// Line_Reference 132: \t\t\treturn \"PayloadURL\", l.Tr(\"repo.settings.webhook.err_cannot_use_local_addresses\"), false",
        "// Line_Reference 133: \t\t}",
        "// Line_Reference 147: \tfield, msg, ok := validateWebhook(c.User, c.Locale, w)",
        "// Line_Reference 351: \tfield, msg, ok := validateWebhook(c.User, c.Locale, w)"
    ]
}
