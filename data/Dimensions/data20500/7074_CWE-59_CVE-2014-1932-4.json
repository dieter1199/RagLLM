{
    "cve_id": "CVE-2014-1932",
    "cve_description": "The (1) load_djpeg function in JpegImagePlugin.py, (2) Ghostscript function in EpsImagePlugin.py, (3) load function in IptcImagePlugin.py, and (4) _copy function in Image.py in Python Image Library (PIL) 1.1.7 and earlier and Pillow before 2.3.1 do not properly create temporary files, which allow local users to overwrite arbitrary files and obtain sensitive information via a symlink attack on the temporary file.",
    "cve_publish_date": "2014-04-17",
    "cwe_id": "CWE-59",
    "cwe_name": "Improper Link Resolution Before File Access ('Link Following')",
    "cwe_description": "The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",
    "commit_message": "Removed tempfile.mktemp, fixes CVE-2014-1932 CVE-2014-1933, debian bug #737059",
    "type_of_change": "Modification",
    "filename_of_changes": "JpegImagePlugin.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 347:         file = tempfile.mktemp()",
        "// Line_Reference 348:         os.system(\"djpeg %s >%s\" % (self.filename, file))",
        "// Line_Reference 351:             self.im = Image.core.open_ppm(file)",
        "// Line_Reference 353:             try: os.unlink(file)"
    ]
}
