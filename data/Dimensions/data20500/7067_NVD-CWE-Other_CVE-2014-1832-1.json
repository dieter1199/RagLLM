{
    "cve_id": "CVE-2014-1832",
    "cve_description": "Phusion Passenger 4.0.37 allows local users to write to certain files and directories via a symlink attack on (1) control_process.pid or a (2) generation-* file.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2014-1831.",
    "cve_publish_date": "2015-02-19",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Fix a symlink-related security vulnerability.\n\nThe fix in commit 34b10878 and contained a small attack time window in\nbetween two filesystem operations. This has been fixed.",
    "type_of_change": "Modification",
    "filename_of_changes": "ServerInstanceDir.h",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "22",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 3:  *  Copyright (c) 2010-2013 Phusion",
        "// Line_Reference 216: \t\t\tswitch (getFileTypeNoFollowSymlinks(path)) {",
        "// Line_Reference 217: \t\t\tcase FT_NONEXISTANT:",
        "// Line_Reference 219: \t\t\t\tbreak;",
        "// Line_Reference 220: \t\t\tcase FT_DIRECTORY:",
        "// Line_Reference 221: \t\t\t\tverifyDirectoryPermissions(path);",
        "// Line_Reference 222: \t\t\t\tbreak;",
        "// Line_Reference 223: \t\t\tdefault:",
        "// Line_Reference 224: \t\t\t\tthrow RuntimeException(\"'\" + path + \"' already exists, and is not a directory\");",
        "// Line_Reference 226: \t\t} else if (getFileType(path) != FT_DIRECTORY) {",
        "// Line_Reference 262: \tvoid verifyDirectoryPermissions(const string &path) {",
        "// Line_Reference 264: \t\tstruct stat buf;",
        "// Line_Reference 266: \t\tif (stat(path.c_str(), &buf) == -1) {",
        "// Line_Reference 267: \t\t\tint e = errno;",
        "// Line_Reference 268: \t\t\tthrow FileSystemException(\"Cannot stat() \" + path, e, path);",
        "// Line_Reference 269: \t\t} else if (buf.st_mode != (S_IFDIR | parseModeString(\"u=rwx,g=rx,o=rx\"))) {"
    ]
}
