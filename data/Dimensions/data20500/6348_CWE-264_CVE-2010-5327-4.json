{
    "cve_id": "CVE-2010-5327",
    "cve_description": "Liferay Portal through 6.2.10 allows remote authenticated users to execute arbitrary shell commands via a crafted Velocity template.",
    "cve_publish_date": "2017-01-13",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "LPS-27741 Add security by plugin context execution to template engines\n\n- We have to initialize/destroy a new template context specific to each plugin (keyed by ClassLoader of the plugin)\n- Add/Replaced helper utilities to support classloading control (and access to classes/packages) within templates",
    "type_of_change": "Modification",
    "filename_of_changes": "VelocityManager.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "100",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 78: \t\tif (templateContextType.equals(TemplateContextType.EMPTY)) {",
        "// Line_Reference 145: \t\textendedProperties.setProperty(_RESOURCE_LOADER, \"string,servlet\");",
        "// Line_Reference 148: \t\t\t\"string.\" + _RESOURCE_LOADER + \".cache\",",
        "// Line_Reference 149: \t\t\tString.valueOf(",
        "// Line_Reference 150: \t\t\t\tPropsValues.VELOCITY_ENGINE_RESOURCE_MANAGER_CACHE_ENABLED));",
        "// Line_Reference 153: \t\t\t\"string.\" + _RESOURCE_LOADER + \".class\",",
        "// Line_Reference 154: \t\t\tStringResourceLoader.class.getName());",
        "// Line_Reference 157: \t\t\t\"string.\" + _RESOURCE_LOADER + \".repository.class\",",
        "// Line_Reference 158: \t\t\tStringResourceRepositoryImpl.class.getName());",
        "// Line_Reference 161: \t\t\t\"servlet.\" + _RESOURCE_LOADER + \".cache\",",
        "// Line_Reference 166: \t\t\t\"servlet.\" + _RESOURCE_LOADER + \".class\",",
        "// Line_Reference 191: \t\textendedProperties.setProperty(",
        "// Line_Reference 192: \t\t\tVelocityEngine.RUNTIME_LOG_LOGSYSTEM_CLASS,",
        "// Line_Reference 193: \t\t\tPropsUtil.get(PropsKeys.VELOCITY_ENGINE_LOGGER));",
        "// Line_Reference 194: ",
        "// Line_Reference 195: \t\textendedProperties.setProperty(",
        "// Line_Reference 196: \t\t\tVelocityEngine.RUNTIME_LOG_LOGSYSTEM + \".log4j.category\",",
        "// Line_Reference 197: \t\t\tPropsUtil.get(PropsKeys.VELOCITY_ENGINE_LOGGER_CATEGORY));",
        "// Line_Reference 198: ",
        "// Line_Reference 232: \tprivate static final String _RESOURCE_LOADER =",
        "// Line_Reference 233: \t\tVelocityEngine.RESOURCE_LOADER;",
        "// Line_Reference 234: "
    ]
}
