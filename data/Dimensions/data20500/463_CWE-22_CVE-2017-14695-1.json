{
    "cve_id": "CVE-2017-14695",
    "cve_description": "Directory traversal vulnerability in minion id validation in SaltStack Salt before 2016.3.8, 2016.11.x before 2016.11.8, and 2017.7.x before 2017.7.2 allows remote minions with incorrect credentials to authenticate to a master via a crafted minion ID.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2017-12791.",
    "cve_publish_date": "2017-10-24",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Don't allow path separators in minion ID",
    "type_of_change": "Modification",
    "filename_of_changes": "verify.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 483: def clean_id(id_):",
        "// Line_Reference 484:     '''",
        "// Line_Reference 485:     Returns if the passed id is clean.",
        "// Line_Reference 486:     '''",
        "// Line_Reference 487:     if re.search(r'\\.\\.\\{sep}'.format(sep=os.sep), id_):",
        "// Line_Reference 488:         return False",
        "// Line_Reference 489:     return True",
        "// Line_Reference 490: ",
        "// Line_Reference 491: ",
        "// Line_Reference 497:         return bool(clean_path(opts['pki_dir'], id_)) and clean_id(id_)",
        "// Line_Reference 498:     except (AttributeError, KeyError, TypeError) as e:"
    ]
}
