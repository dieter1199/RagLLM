{
    "cve_id": "CVE-2024-4287",
    "cve_description": "In mintplex-labs/anything-llm, a vulnerability exists due to improper input validation in the workspace update process. Specifically, the application fails to validate or format JSON data sent in an HTTP POST request to `/api/workspace/:workspace-slug/update`, allowing it to be executed as part of a database query without restrictions. This flaw enables users with a manager role to craft a request that includes nested write operations, effectively allowing them to create new Administrator accounts.",
    "cve_publish_date": "2024-05-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Enable per-workspace provider/model combination (#1042)\n\n* Enable per-workspace provider/model combination\r\n\r\n* cleanup\r\n\r\n* remove resetWorkspaceChatModels and wipeWorkspaceModelPreference to prevent workspace from resetting model\r\n\r\n* add space\r\n\r\n---------\r\n\r\nCo-authored-by: shatfield4 <seanhatfield5@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "index.jsx",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 20:       <div className=\"flex flex-col w-60\">",
        "// Line_Reference 21:         <label className=\"text-white text-sm font-semibold block mb-4\">",
        "// Line_Reference 22:           Chat Model Selection",
        "// Line_Reference 23:         </label>",
        "// Line_Reference 24:         <select",
        "// Line_Reference 25:           name=\"GroqModelPref\"",
        "// Line_Reference 26:           defaultValue={settings?.GroqModelPref || \"llama2-70b-4096\"}",
        "// Line_Reference 27:           required={true}",
        "// Line_Reference 28:           className=\"bg-zinc-900 border-gray-500 text-white text-sm rounded-lg block w-full p-2.5\"",
        "// Line_Reference 29:         >",
        "// Line_Reference 30:           {[\"llama2-70b-4096\", \"mixtral-8x7b-32768\"].map((model) => {",
        "// Line_Reference 31:             return (",
        "// Line_Reference 32:               <option key={model} value={model}>",
        "// Line_Reference 33:                 {model}",
        "// Line_Reference 34:               </option>",
        "// Line_Reference 35:             );",
        "// Line_Reference 36:           })}",
        "// Line_Reference 37:         </select>",
        "// Line_Reference 38:       </div>"
    ]
}
