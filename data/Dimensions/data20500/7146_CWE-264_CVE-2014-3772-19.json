{
    "cve_id": "CVE-2014-3772",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via a request to index.php followed by a direct request to a file that calls the session_start function before checking the CPM key, as demonstrated by a request to sources/upload/upload.files.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "2.1.20",
    "type_of_change": "Modification",
    "filename_of_changes": "folders.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "81",
    "number_of_lines_deleted_vulnerable_to_cve": "34",
    "vulnerable_lines": [
        "// Line_Reference 16: if (!isset($_SESSION['CPM']) || $_SESSION['CPM'] != 1) {",
        "// Line_Reference 92:         $data = $db->fetchRow(\"SELECT title FROM \".$pre.\"nested_tree WHERE id = \".$t->parent_id);",
        "// Line_Reference 108:         $node_data = $db->fetchRow(",
        "// Line_Reference 117:         echo '<tr class=\"ligne0\" id=\"row_'.$t->id.'\">",
        "// Line_Reference 118:                         <td align=\"center\" onclick=\"open_edit_folder_dialog('.$t->id.')\">'.$t->id.'</td>",
        "// Line_Reference 119:                         <td width=\"50%\" onclick=\"open_edit_folder_dialog('.$t->id.')\">",
        "// Line_Reference 120:                             '.$ident.'<span id=\"title_'.$t->id.'\">'.$t->title.'</span>",
        "// Line_Reference 121:                         </td>",
        "// Line_Reference 122:                         <td align=\"center\" onclick=\"open_edit_folder_dialog('.$t->id.')\">",
        "// Line_Reference 123:                             <span id=\"complexite_'.$t->id.'\">'.@$pwComplexity[$node_data[0]][1].'</span>",
        "// Line_Reference 124:                         </td>",
        "// Line_Reference 125:                         <td align=\"center\" onclick=\"open_edit_folder_dialog('.$t->id.')\">",
        "// Line_Reference 126:                             <span id=\"parent_'.$t->id.'\">'.$data[0].'</span>",
        "// Line_Reference 127:                         </td>",
        "// Line_Reference 128:                         <td align=\"center\" onclick=\"open_edit_folder_dialog('.$t->id.')\">",
        "// Line_Reference 129:                             '.$t->nlevel.'",
        "// Line_Reference 130:                         </td>",
        "// Line_Reference 131:                         <td align=\"center\" onclick=\"open_edit_folder_dialog('.$t->id.')\">",
        "// Line_Reference 132:                             <span id=\"renewal_'.$t->id.'\">'.$node_data[1].'</span>",
        "// Line_Reference 133:                         </td>",
        "// Line_Reference 134:                         <td align=\"center\">",
        "// Line_Reference 135:                             <img src=\"includes/images/folder--minus.png\" onclick=\"supprimer_groupe(\\''.$t->id.'\\')\" style=\"cursor:pointer;\" />",
        "// Line_Reference 136:                         </td>';",
        "// Line_Reference 138:         $data3 = $db->fetchRow(\"SELECT bloquer_creation,bloquer_modification FROM \".$pre.\"nested_tree WHERE id = \".$t->id);",
        "// Line_Reference 140:                         <td align=\"center\">",
        "// Line_Reference 141:                             <input type=\"checkbox\" id=\"cb_droit_'.$t->id.'\" onchange=\"Changer_Droit_Complexite(\\''.$t->id.'\\',\\'creation\\')\"', isset($data3[0]) && $data3[0] == 1 ? 'checked' : '', ' />",
        "// Line_Reference 142:                         </td>",
        "// Line_Reference 143:                         <td align=\"center\">",
        "// Line_Reference 144:                             <input type=\"checkbox\" id=\"cb_droit_modif_'.$t->id.'\" onchange=\"Changer_Droit_Complexite(\\''.$t->id.'\\',\\'modification\\')\"', isset($data3[1]) && $data3[1] == 1 ? 'checked' : '', ' />",
        "// Line_Reference 145:                         </td>",
        "// Line_Reference 146:                         <td>",
        "// Line_Reference 147:                             <input type=\"hidden\"  id=\"parent_id_'.$t->id.'\" value=\"'.$t->parent_id.'\" />",
        "// Line_Reference 148:                             <input type=\"hidden\"  id=\"renewal_id_'.$t->id.'\" value=\"'.$node_data[0].'\" />",
        "// Line_Reference 149:                         </td>"
    ]
}
