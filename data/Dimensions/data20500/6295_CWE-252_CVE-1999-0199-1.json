{
    "cve_id": "CVE-1999-0199",
    "cve_description": "manual/search.texi in the GNU C Library (aka glibc) before 2.2 lacks a statement about the unspecified tdelete return value upon deletion of a tree's root, which might allow attackers to access a dangling pointer in an application whose developer was unaware of a documentation update from 1999.",
    "cve_publish_date": "2020-10-06",
    "cwe_id": "CWE-252",
    "cwe_name": "Unchecked Return Value",
    "cwe_description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",
    "commit_message": "Update.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* elf/dl-load.c (_dl_dst_count): Allow $ORIGIN to point to\n\tdirectory with the reference since this is as secure as using the\n\tobject with the dependency.\n\t(_dl_dst_substitute): Likewise.\n\n\t* elf/dl-load.c (_dl_dst_count): Change strings in first two\n\tstrncmp calls to allow reuse.\n\t(_dl_dst_substitute): Likewise.\n\n1999-11-01  Arnold D. Robbins  <arnold@skeeve.com>\n\n\t* posix/regex.c (init_syntax_once): move below definition of\n\tISALNUM etc., then use ISALNUM to init the table, so that\n\tthe word ops will work if i18n'ed.\n\t(SYNTAX): And subscript with 0xFF for 8bit character sets.\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* sysdeps/unix/getlogin_r.c (getlogin_r): Sync with getlogin\n\timplementation for ttyname_r call; fix inverted condition; return\n\tut_user.  Closes PR libc/1438.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* timezone/checktab.awk: Update from tzcode1999h.\n\t* timezone/africa: Update from tzdata1999i.\n\t* timezone/asia: Likewise.\n\t* timezone/australasia: Likewise.\n\t* timezone/backward: Likewise.\n\t* timezone/europe: Likewise.\n\t* timezone/northamerica: Likewise.\n\t* timezone/southamerica: Likewise.\n\t* timezone/iso3166.tab: Likewise.\n\t* timezone/zone.tab: Likewise.\n\n\t* sysdeps/unix/sysv/linux/bits/resource.h: Define values also as\n\tmacros.  Patch by brg@csua.berkeley.edu [PR libc/1439].\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* posix/Makefile (tests): Added tst-getlogin.\n\n\t* posix/tst-getlogin.c: New file, contains simple tests for\n\tgetlogin and getlogin_r.\n\n1999-11-09  Andreas Schwab  <schwab@suse.de>\n\n\t* misc/syslog.c: For LOG_PERROR only append a newline if\n\tnecessary.",
    "type_of_change": "Modification",
    "filename_of_changes": "dl-load.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 158:       /* $ORIGIN is not expanded for SUID/GUID programs.  */",
        "// Line_Reference 159:       if ((((!__libc_enable_secure",
        "// Line_Reference 160: \t     && strncmp (&name[1], \"ORIGIN\", 6) == 0 && (len = 7) != 0)",
        "// Line_Reference 161: \t    || (strncmp (&name[1], \"PLATFORM\", 8) == 0 && (len = 9) != 0))",
        "// Line_Reference 165: \t      && ((!__libc_enable_secure",
        "// Line_Reference 166: \t\t   && strncmp (&name[2], \"ORIGIN}\", 7) == 0 && (len = 9) != 0)",
        "// Line_Reference 198: \t  if ((((strncmp (&name[1], \"ORIGIN\", 6) == 0 && (len = 7) != 0)",
        "// Line_Reference 199: \t\t|| (strncmp (&name[1], \"PLATFORM\", 8) == 0 && (len = 9) != 0))",
        "// Line_Reference 208: \t\t      ? (__libc_enable_secure ? NULL : l->l_origin)",
        "// Line_Reference 262:   /* Determine the nubmer of DST elements.  */"
    ]
}
