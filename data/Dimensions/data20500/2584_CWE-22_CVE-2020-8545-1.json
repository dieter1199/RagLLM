{
    "cve_id": "CVE-2020-8545",
    "cve_description": "Global.py in AIL framework 2.8 allows path traversal.",
    "cve_publish_date": "2020-02-03",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "fix: [Global: filename provided by all feeders] avoid path tranversal",
    "type_of_change": "Modification",
    "filename_of_changes": "Global.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 86:         dirname = os.path.dirname(filename)",
        "// Line_Reference 87:         if not os.path.exists(dirname):",
        "// Line_Reference 88:             os.makedirs(dirname)",
        "// Line_Reference 89: ",
        "// Line_Reference 90:         decoded = base64.standard_b64decode(gzip64encoded)",
        "// Line_Reference 92:         with open(filename, 'wb') as f:",
        "// Line_Reference 93:             f.write(decoded)",
        "// Line_Reference 94:         '''try:",
        "// Line_Reference 95:             decoded2 = gunzip_bytes_obj(decoded)",
        "// Line_Reference 96:         except:",
        "// Line_Reference 97:             decoded2 =''",
        "// Line_Reference 99:         type = magic.from_buffer(decoded2, mime=True)",
        "// Line_Reference 101:         if type!= 'text/x-c++' and type!= 'text/html' and type!= 'text/x-c' and type!= 'text/x-python' and type!= 'text/x-php' and type!= 'application/xml' and type!= 'text/x-shellscript' and type!= 'text/plain' and type!= 'text/x-diff' and type!= 'text/x-ruby':",
        "// Line_Reference 103:             print('-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------')",
        "// Line_Reference 104:             print(filename)",
        "// Line_Reference 105:             print(type)",
        "// Line_Reference 106:             print('-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------')",
        "// Line_Reference 107:         '''",
        "// Line_Reference 109:         # remove PASTES_FOLDER from item path (crawled item + submited)",
        "// Line_Reference 110:         if PASTES_FOLDERS in paste:",
        "// Line_Reference 111:             paste = paste.replace(PASTES_FOLDERS, '', 1)",
        "// Line_Reference 113:         p.populate_set_out(paste)",
        "// Line_Reference 114:         processed_paste+=1"
    ]
}
