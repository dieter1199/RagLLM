{
    "cve_id": "CVE-2024-21650",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. XWiki is vulnerable to a remote code execution (RCE) attack through its user registration feature. This issue allows an attacker to execute arbitrary code by crafting malicious payloads in the \"first name\" or \"last name\" fields during user registration. This impacts all installations that have user registration enabled for guests. This vulnerability has been patched in XWiki 14.10.17, 15.5.3 and 15.8 RC1.",
    "cve_publish_date": "2024-01-08",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "XWIKI-21173: Improve escaping in registration success message\n\n* Use $xwiki.getUserName to link to the user profile.\n* Add an integration test to test proper escaping.",
    "type_of_change": "Modification",
    "filename_of_changes": "RegisterIT.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 22: import java.util.List;",
        "// Line_Reference 31: import org.openqa.selenium.WebElement;",
        "// Line_Reference 239:             return guestUserRegistration(testUtils, registrationPage);",
        "// Line_Reference 268:     private boolean guestUserRegistration(TestUtils testUtils, AbstractRegistrationPage registrationPage)",
        "// Line_Reference 272:         List<WebElement> infos = testUtils.getDriver().findElements(By.className(\"infomessage\"));",
        "// Line_Reference 273:         for (WebElement info : infos) {",
        "// Line_Reference 274:             if (info.getText().contains(\"Registration successful.\")) {",
        "// Line_Reference 275:                 return true;",
        "// Line_Reference 276:             }",
        "// Line_Reference 277:         }",
        "// Line_Reference 278:         return false;"
    ]
}
