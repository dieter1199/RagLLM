*   Copyright (C) 1998-2019 Michal Trojnara <Michal.Trojnara@stunnel.org>
if(verify_checks(c, preverify_ok, callback_ctx)) {
int ok=SSL_SESSION_set_ex_data(sess, index_session_authenticated,
(void *)(-1));
if(c->opt->option.client || c->opt->protocol)
return 0; /* reject */
if(c->opt->redirect_addr.names)
return 1; /* accept */