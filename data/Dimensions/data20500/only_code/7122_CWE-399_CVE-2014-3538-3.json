FILE_RCSID("@(#)$File: softmagic.c,v 1.188 2014/05/14 23:15:42 christos Exp $")
const unsigned char *, uint32_t, size_t, size_t);
file_fmttime(p->l, FILE_T_LOCAL, tbuf)) == -1)
file_fmttime(p->l, 0, tbuf)) == -1)
file_fmttime(p->q, FILE_T_LOCAL, tbuf)) == -1)
file_fmttime(p->q, 0, tbuf)) == -1)
file_fmttime(p->q, FILE_T_WINDOWS, tbuf)) == -1)
switch (cvt_flip(m->type, flip)) {
cvt_32(p, m);
cvt_64(p, m);
cvt_32(p, m);
cvt_64(p, m);
cvt_32(p, m);
const unsigned char *s, uint32_t offset, size_t nbytes, size_t linecnt)
size_t lines;
end = last = RCAST(const char *, s) + nbytes;
last = RCAST(const char *, s) + nbytes;
uint32_t count = m->str_range;
(uint32_t)nbytes, count) == -1)
"nbytes=%zu, count=%u)\n", m->type, m->flag, offset, o,
nbytes, count);
if (mcopy(ms, p, m->type, 0, s, offset, nbytes, count) == -1)
v = file_strncmp(m->value.s, ms->search.s + idx, slen, m->str_flags);
#ifndef REG_STARTEND
char c;
#endif
/* Limit by offset if requested */
if (m->str_range > 0)
slen = MIN(slen, m->str_range);