if (!u.isPasswordCorrect(password))
throw new BadCredentialsException("Failed to login as "+username);