if (inet->opt && inet->opt->srr) {
nexthop = inet->opt->faddr;
if (!inet->opt || !inet->opt->srr)
if (inet->opt)
inet_csk(sk)->icsk_ext_hdr_len = inet->opt->optlen;
static struct ip_options *tcp_v4_save_options(struct sock *sk,
struct sk_buff *skb)
struct ip_options *opt = &(IPCB(skb)->opt);
struct ip_options *dopt = NULL;
int opt_size = optlength(opt);
if (ip_options_echo(dopt, skb)) {
newinet->opt	      = ireq->opt;
if (newinet->opt)
inet_csk(newsk)->icsk_ext_hdr_len = newinet->opt->optlen;