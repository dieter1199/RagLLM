var user = await _userManager.Users.SingleAsync(x => x.UserName == resetPasswordDto.UserName);
if (resetPasswordDto.UserName != User.GetUsername() && !(User.IsInRole(PolicyConstants.AdminRole) || User.IsInRole(PolicyConstants.ChangePasswordRole)))
if (!validPassword)
return Unauthorized("Your credentials are not correct");
var result = await _signInManager
.CheckPasswordSignInAsync(user, loginDto.Password, false);
