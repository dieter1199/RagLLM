for (plane = 0; plane < 4 && frame->data[plane]; plane++) {
for (i = 0; i < 4 && out->data[i]; i++) {