return_to = self.request.GET.get("returnTo", "/")
return_url = request.POST.get("returnTo", "/")
parsed = urlparse(return_url)
if parsed.hostname and parsed.hostname not in settings.ALLOWED_HOSTS:
# Make sure the return url is a relative path or a trusted hostname
return_url = '/'
return_to = self.request.GET.get("returnTo", "/")
self.success_url = form.cleaned_data.get("returnTo", "/") or "/"
