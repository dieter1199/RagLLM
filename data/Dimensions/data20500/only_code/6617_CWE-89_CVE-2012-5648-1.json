conditions = "hosts.name #{operator} '#{value_to_sql(operator, value)}'"
direct     = Puppetclass.all(:conditions => conditions, :joins => :hosts, :select => 'puppetclasses.id').map(&:id).uniq