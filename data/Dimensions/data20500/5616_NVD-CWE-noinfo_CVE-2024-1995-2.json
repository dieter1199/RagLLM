{
    "cve_id": "CVE-2024-1995",
    "cve_description": "The Smart Custom Fields plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the relational_posts_search() function in all versions up to, and including, 4.2.2. This makes it possible for authenticated attackers, with subscrber-level access and above, to retrieve post content that is password protected and/or private.",
    "cve_publish_date": "2024-03-20",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Security fix",
    "type_of_change": "Modification",
    "filename_of_changes": "class.field-related-terms.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "76",
    "number_of_lines_deleted_vulnerable_to_cve": "48",
    "vulnerable_lines": [
        "// Line_Reference 81: \t\t$args   = array();",
        "// Line_Reference 85: \t\t\t$taxonomies = explode( ',', $taxonomies );",
        "// Line_Reference 86: \t\t\t$args       = array(",
        "// Line_Reference 87: \t\t\t\t'taxonomy'     => $taxonomies,",
        "// Line_Reference 88: \t\t\t\t'order'        => 'ASC',",
        "// Line_Reference 89: \t\t\t\t'orderby'      => 'ID',",
        "// Line_Reference 90: \t\t\t\t'number'       => '',",
        "// Line_Reference 91: \t\t\t\t'hide_empty'   => false,",
        "// Line_Reference 92: \t\t\t\t'hierarchical' => false,",
        "// Line_Reference 93: \t\t\t);",
        "// Line_Reference 95: \t\t\t$click_count = filter_input( INPUT_POST, 'click_count' );",
        "// Line_Reference 96: \t\t\tif ( $click_count ) {",
        "// Line_Reference 97: \t\t\t\t$number = get_option( 'posts_per_page' );",
        "// Line_Reference 98: \t\t\t\t$offset = $click_count * $number;",
        "// Line_Reference 99: \t\t\t\t$args   = array_merge(",
        "// Line_Reference 100: \t\t\t\t\t$args,",
        "// Line_Reference 101: \t\t\t\t\tarray(",
        "// Line_Reference 102: \t\t\t\t\t\t'offset' => $offset,",
        "// Line_Reference 103: \t\t\t\t\t\t'number' => $number,",
        "// Line_Reference 104: \t\t\t\t\t)",
        "// Line_Reference 105: \t\t\t\t);",
        "// Line_Reference 108: \t\t\t$search = filter_input( INPUT_POST, 'search' );",
        "// Line_Reference 109: \t\t\tif ( $search ) {",
        "// Line_Reference 110: \t\t\t\t$args = array_merge(",
        "// Line_Reference 111: \t\t\t\t\t$args,",
        "// Line_Reference 112: \t\t\t\t\tarray(",
        "// Line_Reference 113: \t\t\t\t\t\t'search' => $search,",
        "// Line_Reference 114: \t\t\t\t\t)",
        "// Line_Reference 116: \t\t\t}",
        "// Line_Reference 118: \t\t\t$_terms = get_terms( $args );",
        "// Line_Reference 137: \t\tif ( ! $taxonomies ) {",
        "// Line_Reference 138: \t\t\t$taxonomies = array( 'category' );",
        "// Line_Reference 139: \t\t}",
        "// Line_Reference 140: \t\tif ( ! preg_match( '/^\\d+$/', $limit ) ) {",
        "// Line_Reference 141: \t\t\t$limit = '';",
        "// Line_Reference 143: \t\t$number = get_option( 'posts_per_page' );",
        "// Line_Reference 145: \t\t// choicse",
        "// Line_Reference 146: \t\t$choices_terms = get_terms(",
        "// Line_Reference 147: \t\t\tarray(",
        "// Line_Reference 148: \t\t\t\t'taxonomy'     => $taxonomies,",
        "// Line_Reference 149: \t\t\t\t'order'        => 'ASC',",
        "// Line_Reference 150: \t\t\t\t'orderby'      => 'ID',",
        "// Line_Reference 151: \t\t\t\t'hide_empty'   => false,",
        "// Line_Reference 152: \t\t\t\t'hierarchical' => false,",
        "// Line_Reference 153: \t\t\t\t'number'       => $number,",
        "// Line_Reference 154: \t\t\t)",
        "// Line_Reference 155: \t\t);",
        "// Line_Reference 156: \t\t$choices_li    = array();"
    ]
}
