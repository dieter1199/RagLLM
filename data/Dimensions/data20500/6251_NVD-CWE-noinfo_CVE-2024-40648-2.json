{
    "cve_id": "CVE-2024-40648",
    "cve_description": "matrix-rust-sdk is an implementation of a Matrix client-server library in Rust. The `UserIdentity::is_verified()` method in the matrix-sdk-crypto crate before version 0.7.2 doesn't take into account the verification status of the user's own identity while performing the check and may as a result return a value contrary to what is implied by its name and documentation. If the method is used to decide whether to perform sensitive operations towards a user identity, a malicious homeserver could manipulate the outcome in order to make the identity appear trusted. This is not a typical usage of the method, which lowers the impact. The method itself is not used inside the `matrix-sdk-crypto` crate. The 0.7.2 release of the `matrix-sdk-crypto` crate includes a fix. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-07-18",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "crypto: Fix UserIdentity::is_verified to take into account our own identity\n\nThe `UserIdentity::is_verified()` method in the matrix-sdk-crypto crate\nbefore version 0.7.2 doesn't take into account the verification status\nof the user's own identity while performing the check and may as a result\nreturn a value contrary to what is implied by its name and documentation.\n\nThis patch fixes this and adds a regression test.\n\nThe method itself is not used internally and as such has not a larger\nimpact.\n\nCo-authored-by: Denis Kasak <dkasak@termina.org.uk>\nSigned-off-by: Damir JeliÄ‡ <poljar@termina.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "user.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "92",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 230:         self.own_identity.as_ref().is_some_and(|o| o.is_identity_signed(&self.inner).is_ok())",
        "// Line_Reference 792:     use ruma::{device_id, user_id};",
        "// Line_Reference 803:         store::{CryptoStoreWrapper, MemoryStore},"
    ]
}
