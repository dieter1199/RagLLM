{
    "cve_id": "CVE-2022-24786",
    "cve_description": "PJSIP is a free and open source multimedia communication library written in C. PJSIP versions 2.12 and prior do not parse incoming RTCP feedback RPSI (Reference Picture Selection Indication) packet, but any app that directly uses pjmedia_rtcp_fb_parse_rpsi() will be affected. A patch is available in the `master` branch of the `pjsip/pjproject` GitHub repository. There are currently no known workarounds.",
    "cve_publish_date": "2022-04-06",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Merge pull request from GHSA-vhxv-phmx-g52q\n\n* Prevent OOB read/write when parsing RTCP FB RPSI\n\n* Add log information\n\n* Modification based on comments.",
    "type_of_change": "Modification",
    "filename_of_changes": "rtcp_fb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "57",
    "number_of_lines_deleted_vulnerable_to_cve": "38",
    "vulnerable_lines": [
        "// Line_Reference 46:     pjmedia_rtcp_common *hdr;",
        "// Line_Reference 57:     hdr = (pjmedia_rtcp_common*)buf;",
        "// Line_Reference 58:     pj_memcpy(hdr, &session->rtcp_rr_pkt.common,  sizeof(*hdr));",
        "// Line_Reference 59:     hdr->pt = RTCP_RTPFB;",
        "// Line_Reference 60:     hdr->count = 1; /* FMT = 1 */",
        "// Line_Reference 61:     hdr->length = pj_htons((pj_uint16_t)(len/4 - 1));",
        "// Line_Reference 89:     pjmedia_rtcp_common *hdr;",
        "// Line_Reference 99:     hdr = (pjmedia_rtcp_common*)buf;",
        "// Line_Reference 100:     pj_memcpy(hdr, &session->rtcp_rr_pkt.common,  sizeof(*hdr));",
        "// Line_Reference 101:     hdr->pt = RTCP_PSFB;",
        "// Line_Reference 102:     hdr->count = 1; /* FMT = 1 */",
        "// Line_Reference 103:     hdr->length = pj_htons((pj_uint16_t)(len/4 - 1));",
        "// Line_Reference 122:     pjmedia_rtcp_common *hdr;",
        "// Line_Reference 133:     hdr = (pjmedia_rtcp_common*)buf;",
        "// Line_Reference 134:     pj_memcpy(hdr, &session->rtcp_rr_pkt.common,  sizeof(*hdr));",
        "// Line_Reference 135:     hdr->pt = RTCP_PSFB;",
        "// Line_Reference 136:     hdr->count = 2; /* FMT = 2 */",
        "// Line_Reference 137:     hdr->length = pj_htons((pj_uint16_t)(len/4 - 1));",
        "// Line_Reference 169:     pjmedia_rtcp_common *hdr;",
        "// Line_Reference 182:     hdr = (pjmedia_rtcp_common*)buf;",
        "// Line_Reference 183:     pj_memcpy(hdr, &session->rtcp_rr_pkt.common,  sizeof(*hdr));",
        "// Line_Reference 184:     hdr->pt = RTCP_PSFB;",
        "// Line_Reference 185:     hdr->count = 3; /* FMT = 3 */",
        "// Line_Reference 186:     hdr->length = pj_htons((pj_uint16_t)(len/4 - 1));",
        "// Line_Reference 623:     pjmedia_rtcp_common *hdr = (pjmedia_rtcp_common*) buf;",
        "// Line_Reference 628:     PJ_ASSERT_RETURN(length >= sizeof(pjmedia_rtcp_common), PJ_ETOOSMALL);",
        "// Line_Reference 631:     if (hdr->pt != RTCP_RTPFB || hdr->count != 1)",
        "// Line_Reference 634:     cnt = pj_ntohs((pj_uint16_t)hdr->length);",
        "// Line_Reference 664:     pjmedia_rtcp_common *hdr = (pjmedia_rtcp_common*) buf;",
        "// Line_Reference 672:     if (hdr->pt != RTCP_PSFB || hdr->count != 1)",
        "// Line_Reference 689:     pjmedia_rtcp_common *hdr = (pjmedia_rtcp_common*) buf;",
        "// Line_Reference 694:     PJ_ASSERT_RETURN(length >= sizeof(pjmedia_rtcp_common), PJ_ETOOSMALL);",
        "// Line_Reference 697:     if (hdr->pt != RTCP_PSFB || hdr->count != 2)",
        "// Line_Reference 700:     cnt = pj_ntohs((pj_uint16_t)hdr->length) - 2;",
        "// Line_Reference 733:     pjmedia_rtcp_common *hdr = (pjmedia_rtcp_common*) buf;",
        "// Line_Reference 739:     PJ_ASSERT_RETURN(length >= sizeof(pjmedia_rtcp_common), PJ_ETOOSMALL);",
        "// Line_Reference 742:     if (hdr->pt != RTCP_PSFB || hdr->count != 3)",
        "// Line_Reference 745:     rpsi_len = (pj_ntohs((pj_uint16_t)hdr->length)-2) * 4;"
    ]
}
