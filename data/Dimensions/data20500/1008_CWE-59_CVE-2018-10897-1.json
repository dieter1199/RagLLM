{
    "cve_id": "CVE-2018-10897",
    "cve_description": "A directory traversal issue was found in reposync, a part of yum-utils, where reposync fails to sanitize paths in remote repository configuration files. If an attacker controls a repository, they may be able to copy files outside of the destination directory on the targeted system via path traversal. If reposync is running with heightened privileges on a targeted system, this flaw could potentially result in system compromise via the overwriting of critical system files. Version 1.1.31 and older are believed to be affected.",
    "cve_publish_date": "2018-08-01",
    "cwe_id": "CWE-59",
    "cwe_name": "Improper Link Resolution Before File Access ('Link Following')",
    "cwe_description": "The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",
    "commit_message": "reposync: refactor: sanitize remote_path usage\n\nFor better readability (remote_path == relativepath).",
    "type_of_change": "Modification",
    "filename_of_changes": "reposync.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 224:                 remote = pkg.returnSimple('relativepath')",
        "// Line_Reference 225:                 rpmname = os.path.basename(remote)",
        "// Line_Reference 272:                 remote = pkg.returnSimple('relativepath')",
        "// Line_Reference 273:                 local = local_repo_path + '/' + remote",
        "// Line_Reference 285:                 remote = pkg.returnSimple('relativepath')",
        "// Line_Reference 286:                 local = os.path.join(local_repo_path, remote)",
        "// Line_Reference 288:                     print urljoin(pkg.repo.urls[0], pkg.relativepath)",
        "// Line_Reference 297:             rpmfn = pkg.remote_path",
        "// Line_Reference 298:             pkg.localpath = os.path.join(local_repo_path, rpmfn)"
    ]
}
