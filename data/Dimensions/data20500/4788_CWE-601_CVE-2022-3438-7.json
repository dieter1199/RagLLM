{
    "cve_id": "CVE-2022-3438",
    "cve_description": "Open Redirect in GitHub repository ikus060/rdiffweb prior to 2.5.0a4.",
    "cve_publish_date": "2022-10-10",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "Enforce validation on fullname, username and email for increase security #224",
    "type_of_change": "Modification",
    "filename_of_changes": "test_page_admin_users.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "46",
    "number_of_lines_deleted_vulnerable_to_cve": "27",
    "vulnerable_lines": [
        "// Line_Reference 173:     def test_edit_fullname(self):",
        "// Line_Reference 179:             body={'action': 'edit', 'username': self.USERNAME, 'fullname': 'My fullname'},",
        "// Line_Reference 182:         # Then user is updated successfully",
        "// Line_Reference 183:         self.assertInBody(\"User information modified successfully.\")",
        "// Line_Reference 184:         # Then database is updated",
        "// Line_Reference 185:         obj = UserObject.query.filter(UserObject.username == self.USERNAME).first()",
        "// Line_Reference 186:         self.assertEqual('My fullname', obj.fullname)",
        "// Line_Reference 187: ",
        "// Line_Reference 188:     def test_add_edit_delete_user_with_encoding(self):",
        "// Line_Reference 189:         \"\"\"",
        "// Line_Reference 190:         Check creation of user with non-ascii char.",
        "// Line_Reference 191:         \"\"\"",
        "// Line_Reference 192:         self._add_user(\"Éric\", \"éric@test.com\", \"pr3j5Dwi\", \"/home/\", UserObject.USER_ROLE)",
        "// Line_Reference 193:         self.assertInBody(\"User added successfully.\")",
        "// Line_Reference 194:         self.assertInBody(\"Éric\")",
        "// Line_Reference 195:         self.assertInBody(\"éric@test.com\")",
        "// Line_Reference 196:         # Update user",
        "// Line_Reference 197:         self._edit_user(\"Éric\", \"eric.létourno@test.com\", \"écureuil\", \"/tmp/\", UserObject.ADMIN_ROLE)",
        "// Line_Reference 198:         self.assertInBody(\"User information modified successfully.\")",
        "// Line_Reference 199:         self.assertInBody(\"Éric\")",
        "// Line_Reference 200:         self.assertInBody(\"eric.létourno@test.com\")",
        "// Line_Reference 201:         self.assertNotInBody(\"/home/\")",
        "// Line_Reference 202:         self.assertInBody(\"/tmp/\")",
        "// Line_Reference 203: ",
        "// Line_Reference 204:         self._delete_user(\"Éric\")",
        "// Line_Reference 205:         self.assertInBody(\"User account removed.\")",
        "// Line_Reference 206:         self.assertNotInBody(\"Éric\")"
    ]
}
