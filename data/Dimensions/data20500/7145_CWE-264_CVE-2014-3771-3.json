{
    "cve_id": "CVE-2014-3771",
    "cve_description": "TeamPass before 2.1.20 allows remote attackers to bypass access restrictions via the language file path in a (1) request to index.php or (2) \"change_user_language\" request to sources/main.queries.php.",
    "cve_publish_date": "2014-08-07",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Several security improvements\nNew feature: one time item view for anonymous user",
    "type_of_change": "Modification",
    "filename_of_changes": "items.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 17:     !isset($_SESSION['CPM']) || $_SESSION['CPM'] != 1 ||",
        "// Line_Reference 18:     !isset($_SESSION['user_id']) || empty($_SESSION['user_id']) ||",
        "// Line_Reference 19:     !isset($_SESSION['key']) || empty($_SESSION['key']))",
        "// Line_Reference 77: <input type=\"hidden\" name=\"hid_cat\" id=\"hid_cat\" value=\"', isset($_GET['group']) ? $_GET['group'] : \"\", '\" />",
        "// Line_Reference 81: <input type=\"hidden\" name=\"input_list_roles\" id=\"input_list_roles\" value=\"'.htmlentities($listRoles, ENT_QUOTES, 'UTF-8').'\" />",
        "// Line_Reference 90: <input type=\"hidden\" id=\"nb_items_to_display_once\" value=\"', isset($_SESSION['settings']['nb_items_by_query']) ? $_SESSION['settings']['nb_items_by_query'] : 'auto', '\" />",
        "// Line_Reference 121: <input type=\"hidden\" name=\"jstree_group_selected\" id=\"jstree_group_selected\" value=\"'.$firstGroup.'\" />';"
    ]
}
