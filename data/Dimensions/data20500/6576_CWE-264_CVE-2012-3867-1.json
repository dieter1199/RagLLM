{
    "cve_id": "CVE-2012-3867",
    "cve_description": "lib/puppet/ssl/certificate_authority.rb in Puppet before 2.6.17 and 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, does not properly restrict the characters in the Common Name field of a Certificate Signing Request (CSR), which makes it easier for user-assisted remote attackers to trick administrators into signing a crafted agent certificate via ANSI control sequences.",
    "cve_publish_date": "2012-08-06",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "Validate CSR CN and provided certname before signing\n\nThis adds a few new checks when signing CSRs, to validate the CN. First,\nit must conform to a small set of characters, which are the printable\nASCII characters, except for '/' (because we store these in files). This\nprevents attacks such as a CN \"foo^H^H^Hbar\", which appears as \"bar\" to\n\"puppet cert list\".\n\nThe other check is that the certname for the SSL::Host that we think\nwe're signing must match the CN. This prevents a CSR with the CN \"foo\"\nfrom being submitted as a CSR for \"bar\", which would cause it to appear\nas \"bar\" to \"puppet cert list\", but to issue a certificate for \"foo\".",
    "type_of_change": "Modification",
    "filename_of_changes": "certificate_authority_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "76",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 249:       @request_content = stub \"request content stub\", :subject => @name",
        "// Line_Reference 306:           args[0] == :ca",
        "// Line_Reference 313:           args[1] == @request",
        "// Line_Reference 320:           args[2].subject == \"myhost\"",
        "// Line_Reference 327:           args[3] == @serial",
        "// Line_Reference 459:         expect { @ca.sign(@name) }.to raise_error(",
        "// Line_Reference 469:         expect { @ca.sign(@name) }.to raise_error(",
        "// Line_Reference 482:         expect { @ca.sign(@name) }.to raise_error(",
        "// Line_Reference 490:         expect { @ca.sign(@name, true) }.to raise_error(",
        "// Line_Reference 500:         expect { @ca.sign(@name) }.to raise_error(",
        "// Line_Reference 508:         expect { @ca.sign(@name, true) }.to raise_error("
    ]
}
