{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Profiles.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 33:     $exceptions_RET = DBGet(DBQuery('SELECT PROFILE_ID,MODNAME,CAN_USE,CAN_EDIT FROM profile_exceptions WHERE PROFILE_ID=\\'' . $_REQUEST[profile_id] . '\\''), array(), array('MODNAME'));",
        "// Line_Reference 34:     $profile_RET = DBGet(DBQuery('SELECT PROFILE FROM user_profiles WHERE ID=\\'' . $_REQUEST[profile_id] . '\\''));",
        "// Line_Reference 42:     $profile_RET = DBGet(DBQuery('SELECT TITLE FROM user_profiles WHERE ID=\\'' . $_REQUEST[profile_id] . '\\''));",
        "// Line_Reference 43: ",
        "// Line_Reference 44: ",
        "// Line_Reference 46:     if (DeletePromptBigString(\"delete <i>$profile</i>?,<br/>users of that profile will retain their permissions as a custom set which can be modified on a per-user basis through the User Permissions program.\")) {",
        "// Line_Reference 86:                 if (!count($exceptions_RET[$modname]) && ($_REQUEST['can_edit'][str_replace('.', '_', $modname)] || $_REQUEST['can_use'][str_replace('.', '_', $modname)])) {",
        "// Line_Reference 87:                     DBQuery('INSERT INTO profile_exceptions (PROFILE_ID,MODNAME) values(\\'' . $_REQUEST[profile_id] . '\\',\\'' . $modname . '\\')');",
        "// Line_Reference 88:                 } elseif (count($exceptions_RET[$modname]) && !$_REQUEST['can_edit'][str_replace('.', '_', $modname)] && !$_REQUEST['can_use'][str_replace('.', '_', $modname)])",
        "// Line_Reference 89:                     DBQuery('DELETE FROM profile_exceptions WHERE PROFILE_ID=\\'' . $_REQUEST[profile_id] . '\\' AND MODNAME=\\'' . $modname . '\\'');",
        "// Line_Reference 101:                     $update .= ' WHERE PROFILE_ID=\\'' . $_REQUEST[profile_id] . '\\' AND MODNAME=\\'' . $modname . '\\';';",
        "// Line_Reference 107:     $exceptions_RET = DBGet(DBQuery('SELECT MODNAME,CAN_USE,CAN_EDIT FROM profile_exceptions WHERE PROFILE_ID=\\'' . $_REQUEST[profile_id] . '\\''), array(), array('MODNAME'));",
        "// Line_Reference 116:     $id = DBGet(DBQuery('SHOW TABLE STATUS LIKE \\'' . 'user_profiles' . '\\''));",
        "// Line_Reference 117:     $id[1]['ID'] = $id[1]['AUTO_INCREMENT'];",
        "// Line_Reference 118:     $id = $id[1]['ID'];",
        "// Line_Reference 122:     $_REQUEST['profile_id'] = $id;",
        "// Line_Reference 156:                 echo '<TR><TD width=20 align=right class=\"p-10\">' . (AllowEdit() && $id > 4 && $id != 0 ? '<a href=\"Modules.php?modname='.$_REQUEST[modname].'&modfunc=delete&profile_id='.$id.'\" class=\"btn btn-default btn-xs p-5\"><i class=\"icon-cross2\"></i></a>' : '') . '</TD><TD onclick=\"document.location.href=\\'Modules.php?modname=' . $_REQUEST['modname'] . '&profile_id=' . $id . '\\';\">';",
        "// Line_Reference 272:             if (count($values)) {"
    ]
}
