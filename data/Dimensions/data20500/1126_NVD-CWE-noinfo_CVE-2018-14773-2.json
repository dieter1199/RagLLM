{
    "cve_id": "CVE-2018-14773",
    "cve_description": "An issue was discovered in Http Foundation in Symfony 2.7.0 through 2.7.48, 2.8.0 through 2.8.43, 3.3.0 through 3.3.17, 3.4.0 through 3.4.13, 4.0.0 through 4.0.13, and 4.1.0 through 4.1.2. It arises from support for a (legacy) IIS header that lets users override the path in the request URL via the X-Original-URL or X-Rewrite-URL HTTP request header. These headers are designed for IIS support, but it's not verified that the server is in fact running IIS, which means anybody who can send these requests to an application can trigger this. This affects \\Symfony\\Component\\HttpFoundation\\Request::prepareRequestUri() where X-Original-URL and X_REWRITE_URL are both used. The fix drops support for these methods so that they cannot be used as attack vectors such as web cache poisoning.",
    "cve_publish_date": "2018-08-03",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "[HttpFoundation] Remove support for legacy and risky HTTP headers",
    "type_of_change": "Modification",
    "filename_of_changes": "RequestTest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "44",
    "vulnerable_lines": [
        "// Line_Reference 1812:                 array(",
        "// Line_Reference 1813:                     'X_ORIGINAL_URL' => '/foo/bar',",
        "// Line_Reference 1814:                 ),",
        "// Line_Reference 1815:                 array(),",
        "// Line_Reference 1816:                 '/foo/bar',",
        "// Line_Reference 1817:             ),",
        "// Line_Reference 1818:             array(",
        "// Line_Reference 1819:                 array(",
        "// Line_Reference 1820:                     'X_REWRITE_URL' => '/foo/bar',",
        "// Line_Reference 1821:                 ),",
        "// Line_Reference 1823:                 '/foo/bar',",
        "// Line_Reference 1824:             ),",
        "// Line_Reference 1825:             array(",
        "// Line_Reference 1826:                 array(),",
        "// Line_Reference 1827:                 array(",
        "// Line_Reference 1828:                     'IIS_WasUrlRewritten' => '1',",
        "// Line_Reference 1829:                     'UNENCODED_URL' => '/foo/bar',",
        "// Line_Reference 1830:                 ),",
        "// Line_Reference 1831:                 '/foo/bar',",
        "// Line_Reference 1832:             ),",
        "// Line_Reference 1833:             array(",
        "// Line_Reference 1834:                 array(",
        "// Line_Reference 1835:                     'X_ORIGINAL_URL' => '/foo/bar',",
        "// Line_Reference 1836:                 ),",
        "// Line_Reference 1837:                 array(",
        "// Line_Reference 1838:                     'HTTP_X_ORIGINAL_URL' => '/foo/bar',",
        "// Line_Reference 1839:                 ),",
        "// Line_Reference 1840:                 '/foo/bar',",
        "// Line_Reference 1841:             ),",
        "// Line_Reference 1842:             array(",
        "// Line_Reference 1843:                 array(",
        "// Line_Reference 1844:                     'X_ORIGINAL_URL' => '/foo/bar',",
        "// Line_Reference 1845:                 ),",
        "// Line_Reference 1846:                 array(",
        "// Line_Reference 1847:                     'IIS_WasUrlRewritten' => '1',",
        "// Line_Reference 1848:                     'UNENCODED_URL' => '/foo/bar',",
        "// Line_Reference 1849:                 ),",
        "// Line_Reference 1850:                 '/foo/bar',",
        "// Line_Reference 1851:             ),",
        "// Line_Reference 1852:             array(",
        "// Line_Reference 1853:                 array(",
        "// Line_Reference 1854:                     'X_ORIGINAL_URL' => '/foo/bar',",
        "// Line_Reference 1855:                 ),",
        "// Line_Reference 1857:                     'HTTP_X_ORIGINAL_URL' => '/foo/bar',"
    ]
}
