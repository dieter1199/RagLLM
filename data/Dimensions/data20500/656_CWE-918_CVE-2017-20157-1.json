{
    "cve_id": "CVE-2017-20157",
    "cve_description": "A vulnerability was found in Ariadne Component Library up to 2.x. It has been classified as critical. Affected is an unknown function of the file src/url/Url.php. The manipulation leads to server-side request forgery. Upgrading to version 3.0 is able to address this issue. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217140.",
    "cve_publish_date": "2022-12-31",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "added checks for evil URL's (url's that could trigger parse errors and ssrf attacks)\nadded test for double port number ssrf attack and prevent it",
    "type_of_change": "Modification",
    "filename_of_changes": "Url.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 15:  *\tUrl parses a URL string and returns an object with the seperate parts. You can change",
        "// Line_Reference 16:  *\tthese and when cast to a string Url will regenerate the URL string and make sure it",
        "// Line_Reference 17:  *\tis valid.",
        "// Line_Reference 19:  *\tUsage:",
        "// Line_Reference 20:  *\t\t$url = new \\arc\\url\\Url( 'http://www.ariadne-cms.org/' );",
        "// Line_Reference 21:  *\t\t$url->path = '/docs/search/';",
        "// Line_Reference 22:  *\t\t$url->query = 'a=1&a=2';",
        "// Line_Reference 23:  *\t\techo $url; // => 'http://www.ariadne-cms.org/docs/search/?a=1&a=2'",
        "// Line_Reference 29:      *\tAll parts of the URL format, as returned by parse_url.",
        "// Line_Reference 30:      *\tscheme://user:pass@host:port/path?query#fragment",
        "// Line_Reference 36:      *\t@param string $url The URL to parse, the query part will remain a string.",
        "// Line_Reference 37:      *  @param QueryInterface queryObject Optional. An object that parses the query string."
    ]
}
