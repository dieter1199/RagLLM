{
    "cve_id": "CVE-2012-3865",
    "cve_description": "Directory traversal vulnerability in lib/puppet/reports/store.rb in Puppet before 2.6.17 and 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, when Delete is enabled in auth.conf, allows remote authenticated users to delete arbitrary files on the puppet master server via a .. (dot dot) in a node name.",
    "cve_publish_date": "2012-08-06",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Reject directory traversal in store report processor",
    "type_of_change": "Modification",
    "filename_of_changes": "store.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 16:     client = self.host.gsub(\"..\",\".\")",
        "// Line_Reference 18:     dir = File.join(Puppet[:reportdir], client)",
        "// Line_Reference 45:       Puppet.warning \"Could not write report for #{client} at #{file}: #{detail}\"",
        "// Line_Reference 52:   # removes all reports for a given host",
        "// Line_Reference 54:     client = host.gsub(\"..\",\".\")",
        "// Line_Reference 55:     dir = File.join(Puppet[:reportdir], client)"
    ]
}
