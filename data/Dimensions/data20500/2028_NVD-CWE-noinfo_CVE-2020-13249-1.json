{
    "cve_id": "CVE-2020-13249",
    "cve_description": "libmariadb/mariadb_lib.c in MariaDB Connector/C before 3.1.8 does not properly validate the content of an OK packet received from a server. NOTE: although mariadb_lib.c was originally based on code shipped for MySQL, this issue does not affect any MySQL components supported by Oracle.",
    "cve_publish_date": "2020-05-20",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "sanity checks for client-supplied OK packet content\n\nreported by Matthias Kaiser, Apple Information Security",
    "type_of_change": "Modification",
    "filename_of_changes": "mariadb_lib.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 2149:   if (pos < mysql->net.read_pos+length)",
        "// Line_Reference 2163:         if (pos < mysql->net.read_pos + length)",
        "// Line_Reference 2169:           size_t item_len= net_field_length(&pos);  /* length for all items */",
        "// Line_Reference 2175:           while (item_len > 0)",
        "// Line_Reference 2179:             old_pos= pos;",
        "// Line_Reference 2194:               {",
        "// Line_Reference 2195:                 ma_clear_session_state(mysql);",
        "// Line_Reference 2196:                 SET_CLIENT_ERROR(mysql, CR_OUT_OF_MEMORY, SQLSTATE_UNKNOWN, 0);",
        "// Line_Reference 2197:                 return -1;",
        "// Line_Reference 2198:               }",
        "// Line_Reference 2226:                 {",
        "// Line_Reference 2227:                   ma_clear_session_state(mysql);",
        "// Line_Reference 2228:                   SET_CLIENT_ERROR(mysql, CR_OUT_OF_MEMORY, SQLSTATE_UNKNOWN, 0);",
        "// Line_Reference 2229:                   return -1;",
        "// Line_Reference 2230:                 }",
        "// Line_Reference 2237:                 if (set_charset &&",
        "// Line_Reference 2240:                   char cs_name[64];",
        "// Line_Reference 2241:                   MARIADB_CHARSET_INFO *cs_info;",
        "// Line_Reference 2244:                   if ((cs_info = (MARIADB_CHARSET_INFO *)mysql_find_charset_name(cs_name)))",
        "// Line_Reference 2255:             item_len-= (pos - old_pos);"
    ]
}
