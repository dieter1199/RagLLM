{
    "cve_id": "CVE-2024-34712",
    "cve_description": "Oceanic is a NodeJS library for interfacing with Discord. Prior to version 1.10.4, input to functions such as `Client.rest.channels.removeBan` is not url-encoded, resulting in specially crafted input such as `../../../channels/{id}` being normalized into the url `/api/v10/channels/{id}`, and deleting a channel rather than removing a ban. Version 1.10.4 fixes this issue. Some workarounds are available. One may sanitize user input, ensuring strings are valid for the purpose they are being used for. One may also encode input with `encodeURIComponent` before providing it to the library.",
    "cve_publish_date": "2024-05-14",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "sanitize route parameters",
    "type_of_change": "Modification",
    "filename_of_changes": "Routes.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "127",
    "number_of_lines_deleted_vulnerable_to_cve": "123",
    "vulnerable_lines": [
        "// Line_Reference 6: export const CHANNEL_WEBHOOKS = (channelID: string) => `/channels/${channelID}/webhooks` as const;",
        "// Line_Reference 7: export const GUILD_WEBHOOKS   = (guildID: string) => `/guilds/${guildID}/webhooks` as const;",
        "// Line_Reference 8: export const WEBHOOK          = (webhookID: string, webhookToken?: string) => (webhookToken ? `/webhooks/${webhookID}/${webhookToken}` : `/webhooks/${webhookID}`) as `/webhooks/${string}` | `/webhooks/${string}/${string}`;",
        "// Line_Reference 9: export const WEBHOOK_MESSAGE  = (webhookID: string, webhookToken: string, messageID: string) => `/webhooks/${webhookID}/${webhookToken}/messages/${messageID}` as const;",
        "// Line_Reference 10: export const WEBHOOK_PLATFORM = (webhookID: string, webhookToken: string, platform: \"github\" | \"slack\") => `/webhooks/${webhookID}/${webhookToken}/${platform}` as const;",
        "// Line_Reference 13: export const GUILD                       = (userID: string) => `/guilds/${userID}` as const;",
        "// Line_Reference 14: export const GUILDS                      = \"/guilds\" as const;",
        "// Line_Reference 15: export const GUILD_BANS                  = (guildID: string) => `/guilds/${guildID}/bans` as const;",
        "// Line_Reference 16: export const GUILD_BAN                   = (guildID: string, userID: string) => `/guilds/${guildID}/bans/${userID}` as const;",
        "// Line_Reference 17: export const GUILD_AUTOMOD_RULE          = (guildID: string, autoModerationRuleID: string) => `/guilds/${guildID}/auto-moderation/rules/${autoModerationRuleID}` as const;",
        "// Line_Reference 18: export const GUILD_AUTOMOD_RULES         = (guildID: string) => `/guilds/${guildID}/auto-moderation/rules` as const;",
        "// Line_Reference 19: export const GUILD_EMOJI                 = (guildID: string, emojiID: string) => `/guilds/${guildID}/emojis/${emojiID}` as const;",
        "// Line_Reference 20: export const GUILD_EMOJIS                = (guildID: string) => `/guilds/${guildID}/emojis` as const;",
        "// Line_Reference 21: export const GUILD_AUDIT_LOG             = (guildID: string) => `/guilds/${guildID}/audit-logs` as const;",
        "// Line_Reference 22: export const GUILD_SCHEDULED_EVENT       = (guildID: string, eventID: string) => `/guilds/${guildID}/scheduled-events/${eventID}` as const;",
        "// Line_Reference 23: export const GUILD_SCHEDULED_EVENTS      = (guildID: string) => `/guilds/${guildID}/scheduled-events` as const;",
        "// Line_Reference 24: export const GUILD_SCHEDULED_EVENT_USERS = (guildID: string, eventID: string) => `/guilds/${guildID}/scheduled-events/${eventID}/users` as const;",
        "// Line_Reference 25: export const GUILD_TEMPLATE_CODE         = (code: string) => `/guilds/templates/${code}` as const;",
        "// Line_Reference 26: export const GUILD_TEMPLATE              = (guildID: string, templateID: string) => `/guilds/${guildID}/templates/${templateID}` as const;",
        "// Line_Reference 27: export const GUILD_TEMPLATES             = (guildID: string) => `/guilds/${guildID}/templates` as const;",
        "// Line_Reference 28: export const GUILD_PREVIEW               = (guildID: string) => `/guilds/${guildID}/preview` as const;",
        "// Line_Reference 29: export const GUILD_CHANNELS              = (guildID: string) => `/guilds/${guildID}/channels` as const;",
        "// Line_Reference 30: export const GUILD_ACTIVE_THREADS        = (guildID: string) => `/guilds/${guildID}/threads/active` as const;",
        "// Line_Reference 31: export const GUILD_MEMBERS               = (guildID: string) => `/guilds/${guildID}/members` as const;",
        "// Line_Reference 32: export const GUILD_MEMBER                = (guildID: string, userID: string) => `/guilds/${guildID}/members/${userID}` as const;",
        "// Line_Reference 33: export const GUILD_SEARCH_MEMBERS        = (guildID: string) => `/guilds/${guildID}/members/search` as const;",
        "// Line_Reference 34: export const GUILD_MEMBER_ROLE           = (guildID: string, userID: string, roleID: string) => `/guilds/${guildID}/members/${userID}/roles/${roleID}` as const;",
        "// Line_Reference 35: export const GUILD_ROLES                 = (guildID: string) => `/guilds/${guildID}/roles` as const;",
        "// Line_Reference 36: export const GUILD_ROLE                  = (guildID: string, roleID: string) => `/guilds/${guildID}/roles/${roleID}` as const;",
        "// Line_Reference 37: export const GUILD_MFA                   = (guildID: string) => `/guilds/${guildID}/mfa` as const;",
        "// Line_Reference 38: export const GUILD_PRUNE                 = (guildID: string) => `/guilds/${guildID}/prune` as const;",
        "// Line_Reference 39: export const GUILD_INVITES               = (guildID: string) => `/guilds/${guildID}/invites` as const;",
        "// Line_Reference 40: export const GUILD_INTEGRATION           = (guildID: string, integrationID: string) => `/guilds/${guildID}/integrations/${integrationID}` as const;",
        "// Line_Reference 41: export const GUILD_INTEGRATIONS          = (guildID: string) => `/guilds/${guildID}/integrations` as const;",
        "// Line_Reference 42: export const GUILD_WIDGET                = (guildID: string) => `/guilds/${guildID}/widget` as const;",
        "// Line_Reference 43: export const GUILD_VANITY_URL            = (guildID: string) => `/guilds/${guildID}/vanity-url` as const;",
        "// Line_Reference 44: export const GUILD_WIDGET_IMAGE          = (guildID: string) => `/guilds/${guildID}/widget.png` as const;",
        "// Line_Reference 45: export const GUILD_WIDGET_JSON           = (guildID: string) => `/guilds/${guildID}/widget.json` as const;",
        "// Line_Reference 46: export const GUILD_WELCOME_SCREEN        = (guildID: string) => `/guilds/${guildID}/welcome-screen` as const;",
        "// Line_Reference 47: export const GUILD_VOICE_STATE           = (guildID: string, userID: string) => `/guilds/${guildID}/voice-states/${userID}` as const;",
        "// Line_Reference 48: export const GUILD_STICKER\t\t\t     = (guildID: string, stickerID: string) => `/guilds/${guildID}/stickers/${stickerID}` as const;",
        "// Line_Reference 49: export const GUILD_STICKERS\t\t\t     = (guildID: string) => `/guilds/${guildID}/stickers` as const;",
        "// Line_Reference 50: export const GUILD_ONBOARDING            = (guildID: string) => `/guilds/${guildID}/onboarding` as const;",
        "// Line_Reference 51: export const GUILD_INCIDENT_ACTIONS      = (guildID: string) => `/guilds/${guildID}/incident-actions` as const;",
        "// Line_Reference 52: export const GUILD_BULK_BAN              = (guildID: string) => `/guilds/${guildID}/bulk-ban` as const;",
        "// Line_Reference 55: export const CHANNEL                                 = (channelID: string) => `/channels/${channelID}` as const;",
        "// Line_Reference 56: export const CHANNEL_BULK_DELETE_MESSAGES            = (channelID: string) => `/channels/${channelID}/messages/bulk-delete` as const;",
        "// Line_Reference 57: export const CHANNEL_FOLLOWERS                       = (channelID: string) => `/channels/${channelID}/followers` as const;",
        "// Line_Reference 58: export const CHANNEL_INVITES                         = (channelID: string) => `/channels/${channelID}/invites` as const;",
        "// Line_Reference 59: export const CHANNEL_JOINED_PRIVATE_ARCHIVED_THREADS = (channelID: string) => `/channels/${channelID}/users/@me/threads/archived/private` as const;",
        "// Line_Reference 60: export const CHANNEL_MESSAGE                         = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}` as const;",
        "// Line_Reference 61: export const CHANNEL_MESSAGES                        = (channelID: string) => `/channels/${channelID}/messages` as const;",
        "// Line_Reference 62: export const CHANNEL_MESSAGES_CROSSPOST              = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/crosspost` as const;",
        "// Line_Reference 63: export const CHANNEL_MESSAGE_THREADS                 = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/threads` as const;",
        "// Line_Reference 64: export const CHANNEL_PERMISSION                      = (channelID: string, overwriteID: string) => `/channels/${channelID}/permissions/${overwriteID}` as const;",
        "// Line_Reference 65: export const CHANNEL_PERMISSIONS                     = (channelID: string) => `/channels/${channelID}/permissions` as const;",
        "// Line_Reference 66: export const CHANNEL_PINNED_MESSAGE                  = (channelID: string, messageID: string) => `/channels/${channelID}/pins/${messageID}` as const;",
        "// Line_Reference 67: export const CHANNEL_PINS                            = (channelID: string) => `/channels/${channelID}/pins` as const;",
        "// Line_Reference 68: export const CHANNEL_PRIVATE_ARCHIVED_THREADS        = (channelID: string) => `/channels/${channelID}/threads/archived/private` as const;",
        "// Line_Reference 69: export const CHANNEL_PUBLIC_ARCHIVED_THREADS         = (channelID: string) => `/channels/${channelID}/threads/archived/public` as const;",
        "// Line_Reference 70: export const CHANNEL_REACTION                        = (channelID: string, messageID: string, reaction: string) => `/channels/${channelID}/messages/${messageID}/reactions/${reaction}` as const;",
        "// Line_Reference 71: export const CHANNEL_REACTIONS                       = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/reactions` as const;",
        "// Line_Reference 72: export const CHANNEL_REACTION_USER                   = (channelID: string, messageID: string, reaction: string, user: string) => `/channels/${channelID}/messages/${messageID}/reactions/${reaction}/${user}` as const;",
        "// Line_Reference 73: export const CHANNEL_THREADS                         = (channelID: string) => `/channels/${channelID}/threads` as const;",
        "// Line_Reference 74: export const CHANNEL_THREAD_MEMBER                   = (channelID: string, userID: string) => `/channels/${channelID}/thread-members/${userID}` as const;",
        "// Line_Reference 75: export const CHANNEL_THREAD_MEMBERS                  = (channelID: string) => `/channels/${channelID}/thread-members` as const;",
        "// Line_Reference 76: export const CHANNEL_TYPING                          = (channelID: string) => `/channels/${channelID}/typing` as const;",
        "// Line_Reference 77: export const GROUP_RECIPIENT                         = (channelID: string, userID: string) => `/channels/${channelID}/recipients/${userID}` as const;",
        "// Line_Reference 78: export const VOICE_REGIONS                           = \"/voice/regions\" as const;",
        "// Line_Reference 79: export const GUILD_VOICE_REGIONS                     = (guildID: string) => `/guilds/${guildID}/regions` as const;",
        "// Line_Reference 80: export const VOICE_STATUS                            = (channelID: string) => `/channels/${channelID}/voice-status` as const;",
        "// Line_Reference 81: export const POLL_ANSWER_USERS                       = (channelID: string, pollID: string, answerID: number) => `/channels/${channelID}/polls/${pollID}/answers/${answerID}` as const;",
        "// Line_Reference 82: export const POLL_EXPIRE                             = (channelID: string, pollID: string) => `/channels/${channelID}/polls/${pollID}/expire` as const;",
        "// Line_Reference 85: export const OAUTH_APPLICATION         = \"/oauth2/applications/@me\" as const;",
        "// Line_Reference 86: export const OAUTH_AUTHORIZE           = \"/oauth2/authorize\" as const;",
        "// Line_Reference 87: export const OAUTH_INFO                = \"/oauth2/@me\" as const;",
        "// Line_Reference 88: export const OAUTH_CURRENT_USER        = \"/users/@me\" as const;",
        "// Line_Reference 89: export const OAUTH_CHANNELS            = \"/users/@me/channels\" as const;",
        "// Line_Reference 90: export const OAUTH_CONNECTIONS         = \"/users/@me/connections\" as const;",
        "// Line_Reference 91: export const OAUTH_GUILD               = (guildID: string) => `/users/@me/guilds/${guildID}` as const;",
        "// Line_Reference 92: export const OAUTH_GUILD_MEMBER        = (guildID: string) => `${OAUTH_GUILD(guildID)}/member` as const;",
        "// Line_Reference 93: export const OAUTH_GUILDS              = \"/users/@me/guilds\" as const;",
        "// Line_Reference 94: export const OAUTH_TOKEN               = \"/oauth2/token\" as const;",
        "// Line_Reference 95: export const OAUTH_TOKEN_REVOKE        = \"/oauth2/token/revoke\" as const;",
        "// Line_Reference 96: export const OAUTH_ROLE_CONNECTION     = (applicationID: string) => `/users/@me/applications/${applicationID}/role-connection` as const;",
        "// Line_Reference 97: export const ROLE_CONNECTIONS_METADATA = (applicationID: string) => `/applications/${applicationID}/role-connections/metadata` as const;",
        "// Line_Reference 100: export const ACHIEVEMENT_ICON            = (applicationID: string, achievementID: string, hash: string) => `/app-assets/${applicationID}/achievements/${achievementID}/icons/${hash}` as const;",
        "// Line_Reference 101: export const APPLICATION_ASSET           = (applicationID: string, assetID: string) => `/applications/${applicationID}/assets/${assetID}` as const;",
        "// Line_Reference 102: export const APPLICATION_COVER           = (applicationID: string, hash: string) => `/app-icons/${applicationID}/${hash}` as const;",
        "// Line_Reference 104: export const BANNER                      = (guildOrUserID: string, hash: string) => `/banners/${guildOrUserID}/${hash}` as const;",
        "// Line_Reference 105: export const CUSTOM_EMOJI                = (emojiID: string) => `/emojis/${emojiID}` as const;",
        "// Line_Reference 106: export const EMBED_AVATAR                = (mod: number) => `/embed/avatars/${mod}` as const;",
        "// Line_Reference 107: export const GUILD_AVATAR                = (guildID: string, userID: string, hash: string) => `/guilds/${guildID}/users/${userID}/avatars/${hash}` as const;",
        "// Line_Reference 108: export const GUILD_DISCOVERY_SPLASH      = (guildID: string, hash: string) => `/guilds/${guildID}/splashes/${hash}` as const;",
        "// Line_Reference 109: export const GUILD_ICON                  = (guildID: string, hash: string) => `/icons/${guildID}/${hash}` as const;",
        "// Line_Reference 110: export const GUILD_SCHEDULED_EVENT_COVER = (eventID: string, hash: string) => `/guild-events/${eventID}/${hash}` as const;",
        "// Line_Reference 111: export const GUILD_SPLASH                = (guildID: string, hash: string) => `/splashes/${guildID}/${hash}` as const;",
        "// Line_Reference 112: export const MEMBER_BANNER               = (guildID: string, userID: string, hash: string) => `/guilds/${guildID}/users/${userID}/banners/${hash}` as const;",
        "// Line_Reference 113: export const ROLE_ICON                   = (roleID: string, hash: string) => `/role-icons/${roleID}/${hash}` as const;",
        "// Line_Reference 114: export const STICKER                     = (stickerID: string) => `/stickers/${stickerID}` as const;",
        "// Line_Reference 116: export const TEAM_ICON                   = (teamID: string, hash: string) => `/team-icons/${teamID}/${hash}` as const;",
        "// Line_Reference 117: export const USER_AVATAR                 = (userID: string, hash: string) => `/avatars/${userID}/${hash}` as const;",
        "// Line_Reference 118: export const USER_AVATAR_DECORATION      = (userID: string, hash: string) => `/avatar-decorations/${userID}/${hash}` as const;",
        "// Line_Reference 121: export const APPLICATION_COMMAND                   = (applicationID: string, commandID: string) => `/applications/${applicationID}/commands/${commandID}` as const;",
        "// Line_Reference 122: export const APPLICATION_COMMANDS                  = (applicationID: string) => `/applications/${applicationID}/commands` as const;",
        "// Line_Reference 123: export const GUILD_APPLICATION_COMMAND             = (applicationID: string, guildID: string, commandID: string) => `/applications/${applicationID}/guilds/${guildID}/commands/${commandID}` as const;",
        "// Line_Reference 124: export const GUILD_APPLICATION_COMMANDS            = (applicationID: string, guildID: string) => `/applications/${applicationID}/guilds/${guildID}/commands` as const;",
        "// Line_Reference 125: export const GUILD_APPLICATION_COMMAND_PERMISSION  = (applicationID: string, guildID: string, commandID: string) => `/applications/${applicationID}/guilds/${guildID}/commands/${commandID}/permissions` as const;",
        "// Line_Reference 126: export const GUILD_APPLICATION_COMMAND_PERMISSIONS = (applicationID: string, guildID: string) => `/applications/${applicationID}/guilds/${guildID}commands/permissions` as const;",
        "// Line_Reference 127: export const INTERACTION_CALLBACK                  = (interactionID: string, interactionToken: string) => `/interactions/${interactionID}/${interactionToken}/callback` as const;",
        "// Line_Reference 128: export const APPLICATION                           = \"/applications/@me\" as const;",
        "// Line_Reference 129: export const ENTITLEMENTS                          = (applicationID: string) => `/applications/${applicationID}/entitlements` as const;",
        "// Line_Reference 130: export const ENTITLEMENT                           = (applicationID: string, entitlementID: string) => `/applications/${applicationID}/entitlements/${entitlementID}` as const;",
        "// Line_Reference 131: export const SKUS                                  = (applicationID: string) => `/applications/${applicationID}/skus` as const;",
        "// Line_Reference 134: export const GATEWAY                   = \"/gateway\" as const;",
        "// Line_Reference 135: export const GATEWAY_BOT               = \"/gateway/bot\" as const;",
        "// Line_Reference 136: export const USER                      = (userID: string) => `/users/${userID}` as const;",
        "// Line_Reference 137: export const MESSAGE_LINK              = (guildID: string, channelID: string, messageID: string) => `/channels/${guildID}/${channelID}/${messageID}` as const;",
        "// Line_Reference 138: export const STICKER_PACKS             = \"/sticker-packs\" as const;",
        "// Line_Reference 139: export const INVITE                    = (code: string) => `/invites/${code}` as const;",
        "// Line_Reference 140: export const STAGE_INSTANCES           = \"/stage-instances\" as const;",
        "// Line_Reference 141: export const STAGE_INSTANCE            = (channelID: string) => `/stage-instances/${channelID}` as const;",
        "// Line_Reference 142: export const REFRESH_ATTACHMENT_URLS   = \"/attachments/refresh-urls\" as const;"
    ]
}
