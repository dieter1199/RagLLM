{
    "cve_id": "CVE-2022-2084",
    "cve_description": "Sensitive data could be exposed in world readable logs of cloud-init before version 22.3 when schema failures are reported. This leak could include hashed passwords.",
    "cve_publish_date": "2023-04-19",
    "cwe_id": "CWE-532",
    "cwe_name": "Insertion of Sensitive Information into Log File",
    "cwe_description": "Information written to log files can be of a sensitive nature and give valuable guidance to an attacker or expose sensitive user information.",
    "commit_message": "Remove schema errors from log (#1551)\n\nWhen schema errors are encountered, the section of userdata in question\r\ngets printed to the cloud-init log. As this could contain sensitive\r\ndata, so log a generic warning instead and redirect user to run\r\ncloud-init schema --system as root.\r\n\r\nLP: #1978422\r\nCVE: 2022-2084",
    "type_of_change": "Modification",
    "filename_of_changes": "test_cli.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 23: updates:",
        "// Line_Reference 24:  notnetwork: -1",
        "// Line_Reference 25: apt_pipelining: bogus",
        "// Line_Reference 72:         \"[WARNING]: Invalid cloud-config provided:\\napt_pipelining: 'bogus'\"",
        "// Line_Reference 73:         \" is not valid under any of the given schemas\\nupdates: Additional\"",
        "// Line_Reference 74:         \" properties are not allowed ('notnetwork' was unexpected)\""
    ]
}
