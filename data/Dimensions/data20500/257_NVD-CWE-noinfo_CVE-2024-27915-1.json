{
    "cve_id": "CVE-2024-27915",
    "cve_description": "Sulu is a PHP content management system. Starting in verson 2.2.0 and prior to version 2.4.17 and 2.5.13, access to pages is granted regardless of role permissions for webspaces which have a security system configured and permission check enabled. Webspaces without do not have this issue. The problem is patched in versions 2.4.17 and 2.5.13. Some workarounds are available. One may apply the patch to `vendor/symfony/security-http/HttpUtils.php` manually or avoid installing `symfony/security-http` versions greater equal than `v5.4.30` or `v6.3.6`.",
    "cve_publish_date": "2024-03-06",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Merge pull request from GHSA-jr83-m233-gg6p\n\n* Fix setting of Webspace Security System before Symfony RouteListener\n\n* Fix Redirect for Security System checker error\n\n* Add test case to avoid regression\n\n* Add test for none secured pages\n\n* Fix some PHP 7.2 issues\n\n* Remmove website based system listener test\n\n* Activate security only for specific test\n\n* Remove old ContentRouteProviderTests\n\n* Fix phpcs\n\n* Skip security listener test for older symfony security system\n\n* Fix code style\n\n* Fix phpstan issues\n\n* Throw deprecation when requestAnalyzer is still given\n\n* Fix code style\n\n* Mark new service as internal and final",
    "type_of_change": "Modification",
    "filename_of_changes": "ContentRouteProvider.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 27: use Sulu\\Component\\Security\\Authorization\\PermissionTypes;",
        "// Line_Reference 29: use Sulu\\Component\\Security\\Authorization\\SecurityCondition;",
        "// Line_Reference 169:             if ($this->securityChecker && $portal->getWebspace()->hasWebsiteSecurity()) {",
        "// Line_Reference 170:                 $this->securityChecker->checkPermission(",
        "// Line_Reference 171:                     new SecurityCondition(",
        "// Line_Reference 172:                         'sulu.webspaces.' . $document->getWebspaceName(),",
        "// Line_Reference 173:                         $document->getLocale(),",
        "// Line_Reference 174:                         \\get_class($document),",
        "// Line_Reference 175:                         $document->getUuid()",
        "// Line_Reference 176:                     ),",
        "// Line_Reference 177:                     PermissionTypes::VIEW",
        "// Line_Reference 178:                 );",
        "// Line_Reference 179:             }",
        "// Line_Reference 180: "
    ]
}
