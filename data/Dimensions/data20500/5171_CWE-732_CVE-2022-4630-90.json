{
    "cve_id": "CVE-2022-4630",
    "cve_description": "Sensitive Cookie Without 'HttpOnly' Flag in GitHub repository lirantal/daloradius prior to master.",
    "cve_publish_date": "2022-12-21",
    "cwe_id": "CWE-732",
    "cwe_name": "Incorrect Permission Assignment for Critical Resource",
    "cwe_description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
    "commit_message": "Improved attribute dictionaries management feature (#316)\n\nImproved layout and other minor features",
    "type_of_change": "Modification",
    "filename_of_changes": "mng-rad-attributes-new.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "179",
    "number_of_lines_deleted_vulnerable_to_cve": "141",
    "vulnerable_lines": [
        "// Line_Reference 35:     if (isset($_POST[\"submit\"])) {",
        "// Line_Reference 36: ",
        "// Line_Reference 37:         isset($_POST['vendor']) ? $vendor = $_POST['vendor'] : $vendor = \"\";",
        "// Line_Reference 38:         isset($_POST['attribute']) ? $attribute = $_POST['attribute'] : $attribute = \"\";",
        "// Line_Reference 39:         isset($_POST['type']) ? $type = $_POST['type'] : $type = \"\";",
        "// Line_Reference 40:         isset($_POST['RecommendedOP']) ? $RecommendedOP = $_POST['RecommendedOP'] : $RecommendedOP = \"\";",
        "// Line_Reference 41:         isset($_POST['RecommendedTable']) ? $RecommendedTable = $_POST['RecommendedTable'] : $RecommendedTable = \"\";",
        "// Line_Reference 42:         isset($_POST['RecommendedTooltip']) ? $RecommendedTooltip = $_POST['RecommendedTooltip'] : $RecommendedTooltip = \"\";",
        "// Line_Reference 43: ",
        "// Line_Reference 44:         include 'library/opendb.php';",
        "// Line_Reference 45: ",
        "// Line_Reference 46:         $sql = \"SELECT * FROM \".$configValues['CONFIG_DB_TBL_DALODICTIONARY'].\" WHERE vendor='\".$dbSocket->escapeSimple($vendor).",
        "// Line_Reference 47:             \"' AND attribute='\".$dbSocket->escapeSimple($attribute).\"'\";",
        "// Line_Reference 48:         $res = $dbSocket->query($sql);",
        "// Line_Reference 49:         $logDebugSQL .= $sql . \"\\n\";",
        "// Line_Reference 50: ",
        "// Line_Reference 51:         if ($res->numRows() == 0) {",
        "// Line_Reference 52:             if (trim($vendor) != \"\" and trim($attribute) != \"\") {",
        "// Line_Reference 53:                 // insert vendor/attribute pairs to database",
        "// Line_Reference 54:                 $sql = \"INSERT INTO \".$configValues['CONFIG_DB_TBL_DALODICTIONARY'].",
        "// Line_Reference 55:                     \" (id, type, attribute, vendor, RecommendedOP, RecommendedTable, RecommendedTooltip) VALUES (0, '\".",
        "// Line_Reference 56:                     $dbSocket->escapeSimple($type).\"', '\".$dbSocket->escapeSimple($attribute).\"','\".",
        "// Line_Reference 57:                     $dbSocket->escapeSimple($vendor).\"','\".    $dbSocket->escapeSimple($RecommendedOP).\"','\".",
        "// Line_Reference 58:                     $dbSocket->escapeSimple($RecommendedTable).\"','\".$dbSocket->escapeSimple($RecommendedTooltip).\"')\";",
        "// Line_Reference 59:                 $res = $dbSocket->query($sql);",
        "// Line_Reference 60:                 $logDebugSQL .= $sql . \"\\n\";",
        "// Line_Reference 62:                 $successMsg = \"Added to database new vendor attribute: <b>$attribute</b> of vendor: <b>$vendor</b>\";",
        "// Line_Reference 63:                 $logAction .= \"Successfully added new vendor [$vendor] and attribute [$attribute] on page: \";",
        "// Line_Reference 65:                 $failureMsg = \"You must provide atleast a vendor name and attribute\";",
        "// Line_Reference 66:                 $logAction .= \"Failed adding new vendor [$vendor] and attribute [$attribute] on page: \";",
        "// Line_Reference 68:         } else {",
        "// Line_Reference 69:             $failureMsg = \"You have tried to add a vendor's attribute that already exist in the database: $attribute\";",
        "// Line_Reference 70:             $logAction .= \"Failed adding new vendor attribute already in database [$attribute] on page: \";",
        "// Line_Reference 72: ",
        "// Line_Reference 73:         include 'library/closedb.php';",
        "// Line_Reference 74: ",
        "// Line_Reference 76: ",
        "// Line_Reference 77: ",
        "// Line_Reference 78:     include_once(\"lang/main.php\");",
        "// Line_Reference 79:     include(\"library/layout.php\");",
        "// Line_Reference 80: ",
        "// Line_Reference 94: ?>",
        "// Line_Reference 95: ",
        "// Line_Reference 96: <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">",
        "// Line_Reference 97: ",
        "// Line_Reference 98:     <fieldset>",
        "// Line_Reference 99: ",
        "// Line_Reference 100:         <h302> <?php echo t('title','VendorAttribute'); ?> </h302>",
        "// Line_Reference 101:         <br/>",
        "// Line_Reference 103:         <ul>",
        "// Line_Reference 105:         <li class='fieldset'>",
        "// Line_Reference 106:         <label for='vendor' class='form'><?php echo t('all','VendorName') ?></label>",
        "// Line_Reference 107:         <input name='vendor' type='text' id='vendor' value='' tabindex=100 />",
        "// Line_Reference 108:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('vendorNameTooltip')\" />",
        "// Line_Reference 110:         <div id='vendorNameTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 111:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 112:             <?php echo t('Tooltip','vendorNameTooltip') ?>",
        "// Line_Reference 113:         </div>",
        "// Line_Reference 114:         </li>",
        "// Line_Reference 115: ",
        "// Line_Reference 116:         <li class='fieldset'>",
        "// Line_Reference 117:         <label for='attribute' class='form'><?php echo t('all','Attribute') ?></label>",
        "// Line_Reference 118:         <input name='attribute' type='text' id='attribute' value='' tabindex=101 />",
        "// Line_Reference 119:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('attributeTooltip')\" />",
        "// Line_Reference 120: ",
        "// Line_Reference 121:         <div id='attributeTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 122:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 123:             <?php echo t('Tooltip','attributeTooltip') ?>",
        "// Line_Reference 124:         </div>",
        "// Line_Reference 125:         </li>",
        "// Line_Reference 126: ",
        "// Line_Reference 127:         <li class='fieldset'>",
        "// Line_Reference 128:         <label for='type' class='form'><?php echo t('all','Type') ?></label>",
        "// Line_Reference 129:         <select name='type' type='text' id='type' class='form' tabindex=102 />",
        "// Line_Reference 130:             <option value=''>Select Type...</option>",
        "// Line_Reference 131:         <?php",
        "// Line_Reference 132:             include_once('include/management/populate_selectbox.php');",
        "// Line_Reference 133:             drawTypes();",
        "// Line_Reference 134:         ?>",
        "// Line_Reference 135:         </select>",
        "// Line_Reference 136:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('typeTooltip')\" />",
        "// Line_Reference 138:         <div id='typeTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 139:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 140:             <?php echo t('Tooltip','typeTooltip') ?>",
        "// Line_Reference 141:         </div>",
        "// Line_Reference 142:         </li>",
        "// Line_Reference 143: ",
        "// Line_Reference 144:         <li class='fieldset'>",
        "// Line_Reference 145:         <label for='RecommendedOP' class='form'><?php echo t('all','RecommendedOP') ?></label>",
        "// Line_Reference 146:         <select name='RecommendedOP' id='RecommendedOP' class='form' tabindex=103 />",
        "// Line_Reference 147:             <option value=''>Select OP...</option>",
        "// Line_Reference 148:         <?php",
        "// Line_Reference 149:             include_once('include/management/populate_selectbox.php');",
        "// Line_Reference 150:             drawOptions();",
        "// Line_Reference 151:         ?>",
        "// Line_Reference 152:         </select>",
        "// Line_Reference 153:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('RecommendedOPTooltip')\" />",
        "// Line_Reference 155:         <div id='RecommendedOPTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 156:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 157:             <?php echo t('Tooltip','RecommendedOPTooltip') ?>",
        "// Line_Reference 158:         </div>",
        "// Line_Reference 159:         </li>",
        "// Line_Reference 160: ",
        "// Line_Reference 161:         <li class='fieldset'>",
        "// Line_Reference 162:         <label for='RecommendedTable' class='form'><?php echo t('all','RecommendedTable') ?></label>",
        "// Line_Reference 163:                 <select name='RecommendedTable' id='RecommendedTable' class='form' tabindex=104 />",
        "// Line_Reference 164:         <option value=''>Select Table...</option>",
        "// Line_Reference 165:         <?php",
        "// Line_Reference 166:             include_once('include/management/populate_selectbox.php');",
        "// Line_Reference 167:             drawTables();",
        "// Line_Reference 168:         ?>",
        "// Line_Reference 169:         </select>",
        "// Line_Reference 170:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('RecommendedTableTooltip')\" />",
        "// Line_Reference 172:         <div id='RecommendedTableTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 173:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 174:             <?php echo t('Tooltip','RecommendedTableTooltip') ?>",
        "// Line_Reference 175:         </div>",
        "// Line_Reference 176:         </li>",
        "// Line_Reference 177: ",
        "// Line_Reference 178:         <li class='fieldset'>",
        "// Line_Reference 179:         <label for='RecommendedTooltip' class='form'><?php echo t('all','RecommendedTooltip') ?></label>",
        "// Line_Reference 180:         <textarea class='form' name='RecommendedTooltip' type='text' id='RecommendedTooltip' tabindex=105 /></textarea>",
        "// Line_Reference 181:         <img src='images/icons/comment.png' alt='Tip' border='0' onClick=\"javascript:toggleShowDiv('RecommendedTooltipTooltip')\" />",
        "// Line_Reference 182:         <div id='RecommendedTooltipTooltip'  style='display:none;visibility:visible' class='ToolTip'>",
        "// Line_Reference 183:             <img src='images/icons/comment.png' alt='Tip' border='0' />",
        "// Line_Reference 184:             <?php echo t('Tooltip','RecommendedTooltipTooltip') ?>",
        "// Line_Reference 185:         </div>",
        "// Line_Reference 186:         </li>",
        "// Line_Reference 187: ",
        "// Line_Reference 189:         <li class='fieldset'>",
        "// Line_Reference 190:         <br/>",
        "// Line_Reference 191:         <hr><br/>",
        "// Line_Reference 192:         <input type='submit' name='submit' value='<?php echo t('buttons','apply') ?>' tabindex=10000 class='button' />",
        "// Line_Reference 193:         </li>",
        "// Line_Reference 194: ",
        "// Line_Reference 195:         </ul>",
        "// Line_Reference 196:     </fieldset>",
        "// Line_Reference 197: ",
        "// Line_Reference 198:     </form>",
        "// Line_Reference 199: ",
        "// Line_Reference 200: <?php"
    ]
}
