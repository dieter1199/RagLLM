{
    "cve_id": "CVE-2021-46462",
    "cve_description": "njs through 0.7.1, used in NGINX, was discovered to contain a segmentation violation via njs_object_set_prototype in /src/njs_object.c.",
    "cve_publish_date": "2022-02-14",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fixed Function.prototype.apply() with slow arrays.\n\nPreviously, the function had two issues:\n   * array->start was referenced without checking for fast array flag\n   * the created arguments list was not sanity-checked for its length,\n     which can be very large.\n\nThe fix is to remove micro-optimization for arrays and introduce limit\nsize for arguments list.\n\nThis closes #449 issue in Github.",
    "type_of_change": "Modification",
    "filename_of_changes": "njs_function.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 1388: ",
        "// Line_Reference 1389:         goto activate;",
        "// Line_Reference 1390: ",
        "// Line_Reference 1391:     } else if (njs_is_array(arr_like)) {",
        "// Line_Reference 1392:         arr = arr_like->data.u.array;",
        "// Line_Reference 1393: ",
        "// Line_Reference 1394:         args = arr->start;",
        "// Line_Reference 1395:         length = arr->length;",
        "// Line_Reference 1396: ",
        "// Line_Reference 1399:     } else if (njs_slow_path(!njs_is_object(arr_like))) {"
    ]
}
