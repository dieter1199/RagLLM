{
    "cve_id": "CVE-2018-18690",
    "cve_description": "In the Linux kernel before 4.17, a local attacker able to set attributes on an xfs filesystem could make this filesystem non-operational until the next mount by triggering an unchecked error condition during an xfs attribute change, because xfs_attr_shortform_addname in fs/xfs/libxfs/xfs_attr.c mishandles ATTR_REPLACE operations with conversion of an attr from short to long form.",
    "cve_publish_date": "2018-10-26",
    "cwe_id": "CWE-754",
    "cwe_name": "Improper Check for Unusual or Exceptional Conditions",
    "cwe_description": "The product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.",
    "commit_message": "xfs: don't fail when converting shortform attr to long form during ATTR_REPLACE\n\nKanda Motohiro reported that expanding a tiny xattr into a large xattr\nfails on XFS because we remove the tiny xattr from a shortform fork and\nthen try to re-add it after converting the fork to extents format having\nnot removed the ATTR_REPLACE flag.  This fails because the attr is no\nlonger present, causing a fs shutdown.\n\nThis is derived from the patch in his bug report, but we really\nshouldn't ignore a nonzero retval from the remove call.\n\nBugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=199119\nReported-by: kanda.motohiro@gmail.com\nReviewed-by: Dave Chinner <dchinner@redhat.com>\nReviewed-by: Christoph Hellwig <hch@lst.de>\nSigned-off-by: Darrick J. Wong <darrick.wong@oracle.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfs_attr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 514: \t\tASSERT(retval == 0);"
    ]
}
