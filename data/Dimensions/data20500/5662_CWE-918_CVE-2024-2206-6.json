{
    "cve_id": "CVE-2024-2206",
    "cve_description": "An SSRF vulnerability exists in the gradio-app/gradio due to insufficient validation of user-supplied URLs in the `/proxy` route. Attackers can exploit this vulnerability by manipulating the `self.replica_urls` set through the `X-Direct-Url` header in requests to the `/` and `/config` routes, allowing the addition of arbitrary URLs for proxying. This flaw enables unauthorized proxying of requests and potential access to internal endpoints within the Hugging Face space. The issue arises from the application's inadequate checking of safe URLs in the `build_proxy_request` function.",
    "cve_publish_date": "2024-03-27",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "[WIP] Refactor file normalization to be in the backend and remove it from the frontend of each component (#7183)\n\n* processing\r\n\r\n* add changeset\r\n\r\n* changes\r\n\r\n* add changeset\r\n\r\n* add changeset\r\n\r\n* changes\r\n\r\n* changes\r\n\r\n* clean\r\n\r\n* changes\r\n\r\n* add changeset\r\n\r\n* add changeset\r\n\r\n* root url\r\n\r\n* refactor\r\n\r\n* testing\r\n\r\n* testing\r\n\r\n* log\r\n\r\n* logs\r\n\r\n* fix\r\n\r\n* format\r\n\r\n* add changeset\r\n\r\n* remove\r\n\r\n* add root\r\n\r\n* format\r\n\r\n* apply to everything\r\n\r\n* annoying fix\r\n\r\n* fixes\r\n\r\n* lint\r\n\r\n* fixes\r\n\r\n* fixes\r\n\r\n* fixes\r\n\r\n* fix tests\r\n\r\n* fix js tests\r\n\r\n* format\r\n\r\n* fix python tests\r\n\r\n* clean guides\r\n\r\n* add changeset\r\n\r\n* add changeset\r\n\r\n* simplify\r\n\r\n* add changeset\r\n\r\n---------\r\n\r\nCo-authored-by: gradio-pr-bot <gradio-pr-bot@users.noreply.github.com>\r\nCo-authored-by: pngwn <hello@pngwn.io>",
    "type_of_change": "Modification",
    "filename_of_changes": "utils.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 898: FILE_DATA = \"Dict(path: str, url: str | None, size: int | None, orig_name: str | None, mime_type: str | None)\""
    ]
}
