{
    "cve_id": "CVE-2021-25958",
    "cve_description": "In Apache Ofbiz, versions v17.12.01 to v17.12.07 implement a try catch exception to handle errors at multiple locations but leaks out sensitive table info which may aid the attacker for further recon. A user can register with a very long password, but when he tries to login with it an exception occurs.",
    "cve_publish_date": "2021-08-30",
    "cwe_id": "CWE-209",
    "cwe_name": "Generation of Error Message Containing Sensitive Information",
    "cwe_description": "The product generates an error message that includes sensitive information about its environment, users, or associated data.",
    "commit_message": "Fixed: UserLoginHistory failed the store operation with large password (OFBIZ-12287)\n\nBackport 2aa68dc4de8892e8a7cbb38c10a3a3dd65d233e5 from trunk\n\nWhen you have a user with long password (greater than 256 characters) present in OFBiz and you try to log with, OFBiz return a long error message with sensitive information due to exceeding value size to store on the field UserLoginHistory.passwordUsed.\n\nTo solve this we don't return any information on the genericValue that failed and analyze the field passwordUsed to escape the case where the password set to login is create than the database field capacity.\n\nThanks to Daniel Elkabes <daniel.elkabes@whitesourcesoftware.com> and Hagai Wechsler <hagai.wechsler@whitesourcesoftware.com> from white source software to raise the problem.",
    "type_of_change": "Modification",
    "filename_of_changes": "LoginServices.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 337:                                         if (\"N\".equals(successfulLogin) && !\"false\".equals(EntityUtilProperties.getPropertyValue(\"security\", \"store.login.history.incorrect.password\", delegator))) {",
        "// Line_Reference 338:                                             ulhCreateMap.put(\"passwordUsed\", password);",
        "// Line_Reference 349:                                 geeErrMsg += \": \" + e.toString();"
    ]
}
