{
    "cve_id": "CVE-2022-4968",
    "cve_description": "netplan leaks the private key of wireguard to local users. Versions after 1.0 are not affected.",
    "cve_publish_date": "2024-06-07",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "libnetplan: use more restrictive file permissions\n\nA new util.c:_netplan_g_string_free_to_file_with_permissions() was added\nand accepts the owner, group and file mode as arguments. When these\nproperties can't be set, when the generator is called by a non-root user\nfor example, it will not hard-fail. This function is called by unit\ntests where we can't set the owner to a privileged account for example.\n\nWhen generating backend files, use more restrictive permissions:\n\nnetworkd related files will be owned by root:systemd-network and have\nmode 0640.\n\nservice unit files will be owned by root:root and have mode 0640.\nudevd files will be owned by root:root with mode 0640.\n\nwpa_supplicant and Network Manager files will continue with the existing\npermissions.\n\nAutopkgtests will check if the permissions are set as expected when\ncalling the generator.\n\nThis fix addresses CVE-2022-4968",
    "type_of_change": "Modification",
    "filename_of_changes": "test_wifis.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 143:             self.assertEqual(stat.S_IMODE(os.fstat(f.fileno()).st_mode), 0o644)"
    ]
}
