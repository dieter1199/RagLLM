{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "StudentReenroll.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "39",
    "vulnerable_lines": [
        "// Line_Reference 33: ",
        "// Line_Reference 34:     if (!VerifyDate($start_date))",
        "// Line_Reference 35:     {",
        "// Line_Reference 36: //        $start_date=date('Y-m-d',strtotime($start_date));",
        "// Line_Reference 46:         foreach($_REQUEST['student'] as $this_stu)",
        "// Line_Reference 47:         {",
        "// Line_Reference 53:         $start_date=date('Y-m-d',strtotime($start_date));",
        "// Line_Reference 55: ",
        "// Line_Reference 57:         foreach($req_stu as $student_id => $yes) {",
        "// Line_Reference 69:                 $enroll_msg = \"\"._selectedStudentsAreSuccessfullyReEnrolled.\".\";",
        "// Line_Reference 76:             if ($enroll_msg != '' && $enroll_msg == ''._selectedStudentsAreSuccessfullyReEnrolled.'' && count($id_array) > 0) {",
        "// Line_Reference 77:                 $enroll_msg.= \"&nbsp but &nbsp;\" . implode(\",\", $id_array) . \" &nbsp;\"._cannotBeReenrolledBecauseReenrollDateAndDropDateAreSameOrReenrollmentDateIsBeforeEndDate.\" \";",
        "// Line_Reference 85:                 $enroll_msg = $s . \" \" . implode(\",\", $id_array) . \" &nbsp;\"._cannotBeReenrolledBecauseReenrollDateAndDropDateAreSameOrReenrollmentDateIsBeforeEndDate.\" \";",
        "// Line_Reference 89:         $err = \"<div class=\\\"alert bg-danger alert-styled-left\\\">\"._noStudentsAreSelected.\"</div>\";",
        "// Line_Reference 94: DrawBC(\"\"._students.\" > \" . ProgramTitle());",
        "// Line_Reference 106:     echo '<div class=\"form-group\"><label class=\"control-label col-lg-4 text-right\">'._startDate.' <span class=\"text-danger\">*</span></label><div class=\"col-lg-8\">' . DateInputAY(DBDate('mysql'), 'start', 1) . '</div></div>';",
        "// Line_Reference 108:     echo '<div class=\"form-group\"><label class=\"control-label col-lg-4 text-right\">'._grade.' <span class=\"text-danger\">*</span></label><div class=\"col-lg-8\">';",
        "// Line_Reference 109: ",
        "// Line_Reference 111:     echo '<SELECT class=\"form-control\" name=grade_id id=grade_id><OPTION value=\"\">'._selectGrade.'</OPTION>';",
        "// Line_Reference 120:     echo '<div class=\"form-group\"><label class=\"control-label col-lg-4 text-right\">'._enrollmentCode.' <span class=\"text-danger\">*</span></label><div class=\"col-lg-8\">';",
        "// Line_Reference 121:     $enroll_code = DBGet(DBQuery('SELECT TITLE,ID FROM student_enrollment_codes WHERE SYEAR=\\'' . UserSyear() . '\\' AND TYPE IN (\\'' . Add . '\\',\\'' . TrnE . '\\',\\'' . Roll . '\\')'));",
        "// Line_Reference 122:     echo '<SELECT class=form-control name=en_code id=en_code><OPTION value=\"\">'._selectEnrollCode.'</OPTION>';",
        "// Line_Reference 131: if ($enroll_msg)",
        "// Line_Reference 132: {",
        "// Line_Reference 134:     echo '<div class=\"alert alert-success alert-styled-left alert-bordered\">'. $enroll_msg .'</div>';",
        "// Line_Reference 136: if ($err)",
        "// Line_Reference 137: {",
        "// Line_Reference 139:     echo '<div class=\"alert alert-danger alert-styled-left alert-bordered\">'. $err .'</div>';",
        "// Line_Reference 143:     $extra['link'] = array('FULL_NAME' =>false);",
        "// Line_Reference 164: // function _makeChooseCheckbox() {",
        "// Line_Reference 165: //     global $THIS_RET;",
        "// Line_Reference 166: ",
        "// Line_Reference 167: //     return \"<INPUT class=re_enroll type=checkbox name=student[\" . $THIS_RET['STUDENT_ID'] . \"] value=Y>\";",
        "// Line_Reference 168: // }",
        "// Line_Reference 169: ",
        "// Line_Reference 170: function _makeChooseCheckbox($value, $title) {",
        "// Line_Reference 173:     return \"<input class=re_enroll name=student[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[$THIS_RET[STUDENT_ID]]\\\",this,$THIS_RET[STUDENT_ID]);' />\";",
        "// Line_Reference 195: ",
        "// Line_Reference 196: ?>"
    ]
}
