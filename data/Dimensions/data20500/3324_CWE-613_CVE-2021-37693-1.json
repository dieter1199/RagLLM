{
    "cve_id": "CVE-2021-37693",
    "cve_description": "Discourse is an open-source platform for community discussion. In Discourse before versions 2.7.8 and 2.8.0.beta4, when adding additional email addresses to an existing account on a Discourse site an email token is generated as part of the email verification process. Deleting the additional email address does not invalidate an unused token which can then be used in other contexts, including reseting a password.",
    "cve_publish_date": "2021-08-13",
    "cwe_id": "CWE-613",
    "cwe_name": "Insufficient Session Expiration",
    "cwe_description": "According to WASC, \"Insufficient Session Expiration is when a web site permits an attacker to reuse old session credentials or session IDs for authorization.\"",
    "commit_message": "SECURITY: Destroy `EmailToken` when `EmailChangeRequest` is destroyed (#13950)",
    "type_of_change": "Modification",
    "filename_of_changes": "email_change_request.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 4:   belongs_to :old_email_token, class_name: 'EmailToken'",
        "// Line_Reference 5:   belongs_to :new_email_token, class_name: 'EmailToken'"
    ]
}
