{
    "cve_id": "CVE-2021-47208",
    "cve_description": "The Mojolicious module before 9.11 for Perl has a bug in format detection that can potentially be exploited for denial of service.",
    "cve_publish_date": "2024-04-08",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Flip format detection to fix a security issue (closes #1736)",
    "type_of_change": "Modification",
    "filename_of_changes": "routes.t",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 39: $r->any('/optional/:foo/:bar')->to(bar => 'test');",
        "// Line_Reference 44: $r->any('/optional2/:foo')->to(foo => 'one')->any('/:bar')->to(bar => 'two');",
        "// Line_Reference 89: # /format.html",
        "// Line_Reference 90: $r->any('/format')->to(testcase => 'hello')->to(action => 'you', format => 'html');",
        "// Line_Reference 122: $inline->any('/delete')->to(testcase => 'articles', action => 'delete', format => undef)->name('articles_delete');",
        "// Line_Reference 125: $r->any('/method/get')->methods('GET')->to(testcase => 'method', action => 'get');",
        "// Line_Reference 145: $versioned->any('/1.0')->to(testcase => 'bar')->any('/test')->to(action => 'baz');",
        "// Line_Reference 146: $versioned->any('/2.4')->to(testcase => 'foo')->any('/test')->to(action => 'bar');",
        "// Line_Reference 161: my $inactive = $r->any('/', [format => 0]);",
        "// Line_Reference 172: $source->any('/second')->to('#second');",
        "// Line_Reference 173: my $third  = $source->any('/third')->to('#third');",
        "// Line_Reference 186: $r->any('/slash')->to(testcase => 'just')->any('/')->to(action => 'slash');",
        "// Line_Reference 243: is $r->find('nodetect')->pattern->constraints->{format}, 0, 'right value';",
        "// Line_Reference 407: is $m->path_for->{path}, '/articles/1/delete', 'right path';",
        "// Line_Reference 614: is $m->path_for->{path}, '/method/get', 'right path';",
        "// Line_Reference 668: is_deeply $m->stack, [{testcase => 'bar', action => 'baz'}], 'right structure';",
        "// Line_Reference 673: is $m->path_for->{path}, '/versioned/1.0/test', 'right path';",
        "// Line_Reference 676: is_deeply $m->stack, [{testcase => 'foo', action => 'bar'}], 'right structure';",
        "// Line_Reference 681: is $m->path_for->{path}, '/versioned/2.4/test', 'right path';",
        "// Line_Reference 751: is_deeply $m->stack, [{controller => 'target', action => 'second'}], 'right structure';",
        "// Line_Reference 756: is $m->path_for->{path}, '/target/second', 'right path';",
        "// Line_Reference 762: is_deeply $m->stack, [{controller => 'source', action => 'third'}], 'right structure';",
        "// Line_Reference 767: is $m->path_for->{path}, '/source/third', 'right path';",
        "// Line_Reference 785: is $m->path_for->{path}, '/slash', 'right path';"
    ]
}
