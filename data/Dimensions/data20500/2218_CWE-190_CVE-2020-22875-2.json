{
    "cve_id": "CVE-2020-22875",
    "cve_description": "Integer overflow vulnerability in function Jsi_ObjSetLength in jsish before 3.0.6, allows remote attackers to execute arbitrary code.",
    "cve_publish_date": "2021-07-13",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Release \"3.0.6\": Fix crashes in Array for \"integer overflow #10\"\n\nFossilOrigin-Name: 50642d64b8f0a4e62df68e59fcb2ef0923c3dbec8fc8a15d38b1ddbe655c38d6",
    "type_of_change": "Modification",
    "filename_of_changes": "jsiArray.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "51",
    "vulnerable_lines": [
        "// Line_Reference 22:     int curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 23:     if (curlen < 0) {",
        "// Line_Reference 24:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 25:     }",
        "// Line_Reference 26: ",
        "// Line_Reference 34:     Jsi_ValueMakeNumber(interp, ret, Jsi_ObjGetLength(interp, obj));",
        "// Line_Reference 48:     int i = Jsi_ObjGetLength(interp, obj) - 1;",
        "// Line_Reference 81:     curlen = Jsi_ObjGetLength(interp, _this->d.obj);",
        "// Line_Reference 92:     if (0 == (argc=Jsi_ObjGetLength(interp, _this->d.obj))) {",
        "// Line_Reference 236:     int len = Jsi_ObjGetLength(interp, v->d.obj);",
        "// Line_Reference 258:     int i, n = 0, len = Jsi_ObjGetLength(interp, arr->d.obj);",
        "// Line_Reference 261:     int clen = Jsi_ObjGetLength(interp, nobj);",
        "// Line_Reference 305:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 306:     if (curlen < 0) {",
        "// Line_Reference 307:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 308:     }",
        "// Line_Reference 380:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 381:     if (curlen < 0) {",
        "// Line_Reference 382:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 383:     }",
        "// Line_Reference 442:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 443:     if (curlen < 0) {",
        "// Line_Reference 444:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 445:     }",
        "// Line_Reference 525:     int curlen;",
        "// Line_Reference 538:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 539:     if (curlen < 0) {",
        "// Line_Reference 540:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 541:     }",
        "// Line_Reference 569:     int curlen;",
        "// Line_Reference 582:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 583:     if (curlen < 0) {",
        "// Line_Reference 584:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 585:     }",
        "// Line_Reference 631:     int curlen, i;",
        "// Line_Reference 641:     curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 642:     if (curlen < 0)",
        "// Line_Reference 643:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 720:     n = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 772:     int i = Jsi_ObjGetLength(interp, _this->d.obj);",
        "// Line_Reference 783:     uint n = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 784:     assert(n <= obj->arrCnt);",
        "// Line_Reference 805:     int curlen = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 806:     if (curlen < 0) {",
        "// Line_Reference 807:         Jsi_ObjSetLength(interp, obj, 0);",
        "// Line_Reference 808:     }",
        "// Line_Reference 828:     Jsi_ValueMakeNumber(interp, ret, Jsi_ObjGetLength(interp, obj));",
        "// Line_Reference 842:     n = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 905:     n = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 1169:     n = Jsi_ObjGetLength(interp, obj);",
        "// Line_Reference 1205:         Jsi_ObjSetLength(interp, obj, 0);"
    ]
}
