{
    "cve_id": "CVE-2016-7838",
    "cve_description": "Untrusted search path vulnerability in WinSparkle versions prior to 0.5.3 allows remote attackers to execute arbitrary code via a specially crafted executable file in an unspecified directory.",
    "cve_publish_date": "2017-06-09",
    "cwe_id": "CWE-426",
    "cwe_name": "Untrusted Search Path",
    "cwe_description": "The product searches for critical resources using an externally-supplied search path that can point to resources that are not under the product's direct control.",
    "commit_message": "Verify UpdateTempDir isn't maliciously modified\n\nDon't just delete the stored updates temporary directory on launch, but\nvalidate the registry key to ensure it is in an expected location and\nfollows WinSparkle's naming convention. This is to prevent malicious\nusers from modifying this registry key and forcing the host app to\ndelete arbitrary directories (a user being able to delete the key would\nbe able to delete the directory themselves, so it's not a serious issue,\nbut it nevertheless is bad behavior and shouldn't be possible).",
    "type_of_change": "Modification",
    "filename_of_changes": "updatedownloader.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 56:     wchar_t tmpdir[MAX_PATH+1];",
        "// Line_Reference 57:     if ( GetTempPath(MAX_PATH+1, tmpdir) == 0 )",
        "// Line_Reference 58:         throw Win32Exception(\"Cannot create temporary directory\");",
        "// Line_Reference 63:         dir += L\"Update-\";",
        "// Line_Reference 64: "
    ]
}
