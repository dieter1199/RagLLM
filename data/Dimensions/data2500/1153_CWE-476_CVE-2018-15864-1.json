{
    "cve_id": "CVE-2018-15864",
    "cve_description": "Unchecked NULL pointer usage in resolve_keysym in xkbcomp/parser.y in xkbcommon before 0.8.2 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file, because a map access attempt can occur for a map that was never created.",
    "cve_publish_date": "2018-08-25",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "parser: Don't set more maps when we don't have any\n\nIf the scanner indicates that we might have something which looks like a\nmap, but the parser in fact fails to create that map, we will try to\naccess the map regardless. Stop doing that.\n\ntestcase: 'xkb_keymap {' -> '#kb_keymap'\n\nSigned-off-by: Daniel Stone <daniels@collabora.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "parser.y",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 242:                         { $$ = param->rtrn = $1; param->more_maps = true; }",
        "// Line_Reference 244:                         { $$ = param->rtrn = $1; param->more_maps = true; YYACCEPT; }"
    ]
}
