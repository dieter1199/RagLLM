{
    "cve_id": "CVE-2016-8897",
    "cve_description": "Exponent CMS version 2.3.9 suffers from a sql injection vulnerability in framework/modules/help/controllers/helpController.php.",
    "cve_publish_date": "2019-05-23",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "storeController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "54",
    "number_of_lines_deleted_vulnerable_to_cve": "57",
    "vulnerable_lines": [
        "// Line_Reference 27: ",
        "// Line_Reference 43: ",
        "// Line_Reference 57:     //protected $permissions = array_merge(array(\"test\"=>'Test'), array('copyProduct'=>\"Copy Product\"));",
        "// Line_Reference 58:     protected $add_permissions = array(",
        "// Line_Reference 59:         'copyProduct'                 => \"Copy Product\",",
        "// Line_Reference 60:         'delete_children'             => \"Delete Children\",",
        "// Line_Reference 61:         'reimport'                    => 'ReImport Products',",
        "// Line_Reference 62:         'findDupes'                   => 'Fix Duplicate SEF Names',",
        "// Line_Reference 63:         'manage_sales_reps'           => 'Manage Sales Reps',",
        "// Line_Reference 64:         'batch_process'               => 'Batch capture order transactions',",
        "// Line_Reference 65:         'process_orders'              => 'Batch capture order transactions',",
        "// Line_Reference 66:         'import_external_addresses'   => 'Import addresses from other sources',",
        "// Line_Reference 67:         'showallImpropercategorized'  => 'View products in top level categories that should not be',",
        "// Line_Reference 68:         'showallUncategorized'        => 'View all uncategorized products',",
        "// Line_Reference 69:         'nonUnicodeProducts'          => 'View all non-unicode charset products',",
        "// Line_Reference 70:         'cleanNonUnicodeProducts'     => 'Clean all non-unicode charset products',",
        "// Line_Reference 71:         'uploadModelAliases'          => 'Upload model aliases',",
        "// Line_Reference 72:         'processModelAliases'         => 'Process uploaded model aliases',",
        "// Line_Reference 73:         'saveModelAliases'            => 'Save uploaded model aliases',",
        "// Line_Reference 74:         'deleteProcessedModelAliases' => 'Delete processed uploaded model aliases',",
        "// Line_Reference 75:         'delete_model_alias'          => 'Process model aliases',",
        "// Line_Reference 76:         'update_model_alias'          => 'Save model aliases',",
        "// Line_Reference 77:         'edit_model_alias'            => 'Delete model aliases',",
        "// Line_Reference 78:         'import'                      => 'Import Products',",
        "// Line_Reference 79:         'export'                      => 'Export Products',",
        "// Line_Reference 80:     );",
        "// Line_Reference 81: ",
        "// Line_Reference 511:             $ancestors = $this->category->pathToNode();",
        "// Line_Reference 517:             {",
        "// Line_Reference 526:             $ancestors = $this->category->pathToNode();",
        "// Line_Reference 1277:             //eDebug($editable_options[$group->title]);",
        "// Line_Reference 1499:         //eDebug($product_type);",
        "// Line_Reference 1638:         //eDebug($this->params,true);",
        "// Line_Reference 1642:         if (empty($product->id)) // || empty($product->previous_id))",
        "// Line_Reference 1649:             //fwrite($lfh, \"Deleting:\" . $ctd->id . \"\\n\");",
        "// Line_Reference 1825:         //$sql .= \"GROUP BY p.id \";",
        "// Line_Reference 1854:         $req = 'a29f9shsgh32hsf80s7';",
        "// Line_Reference 1857:         {",
        "// Line_Reference 1860:             $successSet[$count]['message'] = \"Sucessfully imported row \" . $count . \", order: \" . $data[2] . \"<br/>\";",
        "// Line_Reference 1866:             $successSet[$count]['shipping_tracking_number'] = '1ZNF453937547';",
        "// Line_Reference 1870:         {",
        "// Line_Reference 1871:             $data[2] = $inv + $count;",
        "// Line_Reference 1872:             $amt += $count*$count;",
        "// Line_Reference 1878: ",
        "// Line_Reference 1879:         assign_to_template(array('errorSet'=>$errorSet, 'successSet'=>$successSet));",
        "// Line_Reference 1888:         //eDebug($this->params,true);",
        "// Line_Reference 1928:         //eDebug($data);",
        "// Line_Reference 2003:                         //just need to set the order shipping info, check and see if we send user an email, and set statuses.",
        "// Line_Reference 2004:                         //shipping info:",
        "// Line_Reference 2016:                         //$failMessage = \"Attempted to delay capture order \" . $data[2] . \" and it failed with the following error: \" . $result->errorCode . \" - \" .$result->message;",
        "// Line_Reference 2027: ",
        "// Line_Reference 2030:                             $order->save();",
        "// Line_Reference 2038:                         //continue;",
        "// Line_Reference 2041:                     //dont suppose we do anything here, as it may be set to approved manually",
        "// Line_Reference 2042:                     //$errorSet[$count] = \"Order \" . $data[2] . \" does not use a billing method with delayed capture ability.\";",
        "// Line_Reference 2129:             //eDebug($product);",
        "// Line_Reference 2234:         //eDebug($data);"
    ]
}
