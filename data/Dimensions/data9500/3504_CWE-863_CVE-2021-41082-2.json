{
    "cve_id": "CVE-2021-41082",
    "cve_description": "Discourse is a platform for community discussion. In affected versions any private message that includes a group had its title and participating user exposed to users that do not have access to the private messages. However, access control for the private messages was not compromised as users were not able to view the posts in the leaked private message despite seeing it in their inbox. The problematic commit was reverted around 32 minutes after it was made. Users are encouraged to upgrade to the latest commit if they are running Discourse against the `tests-passed` branch.",
    "cve_publish_date": "2021-09-20",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Partially revert \"PERF: Improve query performance all inbox private messages. (#14304)\" (#14344)\n\nThis partially reverts commit ddb458343dc39a7a8c99467dcd809b444514fe2c.\r\n\r\nSeeing performance degrade on larger sites so back to drawing board on\r\nthis one. Instead of the DISTINCT LEFT JOIN, we switch back to\r\nIN(subquery).",
    "type_of_change": "Modification",
    "filename_of_changes": "topics_controller.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 976:       topic_scope.distinct(false).pluck(:id),",
        "// Line_Reference 1248: ",
        "// Line_Reference 1249:       topic_query",
        "// Line_Reference 1250:         .filter_private_messages_unread(current_user, filter)",
        "// Line_Reference 1251:         .distinct(false)",
        "// Line_Reference 1252:         .pluck(:id)",
        "// Line_Reference 1271: ",
        "// Line_Reference 1272:       topics.pluck(:id)"
    ]
}
