{
    "cve_id": "CVE-2021-26927",
    "cve_description": "A flaw was found in jasper before 2.0.25. A null pointer dereference in jp2_decode in jp2_dec.c may lead to program crash and denial of service.",
    "cve_publish_date": "2021-02-23",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "Fixes #264.\n\nThe JP2 decoder was allowing the decoding of a code stream to be\nattempted when the stream has inconsistent values for the number of\ncomponents and/or the component types.  For such invalid streams,\nonly a warning would be issued and decoding would proceed.  This is\ndangerous, however, as it can lead to many unexpected paths through\nthe code, which in some cases have been demonstrated to result in\nsecurity vulnerabilities.  This code change makes decoding of these\ntypes invalid code streams a hard error.",
    "type_of_change": "Modification",
    "filename_of_changes": "jp2_dec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 235: \t\tjas_eprintf(\"warning: number of components mismatch\\n\");",
        "// Line_Reference 258: \t\tjas_eprintf(\"warning: component data type mismatch (IHDR)\\n\");",
        "// Line_Reference 270: \t\tif (dec->bpcc->data.bpcc.numcmpts != JAS_CAST(jas_uint, jas_image_numcmpts(",
        "// Line_Reference 271: \t\t  dec->image))) {",
        "// Line_Reference 272: \t\t\tjas_eprintf(\"warning: number of components mismatch\\n\");",
        "// Line_Reference 281: \t\t\t\t\tjas_eprintf(\"warning: component data type mismatch (BPCC)\\n\");"
    ]
}
