{
    "cve_id": "CVE-2021-23449",
    "cve_description": "This affects the package vm2 before 3.9.4 via a Prototype Pollution attack vector, which can lead to execution of arbitrary code on the host machine.",
    "cve_publish_date": "2021-10-18",
    "cwe_id": "CWE-1321",
    "cwe_name": "Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution')",
    "cwe_description": "The product receives input from an upstream component that specifies attributes that are to be initialized or updated in an object, but it does not properly control modifications of attributes of the object prototype.",
    "commit_message": "Security Fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "vm.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 913: \t\tit('Dynamic import attack', (done) => {",
        "// Line_Reference 914: \t\t\tprocess.once('unhandledRejection', (reason) => {",
        "// Line_Reference 915: \t\t\t\tassert.strictEqual(reason.message, 'process is not defined');",
        "// Line_Reference 916: \t\t\t\tdone();",
        "// Line_Reference 917: \t\t\t});",
        "// Line_Reference 921: \t\t\tvm2.run(`",
        "// Line_Reference 922: \t\t\t\t(async () => {",
        "// Line_Reference 923: \t\t\t\t\ttry {",
        "// Line_Reference 924: \t\t\t\t\t\tawait import('oops!');",
        "// Line_Reference 925: \t\t\t\t\t} catch (ex) {",
        "// Line_Reference 926: \t\t\t\t\t\t// ex is an instance of NodeError which is not proxied;",
        "// Line_Reference 927: \t\t\t\t\t\tconst process = ex.constructor.constructor('return process')();",
        "// Line_Reference 928: \t\t\t\t\t\tconst require = process.mainModule.require;",
        "// Line_Reference 929: \t\t\t\t\t\tconst child_process = require('child_process');",
        "// Line_Reference 930: \t\t\t\t\t\tconst output = child_process.execSync('id');",
        "// Line_Reference 931: \t\t\t\t\t\tprocess.stdout.write(output);",
        "// Line_Reference 932: \t\t\t\t\t}",
        "// Line_Reference 933: \t\t\t\t})();",
        "// Line_Reference 934: \t\t\t`);"
    ]
}
