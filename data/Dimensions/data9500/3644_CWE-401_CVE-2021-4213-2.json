{
    "cve_id": "CVE-2021-4213",
    "cve_description": "A flaw was found in JSS, where it did not properly free up all memory. Over time, the wasted memory builds up in the server memory, saturating the serverâ€™s RAM. This flaw allows an attacker to force the invocation of an out-of-memory process, causing a denial of service.",
    "cve_publish_date": "2022-08-24",
    "cwe_id": "CWE-401",
    "cwe_name": "Missing Release of Memory after Effective Lifetime",
    "cwe_description": "The product does not sufficiently track and release allocated memory after it has been used, which slowly consumes remaining memory.",
    "commit_message": "Fix memory leak on each TLS connection\n\nEach TLS connection is leaking a bunch of data that isn't in the heap\nand so after 25k requests Tomcat uses about 2.5GB resident memory.\n\nThere are large number of relationships that point at each other and we\nneed to break the cycle so JSSEngineReferenceImpl's finalizer can run\nand clear all the native resources these point at.\n\nThe lowest impact place to break the cycle was at SSLAlertEvent.engine.\nThis relationship doesn't seem to be used anywhere.  Once the cycle is\nbroken, JSSEngineReferenceImpl can be garbage collected and the\nfinalizer can run.\n\nSigned-off-by: Chris Kelley <ckelley@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "JSSEngineReferenceImpl.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "41",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 7: import java.nio.channels.WritableByteChannel;",
        "// Line_Reference 10: import java.nio.ByteBuffer;",
        "// Line_Reference 11: ",
        "// Line_Reference 12: import javax.net.ssl.*;",
        "// Line_Reference 14: import org.mozilla.jss.nss.*;",
        "// Line_Reference 15: import org.mozilla.jss.pkcs11.*;",
        "// Line_Reference 16: import org.mozilla.jss.provider.javax.crypto.*;",
        "// Line_Reference 17: import org.mozilla.jss.ssl.*;",
        "// Line_Reference 1654:                 PR.Close(ssl_fd);",
        "// Line_Reference 1657:                 debug(\"Got exception trying to cleanup SSLFD: \" + e.getMessage());"
    ]
}
