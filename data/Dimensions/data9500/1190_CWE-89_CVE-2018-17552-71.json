{
    "cve_id": "CVE-2018-17552",
    "cve_description": "SQL Injection in login.php in Naviwebs Navigate CMS 2.8 allows remote attackers to bypass authentication via the navigate-user cookie.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "* security fix: replace string filtering by parameterization in almost all queries",
    "type_of_change": "Modification",
    "filename_of_changes": "webuser_vote.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "81",
    "number_of_lines_deleted_vulnerable_to_cve": "36",
    "vulnerable_lines": [
        "// Line_Reference 132:              WHERE website = '.protect($website->id).'",
        "// Line_Reference 133: \t\t\t   AND object  = '.protect($object).'",
        "// Line_Reference 134:                AND object_id = '.protect($object_id).'",
        "// Line_Reference 137: \t\t ');",
        "// Line_Reference 149: \t\t$DB->queryLimit('wuv.id AS id, wuv.date AS date, wuv.webuser AS webuser, wu.username AS username',",
        "// Line_Reference 150: \t\t\t\t\t\t'nv_webuser_votes wuv, nv_webusers wu',",
        "// Line_Reference 151: \t\t\t\t\t\t'\t wuv.website = '.protect($website->id).'",
        "// Line_Reference 152: \t\t\t\t\t   \t AND wuv.object  = '.protect($object).'",
        "// Line_Reference 153:  \t\t\t\t\t   \t AND wuv.object_id = '.protect($object_id).'",
        "// Line_Reference 154: \t\t\t\t\t   \t AND wu.id = wuv.webuser',",
        "// Line_Reference 155: \t\t\t\t\t\t$orderby,",
        "// Line_Reference 156: \t\t\t\t\t\t$offset,",
        "// Line_Reference 157: \t\t\t\t\t\t$limit);",
        "// Line_Reference 167: \t\t$fromDate = 0;",
        "// Line_Reference 169: \t\t\t$fromDate = time() - $since*24*60*60;",
        "// Line_Reference 174:              WHERE website = '.protect($website->id).'",
        "// Line_Reference 175: \t\t\t   AND object  = '.protect($object).'",
        "// Line_Reference 176:                AND object_id = '.protect($object_id).'",
        "// Line_Reference 177: \t\t\t   AND date > '.$fromDate.'",
        "// Line_Reference 178: \t\t\t ORDER BY date ASC",
        "// Line_Reference 179:         ');",
        "// Line_Reference 207: \t\t\t\t WHERE webuser = '.intval($webuser).'",
        "// Line_Reference 208: \t\t\t\t   AND object  = '.protect($object).'",
        "// Line_Reference 209: \t\t\t\t   AND object_id = '.protect($object_id)",
        "// Line_Reference 223: \t\t\t\t   SET `value`\t=  '.protect($value).',",
        "// Line_Reference 224: \t\t\t\t\t\tdate \t=  '.protect(core_time()).'",
        "// Line_Reference 225: \t\t\t\t WHERE id = '.$webuser_vote_id",
        "// Line_Reference 287: \t\t\t   SET votes = '.protect($votes).',",
        "// Line_Reference 288: \t\t\t   \t   score = '.protect($score).'",
        "// Line_Reference 289: \t\t\t WHERE id = '.protect($object_id)",
        "// Line_Reference 300: \t\t$DB->query('SELECT COUNT(*) as votes, SUM(value) as score",
        "// Line_Reference 301: \t\t\t\t\t  FROM nv_webuser_votes",
        "// Line_Reference 302: \t\t\t\t\t WHERE object_id = '.protect($object_id).'",
        "// Line_Reference 303: \t\t\t\t\t   AND object = '.protect($object).'",
        "// Line_Reference 304: \t\t\t\t\t   AND website = '.$website->id);",
        "// Line_Reference 358:         $DB->query('SELECT * FROM nv_webuser_votes WHERE website = '.protect($website->id), 'object');"
    ]
}
