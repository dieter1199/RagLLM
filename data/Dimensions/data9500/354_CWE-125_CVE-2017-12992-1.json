{
    "cve_id": "CVE-2017-12992",
    "cve_description": "The RIPng parser in tcpdump before 4.9.2 has a buffer over-read in print-ripng.c:ripng_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-12992/RIPng: Clean up bounds checking.\n\nDo bounds checking as we access items.\n\nScan the list of netinfo6 entries based on the supplied packet length,\nwithout taking the captured length into account; let the aforementioned\nbounds checking handle that.\n\nThis fixes a buffer over-read discovered by Kamil Frankowicz.\n\nAdd a test using the capture file supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-ripng.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "40",
    "number_of_lines_deleted_vulnerable_to_cve": "31",
    "vulnerable_lines": [
        "// Line_Reference 113: \tregister u_int amt;",
        "// Line_Reference 114: \tregister u_int i;",
        "// Line_Reference 115: \tint j;",
        "// Line_Reference 116: \tint trunc;",
        "// Line_Reference 117: ",
        "// Line_Reference 118: \tif (ndo->ndo_snapend < dat)",
        "// Line_Reference 119: \t\treturn;",
        "// Line_Reference 120: \tamt = ndo->ndo_snapend - dat;",
        "// Line_Reference 121: \ti = min(length, amt);",
        "// Line_Reference 122: \tif (i < (sizeof(struct rip6) - sizeof(struct netinfo6)))",
        "// Line_Reference 123: \t\treturn;",
        "// Line_Reference 124: \ti -= (sizeof(struct rip6) - sizeof(struct netinfo6));",
        "// Line_Reference 129: \t\tj = length / sizeof(*ni);",
        "// Line_Reference 130: \t\tif (j == 1",
        "// Line_Reference 131: \t\t    &&  rp->rip6_nets->rip6_metric == HOPCNT_INFINITY6",
        "// Line_Reference 132: \t\t    &&  IN6_IS_ADDR_UNSPECIFIED(&rp->rip6_nets->rip6_dest)) {",
        "// Line_Reference 133: \t\t\tND_PRINT((ndo, \" ripng-req dump\"));",
        "// Line_Reference 134: \t\t\tbreak;",
        "// Line_Reference 136: \t\tif (j * sizeof(*ni) != length - 4)",
        "// Line_Reference 137: \t\t\tND_PRINT((ndo, \" ripng-req %d[%u]:\", j, length));",
        "// Line_Reference 139: \t\t\tND_PRINT((ndo, \" ripng-req %d:\", j));",
        "// Line_Reference 140: \t\ttrunc = ((i / sizeof(*ni)) * sizeof(*ni) != i);",
        "// Line_Reference 141: \t\tfor (ni = rp->rip6_nets; i >= sizeof(*ni);",
        "// Line_Reference 142: \t\t    i -= sizeof(*ni), ++ni) {",
        "// Line_Reference 151: \t\tj = length / sizeof(*ni);",
        "// Line_Reference 152: \t\tif (j * sizeof(*ni) != length - 4)",
        "// Line_Reference 156: \t\ttrunc = ((i / sizeof(*ni)) * sizeof(*ni) != i);",
        "// Line_Reference 157: \t\tfor (ni = rp->rip6_nets; i >= sizeof(*ni);",
        "// Line_Reference 158: \t\t    i -= sizeof(*ni), ++ni) {",
        "// Line_Reference 165: \t\tif (trunc)",
        "// Line_Reference 166: \t\t\tND_PRINT((ndo, \"[|ripng]\"));"
    ]
}
