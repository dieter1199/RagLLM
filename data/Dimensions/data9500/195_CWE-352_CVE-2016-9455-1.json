{
    "cve_id": "CVE-2016-9455",
    "cve_description": "Revive Adserver before 3.2.3 suffers from Cross-Site Request Forgery (CSRF). A number of scripts in Revive Adserver's user interface are vulnerable to CSRF attacks: `www/admin/banner-acl.php`, `www/admin/banner-activate.php`, `www/admin/banner-advanced.php`, `www/admin/banner-modify.php`, `www/admin/banner-swf.php`, `www/admin/banner-zone.php`, `www/admin/tracker-modify.php`.",
    "cve_publish_date": "2017-03-28",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Fix h1 report 97123\n\nCross-Site Request Forgery (CSRF)\n---------------------------------\n\nThe HackerOne user @decidedlygray has reported a number of scripts in Revive\nAdserver's user interface that were vulnerable to CSRF attacks:\n\n- www/admin/banner-acl.php\n- www/admin/banner-activate.php\n- www/admin/banner-advanced.php\n- www/admin/banner-modify.php\n- www/admin/banner-swf.php\n- www/admin/banner-zone.php\n- www/admin/tracker-modify.php\n\nA CVE-ID has been requested, but not assigned yet.\n\nCWE: CWE-352\nCVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)",
    "type_of_change": "Modification",
    "filename_of_changes": "banner-advanced.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 42:     if (isset($bannerid) && $bannerid != '') {",
        "// Line_Reference 43:         // Update banner",
        "// Line_Reference 44:         $doBanners = OA_Dal::factoryDO('banners');",
        "// Line_Reference 45:         $doBanners->get($bannerid);",
        "// Line_Reference 46:         $doBanners->prepend = $prepend;",
        "// Line_Reference 47:         $doBanners->append  = $append;",
        "// Line_Reference 48:         $doBanners->update();",
        "// Line_Reference 49: ",
        "// Line_Reference 50:         // Queue confirmation message",
        "// Line_Reference 51:         $translation = new OX_Translation();",
        "// Line_Reference 52:         $translated_message = $translation->translate($GLOBALS['strBannerAdvancedHasBeenUpdated'], array(",
        "// Line_Reference 53:             MAX::constructURL(MAX_URL_ADMIN, 'banner-edit.php?clientid=' .  $clientid . '&campaignid=' . $campaignid . '&bannerid=' . $bannerid),",
        "// Line_Reference 54:             htmlspecialchars($doBanners->description)",
        "// Line_Reference 55:         ));",
        "// Line_Reference 56:         OA_Admin_UI::queueMessage($translated_message, 'local', 'confirm', 0);",
        "// Line_Reference 57:     }"
    ]
}
