{
    "cve_id": "CVE-2022-25867",
    "cve_description": "The package io.socket:socket.io-client before 2.0.1 are vulnerable to NULL Pointer Dereference when parsing a packet with with invalid payload format.",
    "cve_publish_date": "2022-08-02",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "fix: ensure the payload format is valid\n\nThis commit should prevent some NPE issues encountered after the\nparsing of the packet.\n\nRelated:\n\n- https://github.com/socketio/socket.io-client-java/issues/642\n- https://github.com/socketio/socket.io-client-java/issues/609\n- https://github.com/socketio/socket.io-client-java/issues/505",
    "type_of_change": "Modification",
    "filename_of_changes": "ByteArrayTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 3: import io.socket.emitter.Emitter;",
        "// Line_Reference 6: import org.json.JSONObject;",
        "// Line_Reference 22:     public void encodeByteArray() {",
        "// Line_Reference 23:         Packet<byte[]> packet = new Packet<>(Parser.BINARY_EVENT);",
        "// Line_Reference 24:         packet.data = \"abc\".getBytes(Charset.forName(\"UTF-8\"));",
        "// Line_Reference 32:         Packet<byte[]> packet = new Packet<>(Parser.BINARY_EVENT);",
        "// Line_Reference 33:         packet.data = new byte[2];",
        "// Line_Reference 41:         JSONObject data = new JSONObject(\"{a: \\\"hi\\\", b: {}, c: {a: \\\"bye\\\", b: {}}}\");",
        "// Line_Reference 42:         data.getJSONObject(\"b\").put(\"why\", new byte[3]);",
        "// Line_Reference 43:         data.getJSONObject(\"c\").getJSONObject(\"b\").put(\"a\", new byte[6]);",
        "// Line_Reference 45:         Packet<JSONObject> packet = new Packet<>(Parser.BINARY_EVENT);",
        "// Line_Reference 54:         JSONObject data = new JSONObject(\"{a: \\\"b\\\", c: 4, e: {g: null}, h: null}\");",
        "// Line_Reference 55:         data.put(\"h\", new byte[9]);",
        "// Line_Reference 57:         Packet<JSONObject> packet = new Packet<>(Parser.BINARY_EVENT);"
    ]
}
