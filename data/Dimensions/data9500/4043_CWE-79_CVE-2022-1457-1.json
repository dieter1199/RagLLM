{
    "cve_id": "CVE-2022-1457",
    "cve_description": "Store XSS in title parameter executing at EditUser Page & EditProducto page in GitHub repository neorazorx/facturascripts prior to 2022.04. Cross-site scripting attacks can have devastating consequences. Code injected into a vulnerable application can exfiltrate data or install malware on the user's machine. Attackers can masquerade as authorized users via session cookies, allowing them to perform any action allowed by the user account.",
    "cve_publish_date": "2022-04-25",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Solucionado bug XSS al colocar javascript como t√≠tulo en un page_option.",
    "type_of_change": "Modification",
    "filename_of_changes": "EditPageOption.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 4:  * Copyright (C) 2017-2020 Carlos Garcia Gomez <carlos@facturascripts.com>",
        "// Line_Reference 48:      *",
        "// Line_Reference 54:      *",
        "// Line_Reference 67:      *",
        "// Line_Reference 86:     /**",
        "// Line_Reference 87:      * Returns basic page attributes",
        "// Line_Reference 88:      *",
        "// Line_Reference 89:      * @return array",
        "// Line_Reference 90:      */",
        "// Line_Reference 91:     public function getPageData()",
        "// Line_Reference 106:     public function getUserList()",
        "// Line_Reference 122:      * @param Response              $response",
        "// Line_Reference 123:      * @param User                  $user",
        "// Line_Reference 187:         if (false === \\strpos($code, '-')) {",
        "// Line_Reference 192:         $parts = \\explode('-', $code);",
        "// Line_Reference 269:             return true;  // Existen opciones para el usuario.",
        "// Line_Reference 272:         if (false == $this->loadPageOptionsForAll()) {",
        "// Line_Reference 273:             // No existe opciones general. Asignamos las opciones por defecto de la vista xml al usuario.",
        "// Line_Reference 285:      *",
        "// Line_Reference 286:      * @param array  $column",
        "// Line_Reference 289:      * @param bool   $isWidget",
        "// Line_Reference 290:      * @param bool   $allowEmpty",
        "// Line_Reference 294:         $newValue = $this->request->request->get($name . '-' . $key);"
    ]
}
