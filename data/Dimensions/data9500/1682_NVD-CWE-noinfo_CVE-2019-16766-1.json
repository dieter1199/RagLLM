{
    "cve_id": "CVE-2019-16766",
    "cve_description": "When using wagtail-2fa before 1.3.0, if someone gains access to someone's Wagtail login credentials, they can log into the CMS and bypass the 2FA check by changing the URL. They can then add a new device and gain full access to the CMS. This problem has been patched in version 1.3.0.",
    "cve_publish_date": "2019-11-29",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Allow a limited list of paths when user has device\n\nThis prevents users from adding or listing devices while they are not\nyet verified and already have a registered device.",
    "type_of_change": "Modification",
    "filename_of_changes": "middleware.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 69:         if request.path in self._allowed_paths:",
        "// Line_Reference 75:     @property",
        "// Line_Reference 76:     def _allowed_paths(self):",
        "// Line_Reference 77:         \"\"\"Return the paths the user may visit when not verified via otp",
        "// Line_Reference 78: ",
        "// Line_Reference 79:         This result cannot be cached since we want to be compatible with the",
        "// Line_Reference 80:         django-hosts package. Django-hosts alters the urlconf based on the",
        "// Line_Reference 81:         hostname in the request, so the urls might exist for admin.<domain> but",
        "// Line_Reference 82:         not for www.<domain>.",
        "// Line_Reference 86:         for route_name in self._allowed_url_names:"
    ]
}
