if ($serviceResponse->isAwaitingNotification()) {
} else {
if ($serviceResponse->isError()) {
$this->createMessage($this->errorMessageType, $response);
} else {
if ($diff < 0) {
$this->createPartialPayment(PaymentMath::multiply($amount, '-1'), $this->pendingState);
} elseif ($diff > 0) {
$this->createPartialPayment($diff, $this->pendingState);
}
$this->markCompleted($this->endState, $serviceResponse, $response);