* Sanitize HTTP_HOST, take proxy configuration into account and
* verify allowed hosts with configured trusted hosts pattern.
* @return string Sanitized HTTP_HOST
if (!GeneralUtility::isAllowedHostHeaderValue($httpHost)) {
throw new \UnexpectedValueException(
'The current host header value does not match the configured trusted hosts pattern!'
. ' Check the pattern defined in $GLOBALS[\'TYPO3_CONF_VARS\'][\'SYS\'][\'trustedHostsPattern\']'
. ' and adapt it, if you want to allow the current host header \'' . $httpHost . '\' for your installation.',
1396795886
);
}