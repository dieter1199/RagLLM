{
    "cve_id": "CVE-2022-3232",
    "cve_description": "Cross-Site Request Forgery (CSRF) in GitHub repository ikus060/rdiffweb prior to 2.4.5.",
    "cve_publish_date": "2022-09-17",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Mitigate CSRF on repository deletion and user deletion #214 #215",
    "type_of_change": "Modification",
    "filename_of_changes": "test_page_delete.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "53",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 40:     def _delete(self, user, repo, confirm, redirect=None):",
        "// Line_Reference 44:         if redirect is not None:",
        "// Line_Reference 45:             body['redirect'] = redirect",
        "// Line_Reference 51:             (\"with_dir\", 'admin', '/testcases/Revisions', 'Revisions', 303, 404),",
        "// Line_Reference 53:             (\"with_file\", 'admin', '/testcases/Revisions/Data', 'Data', 303, 404),",
        "// Line_Reference 56:             (\"with_broken_symlink\", 'admin', '/testcases/BrokenSymlink', 'BrokenSymlink', 303, 404),",
        "// Line_Reference 57:             (\"with_utf8\", 'admin', '/testcases/R%C3%A9pertoire%20Existant', 'RÃ©pertoire Existant', 303, 404),",
        "// Line_Reference 59:             (\"with_quoted_path\", 'admin', '/testcases/Char%20%3B090%20to%20quote', 'Char Z to quote', 303, 404),",
        "// Line_Reference 62:     def test_delete_path(self, unused, username, path, confirmation, expected_status, expected_history_status):",
        "// Line_Reference 128:         self._delete('anotheruser', 'testcases', 'testcases', redirect='/admin/repos/')",
        "// Line_Reference 130:         location = self.assertHeader('Location')",
        "// Line_Reference 131:         self.assertTrue(location.endswith('/admin/repos/'))",
        "// Line_Reference 150:         # Try to delete own own repo",
        "// Line_Reference 151:         self._delete('maintainer', 'testcases', 'testcases', redirect='/admin/repos/')",
        "// Line_Reference 153:         location = self.assertHeader('Location')",
        "// Line_Reference 154:         self.assertTrue(location.endswith('/admin/repos/'))",
        "// Line_Reference 172:         self._delete('user', 'testcases', 'testcases', redirect='/admin/repos/')"
    ]
}
