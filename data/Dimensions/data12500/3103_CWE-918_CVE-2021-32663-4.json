{
    "cve_id": "CVE-2021-32663",
    "cve_description": "iTop is an open source web based IT Service Management tool. In affected versions an attacker can call the system setup without authentication. Given specific parameters this can lead to SSRF. This issue has been resolved in versions 2.6.5 and 2.7.5 and later",
    "cve_publish_date": "2021-10-19",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "NÂ°3952 - code hardening",
    "type_of_change": "Modification",
    "filename_of_changes": "wizardsteps.class.inc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 60: \t\tif (!is_dir(APPROOT.'data'))",
        "// Line_Reference 61: \t\t{",
        "// Line_Reference 62: \t\t\tmkdir(APPROOT.'data');",
        "// Line_Reference 63: \t\t}",
        "// Line_Reference 64: \t\tif (!is_dir(APPROOT.'data/setup'))",
        "// Line_Reference 65: \t\t{",
        "// Line_Reference 66: \t\t\tmkdir(APPROOT.'data/setup');",
        "// Line_Reference 67: \t\t}",
        "// Line_Reference 68: \t\t$sUID = hash('sha256', rand());",
        "// Line_Reference 69: \t\tfile_put_contents(APPROOT.'data/setup/authent', $sUID);"
    ]
}
