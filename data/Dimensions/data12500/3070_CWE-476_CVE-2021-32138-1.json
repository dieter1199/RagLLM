{
    "cve_id": "CVE-2021-32138",
    "cve_description": "The DumpTrackInfo function in GPAC 1.0.1 allows attackers to cause a denial of service (NULL pointer dereference) via a crafted file in the MP4Box command.",
    "cve_publish_date": "2021-09-13",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "fixed #1767 (fuzz)",
    "type_of_change": "Modification",
    "filename_of_changes": "filedump.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 2883: \t\tfprintf(stderr, \"\\tversion=%u, profile=%u, level_idx0=%u, tier=%u\\n\", (u32)av1c->version, (u32)av1c->seq_profile, (u32)av1c->seq_level_idx_0, (u32)av1c->seq_tier_0);",
        "// Line_Reference 2884: \t\tfprintf(stderr, \"\\thigh_bitdepth=%u, twelve_bit=%u, monochrome=%u\\n\", (u32)av1c->high_bitdepth, (u32)av1c->twelve_bit, (u32)av1c->monochrome);",
        "// Line_Reference 2885: \t\tfprintf(stderr, \"\\tchroma: subsampling_x=%u, subsampling_y=%u, sample_position=%u\\n\", (u32)av1c->chroma_subsampling_x, (u32)av1c->chroma_subsampling_y, (u32)av1c->chroma_sample_position);",
        "// Line_Reference 2887: \t\tif (av1c->initial_presentation_delay_present)",
        "// Line_Reference 2888: \t\t\tfprintf(stderr, \"\\tInitial presentation delay %u\\n\", (u32) av1c->initial_presentation_delay_minus_one+1);",
        "// Line_Reference 2890: \t\tcount = gf_list_count(av1c->obu_array);",
        "// Line_Reference 2891: \t\tfor (i=0; i<count; i++) {",
        "// Line_Reference 2892: \t\t\tu8 hash[20];",
        "// Line_Reference 2893: \t\t\tGF_AV1_OBUArrayEntry *obu = gf_list_get(av1c->obu_array, i);",
        "// Line_Reference 2894: \t\t\tgf_sha1_csum((u8*)obu->obu, (u32)obu->obu_length, hash);",
        "// Line_Reference 2895: \t\t\tfprintf(stderr, \"\\tOBU#%d %s hash: \", i+1, gf_av1_get_obu_name(obu->obu_type) );",
        "// Line_Reference 2896: \t\t\tfor (j=0; j<20; j++) fprintf(stderr, \"%02X\", hash[j]);",
        "// Line_Reference 2897: \t\t\tfprintf(stderr, \"\\n\");",
        "// Line_Reference 2899: \t\tgf_odf_av1_cfg_del(av1c);"
    ]
}
