{
    "cve_id": "CVE-2022-35928",
    "cve_description": "AES Crypt is a file encryption software for multiple platforms. AES Crypt for Linux built using the source on GitHub and having the version number 3.11 has a vulnerability with respect to reading user-provided passwords and confirmations via command-line prompts. Passwords lengths were not checked before being read. This vulnerability may lead to buffer overruns. This does _not_ affect source code found on aescrypt.com, nor is the vulnerability present when providing a password or a key via the `-p` or `-k` command-line options. The problem was fixed via in commit 68761851b and will be included in release 3.16. Users are advised to upgrade. Users unable to upgrade should us the `-p` or `-k` options to provide a password or key.",
    "cve_publish_date": "2022-08-03",
    "cwe_id": "CWE-1284",
    "cwe_name": "Improper Validation of Specified Quantity in Input",
    "cwe_description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
    "commit_message": "Fixed security issue with passwords entered via a prompt",
    "type_of_change": "Modification",
    "filename_of_changes": "password.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "41",
    "vulnerable_lines": [
        "// Line_Reference 3:  * Copyright (C) 2007-2017",
        "// Line_Reference 85: ",
        "// Line_Reference 113:     if (ftty == NULL)",
        "// Line_Reference 114:     {",
        "// Line_Reference 115:         return AESCRYPT_READPWD_FOPEN;",
        "// Line_Reference 116:     }",
        "// Line_Reference 118:     if (tty < 0)",
        "// Line_Reference 119:     {",
        "// Line_Reference 120:         return AESCRYPT_READPWD_FILENO;",
        "// Line_Reference 121:     }",
        "// Line_Reference 122: ",
        "// Line_Reference 225:             if (ftty != stderr)",
        "// Line_Reference 226:                 fclose(ftty);",
        "// Line_Reference 239:             if (ftty != stderr)",
        "// Line_Reference 240:                 fclose(ftty);",
        "// Line_Reference 246:     if (ftty != stderr)",
        "// Line_Reference 247:         fclose(ftty);",
        "// Line_Reference 253:         match = strcmp((char*)pwd, (char*)pwd_confirm);",
        "// Line_Reference 256:         if (match != 0)",
        "// Line_Reference 257:         {",
        "// Line_Reference 258:             /* For security reasons, erase the password */",
        "// Line_Reference 259:             memset_secure(pwd, 0, MAX_PASSWD_BUF);",
        "// Line_Reference 260:             return AESCRYPT_READPWD_NOMATCH;",
        "// Line_Reference 261:         }",
        "// Line_Reference 267:     chars_read = passwd_to_utf16(",
        "// Line_Reference 268:        pwd,",
        "// Line_Reference 269:        chars_read,",
        "// Line_Reference 270:        MAX_PASSWD_LEN,",
        "// Line_Reference 271:        buffer);",
        "// Line_Reference 296:     ret = MultiByteToWideChar(",
        "// Line_Reference 297:         CP_ACP,",
        "// Line_Reference 298:         0,",
        "// Line_Reference 299:         (LPCSTR)in_passwd,",
        "// Line_Reference 300:         -1,",
        "// Line_Reference 301:         (LPWSTR)out_passwd,",
        "// Line_Reference 302:         max_length / 2",
        "// Line_Reference 303:     );",
        "// Line_Reference 311:     for (i=0;i<length+1;i++) {",
        "// Line_Reference 312:         out_passwd[i*2] = in_passwd[i];",
        "// Line_Reference 313:         out_passwd[i*2+1] = 0;",
        "// Line_Reference 315:     return length*2;"
    ]
}
