{
    "cve_id": "CVE-2017-12898",
    "cve_description": "The NFS parser in tcpdump before 4.9.2 has a buffer over-read in print-nfs.c:interp_reply().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-12898/NFS: Fix bounds checking.\n\nFix the bounds checking for the NFSv3 WRITE procedure to check whether the\nlength of the opaque data being written is present in the captured data,\nnot just whether the byte count is present in the captured data.\nfurthest forward in the packet, not the item before it.  (This also lets\nus eliminate the check for the \"stable\" argument being present in the\ncaptured data; rewrite the code to print that to make it a bit clearer.)\n\nCheck that the entire ar_stat field is present in the capture.\n\nNote that parse_wcc_attr() is called after we've already checked whether\nthe wcc_data is present.\n\nCheck before fetching the \"access\" part of the NFSv3 ACCESS results.\nThis fixes a buffer over-read discovered by Kamil Frankowicz.\n\nInclude a test for the \"check before fetching the \"access\" part...\" fix,\nusing the capture supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-nfs.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 631: \t\t\t\tND_TCHECK(dp[2]);",
        "// Line_Reference 637: \t\t\t\t\tdp += 3;",
        "// Line_Reference 638: \t\t\t\t\tND_TCHECK(dp[0]);",
        "// Line_Reference 641: \t\t\t\t\t\t\tNULL, EXTRACT_32BITS(dp))));",
        "// Line_Reference 1005: \tND_TCHECK2(dp[0], 0);",
        "// Line_Reference 1514: \t\tif (!er)"
    ]
}
