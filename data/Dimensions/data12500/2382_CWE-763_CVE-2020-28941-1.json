{
    "cve_id": "CVE-2020-28941",
    "cve_description": "An issue was discovered in drivers/accessibility/speakup/spk_ttyio.c in the Linux kernel through 5.9.9. Local attackers on systems with the speakup driver could cause a local denial of service attack, aka CID-d41227544427. This occurs because of an invalid free when the line discipline is used more than once.",
    "cve_publish_date": "2020-11-19",
    "cwe_id": "CWE-763",
    "cwe_name": "Release of Invalid Pointer or Reference",
    "cwe_description": "The product attempts to return a memory resource to the system, but it calls the wrong release function or calls the appropriate release function incorrectly.",
    "commit_message": "speakup: Do not let the line discipline be used several times\n\nSpeakup has only one speakup_tty variable to store the tty it is managing. This\nmakes sense since its codebase currently assumes that there is only one user who\ncontrols the screen reading.\n\nThat however means that we have to forbid using the line discipline several\ntimes, otherwise the second closure would try to free a NULL ldisc_data, leading to\n\ngeneral protection fault: 0000 [#1] SMP KASAN PTI\nRIP: 0010:spk_ttyio_ldisc_close+0x2c/0x60\nCall Trace:\n tty_ldisc_release+0xa2/0x340\n tty_release_struct+0x17/0xd0\n tty_release+0x9d9/0xcc0\n __fput+0x231/0x740\n task_work_run+0x12c/0x1a0\n do_exit+0x9b5/0x2230\n ? release_task+0x1240/0x1240\n ? __do_page_fault+0x562/0xa30\n do_group_exit+0xd5/0x2a0\n __x64_sys_exit_group+0x35/0x40\n do_syscall_64+0x89/0x2b0\n ? page_fault+0x8/0x30\n entry_SYSCALL_64_after_hwframe+0x44/0xa9\n\nCc: stable@vger.kernel.org\nReported-by: 秦世松 <qinshisong1205@gmail.com>\nSigned-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>\nTested-by: Shisong Qin <qinshisong1205@gmail.com>\nLink: https://lore.kernel.org/r/20201110183541.fzgnlwhjpgqzjeth@function\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "spk_ttyio.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 55: \tif (!ldisc_data)"
    ]
}
