{
    "cve_id": "CVE-2022-27651",
    "cve_description": "A flaw was found in buildah where containers were incorrectly started with non-empty default permissions. A bug was found in Moby (Docker Engine) where containers were incorrectly started with non-empty inheritable Linux process capabilities, enabling an attacker with access to programs with inheritable file capabilities to elevate those capabilities to the permitted set when execve(2) runs. This has the potential to impact confidentiality and integrity.",
    "cve_publish_date": "2022-04-04",
    "cwe_id": "CWE-276",
    "cwe_name": "Incorrect Default Permissions",
    "cwe_description": "During installation, installed file permissions are set to allow anyone to modify those files.",
    "commit_message": "do not set the inheritable capabilities\n\nThe kernel never sets the inheritable capabilities for a process, they\nare only set by userspace.  Emulate the same behavior.\n\nCloses: CVE-2022-27651\n\nSigned-off-by: Giuseppe Scrivano <gscrivan@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "run_linux.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1967: \t\tif err := g.AddProcessCapabilityInheritable(cap); err != nil {",
        "// Line_Reference 1968: \t\t\treturn errors.Wrapf(err, \"error adding %q to the inheritable capability set\", cap)",
        "// Line_Reference 1969: \t\t}",
        "// Line_Reference 1988: \t\tif err := g.DropProcessCapabilityInheritable(cap); err != nil {",
        "// Line_Reference 1989: \t\t\treturn errors.Wrapf(err, \"error removing %q from the inheritable capability set\", cap)",
        "// Line_Reference 1990: \t\t}"
    ]
}
