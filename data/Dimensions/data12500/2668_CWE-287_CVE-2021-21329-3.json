{
    "cve_id": "CVE-2021-21329",
    "cve_description": "RATCF is an open-source framework for hosting Cyber-Security Capture the Flag events. In affected versions of RATCF users with multi factor authentication enabled are able to log in without a valid token. This is fixed in commit cebb67b.",
    "cve_publish_date": "2021-03-08",
    "cwe_id": "CWE-287",
    "cwe_name": "Improper Authentication",
    "cwe_description": "When an actor claims to have a given identity, the product does not prove or insufficiently proves that the claim is correct.",
    "commit_message": "Refactor 2FA and prepare for fido support",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "models.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 35:         error_messages={\"unique\": _(\"A user with that username already exists.\"),},",
        "// Line_Reference 38:     totp_secret = models.CharField(null=True, max_length=16)",
        "// Line_Reference 39:     totp_status = models.IntegerField(",
        "// Line_Reference 40:         choices=[(status, status.value) for status in TOTPStatus],",
        "// Line_Reference 41:         default=TOTPStatus.DISABLED,",
        "// Line_Reference 42:     )",
        "// Line_Reference 73:     def is_2fa_enabled(self):",
        "// Line_Reference 74:         return self.totp_status == TOTPStatus.ENABLED",
        "// Line_Reference 77:         return self.totp_status != TOTPStatus.ENABLED and config.get("
    ]
}
