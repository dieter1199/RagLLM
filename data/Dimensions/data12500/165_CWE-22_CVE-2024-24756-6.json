{
    "cve_id": "CVE-2024-24756",
    "cve_description": "Crafatar serves Minecraft avatars based on the skin for use in external applications. Files outside of the `lib/public/` directory can be requested from the server. Instances running behind Cloudflare (including crafatar.com) are not affected. Instances using the Docker container as shown in the README are affected, but only files within the container can be read. By default, all of the files within the container can also be found in this repository and are not confidential. This vulnerability is patched in 2.1.5.",
    "cve_publish_date": "2024-02-01",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "improve URL parsing\n\nuses `new URL()` and `decodeURI()` instead of `url.parse()`\nalso checks that the requested file is in a subdirectory of `public/` before serving the file\n\nfixes path traversal vulnerability GHSA-5cxq-25mp-q5f2",
    "type_of_change": "Modification",
    "filename_of_changes": "test.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 318:         redirect: \"/avatars/853c80ef3c3749fdaa49938b674adae6?size=16\",",
        "// Line_Reference 340:         redirect: \"/avatars/853c80ef3c3749fdaa49938b674adae6?size=16\",",
        "// Line_Reference 375:         redirect: \"/skins/853c80ef3c3749fdaa49938b674adae6?size=16\",",
        "// Line_Reference 397:         redirect: \"/renders/head/853c80ef3c3749fdaa49938b674adae6?scale=2\",",
        "// Line_Reference 419:         redirect: \"/renders/head/853c80ef3c3749fdaa49938b674adae6?scale=2&overlay=\",",
        "// Line_Reference 441:         redirect: \"/renders/body/853c80ef3c3749fdaa49938b674adae6?scale=2\","
    ]
}
