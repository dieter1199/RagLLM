{
    "cve_id": "CVE-2020-15153",
    "cve_description": "Ampache before version 4.2.2 allows unauthenticated users to perform SQL injection. Refer to the referenced GitHub Security Advisory for details and a workaround. This is fixed in version 4.2.2 and the development branch.",
    "cve_publish_date": "2021-04-30",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Update database_object.abstract.php\n\ncast int for object_id",
    "type_of_change": "Modification",
    "filename_of_changes": "database_object.abstract.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 48:         $table_name = $table_name ? Dba::escape($table_name) : Dba::escape(strtolower(get_class($this)));",
        "// Line_Reference 55:         if (self::is_cached($table_name, $object_id)) {",
        "// Line_Reference 56:             return self::get_from_cache($table_name, $object_id);",
        "// Line_Reference 59:         $sql        = \"SELECT * FROM `$table_name` WHERE `id`='$object_id'\";",
        "// Line_Reference 60:         $db_results = Dba::read($sql);",
        "// Line_Reference 68:         self::add_to_cache($table_name, $object_id, $row);"
    ]
}
