{
    "cve_id": "CVE-2022-25882",
    "cve_description": "Versions of the package onnx before 1.13.0 are vulnerable to Directory Traversal as the external_data field of the tensor proto can have a path to the file which is outside the model current directory or user-provided directory, for example \"../../../etc/passwd\"",
    "cve_publish_date": "2023-01-26",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "Do not allow to read tensor's external_data outside the model directory (#4400)\n\n* Not allow to read tensor external_data outside the model directory\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Fix formatting errors\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Disable segfaulty test\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Fix cpp tests\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Fix UB while removing ../\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Fix clang-format\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Check for symlinks only on POSIX systems\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Add specific to Windows external_data test\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Change specific Windows external_data test decorator tofix mypy\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\n* Remove unused pathlib\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>\r\n\r\nSigned-off-by: jnovikov <johnnovikov0@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "test_external_data.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "54",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 52: ",
        "// Line_Reference 229:         convert_model_to_external_data(self.model, size_threshold=0, all_tensors_to_one_file=True, location=external_data_file)",
        "// Line_Reference 263:         convert_model_to_external_data(self.model, size_threshold=0, all_tensors_to_one_file=False, convert_attribute=False)",
        "// Line_Reference 273:         convert_model_to_external_data(self.model, size_threshold=0, all_tensors_to_one_file=False, convert_attribute=True)",
        "// Line_Reference 283:         convert_model_to_external_data(self.model, size_threshold=0, convert_attribute=False, all_tensors_to_one_file=False)",
        "// Line_Reference 402:             dims=self.large_data.shape, vals=self.large_data.tobytes(), raw=True)",
        "// Line_Reference 406:             dims=shape_data.shape, vals=shape_data.tobytes(), raw=True)",
        "// Line_Reference 435:         onnx.save_model(self.model, self.model_file_path, save_as_external_data=True, all_tensors_to_one_file=False, size_threshold=0)",
        "// Line_Reference 441:             model_without_external_data, strict_mode=True)"
    ]
}
