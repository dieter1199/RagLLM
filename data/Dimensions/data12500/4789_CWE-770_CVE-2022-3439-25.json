{
    "cve_id": "CVE-2022-3439",
    "cve_description": "Allocation of Resources Without Limits or Throttling in GitHub repository ikus060/rdiffweb prior to 2.5.0.",
    "cve_publish_date": "2022-10-14",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "Improve ratelimit implementation",
    "type_of_change": "Modification",
    "filename_of_changes": "test_page_login.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "57",
    "number_of_lines_deleted_vulnerable_to_cve": "44",
    "vulnerable_lines": [
        "// Line_Reference 23: ",
        "// Line_Reference 24: from parameterized import parameterized",
        "// Line_Reference 216: ",
        "// Line_Reference 217:     default_config = {",
        "// Line_Reference 218:         'rate-limit': 5,",
        "// Line_Reference 219:     }",
        "// Line_Reference 223:         # When requesting multple time the login page",
        "// Line_Reference 224:         for i in range(0, 6):",
        "// Line_Reference 225:             self.getPage('/login/')",
        "// Line_Reference 230: class LoginPageRateLimitWithSessionDirTest(rdiffweb.test.WebCase):",
        "// Line_Reference 232:     default_config = {",
        "// Line_Reference 233:         'rate-limit-dir': '/tmp',",
        "// Line_Reference 234:         'rate-limit': 5,",
        "// Line_Reference 235:     }",
        "// Line_Reference 237:     def test_login_ratelimit(self):",
        "// Line_Reference 239:         # When requesting multple time the login page",
        "// Line_Reference 240:         for i in range(0, 6):",
        "// Line_Reference 241:             self.getPage('/login/')",
        "// Line_Reference 242:         # Then a 429 error (too many request) is return",
        "// Line_Reference 246: class LoginPageRateLimitTestWithXForwardedFor(rdiffweb.test.WebCase):",
        "// Line_Reference 248:     default_config = {",
        "// Line_Reference 249:         'rate-limit': 5,",
        "// Line_Reference 250:     }",
        "// Line_Reference 251: ",
        "// Line_Reference 252:     def test_login_ratelimit(self):",
        "// Line_Reference 254:         # When requesting multple time the login page",
        "// Line_Reference 255:         for i in range(0, 6):",
        "// Line_Reference 256:             self.getPage('/login/', headers=[('X-Forwarded-For', '127.0.0.%s' % i)])",
        "// Line_Reference 257:         # Then a 429 error (too many request) is return",
        "// Line_Reference 261: class LoginPageRateLimitTestWithXRealIP(rdiffweb.test.WebCase):",
        "// Line_Reference 262: ",
        "// Line_Reference 263:     default_config = {",
        "// Line_Reference 264:         'rate-limit': 5,",
        "// Line_Reference 265:     }",
        "// Line_Reference 266: ",
        "// Line_Reference 267:     def test_login_ratelimit(self):",
        "// Line_Reference 268:         # Given an unauthenticate",
        "// Line_Reference 269:         # When requesting multple time the login page",
        "// Line_Reference 270:         for i in range(0, 6):",
        "// Line_Reference 271:             self.getPage('/login/', headers=[('X-Real-IP', '127.0.0.%s' % i)])",
        "// Line_Reference 272:         # Then a 200 is return.",
        "// Line_Reference 273:         self.assertStatus(200)",
        "// Line_Reference 274: ",
        "// Line_Reference 275: "
    ]
}
