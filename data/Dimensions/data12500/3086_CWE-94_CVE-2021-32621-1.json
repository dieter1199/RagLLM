{
    "cve_id": "CVE-2021-32621",
    "cve_description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In versions prior to 12.6.7 and 12.10.3, a user without Script or Programming right is able to execute script requiring privileges by editing gadget titles in the dashboard. The issue has been patched in XWiki 12.6.7, 12.10.3 and 13.0RC1.",
    "cve_publish_date": "2021-05-28",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "XWIKI-17794: Properly interpret velocity in gadget titles",
    "type_of_change": "Modification",
    "filename_of_changes": "DefaultGadgetSource.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 47: import org.xwiki.rendering.executor.ContentExecutorException;",
        "// Line_Reference 52: import org.xwiki.rendering.parser.MissingParserException;",
        "// Line_Reference 53: import org.xwiki.rendering.parser.ParseException;",
        "// Line_Reference 197:                 // render title with velocity",
        "// Line_Reference 198:                 StringWriter writer = new StringWriter();",
        "// Line_Reference 199:                 // FIXME: the engine has an issue with $ and # as last character. To test and fix if it happens",
        "// Line_Reference 200:                 velocityEngine.evaluate(velocityContext, writer, key, title);",
        "// Line_Reference 201:                 String gadgetTitle = writer.toString();",
        "// Line_Reference 206:                         xObject.getOwnerDocument(), context);",
        "// Line_Reference 209:                         xObject.getOwnerDocument(), context);"
    ]
}
