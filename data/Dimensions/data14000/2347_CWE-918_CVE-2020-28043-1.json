{
    "cve_id": "CVE-2020-28043",
    "cve_description": "MISP through 2.4.133 allows SSRF in the REST client via the use_full_path parameter with an arbitrary URL.",
    "cve_publish_date": "2020-11-02",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "fix: [security] SSRF fixed in the rest client\n\n- by using the full path parameter in the rest client, users could issue queries to any server\n- this becomes especially problematic when the MISP server is able to query other internal servers,\n  as external users could trigger those\n\n- new server setting added that allows enabling the full path option, this is now disabled by default\n- new server setting added to add an override baseurl for the rest client, removing the need for the full\n  path option in the first place (for example for the training VM with its port forwarding)\n\n- Thanks to Heitor GouvÃªa for reporting this vulnerability",
    "type_of_change": "Modification",
    "filename_of_changes": "ServersController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 2005:             'use_full_path' => $request['use_full_path'],",
        "// Line_Reference 2013:             if (empty($request['use_full_path'])) {",
        "// Line_Reference 2015:                 $url = Configure::read('MISP.baseurl') . $path;"
    ]
}
