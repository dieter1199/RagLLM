{
    "cve_id": "CVE-2021-3920",
    "cve_description": "grav-plugin-admin is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cve_publish_date": "2021-11-19",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed unescaped messages in JSON responses",
    "type_of_change": "Modification",
    "filename_of_changes": "AdminController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 291:             $this->admin->json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 410:             $json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 493:             $json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 543:                 'message' => $this->admin::translate('PLUGIN_ADMIN.AN_ERROR_OCCURRED') . '. ' . $e->getMessage()",
        "// Line_Reference 920:             $this->admin->json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 964:             $this->admin->json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 1007:             $this->admin->json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 1062:             $this->admin->json_response = ['status' => 'error', 'message' => $msg];",
        "// Line_Reference 1136:             $json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 2071:             $this->admin->json_response = ['status' => 'error', 'message' => $e->getMessage()];",
        "// Line_Reference 2228:                     $filename, 'Bad filename')",
        "// Line_Reference 2456:                     'message' => $this->admin::translate('PLUGIN_ADMIN.FILE_COULD_NOT_BE_DELETED') . ': ' . $filename",
        "// Line_Reference 2477:                         'message' => $this->admin::translate('PLUGIN_ADMIN.FILE_COULD_NOT_BE_DELETED') . ': ' . $filename",
        "// Line_Reference 2492:                 'message' => $this->admin::translate('PLUGIN_ADMIN.FILE_NOT_FOUND') . ': ' . $filename",
        "// Line_Reference 2503:             'message' => $this->admin::translate('PLUGIN_ADMIN.FILE_DELETED') . ': ' . $filename"
    ]
}
