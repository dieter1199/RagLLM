{
    "cve_id": "CVE-2021-43825",
    "cve_description": "Envoy is an open source edge and service proxy, designed for cloud-native applications. Sending a locally generated response must stop further processing of request or response data. Envoy tracks the amount of buffered request and response data and aborts the request if the amount of buffered data is over the limit by sending 413 or 500 responses. However when the buffer overflows while response is processed by the filter chain the operation may not be aborted correctly and result in accessing a freed memory block. If this happens Envoy will crash resulting in a denial of service.",
    "cve_publish_date": "2022-02-22",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "CVE-2021-43825\n\nResponse filter manager crash\n\nSigned-off-by: Yan Avlasov <yavlasov@google.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "filter_manager.h",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 320:   bool canContinue() override { return true; }",
        "// Line_Reference 910:   bool remoteComplete() const { return state_.remote_complete_; }",
        "// Line_Reference 1061:         : remote_complete_(false), local_complete_(false), has_1xx_headers_(false),",
        "// Line_Reference 1062:           created_filter_chain_(false), is_head_request_(false), is_grpc_request_(false),",
        "// Line_Reference 1063:           non_100_response_headers_encoded_(false), under_on_local_reply_(false),",
        "// Line_Reference 1064:           decoder_filter_chain_aborted_(false), encoder_filter_chain_aborted_(false),",
        "// Line_Reference 1065:           saw_downstream_reset_(false) {}",
        "// Line_Reference 1066: ",
        "// Line_Reference 1069:     bool remote_complete_ : 1;"
    ]
}
