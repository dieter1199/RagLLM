{
    "cve_id": "CVE-2022-31173",
    "cve_description": "Juniper is a GraphQL server library for Rust. Affected versions of Juniper are vulnerable to uncontrolled recursion resulting in a program crash. This issue has been addressed in version 0.15.10. Users are advised to upgrade. Users unable to upgrade should limit the recursion depth manually.",
    "cve_publish_date": "2022-08-01",
    "cwe_id": "CWE-674",
    "cwe_name": "Uncontrolled Recursion",
    "cwe_description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
    "commit_message": "Merge pull request from GHSA-4rx6-g5vg-5f3j\n\n* Replace recursions with heap allocations\n\n* Some corrections [skip ci]\n\n* Add recursive nested fragments test case\n\n* Docs and small corrections\n\n* Corrections\n\nCo-authored-by: Kai Ren <tyranron@gmail.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "no_unused_variables.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 15: pub struct NoUnusedVariables<'a> {",
        "// Line_Reference 16:     defined_variables: HashMap<Option<&'a str>, HashSet<&'a Spanning<&'a str>>>,",
        "// Line_Reference 17:     used_variables: HashMap<Scope<'a>, Vec<&'a str>>,",
        "// Line_Reference 18:     current_scope: Option<Scope<'a>>,",
        "// Line_Reference 19:     spreads: HashMap<Scope<'a>, Vec<&'a str>>,",
        "// Line_Reference 20: }",
        "// Line_Reference 21: ",
        "// Line_Reference 33:         &self,",
        "// Line_Reference 40:             return;",
        "// Line_Reference 53:         if let Some(spreads) = self.spreads.get(from) {",
        "// Line_Reference 54:             for spread in spreads {",
        "// Line_Reference 55:                 self.find_used_vars(&Scope::Fragment(spread), defined, used, visited);",
        "// Line_Reference 56:             }",
        "// Line_Reference 57:         }"
    ]
}
