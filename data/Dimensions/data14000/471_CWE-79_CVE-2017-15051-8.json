{
    "cve_id": "CVE-2017-15051",
    "cve_description": "Multiple stored cross-site scripting (XSS) vulnerabilities in TeamPass before 2.1.27.9 allow authenticated remote attackers to inject arbitrary web script or HTML via the (1) URL value of an item or (2) user log history. To exploit the vulnerability, the attacker must be first authenticated to the application. For the first one, the attacker has to simply inject XSS code within the URL field of a shared item. For the second one however, the attacker must prepare a payload within its profile, and then ask an administrator to modify its profile. From there, whenever the administrator accesses the log, it can be XSS'ed.",
    "cve_publish_date": "2017-11-27",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "2.1.27\n\nSeveral fixes",
    "type_of_change": "Modification",
    "filename_of_changes": "items.load.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "52",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 293:                     $(\"#display_categories\").val(data.displayCategories);",
        "// Line_Reference 353:                         if ($(\".tr_fields\") != undefined && data.displayCategories != \"\") {",
        "// Line_Reference 385:                         if ($(\".tr_fields\") != undefined && data.displayCategories != \"\") {",
        "// Line_Reference 423:                                         type     : \"move_item\",",
        "// Line_Reference 424:                                         item_id : ui.draggable.attr(\"id\"),",
        "// Line_Reference 426:                                         key        : \"<?php echo $_SESSION['key']; ?>\"",
        "// Line_Reference 929:                     if (data.error == \"ERR_JSON_FORMAT\") {",
        "// Line_Reference 931:                         $(\"#edit_show_error\").html(data.error + ' ERROR (JSON is broken)!!!!!');",
        "// Line_Reference 932:                         $(\"#edit_show_error\").show();",
        "// Line_Reference 933:                     } else if (data.error == \"ERR_KEY_NOT_CORRECT\") {",
        "// Line_Reference 935:                         $(\"#edit_show_error\").html('Key verification for Query is not correct!');",
        "// Line_Reference 936:                         $(\"#edit_show_error\").show();",
        "// Line_Reference 938:                     }else if (data.error == \"ERR_ENCRYPTION_NOT_CORRECT\") {",
        "// Line_Reference 940:                         $(\"#edit_show_error\").html('Item password could not be correctly encrypted!');",
        "// Line_Reference 941:                         $(\"#edit_show_error\").show();",
        "// Line_Reference 943:                     } else if (data.error == \"ERR_PWD_TOO_LONG\") {",
        "// Line_Reference 945:                         $(\"#edit_show_error\").html('<?php echo addslashes($LANG['error_pw_too_long']); ?>');",
        "// Line_Reference 946:                         $(\"#edit_show_error\").show();",
        "// Line_Reference 948:                     } else if (data.error == \"ERR_NOT_ALLOWED_TO_EDIT\") {",
        "// Line_Reference 950:                         $(\"#new_show_error\").html('User not allowed to edit this Item!');",
        "// Line_Reference 951:                         $(\"#new_show_error\").show();",
        "// Line_Reference 953:                     } else if (data.error != \"\") {",
        "// Line_Reference 955:                         $(\"#edit_show_error\").html('<?php echo addslashes($LANG['error_not_allowed_to']); ?>');",
        "// Line_Reference 956:                         $(\"#edit_show_error\").show();",
        "// Line_Reference 1275:                     type                : 'show_details_item',",
        "// Line_Reference 1276:                     id                  : id,",
        "// Line_Reference 1277:                     folder_id           : $('#hid_cat').val(),",
        "// Line_Reference 1278:                     salt_key_required   : $('#recherche_group_pf').val(),",
        "// Line_Reference 1279:                     salt_key_set        : $('#personal_sk_set').val(),",
        "// Line_Reference 1280:                     expired_item        : expired_item,",
        "// Line_Reference 1281:                     restricted          : restricted,",
        "// Line_Reference 1282:                     page                : \"items\",",
        "// Line_Reference 1283:                     key                 : \"<?php echo $_SESSION['key']; ?>\"",
        "// Line_Reference 1592:                     } else if (data.show_details == \"1\" && data.show_detail_option == \"2\") {",
        "// Line_Reference 2604:                             type    : \"update_rep\","
    ]
}
