{
    "cve_id": "CVE-2017-15053",
    "cve_description": "TeamPass before 2.1.27.9 does not properly enforce manager access control when requesting roles.queries.php. It is then possible for a manager user to modify any arbitrary roles within the application, or delete any arbitrary role. To exploit the vulnerability, an authenticated attacker must have the manager rights on the application, then tamper with the requests sent directly, for example by changing the \"id\" parameter when invoking \"delete_role\" on roles.queries.php.",
    "cve_publish_date": "2017-11-27",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "2.1.27\n\nAdded filter in Roles page\nImprove truncating title in list of items",
    "type_of_change": "Modification",
    "filename_of_changes": "items.load.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 795:     $(\"#div_formulaire_edition_item_info\").html(\"<?php echo \"<i class='fa fa-cog fa-spin fa-lg'></i>&nbsp;\".addslashes($LANG['please_wait']).\"...\"; ?>\").show();",
        "// Line_Reference 968:                         $(\"#fileclass\"+data.id).text($('#edit_label').val());",
        "// Line_Reference 1091:             $('#edit_show_error').html(\"<?php echo addslashes($LANG['error_complex_not_enought']); ?>\").show();",
        "// Line_Reference 1093:             $(\"#div_formulaire_edition_item_info\").addClass(\"hidden\").html(\"\");",
        "// Line_Reference 1099:         $(\"#div_formulaire_edition_item_info\").addClass(\"hidden\").html(\"\");",
        "// Line_Reference 1100:         $(\"#div_formulaire_edition_item ~ .ui-dialog-buttonpane\").find(\"button:contains('<?php echo addslashes($LANG['save_button']); ?>')\").prop(\"disabled\", false);"
    ]
}
