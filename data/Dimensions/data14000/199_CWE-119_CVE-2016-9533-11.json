{
    "cve_id": "CVE-2016-9533",
    "cve_description": "tif_pixarlog.c in libtiff 4.0.6 has out-of-bounds write vulnerabilities in heap allocated buffers. Reported as MSVR 35094, aka \"PixarLog horizontalDifference heap-buffer-overflow.\"",
    "cve_publish_date": "2016-11-22",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "* tools/tiffcrop.c: fix various out-of-bounds write vulnerabilities\nin heap or stack allocated buffers. Reported as MSVR 35093,\nMSVR 35096 and MSVR 35097. Discovered by Axel Souchet and Vishal\nChauhan from the MSRC Vulnerabilities & Mitigations team.\n* tools/tiff2pdf.c: fix out-of-bounds write vulnerabilities in\nheap allocate buffer in t2p_process_jpeg_strip(). Reported as MSVR\n35098. Discovered by Axel Souchet and Vishal Chauhan from the MSRC\nVulnerabilities & Mitigations team.\n* libtiff/tif_pixarlog.c: fix out-of-bounds write vulnerabilities\nin heap allocated buffers. Reported as MSVR 35094. Discovered by\nAxel Souchet and Vishal Chauhan from the MSRC Vulnerabilities &\nMitigations team.\n* libtiff/tif_write.c: fix issue in error code path of TIFFFlushData1()\nthat didn't reset the tif_rawcc and tif_rawcp members. I'm not\ncompletely sure if that could happen in practice outside of the odd\nbehaviour of t2p_seekproc() of tiff2pdf). The report points that a\nbetter fix could be to check the return value of TIFFFlushData1() in\nplaces where it isn't done currently, but it seems this patch is enough.\nReported as MSVR 35095. Discovered by Axel Souchet & Vishal Chauhan &\nSuha Can from the MSRC Vulnerabilities & Mitigations team.",
    "type_of_change": "Modification",
    "filename_of_changes": "tif_pixarlog.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "23",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 986: \t    ip += n - 1;\t/* point to last one */",
        "// Line_Reference 987: \t    wp += n - 1;\t/* point to last one */",
        "// Line_Reference 988: \t    n -= stride;",
        "// Line_Reference 989: \t    while (n > 0) {",
        "// Line_Reference 990: \t\tREPEAT(stride, wp[0] = (uint16) CLAMP(ip[0]);",
        "// Line_Reference 991: \t\t\t\twp[stride] -= wp[0];",
        "// Line_Reference 992: \t\t\t\twp[stride] &= mask;",
        "// Line_Reference 993: \t\t\t\twp--; ip--)",
        "// Line_Reference 994: \t\tn -= stride;",
        "// Line_Reference 995: \t    }",
        "// Line_Reference 996: \t    REPEAT(stride, wp[0] = (uint16) CLAMP(ip[0]); wp--; ip--)",
        "// Line_Reference 1039: \t    ip += n - 1;\t/* point to last one */",
        "// Line_Reference 1040: \t    wp += n - 1;\t/* point to last one */",
        "// Line_Reference 1043: \t\tREPEAT(stride, wp[0] = CLAMP(ip[0]);",
        "// Line_Reference 1044: \t\t\t\twp[stride] -= wp[0];",
        "// Line_Reference 1045: \t\t\t\twp[stride] &= mask;",
        "// Line_Reference 1046: \t\t\t\twp--; ip--)",
        "// Line_Reference 1047: \t\tn -= stride;",
        "// Line_Reference 1048: \t    }",
        "// Line_Reference 1049: \t    REPEAT(stride, wp[0] = CLAMP(ip[0]); wp--; ip--)",
        "// Line_Reference 1092: \t    wp += n + stride - 1;\t/* point to last one */",
        "// Line_Reference 1093: \t    ip += n + stride - 1;\t/* point to last one */",
        "// Line_Reference 1094: \t    n -= stride;",
        "// Line_Reference 1095: \t    while (n > 0) {",
        "// Line_Reference 1096: \t\tREPEAT(stride, wp[0] = CLAMP(ip[0]);",
        "// Line_Reference 1097: \t\t\t\twp[stride] -= wp[0];",
        "// Line_Reference 1098: \t\t\t\twp[stride] &= mask;",
        "// Line_Reference 1099: \t\t\t\twp--; ip--)",
        "// Line_Reference 1100: \t\tn -= stride;",
        "// Line_Reference 1101: \t    }",
        "// Line_Reference 1102: \t    REPEAT(stride, wp[0] = CLAMP(ip[0]); wp--; ip--)",
        "// Line_Reference 1103: \t}"
    ]
}
