{
    "cve_id": "CVE-2021-38114",
    "cve_description": "libavcodec/dnxhddec.c in FFmpeg 4.4 does not check the return value of the init_vlc function, a similar issue to CVE-2013-0868.",
    "cve_publish_date": "2021-08-04",
    "cwe_id": "CWE-252",
    "cwe_name": "Unchecked Return Value",
    "cwe_description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",
    "commit_message": "avcodec/dnxhddec: check and propagate function return value\n\nSimilar to CVE-2013-0868, here return value check for 'init_vlc' is needed.\ncrafted DNxHD data can cause unspecified impact.\n\nReviewed-by: Paul B Mahol <onemda@gmail.com>\nSigned-off-by: James Almer <jamrial@gmail.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "dnxhddec.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 135:         init_vlc(&ctx->ac_vlc, DNXHD_VLC_BITS, 257,",
        "// Line_Reference 137:                  ctx->cid_table->ac_codes, 2, 2, 0);",
        "// Line_Reference 138:         init_vlc(&ctx->dc_vlc, DNXHD_DC_VLC_BITS, bitdepth > 8 ? 14 : 12,",
        "// Line_Reference 140:                  ctx->cid_table->dc_codes, 1, 1, 0);",
        "// Line_Reference 141:         init_vlc(&ctx->run_vlc, DNXHD_VLC_BITS, 62,",
        "// Line_Reference 143:                  ctx->cid_table->run_codes, 2, 2, 0);",
        "// Line_Reference 147:     return 0;"
    ]
}
