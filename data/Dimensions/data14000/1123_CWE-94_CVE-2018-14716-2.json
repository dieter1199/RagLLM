{
    "cve_id": "CVE-2018-14716",
    "cve_description": "A Server Side Template Injection (SSTI) was discovered in the SEOmatic plugin before 3.1.4 for Craft CMS, because requests that don't match any elements incorrectly generate the canonicalUrl, and can lead to execution of Twig code.",
    "cve_publish_date": "2018-08-06",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "Changed the way requests that don't match any elements generate the `canonicalUrl`, to avoid potentially executing injected Twig code\n\nSigned-off-by: Andrew Welch <andrew@nystudio107.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "Helper.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "51",
    "number_of_lines_deleted_vulnerable_to_cve": "28",
    "vulnerable_lines": [
        "// Line_Reference 25: use craft\\helpers\\UrlHelper;",
        "// Line_Reference 43:      * Twig {% paginate %} tag: https://docs.craftcms.com/v3/templating/tags/paginate.html#the-pageInfo-variable",
        "// Line_Reference 89:      * The resulting array of arrays has `id`, `language`, `ogLanguage`, `hreflangLanguage`,",
        "// Line_Reference 90:      * and `url` as keys.",
        "// Line_Reference 285: ",
        "// Line_Reference 286:     /**",
        "// Line_Reference 287:      * Return a flattened, indented menu of the given $path",
        "// Line_Reference 288:      *",
        "// Line_Reference 289:      * @param string $path",
        "// Line_Reference 290:      *",
        "// Line_Reference 291:      * @return array",
        "// Line_Reference 292:      */",
        "// Line_Reference 293:     public static function getTypeMenu($path): array",
        "// Line_Reference 294:     {",
        "// Line_Reference 295:         return SchemaHelper::getTypeMenu($path);",
        "// Line_Reference 296:     }",
        "// Line_Reference 297: ",
        "// Line_Reference 298:     /**",
        "// Line_Reference 299:      * Return a single menu of schemas starting at $path",
        "// Line_Reference 300:      *",
        "// Line_Reference 301:      * @param string $path",
        "// Line_Reference 302:      *",
        "// Line_Reference 303:      * @return array",
        "// Line_Reference 304:      */",
        "// Line_Reference 305:     public static function getSingleTypeMenu($path): array",
        "// Line_Reference 306:     {",
        "// Line_Reference 307:         return SchemaHelper::getSingleTypeMenu($path);",
        "// Line_Reference 308:     }"
    ]
}
