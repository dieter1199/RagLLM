{
    "cve_id": "CVE-2022-3873",
    "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository jgraph/drawio prior to 20.5.2.",
    "cve_publish_date": "2022-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.5.2 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Dialogs.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "106",
    "number_of_lines_deleted_vulnerable_to_cve": "61",
    "vulnerable_lines": [
        "// Line_Reference 1539: var BackgroundImageDialog = function(editorUi, applyFn, img)",
        "// Line_Reference 1545: \tmxUtils.write(h3, mxResources.get('backgroundImage'));",
        "// Line_Reference 1928: \t\t\t\turl == null);",
        "// Line_Reference 4187: \t\tif (!mxClient.IS_FF && navigator.clipboard != null && mimeType == 'image/png')",
        "// Line_Reference 6197: \t\tvar curr = currentDiagrams[diagrams[currentPage].getAttribute('id')];",
        "// Line_Reference 6885: ",
        "// Line_Reference 6886: \t// TODO: Enable per-page math",
        "// Line_Reference 6887: //\tif (Editor.MathJaxRender)",
        "// Line_Reference 6888: //\t{",
        "// Line_Reference 6889: //\t\tgraph.model.addListener(mxEvent.CHANGE, mxUtils.bind(this, function(sender, evt)",
        "// Line_Reference 6890: //\t\t{",
        "// Line_Reference 6891: //\t\t\t// LATER: Math support is used if current graph has math enabled",
        "// Line_Reference 6892: //\t\t\t// should use switch from history instead but requires setting the",
        "// Line_Reference 6893: //\t\t\t// global mxClient.NO_FO switch",
        "// Line_Reference 6894: //\t\t\tif (editorUi.editor.graph.mathEnabled)",
        "// Line_Reference 6895: //\t\t\t{",
        "// Line_Reference 6896: //\t\t\t\tEditor.MathJaxRender(graph.container);",
        "// Line_Reference 6897: //\t\t\t}",
        "// Line_Reference 6898: //\t\t}));",
        "// Line_Reference 6899: //\t}",
        "// Line_Reference 6900: ",
        "// Line_Reference 6901: \tvar zoomInBtn = mxUtils.button('', function()",
        "// Line_Reference 6904: \t});",
        "// Line_Reference 6905: \tzoomInBtn.className = 'geSprite geSprite-zoomin';",
        "// Line_Reference 6906: \tzoomInBtn.setAttribute('title', mxResources.get('zoomIn'));",
        "// Line_Reference 6907: \tzoomInBtn.style.outline = 'none';",
        "// Line_Reference 6908: \tzoomInBtn.style.border = 'none';",
        "// Line_Reference 6909: \tzoomInBtn.style.margin = '2px';",
        "// Line_Reference 6910: \tmxUtils.setOpacity(zoomInBtn, 60);",
        "// Line_Reference 6911: ",
        "// Line_Reference 6912: \tvar zoomOutBtn = mxUtils.button('', function()",
        "// Line_Reference 6915: \t});",
        "// Line_Reference 6916: \tzoomOutBtn.className = 'geSprite geSprite-zoomout';",
        "// Line_Reference 6917: \tzoomOutBtn.setAttribute('title', mxResources.get('zoomOut'));",
        "// Line_Reference 6918: \tzoomOutBtn.style.outline = 'none';",
        "// Line_Reference 6919: \tzoomOutBtn.style.border = 'none';",
        "// Line_Reference 6920: \tzoomOutBtn.style.margin = '2px';",
        "// Line_Reference 6921: \tmxUtils.setOpacity(zoomOutBtn, 60);",
        "// Line_Reference 6923: \tvar zoomFitBtn = mxUtils.button('', function()",
        "// Line_Reference 6924: \t{",
        "// Line_Reference 6925: \t\tgraph.maxFitScale = 8;",
        "// Line_Reference 6926: \t\tgraph.fit(8);",
        "// Line_Reference 6927: \t\tgraph.center();",
        "// Line_Reference 6928: \t});",
        "// Line_Reference 6929: \tzoomFitBtn.className = 'geSprite geSprite-fit';",
        "// Line_Reference 6930: \tzoomFitBtn.setAttribute('title', mxResources.get('fit'));",
        "// Line_Reference 6931: \tzoomFitBtn.style.outline = 'none';",
        "// Line_Reference 6932: \tzoomFitBtn.style.border = 'none';",
        "// Line_Reference 6933: \tzoomFitBtn.style.margin = '2px';",
        "// Line_Reference 6934: \tmxUtils.setOpacity(zoomFitBtn, 60);",
        "// Line_Reference 6935: ",
        "// Line_Reference 6936: \tvar zoomActualBtn = mxUtils.button('', function()",
        "// Line_Reference 6938: \t\tgraph.zoomActual();",
        "// Line_Reference 6940: \t});",
        "// Line_Reference 6941: \tzoomActualBtn.className = 'geSprite geSprite-actualsize';",
        "// Line_Reference 6942: \tzoomActualBtn.setAttribute('title', mxResources.get('actualSize'));",
        "// Line_Reference 6943: \tzoomActualBtn.style.outline = 'none';",
        "// Line_Reference 6944: \tzoomActualBtn.style.border = 'none';",
        "// Line_Reference 6945: \tzoomActualBtn.style.margin = '2px';",
        "// Line_Reference 6946: \tmxUtils.setOpacity(zoomActualBtn, 60);",
        "// Line_Reference 7088: \ttb.appendChild(zoomActualBtn);"
    ]
}
