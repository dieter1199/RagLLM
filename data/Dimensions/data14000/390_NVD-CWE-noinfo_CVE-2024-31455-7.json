{
    "cve_id": "CVE-2024-31455",
    "cve_description": "Minder by Stacklok is an open source software supply chain security platform. A refactoring in commit `5c381cf` added the ability to get GitHub repositories registered to a project without specifying a specific provider.  Unfortunately, the SQL query for doing so was missing parenthesis, and would select a random repository. This issue is patched in pull request 2941. As a workaround, revert prior to `5c381cf`, or roll forward past `2eb94e7`.",
    "cve_publish_date": "2024-04-09",
    "cwe_id": "NVD-CWE-noinfo",
    "commit_message": "Make provider an optional filter (#2871)\n\nRef #2522",
    "type_of_change": "Modification",
    "filename_of_changes": "repositories.sql.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 206: SELECT id, provider, project_id, repo_owner, repo_name, repo_id, is_private, is_fork, webhook_id, webhook_url, deploy_url, clone_url, created_at, updated_at, default_branch, license, provider_id FROM repositories WHERE provider = $1 AND repo_owner = $2 AND repo_name = $3 AND project_id = $4",
        "// Line_Reference 210:     Provider  string    `json:\"provider\"`",
        "// Line_Reference 211:     RepoOwner string    `json:\"repo_owner\"`",
        "// Line_Reference 212:     RepoName  string    `json:\"repo_name\"`",
        "// Line_Reference 213:     ProjectID uuid.UUID `json:\"project_id\"`",
        "// Line_Reference 218:         arg.Provider,",
        "// Line_Reference 248: WHERE provider = $1 AND project_id = $2 AND webhook_id IS NOT NULL",
        "// Line_Reference 253:     Provider  string    `json:\"provider\"`",
        "// Line_Reference 254:     ProjectID uuid.UUID `json:\"project_id\"`",
        "// Line_Reference 258:     rows, err := q.db.QueryContext(ctx, listRegisteredRepositoriesByProjectIDAndProvider, arg.Provider, arg.ProjectID)",
        "// Line_Reference 300: WHERE provider = $1 AND project_id = $2",
        "// Line_Reference 301:   AND (repo_id >= $3 OR $3 IS NULL)",
        "// Line_Reference 307:     Provider  string        `json:\"provider\"`",
        "// Line_Reference 308:     ProjectID uuid.UUID     `json:\"project_id\"`",
        "// Line_Reference 309:     RepoID    sql.NullInt64 `json:\"repo_id\"`",
        "// Line_Reference 310:     Limit     sql.NullInt64 `json:\"limit\"`",
        "// Line_Reference 315:         arg.Provider,"
    ]
}
