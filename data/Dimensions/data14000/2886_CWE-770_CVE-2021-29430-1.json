{
    "cve_id": "CVE-2021-29430",
    "cve_description": "Sydent is a reference Matrix identity server. Sydent does not limit the size of requests it receives from HTTP clients. A malicious user could send an HTTP request with a very large body, leading to memory exhaustion and denial of service. Sydent also does not limit response size for requests it makes to remote Matrix homeservers. A malicious homeserver could return a very large response, again leading to memory exhaustion and denial of service. This affects any server which accepts registration requests from untrusted clients. This issue has been patched by releases 89071a1, 0523511, f56eee3. As a workaround request sizes can be limited in an HTTP reverse-proxy. There are no known workarounds for the problem with overlarge responses.",
    "cve_publish_date": "2021-04-15",
    "cwe_id": "CWE-770",
    "cwe_name": "Allocation of Resources Without Limits or Throttling",
    "cwe_description": "The product allocates a reusable resource or group of resources on behalf of an actor without imposing any restrictions on the size or number of resources that can be allocated, in violation of the intended security policy for that actor.",
    "commit_message": "Limit the size of .well-known lookups.\n\nThis is a port of matrix-org/synapse#8950 and matrix-org/synapse#9108.\n\nThis is not a straight port, the code is simplified a bit:\n\n* Type hints are removed since sydent supports Python 2.7.\n* The size of the response is not returned, only the bytes.",
    "type_of_change": "Modification",
    "filename_of_changes": "matrixfederationagent.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 29: from twisted.web.client import URI, Agent, HTTPConnectionPool, RedirectAgent, readBody",
        "// Line_Reference 319:             body = yield readBody(response)"
    ]
}
