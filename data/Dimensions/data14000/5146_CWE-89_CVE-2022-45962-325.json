{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Transcripts.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "137",
    "number_of_lines_deleted_vulnerable_to_cve": "39",
    "vulnerable_lines": [
        "// Line_Reference 101:             $tquery = \"SELECT tg.*, IF(tg.gradelevel IS NULL, CONCAT('O', TRIM((SELECT sg.ID FROM school_gradelevels sg, student_enrollment se WHERE se.STUDENT_ID = tg.STUDENT_ID AND se.SCHOOL_ID = tg.SCHOOL_ID AND se.SYEAR = tg.SYEAR AND se.GRADE_ID = sg.ID ORDER BY se.ID DESC LIMIT 0,1))), CONCAT('H', TRIM(tg.gradelevel))) AS gradelevel_ret FROM transcript_grades tg WHERE student_id = \" . $student_id . $gradelevel_addon . \" ORDER BY tg.mp_id\";",
        "// Line_Reference 165:                     $course_html[$colnum] .= '<h4 class=\"f-s-15 m-b-0 m-t-0\"><span class=\"text-blue\">' . $firstrec[SCHOOL_NAME] . '</span> - ' . $firstrec['MP_NAME'] . ' (' . $gradelevel . ')</h4>';",
        "// Line_Reference 193:                     $gradeletter = $trec['GRADE_LETTER'];",
        "// Line_Reference 198: ",
        "// Line_Reference 200: ",
        "// Line_Reference 203: \t\t\t else",
        "// Line_Reference 205: \t\t\t }",
        "// Line_Reference 209:          }",
        "// Line_Reference 213:         else",
        "// Line_Reference 215:         }",
        "// Line_Reference 223:        }",
        "// Line_Reference 228:            }",
        "// Line_Reference 238:                                       $qtr_gpa = $trec['GPA'];",
        "// Line_Reference 243:                                             $cred_attempted += $trec['CREDIT_ATTEMPTED'];",
        "// Line_Reference 245:                                             $cred_attempted += $trec['CREDIT_ATTEMPTED'];",
        "// Line_Reference 247:                         $cred_attempted += 0.00;",
        "// Line_Reference 248:                                       }",
        "// Line_Reference 251:                                             $cred_earned += $trec['CREDIT_EARNED'];",
        "// Line_Reference 253:                                             $cred_earned += $trec['CREDIT_EARNED'];",
        "// Line_Reference 255:                         $cred_earned += 0.00;",
        "// Line_Reference 256:                                         }",
        "// Line_Reference 261:                 $total_QP_value_fy += $QP_value;",
        "// Line_Reference 262:                 $cred_earned_fy += $trec['CREDIT_EARNED'];",
        "// Line_Reference 263:                 }",
        "// Line_Reference 265:                 $total_QP_value += $QP_value;",
        "// Line_Reference 266:                 $cred_earned_sem += $trec['CREDIT_EARNED'];",
        "// Line_Reference 267:                 }",
        "// Line_Reference 269:                 $total_QP_value_qr += $QP_value;",
        "// Line_Reference 270:                 $cred_earned_qr += $trec['CREDIT_EARNED'];",
        "// Line_Reference 271:                 }",
        "// Line_Reference 272:                 }",
        "// Line_Reference 290:                     $total_CGPA = $total_CGPA + ($total_QP_value / $qtr_gpa);",
        "// Line_Reference 323:                             <p><b><?=phone?> :</b> <?php echo $schoolinfo['PHONE']; ?></p>",
        "// Line_Reference 363:                                 <td><?php echo $tot_qp != 0 ? sprintf(\"%01.2f\", ($tot_qp / $total_CGPA_attemted)) : '0.00'; ?></td>",
        "// Line_Reference 367:                                 <td><?php echo sprintf(\"%01.2f\", $total_CGPA_attemp); ?></td>",
        "// Line_Reference 371:                                 <td><?php echo sprintf(\"%01.2f\", $total_credit_earn); ?></td>",
        "// Line_Reference 487:         $extra['extra_header_left'] .= '<div class=\"form-group\"><label class=\"radio-inline\"><input type=\"radio\" class=\"styled\" name=\"template\" id=\"\" value=\"two\" checked /> '._twoColumnTemplate.'</label></div>';",
        "// Line_Reference 488:         $extra['extra_header_left'] .= '<div class=\"form-group\"><label class=\"radio-inline\"><input class=\"styled\" type=\"radio\" name=\"template\" id=\"\" value=\"single\" /> '._singleColumnTemplate.'</label></div>';",
        "// Line_Reference 602:     return \"<input name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";"
    ]
}
