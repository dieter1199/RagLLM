{
    "cve_id": "CVE-2022-4314",
    "cve_description": "Improper Privilege Management in GitHub repository ikus060/rdiffweb prior to 2.5.2.",
    "cve_publish_date": "2022-12-12",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "Block repository access when user_root directory is empty or a relative path",
    "type_of_change": "Modification",
    "filename_of_changes": "librdiff.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 848:     def __init__(self, user_root, path, encoding):",
        "// Line_Reference 849:         if isinstance(user_root, str):",
        "// Line_Reference 850:             user_root = os.fsencode(user_root)",
        "// Line_Reference 851:         if isinstance(path, str):",
        "// Line_Reference 852:             path = os.fsencode(path)",
        "// Line_Reference 853:         assert isinstance(user_root, bytes)",
        "// Line_Reference 854:         assert isinstance(path, bytes)",
        "// Line_Reference 855:         assert encoding",
        "// Line_Reference 857:         assert self._encoding",
        "// Line_Reference 858:         self.path = path.strip(b\"/\")",
        "// Line_Reference 859:         if self.path:",
        "// Line_Reference 860:             self.full_path = os.path.normpath(os.path.join(user_root, self.path))",
        "// Line_Reference 861:         else:",
        "// Line_Reference 862:             self.full_path = os.path.normpath(user_root)",
        "// Line_Reference 1090:             # For repository we use either path if defined or the directory base name",
        "// Line_Reference 1091:             if not self.path:",
        "// Line_Reference 1092:                 return self._decode(unquote(os.path.basename(self.full_path)))",
        "// Line_Reference 1093:             return self._decode(unquote(self.path))"
    ]
}
