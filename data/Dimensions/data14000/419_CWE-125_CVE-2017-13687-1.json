{
    "cve_id": "CVE-2017-13687",
    "cve_description": "The Cisco HDLC parser in tcpdump before 4.9.2 has a buffer over-read in print-chdlc.c:chdlc_print().",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-13687/CHDLC: Improve bounds and length checks.\n\nPrevent a possible buffer overread in chdlc_print() and replace the\ncustom check in chdlc_if_print() with a standard check in chdlc_print()\nso that the latter certainly does not over-read even when reached via\njuniper_chdlc_print(). Add length checks.",
    "type_of_change": "Modification",
    "filename_of_changes": "print-chdlc.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 49: \tregister u_int length = h->len;",
        "// Line_Reference 50: \tregister u_int caplen = h->caplen;",
        "// Line_Reference 51: ",
        "// Line_Reference 52: \tif (caplen < CHDLC_HDRLEN) {",
        "// Line_Reference 53: \t\tND_PRINT((ndo, \"[|chdlc]\"));",
        "// Line_Reference 54: \t\treturn (caplen);",
        "// Line_Reference 55: \t}",
        "// Line_Reference 56:         return (chdlc_print(ndo, p,length));"
    ]
}
