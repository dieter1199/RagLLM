{
    "cve_id": "CVE-2021-3603",
    "cve_description": "PHPMailer 6.4.1 and earlier contain a vulnerability that can result in untrusted code being called (if such code is injected into the host project's scope by other means). If the $patternselect parameter to validateAddress() is set to 'php' (the default, defined by PHPMailer::$validator), and the global namespace contains a function called php, it will be called in preference to the built-in validator of the same name. Mitigated in PHPMailer 6.5.0 by denying the use of simple strings as validator function names.",
    "cve_publish_date": "2021-06-17",
    "cwe_id": "CWE-829",
    "cwe_name": "Inclusion of Functionality from Untrusted Control Sphere",
    "cwe_description": "The product imports, requires, or includes executable functionality (such as a library) from a source that is outside of the intended control sphere.",
    "commit_message": "Deny string-based callables altogether",
    "type_of_change": "Modification",
    "filename_of_changes": "PHPMailerTest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 736:         //Test denying override of built-in validator names",
        "// Line_Reference 741:         //Check a non-matching validator function, which should be permitted, and return false in this case",
        "// Line_Reference 742:         self::assertFalse(PHPMailer::validateAddress('test@example.com', 'phpx'));"
    ]
}
