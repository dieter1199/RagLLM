{
    "cve_id": "CVE-2020-12135",
    "cve_description": "bson before 0.8 incorrectly uses int rather than size_t for many variables, parameters, and return values. In particular, the bson_ensure_space() parameter bytesNeeded could have an integer overflow via properly constructed bson input.",
    "cve_publish_date": "2020-04-24",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "don't mix up int and size_t (first pass to fix that)",
    "type_of_change": "Modification",
    "filename_of_changes": "gridfs.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 231:     int bytes_left = 0;",
        "// Line_Reference 232:     int data_partial_len = 0;",
        "// Line_Reference 233:     int chunks_to_write = 0;",
        "// Line_Reference 593: MONGO_EXPORT mongo_cursor *gridfile_get_chunks( gridfile *gfile, int start, int size ) {",
        "// Line_Reference 608:         bson_append_int( &query, \"n\", start );",
        "// Line_Reference 612:         bson_append_int( &gte, \"$gte\", start );",
        "// Line_Reference 629:                          &command, NULL, size, 0, 0 );",
        "// Line_Reference 662:     int first_chunk;",
        "// Line_Reference 663:     int last_chunk;",
        "// Line_Reference 664:     int total_chunks;"
    ]
}
