{
    "cve_id": "CVE-2019-15900",
    "cve_description": "An issue was discovered in slicer69 doas before 6.2 on certain platforms other than OpenBSD. On platforms without strtonum(3), sscanf was used without checking for error cases. Instead, the uninitialized variable errstr was checked and in some cases returned success even if sscanf failed. The result was that, instead of reporting that the supplied username or group name did not exist, it would execute the command as root.",
    "cve_publish_date": "2019-10-18",
    "cwe_id": "CWE-252",
    "cwe_name": "Unchecked Return Value",
    "cwe_description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",
    "commit_message": "Added optimization to Makefile (can be set/overruled using OPT).\nAdded flag to display all warnings during compiling.\nAdded status checks when parsing user/group IDs for Linux.\nMake sure Linux drops original user's groups when running as another user.",
    "type_of_change": "Modification",
    "filename_of_changes": "doas.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 88: \tconst char *errstr;",
        "// Line_Reference 96: \t#else",
        "// Line_Reference 97: \tsscanf(s, \"%d\", uid);",
        "// Line_Reference 98: \t#endif",
        "// Line_Reference 120: \tconst char *errstr;",
        "// Line_Reference 128: \t#else",
        "// Line_Reference 129: \tsscanf(s, \"%d\", gid);",
        "// Line_Reference 130: \t#endif"
    ]
}
