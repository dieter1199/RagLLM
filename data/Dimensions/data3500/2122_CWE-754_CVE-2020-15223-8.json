{
    "cve_id": "CVE-2020-15223",
    "cve_description": "In ORY Fosite (the security first OAuth2 & OpenID Connect framework for Go) before version 0.34.0, the `TokenRevocationHandler` ignores errors coming from the storage. This can lead to unexpected 200 status codes indicating successful revocation while the token is still valid. Whether an attacker can use this for her advantage depends on the ability to trigger errors in the store. This is fixed in version 0.34.0",
    "cve_publish_date": "2020-09-24",
    "cwe_id": "CWE-754",
    "cwe_name": "Improper Check for Unusual or Exceptional Conditions",
    "cwe_description": "The product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.",
    "commit_message": "Merge pull request from GHSA-7mqr-2v3q-v2wm\n\nBREAKING CHANGE: `fosite.ErrRevocationClientMismatch` was removed because it is not part of [RFC 6749](https://tools.ietf.org/html/rfc6749#section-5.2). Instead, `fosite.ErrUnauthorizedClient` will be returned when calling `RevokeToken` with an OAuth2 Client which does not match the Access or Refresh Token to be revoked.",
    "type_of_change": "Modification",
    "filename_of_changes": "revocation.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 60: \tvar err error",
        "// Line_Reference 61: \tif ar, err = discoveryFuncs[0](); err != nil {",
        "// Line_Reference 62: \t\tar, err = discoveryFuncs[1]()",
        "// Line_Reference 64: \tif err != nil {",
        "// Line_Reference 65: \t\treturn err",
        "// Line_Reference 69: \t\treturn errors.WithStack(fosite.ErrRevocationClientMismatch)",
        "// Line_Reference 73: \tr.TokenRevocationStorage.RevokeRefreshToken(ctx, requestID)",
        "// Line_Reference 74: \tr.TokenRevocationStorage.RevokeAccessToken(ctx, requestID)",
        "// Line_Reference 76: \treturn nil"
    ]
}
