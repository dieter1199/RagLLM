{
    "cve_id": "CVE-2018-12649",
    "cve_description": "An issue was discovered in app/Controller/UsersController.php in MISP 2.4.92. An adversary can bypass the brute-force protection by using a PUT HTTP method instead of a POST HTTP method in the login part, because this protection was only covering POST requests.",
    "cve_publish_date": "2018-06-22",
    "cwe_id": "CWE-307",
    "cwe_name": "Improper Restriction of Excessive Authentication Attempts",
    "cwe_description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it more susceptible to brute force attacks.",
    "commit_message": "fix: [security] Brute force protection can be bypased with a PUT request\n\n- fixes an issue where brute forcing the login would work by using PUT requests\n- as reported by Silver Saks from CCDCOE",
    "type_of_change": "Modification",
    "filename_of_changes": "UsersController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 859: \t\t$this->Bruteforce = ClassRegistry::init('Bruteforce');",
        "// Line_Reference 860: \t\tif ($this->request->is('post') && isset($this->request->data['User']['email'])) {",
        "// Line_Reference 861: \t\t\tif ($this->Bruteforce->isBlacklisted($_SERVER['REMOTE_ADDR'], $this->request->data['User']['email'])) {",
        "// Line_Reference 862: \t\t\t\tthrow new ForbiddenException('You have reached the maximum number of login attempts. Please wait ' . Configure::read('SecureAuth.expire') . ' seconds and try again.');",
        "// Line_Reference 863: \t\t\t}",
        "// Line_Reference 864: \t\t}"
    ]
}
