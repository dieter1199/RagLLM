{
    "cve_id": "CVE-2019-14749",
    "cve_description": "An issue was discovered in osTicket before 1.10.7 and 1.12.x before 1.12.1. CSV (aka Formula) injection exists in the export spreadsheets functionality. These spreadsheets are generated dynamically from unvalidated or unfiltered user input in the Name and Internal Notes fields in the Users tab, and the Issue Summary field in the tickets tab. This allows other agents to download data in a .csv file format or .xls file format. This is used as input for spreadsheet applications such as Excel and OpenOffice Calc, resulting in a situation where cells in the spreadsheets can contain input from an untrusted source. As a result, the end user who is accessing the exported spreadsheet can be affected.",
    "cve_publish_date": "2019-08-07",
    "cwe_id": "CWE-1236",
    "cwe_name": "Improper Neutralization of Formula Elements in a CSV File",
    "cwe_description": "The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.",
    "commit_message": "security: CSV Formula Injection\n\nThis addresses a security issue discovered by Aishwarya Iyer where a User\ncan change their Full Name to a windows formula and when an Agent exports a\nlist of Users containing said User and opens the export file, the formula\nwill be executed on their computer (if it's windows of course). This adds a\nnew validator called `is_formula()` to all text fields disallowing the use\nof the following characters `= + - @` at the beginning of text. This should\nmitigate CSV Formula injections for any text field that allows user-input in\nthe system. To further prevent CSV Formula injections this adds an escape\nmechanism to the Exporter that will escape any content matching the formula\nregex with a single quote (as mentioned in many posts about this subject).",
    "type_of_change": "Modification",
    "filename_of_changes": "class.user.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 251:             return !isset($thisstaff) || $f->isRequiredForStaff();"
    ]
}
