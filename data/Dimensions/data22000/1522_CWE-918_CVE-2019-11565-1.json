{
    "cve_id": "CVE-2019-11565",
    "cve_description": "Server Side Request Forgery (SSRF) exists in the Print My Blog plugin before 1.6.7 for WordPress via the site parameter.",
    "cve_publish_date": "2019-04-27",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "do a little more sanitizing of the site param when REST PRoxy enabled",
    "type_of_change": "Modification",
    "filename_of_changes": "RestApiDetector.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 33:         // If the REST API Proxy Plugin isn't active, always use the current site.",
        "// Line_Reference 34:         if(! PMB_REST_PROXY_EXISTS){",
        "// Line_Reference 35:             $site = '';",
        "// Line_Reference 36:         }",
        "// Line_Reference 37:         $this->setSite($site);",
        "// Line_Reference 58:         // If they forgot to add http(s), add it for them.",
        "// Line_Reference 59:         if(strpos($this->getSite(), 'http://') === false && strpos($this->getSite(), 'https://') === false) {",
        "// Line_Reference 60:             $this->setSite( 'http://' . $this->getSite());",
        "// Line_Reference 61:         }",
        "// Line_Reference 62:         // if there is one, check if it exists in wordpress.com, eg \"retirementreflections.com\"",
        "// Line_Reference 63:         $site = trailingslashit(sanitize_text_field($this->getSite()));",
        "// Line_Reference 64: ",
        "// Line_Reference 65: "
    ]
}
