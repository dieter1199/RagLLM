{
    "cve_id": "CVE-2014-2672",
    "cve_description": "Race condition in the ath_tx_aggr_sleep function in drivers/net/wireless/ath/ath9k/xmit.c in the Linux kernel before 3.13.7 allows remote attackers to cause a denial of service (system crash) via a large amount of network traffic that triggers certain list deletions.",
    "cve_publish_date": "2014-04-01",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "ath9k: protect tid->sched check\n\nWe check tid->sched without a lock taken on ath_tx_aggr_sleep(). That\nis race condition which can result of doing list_del(&tid->list) twice\n(second time with poisoned list node) and cause crash like shown below:\n\n[424271.637220] BUG: unable to handle kernel paging request at 00100104\n[424271.637328] IP: [<f90fc072>] ath_tx_aggr_sleep+0x62/0xe0 [ath9k]\n...\n[424271.639953] Call Trace:\n[424271.639998]  [<f90f6900>] ? ath9k_get_survey+0x110/0x110 [ath9k]\n[424271.640083]  [<f90f6942>] ath9k_sta_notify+0x42/0x50 [ath9k]\n[424271.640177]  [<f809cfef>] sta_ps_start+0x8f/0x1c0 [mac80211]\n[424271.640258]  [<c10f730e>] ? free_compound_page+0x2e/0x40\n[424271.640346]  [<f809e915>] ieee80211_rx_handlers+0x9d5/0x2340 [mac80211]\n[424271.640437]  [<c112f048>] ? kmem_cache_free+0x1d8/0x1f0\n[424271.640510]  [<c1345a84>] ? kfree_skbmem+0x34/0x90\n[424271.640578]  [<c10fc23c>] ? put_page+0x2c/0x40\n[424271.640640]  [<c1345a84>] ? kfree_skbmem+0x34/0x90\n[424271.640706]  [<c1345a84>] ? kfree_skbmem+0x34/0x90\n[424271.640787]  [<f809dde3>] ? ieee80211_rx_handlers_result+0x73/0x1d0 [mac80211]\n[424271.640897]  [<f80a07a0>] ieee80211_prepare_and_rx_handle+0x520/0xad0 [mac80211]\n[424271.641009]  [<f809e22d>] ? ieee80211_rx_handlers+0x2ed/0x2340 [mac80211]\n[424271.641104]  [<c13846ce>] ? ip_output+0x7e/0xd0\n[424271.641182]  [<f80a1057>] ieee80211_rx+0x307/0x7c0 [mac80211]\n[424271.641266]  [<f90fa6ee>] ath_rx_tasklet+0x88e/0xf70 [ath9k]\n[424271.641358]  [<f80a0f2c>] ? ieee80211_rx+0x1dc/0x7c0 [mac80211]\n[424271.641445]  [<f90f82db>] ath9k_tasklet+0xcb/0x130 [ath9k]\n\nBug report:\nhttps://bugzilla.kernel.org/show_bug.cgi?id=70551\n\nReported-and-tested-by: Max Sydorenko <maxim.stargazer@gmail.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Stanislaw Gruszka <sgruszka@redhat.com>\nSigned-off-by: John W. Linville <linville@tuxdriver.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "xmit.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 1447: \t\tif (!tid->sched)",
        "// Line_Reference 1448: \t\t\tcontinue;",
        "// Line_Reference 1449: "
    ]
}
