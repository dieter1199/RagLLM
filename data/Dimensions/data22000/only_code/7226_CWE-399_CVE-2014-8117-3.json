FILE_RCSID("@(#)$File: softmagic.c,v 1.196 2014/11/07 15:24:14 christos Exp $")
uint32_t soffset, offset = ms->offset;
char *sbuf, *rbuf;
if (recursion_level >= 20) {
sbuf = ms->o.buf;
soffset = ms->offset;
ms->o.buf = NULL;
ms->offset = 0;
rbuf = ms->o.buf;
ms->o.buf = sbuf;
ms->offset = soffset;
sbuf = m->value.s;
if (*sbuf == '^') {
sbuf++;
if (file_magicfind(ms, sbuf, &ml) == -1) {
file_error(ms, 0, "cannot find entry `%s'", sbuf);