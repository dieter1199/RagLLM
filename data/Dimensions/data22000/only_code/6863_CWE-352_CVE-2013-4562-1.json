# You can pass +display+, +state+ or +scope+ params to the auth request, if
%w[display state scope].each do |v|
# to support omniauth-oauth2's auto csrf protection
session['omniauth.state'] = params[:state] if v == 'state'
