#define TEMP_TICKET_BUF_LEN	256
void **p, void *end, void *obuf, size_t olen)
ret = ceph_decrypt2(secret, &head, &head_len, obuf, &olen,
*p, len);
void **p, void *end,
void *dbuf, void *ticket_buf)
dlen = ceph_x_decrypt(secret, p, end, dbuf,
TEMP_TICKET_BUF_LEN);
tp = ticket_buf;
dlen = ceph_x_decrypt(&old_key, p, end, ticket_buf,
TEMP_TICKET_BUF_LEN);
char *dbuf;
char *ticket_buf;
dbuf = kmalloc(TEMP_TICKET_BUF_LEN, GFP_NOFS);
if (!dbuf)
return -ENOMEM;
ret = -ENOMEM;
ticket_buf = kmalloc(TEMP_TICKET_BUF_LEN, GFP_NOFS);
if (!ticket_buf)
goto out_dbuf;
ret = process_one_ticket(ac, secret, &p, end,
dbuf, ticket_buf);
goto out;
ret = 0;
out:
kfree(ticket_buf);
out_dbuf:
kfree(dbuf);
return ret;
ret = -EINVAL;
goto out;
ret = ceph_x_decrypt(&th->session_key, &p, end, &reply, sizeof(reply));
