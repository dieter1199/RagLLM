// We already have one correct captcha.
$skip = false;
if (  isset($_SESSION['last_valid_captcha'])
&& $_SESSION['last_valid_captcha']
) {
$skip = true;
}
&& !$skip
// $_SESSION array is not immediately emptied
$_SESSION['last_valid_captcha'] = false;
// We already have one correct captcha.
$skip = false;
if (isset($_SESSION['last_valid_captcha'])
&& $_SESSION['last_valid_captcha']
) {
$skip = true;
}
&& ! $skip
$_SESSION['last_valid_captcha'] = false;
} else {
$_SESSION['last_valid_captcha'] = true;
if (! isset($_SESSION['last_valid_captcha'])
|| ! $_SESSION['last_valid_captcha']
) {
$conn_error = __('Please enter correct captcha!');
return false;
}
