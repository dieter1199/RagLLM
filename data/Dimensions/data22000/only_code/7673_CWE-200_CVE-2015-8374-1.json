btrfs_file_extent_compression(leaf, fi) == 0 &&
u32 size = new_size - found_key.offset;
if (test_bit(BTRFS_ROOT_REF_COWS, &root->state))
inode_sub_bytes(inode, item_end + 1 -
new_size);
* update the ram bytes to properly reflect
* the new size of our item
btrfs_set_file_extent_ram_bytes(leaf, fi, size);
size =
btrfs_file_extent_calc_inline_size(size);
btrfs_truncate_item(root, path, size, 1);
inode_sub_bytes(inode, item_end + 1 -
found_key.offset);
