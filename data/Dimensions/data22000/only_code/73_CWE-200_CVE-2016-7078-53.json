User.current = FactoryGirl.build(:user, :admin => true)
assert_difference 'User.where(:login => "admin").count', 1 do
user = User.find_by_login('admin')
assert_difference 'User.where(:login => "seed_test").count', 1 do
user = User.find_by_login('seed_test')
count = Ptable.count
assert_not_equal count, Ptable.count
refute Ptable.where(:os_family => nil).any?
count = Medium.count
assert_not_equal count, Medium.count
refute Medium.where(:os_family => nil).any?
count = ProvisioningTemplate.count
assert_not_equal count, ProvisioningTemplate.count
assert Ptable.where(:template => File.read(tmpl)).any?, "No partition table containing #{tmpl}"
assert ProvisioningTemplate.where(:template => File.read(tmpl)).any?, "No template containing #{tmpl}"
count = Bookmark.where(:public => true).count
assert_not_equal count, Bookmark.where(:public => true).count
ProvisioningTemplate.without_auditing { ProvisioningTemplate.find_by_name('Kickstart default').update_attributes(:template => 'test') }
refute_equal ProvisioningTemplate.find_by_name('Kickstart default').template, 'test'
assert_equal 1, ProvisioningTemplate.destroy_all(:name => 'Kickstart default').size
refute ProvisioningTemplate.find_by_name('Kickstart default')
tmpl = ProvisioningTemplate.find_by_name('Kickstart default')
refute ProvisioningTemplate.find_by_name('Kickstart default')
assert Organization.find_by_name('seed_test')
refute Organization.find_by_name('seed_test')
assert Location.find_by_name('seed_test')
refute Location.find_by_name('seed_test')
assert_equal [], view_permissions - Role.find_by_name('Viewer').permissions