wd = mkdtemp()
with patch.object(os, "getcwd", lambda: wd):
app = DummyApp(config_dir=config_dir)
app.initialize([])
with open(pjoin(wd, "dummy_app_config.py"), "w", encoding="utf-8") as f:
f.write("c.DummyApp.n = 2")
assert app.m == 1, "Loaded config from config dir"
assert app.n == 2, "Loaded config from CWD"
wd = mkdtemp()
with patch.object(os, "getcwd", lambda: wd):
with pytest.raises(SyntaxError):
app = DummyApp(config_dir=config_dir)
app.raise_config_file_errors = True
app.initialize([])
shutil.rmtree(wd)