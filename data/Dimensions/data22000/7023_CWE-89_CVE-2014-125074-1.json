{
    "cve_id": "CVE-2014-125074",
    "cve_description": "A vulnerability was found in Nayshlok Voyager. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the file Voyager/src/models/DatabaseAccess.java. The manipulation leads to sql injection. The identifier of the patch is f1249f438cd8c39e7ef2f6c8f2ab76b239a02fae. It is recommended to apply a patch to fix this issue. The identifier VDB-218005 was assigned to this vulnerability.",
    "cve_publish_date": "2023-01-11",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "fixed problems in register controller, and worked at preventing sql-injection in database access",
    "type_of_change": "Modification",
    "filename_of_changes": "DatabaseAccess.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 25: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 28: \t\t\tPreparedStatement statement = con.prepareStatement(\"Select userName, userPassword, userEmail, userRole from UserTable where userName = '\" + username + \"'\");",
        "// Line_Reference 58: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 62: \t\t\t\t\t+ \"VALUES ('\" + user.getUsername() + \"', '\" + user.getPassword() + \"', '\" + user.getEmail() + \"', '\" + user.getRole().toString() + \"');\");",
        "// Line_Reference 82: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 85: \t\t\tPreparedStatement statement = con.prepareStatement(\"DELETE FROM UserTable WHERE userName='\" + user.getUsername() + \"'\");",
        "// Line_Reference 99: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 103: \t\t\t\t\t+ \"SET userPassword='\" + user.getPassword() + \"', userEmail='\" + user.getEmail() + \"', userRole='\" + user.getRole().toString() + \"'\"",
        "// Line_Reference 104: \t\t\t\t\t+ \"WHERE userName='\" + user.getUsername() + \"'\");",
        "// Line_Reference 109: \t\t}",
        "// Line_Reference 117: \t\tAccount account = null;",
        "// Line_Reference 120: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 123: \t\t\tPreparedStatement statement = con.prepareStatement(\"Select userId from UserTable where userName = '\" + user + \"'\");",
        "// Line_Reference 141: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 144: \t\t\tPreparedStatement statement = con.prepareStatement(\"Select userName from UserTable where userId = '\" + userId + \"'\");",
        "// Line_Reference 162: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";",
        "// Line_Reference 173: ",
        "// Line_Reference 181: \t\tString connectionUrl = \"jdbc:sqlserver://n8bu1j6855.database.windows.net:1433;database=VoyagerDB;user=VoyageLogin@n8bu1j6855;password={GroupP@ssword};encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;\";"
    ]
}
