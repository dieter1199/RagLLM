{
    "cve_id": "CVE-2012-3366",
    "cve_description": "The Trigger plugin in bcfg2 1.2.x before 1.2.3 allows remote attackers with root access to the client to execute arbitrary commands via shell metacharacters in the UUID field to the server process (bcfg2-server).",
    "cve_publish_date": "2012-07-03",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "fixed major security flaw in Trigger plugin",
    "type_of_change": "Modification",
    "filename_of_changes": "Trigger.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 3: ",
        "// Line_Reference 4: ",
        "// Line_Reference 5: def async_run(prog, args):",
        "// Line_Reference 6:     pid = os.fork()",
        "// Line_Reference 7:     if pid:",
        "// Line_Reference 8:         os.waitpid(pid, 0)",
        "// Line_Reference 9:     else:",
        "// Line_Reference 10:         dpid = os.fork()",
        "// Line_Reference 11:         if not dpid:",
        "// Line_Reference 12:             os.system(\" \".join([prog] + args))",
        "// Line_Reference 13:         os._exit(0)",
        "// Line_Reference 14: ",
        "// Line_Reference 42:             npath = self.data + '/' + notifier",
        "// Line_Reference 43:             self.logger.debug(\"Running %s %s\" % (npath, \" \".join(args)))",
        "// Line_Reference 44:             async_run(npath, args)"
    ]
}
