{
    "cve_id": "CVE-2022-1775",
    "cve_description": "Weak Password Requirements in GitHub repository polonel/trudesk prior to 1.2.2.",
    "cve_publish_date": "2022-05-20",
    "cwe_id": "CWE-521",
    "cwe_name": "Weak Password Requirements",
    "cwe_description": "The product does not require that users should have strong passwords, which makes it easier for attackers to compromise user accounts.",
    "commit_message": "refactor(accounts): password security enhancements",
    "type_of_change": "Modification",
    "filename_of_changes": "users.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "111",
    "number_of_lines_deleted_vulnerable_to_cve": "51",
    "vulnerable_lines": [
        "// Line_Reference 17: const winston = require('winston')",
        "// Line_Reference 150: apiUsers.create = function (req, res) {",
        "// Line_Reference 177:   const Chance = require('chance')",
        "// Line_Reference 178:   const chance = new Chance()",
        "// Line_Reference 180:   const account = new UserSchema({",
        "// Line_Reference 181:     username: postData.aUsername,",
        "// Line_Reference 182:     password: postData.aPass,",
        "// Line_Reference 183:     fullname: postData.aFullname,",
        "// Line_Reference 184:     email: postData.aEmail,",
        "// Line_Reference 185:     accessToken: chance.hash(),",
        "// Line_Reference 186:     role: postData.aRole",
        "// Line_Reference 187:   })",
        "// Line_Reference 189:   if (postData.aTitle) {",
        "// Line_Reference 190:     account.title = postData.aTitle",
        "// Line_Reference 191:   }",
        "// Line_Reference 193:   account.save(function (err, a) {",
        "// Line_Reference 194:     if (err) {",
        "// Line_Reference 195:       response.success = false",
        "// Line_Reference 196:       response.error = err",
        "// Line_Reference 197:       winston.debug(response)",
        "// Line_Reference 198:       return res.status(400).json(response)",
        "// Line_Reference 199:     }",
        "// Line_Reference 201:     a.populate('role', function (err, populatedAccount) {",
        "// Line_Reference 202:       if (err) return res.status(500).json({ success: false, error: err })",
        "// Line_Reference 204:       response.account = populatedAccount.toObject()",
        "// Line_Reference 205:       delete response.account.password",
        "// Line_Reference 207:       const groups = []",
        "// Line_Reference 209:       async.each(",
        "// Line_Reference 210:         postData.aGrps,",
        "// Line_Reference 211:         function (id, done) {",
        "// Line_Reference 212:           if (_.isUndefined(id)) return done(null)",
        "// Line_Reference 213:           groupSchema.getGroupById(id, function (err, grp) {",
        "// Line_Reference 214:             if (err) return done(err)",
        "// Line_Reference 215:             if (!grp) return done('Invalid Group (' + id + ') - Group not found. Check Group ID')",
        "// Line_Reference 217:             grp.addMember(a._id, function (err, success) {",
        "// Line_Reference 218:               if (err) return done(err)",
        "// Line_Reference 220:               grp.save(function (err) {",
        "// Line_Reference 221:                 if (err) return done(err)",
        "// Line_Reference 222:                 groups.push(grp)",
        "// Line_Reference 223:                 done(null, success)",
        "// Line_Reference 224:               })",
        "// Line_Reference 225:             })",
        "// Line_Reference 227:         },",
        "// Line_Reference 228:         function (err) {",
        "// Line_Reference 229:           if (err) return res.status(400).json({ success: false, error: err })",
        "// Line_Reference 230:           response.account.groups = groups",
        "// Line_Reference 231:           return res.json(response)",
        "// Line_Reference 232:         }",
        "// Line_Reference 233:       )",
        "// Line_Reference 234:     })",
        "// Line_Reference 235:   })"
    ]
}
