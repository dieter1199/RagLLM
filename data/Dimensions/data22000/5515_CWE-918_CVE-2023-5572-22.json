{
    "cve_id": "CVE-2023-5572",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository vriteio/vrite prior to 0.3.0.",
    "cve_publish_date": "2023-10-13",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "Vrite v0.3 (#45)\n\n- Replace wrapper with element;\r\n- Add XML-like syntax for elements;\r\n- Redesign editor block menus;\r\n- Add MDX extension;\r\n- Allow CORS API access;\r\n- Restructure @vrite/backend;",
    "type_of_change": "Modification",
    "filename_of_changes": "api.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 7: import corsPlugin from \"@fastify/cors\";",
        "// Line_Reference 65:     methods: [\"GET\", \"DELETE\", \"PUT\", \"POST\"],",
        "// Line_Reference 66:     origin(origin, callback) {",
        "// Line_Reference 67:       if (!origin || origin === \"null\") {",
        "// Line_Reference 68:         callback(null, true);",
        "// Line_Reference 69: ",
        "// Line_Reference 70:         return;",
        "// Line_Reference 71:       }",
        "// Line_Reference 72: ",
        "// Line_Reference 73:       const { hostname } = new URL(origin);",
        "// Line_Reference 74:       const appHostname = new URL(fastify.config.PUBLIC_APP_URL).hostname;",
        "// Line_Reference 75: ",
        "// Line_Reference 76:       if (",
        "// Line_Reference 77:         hostname === \"localhost\" ||",
        "// Line_Reference 78:         hostname.endsWith(appHostname) ||",
        "// Line_Reference 79:         (fastify.config.VRITE_CLOUD && hostname.endsWith(\"swagger.io\"))",
        "// Line_Reference 80:       ) {",
        "// Line_Reference 81:         callback(null, true);",
        "// Line_Reference 82: ",
        "// Line_Reference 83:         return;",
        "// Line_Reference 84:       }",
        "// Line_Reference 85: ",
        "// Line_Reference 86:       callback(new Error(\"Not allowed\"), false);",
        "// Line_Reference 87:     }"
    ]
}
