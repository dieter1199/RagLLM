{
    "cve_id": "CVE-2015-10106",
    "cve_description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as critical was found in mback2k mh_httpbl Extension up to 1.1.7 on TYPO3. This vulnerability affects the function moduleContent of the file mod1/index.php. The manipulation leads to sql injection. The attack can be initiated remotely. Upgrading to version 1.1.8 is able to address this issue. The patch is identified as 429f50f4e4795b20dae06735b41fb94f010722bf. It is recommended to upgrade the affected component. VDB-230086 is the identifier assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "cve_publish_date": "2023-05-28",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fix TYPO3-EXT-SA-2015-021: SQL Injection\n\nHandle all user-input which is passed as WHERE or ORDER statement to\nexec_SELECTquery using fullQuoteStr or explicit value checks.",
    "type_of_change": "Modification",
    "filename_of_changes": "index.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 207: \t\t\t\t\t$where = \"block_ip = '\". t3lib_div::_GP('block_ip') .\"'\";",
        "// Line_Reference 212: \t\t\t\t\t$order = t3lib_div::_GP('sort').' '.strtoupper(t3lib_div::_GP('order'));",
        "// Line_Reference 243: \t\t\t\t\t$GLOBALS['TYPO3_DB']->exec_INSERTquery('tx_mhhttpbl_whitelist', array('cruser_id'=>$BE_USER->user['uid'], 'crdate'=>time(), 'tstamp'=>time(), 'whitelist_ip'=>implode('.', t3lib_div::_GP('whitelist_ip'))));",
        "// Line_Reference 278: \t\t\t\t\t$order = t3lib_div::_GP('sort').' '.strtoupper(t3lib_div::_GP('order'));",
        "// Line_Reference 315: \t\t\t\t\t$order = t3lib_div::_GP('sort').' '.strtoupper(t3lib_div::_GP('order'));"
    ]
}
