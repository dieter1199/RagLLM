{
    "cve_id": "CVE-2023-0048",
    "cve_description": "Code Injection in GitHub repository lirantal/daloradius prior to master-branch.",
    "cve_publish_date": "2023-01-04",
    "cwe_id": "CWE-94",
    "cwe_name": "Improper Control of Generation of Code ('Code Injection')",
    "cwe_description": "The product constructs all or part of a code segment using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the syntax or behavior of the intended code segment.",
    "commit_message": "Validating/sanitizing user input (#327)\n\n* Better validating log filepath\r\n\r\n* improving configuration read/write function\r\n\r\n* SMTP configuration parameter validation\r\n\r\n* Input validation/sanitization fixes\r\n\r\n* minor fix",
    "type_of_change": "Modification",
    "filename_of_changes": "config-mail.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "127",
    "number_of_lines_deleted_vulnerable_to_cve": "59",
    "vulnerable_lines": [
        "// Line_Reference 28: ",
        "// Line_Reference 31: ",
        "// Line_Reference 34:     if (isset($_REQUEST['submit'])) {",
        "// Line_Reference 36:         if (isset($_REQUEST['config_mail_smtpaddr']))",
        "// Line_Reference 37:             $configValues['CONFIG_MAIL_SMTPADDR'] = $_REQUEST['config_mail_smtpaddr'];",
        "// Line_Reference 38: ",
        "// Line_Reference 39:         if (isset($_REQUEST['config_mail_smtpport']))",
        "// Line_Reference 40:             $configValues['CONFIG_MAIL_SMTPPORT'] = $_REQUEST['config_mail_smtpport'];",
        "// Line_Reference 41: ",
        "// Line_Reference 42:         if (isset($_REQUEST['config_mail_smtp_fromemail']))",
        "// Line_Reference 43:             $configValues['CONFIG_MAIL_SMTPFROM'] = $_REQUEST['config_mail_smtp_fromemail'];",
        "// Line_Reference 44: ",
        "// Line_Reference 45:         include (\"library/config_write.php\");",
        "// Line_Reference 46:     }",
        "// Line_Reference 48:     include(\"library/layout.php\");",
        "// Line_Reference 63: ?>",
        "// Line_Reference 64: ",
        "// Line_Reference 65: <form name=\"mailsettings\" method=\"POST\">",
        "// Line_Reference 66:     <fieldset>",
        "// Line_Reference 67:         <h302><?= t('title','Settings'); ?></h302>",
        "// Line_Reference 68: ",
        "// Line_Reference 69:         <br/>",
        "// Line_Reference 70: ",
        "// Line_Reference 71:         <ul>",
        "// Line_Reference 72: ",
        "// Line_Reference 73:             <li class=\"fieldset\">",
        "// Line_Reference 74:                 <label for=\"config_mail_smtpaddr\" class=\"form\"><?= t('all','SMTPServerAddress') ?></label>",
        "// Line_Reference 75:                 <input type=\"text\" value=\"<?= $configValues['CONFIG_MAIL_SMTPADDR'] ?>\" name=\"config_mail_smtpaddr\">",
        "// Line_Reference 76:             </li>",
        "// Line_Reference 78:             <li class=\"fieldset\">",
        "// Line_Reference 79:                 <label for=\"config_mail_smtpport\" class=\"form\"><?= t('all','SMTPServerPort') ?></label>",
        "// Line_Reference 80:                 <input type=\"number\" min=\"0\" max=\"65535\" value=\"<?= $configValues['CONFIG_MAIL_SMTPPORT'] ?>\" name=\"config_mail_smtpport\">",
        "// Line_Reference 81:             </li>",
        "// Line_Reference 82: ",
        "// Line_Reference 83:             <li class=\"fieldset\">",
        "// Line_Reference 84:                 <label for=\"config_mail_smtp_fromemail\" class=\"form\"><?= t('all','SMTPServerFromEmail') ?></label>",
        "// Line_Reference 85:                 <input type=\"text\" value=\"<?= $configValues['CONFIG_MAIL_SMTPFROM'] ?>\" name=\"config_mail_smtp_fromemail\">",
        "// Line_Reference 86:             </li>",
        "// Line_Reference 87: ",
        "// Line_Reference 88: ",
        "// Line_Reference 89:             <li class=\"fieldset\">",
        "// Line_Reference 90:                 <br/><hr><br/>",
        "// Line_Reference 91:                 <input type=\"submit\" name=\"submit\" value=\"<?= t('buttons','apply') ?>\" class=\"button\">",
        "// Line_Reference 92:             </li>",
        "// Line_Reference 93:         </ul>",
        "// Line_Reference 94:     </fieldset>",
        "// Line_Reference 95: </form>",
        "// Line_Reference 96: ",
        "// Line_Reference 97:         </div><!-- #contentnorightbar -->",
        "// Line_Reference 98: ",
        "// Line_Reference 99:         <div id=\"footer\">",
        "// Line_Reference 100: <?php",
        "// Line_Reference 102:     include('page-footer.php');",
        "// Line_Reference 103: ?>",
        "// Line_Reference 104:         </div><!-- #footer -->",
        "// Line_Reference 105:     </div>",
        "// Line_Reference 106: </div>",
        "// Line_Reference 108: </body>",
        "// Line_Reference 109: </html>"
    ]
}
