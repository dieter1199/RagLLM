{
    "cve_id": "CVE-2022-3065",
    "cve_description": "Improper Access Control in GitHub repository jgraph/drawio prior to 20.2.8.",
    "cve_publish_date": "2022-09-02",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "20.2.8 release",
    "type_of_change": "Modification",
    "filename_of_changes": "App.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "59",
    "vulnerable_lines": [
        "// Line_Reference 7599: \t\t\t\t\tif (!connected)",
        "// Line_Reference 7600: \t\t\t\t\t{",
        "// Line_Reference 7601: \t\t\t\t\t\tvar div = document.createElement('div');",
        "// Line_Reference 7602: \t\t\t\t\t\tdiv.style.textAlign = 'center';",
        "// Line_Reference 7603: \t\t\t\t\t\tdiv.style.padding = '10px';",
        "// Line_Reference 7604: \t\t\t\t\t\tdiv.innerHTML = mxResources.get('notConnected');",
        "// Line_Reference 7605: ",
        "// Line_Reference 7606: \t\t\t\t\t\tthis.userPanel.appendChild(div);",
        "// Line_Reference 7607: \t\t\t\t\t}",
        "// Line_Reference 7608: ",
        "// Line_Reference 7609: \t\t\t\t\tvar div = document.createElement('div');",
        "// Line_Reference 7610: \t\t\t\t\tdiv.style.textAlign = 'center';",
        "// Line_Reference 7611: \t\t\t\t\tdiv.style.padding = '10px';",
        "// Line_Reference 7612: \t\t\t\t\tdiv.style.background = Editor.isDarkMode() ? '' : 'whiteSmoke';",
        "// Line_Reference 7613: \t\t\t\t\tdiv.style.borderTop = '1px solid #e0e0e0';",
        "// Line_Reference 7614: \t\t\t\t\tdiv.style.whiteSpace = 'nowrap';",
        "// Line_Reference 7615: ",
        "// Line_Reference 7616: \t\t\t\t\tif (urlParams['sketch'] == '1')",
        "// Line_Reference 7617: \t\t\t\t\t{",
        "// Line_Reference 7618: \t\t\t\t\t\tvar btn = mxUtils.button(mxResources.get('share'), mxUtils.bind(this, function()",
        "// Line_Reference 7619: \t\t\t\t\t\t{",
        "// Line_Reference 7620: \t\t\t\t\t\t\tthis.actions.get('share').funct();",
        "// Line_Reference 7621: \t\t\t\t\t\t}));",
        "// Line_Reference 7622: \t\t\t\t\t\tbtn.className = 'geBtn';",
        "// Line_Reference 7623: \t\t\t\t\t\tdiv.appendChild(btn);",
        "// Line_Reference 7624: ",
        "// Line_Reference 7625: \t\t\t\t\t\tif (this.commentsSupported())",
        "// Line_Reference 7626: \t\t\t\t\t\t{",
        "// Line_Reference 7627: \t\t\t\t\t\t\tbtn = mxUtils.button(mxResources.get('comments'), mxUtils.bind(this, function()",
        "// Line_Reference 7628: \t\t\t\t\t\t\t{",
        "// Line_Reference 7629: \t\t\t\t\t\t\t\tthis.actions.get('comments').funct();",
        "// Line_Reference 7630: \t\t\t\t\t\t\t}));",
        "// Line_Reference 7631: \t\t\t\t\t\t\tbtn.className = 'geBtn';",
        "// Line_Reference 7632: \t\t\t\t\t\t\tdiv.appendChild(btn);",
        "// Line_Reference 7633: \t\t\t\t\t\t\tthis.userPanel.appendChild(div);",
        "// Line_Reference 7634: \t\t\t\t\t\t}",
        "// Line_Reference 7635: ",
        "// Line_Reference 7636: \t\t\t\t\t\tthis.userPanel.appendChild(div);",
        "// Line_Reference 7637: \t\t\t\t\t}",
        "// Line_Reference 7638: \t\t\t\t\telse",
        "// Line_Reference 7639: \t\t\t\t\t{",
        "// Line_Reference 7640: \t\t\t\t\t\tvar btn = mxUtils.button(mxResources.get('close'), mxUtils.bind(this, function()",
        "// Line_Reference 7641: \t\t\t\t\t\t{",
        "// Line_Reference 7642: \t\t\t\t\t\t\tif (!mxEvent.isConsumed(evt) && this.userPanel != null && this.userPanel.parentNode != null)",
        "// Line_Reference 7643: \t\t\t\t\t\t\t{",
        "// Line_Reference 7644: \t\t\t\t\t\t\t\tthis.userPanel.parentNode.removeChild(this.userPanel);",
        "// Line_Reference 7645: \t\t\t\t\t\t\t}",
        "// Line_Reference 7646: \t\t\t\t\t\t}));",
        "// Line_Reference 7647: ",
        "// Line_Reference 7648: \t\t\t\t\t\tbtn.className = 'geBtn';",
        "// Line_Reference 7649: \t\t\t\t\t\tdiv.appendChild(btn);",
        "// Line_Reference 7650: \t\t\t\t\t\tthis.userPanel.appendChild(div);",
        "// Line_Reference 7651: \t\t\t\t\t}",
        "// Line_Reference 7652: ",
        "// Line_Reference 7664: \t\t\t\t\t\t\tmxUtils.write(div, mxResources.get('realtimeCollaboration') + ': ' +",
        "// Line_Reference 7665: \t\t\t\t\t\t\t\t(state == 1 ? mxResources.get('online') :",
        "// Line_Reference 7666: \t\t\t\t\t\t\t\t\t((err != null && err.message != null) ?",
        "// Line_Reference 7667: \t\t\t\t\t\t\t\t\terr.message : mxResources.get('disconnected'))));",
        "// Line_Reference 7668: \t\t\t\t\t\t\tthis.userPanel.appendChild(div);"
    ]
}
