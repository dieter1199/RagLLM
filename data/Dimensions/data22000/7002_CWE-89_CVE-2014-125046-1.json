{
    "cve_id": "CVE-2014-125046",
    "cve_description": "A vulnerability, which was classified as critical, was found in Seiji42 cub-scout-tracker. This affects an unknown part of the file databaseAccessFunctions.js. The manipulation leads to sql injection. The patch is named b4bc1a328b1f59437db159f9d136d9ed15707e31. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217551.",
    "cve_publish_date": "2023-01-06",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Added protection from sql injection and dubug flag",
    "type_of_change": "Modification",
    "filename_of_changes": "databaseAccessFunctions.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "94",
    "number_of_lines_deleted_vulnerable_to_cve": "47",
    "vulnerable_lines": [
        "// Line_Reference 23: function selectAdult(username, connection)",
        "// Line_Reference 25: \tvar strQuery = \"SELECT * FROM adult WHERE username= '\" +connection.escape(username)+\"'\";",
        "// Line_Reference 31: \t\t\t\ttemp= rows[0];",
        "// Line_Reference 32: \t\t\t\ttemp.password=\"\";",
        "// Line_Reference 34: \t\t\t\t{console.log(\"SelectAdult \\n\"+rows[0]+\"\\n\");}",
        "// Line_Reference 35: ",
        "// Line_Reference 36: \t\t\t\treturn temp;",
        "// Line_Reference 41: function validateAdult(username, password, connection)",
        "// Line_Reference 43: \tvar strQuery = \"SELECT * FROM adult WHERE username= '\" +connection.escape(username)+\"'\" +\"AND password= '\"",
        "// Line_Reference 44: \t+ hashPassword(password)+\"'\";",
        "// Line_Reference 52: ",
        "// Line_Reference 54: \t\t\t\t{console.log(\"validateAdult \\n\"+rows[0]+\"\\n\");}",
        "// Line_Reference 55: ",
        "// Line_Reference 61: function insertAdult(firstName, lastName, username, password, packNumber,",
        "// Line_Reference 62: \t\tleaderType, rankType, phoneNumber, connection)",
        "// Line_Reference 64: \tvar temp= selectAdult(username, connection);",
        "// Line_Reference 66: \tif(temp.databaseObject.adult_id<1)",
        "// Line_Reference 67: \t{",
        "// Line_Reference 68: \t\treturn temp;",
        "// Line_Reference 69: \t}",
        "// Line_Reference 70: \tvar strQuery = \"INSERT INTO adult VALUES('\"+firstName+\"', '\"+lastName+\"', '\"+",
        "// Line_Reference 71: \tusername + \"', '\" +hashPassword(password) + \"', '\" + packNumber+\"', '\"+",
        "// Line_Reference 72: \tleaderType +\"', '\"+ rankType+\"', '\"+phoneNumber+ \"', 'NULL')\";",
        "// Line_Reference 77: \t\t\t\ttemp= new Adult(row[0]);",
        "// Line_Reference 79: \t\t\t\t{console.log(\"insertAdult \\n\"+rows[0]+\"\\n\");}",
        "// Line_Reference 80: ",
        "// Line_Reference 81: \t\t\t\treturn addScoutsToParent(temp);",
        "// Line_Reference 97: \tvar strQuery = \"UPDATE adult SET first_name=\"+firstName+\", last_name=\"+lastName+\", username=\"+",
        "// Line_Reference 98: \tusername + \", password=\" +hashPassword(password) + \", pack_number=\" + packNumber+\", leader_type=\"+",
        "// Line_Reference 99: \tleaderType +\", rank_type=\"+ rankType+\", phone_number=\"+phoneNumber+ \"WHERE adult_id=\"+id;",
        "// Line_Reference 107: ",
        "// Line_Reference 115: \tvar strQuery = \"INSERT INTO achievement  VALUES('\"+name+\"', '\" +  description + \"', '\" + categoryID",
        "// Line_Reference 116: \t+\"', '\"+ numElectives+ \"', 'NULL')\";",
        "// Line_Reference 130: \tvar strQuery = \"INSERT INTO category VALUES('\"+name+\"', '\" +  description + \"', '\"",
        "// Line_Reference 131: \t+ rankID+\"', '\"+numAchievments+ \"', 'NULL')\";",
        "// Line_Reference 145: \tvar strQuery = \"INSERT INTO rank  VALUES('\"+name+\"', '\" +  description + \"', 'NULL')\";",
        "// Line_Reference 161: \tvar strQuery = \"INSERT INTO record  VALUES('\"+recordRankType+\"', '\" +",
        "// Line_Reference 162: \tdateDone + \"', '\" +requirementID+\"', '\"+scoutID+\"', 'NULL')\";",
        "// Line_Reference 177: \tvar strQuery = \"INSERT INTO requirement VALUES('\"+name+\"', '\" +  description +",
        "// Line_Reference 178: \t\"', '\" + achievementID+\"', '\"+reqElec+ \"', 'NULL')\";",
        "// Line_Reference 193: \tvar strQuery = \"INSERT INTO scout VALUES('\"+firstName+\"', '\" +lastName+\"', '\"+",
        "// Line_Reference 194: \tbirthDate + \"', '\" + packNumber + \"', '\"+ rankType+\"', '\"+parentID+\", \"+leaderID+\"', 'NULL')\";",
        "// Line_Reference 207: \t\t rankType, parentID, leaderID, scoutID, connection)",
        "// Line_Reference 209: \tvar strQuery = \"UPDATE scout SET first_name=\"+firstName+\", last_name=\"+lastName+\", birth_date=\"+",
        "// Line_Reference 210: \t + \", pack_number=\" + + \", rank_type=\" + packNumber+\", parent_id=\"+",
        "// Line_Reference 211: \tleaderType +\", leader_id=\"+ rankType+\" WHERE scout_id=\"+id;",
        "// Line_Reference 225: \tvar strQuery = \"SELECT * FROM scout WHERE parent_id= '\" +adult.rowID+\"'\";"
    ]
}
