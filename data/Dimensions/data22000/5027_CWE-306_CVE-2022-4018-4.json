{
    "cve_id": "CVE-2022-4018",
    "cve_description": "Missing Authentication for Critical Function in GitHub repository ikus060/rdiffweb prior to 2.5.0a6.",
    "cve_publish_date": "2022-11-16",
    "cwe_id": "CWE-306",
    "cwe_name": "Missing Authentication for Critical Function",
    "cwe_description": "The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.",
    "commit_message": "Define idle and absolute session timeout with agressive default to protect usage on public computer",
    "type_of_change": "Modification",
    "filename_of_changes": "auth_form.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "27",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 50:         return (",
        "// Line_Reference 51:             session.get(SESSION_KEY) is not None",
        "// Line_Reference 52:             and session.get(LOGIN_TIME) is not None",
        "// Line_Reference 53:             and session[LOGIN_TIME] + datetime.timedelta(minutes=session.timeout) > session.now()",
        "// Line_Reference 54:         )",
        "// Line_Reference 75:     def run(self, login_url='/login/', logout_url='/logout', timeout=43200):",
        "// Line_Reference 99:         # If login is persistent, update the cookie max-age/expires",
        "// Line_Reference 100:         if cherrypy.session.get(LOGIN_PERSISTENT, False):",
        "// Line_Reference 101:             cherrypy.session.timeout = timeout",
        "// Line_Reference 102:             cookie = cherrypy.serving.response.cookie",
        "// Line_Reference 103:             cookie['session_id']['max-age'] = timeout * 60",
        "// Line_Reference 104:             cookie['session_id']['expires'] = httputil.HTTPDate(time.time() + timeout * 60)",
        "// Line_Reference 105:         else:",
        "// Line_Reference 106:             session_timeout = cherrypy.request.config.get('tools.sessions.timeout', 60)",
        "// Line_Reference 107:             cherrypy.session.timeout = session_timeout"
    ]
}
