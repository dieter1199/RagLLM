{
    "cve_id": "CVE-2017-12902",
    "cve_description": "The Zephyr parser in tcpdump before 4.9.2 has a buffer over-read in print-zephyr.c, several functions.",
    "cve_publish_date": "2017-09-14",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "CVE-2017-12902/Zephyr: Fix bounds checking.\n\nUse ND_TTEST() rather than comparing against ndo->ndo_snapend ourselves;\nit's easy to get the tests wrong.\n\nCheck for running out of packet data before checking for running out of\ncaptured data, and distinguish between running out of packet data (which\nmight just mean \"no more strings\") and running out of captured data\n(which means \"truncated\").\n\nThis fixes a buffer over-read discovered by Forcepoint's security\nresearchers Otto Airamo & Antti Levom√§ki.\n\nAdd a test using the capture file supplied by the reporter(s).",
    "type_of_change": "Modification",
    "filename_of_changes": "print-zephyr.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "30",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 86: parse_field(netdissect_options *ndo, const char **pptr, int *len)",
        "// Line_Reference 90:     if (*len <= 0 || !pptr || !*pptr)",
        "// Line_Reference 91: \treturn NULL;",
        "// Line_Reference 92:     if (*pptr > (const char *) ndo->ndo_snapend)",
        "// Line_Reference 93: \treturn NULL;",
        "// Line_Reference 94: ",
        "// Line_Reference 96:     while (*pptr <= (const char *) ndo->ndo_snapend && *len >= 0 && **pptr) {",
        "// Line_Reference 102:     if (*len < 0 || *pptr > (const char *) ndo->ndo_snapend)",
        "// Line_Reference 103: \treturn NULL;",
        "// Line_Reference 152: #define PARSE_STRING\t\t\t\t\\",
        "// Line_Reference 153: \ts = parse_field(ndo, &parse, &parselen);\t\\",
        "// Line_Reference 186:     if (lose) {",
        "// Line_Reference 187: \tND_PRINT((ndo, \" [|zephyr] (%d)\", length));",
        "// Line_Reference 188: \treturn;",
        "// Line_Reference 189:     }"
    ]
}
