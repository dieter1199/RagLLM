{
    "cve_id": "CVE-2022-25896",
    "cve_description": "This affects the package passport before 0.6.0. When a user logs in or logs out, the session is regenerated instead of being closed.",
    "cve_publish_date": "2022-07-01",
    "cwe_id": "CWE-384",
    "cwe_name": "Session Fixation",
    "cwe_description": "Authenticating a user, or otherwise establishing a new user session, without invalidating any existing session identifier gives an attacker the opportunity to steal authenticated sessions.",
    "commit_message": "Regenerate session on login.",
    "type_of_change": "Modification",
    "filename_of_changes": "sessionmanager.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 14:   this._serializeUser(user, req, function(err, obj) {",
        "// Line_Reference 18:     // TODO: Error if session isn't available here.",
        "// Line_Reference 19:     if (!req.session) {",
        "// Line_Reference 20:       req.session = {};",
        "// Line_Reference 21:     }",
        "// Line_Reference 22:     if (!req.session[self._key]) {",
        "// Line_Reference 23:       req.session[self._key] = {};",
        "// Line_Reference 24:     }",
        "// Line_Reference 25:     req.session[self._key].user = obj;",
        "// Line_Reference 26:     cb();"
    ]
}
