{
    "cve_id": "CVE-2011-2918",
    "cve_description": "The Performance Events subsystem in the Linux kernel before 3.1 does not properly handle event overflows associated with PERF_COUNT_SW_CPU_CLOCK events, which allows local users to cause a denial of service (system hang) via a crafted application.",
    "cve_publish_date": "2012-05-24",
    "cwe_id": "CWE-400",
    "cwe_name": "Uncontrolled Resource Consumption",
    "cwe_description": "The product does not properly control the allocation and maintenance of a limited resource, thereby enabling an actor to influence the amount of resources consumed, eventually leading to the exhaustion of available resources.",
    "commit_message": "perf: Remove the nmi parameter from the swevent and overflow interface\n\nThe nmi parameter indicated if we could do wakeups from the current\ncontext, if not, we would set some state and self-IPI and let the\nresulting interrupt do the wakeup.\n\nFor the various event classes:\n\n  - hardware: nmi=0; PMI is in fact an NMI or we run irq_work_run from\n    the PMI-tail (ARM etc.)\n  - tracepoint: nmi=0; since tracepoint could be from NMI context.\n  - software: nmi=[0,1]; some, like the schedule thing cannot\n    perform wakeups, and hence need 0.\n\nAs one can see, there is very little nmi=1 usage, and the down-side of\nnot using it is that on some platforms some software events can have a\njiffy delay in wakeup (when arch_irq_work_raise isn't implemented).\n\nThe up-side however is that we can remove the nmi parameter and save a\nbunch of conditionals in fast paths.\n\nSigned-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl>\nCc: Michael Cree <mcree@orcon.net.nz>\nCc: Will Deacon <will.deacon@arm.com>\nCc: Deng-Cheng Zhu <dengcheng.zhu@gmail.com>\nCc: Anton Blanchard <anton@samba.org>\nCc: Eric B Munson <emunson@mgebm.net>\nCc: Heiko Carstens <heiko.carstens@de.ibm.com>\nCc: Paul Mundt <lethal@linux-sh.org>\nCc: David S. Miller <davem@davemloft.net>\nCc: Frederic Weisbecker <fweisbec@gmail.com>\nCc: Jason Wessel <jason.wessel@windriver.com>\nCc: Don Zickus <dzickus@redhat.com>\nLink: http://lkml.kernel.org/n/tip-agjev8eu666tvknpb3iaj0fg@git.kernel.org\nSigned-off-by: Ingo Molnar <mingo@elte.hu>",
    "type_of_change": "Modification",
    "filename_of_changes": "traps_32.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 396: \t\tperf_sw_event(PERF_COUNT_SW_ALIGNMENT_FAULTS, 1, 0,"
    ]
}
