{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "Events.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "83",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 142:                     if (count(X2Model::model($this->associationType)->findAllByPk($this->associationId)) > 0) {",
        "// Line_Reference 145:                             if (isset($action) && (strcasecmp($action->associationType, 'contacts') === 0 || in_array($action->type, array('call', 'note', 'time')))) {",
        "// Line_Reference 146:                                 // Special considerations for publisher-created actions, i.e. call, note, time, and anything associated with a contact",
        "// Line_Reference 155:                             $authorText = empty($authorText) ? Yii::t('app', 'Someone') : $authorText;",
        "// Line_Reference 213:                                 } else {",
        "// Line_Reference 218:                                     '{modelLink}' => X2Model::getModelLink($this->associationId, $this->associationType, $requireAbsoluteUrl),",
        "// Line_Reference 673:                 $criteria->addCondition ('user=:getAccessCriteria_username');",
        "// Line_Reference 675:                 $criteria->addCondition (",
        "// Line_Reference 676:                     'user IN (' .",
        "// Line_Reference 677:                         'SELECT DISTINCT b.username ' .",
        "// Line_Reference 678:                         'FROM x2_group_to_user a JOIN x2_group_to_user b ' .",
        "// Line_Reference 679:                         'ON a.groupId=b.groupId ' .",
        "// Line_Reference 680:                         'WHERE a.username=:getAccessCriteria_username' .",
        "// Line_Reference 681:                     ') OR (user = :getAccessCriteria_username)');",
        "// Line_Reference 683:                 $criteria->addCondition (\"(user=:getAccessCriteria_username OR visibility=1)\");"
    ]
}
