{
    "cve_id": "CVE-2021-43404",
    "cve_description": "An issue was discovered in FusionPBX before 4.5.30. The FAX file name may have risky characters.",
    "cve_publish_date": "2021-11-05",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Change the fax file name to md5 to avoid characters that present a security risk.",
    "type_of_change": "Modification",
    "filename_of_changes": "fax_send.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 354: \t\t\t\t$fax_name = $_files['name'][$index];",
        "// Line_Reference 355: \t\t\t\t$fax_name = preg_replace('/\\\\.[^.\\\\s]{3,4}$/', '', $fax_name);",
        "// Line_Reference 356: \t\t\t\t$fax_name = str_replace(\" \", \"_\", $fax_name);",
        "// Line_Reference 357: ",
        "// Line_Reference 358: \t\t\t\t//lua doesn't seem to like special chars with env:GetHeader",
        "// Line_Reference 359: \t\t\t\t$fax_name = str_replace(\";\", \"_\", $fax_name);",
        "// Line_Reference 360: \t\t\t\t$fax_name = str_replace(\",\", \"_\", $fax_name);",
        "// Line_Reference 361: \t\t\t\t$fax_name = str_replace(\"'\", \"_\", $fax_name);",
        "// Line_Reference 362: \t\t\t\t$fax_name = str_replace(\"!\", \"_\", $fax_name);",
        "// Line_Reference 363: \t\t\t\t$fax_name = str_replace(\"@\", \"_\", $fax_name);",
        "// Line_Reference 364: \t\t\t\t$fax_name = str_replace(\"#\", \"_\", $fax_name);",
        "// Line_Reference 365: \t\t\t\t$fax_name = str_replace(\"$\", \"_\", $fax_name);",
        "// Line_Reference 366: \t\t\t\t$fax_name = str_replace(\"%\", \"_\", $fax_name);",
        "// Line_Reference 367: \t\t\t\t$fax_name = str_replace(\"^\", \"_\", $fax_name);",
        "// Line_Reference 368: \t\t\t\t$fax_name = str_replace(\"`\", \"_\", $fax_name);",
        "// Line_Reference 369: \t\t\t\t$fax_name = str_replace(\"~\", \"_\", $fax_name);",
        "// Line_Reference 370: \t\t\t\t$fax_name = str_replace(\"&\", \"_\", $fax_name);",
        "// Line_Reference 371: \t\t\t\t$fax_name = str_replace(\"(\", \"_\", $fax_name);",
        "// Line_Reference 372: \t\t\t\t$fax_name = str_replace(\")\", \"_\", $fax_name);",
        "// Line_Reference 373: \t\t\t\t$fax_name = str_replace(\"+\", \"_\", $fax_name);",
        "// Line_Reference 374: \t\t\t\t$fax_name = str_replace(\"=\", \"_\", $fax_name);",
        "// Line_Reference 385: \t\t\t\t\t\tevent_socket_mkdir($dir_fax_temp);"
    ]
}
