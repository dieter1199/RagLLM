{
    "cve_id": "CVE-2022-45962",
    "cve_description": "Open Solutions for Education, Inc openSIS Community Edition v8.0 and earlier is vulnerable to SQL Injection via CalendarModal.php.",
    "cve_publish_date": "2023-02-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Version 9.0 release\n\nOlder version shifted to branch: Version_8.0",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "ConfigInc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "42",
    "vulnerable_lines": [
        "// Line_Reference 28: include('RedirectRootInc.php');",
        "// Line_Reference 30: if(CONFIG_INC==0)",
        "// Line_Reference 31: {",
        "// Line_Reference 35:     $IgnoreFiles = Array('.DS_Store','CVS','.svn');",
        "// Line_Reference 36: ",
        "// Line_Reference 37:     $openSISPath = dirname(__FILE__).'/';",
        "// Line_Reference 38: ",
        "// Line_Reference 39:     if (file_exists($openSISPath.\"Data.php\"))",
        "// Line_Reference 40:     {",
        "// Line_Reference 41:         include($openSISPath.\"Data.php\");",
        "// Line_Reference 46:   #  Set Build Date and Version Number here.",
        "// Line_Reference 47: ",
        "// Line_Reference 48:   \t$b_date_sql = \"select value from app where name='date'\";",
        "// Line_Reference 49: \t$b_date_res = DBQuery($b_date_sql);",
        "// Line_Reference 50: \t$b_date_row = DBGet($b_date_res);",
        "// Line_Reference 51: ",
        "// Line_Reference 52:   \t$version_sql = \"select value from app where name='version'\";",
        "// Line_Reference 53: \t$version_res = DBQuery($version_sql);",
        "// Line_Reference 54: \t$version_row = DBGet($version_res);",
        "// Line_Reference 55: $openSISVersion = $version_row[1]['VALUE'];",
        "// Line_Reference 57: \t    $htmldocPath = \"\";",
        "// Line_Reference 60:     $htmldocAssetsPath = '';\t\t// way htmldoc accesses the assets/ directory, possibly different than user - empty string means no translation",
        "// Line_Reference 61: //    $StudentPicturesPath = 'assets/studentphotos/';",
        "// Line_Reference 62: //    $UserPicturesPath = 'assets/userphotos/';",
        "// Line_Reference 64:     $openSISAdmins = '1';\t\t\t// can be list such as '1,23,50' - note, these should be id's in the DefaultSyear, otherwise they can't login anyway",
        "// Line_Reference 66:     $msgFlag='';",
        "// Line_Reference 69:         'schoolsetup'=>true,",
        "// Line_Reference 70:         'students'=>true,",
        "// Line_Reference 71:         'users'=>true,",
        "// Line_Reference 72:         'scheduling'=>true,",
        "// Line_Reference 73:         'grades'=>true,",
        "// Line_Reference 74:         'attendance'=>true,",
        "// Line_Reference 75:         'eligibility'=>true,",
        "// Line_Reference 76:         'Discipline'=>true,",
        "// Line_Reference 77:         'Billing' =>true,",
        "// Line_Reference 78:         'EasyCom' =>true,",
        "// Line_Reference 79:         'Library' =>true,",
        "// Line_Reference 80:         'messaging'=>true,",
        "// Line_Reference 81:         'tools'=>true,",
        "// Line_Reference 85:     if(!isset($SessionStart))",
        "// Line_Reference 86:     $SessionStart = 1;",
        "// Line_Reference 88: ?>"
    ]
}
