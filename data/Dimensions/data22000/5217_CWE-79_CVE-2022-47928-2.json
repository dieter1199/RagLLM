{
    "cve_id": "CVE-2022-47928",
    "cve_description": "In MISP before 2.4.167, there is XSS in the template file uploads in app/View/Templates/upload_file.ctp.",
    "cve_publish_date": "2022-12-22",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fix: [security] XSS in the template file uploads\n\n- as reported by Dawid Czarnecki from Zigrin Security",
    "type_of_change": "Modification",
    "filename_of_changes": "upload_file.ctp",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 9:     } else {",
        "// Line_Reference 21: <span id=\"fileUploadButton_<?php echo $element_id; ?>\"  role=\"button\" tabindex=\"0\" aria-label=\"<?php echo $buttonText; ?>\" title=\"<?php echo $buttonText; ?>\" class=\"btn btn-primary\" onClick=\"templateFileUploadTriggerBrowse('<?php echo $element_id; ?>');\"><?php echo $buttonText; ?></span>",
        "// Line_Reference 26:     templateFileHiddenAdd(fileArray, '<?php echo $element_id; ?>', '<?php echo $batch; ?>');",
        "// Line_Reference 27:     showMessage('<?php echo $upload_error ? 'fail' : 'success'; ?>', '<?php echo $result; ?>', 'iframe');"
    ]
}
