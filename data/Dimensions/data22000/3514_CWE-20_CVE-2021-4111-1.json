{
    "cve_id": "CVE-2021-4111",
    "cve_description": "yetiforcecrm is vulnerable to Business Logic Errors",
    "cve_publish_date": "2021-12-15",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Improved validation for multi-currency fields",
    "type_of_change": "Modification",
    "filename_of_changes": "CurrenciesModal.tpl",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 12: \t\t\t\t\t\t\ttitle=\"{\\App\\Language::translate('LBL_CLOSE')}\">",
        "// Line_Reference 37: \t\t\t\t\t\t\t\t\t\t\t\t   id=\"cur_{$CURRENCY_ID}_check\"",
        "// Line_Reference 38: \t\t\t\t\t\t\t\t\t\t\t\t   class=\"small float-right js-enable-currency\"",
        "// Line_Reference 39: \t\t\t\t\t\t\t\t\t\t\t\t   data-js=\"change\">",
        "// Line_Reference 46: \t\t\t\t\t\t\t\t\t\t\t   size=\"10\" id=\"{$ITEM['name']}\"",
        "// Line_Reference 47: \t\t\t\t\t\t\t\t\t\t\t   class=\"col-md-9 js-format-numer js-converted-price form-control\"",
        "// Line_Reference 48: \t\t\t\t\t\t\t\t\t\t\t   data-validation-engine=\"validate[funcCall[Vtiger_Currency_Validator_Js.invokeValidation]]\"",
        "// Line_Reference 49: \t\t\t\t\t\t\t\t\t\t\t   data-fieldinfo=\"{\\App\\Purifier::encodeHtml(\\App\\Json::encode($ITEM.fieldInfo))}\"",
        "// Line_Reference 50: \t\t\t\t\t\t\t\t\t\t\t   data-js=\"value\" disabled=\"disabled\"/>",
        "// Line_Reference 55: \t\t\t\t\t\t\t\t\t\t<input name=\"currencies[{$CURRENCY_ID}]['rate']\"",
        "// Line_Reference 56: \t\t\t\t\t\t\t\t\t\t\t   value=\"{App\\Fields\\Double::formatToDisplay($ITEM['conversionRate'], false)}\"",
        "// Line_Reference 57: \t\t\t\t\t\t\t\t\t\t\t   class=\"col-md-9 js-conversion-rate form-control\" type=\"text\" size=\"10\"",
        "// Line_Reference 58: \t\t\t\t\t\t\t\t\t\t\t   readonly=\"readonly\" disabled=\"disabled\">",
        "// Line_Reference 64: \t\t\t\t\t\t\t\t\t\t\t\tid=\"cur_reset{$CURRENCY_ID}\"",
        "// Line_Reference 65: \t\t\t\t\t\t\t\t\t\t\t\tvalue=\"{\\App\\Language::translate('LBL_RESET',$MODULE_NAME)}\"",
        "// Line_Reference 66: \t\t\t\t\t\t\t\t\t\t\t\tdata-js=\"click\">",
        "// Line_Reference 75: \t\t\t\t\t\t\t\t\t\t\t   class=\"js-base-currency\" type=\"radio\" disabled=\"disabled\"",
        "// Line_Reference 76: \t\t\t\t\t\t\t\t\t\t\t   title=\"{\\App\\Language::translate('LBL_BASE_CURRENCY')}\"",
        "// Line_Reference 77: \t\t\t\t\t\t\t\t\t\t\t   data-js=\"checked\"/>"
    ]
}
