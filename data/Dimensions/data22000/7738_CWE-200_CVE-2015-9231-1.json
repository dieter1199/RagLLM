{
    "cve_id": "CVE-2015-9231",
    "cve_description": "iTerm2 3.x before 3.1.1 allows remote attackers to discover passwords by reading DNS queries. A new (default) feature was added to iTerm2 version 3.0.0 (and unreleased 2.9.x versions such as 2.9.20150717) that resulted in a potential information disclosure. In an attempt to see whether the text under the cursor (or selected text) was a URL, the text would be sent as an unencrypted DNS query. This has the potential to result in passwords and other sensitive information being sent in cleartext without the user being aware.",
    "cve_publish_date": "2017-09-20",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Fist swipe at removing DNS code",
    "type_of_change": "Modification",
    "filename_of_changes": "PTYTextView.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "64",
    "vulnerable_lines": [
        "// Line_Reference 3: #import \"AsyncHostLookupController.h\"",
        "// Line_Reference 99: // Notifications posted when hostname lookups finish. Notifications are used to",
        "// Line_Reference 100: // avoid dangling references.",
        "// Line_Reference 101: static NSString *const kHostnameLookupFailed = @\"kHostnameLookupFailed\";",
        "// Line_Reference 102: static NSString *const kHostnameLookupSucceeded = @\"kHostnameLookupSucceeded\";",
        "// Line_Reference 122: // Set the hostname this view is currently waiting for AsyncHostLookupController to finish looking",
        "// Line_Reference 123: // up.",
        "// Line_Reference 124: @property(nonatomic, copy) NSString *currentUnderlineHostname;",
        "// Line_Reference 312:         [[NSNotificationCenter defaultCenter] addObserver:self",
        "// Line_Reference 313:                                                  selector:@selector(hostnameLookupFailed:)",
        "// Line_Reference 314:                                                      name:kHostnameLookupFailed",
        "// Line_Reference 315:                                                    object:nil];",
        "// Line_Reference 316:         [[NSNotificationCenter defaultCenter] addObserver:self",
        "// Line_Reference 317:                                                  selector:@selector(hostnameLookupSucceeded:)",
        "// Line_Reference 318:                                                      name:kHostnameLookupSucceeded",
        "// Line_Reference 319:                                                    object:nil];",
        "// Line_Reference 403:     if (self.currentUnderlineHostname) {",
        "// Line_Reference 404:         [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];",
        "// Line_Reference 405:     }",
        "// Line_Reference 406:     [_currentUnderlineHostname release];",
        "// Line_Reference 1118:     _drawingHelper.haveUnderlinedHostname = (self.currentUnderlineHostname != nil);",
        "// Line_Reference 1775:     if (self.currentUnderlineHostname) {",
        "// Line_Reference 1776:         [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];",
        "// Line_Reference 1777:     }",
        "// Line_Reference 1778:     self.currentUnderlineHostname = nil;",
        "// Line_Reference 1812:                     if (![url.host isEqualToString:self.currentUnderlineHostname]) {",
        "// Line_Reference 1813:                         if (self.currentUnderlineHostname) {",
        "// Line_Reference 1814:                             [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];",
        "// Line_Reference 1815:                         }",
        "// Line_Reference 1816:                         if (url && url.host) {",
        "// Line_Reference 1817:                             self.currentUnderlineHostname = url.host;",
        "// Line_Reference 1818:                             [[AsyncHostLookupController sharedInstance] getAddressForHost:url.host",
        "// Line_Reference 1819:                                                                                completion:^(BOOL ok, NSString *hostname) {",
        "// Line_Reference 1820:                                                                                    if (!ok) {",
        "// Line_Reference 1821:                                                                                        [[NSNotificationCenter defaultCenter] postNotificationName:kHostnameLookupFailed",
        "// Line_Reference 1822:                                                                                                                                            object:hostname];",
        "// Line_Reference 1823:                                                                                    } else {",
        "// Line_Reference 1824:                                                                                        [[NSNotificationCenter defaultCenter] postNotificationName:kHostnameLookupSucceeded",
        "// Line_Reference 1825:                                                                                                                                            object:hostname];",
        "// Line_Reference 1826:                                                                                    }",
        "// Line_Reference 1827:                                                                                }];",
        "// Line_Reference 1828:                         }",
        "// Line_Reference 1830:                 } else {",
        "// Line_Reference 1831:                     if (self.currentUnderlineHostname) {",
        "// Line_Reference 1832:                         [[AsyncHostLookupController sharedInstance] cancelRequestForHostname:self.currentUnderlineHostname];",
        "// Line_Reference 1833:                     }",
        "// Line_Reference 1834:                     self.currentUnderlineHostname = nil;",
        "// Line_Reference 6191: - (void)hostnameLookupFailed:(NSNotification *)notification {",
        "// Line_Reference 6192:     if ([[notification object] isEqualToString:self.currentUnderlineHostname]) {",
        "// Line_Reference 6193:         self.currentUnderlineHostname = nil;",
        "// Line_Reference 6194:         [self removeUnderline];",
        "// Line_Reference 6195:         _drawingHelper.underlinedRange =",
        "// Line_Reference 6196:             VT100GridAbsWindowedRangeMake(VT100GridAbsCoordRangeMake(-1, -1, -1, -1), 0, 0);",
        "// Line_Reference 6197:         [self setNeedsDisplay:YES];",
        "// Line_Reference 6198:     }",
        "// Line_Reference 6199: }",
        "// Line_Reference 6200: ",
        "// Line_Reference 6201: - (void)hostnameLookupSucceeded:(NSNotification *)notification {",
        "// Line_Reference 6202:     if ([[notification object] isEqualToString:self.currentUnderlineHostname]) {",
        "// Line_Reference 6203:         self.currentUnderlineHostname = nil;",
        "// Line_Reference 6204:         [self setNeedsDisplay:YES];",
        "// Line_Reference 6205:     }",
        "// Line_Reference 6206: }",
        "// Line_Reference 6207: "
    ]
}
