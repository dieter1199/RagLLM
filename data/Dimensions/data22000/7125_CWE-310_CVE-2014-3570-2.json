{
    "cve_id": "CVE-2014-3570",
    "cve_description": "The BN_sqr implementation in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k does not properly calculate the square of a BIGNUM value, which might make it easier for remote attackers to defeat cryptographic protection mechanisms via unspecified vectors, related to crypto/bn/asm/mips.pl, crypto/bn/asm/x86_64-gcc.c, and crypto/bn/bn_asm.c.",
    "cve_publish_date": "2015-01-09",
    "cwe_id": "CWE-310",
    "cwe_name": "Cryptographic Issues",
    "cwe_description": "Weaknesses in this category are related to the design and implementation of data confidentiality and integrity. Frequently these deal with the use of encoding techniques, encryption libraries, and hashing algorithms. The weaknesses in this category could lead to a degradation of the quality data if they are not addressed.",
    "commit_message": "Fix for CVE-2014-3570 (with minor bn_asm.c revamp).\n\nReviewed-by: Emilia Kasper <emilia@openssl.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "x86_64-gcc.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "48",
    "number_of_lines_deleted_vulnerable_to_cve": "53",
    "vulnerable_lines": [
        "// Line_Reference 281: #define mul_add_c(a,b,c0,c1,c2) {\t\\",
        "// Line_Reference 282: \tBN_ULONG ta=(a),tb=(b);\t\t\\",
        "// Line_Reference 283: \tt1 = ta * tb;\t\t\t\\",
        "// Line_Reference 284: \tt2 = BN_UMULT_HIGH(ta,tb);\t\\",
        "// Line_Reference 285: \tc0 += t1; t2 += (c0<t1)?1:0;\t\\",
        "// Line_Reference 286: \tc1 += t2; c2 += (c1<t2)?1:0;\t\\",
        "// Line_Reference 287: \t}",
        "// Line_Reference 288: ",
        "// Line_Reference 289: #define mul_add_c2(a,b,c0,c1,c2) {\t\\",
        "// Line_Reference 290: \tBN_ULONG ta=(a),tb=(b),t0;\t\\",
        "// Line_Reference 291: \tt1 = BN_UMULT_HIGH(ta,tb);\t\\",
        "// Line_Reference 292: \tt0 = ta * tb;\t\t\t\\",
        "// Line_Reference 293: \tt2 = t1+t1; c2 += (t2<t1)?1:0;\t\\",
        "// Line_Reference 294: \tt1 = t0+t0; t2 += (t1<t0)?1:0;\t\\",
        "// Line_Reference 295: \tc0 += t1; t2 += (c0<t1)?1:0;\t\\",
        "// Line_Reference 296: \tc1 += t2; c2 += (c1<t2)?1:0;\t\\",
        "// Line_Reference 297: \t}",
        "// Line_Reference 304: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 305: \t\t: \"+r\"(c0),\"+d\"(t2)\t\\",
        "// Line_Reference 306: \t\t: \"a\"(t1),\"g\"(0)\t\\",
        "// Line_Reference 307: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 308: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 309: \t\t: \"+r\"(c1),\"+r\"(c2)\t\\",
        "// Line_Reference 310: \t\t: \"d\"(t2),\"g\"(0)\t\\",
        "// Line_Reference 311: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 319: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 320: \t\t: \"+r\"(c0),\"+d\"(t2)\t\\",
        "// Line_Reference 321: \t\t: \"a\"(t1),\"g\"(0)\t\\",
        "// Line_Reference 322: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 323: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 324: \t\t: \"+r\"(c1),\"+r\"(c2)\t\\",
        "// Line_Reference 325: \t\t: \"d\"(t2),\"g\"(0)\t\\",
        "// Line_Reference 326: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 334: \tasm (\"addq %0,%0; adcq %2,%1\"\t\\",
        "// Line_Reference 335: \t\t: \"+d\"(t2),\"+r\"(c2)\t\\",
        "// Line_Reference 336: \t\t: \"g\"(0)\t\t\\",
        "// Line_Reference 337: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 338: \tasm (\"addq %0,%0; adcq %2,%1\"\t\\",
        "// Line_Reference 339: \t\t: \"+a\"(t1),\"+d\"(t2)\t\\",
        "// Line_Reference 340: \t\t: \"g\"(0)\t\t\\",
        "// Line_Reference 341: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 342: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 343: \t\t: \"+r\"(c0),\"+d\"(t2)\t\\",
        "// Line_Reference 344: \t\t: \"a\"(t1),\"g\"(0)\t\\",
        "// Line_Reference 345: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 346: \tasm (\"addq %2,%0; adcq %3,%1\"\t\\",
        "// Line_Reference 347: \t\t: \"+r\"(c1),\"+r\"(c2)\t\\",
        "// Line_Reference 348: \t\t: \"d\"(t2),\"g\"(0)\t\\",
        "// Line_Reference 349: \t\t: \"cc\");\t\t\\",
        "// Line_Reference 358: \tBN_ULONG t1,t2;",
        "// Line_Reference 462: \tBN_ULONG t1,t2;",
        "// Line_Reference 502: \tBN_ULONG t1,t2;",
        "// Line_Reference 578: \tBN_ULONG t1,t2;"
    ]
}
