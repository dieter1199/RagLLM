{
    "cve_id": "CVE-2022-3023",
    "cve_description": "Use of Externally-Controlled Format String in GitHub repository pingcap/tidb prior to 6.4.0, 6.1.3.",
    "cve_publish_date": "2022-11-04",
    "cwe_id": "CWE-134",
    "cwe_name": "Use of Externally-Controlled Format String",
    "cwe_description": "The product uses a function that accepts a format string as an argument, but the format string originates from an external source.",
    "commit_message": "*: don't use DSN to avoid some security problems (#38342)",
    "type_of_change": "Modification",
    "filename_of_changes": "sql.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 13: \t\"net/url\"",
        "// Line_Reference 837: func resetDBWithSessionParams(tctx *tcontext.Context, db *sql.DB, dsn string, params map[string]interface{}) (*sql.DB, error) {",
        "// Line_Reference 874: \t\tdsn += fmt.Sprintf(\"&%s=%s\", k, url.QueryEscape(s))",
        "// Line_Reference 878: \tnewDB, err := sql.Open(\"mysql\", dsn)",
        "// Line_Reference 879: \tif err == nil {",
        "// Line_Reference 880: \t\t// ping to make sure all session parameters are set correctly",
        "// Line_Reference 881: \t\terr = newDB.PingContext(tctx)",
        "// Line_Reference 882: \t\tif err != nil {",
        "// Line_Reference 883: \t\t\tnewDB.Close()",
        "// Line_Reference 884: \t\t}",
        "// Line_Reference 886: \treturn newDB, errors.Trace(err)"
    ]
}
