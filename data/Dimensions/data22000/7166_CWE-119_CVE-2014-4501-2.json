{
    "cve_id": "CVE-2014-4501",
    "cve_description": "Multiple stack-based buffer overflows in sgminer before 4.2.2, cgminer before 4.3.5, and BFGMiner before 3.3.0 allow remote pool servers to have unspecified impact via a long URL in a client.reconnect stratum message to the (1) extract_sockaddr or (2) parse_reconnect functions in util.c.",
    "cve_publish_date": "2014-07-23",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Do some random sanity checking for stratum message parsing",
    "type_of_change": "Modification",
    "filename_of_changes": "util.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "41",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 2:  * Copyright 2011-2013 Con Kolivas",
        "// Line_Reference 1378: \tsprintf(url_address, \"%.*s\", url_len, url_begin);",
        "// Line_Reference 1688: \tif (!job_id || !prev_hash || !coinbase1 || !coinbase2 || !bbversion || !nbit || !ntime) {",
        "// Line_Reference 1690: \t\tif (job_id)",
        "// Line_Reference 1691: \t\t\tfree(job_id);",
        "// Line_Reference 1692: \t\tif (coinbase1)",
        "// Line_Reference 1693: \t\t\tfree(coinbase1);",
        "// Line_Reference 1694: \t\tif (coinbase2)",
        "// Line_Reference 1695: \t\t\tfree(coinbase2);",
        "// Line_Reference 1883: \tsprintf(address, \"%s:%s\", url, port);",
        "// Line_Reference 2554: \tif (!nonce1) {",
        "// Line_Reference 2555: \t\tapplog(LOG_INFO, \"Failed to get nonce1 in initiate_stratum\");",
        "// Line_Reference 2560: \tif (!n2size) {",
        "// Line_Reference 2561: \t\tapplog(LOG_INFO, \"Failed to get n2size in initiate_stratum\");"
    ]
}
