{
    "cve_id": "CVE-2017-5546",
    "cve_description": "The freelist-randomization feature in mm/slab.c in the Linux kernel 4.8.x and 4.9.x before 4.9.5 allows local users to cause a denial of service (duplicate freelist entries and system crash) or possibly have unspecified other impact in opportunistic circumstances by leveraging the selection of a large value for a random number.",
    "cve_publish_date": "2017-02-06",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "mm/slab.c: fix SLAB freelist randomization duplicate entries\n\nThis patch fixes a bug in the freelist randomization code.  When a high\nrandom number is used, the freelist will contain duplicate entries.  It\nwill result in different allocations sharing the same chunk.\n\nIt will result in odd behaviours and crashes.  It should be uncommon but\nit depends on the machines.  We saw it happening more often on some\nmachines (every few hours of running tests).\n\nFixes: c7ce4f60ac19 (\"mm: SLAB freelist randomization\")\nLink: http://lkml.kernel.org/r/20170103181908.143178-1-thgarnie@google.com\nSigned-off-by: John Sperbeck <jsperbeck@google.com>\nSigned-off-by: Thomas Garnier <thgarnie@google.com>\nCc: Christoph Lameter <cl@linux.com>\nCc: Pekka Enberg <penberg@kernel.org>\nCc: David Rientjes <rientjes@google.com>\nCc: Joonsoo Kim <iamjoonsoo.kim@lge.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "slab.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 2460: \t\tunsigned int rand;",
        "// Line_Reference 2486: \t\tstate->pos = 0;",
        "// Line_Reference 2487: \t\tstate->rand = rand;",
        "// Line_Reference 2496: \treturn (state->list[state->pos++] + state->rand) % state->count;"
    ]
}
