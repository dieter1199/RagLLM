{
    "cve_id": "CVE-2017-18184",
    "cve_description": "An issue was discovered in QPDF before 7.0.0. There is a stack-based out-of-bounds read in the function iterate_rc4 in QPDF_encryption.cc.",
    "cve_publish_date": "2018-02-13",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Pad keys to avoid memory errors (fixes #147)",
    "type_of_change": "Modification",
    "filename_of_changes": "QPDF_encryption.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "14",
    "vulnerable_lines": [
        "// Line_Reference 594:     iterate_rc4(O_data, key_bytes, key, data.getLengthBytes(),",
        "// Line_Reference 921:         if ((O.length() < OU_key_bytes_V5) ||",
        "// Line_Reference 922:             (U.length() < OU_key_bytes_V5) ||",
        "// Line_Reference 923:             (OE.length() < OUE_key_bytes_V5) ||",
        "// Line_Reference 924:             (UE.length() < OUE_key_bytes_V5) ||",
        "// Line_Reference 925:             (Perms.length() < Perms_key_bytes_V5))",
        "// Line_Reference 926:         {",
        "// Line_Reference 927:             throw QPDFExc(qpdf_e_damaged_pdf, this->m->file->getName(),",
        "// Line_Reference 928:                           \"encryption dictionary\",",
        "// Line_Reference 929:                           this->m->file->getLastOffset(),",
        "// Line_Reference 930:                           \"incorrect length for some of\"",
        "// Line_Reference 931:                           \" /O, /U, /OE, /UE, or /Perms in\"",
        "// Line_Reference 932:                           \" encryption dictionary\");",
        "// Line_Reference 933:         }"
    ]
}
