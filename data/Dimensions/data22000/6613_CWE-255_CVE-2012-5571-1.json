{
    "cve_id": "CVE-2012-5571",
    "cve_description": "OpenStack Keystone Essex (2012.1) and Folsom (2012.2) does not properly handle EC2 tokens when the user role has been removed from a tenant, which allows remote authenticated users to bypass intended authorization restrictions by leveraging a token for the removed user role.",
    "cve_publish_date": "2012-12-18",
    "cwe_id": "CWE-255",
    "cwe_name": "Credentials Management Errors",
    "cwe_description": "Weaknesses in this category are related to the management of credentials.",
    "commit_message": "Ensures User is member of tenant in ec2 validation\n\nIt is possible that a user is no longer a member of a tenant when\nthey attempt to use an ec2 token. This checks to make sure that\nthe user still has at least one valid role in the tenant before\nauthenticating them. This should automatically work for the s3\nversion as well since it is a subclass.\n\nFixes bug 1064914\n\nChange-Id: Ieb237bae936a7b00ce7ba4d4c59aec6c7a69ec21",
    "type_of_change": "Modification",
    "filename_of_changes": "core.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 183:         # TODO(termie): optimize this call at some point and put it into the",
        "// Line_Reference 184:         #               the return for metadata",
        "// Line_Reference 185:         # fill out the roles in the metadata",
        "// Line_Reference 186:         roles_ref = []",
        "// Line_Reference 187:         for role_id in metadata_ref.get('roles', []):",
        "// Line_Reference 188:             roles_ref.append(self.identity_api.get_role(context, role_id))",
        "// Line_Reference 189: "
    ]
}
