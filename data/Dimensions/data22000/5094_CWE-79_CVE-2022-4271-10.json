{
    "cve_id": "CVE-2022-4271",
    "cve_description": "Cross-site Scripting (XSS) - Reflected in GitHub repository osticket/osticket prior to 1.16.4.",
    "cve_publish_date": "2022-12-02",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "security: Username XSS\n\nThis mitigates a vulnerability reported by legoclones on\n[huntr.dev](https://huntr.dev/) where XSS can be stored/executed via a\nUser's `username`. If an Agent is redirected to the User Lookup AJAX\nresponse directly it will execute the stored XSS. This adds\n`Format::sanitize()` to the `username` before saving to the database so any\npotential XSS is sanitized. Additionally, this adds `Format::htmlchars()` to\nthe `username` before displaying in the UI to help prevent code execution.",
    "type_of_change": "Modification",
    "filename_of_changes": "user-register.tmpl.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 71:                     <input type=\"text\" size=\"35\" name=\"username\" value=\"<?php echo $info['username'] ?: $user->getEmail(); ?>\">",
        "// Line_Reference 72:                     &nbsp;<span class=\"error\">&nbsp;<?php echo $errors['username']; ?></span>"
    ]
}
