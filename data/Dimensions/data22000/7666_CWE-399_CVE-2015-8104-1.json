{
    "cve_id": "CVE-2015-8104",
    "cve_description": "The KVM subsystem in the Linux kernel through 4.2.6, and Xen 4.3.x through 4.6.x, allows guest OS users to cause a denial of service (host OS panic or hang) by triggering many #DB (aka Debug) exceptions, related to svm.c.",
    "cve_publish_date": "2015-11-16",
    "cwe_id": "CWE-399",
    "cwe_name": "Resource Management Errors",
    "cwe_description": "Weaknesses in this category are related to improper management of system resources.",
    "commit_message": "KVM: svm: unconditionally intercept #DB\n\nThis is needed to avoid the possibility that the guest triggers\nan infinite stream of #DB exceptions (CVE-2015-8104).\n\nVMX is not affected: because it does not save DR6 in the VMCS,\nit already intercepts #DB unconditionally.\n\nReported-by: Jan Beulich <jbeulich@suse.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "svm.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 1557: static void update_db_bp_intercept(struct kvm_vcpu *vcpu)",
        "// Line_Reference 1561: \tclr_exception_intercept(svm, DB_VECTOR);",
        "// Line_Reference 1564: \tif (svm->nmi_singlestep)",
        "// Line_Reference 1565: \t\tset_exception_intercept(svm, DB_VECTOR);",
        "// Line_Reference 1566: ",
        "// Line_Reference 1568: \t\tif (vcpu->guest_debug &",
        "// Line_Reference 1569: \t\t    (KVM_GUESTDBG_SINGLESTEP | KVM_GUESTDBG_USE_HW_BP))",
        "// Line_Reference 1570: \t\t\tset_exception_intercept(svm, DB_VECTOR);",
        "// Line_Reference 1676: \t\tupdate_db_bp_intercept(&svm->vcpu);",
        "// Line_Reference 3664: \tupdate_db_bp_intercept(vcpu);",
        "// Line_Reference 4290: \t.update_db_bp_intercept = update_db_bp_intercept,"
    ]
}
