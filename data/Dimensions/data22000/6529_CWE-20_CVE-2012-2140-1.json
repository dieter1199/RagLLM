{
    "cve_id": "CVE-2012-2140",
    "cve_description": "The Mail gem before 2.4.3 for Ruby allows remote attackers to execute arbitrary commands via shell metacharacters in a (1) sendmail or (2) exim delivery.",
    "cve_publish_date": "2012-07-18",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Fix security vulnerability allowing command line exploit when using exim or sendmail from the command line",
    "type_of_change": "Modification",
    "filename_of_changes": "exim.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "38",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 5:     def deliver!(mail)",
        "// Line_Reference 6:       envelope_from = mail.return_path || mail.sender || mail.from_addrs.first",
        "// Line_Reference 7:       return_path = \"-f \\\"#{envelope_from.to_s.shellescape}\\\"\" if envelope_from",
        "// Line_Reference 8:       arguments = [settings[:arguments], return_path].compact.join(\" \")",
        "// Line_Reference 9:       self.class.call(settings[:location], arguments, mail)"
    ]
}
