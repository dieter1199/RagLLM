{
    "cve_id": "CVE-2015-3935",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 allow remote attackers to inject arbitrary web script or HTML via the Business Search (search_nom) field to (1) htdocs/societe/societe.php or (2) htdocs/societe/admin/societe.php.",
    "cve_publish_date": "2015-06-10",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Properly escape untrusted data to prevent HTML injection.\n\nFirst pass for #2857",
    "type_of_change": "Modification",
    "filename_of_changes": "list.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 6:  * Copyright (C) 2013      RaphaÃ«l Doursenaud   <rdoursenaud@gpcsolutions.fr>",
        "// Line_Reference 154: if ($search_categ > 0)   $sql.= \" AND cs.fk_categorie = \".$search_categ;",
        "// Line_Reference 248:     $param ='&begin='.urlencode($begin).'&view='.urlencode($view).'&userid='.urlencode($userid).'&contactname='.urlencode($sall);",
        "// Line_Reference 249:     $param.='&type='.urlencode($type).'&view='.urlencode($view).'&search_lastname='.urlencode($search_lastname).'&search_firstname='.urlencode($search_firstname).'&search_societe='.urlencode($search_societe).'&search_email='.urlencode($search_email);",
        "// Line_Reference 250:     if (!empty($search_categ)) $param.='&search_categ='.$search_categ;",
        "// Line_Reference 251:     if ($search_status != '') $param.='&amp;search_status='.$search_status;",
        "// Line_Reference 252:     if ($search_priv == '0' || $search_priv == '1') $param.=\"&search_priv=\".urlencode($search_priv);",
        "// Line_Reference 261:     print '<input type=\"hidden\" name=\"view\" value=\"'.$view.'\">';",
        "// Line_Reference 280:         print $langs->trans(\"Filter\").\" (\".$langs->trans(\"Lastname\").\", \".$langs->trans(\"Firstname\").\" \".$langs->trans(\"or\").\" \".$langs->trans(\"EMail\").\"): \".$sall;",
        "// Line_Reference 305:     print '<input class=\"flat\" type=\"text\" name=\"search_lastname\" size=\"9\" value=\"'.$search_lastname.'\">';",
        "// Line_Reference 308:     print '<input class=\"flat\" type=\"text\" name=\"search_firstname\" size=\"9\" value=\"'.$search_firstname.'\">';",
        "// Line_Reference 311:     print '<input class=\"flat\" type=\"text\" name=\"search_poste\" size=\"9\" value=\"'.$search_poste.'\">';",
        "// Line_Reference 316:         print '<input class=\"flat\" type=\"text\" name=\"search_societe\" size=\"9\" value=\"'.$search_societe.'\">';",
        "// Line_Reference 320:     print '<input class=\"flat\" type=\"text\" name=\"search_phonepro\" size=\"8\" value=\"'.$search_phonepro.'\">';",
        "// Line_Reference 323:     print '<input class=\"flat\" type=\"text\" name=\"search_phonemob\" size=\"8\" value=\"'.$search_phonemob.'\">';",
        "// Line_Reference 326:     print '<input class=\"flat\" type=\"text\" name=\"search_fax\" size=\"8\" value=\"'.$search_fax.'\">';",
        "// Line_Reference 329:     print '<input class=\"flat\" type=\"text\" name=\"search_email\" size=\"8\" value=\"'.$search_email.'\">';",
        "// Line_Reference 334:         print '<input class=\"flat\" type=\"text\" name=\"search_skype\" size=\"8\" value=\"'.$search_skype.'\">';"
    ]
}
