{
    "cve_id": "CVE-2015-5074",
    "cve_description": "Incomplete blacklist vulnerability in the FileUploadsFilter class in protected/components/filters/FileUploadsFilter.php in X2Engine X2CRM before 5.0.9 allows remote authenticated users to execute arbitrary PHP code by uploading a file with a .pht extension.",
    "cve_publish_date": "2015-09-29",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Release v5.0.9; see CHANGELOG for details.",
    "type_of_change": "Modification",
    "filename_of_changes": "X2Model.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "20",
    "vulnerable_lines": [
        "// Line_Reference 388:                 if ($modelName = X2Model::getModelName($module->name))",
        "// Line_Reference 390:                 else // Custom module most likely",
        "// Line_Reference 391:                     $modelNames[ucfirst($module->name)] = self::getModelTitle($modelName);",
        "// Line_Reference 424:                 else // Custom module most likely",
        "// Line_Reference 479:     public function getDisplayName ($plural=true) {",
        "// Line_Reference 1394:             return array_combine($modelTypes, array_map(function($term) {",
        "// Line_Reference 1395:                 return Yii::t('app', X2Model::getModelTitle($term));",
        "// Line_Reference 1802:                             'model' => $model, //Model object",
        "// Line_Reference 1803:                             'attribute' => $fieldName, //attribute name",
        "// Line_Reference 1804:                             'mode' => 'date', //use \"time\",\"date\" or \"datetime\" (default)",
        "// Line_Reference 1805:                             'options' => array(// jquery options",
        "// Line_Reference 1806:                                 'dateFormat' => Formatter::formatDatePicker(),",
        "// Line_Reference 1807:                                 'changeMonth' => true,",
        "// Line_Reference 1808:                                 'changeYear' => true,",
        "// Line_Reference 1809:                             ),",
        "// Line_Reference 1810:                             'htmlOptions' => array_merge(array(",
        "// Line_Reference 1811:                                 'title' => $field->attributeLabel,",
        "// Line_Reference 1812:                                     ), $htmlOptions),",
        "// Line_Reference 1813:                             'language' => (Yii::app()->language == 'en') ? '' : Yii::app()->getLanguage(),",
        "// Line_Reference 1814:                                 ), true);"
    ]
}
