{
    "cve_id": "CVE-2015-5273",
    "cve_description": "The abrt-action-install-debuginfo-to-abrt-cache help program in Automatic Bug Reporting Tool (ABRT) before 2.7.1 allows local users to write to arbitrary files via a symlink attack on unpacked.cpio in a pre-created directory with a predictable name in /var/tmp.",
    "cve_publish_date": "2015-12-07",
    "cwe_id": "CWE-59",
    "cwe_name": "Improper Link Resolution Before File Access ('Link Following')",
    "cwe_description": "The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",
    "commit_message": "a-a-i-d-to-abrt-cache: make own random temporary directory\n\nThe set-user-ID wrapper must use own new temporary directory in order to\navoid security issues with unpacking specially crafted debuginfo\npackages that might be used to create files or symlinks anywhere on the\nfile system as the abrt user.\n\nWithot the forking code the temporary directory would remain on the\nfilesystem in the case where all debuginfo data are already available.\nThis is caused by the fact that the underlying libreport functionality\naccepts path to a desired temporary directory and creates it only if\nnecessary. Otherwise, the directory is not touched at all.\n\nThis commit addresses CVE-2015-5273\n\nSigned-off-by: Jakub Filak <jfilak@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "abrt-action-install-debuginfo-to-abrt-cache.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 111:     /* name, -v, --ids, -, -y, -e, EXACT, -r, REPO, --, NULL */",
        "// Line_Reference 112:     const char *args[11];",
        "// Line_Reference 207:     execvp(EXECUTABLE, (char **)args);",
        "// Line_Reference 208:     error_msg_and_die(\"Can't execute %s\", EXECUTABLE);"
    ]
}
