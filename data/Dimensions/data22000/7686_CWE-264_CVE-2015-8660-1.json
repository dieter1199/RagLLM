{
    "cve_id": "CVE-2015-8660",
    "cve_description": "The ovl_setattr function in fs/overlayfs/inode.c in the Linux kernel through 4.3.3 attempts to merge distinct setattr operations, which allows local users to bypass intended access restrictions and modify the attributes of arbitrary overlay files via a crafted application.",
    "cve_publish_date": "2015-12-28",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "ovl: fix permission checking for setattr\n\n[Al Viro] The bug is in being too enthusiastic about optimizing ->setattr()\naway - instead of \"copy verbatim with metadata\" + \"chmod/chown/utimes\"\n(with the former being always safe and the latter failing in case of\ninsufficient permissions) it tries to combine these two.  Note that copyup\nitself will have to do ->setattr() anyway; _that_ is where the elevated\ncapabilities are right.  Having these two ->setattr() (one to set verbatim\ncopy of metadata, another to do what overlayfs ->setattr() had been asked\nto do in the first place) combined is where it breaks.\n\nSigned-off-by: Miklos Szeredi <miklos@szeredi.hu>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Al Viro <viro@zeniv.linux.org.uk>",
    "type_of_change": "Modification",
    "filename_of_changes": "inode.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 52: \tupperdentry = ovl_dentry_upper(dentry);",
        "// Line_Reference 53: \tif (upperdentry) {",
        "// Line_Reference 57: \t} else {",
        "// Line_Reference 58: \t\terr = ovl_copy_up_last(dentry, attr, false);"
    ]
}
