{
    "cve_id": "CVE-2017-5970",
    "cve_description": "The ipv4_pktinfo_prepare function in net/ipv4/ip_sockglue.c in the Linux kernel through 4.9.9 allows attackers to cause a denial of service (system crash) via (1) an application that makes crafted system calls or possibly (2) IPv4 traffic with invalid IP options.",
    "cve_publish_date": "2017-02-14",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "ipv4: keep skb->dst around in presence of IP options\n\nAndrey Konovalov got crashes in __ip_options_echo() when a NULL skb->dst\nis accessed.\n\nipv4_pktinfo_prepare() should not drop the dst if (evil) IP options\nare present.\n\nWe could refine the test to the presence of ts_needtime or srr,\nbut IP options are not often used, so let's be conservative.\n\nThanks to syzkaller team for finding this bug.\n\nFixes: d826eb14ecef (\"ipv4: PKTINFO doesnt need dst reference\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Andrey Konovalov <andreyknvl@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip_sockglue.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "8",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1241: \tskb_dst_drop(skb);"
    ]
}
