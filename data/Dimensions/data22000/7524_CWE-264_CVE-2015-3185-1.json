{
    "cve_id": "CVE-2015-3185",
    "cve_description": "The ap_some_auth_required function in server/request.c in the Apache HTTP Server 2.4.x before 2.4.14 does not consider that a Require directive may be associated with an authorization setting rather than an authentication setting, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging the presence of a module that relies on the 2.2 API behavior.",
    "cve_publish_date": "2015-07-20",
    "cwe_id": "CWE-264",
    "cwe_name": "Permissions, Privileges, and Access Controls",
    "cwe_description": "Weaknesses in this category are related to the management of permissions, privileges, and other security features that are used to perform access control.",
    "commit_message": "SECURITY: CVE-2015-3185 (cve.mitre.org)\n\nReplacement of ap_some_auth_required (unusable in Apache httpd 2.4)\nwith new ap_some_authn_required and ap_force_authn hook.\n\nSubmitted by: breser\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1684524 13f79535-47bb-0310-9956-ffa450edef68",
    "type_of_change": "Modification",
    "filename_of_changes": "request.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "56",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 239:             if (access_status == OK) {",
        "// Line_Reference 240:                 ap_log_rerror(APLOG_MARK, APLOG_TRACE3, 0, r,",
        "// Line_Reference 241:                               \"request authorized without authentication by \"",
        "// Line_Reference 242:                               \"access_checker_ex hook: %s\", r->uri);",
        "// Line_Reference 243:             }",
        "// Line_Reference 244:             else if (access_status != DECLINED) {",
        "// Line_Reference 245:                 return decl_die(access_status, \"check access\", r);",
        "// Line_Reference 246:             }",
        "// Line_Reference 247:             else {",
        "// Line_Reference 276:             if (access_status == OK) {",
        "// Line_Reference 277:                 ap_log_rerror(APLOG_MARK, APLOG_TRACE3, 0, r,",
        "// Line_Reference 278:                               \"request authorized without authentication by \"",
        "// Line_Reference 279:                               \"access_checker_ex hook: %s\", r->uri);",
        "// Line_Reference 280:             }",
        "// Line_Reference 281:             else if (access_status != DECLINED) {",
        "// Line_Reference 282:                 return decl_die(access_status, \"check access\", r);",
        "// Line_Reference 283:             }",
        "// Line_Reference 284:             else {"
    ]
}
