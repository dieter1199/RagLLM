{
    "cve_id": "CVE-2014-0064",
    "cve_description": "Multiple integer overflows in the path_in and other unspecified functions in PostgreSQL before 8.4.20, 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to have unspecified impact and attack vectors, which trigger a buffer overflow.  NOTE: this identifier has been SPLIT due to different affected versions; use CVE-2014-2669 for the hstore vector.",
    "cve_publish_date": "2014-03-31",
    "cwe_id": "CWE-189",
    "cwe_name": "Numeric Errors",
    "cwe_description": "Weaknesses in this category are related to improper calculation or conversion of numbers.",
    "commit_message": "Predict integer overflow to avoid buffer overruns.\n\nSeveral functions, mostly type input functions, calculated an allocation\nsize such that the calculation wrapped to a small positive value when\narguments implied a sufficiently-large requirement.  Writes past the end\nof the inadvertent small allocation followed shortly thereafter.\nCoverity identified the path_in() vulnerability; code inspection led to\nthe rest.  In passing, add check_stack_depth() to prevent stack overflow\nin related functions.\n\nBack-patch to 8.4 (all supported versions).  The non-comment hstore\nchanges touch code that did not exist in 8.4, so that part stops at 9.0.\n\nNoah Misch and Heikki Linnakangas, reviewed by Tom Lane.\n\nSecurity: CVE-2014-0064",
    "type_of_change": "Modification",
    "filename_of_changes": "txid.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 448: \tint\t\t\tavail;",
        "// Line_Reference 449: \tint\t\t\texpect;",
        "// Line_Reference 453: \t/*",
        "// Line_Reference 454: \t * load nxip and check for nonsense.",
        "// Line_Reference 455: \t *",
        "// Line_Reference 456: \t * (nxip > avail) check is against int overflows in 'expect'.",
        "// Line_Reference 457: \t */",
        "// Line_Reference 459: \tavail = buf->len - buf->cursor;",
        "// Line_Reference 460: \texpect = 8 + 8 + nxip * 8;",
        "// Line_Reference 461: \tif (nxip < 0 || nxip > avail || expect > avail)"
    ]
}
