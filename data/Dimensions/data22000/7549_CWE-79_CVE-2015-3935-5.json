{
    "cve_id": "CVE-2015-3935",
    "cve_description": "Multiple cross-site scripting (XSS) vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 allow remote attackers to inject arbitrary web script or HTML via the Business Search (search_nom) field to (1) htdocs/societe/societe.php or (2) htdocs/societe/admin/societe.php.",
    "cve_publish_date": "2015-06-10",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Properly escape untrusted data to prevent HTML injection.\n\nFirst pass for #2857",
    "type_of_change": "Modification",
    "filename_of_changes": "societe.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 6:  * Copyright (C) 2013      RaphaÃ«l Doursenaud   <rdoursenaud@gpcsolutions.fr>",
        "// Line_Reference 213:     $sql .= \" AND sc.fk_user = \".$search_sale;",
        "// Line_Reference 218:     $sql .= \" AND cs.fk_categorie = \".$search_categ;",
        "// Line_Reference 275: \t$params = \"&amp;socname=\".$socname.\"&amp;search_nom=\".$search_nom.\"&amp;search_town=\".$search_town;",
        "// Line_Reference 276: \t$params.= ($sbarcode?\"&amp;sbarcode=\".$sbarcode:\"\");",
        "// Line_Reference 277: \t$params.= '&amp;search_idprof1='.$search_idprof1;",
        "// Line_Reference 278: \t$params.= '&amp;search_idprof2='.$search_idprof2;",
        "// Line_Reference 279: \t$params.= '&amp;search_idprof3='.$search_idprof3;",
        "// Line_Reference 280: \t$params.= '&amp;search_idprof4='.$search_idprof4;",
        "// Line_Reference 351: \tprint '<input class=\"flat\" type=\"text\" name=\"search_nom\" value=\"'.$search_nom.'\">';",
        "// Line_Reference 356:     \tprint '<td class=\"liste_titre\">';",
        "// Line_Reference 357:     \tprint '<input class=\"flat\" type=\"text\" name=\"sbarcode\" size=\"6\" value=\"'.$sbarcode.'\">';",
        "// Line_Reference 358:     \tprint '</td>';",
        "// Line_Reference 362: \tprint '<input class=\"flat\" size=\"10\" type=\"text\" name=\"search_town\" value=\"'.$search_town.'\">';",
        "// Line_Reference 366: \tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof1\" value=\"'.$search_idprof1.'\">';",
        "// Line_Reference 370: \tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof2\" value=\"'.$search_idprof2.'\">';",
        "// Line_Reference 374: \tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof3\" value=\"'.$search_idprof3.'\">';",
        "// Line_Reference 378: \tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof4\" value=\"'.$search_idprof4.'\">';"
    ]
}
