{
    "cve_id": "CVE-2014-5207",
    "cve_description": "fs/namespace.c in the Linux kernel through 3.16.1 does not properly restrict clearing MNT_NODEV, MNT_NOSUID, and MNT_NOEXEC and changing MNT_ATIME_MASK during a remount of a bind mount, which allows local users to gain privileges, interfere with backups and auditing on systems that had atime enabled, or cause a denial of service (excessive filesystem updating) on systems that had atime disabled via a \"mount -o remount\" command within a user namespace.",
    "cve_publish_date": "2014-08-18",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "mnt: Correct permission checks in do_remount\n\nWhile invesgiating the issue where in \"mount --bind -oremount,ro ...\"\nwould result in later \"mount --bind -oremount,rw\" succeeding even if\nthe mount started off locked I realized that there are several\nadditional mount flags that should be locked and are not.\n\nIn particular MNT_NOSUID, MNT_NODEV, MNT_NOEXEC, and the atime\nflags in addition to MNT_READONLY should all be locked.  These\nflags are all per superblock, can all be changed with MS_BIND,\nand should not be changable if set by a more privileged user.\n\nThe following additions to the current logic are added in this patch.\n- nosuid may not be clearable by a less privileged user.\n- nodev  may not be clearable by a less privielged user.\n- noexec may not be clearable by a less privileged user.\n- atime flags may not be changeable by a less privileged user.\n\nThe logic with atime is that always setting atime on access is a\nglobal policy and backup software and auditing software could break if\natime bits are not updated (when they are configured to be updated),\nand serious performance degradation could result (DOS attack) if atime\nupdates happen when they have been explicitly disabled.  Therefore an\nunprivileged user should not be able to mess with the atime bits set\nby a more privileged user.\n\nThe additional restrictions are implemented with the addition of\nMNT_LOCK_NOSUID, MNT_LOCK_NODEV, MNT_LOCK_NOEXEC, and MNT_LOCK_ATIME\nmnt flags.\n\nTaken together these changes and the fixes for MNT_LOCK_READONLY\nshould make it safe for an unprivileged user to create a user\nnamespace and to call \"mount --bind -o remount,... ...\" without\nthe danger of mount flags being changed maliciously.\n\nCc: stable@vger.kernel.org\nAcked-by: Serge E. Hallyn <serge.hallyn@ubuntu.com>\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "namespace.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 893: \tif ((flag & CL_UNPRIVILEGED) && (mnt->mnt.mnt_flags & MNT_READONLY))",
        "// Line_Reference 894: \t\tmnt->mnt.mnt_flags |= MNT_LOCK_READONLY;",
        "// Line_Reference 2132: \t\t\tmnt_flags |= MNT_NODEV;"
    ]
}
