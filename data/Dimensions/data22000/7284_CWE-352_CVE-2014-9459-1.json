{
    "cve_id": "CVE-2014-9459",
    "cve_description": "Cross-site request forgery (CSRF) vulnerability in the AdminObserver function in e107_admin/users.php in e107 2.0 alpha2 allows remote attackers to hijack the authentication of administrators for requests that add users to the administrator group via the id parameter in an admin action.",
    "cve_publish_date": "2015-01-02",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Added additional check prior to administrator status change.",
    "type_of_change": "Modification",
    "filename_of_changes": "users.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 698: \t\tif(!$sysuser->isAdmin())",
        "// Line_Reference 700: \t\t\t$sysuser->set('user_admin', 1)->save(); //\"user\",\"user_admin='1' WHERE user_id={$userid}\"",
        "// Line_Reference 701: \t\t\t$lan = str_replace(array('--UID--', '--NAME--', '--EMAIL--'), array($sysuser->getId(), $sysuser->getName(), $sysuser->getValue('email')), USRLAN_164);",
        "// Line_Reference 702: \t\t\te107::getLog()->add('USET_08', $lan, E_LOG_INFORMATIVE);",
        "// Line_Reference 703: \t\t\t$mes->addSuccess($lan);",
        "// Line_Reference 706: \t\tif($this->getPosted('update_admin')) e107::getUserPerms()->updatePerms($userid, $_POST['perms']);"
    ]
}
