{
    "cve_id": "CVE-2017-5590",
    "cve_description": "An incorrect implementation of \"XEP-0280: Message Carbons\" in multiple XMPP clients allows a remote attacker to impersonate any user, including contacts, in the vulnerable application's display. This allows for various kinds of social engineering attacks. This CVE is for ChatSecure (3.2.0 - 4.0.0; only iOS) and Zom (all versions up to 1.0.11; only iOS).",
    "cve_publish_date": "2017-02-09",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Changed to using carbon module delegate methods",
    "type_of_change": "Modification",
    "filename_of_changes": "OTRXMPPMessageYapStroage.m",
    "code_language": "Objective-C",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "19",
    "vulnerable_lines": [
        "// Line_Reference 32: - (void)xmppStream:(XMPPStream *)sender didReceiveMessage:(XMPPMessage *)xmppMessage",
        "// Line_Reference 33: {",
        "// Line_Reference 34:     [self storeMessage:xmppMessage stream:sender incoming:YES];",
        "// Line_Reference 35: }",
        "// Line_Reference 36: ",
        "// Line_Reference 37: - (void)storeMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream incoming:(BOOL)incoming",
        "// Line_Reference 38: {",
        "// Line_Reference 39:     if ([xmppMessage isMessageCarbon]) {",
        "// Line_Reference 40:         [self handleCarbonMessage:xmppMessage stream:stream];",
        "// Line_Reference 41:     } else {",
        "// Line_Reference 42:         [self handleMessage:xmppMessage stream:stream incoming:incoming];",
        "// Line_Reference 43:     }",
        "// Line_Reference 44: }",
        "// Line_Reference 79: - (void)handleMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream incoming:(BOOL)incoming;",
        "// Line_Reference 187: - (void)handleCarbonMessage:(XMPPMessage *)xmppMessage stream:(XMPPStream *)stream",
        "// Line_Reference 191:     BOOL incoming = NO;",
        "// Line_Reference 192:     XMPPMessage *forwardedMessage = [xmppMessage messageCarbonForwardedMessage];",
        "// Line_Reference 196:     if ([xmppMessage isReceivedMessageCarbon]) {",
        "// Line_Reference 198:         incoming = YES;"
    ]
}
