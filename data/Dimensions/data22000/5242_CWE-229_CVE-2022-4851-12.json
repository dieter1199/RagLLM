{
    "cve_id": "CVE-2022-4851",
    "cve_description": "Improper Handling of Values in GitHub repository usememos/memos prior to 0.9.1.",
    "cve_publish_date": "2022-12-29",
    "cwe_id": "CWE-229",
    "cwe_name": "Improper Handling of Values",
    "cwe_description": "The product does not properly handle when the expected number of values for parameters, fields, or arguments is not provided in input, or if those values are undefined.",
    "commit_message": "fix: access control (#870)",
    "type_of_change": "Modification",
    "filename_of_changes": "tag.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "7",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 26: \t\ttagUpsert := &api.TagUpsert{",
        "// Line_Reference 27: \t\t\tCreatorID: userID,",
        "// Line_Reference 28: \t\t}",
        "// Line_Reference 92: \t\tif userID, err := strconv.Atoi(c.QueryParam(\"creatorId\")); err == nil {",
        "// Line_Reference 93: \t\t\tmemoFind.CreatorID = &userID",
        "// Line_Reference 94: \t\t}",
        "// Line_Reference 95: ",
        "// Line_Reference 96: \t\tcurrentUserID, ok := c.Get(getUserIDContextKey()).(int)",
        "// Line_Reference 97: \t\tif !ok {",
        "// Line_Reference 98: \t\t\tif memoFind.CreatorID == nil {",
        "// Line_Reference 99: \t\t\t\treturn echo.NewHTTPError(http.StatusBadRequest, \"Missing user id to find memo\")",
        "// Line_Reference 100: \t\t\t}",
        "// Line_Reference 101: \t\t\tmemoFind.VisibilityList = []api.Visibility{api.Public}",
        "// Line_Reference 102: \t\t} else {",
        "// Line_Reference 103: \t\t\tif memoFind.CreatorID == nil {",
        "// Line_Reference 104: \t\t\t\tmemoFind.CreatorID = &currentUserID",
        "// Line_Reference 105: \t\t\t} else {",
        "// Line_Reference 106: \t\t\t\tmemoFind.VisibilityList = []api.Visibility{api.Public, api.Protected}",
        "// Line_Reference 107: \t\t\t}",
        "// Line_Reference 108: \t\t}",
        "// Line_Reference 109: "
    ]
}
