{
    "cve_id": "CVE-2012-10008",
    "cve_description": "A vulnerability, which was classified as critical, has been found in uakfdotb oneapp. This issue affects some unknown processing. The manipulation leads to sql injection. The attack may be initiated remotely. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The patch is named 5413ac804f1b09f9decc46a6c37b08352c49669c. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-221483.",
    "cve_publish_date": "2023-02-20",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "All users are now unified in the users table. Club and site administrators are determined by associations with groups in the user_groups table. Additionally, a few critical MySQL injection vulnerabilities are fixed in this revision.",
    "type_of_change": "Modification",
    "filename_of_changes": "common.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "119",
    "number_of_lines_deleted_vulnerable_to_cve": "101",
    "vulnerable_lines": [
        "// Line_Reference 517: \tif(!lockAction(\"checkuser\")) {",
        "// Line_Reference 575: //returns array (username, email address, name)",
        "// Line_Reference 576: function getUserInformation($user_id) {",
        "// Line_Reference 577: \t$user_id = escape($user_id);",
        "// Line_Reference 578: \t$result = mysql_query(\"SELECT username, email, name FROM users WHERE id='$user_id'\");",
        "// Line_Reference 580: \tif($row = mysql_fetch_array($result)) {",
        "// Line_Reference 581: \t\treturn array($row[0], $row[1], $row[2]);",
        "// Line_Reference 587: //returns array (username, email address, club name)",
        "// Line_Reference 588: function getAdminInformation($admin_id) {",
        "// Line_Reference 589: \t$admin_id = escape($admin_id);",
        "// Line_Reference 590: \t$club_id = getAdminClub($admin_id);",
        "// Line_Reference 591: \t$result = mysql_query(\"SELECT a.username, a.email, c.name FROM admins a, clubs c WHERE a.id='$admin_id' AND c.id='$club_id'\");",
        "// Line_Reference 602: \tif(!lockAction(\"checkuser\")) {",
        "// Line_Reference 622: function addAdmin($username, $password, $email, $club_id) {",
        "// Line_Reference 623: \t$username = escape($username);",
        "// Line_Reference 624: \t$password = escape(chash($password));",
        "// Line_Reference 625: \t$email = escape($email);",
        "// Line_Reference 627: ",
        "// Line_Reference 628: \t$result = mysql_query(\"INSERT INTO admins (username, password, email, club_id) VALUES ('$username', '$password', '$email', '$club_id')\");",
        "// Line_Reference 629: }",
        "// Line_Reference 630: ",
        "// Line_Reference 631: function updateAdmin($admin_id, $username, $password, $email, $club_id) {",
        "// Line_Reference 632: \t$admin_id = escape($admin_id);",
        "// Line_Reference 633: \t$setString = \"\";",
        "// Line_Reference 634: ",
        "// Line_Reference 635: \tif(strlen($username) > 0) {",
        "// Line_Reference 636: \t\t$setString .= \", username = '\" . escape($username) . \"'\";",
        "// Line_Reference 637: \t}",
        "// Line_Reference 638: ",
        "// Line_Reference 639: \tif(strlen($password) > 0) {",
        "// Line_Reference 640: \t\t$setString .= \", password = '\" . escape(chash($password)) . \"'\";",
        "// Line_Reference 641: \t}",
        "// Line_Reference 642: ",
        "// Line_Reference 643: \tif(strlen($email) > 0) {",
        "// Line_Reference 644: \t\t$setString .= \", email = '\" . escape($email) . \"'\";",
        "// Line_Reference 645: \t}",
        "// Line_Reference 646: ",
        "// Line_Reference 647: \tif(strlen($club_id) > 0) {",
        "// Line_Reference 648: \t\t$setString .= \", club_id = '\" . escape($club_id) . \"'\";",
        "// Line_Reference 649: \t}",
        "// Line_Reference 650: ",
        "// Line_Reference 651: \tif(strlen($setString) > 0) {",
        "// Line_Reference 652: \t\t$setString = substr($setString, 2);",
        "// Line_Reference 653: \t\t$result = mysql_query(\"UPDATE admins SET $setString WHERE id='$admin_id'\");",
        "// Line_Reference 654: \t}",
        "// Line_Reference 655: }",
        "// Line_Reference 657: function checkAdmin($username, $password) {",
        "// Line_Reference 658: \tif(!checkLock(\"checkadmin\")) {",
        "// Line_Reference 659: \t\treturn FALSE;",
        "// Line_Reference 660: \t}",
        "// Line_Reference 662: \t$username = escape($username);",
        "// Line_Reference 663: \t$password = escape(chash($password));",
        "// Line_Reference 664: ",
        "// Line_Reference 665: \t$result = mysql_query(\"SELECT id, password FROM admins WHERE username='\" . $username . \"'\");",
        "// Line_Reference 666: ",
        "// Line_Reference 667: \tif($row = mysql_fetch_array($result)) {",
        "// Line_Reference 668: \t\tif(strcmp($password, $row['password']) == 0) {",
        "// Line_Reference 669: \t\t\treturn $row['id'];",
        "// Line_Reference 671: \t\t\tlockAction(\"checkadmin\");",
        "// Line_Reference 672: \t\t\treturn FALSE;",
        "// Line_Reference 675: \t\tlockAction(\"checkadmin\");",
        "// Line_Reference 676: \t\treturn FALSE;",
        "// Line_Reference 680: //returns admin ID, or false on failure",
        "// Line_Reference 681: function getAdminClub($admin_id) {",
        "// Line_Reference 682: \t$admin_id = escape($admin_id);",
        "// Line_Reference 683: \t$result = mysql_query(\"SELECT club_id FROM admins WHERE id='$admin_id'\");",
        "// Line_Reference 685: \tif($row = mysql_fetch_array($result)) {",
        "// Line_Reference 686: \t\treturn $row[0];",
        "// Line_Reference 688: \t\treturn FALSE;",
        "// Line_Reference 692: function checkRoot($password) {",
        "// Line_Reference 693: \tif(!checkLock(\"root\")) {",
        "// Line_Reference 694: \t\treturn FALSE;",
        "// Line_Reference 695: \t}",
        "// Line_Reference 697: \t$config = $GLOBALS['config'];",
        "// Line_Reference 699: \t$root_password = $config['root_password'];",
        "// Line_Reference 700: \tif(substr($root_password, 0, 1) == ':') { //rest of root password is actually a hash",
        "// Line_Reference 701: \t\t$root_password = substr($root_password, 1);",
        "// Line_Reference 702: \t\t$password = chash($config['root_password_salt'] . $password);",
        "// Line_Reference 705: \tif($password == $root_password) {",
        "// Line_Reference 706: \t\treturn true;",
        "// Line_Reference 707: \t} else {",
        "// Line_Reference 708: \t\tlockAction(\"root\");",
        "// Line_Reference 709: \t\treturn false;",
        "// Line_Reference 713: //1: success; -1: invalid password",
        "// Line_Reference 714: function changeAdminPassword($admin_id, $password){",
        "// Line_Reference 715: \tif(validPassword($password) != 0) {",
        "// Line_Reference 716: \t\treturn -1;",
        "// Line_Reference 717: \t} else {",
        "// Line_Reference 718: \t\tmysql_query(\"UPDATE admins SET password = '\" . escape(chash($password)) . \"' WHERE id='\" . $admin_id . \"'\");",
        "// Line_Reference 719: \t\treturn 1;",
        "// Line_Reference 721: }",
        "// Line_Reference 722: ",
        "// Line_Reference 723: //1: success; -1: invalid password, -2 password doesnt match",
        "// Line_Reference 724: function changeAdminPass($admin_id, $password, $verify){",
        "// Line_Reference 725: \tif($password != $verify){",
        "// Line_Reference 726: \t\treturn -2;",
        "// Line_Reference 727: \t} else if(validPassword($password) != 0) {",
        "// Line_Reference 728: \t\treturn -1;",
        "// Line_Reference 729: \t} else {",
        "// Line_Reference 730: \t\tmysql_query(\"UPDATE admins SET password = '\" . escape(chash($password)) . \"' WHERE id='\" . $admin_id . \"'\");",
        "// Line_Reference 731: \t\treturn 1;"
    ]
}
