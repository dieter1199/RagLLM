{
    "cve_id": "CVE-2015-5070",
    "cve_description": "The (1) filesystem::get_wml_location function in filesystem.cpp and (2) is_legal_file function in filesystem_boost.cpp in Battle for Wesnoth before 1.12.4 and 1.13.x before 1.13.1, when a case-insensitive filesystem is used, allow remote attackers to obtain sensitive information via vectors related to inclusion of .pbl files from WML.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-5069.",
    "cve_publish_date": "2017-09-26",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Use looks_like_pbl() to disallow .pbl file inclusion (bug #23504)\n\nThis function is implemented using case-insensitive pattern matching,\nunlike filesystem::ends_with(). I missed this when writing my original\nfix, so the vulnerability still applied to .pbl files on a\ncase-insensitive filesystem (e.g. NTFS and FAT* on Windows) by using\ndifferent case to bypass the check.",
    "type_of_change": "Modification",
    "filename_of_changes": "filesystem_boost.cpp",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 1003: \tif (ends_with(filename, \".pbl\")) {"
    ]
}
