{
    "cve_id": "CVE-2024-22400",
    "cve_description": "Nextcloud User Saml is an app for authenticating Nextcloud users using SAML. In affected versions users can be given a link to the Nextcloud server and end up on a uncontrolled thirdparty server. It is recommended that the User Saml app is upgraded to version 5.1.5, 5.2.5, or 6.0.1. There are no known workarounds for this issue.",
    "cve_publish_date": "2024-01-18",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "refactor(Controller): read parameter only once\n\nSigned-off-by: Arthur Schiwon <blizzz@arthur-schiwon.de>",
    "type_of_change": "Modification",
    "filename_of_changes": "SAMLController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 94: \t\tICrypto $crypto",
        "// Line_Reference 199: \t\t\t\t$returnUrl = $this->request->getParam('originalUrl', $this->urlGenerator->linkToRouteAbsolute('user_saml.SAML.login'));",
        "// Line_Reference 218: \t\t\t\t\t'OriginalUrl' => $this->request->getParam('originalUrl', ''),",
        "// Line_Reference 232: \t\t\t\t$ssoUrl = $this->request->getParam('originalUrl', '');"
    ]
}
