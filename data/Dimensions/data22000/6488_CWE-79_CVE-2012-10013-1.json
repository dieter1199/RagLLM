{
    "cve_id": "CVE-2012-10013",
    "cve_description": "A vulnerability was found in Kau-Boy Backend Localization Plugin up to 1.6.1 on WordPress. It has been rated as problematic. This issue affects some unknown processing of the file backend_localization.php. The manipulation leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 2.0 is able to address this issue. The patch is named 43dc96defd7944da12ff116476a6890acd7dd24b. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-227231.",
    "cve_publish_date": "2023-04-24",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Adding Version 2.0: Adding some new languages. Fixing link to switch languages in backend. Thanks to Justin! Fixing XSS vulnerabilities. Many Thanks to Matt Fuller from MOZILLA!\n\ngit-svn-id: https://plugins.svn.wordpress.org/kau-boys-backend-localization/trunk@579507 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "backend_localization.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "190",
    "number_of_lines_deleted_vulnerable_to_cve": "155",
    "vulnerable_lines": [
        "// Line_Reference 4: Plugin URI: http://kau-boys.de/230/wordpress/kau-boys-backend-localization-plugin",
        "// Line_Reference 6: Version: 1.6.1",
        "// Line_Reference 8: Author URI: http://kau-boys.de",
        "// Line_Reference 11: ",
        "// Line_Reference 12: define('BACKEND_LOCALIZATION_URL', WP_PLUGIN_URL.'/'.str_replace(basename( __FILE__),\"\",plugin_basename(__FILE__)));",
        "// Line_Reference 19: \tload_plugin_textdomain('backend-localization', false, dirname(plugin_basename(__FILE__)));",
        "// Line_Reference 22: \t\t'af' => __('Afrikaans', 'backend-localization'),",
        "// Line_Reference 23: \t\t\t'ar' => __('Arabic', 'backend-localization'),",
        "// Line_Reference 24: \t\t\t'az' => __('Azerbaijani', 'backend-localization'),",
        "// Line_Reference 25: \t\t\t'bg_BG' => __('Bulgarian', 'backend-localization'),",
        "// Line_Reference 26: \t\t\t'bn_BD' => __('Bengali', 'backend-localization'),",
        "// Line_Reference 27: \t\t\t'bs_BA' => __('Bosnian', 'backend-localization'),",
        "// Line_Reference 28: \t\t\t'ca' => __('Catalan', 'backend-localization'),",
        "// Line_Reference 29: \t\t\t'ckb' => __('Kurdish', 'backend-localization'),",
        "// Line_Reference 30: \t\t\t'cpp' => __('Cape Verdean Creole', 'backend-localization'),",
        "// Line_Reference 31: \t\t\t'cs_CZ' => __('Czech', 'backend-localization'),",
        "// Line_Reference 32: \t\t\t'cy' => __('Cymraeg (Welsh)', 'backend-localization'),",
        "// Line_Reference 33: \t\t\t'da_DK' => __('Danish', 'backend-localization'),",
        "// Line_Reference 34: \t\t\t'de_DE' => __('German', 'backend-localization'),",
        "// Line_Reference 35: \t\t\t'el' => __('Greek', 'backend-localization'),",
        "// Line_Reference 36: \t\t\t'en_US' => __('English', 'backend-localization'),",
        "// Line_Reference 37: \t\t\t'eo' => __('Esperanto', 'backend-localization'),",
        "// Line_Reference 38: \t\t\t'es_CL' => __('Spanish (Chile)', 'backend-localization'),",
        "// Line_Reference 39: \t\t\t'es_ES' => __('Spanish', 'backend-localization'),",
        "// Line_Reference 40: \t\t\t'es_PE' => __('Spanish (Peru)', 'backend-localization'),",
        "// Line_Reference 41: \t\t\t'es_VE' => __('Spanish (Venezuela)', 'backend-localization'),",
        "// Line_Reference 42: \t\t\t'et' => __('Estonian', 'backend-localization'),",
        "// Line_Reference 43: \t\t\t'eu' => __('Basque', 'backend-localization'),",
        "// Line_Reference 44: \t\t\t'fa_AF' => __('Persian (Afghanistan)', 'backend-localization'),",
        "// Line_Reference 45: \t\t\t'fa_IR' => __('Persian', 'backend-localization'),",
        "// Line_Reference 46: \t\t\t'fi' => __('Finnish', 'backend-localization'),",
        "// Line_Reference 47: \t\t\t'fo' => __('Faroese', 'backend-localization'),",
        "// Line_Reference 48: \t\t\t'fr_BE' => __('French (Belgium)', 'backend-localization'),",
        "// Line_Reference 49: \t\t\t'fr_FR' => __('French', 'backend-localization'),",
        "// Line_Reference 50: \t\t\t'fy' => __('Western Frisian', 'backend-localization'),",
        "// Line_Reference 51: \t\t\t'gd' => __('Scottish Gaelic', 'backend-localization'),",
        "// Line_Reference 52: \t\t\t'gl_ES' => __('Galician ', 'backend-localization'),",
        "// Line_Reference 53: \t\t\t'haw_US' => __('Hawaiian', 'backend-localization'),",
        "// Line_Reference 54: \t\t\t'he_IL' => __('Hebrew', 'backend-localization'),",
        "// Line_Reference 55: \t\t\t'hi_IN' => __('Hindi', 'backend-localization'),",
        "// Line_Reference 56: \t\t\t'hr' => __('Croatian', 'backend-localization'),",
        "// Line_Reference 57: \t\t\t'hu_HU' => __('Hungarian', 'backend-localization'),",
        "// Line_Reference 58: \t\t\t'hy' => __('Armenian', 'backend-localization'),",
        "// Line_Reference 59: \t\t\t'id_ID' => __('Indonesian', 'backend-localization'),",
        "// Line_Reference 60: \t\t\t'is_IS' => __('Icelandic', 'backend-localization'),",
        "// Line_Reference 61: \t\t\t'it_IT' => __('Italian', 'backend-localization'),",
        "// Line_Reference 62: \t\t\t'ja' => __('Japanese', 'backend-localization'),",
        "// Line_Reference 63: \t\t\t'jv_ID' => __('Javanese', 'backend-localization'),",
        "// Line_Reference 64: \t\t\t'ka_GE' => __('Georgian', 'backend-localization'),",
        "// Line_Reference 65: \t\t\t'kea' => __('Kabuverdianu', 'backend-localization'),",
        "// Line_Reference 66: \t\t\t'kk' => __('Kazakh', 'backend-localization'),",
        "// Line_Reference 67: \t\t\t'kn' => __('Kannada', 'backend-localization'),",
        "// Line_Reference 68: \t\t\t'ko_KR' => __('Korean', 'backend-localization'),",
        "// Line_Reference 69: \t\t\t'ku' => __('Kurdish', 'backend-localization'),",
        "// Line_Reference 70: \t\t\t'ky_KY' => __('Kyrgyz', 'backend-localization'),",
        "// Line_Reference 71: \t\t\t'li' => __('Limburgish', 'backend-localization'),",
        "// Line_Reference 72: \t\t\t'lv' => __('Latvian', 'backend-localization'),",
        "// Line_Reference 73: \t\t\t// 'me_ME' => __('', 'backend-localization'),",
        "// Line_Reference 74: \t\t\t'mg_MG' => __('Malagasy', 'backend-localization'),",
        "// Line_Reference 75: \t\t\t'mk_MK' => __('Macedonian', 'backend-localization'),",
        "// Line_Reference 76: \t\t\t'ml_IN' => __('Malayalam', 'backend-localization'),",
        "// Line_Reference 77: \t\t\t'mn' => __('Mongolian', 'backend-localization'),",
        "// Line_Reference 78: \t\t\t'ms_MY' => __('Malay', 'backend-localization'),",
        "// Line_Reference 79: \t\t\t'my_MM' => __('Burmese (Myanmar)', 'backend-localization'),",
        "// Line_Reference 80: \t\t\t'nb_NO' => __('Norwegian (Bokm&aring;l)', 'backend-localization'),",
        "// Line_Reference 81: \t\t\t'ne_NP' => __('Nepali', 'backend-localization'),",
        "// Line_Reference 82: \t\t\t'nl' => __('Dutch', 'backend-localization'),",
        "// Line_Reference 83: \t\t\t'nl_BE' => __('Dutch (Belgium)', 'backend-localization'),",
        "// Line_Reference 84: \t\t\t'nl_NL' => __('Dutch (Netherlands)', 'backend-localization'),",
        "// Line_Reference 85: \t\t\t'nn_NO' => __('Norwegian (Nynorsk)', 'backend-localization'),",
        "// Line_Reference 86: \t\t\t'pa_IN' => __('Punjabi', 'backend-localization'),",
        "// Line_Reference 87: \t\t\t'pl_PL' => __('Polish', 'backend-localization'),",
        "// Line_Reference 88: \t\t\t'pt_BR' => __('Portuguese (Brazil)', 'backend-localization'),",
        "// Line_Reference 89: \t\t\t'pt_PT' => __('Portuguese', 'backend-localization'),",
        "// Line_Reference 90: \t\t\t'ro_RO' => __('Romanian', 'backend-localization'),",
        "// Line_Reference 91: \t\t\t'ru_RU' => __('Russian', 'backend-localization'),",
        "// Line_Reference 92: \t\t\t'ru_UA' => __('Russian (Ukraine)', 'backend-localization'),",
        "// Line_Reference 93: \t\t\t'sa_IN' => __('Sanskrit', 'backend-localization'),",
        "// Line_Reference 94: \t\t\t'sd_PK' => __('Sindhi', 'backend-localization'),",
        "// Line_Reference 95: \t\t\t'si_LK' => __('Sinhalese', 'backend-localization'),",
        "// Line_Reference 96: \t\t\t'sk_SK' => __('Slovak', 'backend-localization'),",
        "// Line_Reference 97: \t\t\t'sl_SI' => __('Slovenian', 'backend-localization'),",
        "// Line_Reference 98: \t\t\t'so_SO' => __('Somali', 'backend-localization'),",
        "// Line_Reference 99: \t\t\t'sq' => __('Albanian', 'backend-localization'),",
        "// Line_Reference 100: \t\t\t'sr_RS' => __('Serbian', 'backend-localization'),",
        "// Line_Reference 101: \t\t\t'srd' => __('Sardinian', 'backend-localization'),",
        "// Line_Reference 102: \t\t\t'su_ID' => __('Sundanese', 'backend-localization'),",
        "// Line_Reference 103: \t\t\t'sv_SE' => __('Swedish', 'backend-localization'),",
        "// Line_Reference 104: \t\t\t'sw' => __('Swahili', 'backend-localization'),",
        "// Line_Reference 105: \t\t\t'ta_IN' => __('Tamil', 'backend-localization'),",
        "// Line_Reference 106: \t\t\t'ta_LK' => __('Tamil (Sri Lanka)', 'backend-localization'),",
        "// Line_Reference 107: \t\t\t'th' => __('Thai', 'backend-localization'),",
        "// Line_Reference 108: \t\t\t'tr_TR' => __('Turkish', 'backend-localization'),",
        "// Line_Reference 109: \t\t\t'ug_CN' => __('Uighur', 'backend-localization'),",
        "// Line_Reference 110: \t\t\t'uk' => __('Ukrainian', 'backend-localization'),",
        "// Line_Reference 111: \t\t\t'ur' => __('Urdu', 'backend-localization'),",
        "// Line_Reference 112: \t\t\t'uz_UZ' => __('Uzbek', 'backend-localization'),",
        "// Line_Reference 113: \t\t\t'vi' => __('Vietnamese', 'backend-localization'),",
        "// Line_Reference 114: \t\t\t'zh_CN' => __('Chinese', 'backend-localization'),",
        "// Line_Reference 115: \t\t\t'zh_HK' => __('Chinese (Hong Kong)', 'backend-localization'),",
        "// Line_Reference 116: \t\t\t'zh_TW' => __('Chinese (Taiwan)', 'backend-localization')",
        "// Line_Reference 123: \tadd_options_page(\"Kau-Boy's Backend Localization settings\", __('Backend Language', 'backend-localization'), 8, __FILE__, 'backend_localization_admin_settings');",
        "// Line_Reference 128: \tforeach($backend_locale_array as $locale_value){",
        "// Line_Reference 129: \t\t$link = 'http://'.add_query_arg('kau-boys_backend_localization_language', $locale_value);",
        "// Line_Reference 130: \t\tadd_menu_page($wp_locale_all[$locale_value], $wp_locale_all[$locale_value], 'read', $link, NULL, BACKEND_LOCALIZATION_URL.'flag_icons/'.strtolower(substr($locale_value, (strpos($locale_value, '_') * -1))).'.png');",
        "// Line_Reference 134: function backend_localization_filter_plugin_actions($links, $file){",
        "// Line_Reference 136: \tif (!$this_plugin) $this_plugin = plugin_basename(__FILE__);",
        "// Line_Reference 138: \tif ($file == $this_plugin){",
        "// Line_Reference 139: \t\t$settings_link = '<a href=\"options-general.php?page=kau-boys-backend-localization/backend_localization.php\">'.__('Settings').'</a>';",
        "// Line_Reference 140: \t\tarray_unshift($links, $settings_link);",
        "// Line_Reference 148: \tif(isset($_POST['save'])){",
        "// Line_Reference 149: \t\tupdate_option('kau-boys_backend_localization_loginselect', $_POST['kau-boys_backend_localization_loginselect']);",
        "// Line_Reference 151: \t$loginselect = get_option('kau-boys_backend_localization_loginselect');",
        "// Line_Reference 156: \tif(empty($backend_locale)) $backend_locale = 'en_US';",
        "// Line_Reference 162: \t<?php if($settings_saved) : ?>",
        "// Line_Reference 163: \t<div id=\"message\" class=\"updated fade\"><p><strong><?php _e('Options saved.') ?></strong></p></div>",
        "// Line_Reference 166: \t\t<?php _e('Here you can customize the plugin for your needs.', 'backend-localization') ?>",
        "// Line_Reference 170: \t\t\t<input type=\"checkbox\" name=\"kau-boys_backend_localization_loginselect\" id=\"kau-boys_backend_localization_loginselect\"<?php echo ($loginselect == 'on')? ' checked=\"checked\"' : '' ?>/>",
        "// Line_Reference 171: \t\t\t<label for=\"kau-boys_backend_localization_loginselect\"><?php _e('Hide language selection on login form', 'backend-localization') ?></label>",
        "// Line_Reference 177: \t\t\t<input type=\"radio\" value=\"<?php echo $locale_value ?>\" id=\"kau-boys_backend_localization_language_<?php echo $locale_value ?>\" name=\"kau-boys_backend_localization_language\"<?php echo ($backend_locale == $locale_value)? ' checked=\"checked\"' : '' ?> />",
        "// Line_Reference 179: \t\t\t\t<img src=\"<?php echo BACKEND_LOCALIZATION_URL.'flag_icons/'.strtolower(substr($locale_value, (strpos($locale_value, '_') * -1))).'.png' ?>\" alt=\"<?php echo $locale_value ?>\" />",
        "// Line_Reference 180: \t\t\t\t<?php echo $wp_locale_all[$locale_value].' ('.$locale_value.')' ?>",
        "// Line_Reference 185: \t\t\t\t<?php echo sprintf(__('If your language isn\\'t listed, you have to download the right version from the WordPress repository: <a href=\"http://svn.automattic.com/wordpress-i18n\">http://svn.automattic.com/wordpress-i18n</a>. Browser to the language folder of your choice and get the <b>all</b> .mo files for your WordPress Version from <i><b>tags/%1s/messages/</b></i> or from the <i><b>trunk/messages/</b></i> folder. Upload them to the langauge folder <i>%2s</i>. You should than be able to choose the new language (or after a refresh of this page).', 'backend-localization'), $wp_version, WP_LANG_DIR) ?>",
        "// Line_Reference 189: \t\t\t<input class=\"button-primary\" name=\"save\" type=\"submit\" value=\"<?php _e('Save Changes') ?>\" />",
        "// Line_Reference 200: \tif(is_dir(WP_LANG_DIR)){",
        "// Line_Reference 203: \t\t$dh = opendir($dir);",
        "// Line_Reference 204: \t\twhile (false !== ($filename = readdir($dh))) {",
        "// Line_Reference 208: \t\tforeach($files as $file){",
        "// Line_Reference 209: \t\t\t$fileParts = pathinfo($file);",
        "// Line_Reference 210: \t\t\tif($fileParts['extension'] == 'mo' && (strlen($fileParts['filename']) <= 5)){",
        "// Line_Reference 211: \t\t\t\t$fileParts['filename'] = substr($fileParts['basename'], 0,strpos($fileParts['basename'],'.'));",
        "// Line_Reference 217: \tif(!in_array('en_US', $backend_locale_array)){",
        "// Line_Reference 226: \tif(isset($_REQUEST['kau-boys_backend_localization_language'])){",
        "// Line_Reference 227: \t\tsetcookie('kau-boys_backend_localization_language', $_REQUEST['kau-boys_backend_localization_language'], time()+60*60*24*30, '/');",
        "// Line_Reference 237: \tif(get_option('kau-boys_backend_localization_loginselect')) return;",
        "// Line_Reference 244: \t\t<?php _e('Language', 'backend-localization') ?><br />",
        "// Line_Reference 246: \t\t<?php foreach($backend_locale_array as $locale_value) : ?>",
        "// Line_Reference 247: \t\t\t<option value=\"<?php echo $locale_value ?>\"<?php echo ($backend_locale == $locale_value)? ' selected=\"selected\"' : '' ?>>",
        "// Line_Reference 248: \t\t\t\t<?php echo $wp_locale_all[$locale_value].' ('.$locale_value.')' ?>",
        "// Line_Reference 258: \treturn \tisset($_REQUEST['kau-boys_backend_localization_language'])",
        "// Line_Reference 259: \t\t\t? $_REQUEST['kau-boys_backend_localization_language']",
        "// Line_Reference 260: \t\t\t: (\tisset($_COOKIE['kau-boys_backend_localization_language'])",
        "// Line_Reference 262: \t\t\t\t: get_option('kau-boys_backend_localization_language'));",
        "// Line_Reference 267: \tif(defined('WP_ADMIN') || (isset($_REQUEST['pwd']) && isset($_REQUEST['kau-boys_backend_localization_language']))) {",
        "// Line_Reference 274: \tsetcookie('kau-boys_backend_localization_language', \"\", time() - 3600, '/');",
        "// Line_Reference 275: \tsetcookie('kau-boys_backend_localization_language', $_REQUEST['kau-boys_backend_localization_language'], time()+60*60*24*30, '/');",
        "// Line_Reference 278: add_action('init', 'init_backend_localization');",
        "// Line_Reference 279: add_action('admin_menu', 'backend_localization_admin_menu');",
        "// Line_Reference 280: add_action('admin_menu', 'backend_localization_save_setting');",
        "// Line_Reference 281: add_action('wp_login', 'backend_localization_set_login_language');",
        "// Line_Reference 282: add_action('login_form_locale', 'localize_backend');",
        "// Line_Reference 283: add_action('login_head', 'localize_backend');",
        "// Line_Reference 284: add_action('login_form', 'backend_localization_login_form');",
        "// Line_Reference 285: add_filter('plugin_action_links', 'backend_localization_filter_plugin_actions', 10, 2);",
        "// Line_Reference 286: add_filter('locale', 'localize_backend');"
    ]
}
