{
    "cve_id": "CVE-2022-31155",
    "cve_description": "Sourcegraph is an opensource code search and navigation engine. In Sourcegraph versions before 3.41.0, it is possible for an attacker to delete other users’ saved searches due to a bug in the authorization check. The vulnerability does not allow the reading of other users’ saved searches, only overwriting them with attacker-controlled searches. The issue is patched in Sourcegraph version 3.41.0. There is no workaround for this issue and updating to a secure version is highly recommended.",
    "cve_publish_date": "2022-08-01",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Saved searches: fix update permissions (#36674)",
    "type_of_change": "Modification",
    "filename_of_changes": "saved_searches.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "16",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 199: \tvar userID, orgID *int32",
        "// Line_Reference 201: \tif args.UserID != nil {",
        "// Line_Reference 202: \t\tu, err := unmarshalSavedSearchID(*args.UserID)",
        "// Line_Reference 203: \t\tif err != nil {",
        "// Line_Reference 204: \t\t\treturn nil, err",
        "// Line_Reference 205: \t\t}",
        "// Line_Reference 206: \t\tuserID = &u",
        "// Line_Reference 207: \t\tif err := backend.CheckSiteAdminOrSameUser(ctx, r.db, u); err != nil {",
        "// Line_Reference 208: \t\t\treturn nil, err",
        "// Line_Reference 209: \t\t}",
        "// Line_Reference 210: \t} else if args.OrgID != nil {",
        "// Line_Reference 211: \t\to, err := unmarshalSavedSearchID(*args.OrgID)",
        "// Line_Reference 212: \t\tif err != nil {",
        "// Line_Reference 215: \t\torgID = &o",
        "// Line_Reference 216: \t\tif err := backend.CheckOrgAccessOrSiteAdmin(ctx, r.db, o); err != nil {",
        "// Line_Reference 223: \tid, err := unmarshalSavedSearchID(args.ID)",
        "// Line_Reference 224: \tif err != nil {",
        "// Line_Reference 225: \t\treturn nil, err",
        "// Line_Reference 226: \t}",
        "// Line_Reference 227: ",
        "// Line_Reference 238: \t\tUserID:      userID,",
        "// Line_Reference 239: \t\tOrgID:       orgID,"
    ]
}
