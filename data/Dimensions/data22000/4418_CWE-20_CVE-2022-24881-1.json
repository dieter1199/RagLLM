{
    "cve_id": "CVE-2022-24881",
    "cve_description": "Ballcat Codegen provides the function of online editing code to generate templates. In versions prior to 1.0.0.beta.2, attackers can implement remote code execution through malicious code injection of the template engine. This happens because Velocity and freemarker templates are introduced but input verification is not done. The fault is rectified in version 1.0.0.beta.2.",
    "cve_publish_date": "2022-04-26",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": ":lock: 修改模板引擎的默认安全策略，以防止RCE",
    "type_of_change": "Modification",
    "filename_of_changes": "GeneratorServiceImpl.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 136: \t\t\tString filename = StrUtil.format(templateFile.getFilename(), context);",
        "// Line_Reference 144: \t\t\t\tfileEntry.setFilePath(GenUtils.concatFilePath(parentFilePath, filename));",
        "// Line_Reference 147: \t\t\t\tString content = templateEngineDelegator.render(engineTypeEnum, templateFile.getContent(), context);",
        "// Line_Reference 148: \t\t\t\tfileEntry.setContent(content);",
        "// Line_Reference 151: \t\t\t\tString currentPath = GenUtils.evaluateRealPath(templateFile.getFilename(), context);"
    ]
}
