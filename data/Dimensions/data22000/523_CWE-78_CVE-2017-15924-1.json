{
    "cve_id": "CVE-2017-15924",
    "cve_description": "In manager.c in ss-manager in shadowsocks-libev 3.1.0, improper parsing allows command injection via shell metacharacters in a JSON configuration request received via 127.0.0.1 UDP traffic, related to the add_server, build_config, and construct_command_line functions.",
    "cve_publish_date": "2017-10-27",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Fix #1734",
    "type_of_change": "Modification",
    "filename_of_changes": "manager.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 95: build_config(char *prefix, struct server *server)",
        "// Line_Reference 113:     if (server->fast_open[0]) fprintf(f, \",\\n\\\"fast_open\\\": %s\", server->fast_open);",
        "// Line_Reference 114:     if (server->mode)   fprintf(f, \",\\n\\\"mode\\\":\\\"%s\\\"\", server->mode);",
        "// Line_Reference 115:     if (server->method) fprintf(f, \",\\n\\\"method\\\":\\\"%s\\\"\", server->method);",
        "// Line_Reference 116:     if (server->plugin) fprintf(f, \",\\n\\\"plugin\\\":\\\"%s\\\"\", server->plugin);",
        "// Line_Reference 117:     if (server->plugin_opts) fprintf(f, \",\\n\\\"plugin_opts\\\":\\\"%s\\\"\", server->plugin_opts);",
        "// Line_Reference 127:     char *method = manager->method;",
        "// Line_Reference 130:     build_config(working_dir, server);",
        "// Line_Reference 132:     if (server->method) method = server->method;",
        "// Line_Reference 135:              \"%s -m %s --manager-address %s -f %s/.shadowsocks_%s.pid -c %s/.shadowsocks_%s.conf\",",
        "// Line_Reference 136:              executable, method, manager->manager_address,",
        "// Line_Reference 137:              working_dir, server->port, working_dir, server->port);"
    ]
}
