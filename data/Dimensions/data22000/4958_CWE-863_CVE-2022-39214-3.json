{
    "cve_id": "CVE-2022-39214",
    "cve_description": "Combodo iTop is an open source, web-based IT service management platform. Prior to versions 2.7.8 and 3.0.2-1, a user who can log in on iTop is able to take over any account just by knowing the account's username. This issue is fixed in versions 2.7.8 and 3.0.2-1.",
    "cve_publish_date": "2023-03-14",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "NÂ°5394 - use session for the FSM",
    "type_of_change": "Modification",
    "filename_of_changes": "loginform.class.inc.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 85: \t\t\tif (isset($_SESSION['auth_user']))",
        "// Line_Reference 86: \t\t\t{",
        "// Line_Reference 87: \t\t\t\t// If FSM reenter this state (example 2FA) then the auth_user is not resubmitted",
        "// Line_Reference 88: \t\t\t\t$sAuthUser = $_SESSION['auth_user'];",
        "// Line_Reference 89: \t\t\t}",
        "// Line_Reference 90: \t\t\telse",
        "// Line_Reference 91: \t\t\t{",
        "// Line_Reference 92: \t\t\t\t$sAuthUser = utils::ReadPostedParam('auth_user', '', 'raw_data');",
        "// Line_Reference 93: \t\t\t}"
    ]
}
