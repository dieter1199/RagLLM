{
    "cve_id": "CVE-2015-10084",
    "cve_description": "A vulnerability was found in irontec klear-library chloe and classified as critical. Affected by this issue is the function _prepareWhere of the file Controller/Rest/BaseController.php. The manipulation leads to sql injection. Upgrading to version marla is able to address this issue. The name of the patch is b25262de52fdaffde2a4434fc2a84408b304fbc5. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-221504.",
    "cve_publish_date": "2023-02-21",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fix sql injection && Permitir la ejecución de sentencias sql complejas predefinidas en controladores REST vía Zend_Db_Expr",
    "type_of_change": "Modification",
    "filename_of_changes": "BaseController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "56",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 386:             if (is_scalar($val)) {",
        "// Line_Reference 392: ",
        "// Line_Reference 393:         if (empty($itemsSearch)) {",
        "// Line_Reference 394:             return '';",
        "// Line_Reference 395:         }",
        "// Line_Reference 396:         return implode(\" AND \", $itemsSearch);",
        "// Line_Reference 397:     }",
        "// Line_Reference 416:                 $values = $this->_cleanArray($val);",
        "// Line_Reference 420: ",
        "// Line_Reference 421:                 $values = $this->_cleanArray($val);",
        "// Line_Reference 425: ",
        "// Line_Reference 426:                 $values = $this->_cleanArray($val);",
        "// Line_Reference 430: ",
        "// Line_Reference 431:                 $key = $dbAdapter->quoteIdentifier($key) . \" like '%?%'\";",
        "// Line_Reference 432:                 return $dbAdapter->quoteInto($key, $val);",
        "// Line_Reference 436:                 $key = $dbAdapter->quoteIdentifier($key) . \" not like '%?%'\";",
        "// Line_Reference 437:                 return $dbAdapter->quoteInto($key, $val);",
        "// Line_Reference 440: "
    ]
}
