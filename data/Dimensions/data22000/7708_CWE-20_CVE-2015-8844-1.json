{
    "cve_id": "CVE-2015-8844",
    "cve_description": "The signal implementation in the Linux kernel before 4.3.5 on powerpc platforms does not check for an MSR with both the S and T bits set, which allows local users to cause a denial of service (TM Bad Thing exception and panic) via a crafted application.",
    "cve_publish_date": "2016-04-27",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "powerpc/tm: Block signal return setting invalid MSR state\n\nCurrently we allow both the MSR T and S bits to be set by userspace on\na signal return.  Unfortunately this is a reserved configuration and\nwill cause a TM Bad Thing exception if attempted (via rfid).\n\nThis patch checks for this case in both the 32 and 64 bit signals\ncode.  If both T and S are set, we mark the context as invalid.\n\nFound using a syscall fuzzer.\n\nFixes: 2b0a576d15e0 (\"powerpc: Add new transactional memory state to the signal context\")\nCc: stable@vger.kernel.org # v3.9+\nSigned-off-by: Michael Neuling <mikey@neuling.org>\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>",
    "type_of_change": "Modification",
    "filename_of_changes": "signal_32.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 887: \t/* Get the top half of the MSR */",
        "// Line_Reference 888: \tif (__get_user(msr_hi, &tm_sr->mc_gregs[PT_MSR]))",
        "// Line_Reference 889: \t\treturn 1;",
        "// Line_Reference 890: \t/* Pull in MSR TM from user context */",
        "// Line_Reference 891: \tregs->msr = (regs->msr & ~MSR_TS_MASK) | ((msr_hi<<32) & MSR_TS_MASK);"
    ]
}
