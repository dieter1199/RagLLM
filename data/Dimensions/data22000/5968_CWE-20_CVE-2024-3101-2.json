{
    "cve_id": "CVE-2024-3101",
    "cve_description": "In mintplex-labs/anything-llm, an improper input validation vulnerability allows attackers to escalate privileges by deactivating 'Multi-User Mode'. By sending a specially crafted curl request with the 'multi_user_mode' parameter set to false, an attacker can deactivate 'Multi-User Mode'. This action permits the creation of a new admin user without requiring a password, leading to unauthorized administrative access.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Patch ability to update multi-user-flag once set (#993)\n\n* Patch ability to update multi-user-flag once set\r\n\r\n* update logo function to safe update key values",
    "type_of_change": "Modification",
    "filename_of_changes": "systemSettings.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 9:     \"multi_user_mode\",",
        "// Line_Reference 292:       const updatePromises = Object.keys(updates)",
        "// Line_Reference 293:         .filter((key) => this.supportedFields.includes(key))",
        "// Line_Reference 294:         .map((key) => {",
        "// Line_Reference 295:           const validatedValue = this.validations.hasOwnProperty(key)",
        "// Line_Reference 296:             ? this.validations[key](updates[key])",
        "// Line_Reference 297:             : updates[key];",
        "// Line_Reference 298: ",
        "// Line_Reference 299:           return prisma.system_settings.upsert({",
        "// Line_Reference 300:             where: { label: key },",
        "// Line_Reference 301:             update: {",
        "// Line_Reference 302:               value: validatedValue === null ? null : String(validatedValue),",
        "// Line_Reference 303:             },",
        "// Line_Reference 304:             create: {",
        "// Line_Reference 305:               label: key,",
        "// Line_Reference 306:               value: validatedValue === null ? null : String(validatedValue),",
        "// Line_Reference 307:             },",
        "// Line_Reference 308:           });"
    ]
}
