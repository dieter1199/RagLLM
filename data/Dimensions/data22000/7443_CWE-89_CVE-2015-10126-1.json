{
    "cve_id": "CVE-2015-10126",
    "cve_description": "A vulnerability classified as critical was found in Easy2Map Photos Plugin 1.0.1 on WordPress. This vulnerability affects unknown code. The manipulation leads to sql injection. The attack can be initiated remotely. Upgrading to version 1.1.0 is able to address this issue. The patch is identified as 503d9ee2482d27c065f78d9546f076a406189908. It is recommended to upgrade the affected component. VDB-241318 is the identifier assigned to this vulnerability.",
    "cve_publish_date": "2023-10-06",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "tested up to v 4.2.2 and SQL vulnerability plugged\n\ngit-svn-id: https://plugins.svn.wordpress.org/easy2map-photos/trunk@1193098 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "filename_of_changes": "functions.imgmap.admin.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "115",
    "number_of_lines_deleted_vulnerable_to_cve": "36",
    "vulnerable_lines": [
        "// Line_Reference 14:         var templateID = parseInt(jQuery(\"#MapTemplateName\").val());",
        "// Line_Reference 15:         var proVersion = !!jQuery(\"#photoSize\").attr(\"proVersion\");",
        "// Line_Reference 17:         for (var t = 0; t < $arrTemplates.length; t++) {",
        "// Line_Reference 19:             var template = $arrTemplates[t];",
        "// Line_Reference 21:             if (parseInt(template.ID) == templateID) {",
        "// Line_Reference 23:                 jQuery('#divPreview').html(replaceAll(template.TemplateHTML, '[siteurl]', $pluginsURL));",
        "// Line_Reference 24:                 if (proVersion === true)",
        "// Line_Reference 25:                     jQuery('#easy2mapphotologo').remove();",
        "// Line_Reference 27:                 jQuery('[id ^= styleElement]').each(function() {",
        "// Line_Reference 28:                     jQuery('#divMapParent').css(replaceAll(jQuery(this).attr('item'), \"_\", \"-\"), jQuery(this).attr('value'));",
        "// Line_Reference 29:                 });",
        "// Line_Reference 31:                 jQuery('[id ^= stylePhotoElement]').each(function() {",
        "// Line_Reference 33:                     if (jQuery(this).attr('item') === \"width\") {",
        "// Line_Reference 34:                         jQuery('#divMapParent').css(\"width\", jQuery(this).attr('value'));",
        "// Line_Reference 35:                         jQuery('#easy2mapmainimage').css(\"width\", '');",
        "// Line_Reference 37:                     } else {",
        "// Line_Reference 38:                         jQuery('#easy2mapmainimage').css(replaceAll(jQuery(this).attr('item'), \"_\", \"-\"), jQuery(this).attr('value'));",
        "// Line_Reference 39:                     }",
        "// Line_Reference 40:                 });",
        "// Line_Reference 42:                 jQuery('[id ^= styleMapElement]').each(function() {",
        "// Line_Reference 43:                     jQuery('#divMap').css(replaceAll(jQuery(this).attr('item'), \"_\", \"-\"), jQuery(this).attr('value'));",
        "// Line_Reference 44:                 });",
        "// Line_Reference 46:                 jQuery(\"#easy2mapIimgShadow\").width(jQuery(\"#divMapParent\").width());",
        "// Line_Reference 47:                 jQuery(\"#easy2mapIimgShadow\").width(jQuery(\"#divMapParent\").width());",
        "// Line_Reference 48:                 jQuery(\"#easy2mapIimgShadow\").css('marginLeft', jQuery(\"#divMapParent\").css('marginLeft'));",
        "// Line_Reference 49:                 jQuery(\"#easy2mapIimgShadow\").css('marginRight', jQuery(\"#divMapParent\").css('marginRight'));",
        "// Line_Reference 51:             }",
        "// Line_Reference 52:         }",
        "// Line_Reference 54:         //save the map to the database if required to do so",
        "// Line_Reference 55:         if (!!saveMapToDatabase) {",
        "// Line_Reference 56:             easy2map_imgmap_functions.saveMap(false, false);",
        "// Line_Reference 57:         }",
        "// Line_Reference 59:         easy2map_imgmap_functions.displayGoogleMap();",
        "// Line_Reference 61:         google.maps.event.addDomListener(window, 'load', easy2map_imgmappin_functions.retrieveMapPoints());",
        "// Line_Reference 63:     };",
        "// Line_Reference 256: "
    ]
}
