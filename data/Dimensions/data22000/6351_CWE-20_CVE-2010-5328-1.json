{
    "cve_id": "CVE-2010-5328",
    "cve_description": "include/linux/init_task.h in the Linux kernel before 2.6.35 does not prevent signals with a process group ID of zero from reaching the swapper process, which allows local users to cause a denial of service (system crash) by leveraging access to this process group.",
    "cve_publish_date": "2017-02-06",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "pids: init_struct_pid.tasks should never see the swapper process\n\n\"statically initialize struct pid for swapper\" commit 820e45db says:\n\n\tStatically initialize a struct pid for the swapper process (pid_t == 0)\n\tand attach it to init_task.  This is needed so task_pid(), task_pgrp()\n\tand task_session() interfaces work on the swapper process also.\n\nOK, but:\n\n\t- it doesn't make sense to add init_task.pids[].node into\n\t  init_struct_pid.tasks[], and in fact this just wrong.\n\n\t  idle threads are special, they shouldn't be visible on any\n\t  global list. In particular do_each_pid_task(init_struct_pid)\n\t  shouldn't see swapper.\n\n\t  This is the actual reason why kill(0, SIGKILL) from /sbin/init\n\t  (which starts with 0,0 special pids) crashes the kernel. The\n\t  signal sent to pgid/sid == 0 must never see idle threads, even\n\t  if the previous patch fixed the crash itself.\n\n\t- we have other idle threads running on the non-boot CPUs, see\n\t  the next patch.\n\nChange INIT_STRUCT_PID/INIT_PID_LINK to create the empty/unhashed\nhlist_head/hlist_node. Like any other idle thread swapper can never exit,\nso detach_pid()->__hlist_del() is not possible, but we could change\nINIT_PID_LINK() to set pprev = &next if needed.\n\nAll we need is the valid swapper->pids[].pid == &init_struct_pid.\n\nReported-by: Mathias Krause <mathias.krause@secunet.com>\nSigned-off-by: Oleg Nesterov <oleg@redhat.com>\nCc: Cedric Le Goater <clg@fr.ibm.com>\nCc: Dave Hansen <haveblue@us.ibm.com>\nCc: Eric Biederman <ebiederm@xmission.com>\nCc: Herbert Poetzl <herbert@13thfloor.at>\nCc: Mathias Krause <Mathias.Krause@secunet.com>\nAcked-by: Roland McGrath <roland@redhat.com>\nAcked-by: Serge Hallyn <serue@us.ibm.com>\nCc: Sukadev Bhattiprolu <sukadev@us.ibm.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "init_task.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 48: \t\t{ .first = &init_task.pids[PIDTYPE_PID].node },\t\t\\",
        "// Line_Reference 49: \t\t{ .first = &init_task.pids[PIDTYPE_PGID].node },\t\\",
        "// Line_Reference 50: \t\t{ .first = &init_task.pids[PIDTYPE_SID].node },\t\t\\",
        "// Line_Reference 64: \t\t.pprev = &init_struct_pid.tasks[type].first,\t\\"
    ]
}
