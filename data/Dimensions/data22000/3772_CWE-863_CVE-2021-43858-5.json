{
    "cve_id": "CVE-2021-43858",
    "cve_description": "MinIO is a Kubernetes native application for cloud storage. Prior to version `RELEASE.2021-12-27T07-23-18Z`, a malicious client can hand-craft an HTTP API call that allows for updating policy for a user and gaining higher privileges. The patch in version `RELEASE.2021-12-27T07-23-18Z` changes the accepted request body type and removes the ability to apply policy changes through this API. There is a workaround for this vulnerability: Changing passwords can be disabled by adding an explicit `Deny` rule to disable the API for users.",
    "cve_publish_date": "2021-12-27",
    "cwe_id": "CWE-863",
    "cwe_name": "Incorrect Authorization",
    "cwe_description": "The product performs an authorization check when an actor attempts to access a resource or perform an action, but it does not correctly perform the check. This allows attackers to bypass intended access restrictions.",
    "commit_message": "Fix user privilege escalation bug (#13976)\n\nThe AddUser() API endpoint was accepting a policy field. \r\nThis API is used to update a user's secret key and account \r\nstatus, and allows a regular user to update their own secret key. \r\n\r\nThe policy update is also applied though does not appear to \r\nbe used by any existing client-side functionality.\r\n\r\nThis fix changes the accepted request body type and removes \r\nthe ability to apply policy changes as that is possible via the \r\npolicy set API.\r\n\r\nNOTE: Changing passwords can be disabled as a workaround\r\nfor this issue by adding an explicit \"Deny\" rule to disable the API\r\nfor users.",
    "type_of_change": "Modification",
    "filename_of_changes": "iam.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 957: func (sys *IAMSys) CreateUser(ctx context.Context, accessKey string, uinfo madmin.UserInfo) error {",
        "// Line_Reference 970: \tif !auth.IsSecretKeyValid(uinfo.SecretKey) {",
        "// Line_Reference 974: \terr := sys.store.AddUser(ctx, accessKey, uinfo)"
    ]
}
