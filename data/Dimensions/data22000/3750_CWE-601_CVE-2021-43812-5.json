{
    "cve_id": "CVE-2021-43812",
    "cve_description": "The Auth0 Next.js SDK is a library for implementing user authentication in Next.js applications. Versions before 1.6.2 do not filter out certain returnTo parameter values from the login url, which expose the application to an open redirect vulnerability. Users are advised to upgrade as soon as possible. There are no known workarounds for this issue.",
    "cve_publish_date": "2021-12-16",
    "cwe_id": "CWE-601",
    "cwe_name": "URL Redirection to Untrusted Site ('Open Redirect')",
    "cwe_description": "A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",
    "commit_message": "Enforce configured host on user supplied returnTo (#557)\n\n* Enforce configured host on user supplied returnTo\r\n\r\n* Test improvements per PR suggestions",
    "type_of_change": "Modification",
    "filename_of_changes": "url-helpers.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 3:  * @param url",
        "// Line_Reference 5: export default function isSafeRedirect(url: string): boolean {",
        "// Line_Reference 6:   if (typeof url !== 'string') {",
        "// Line_Reference 7:     throw new TypeError(`Invalid url: ${url}`);",
        "// Line_Reference 9: ",
        "// Line_Reference 10:   // Prevent open redirects using the //foo.com format (double forward slash).",
        "// Line_Reference 11:   if (/\\/\\//.test(url)) {",
        "// Line_Reference 12:     return false;",
        "// Line_Reference 14: ",
        "// Line_Reference 15:   return !/^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(url);"
    ]
}
