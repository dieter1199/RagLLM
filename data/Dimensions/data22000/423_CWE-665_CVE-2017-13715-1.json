{
    "cve_id": "CVE-2017-13715",
    "cve_description": "The __skb_flow_dissect function in net/core/flow_dissector.c in the Linux kernel before 4.3 does not ensure that n_proto, ip_proto, and thoff are initialized, which allows remote attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a single crafted MPLS packet.",
    "cve_publish_date": "2017-08-29",
    "cwe_id": "CWE-665",
    "cwe_name": "Improper Initialization",
    "cwe_description": "The product does not initialize or incorrectly initializes a resource, which might leave the resource in an unexpected state when it is accessed or used.",
    "commit_message": "flow_dissector: Jump to exit code in __skb_flow_dissect\n\nInstead of returning immediately (on a parsing failure for instance) we\njump to cleanup code. This always sets protocol values in key_control\n(even on a failure there is still valid information in the key_tags that\nwas set before the problem was hit).\n\nSigned-off-by: Tom Herbert <tom@herbertland.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "flow_dissector.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 174: \t\t\treturn false;",
        "// Line_Reference 200: \t\t\treturn false;",
        "// Line_Reference 237: \t\t\treturn false;",
        "// Line_Reference 259: \t\t\treturn false;",
        "// Line_Reference 268: \t\t\treturn false;",
        "// Line_Reference 278: \t\t\treturn false;",
        "// Line_Reference 279: \t\tkey_basic->n_proto = proto;",
        "// Line_Reference 280: \t\tkey_control->thoff = (u16)nhoff;",
        "// Line_Reference 290: \t\treturn true;",
        "// Line_Reference 300: \t\t\treturn false;",
        "// Line_Reference 313: \t\t\tkey_basic->n_proto = proto;",
        "// Line_Reference 314: \t\t\tkey_basic->ip_proto = ip_proto;",
        "// Line_Reference 315: \t\t\tkey_control->thoff = (u16)nhoff;",
        "// Line_Reference 316: ",
        "// Line_Reference 317: \t\t\treturn true;",
        "// Line_Reference 320: \t\treturn true;",
        "// Line_Reference 327: \t\treturn false;",
        "// Line_Reference 340: \t\t\treturn false;",
        "// Line_Reference 360: \t\t\t\treturn false;",
        "// Line_Reference 381: \t\t\t\treturn false;",
        "// Line_Reference 398: \t\t\treturn false;",
        "// Line_Reference 418: \tkey_basic->n_proto = proto;",
        "// Line_Reference 419: \tkey_basic->ip_proto = ip_proto;",
        "// Line_Reference 420: \tkey_control->thoff = (u16)nhoff;",
        "// Line_Reference 421: ",
        "// Line_Reference 431: \treturn true;"
    ]
}
