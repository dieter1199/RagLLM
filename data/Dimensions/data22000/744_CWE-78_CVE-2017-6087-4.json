{
    "cve_id": "CVE-2017-6087",
    "cve_description": "EyesOfNetwork (\"EON\") 5.0 and earlier allows remote authenticated users to execute arbitrary code via shell metacharacters in the selected_events[] parameter in the (1) acknowledge, (2) delete, or (3) ownDisown function in module/monitoring_ged/ged_functions.php or the (4) module parameter to module/index.php.",
    "cve_publish_date": "2017-03-24",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Fix vulnerabilities",
    "type_of_change": "Modification",
    "filename_of_changes": "function_bp.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "81",
    "number_of_lines_deleted_vulnerable_to_cve": "56",
    "vulnerable_lines": [
        "// Line_Reference 19: \t$bdd = new PDO('mysql:host=localhost;dbname=nagiosbp', 'root', 'root66');",
        "// Line_Reference 76:     $sql = \"delete from bp where name = '\" . $bp . \"'\";",
        "// Line_Reference 77:     $bdd->exec($sql);",
        "// Line_Reference 79: \t$sql = \"delete from bp_services where bp_name = '\" . $bp . \"'\";",
        "// Line_Reference 80:     $bdd->exec($sql);",
        "// Line_Reference 82: \t$sql = \"delete from bp_links where bp_name = '\" . $bp . \"'\";",
        "// Line_Reference 83: \t$bdd->exec($sql);",
        "// Line_Reference 85: \t$sql = \"delete from bp_links where bp_link = '\" . $bp . \"'\";",
        "// Line_Reference 86: \t$bdd->exec($sql);",
        "// Line_Reference 115: \t$sql = \"select name from bp where is_define = 1 and name!='\".$bp.\"' and priority = '\" . $display . \"'\";",
        "// Line_Reference 116: \t$req = $bdd->query($sql);",
        "// Line_Reference 133: \t$sql = \"select service,host from bp_services where bp_name = '\" . $bp . \"'\";",
        "// Line_Reference 134: \t$req = $bdd->query($sql);",
        "// Line_Reference 136: \t$sql = \"delete from bp_services where bp_name = '\" . $bp . \"'\";",
        "// Line_Reference 137: \t$bdd->exec($sql);",
        "// Line_Reference 140: \t\t$sql = \"update bp set is_define = 1 where name = '\" . $bp . \"'\";",
        "// Line_Reference 141: \t\t$bdd->exec($sql);",
        "// Line_Reference 143: ",
        "// Line_Reference 145: \t\t$sql = \"update bp set is_define = 0 where name = '\" . $bp . \"'\";",
        "// Line_Reference 146:         $bdd->exec($sql);",
        "// Line_Reference 155: \t\t\t$sql = \"insert into bp_services (bp_name,host,service) values('\" . trim($bp) . \"','\" . $host . \"','\" . $service . \"')\";",
        "// Line_Reference 156: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 162:     $sql = \"delete from bp_links where bp_name = '\" . $bp . \"'\";",
        "// Line_Reference 163:     $bdd->exec($sql);",
        "// Line_Reference 164: \t$sql = \"update bp set is_define = 0 where name = '\" . $bp . \"'\";",
        "// Line_Reference 165: \t$bdd->exec($sql);",
        "// Line_Reference 168:         $sql = \"update bp set is_define = 1 where name = '\" . $bp . \"'\";",
        "// Line_Reference 169:         $bdd->exec($sql);",
        "// Line_Reference 175: \t\t\t$sql = \"insert into bp_links (bp_name,bp_link) values('\" . $bp . \"','\" . $bp_link . \"')\";",
        "// Line_Reference 177: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 184: \t$sql = \"select count(*) from bp where name = '\" . $uniq_name . \"';\";",
        "// Line_Reference 185: \t$req = $bdd->query($sql);",
        "// Line_Reference 199: \t$sql = \"select count(*) from bp where name = '\" . $uniq_name . \"';\";",
        "// Line_Reference 200: \t$req = $bdd->query($sql);",
        "// Line_Reference 205: \t\t$sql = \"insert into bp (name,description,priority,type,command,url,min_value) values('\" . $uniq_name .\"','\" . $process_name .\"','\" . $display . \"','\" . $type . \"','\" . $command . \"','\" . $url . \"','\" . $min_value . \"')\";",
        "// Line_Reference 206: \t\t$bdd->exec($sql);",
        "// Line_Reference 213: \t\t\t$sql = \"update bp set name = '\" . $uniq_name . \"',description = '\" . $process_name . \"',priority = '\" . $display . \"',type = '\" . $type . \"',command = '\" . $command . \"',url = '\" . $url . \"',min_value = '\" . $min_value . \"' where name = '\" . $uniq_name_orig . \"'\";",
        "// Line_Reference 214: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 215: \t\t\t$sql = \"update bp_links set bp_name = '\" . $uniq_name . \"' where bp_name = '\" . $uniq_name_orig . \"'\";",
        "// Line_Reference 216: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 217: \t\t\t$sql = \"update bp_links set bp_link = '\" . $uniq_name . \"' where bp_link = '\" . $uniq_name_orig . \"'\";",
        "// Line_Reference 218: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 219: \t\t\t$sql = \"update bp_services set bp_name = '\" . $uniq_name . \"' where bp_name = '\" . $uniq_name_orig . \"'\";",
        "// Line_Reference 220: \t\t\t$bdd->exec($sql);",
        "// Line_Reference 225: \t\t$sql = \"update bp set name = '\" . $uniq_name . \"',description = '\" . $process_name . \"',priority = '\" . $display . \"',type = '\" . $type . \"',command = '\" . $command . \"',url = '\" . $url . \"',min_value = '\" . $min_value . \"' where name = '\" . $uniq_name . \"'\";",
        "// Line_Reference 226: \t\t$bdd->exec($sql);",
        "// Line_Reference 255: \t$sql = \"SELECT bp_link FROM bp_links where bp_name='\".$bp_informations['name'].\"'\";",
        "// Line_Reference 256: \t$req = $bdd->query($sql);",
        "// Line_Reference 263: \t\t\t$sql = \"SELECT * FROM bp where is_define ='1' and name='\".$bp_link[\"bp_link\"].\"'\";",
        "// Line_Reference 264: \t\t\t$req = $bdd->query($sql);",
        "// Line_Reference 290: \t$sql = \"select host,service from bp_services where bp_name = '\" . $bp_informations['name'] . \"'\";",
        "// Line_Reference 291: \t$req = $bdd->query($sql);",
        "// Line_Reference 306: \t$sql = \"select bp_link from bp_links where bp_name = '\" .$bp_informations['name'] . \"'\";",
        "// Line_Reference 307: \t$req = $bdd->query($sql);",
        "// Line_Reference 336: \t$sql = \"select * from bp where name = '\" . $bp_name . \"'\";",
        "// Line_Reference 337: \t$req = $bdd->query($sql);"
    ]
}
