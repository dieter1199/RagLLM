{
    "cve_id": "CVE-2014-7842",
    "cve_description": "Race condition in arch/x86/kvm/x86.c in the Linux kernel before 3.17.4 allows guest OS users to cause a denial of service (guest OS crash) via a crafted application that performs an MMIO transaction or a PIO transaction to trigger a guest userspace emulation error report, a similar issue to CVE-2010-5313.",
    "cve_publish_date": "2014-11-30",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "KVM: x86: Don't report guest userspace emulation error to userspace\n\nCommit fc3a9157d314 (\"KVM: X86: Don't report L2 emulation failures to\nuser-space\") disabled the reporting of L2 (nested guest) emulation failures to\nuserspace due to race-condition between a vmexit and the instruction emulator.\nThe same rational applies also to userspace applications that are permitted by\nthe guest OS to access MMIO area or perform PIO.\n\nThis patch extends the current behavior - of injecting a #UD instead of\nreporting it to userspace - also for guest userspace code.\n\nSigned-off-by: Nadav Amit <namit@cs.technion.ac.il>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "x86.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 5003: \tif (!is_guest_mode(vcpu)) {"
    ]
}
