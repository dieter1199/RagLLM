{
    "cve_id": "CVE-2017-6436",
    "cve_description": "The parse_string_node function in bplist.c in libimobiledevice libplist 1.12 allows local users to cause a denial of service (memory allocation error) via a crafted plist file.",
    "cve_publish_date": "2017-03-15",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "bplist: Fix data range check for string/data/dict/array nodes\n\nPassing a size of 0xFFFFFFFFFFFFFFFF to parse_string_node() might result\nin a memcpy with a size of -1, leading to undefined behavior.\nThis commit makes sure that the actual node data (which depends on the size)\nis in the range start_of_object..start_of_object+size.\n\nCredit to OSS-Fuzz",
    "type_of_change": "Modification",
    "filename_of_changes": "bplist.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "6",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 657:         if (*object + size > bplist->offset_table) {",
        "// Line_Reference 664:         if (*object + size > bplist->offset_table) {",
        "// Line_Reference 675:         if (*object + size*2 > bplist->offset_table) {",
        "// Line_Reference 683:         if (*object + size > bplist->offset_table) {",
        "// Line_Reference 697:         if (*object + size > bplist->offset_table) {",
        "// Line_Reference 698:             PLIST_BIN_ERR(\"%s: BPLIST_REAL data bytes point outside of valid range\\n\", __func__);"
    ]
}
