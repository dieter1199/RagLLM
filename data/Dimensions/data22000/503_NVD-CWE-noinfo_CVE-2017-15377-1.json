{
    "cve_id": "CVE-2017-15377",
    "cve_description": "In Suricata before 4.x, it was possible to trigger lots of redundant checks on the content of crafted network traffic with a certain signature, because of DetectEngineContentInspection in detect-engine-content-inspection.c. The search engine doesn't stop when it should after no match is found; instead, it stops only upon reaching inspection-recursion-limit (3000 by default).",
    "cve_publish_date": "2017-10-23",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "detect: avoid needless recursive scanning\n\nDon't recursively inspect a detect list if the recursion\ndoesn't increase chance of success.",
    "type_of_change": "Modification",
    "filename_of_changes": "detect-engine-content-inspection.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "21",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 1: /* Copyright (C) 2007-2011 Open Information Security Foundation",
        "// Line_Reference 313:                 if (!(cd->flags & DETECT_CONTENT_RELATIVE_NEXT)) {",
        "// Line_Reference 314:                     SCLogDebug(\"no relative match coming up, so this is a match\");",
        "// Line_Reference 315:                     goto match;",
        "// Line_Reference 316:                 }",
        "// Line_Reference 318:                 /* bail out if we have no next match. Technically this is an",
        "// Line_Reference 319:                  * error, as the current cd has the DETECT_CONTENT_RELATIVE_NEXT",
        "// Line_Reference 320:                  * flag set. */",
        "// Line_Reference 322:                     goto no_match;",
        "// Line_Reference 337:                 if (det_ctx->discontinue_matching)"
    ]
}
