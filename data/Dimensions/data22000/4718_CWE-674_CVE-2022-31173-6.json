{
    "cve_id": "CVE-2022-31173",
    "cve_description": "Juniper is a GraphQL server library for Rust. Affected versions of Juniper are vulnerable to uncontrolled recursion resulting in a program crash. This issue has been addressed in version 0.15.10. Users are advised to upgrade. Users unable to upgrade should limit the recursion depth manually.",
    "cve_publish_date": "2022-08-01",
    "cwe_id": "CWE-674",
    "cwe_name": "Uncontrolled Recursion",
    "cwe_description": "The product does not properly control the amount of recursion that takes place,  consuming excessive resources, such as allocated memory or the program stack.",
    "commit_message": "Backport CVE-2022-31173 fix from GHSA-4rx6-g5vg-5f3j\n\nCo-authored-by: ilslv <ilya.solovyiov@gmail.com>",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "variables_in_allowed_position.rs",
    "code_language": "Rust",
    "number_of_lines_added_for_mitigation": "42",
    "number_of_lines_deleted_vulnerable_to_cve": "15",
    "vulnerable_lines": [
        "// Line_Reference 20: pub struct VariableInAllowedPosition<'a, S: Debug + 'a> {",
        "// Line_Reference 21:     spreads: HashMap<Scope<'a>, HashSet<&'a str>>,",
        "// Line_Reference 22:     variable_usages: HashMap<Scope<'a>, Vec<(Spanning<&'a String>, Type<'a>)>>,",
        "// Line_Reference 23:     variable_defs: HashMap<Scope<'a>, Vec<&'a (Spanning<&'a str>, VariableDefinition<'a, S>)>>,",
        "// Line_Reference 24:     current_scope: Option<Scope<'a>>,",
        "// Line_Reference 25: }",
        "// Line_Reference 26: ",
        "// Line_Reference 37:     fn collect_incorrect_usages(",
        "// Line_Reference 38:         &self,",
        "// Line_Reference 45:             return;",
        "// Line_Reference 78:         if let Some(spreads) = self.spreads.get(from) {",
        "// Line_Reference 79:             for spread in spreads {",
        "// Line_Reference 80:                 self.collect_incorrect_usages(&Scope::Fragment(spread), var_defs, ctx, visited);",
        "// Line_Reference 81:             }",
        "// Line_Reference 82:         }"
    ]
}
