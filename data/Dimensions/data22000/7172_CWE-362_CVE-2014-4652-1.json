{
    "cve_id": "CVE-2014-4652",
    "cve_description": "Race condition in the tlv handler functionality in the snd_ctl_elem_user_tlv function in sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 allows local users to obtain sensitive information from kernel memory by leveraging /dev/snd/controlCX access.",
    "cve_publish_date": "2014-07-03",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "ALSA: control: Protect user controls against concurrent access\n\nThe user-control put and get handlers as well as the tlv do not protect against\nconcurrent access from multiple threads. Since the state of the control is not\nupdated atomically it is possible that either two write operations or a write\nand a read operation race against each other. Both can lead to arbitrary memory\ndisclosure. This patch introduces a new lock that protects user-controls from\nconcurrent access. Since applications typically access controls sequentially\nthan in parallel a single lock per card should be fine.\n\nSigned-off-by: Lars-Peter Clausen <lars@metafoo.de>\nAcked-by: Jaroslav Kysela <perex@perex.cz>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
    "type_of_change": "Modification",
    "filename_of_changes": "control.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1046: ",
        "// Line_Reference 1076: \t\tif (! ue->tlv_data_size || ! ue->tlv_data)",
        "// Line_Reference 1077: \t\t\treturn -ENXIO;",
        "// Line_Reference 1078: \t\tif (size < ue->tlv_data_size)",
        "// Line_Reference 1079: \t\t\treturn -ENOSPC;",
        "// Line_Reference 1081: \t\t\treturn -EFAULT;"
    ]
}
