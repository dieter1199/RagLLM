{
    "cve_id": "CVE-2017-6347",
    "cve_description": "The ip_cmsg_recv_checksum function in net/ipv4/ip_sockglue.c in the Linux kernel before 4.10.1 has incorrect expectations about skb data layout, which allows local users to cause a denial of service (buffer over-read) or possibly have unspecified other impact via crafted system calls, as demonstrated by use of the MSG_MORE flag in conjunction with loopback UDP transmission.",
    "cve_publish_date": "2017-03-01",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "ip: fix IP_CHECKSUM handling\n\nThe skbs processed by ip_cmsg_recv() are not guaranteed to\nbe linear e.g. when sending UDP packets over loopback with\nMSGMORE.\nUsing csum_partial() on [potentially] the whole skb len\nis dangerous; instead be on the safe side and use skb_checksum().\n\nThanks to syzkaller team to detect the issue and provide the\nreproducer.\n\nv1 -> v2:\n - move the variable declaration in a tighter scope\n\nFixes: ad6f939ab193 (\"ip: Add offset parameter to ip_cmsg_recv\")\nReported-by: Andrey Konovalov <andreyknvl@google.com>\nSigned-off-by: Paolo Abeni <pabeni@redhat.com>\nAcked-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "ip_sockglue.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 119: \tif (offset != 0)",
        "// Line_Reference 120: \t\tcsum = csum_sub(csum,",
        "// Line_Reference 121: \t\t\t\tcsum_partial(skb_transport_header(skb) + tlen,",
        "// Line_Reference 122: \t\t\t\t\t     offset, 0));"
    ]
}
