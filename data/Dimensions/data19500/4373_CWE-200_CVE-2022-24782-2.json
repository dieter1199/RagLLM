{
    "cve_id": "CVE-2022-24782",
    "cve_description": "Discourse is an open source discussion platform. Versions 2.8.2 and prior in the `stable` branch, 2.9.0.beta3 and prior in the `beta` branch, and 2.9.0.beta3 and prior in the `tests-passed` branch are vulnerable to a data leak. Users can request an export of their own activity. Sometimes, due to category settings, they may have category membership for a secure category. The name of this secure category is shown to the user in the export. The same thing occurs when the user's post has been moved to a secure category. A patch for this issue is available in the `main` branch of Discourse's GitHub repository and is anticipated to be part of future releases.",
    "cve_publish_date": "2022-03-24",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "SECURITY: Hide private categories in user activity export (#16273)\n\nIn some of the user's own activity export data,\r\nwe sometimes showed a secure category's name or\r\nexposed the existence of a secure category.",
    "type_of_change": "Modification",
    "filename_of_changes": "export_user_archive_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 18:   fab!(:category) { Fabricate(:category_with_definition) }",
        "// Line_Reference 317:     let(:subsubcategory) { Fabricate(:category_with_definition, parent_category_id: subcategory.id) }",
        "// Line_Reference 318:     let(:announcements) { Fabricate(:category_with_definition) }",
        "// Line_Reference 319:     let(:deleted_category) { Fabricate(:category) }",
        "// Line_Reference 344:     it 'correctly exports the CategoryUser table' do",
        "// Line_Reference 347:       expect(data.find { |r| r['category_id'] == category.id }).to be_nil",
        "// Line_Reference 348:       expect(data.length).to eq(4)",
        "// Line_Reference 365:       expect(data[3][:category_names]).to eq(data[3][:category_id])"
    ]
}
