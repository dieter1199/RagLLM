{
    "cve_id": "CVE-2011-4112",
    "cve_description": "The net subsystem in the Linux kernel before 3.1 does not properly restrict use of the IFF_TX_SKB_SHARING flag, which allows local users to cause a denial of service (panic) by leveraging the CAP_NET_ADMIN capability to access /proc/net/pktgen/pgctrl, and then using the pktgen package in conjunction with a bridge device for a VLAN interface.",
    "cve_publish_date": "2012-05-17",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "net: Audit drivers to identify those needing IFF_TX_SKB_SHARING cleared\n\nAfter the last patch, We are left in a state in which only drivers calling\nether_setup have IFF_TX_SKB_SHARING set (we assume that drivers touching real\nhardware call ether_setup for their net_devices and don't hold any state in\ntheir skbs.  There are a handful of drivers that violate this assumption of\ncourse, and need to be fixed up.  This patch identifies those drivers, and marks\nthem as not being able to support the safe transmission of skbs by clearning the\nIFF_TX_SKB_SHARING flag in priv_flags\n\nSigned-off-by: Neil Horman <nhorman@tuxdriver.com>\nCC: Karsten Keil <isdn@linux-pingi.de>\nCC: \"David S. Miller\" <davem@davemloft.net>\nCC: Jay Vosburgh <fubar@us.ibm.com>\nCC: Andy Gospodarek <andy@greyhouse.net>\nCC: Patrick McHardy <kaber@trash.net>\nCC: Krzysztof Halasa <khc@pm.waw.pl>\nCC: \"John W. Linville\" <linville@tuxdriver.com>\nCC: Greg Kroah-Hartman <gregkh@suse.de>\nCC: Marcel Holtmann <marcel@holtmann.org>\nCC: Johannes Berg <johannes@sipsolutions.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "vlan_dev.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 698: \tdev->priv_flags\t\t&= ~IFF_XMIT_DST_RELEASE;"
    ]
}
