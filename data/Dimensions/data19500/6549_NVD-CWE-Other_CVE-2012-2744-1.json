{
    "cve_id": "CVE-2012-2744",
    "cve_description": "net/ipv6/netfilter/nf_conntrack_reasm.c in the Linux kernel before 2.6.34, when the nf_conntrack_ipv6 module is enabled, allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) via certain types of fragmented IPv6 packets.",
    "cve_publish_date": "2012-08-09",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "netfilter: nf_conntrack_reasm: properly handle packets fragmented into a single fragment\n\nWhen an ICMPV6_PKT_TOOBIG message is received with a MTU below 1280,\nall further packets include a fragment header.\n\nUnlike regular defragmentation, conntrack also needs to \"reassemble\"\nthose fragments in order to obtain a packet without the fragment\nheader for connection tracking. Currently nf_conntrack_reasm checks\nwhether a fragment has either IP6_MF set or an offset != 0, which\nmakes it ignore those fragments.\n\nRemove the invalid check and make reassembly handle fragment queues\ncontaining only a single fragment.\n\nReported-and-tested-by: Ulrich Weber <uweber@astaro.com>\nSigned-off-by: Patrick McHardy <kaber@trash.net>",
    "type_of_change": "Modification",
    "filename_of_changes": "nf_conntrack_reasm.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 472: \tif (NFCT_FRAG6_CB(fp)->orig == NULL)",
        "// Line_Reference 598: \tif (!(fhdr->frag_off & htons(0xFFF9))) {",
        "// Line_Reference 599: \t\tpr_debug(\"Invalid fragment offset\\n\");",
        "// Line_Reference 600: \t\t/* It is not a fragmented frame */",
        "// Line_Reference 601: \t\tgoto ret_orig;",
        "// Line_Reference 602: \t}",
        "// Line_Reference 603: "
    ]
}
