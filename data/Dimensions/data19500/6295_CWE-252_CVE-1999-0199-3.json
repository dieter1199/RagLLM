{
    "cve_id": "CVE-1999-0199",
    "cve_description": "manual/search.texi in the GNU C Library (aka glibc) before 2.2 lacks a statement about the unspecified tdelete return value upon deletion of a tree's root, which might allow attackers to access a dangling pointer in an application whose developer was unaware of a documentation update from 1999.",
    "cve_publish_date": "2020-10-06",
    "cwe_id": "CWE-252",
    "cwe_name": "Unchecked Return Value",
    "cwe_description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",
    "commit_message": "Update.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* elf/dl-load.c (_dl_dst_count): Allow $ORIGIN to point to\n\tdirectory with the reference since this is as secure as using the\n\tobject with the dependency.\n\t(_dl_dst_substitute): Likewise.\n\n\t* elf/dl-load.c (_dl_dst_count): Change strings in first two\n\tstrncmp calls to allow reuse.\n\t(_dl_dst_substitute): Likewise.\n\n1999-11-01  Arnold D. Robbins  <arnold@skeeve.com>\n\n\t* posix/regex.c (init_syntax_once): move below definition of\n\tISALNUM etc., then use ISALNUM to init the table, so that\n\tthe word ops will work if i18n'ed.\n\t(SYNTAX): And subscript with 0xFF for 8bit character sets.\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* sysdeps/unix/getlogin_r.c (getlogin_r): Sync with getlogin\n\timplementation for ttyname_r call; fix inverted condition; return\n\tut_user.  Closes PR libc/1438.\n\n1999-11-09  Ulrich Drepper  <drepper@cygnus.com>\n\n\t* timezone/checktab.awk: Update from tzcode1999h.\n\t* timezone/africa: Update from tzdata1999i.\n\t* timezone/asia: Likewise.\n\t* timezone/australasia: Likewise.\n\t* timezone/backward: Likewise.\n\t* timezone/europe: Likewise.\n\t* timezone/northamerica: Likewise.\n\t* timezone/southamerica: Likewise.\n\t* timezone/iso3166.tab: Likewise.\n\t* timezone/zone.tab: Likewise.\n\n\t* sysdeps/unix/sysv/linux/bits/resource.h: Define values also as\n\tmacros.  Patch by brg@csua.berkeley.edu [PR libc/1439].\n\n1999-11-09  Andreas Jaeger  <aj@suse.de>\n\n\t* posix/Makefile (tests): Added tst-getlogin.\n\n\t* posix/tst-getlogin.c: New file, contains simple tests for\n\tgetlogin and getlogin_r.\n\n1999-11-09  Andreas Schwab  <schwab@suse.de>\n\n\t* misc/syslog.c: For LOG_PERROR only append a newline if\n\tnecessary.",
    "type_of_change": "Modification",
    "filename_of_changes": "regex.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "40",
    "vulnerable_lines": [
        "// Line_Reference 167: /* How many characters in the character set.  */",
        "// Line_Reference 168: # define CHAR_SET_SIZE 256",
        "// Line_Reference 169: ",
        "// Line_Reference 170: # ifdef SYNTAX_TABLE",
        "// Line_Reference 171: ",
        "// Line_Reference 172: extern char *re_syntax_table;",
        "// Line_Reference 173: ",
        "// Line_Reference 174: # else /* not SYNTAX_TABLE */",
        "// Line_Reference 175: ",
        "// Line_Reference 176: static char re_syntax_table[CHAR_SET_SIZE];",
        "// Line_Reference 177: ",
        "// Line_Reference 178: static void",
        "// Line_Reference 179: init_syntax_once ()",
        "// Line_Reference 180: {",
        "// Line_Reference 181:    register int c;",
        "// Line_Reference 182:    static int done;",
        "// Line_Reference 183: ",
        "// Line_Reference 184:    if (done)",
        "// Line_Reference 185:      return;",
        "// Line_Reference 186: ",
        "// Line_Reference 187:    bzero (re_syntax_table, sizeof re_syntax_table);",
        "// Line_Reference 188: ",
        "// Line_Reference 189:    for (c = 'a'; c <= 'z'; c++)",
        "// Line_Reference 190:      re_syntax_table[c] = Sword;",
        "// Line_Reference 191: ",
        "// Line_Reference 192:    for (c = 'A'; c <= 'Z'; c++)",
        "// Line_Reference 193:      re_syntax_table[c] = Sword;",
        "// Line_Reference 194: ",
        "// Line_Reference 195:    for (c = '0'; c <= '9'; c++)",
        "// Line_Reference 196:      re_syntax_table[c] = Sword;",
        "// Line_Reference 197: ",
        "// Line_Reference 198:    re_syntax_table['_'] = Sword;",
        "// Line_Reference 199: ",
        "// Line_Reference 200:    done = 1;",
        "// Line_Reference 201: }",
        "// Line_Reference 202: ",
        "// Line_Reference 203: # endif /* not SYNTAX_TABLE */",
        "// Line_Reference 204: ",
        "// Line_Reference 205: # define SYNTAX(c) re_syntax_table[c]",
        "// Line_Reference 206: "
    ]
}
