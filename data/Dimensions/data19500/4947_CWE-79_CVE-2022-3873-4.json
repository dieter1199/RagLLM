{
    "cve_id": "CVE-2022-3873",
    "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository jgraph/drawio prior to 20.5.2.",
    "cve_publish_date": "2022-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.5.2 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Editor.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "45",
    "number_of_lines_deleted_vulnerable_to_cve": "68",
    "vulnerable_lines": [
        "// Line_Reference 141: Editor.shapesImage = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIGZpbGw9IiMwMDAwMDAiPjxnPjxwYXRoIGQ9Ik0wLDBoMjR2MjRIMFYweiIgZmlsbD0ibm9uZSIvPjwvZz48Zz48Zz48cGF0aCBkPSJNMywxMWg4VjNIM1YxMXogTTUsNWg0djRINVY1eiIvPjxwYXRoIGQ9Ik0xMywzdjhoOFYzSDEzeiBNMTksOWgtNFY1aDRWOXoiLz48cGF0aCBkPSJNMywyMWg4di04SDNWMjF6IE01LDE1aDR2NEg1VjE1eiIvPjxwb2x5Z29uIHBvaW50cz0iMTgsMTMgMTYsMTMgMTYsMTYgMTMsMTYgMTMsMTggMTYsMTggMTYsMjEgMTgsMjEgMTgsMTggMjEsMTggMjEsMTYgMTgsMTYiLz48L2c+PC9nPjwvc3ZnPg==';",
        "// Line_Reference 1117: \tif (this.dialogImg != null)",
        "// Line_Reference 1129: \tthis.container.parentNode.removeChild(this.container);",
        "// Line_Reference 1575: \tmxUtils.write(td, mxResources.get('background') + ':');",
        "// Line_Reference 1576: ",
        "// Line_Reference 1581: ",
        "// Line_Reference 1582: \tvar backgroundInput = document.createElement('input');",
        "// Line_Reference 1583: \tbackgroundInput.setAttribute('type', 'text');",
        "// Line_Reference 1584: ",
        "// Line_Reference 1585: \tvar backgroundButton = document.createElement('button');",
        "// Line_Reference 1586: \tbackgroundButton.style.width = '22px';",
        "// Line_Reference 1587: \tbackgroundButton.style.height = '22px';",
        "// Line_Reference 1588: \tbackgroundButton.style.cursor = 'pointer';",
        "// Line_Reference 1589: \tbackgroundButton.style.marginRight = '20px';",
        "// Line_Reference 1590: \tbackgroundButton.style.backgroundPosition = 'center center';",
        "// Line_Reference 1591: \tbackgroundButton.style.backgroundRepeat = 'no-repeat';",
        "// Line_Reference 1593: \tif (mxClient.IS_FF)",
        "// Line_Reference 1594: \t{",
        "// Line_Reference 1595: \t\tbackgroundButton.style.position = 'relative';",
        "// Line_Reference 1596: \t\tbackgroundButton.style.top = '-6px';",
        "// Line_Reference 1597: \t}",
        "// Line_Reference 1598: ",
        "// Line_Reference 1599: \tvar newBackgroundColor = graph.background;",
        "// Line_Reference 1600: ",
        "// Line_Reference 1601: \tfunction updateBackgroundColor()",
        "// Line_Reference 1602: \t{",
        "// Line_Reference 1603: \t\tif (newBackgroundColor == null || newBackgroundColor == mxConstants.NONE)",
        "// Line_Reference 1604: \t\t{",
        "// Line_Reference 1605: \t\t\tbackgroundButton.style.backgroundColor = '';",
        "// Line_Reference 1606: \t\t\tbackgroundButton.style.backgroundImage = 'url(\\'' + Dialog.prototype.noColorImage + '\\')';",
        "// Line_Reference 1607: \t\t}",
        "// Line_Reference 1608: \t\telse",
        "// Line_Reference 1609: \t\t{",
        "// Line_Reference 1610: \t\t\tbackgroundButton.style.backgroundColor = newBackgroundColor;",
        "// Line_Reference 1611: \t\t\tbackgroundButton.style.backgroundImage = '';",
        "// Line_Reference 1612: \t\t}",
        "// Line_Reference 1613: \t};",
        "// Line_Reference 1614: ",
        "// Line_Reference 1615: \tupdateBackgroundColor();",
        "// Line_Reference 1616: ",
        "// Line_Reference 1617: \tmxEvent.addListener(backgroundButton, 'click', function(evt)",
        "// Line_Reference 1618: \t{",
        "// Line_Reference 1619: \t\teditorUi.pickColor(newBackgroundColor || 'none', function(color)",
        "// Line_Reference 1620: \t\t{",
        "// Line_Reference 1621: \t\t\tnewBackgroundColor = color;",
        "// Line_Reference 1622: \t\t\tupdateBackgroundColor();",
        "// Line_Reference 1623: \t\t});",
        "// Line_Reference 1624: \t\tmxEvent.consume(evt);",
        "// Line_Reference 1625: \t});",
        "// Line_Reference 1626: ",
        "// Line_Reference 1627: \ttd.appendChild(backgroundButton);",
        "// Line_Reference 1628: ",
        "// Line_Reference 1629: \tmxUtils.write(td, mxResources.get('gridSize') + ':');",
        "// Line_Reference 1630: ",
        "// Line_Reference 1652: \tmxUtils.write(td, mxResources.get('image') + ':');",
        "// Line_Reference 1662: \tvar imgPreview = document.createElement('img');",
        "// Line_Reference 1663: \timgPreview.setAttribute('valign', 'middle');",
        "// Line_Reference 1668: \timgPreview.style.maxWidth = '100px';",
        "// Line_Reference 1670: \timgPreview.style.height = '60px';",
        "// Line_Reference 1679: \t\tif (img != null && Graph.isPageLink(img.src))",
        "// Line_Reference 1681: \t\t\timg = editorUi.createImageForPageLink(img.src, null);",
        "// Line_Reference 1686: \t\t\timgPreview.setAttribute('src', img.src);",
        "// Line_Reference 1687: \t\t\timgPreview.style.display = '';",
        "// Line_Reference 1691: \t\t\timgPreview.removeAttribute('src');",
        "// Line_Reference 1698: \t\teditorUi.showBackgroundImageDialog(function(image, failed)",
        "// Line_Reference 1703: \t\t\t\tupdateBackgroundImage();",
        "// Line_Reference 1705: \t\t}, newBackgroundImage);",
        "// Line_Reference 2796: \t\t\t\t\tbreaks[i].destroy();"
    ]
}
