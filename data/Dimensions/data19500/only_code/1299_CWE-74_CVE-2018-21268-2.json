const command = (internals.isWin ? 'tracert -d ' : 'traceroute -q 1 -n ') + host;
Child.exec(command, (err, stdout, stderr) => {
if (err) {
return callback(err);
const results = internals.parseOutput(stdout);
return callback(null, results);
internals.parseOutput = function (output) {
const lines = output.split('\n');
const hops = [];
lines.shift();
lines.pop();
if (internals.isWin) {
for (let i = 0; i < lines.length; ++i) {
if (/^\s+1/.test(lines[i])) {
break;
}
}
lines.splice(0,i);
lines.pop();
lines.pop();
}
for (let i = 0; i < lines.length; ++i) {
hops.push(internals.parseHop(lines[i]));
}
return hops;
};
