$langSet = strtolower($request->get($this->config['detect_var']));
$langSet = strtolower($request->header($this->config['header_var']));
$langSet = strtolower($request->cookie($this->config['cookie_var']));
$match = preg_match('/^([a-z\d\-]+)/i', $request->server('HTTP_ACCEPT_LANGUAGE'), $matches);
if ($match) {
$langSet = strtolower($matches[1]);
if (isset($this->config['accept_language'][$langSet])) {
$langSet = $this->config['accept_language'][$langSet];
}
$range = $langSet;
$this->lang->setLangSet($range);
$range = $this->lang->getLangSet();
return $range;