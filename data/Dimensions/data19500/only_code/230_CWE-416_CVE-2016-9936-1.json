if (!php_var_unserialize_ex(return_value, &p, p + buf_len, &var_hash, class_hash)) {
zval_ptr_dtor(return_value);
/* We should keep an reference to return_value to prevent it from being dtor
in case nesting calls to unserialize */
var_push_dtor(&var_hash, return_value);