// Prevent XSS abuse
$variable = preg_replace_callback('#</?([a-z]+)(\s.*)?/?>#i', function($matches) {
$tag = strtolower($matches[1]);
// Allowed tags
if (in_array($tag, array(
'b', 'strong', 'small', 'i', 'em', 'u', 's', 'sub', 'sup', 'a', 'button', 'img', 'br',
'font', 'span', 'blockquote', 'q', 'abbr', 'address', 'code', 'hr',
'audio', 'video', 'source', 'iframe',
'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
'ul', 'ol', 'li', 'dl', 'dt', 'dd',
'div', 'p', 'var',
'table', 'thead', 'tbody', 'tfoot', 'tr', 'th', 'td', 'colgroup', 'col',
'section', 'article', 'aside'))) {
return $matches[0];
} else if (in_array($tag, array('script', 'link'))) {
return '';
} else {
return htmlentities($matches[0]);
}
}, $variable);
