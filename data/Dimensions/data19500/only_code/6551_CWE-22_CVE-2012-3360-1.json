def _inject_file_into_fs(fs, path, contents):
absolute_path = os.path.join(fs, path.lstrip('/'))
utils.execute('tee', absolute_path, process_input=contents,
run_as_root=True)
metadata_path = os.path.join(fs, "meta.js")
utils.execute('tee', metadata_path,
process_input=jsonutils.dumps(metadata), run_as_root=True)
sshdir = os.path.join(fs, 'root', '.ssh')
keyfile = os.path.join(sshdir, 'authorized_keys')
key_data = [
]
utils.execute('tee', '-a', keyfile,
process_input=''.join(key_data), run_as_root=True)
netdir = os.path.join(os.path.join(fs, 'etc'), 'network')
netfile = os.path.join(netdir, 'interfaces')
utils.execute('tee', netfile, process_input=net, run_as_root=True)
utils.execute('cp', os.path.join(fs, 'etc', 'passwd'), tmp_passwd,
run_as_root=True)
utils.execute('cp', os.path.join(fs, 'etc', 'shadow'), tmp_shadow,
run_as_root=True)
utils.execute('cp', tmp_passwd, os.path.join(fs, 'etc', 'passwd'),
run_as_root=True)
utils.execute('cp', tmp_shadow, os.path.join(fs, 'etc', 'shadow'),
run_as_root=True)
