{
    "cve_id": "CVE-2012-5618",
    "cve_description": "Ushahidi before 2.6.1 has insufficient entropy for forgot-password tokens.",
    "cve_publish_date": "2020-02-04",
    "cwe_id": "CWE-640",
    "cwe_name": "Weak Password Recovery Mechanism for Forgotten Password",
    "cwe_description": "The product contains a mechanism for users to recover or change their passwords without knowing the original password, but the mechanism is weak.",
    "commit_message": "Make forgot password tokens use better random token #646\n\nFixes security issue discovered by Timothy D. Morgan <tim.morgan@owasp.org>\nForgotten password challenges were guessable based on users last login\nand email address. Tokens are now generated based on a HMAC of login time\nand email address using a salt and secret key specifically for these\ntokens.",
    "type_of_change": "Modification",
    "filename_of_changes": "login.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "9",
    "vulnerable_lines": [
        "// Line_Reference 323: ",
        "// Line_Reference 324: \t\t\t\t\t\t// Secret consists of email and the last_login field.",
        "// Line_Reference 325: \t\t\t\t\t\t// So as soon as the user logs in again,",
        "// Line_Reference 326: \t\t\t\t\t\t// the reset link expires automatically.",
        "// Line_Reference 327: \t\t\t\t\t\t$secret = $auth->hash_password($user->email.$user->last_login);",
        "// Line_Reference 328: \t\t\t\t\t\t$secret_link = url::site('login/index/'.$user->id.'/'.$secret.'?reset');",
        "// Line_Reference 329: \t\t\t\t\t\t$email_sent = $this->_email_resetlink($post->resetemail,$user->name,$secret_link);",
        "// Line_Reference 873: ",
        "// Line_Reference 874: \t\t\t\tif($auth->hash_password($user->email.$user->last_login, $auth->find_salt($token)) == $token)"
    ]
}
