{
    "cve_id": "CVE-2020-23352",
    "cve_description": "Z-BlogPHP 1.6.0 Valyria is affected by incorrect access control. PHP loose comparison and a magic hash can be used to bypass authentication. zb_user/plugin/passwordvisit/include.php:passwordvisit_input_password() uses loose comparison to authenticate, which can be bypassed via magic hash values.",
    "cve_publish_date": "2021-01-27",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "hash_equals函数添加及其应用;CloseTags函数进行了修正;",
    "type_of_change": "Modification",
    "filename_of_changes": "c_system_common.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "30",
    "vulnerable_lines": [
        "// Line_Reference 1221:     // strip fraction of open or close tag from end (e.g. if we take first x characters, we might cut off a tag at the end!)",
        "// Line_Reference 1222:     $html = preg_replace('/<[^>]*$/', '', $html); // ending with fraction of open tag",
        "// Line_Reference 1223: ",
        "// Line_Reference 1224:     // put open tags into an array",
        "// Line_Reference 1225:     preg_match_all('#<([a-z]+)(?: .*)?(?<![/|/ ])>#iU', $html, $result);",
        "// Line_Reference 1226:     $opentags = $result[1];",
        "// Line_Reference 1227: ",
        "// Line_Reference 1228:     // put all closed tags into an array",
        "// Line_Reference 1230:     $closetags = $result[1];",
        "// Line_Reference 1231: ",
        "// Line_Reference 1232:     $len_opened = count($opentags);",
        "// Line_Reference 1233: ",
        "// Line_Reference 1234:     // if all tags are closed, we can return",
        "// Line_Reference 1235:     if (count($closetags) == $len_opened) {",
        "// Line_Reference 1238: ",
        "// Line_Reference 1239:     // close tags in reverse order that they were opened",
        "// Line_Reference 1240:     $opentags = array_reverse($opentags);",
        "// Line_Reference 1241: ",
        "// Line_Reference 1242:     // self closing tags",
        "// Line_Reference 1243:     $sc = array('br', 'input', 'img', 'hr', 'meta', 'link');",
        "// Line_Reference 1244:     // ,'frame','iframe','param','area','base','basefont','col'",
        "// Line_Reference 1245:     // should not skip tags that can have content inside!",
        "// Line_Reference 1246: ",
        "// Line_Reference 1247:     for ($i = 0; $i < $len_opened; $i++) {",
        "// Line_Reference 1248:         $ot = strtolower($opentags[$i]);",
        "// Line_Reference 1249: ",
        "// Line_Reference 1250:         if (!in_array($opentags[$i], $closetags) && !in_array($ot, $sc)) {",
        "// Line_Reference 1251:             $html .= '</' . $opentags[$i] . '>';",
        "// Line_Reference 1253:             unset($closetags[array_search($opentags[$i], $closetags)]);",
        "// Line_Reference 1256: "
    ]
}
