{
    "cve_id": "CVE-2023-5572",
    "cve_description": "Server-Side Request Forgery (SSRF) in GitHub repository vriteio/vrite prior to 0.3.0.",
    "cve_publish_date": "2023-10-13",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "Vrite v0.3 (#45)\n\n- Replace wrapper with element;\r\n- Add XML-like syntax for elements;\r\n- Redesign editor block menus;\r\n- Add MDX extension;\r\n- Allow CORS API access;\r\n- Restructure @vrite/backend;",
    "type_of_change": "Modification",
    "filename_of_changes": "menu.tsx",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "91",
    "number_of_lines_deleted_vulnerable_to_cve": "59",
    "vulnerable_lines": [
        "// Line_Reference 4: import { Component, createSignal, Show } from \"solid-js\";",
        "// Line_Reference 7: import { uploadFile as uploadFileUtil } from \"#lib/utils\";",
        "// Line_Reference 8: import { Button, IconButton, Input, Loader, Tooltip } from \"#components/primitives\";",
        "// Line_Reference 23:   const inputId = nanoid();",
        "// Line_Reference 30:       if (uploadedUrl) {",
        "// Line_Reference 31:         props.state.updateAttributes({ src: uploadedUrl });",
        "// Line_Reference 32:       }",
        "// Line_Reference 37:   const getPlaceholder = (): string => {",
        "// Line_Reference 38:     if (inputMode() === \"src\") {",
        "// Line_Reference 39:       return options().cover ? \"Cover image URL\" : \"Image URL\";",
        "// Line_Reference 40:     }",
        "// Line_Reference 41: ",
        "// Line_Reference 42:     return options().cover ? \"Cover alt description\" : \"Alt description\";",
        "// Line_Reference 43:   };",
        "// Line_Reference 51:     <div class=\"flex p-0 transition-shadow duration-200 border-0 rounded-xl\">",
        "// Line_Reference 52:       <Tooltip text=\"Alt\">",
        "// Line_Reference 53:         <IconButton",
        "// Line_Reference 54:           path={mdiText}",
        "// Line_Reference 55:           color={inputMode() === \"alt\" ? \"primary\" : \"contrast\"}",
        "// Line_Reference 56:           text={inputMode() === \"alt\" ? \"primary\" : \"soft\"}",
        "// Line_Reference 57:           onClick={() => {",
        "// Line_Reference 58:             setInputMode(\"alt\");",
        "// Line_Reference 60:         ></IconButton>",
        "// Line_Reference 61:       </Tooltip>",
        "// Line_Reference 62:       <Tooltip text=\"Image URL\">",
        "// Line_Reference 63:         <IconButton",
        "// Line_Reference 64:           path={mdiLinkVariant}",
        "// Line_Reference 65:           color={inputMode() === \"src\" ? \"primary\" : \"contrast\"}",
        "// Line_Reference 66:           text={inputMode() === \"src\" ? \"primary\" : \"soft\"}",
        "// Line_Reference 67:           onClick={() => {",
        "// Line_Reference 68:             setInputMode(\"src\");",
        "// Line_Reference 69:           }}",
        "// Line_Reference 70:         ></IconButton>",
        "// Line_Reference 71:       </Tooltip>",
        "// Line_Reference 72:       <Input",
        "// Line_Reference 73:         color=\"contrast\"",
        "// Line_Reference 74:         wrapperClass=\"flex-1 max-w-full min-w-unset\"",
        "// Line_Reference 75:         class=\"w-full\"",
        "// Line_Reference 76:         placeholder={getPlaceholder()}",
        "// Line_Reference 77:         value={attrs()[inputMode()] || \"\"}",
        "// Line_Reference 78:         disabled={!props.state.editor.isEditable}",
        "// Line_Reference 79:         setValue={(value) => {",
        "// Line_Reference 80:           updateAttribute.clear();",
        "// Line_Reference 81:           updateAttribute(inputMode(), value);",
        "// Line_Reference 82:         }}",
        "// Line_Reference 83:       />",
        "// Line_Reference 84:       <Show when={props.state.editor.isEditable}>",
        "// Line_Reference 98:           <Tooltip text={uploading() ? \"Uploading\" : \"Upload image\"}>",
        "// Line_Reference 99:             <Show",
        "// Line_Reference 100:               when={!uploading()}",
        "// Line_Reference 101:               fallback={",
        "// Line_Reference 102:                 <Button badge color=\"contrast\" class=\"flex items-center justify-center w-8 h-8\">",
        "// Line_Reference 103:                   <Loader class=\"w-6 h-6\" />",
        "// Line_Reference 104:                 </Button>",
        "// Line_Reference 105:               }",
        "// Line_Reference 106:             >",
        "// Line_Reference 107:               <IconButton path={mdiUpload} color=\"contrast\" text=\"soft\" badge></IconButton>",
        "// Line_Reference 108:             </Show>",
        "// Line_Reference 111:       </Show>"
    ]
}
