{
    "cve_id": "CVE-2021-43405",
    "cve_description": "An issue was discovered in FusionPBX before 4.5.30. The fax_extension may have risky characters (it is not constrained to be numeric).",
    "cve_publish_date": "2021-11-05",
    "cwe_id": "NVD-CWE-Other",
    "cwe_name": "Other",
    "cwe_description": "NVD is only using a subset of CWE for mapping instead of the entire CWE, and the weakness type is not covered by that subset.",
    "commit_message": "Require the fax_extension to be numeric.\n\nNeed to validate that the fax_extension really is numeric. Also replace event_socket_mkdir that makes a directory with mkdir.lua and use a php mkdir function instead. We want to offload this off of FreeSWITCH and its safer to use the PHP function.",
    "type_of_change": "Modification",
    "filename_of_changes": "fax_send.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "10",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 20: \tPortions created by the Initial Developer are Copyright (C) 2008-2020",
        "// Line_Reference 56: \t\tif (strlen($_REQUEST[\"fax_extension\"]) > 0) {",
        "// Line_Reference 217: \tif (strlen($fax_extension) > 0) {",
        "// Line_Reference 225: \t\t\t\tevent_socket_mkdir($_SESSION['switch']['storage']['dir']);",
        "// Line_Reference 228: \t\t\t\tevent_socket_mkdir($_SESSION['switch']['storage']['dir'].'/fax');",
        "// Line_Reference 231: \t\t\t\tevent_socket_mkdir($_SESSION['switch']['storage']['dir'].'/fax/'.$_SESSION['domain_name']);",
        "// Line_Reference 234: \t\t\t\tevent_socket_mkdir($fax_dir.'/'.$fax_extension);",
        "// Line_Reference 237: \t\t\t\tevent_socket_mkdir($dir_fax_inbox);",
        "// Line_Reference 240: \t\t\t\tevent_socket_mkdir($dir_fax_sent);",
        "// Line_Reference 243: \t\t\t\tevent_socket_mkdir($dir_fax_temp);"
    ]
}
