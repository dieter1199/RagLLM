{
    "cve_id": "CVE-2022-3873",
    "cve_description": "Cross-site Scripting (XSS) - DOM in GitHub repository jgraph/drawio prior to 20.5.2.",
    "cve_publish_date": "2022-11-07",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "20.5.2 release",
    "type_of_change": "Modification",
    "filename_of_changes": "Menus.js",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "32",
    "vulnerable_lines": [
        "// Line_Reference 813: \t\teditorUi.actions.put('pageBackgroundImage', new Action(mxResources.get('backgroundImage') + '...', function()",
        "// Line_Reference 814: \t\t{",
        "// Line_Reference 815: \t\t\tif (!editorUi.isOffline())",
        "// Line_Reference 816: \t\t\t{",
        "// Line_Reference 817: \t\t\t\tvar apply = function(image)",
        "// Line_Reference 818: \t\t\t\t{",
        "// Line_Reference 819: \t\t\t\t\teditorUi.setBackgroundImage(image);",
        "// Line_Reference 820: \t\t\t\t};",
        "// Line_Reference 821: ",
        "// Line_Reference 822: \t\t\t\tvar dlg = new BackgroundImageDialog(editorUi, apply);",
        "// Line_Reference 823: \t\t\t\teditorUi.showDialog(dlg.container, 400, 170, true, true);",
        "// Line_Reference 824: \t\t\t\tdlg.init();",
        "// Line_Reference 825: \t\t\t}",
        "// Line_Reference 826: \t\t}));",
        "// Line_Reference 827: ",
        "// Line_Reference 1014: \t\t\t\tvar w = (findReplace) ? ((uiTheme == 'min') ? 330 : 300) : 240;",
        "// Line_Reference 1015: \t\t\t\tvar h = (findReplace) ? ((uiTheme == 'min') ? 304 : 288) : 170;",
        "// Line_Reference 2654: \t\t\tif (Editor.currentTheme == 'simple' || Editor.currentTheme == 'min')",
        "// Line_Reference 2656: \t\t\t\tif (!mxClient.IS_CHROMEAPP && !EditorUi.isElectronApp)",
        "// Line_Reference 2657: \t\t\t\t{",
        "// Line_Reference 2658: \t\t\t\t\t// Publish menu contains only one element by default...",
        "// Line_Reference 2659: \t\t\t\t\t//ui.menus.addSubmenu('publish', menu, parent);",
        "// Line_Reference 2660: \t\t\t\t\tthis.addMenuItems(menu, ['publishLink'], parent);",
        "// Line_Reference 2661: \t\t\t\t}",
        "// Line_Reference 2662: ",
        "// Line_Reference 2663: \t\t\t\tif (editorUi.mode != App.MODE_ATLAS && urlParams['extAuth'] != '1')",
        "// Line_Reference 2664: \t\t\t\t{",
        "// Line_Reference 2665: \t\t\t\t\tmenu.addSeparator(parent);",
        "// Line_Reference 2666: \t\t\t\t\teditorUi.menus.addSubmenu('embed', menu, parent);",
        "// Line_Reference 2667: \t\t\t\t}",
        "// Line_Reference 4360: \t\t\t\t\t\tif (file.constructor == DriveFile)",
        "// Line_Reference 4597: \t\t\t\t\tif (file.constructor == DriveFile)"
    ]
}
