{
    "cve_id": "CVE-2012-0037",
    "cve_description": "Redland Raptor (aka libraptor) before 2.0.7, as used by OpenOffice 3.3 and 3.4 Beta, LibreOffice before 3.4.6 and 3.5.x before 3.5.1, and other products, allows user-assisted remote attackers to read arbitrary files via a crafted XML external entity (XXE) declaration and reference in an RDF document.",
    "cve_publish_date": "2012-06-17",
    "cwe_id": "CWE-611",
    "cwe_name": "Improper Restriction of XML External Entity Reference",
    "cwe_description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
    "commit_message": "CVE-2012-0037\n\nEnforce entity loading policy in raptor_libxml_resolveEntity\nand raptor_libxml_getEntity by checking for file URIs and network URIs.\n\nAdd RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES / loadExternalEntities for\nturning on loading of XML external entity loading, disabled by default.\n\nThis affects all the parsers that use SAX2: rdfxml, rss-tag-soup (and\naliases) and rdfa.",
    "type_of_change": "Modification",
    "filename_of_changes": "raptor_libxml.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "105",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 148:                             const xmlChar *publicId, const xmlChar *systemId) {",
        "// Line_Reference 150:   return libxml2_resolveEntity(sax2->xc, publicId, systemId);",
        "// Line_Reference 155: raptor_libxml_getEntity(void* user_data, const xmlChar *name) {",
        "// Line_Reference 157:   return libxml2_getEntity(sax2->xc, name);"
    ]
}
