{
    "cve_id": "CVE-2022-31005",
    "cve_description": "Vapor is an HTTP web framework for Swift. Users of Vapor prior to version 4.60.3 with FileMiddleware enabled are vulnerable to an integer overflow vulnerability that can crash the application. Version 4.60.3 contains a patch for this issue. As a workaround, disable FileMiddleware and serve via a Content Delivery Network.",
    "cve_publish_date": "2022-05-31",
    "cwe_id": "CWE-190",
    "cwe_name": "Integer Overflow or Wraparound",
    "cwe_description": "The product performs a calculation that can\n         produce an integer overflow or wraparound when the logic\n         assumes that the resulting value will always be larger than\n         the original value. This occurs when an integer value is\n         incremented to a value that is too large to store in the\n         associated representation. When this occurs, the value may\n         become a very small or negative number.",
    "commit_message": "Merge pull request from GHSA-vj2m-9f5j-mpr5\n\n* Add failing test for crash\n\n* Bounds check the range and add a couple more test cases\n\n* Fail if range start is negative\n\n* Safer parsing of integer additions\n\n* Check requested size for range header\n\n* Check for 0\n\n* Log errors and catch invalid range headers\n\n* One more log",
    "type_of_change": "Modification",
    "filename_of_changes": "FileIO.swift",
    "code_language": "Swift",
    "number_of_lines_added_for_mitigation": "31",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 166:                 (offset, byteCount) = firstRange.asByteBufferBounds(withMaxSize: fileSize)",
        "// Line_Reference 255:     fileprivate func asByteBufferBounds(withMaxSize size: Int) -> (offset: Int64, byteCount: Int) {",
        "// Line_Reference 262:                 return (offset: numericCast(start), byteCount: end - start + 1)"
    ]
}
