{
    "cve_id": "CVE-2023-23006",
    "cve_description": "In the Linux kernel before 5.15.13, drivers/net/ethernet/mellanox/mlx5/core/steering/dr_domain.c misinterprets the mlx5_get_uars_page return value (expects it to be NULL in the error case, whereas it is actually an error pointer).",
    "cve_publish_date": "2023-03-01",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "net/mlx5: DR, Fix NULL vs IS_ERR checking in dr_domain_init_resources\n\nThe mlx5_get_uars_page() function  returns error pointers.\nUsing IS_ERR() to check the return value to fix this.\n\nFixes: 4ec9e7b02697 (\"net/mlx5: DR, Expose steering domain functionality\")\nSigned-off-by: Miaoqian Lin <linmq006@gmail.com>\nSigned-off-by: Saeed Mahameed <saeedm@nvidia.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "dr_domain.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 75: \tif (!dmn->uar) {",
        "// Line_Reference 77: \t\tret = -ENOMEM;"
    ]
}
