{
    "cve_id": "CVE-2021-29533",
    "cve_description": "TensorFlow is an end-to-end open source platform for machine learning. An attacker can trigger a denial of service via a `CHECK` failure by passing an empty image to `tf.raw_ops.DrawBoundingBoxes`. This is because the implementation(https://github.com/tensorflow/tensorflow/blob/ea34a18dc3f5c8d80a40ccca1404f343b5d55f91/tensorflow/core/kernels/image/draw_bounding_box_op.cc#L148-L165) uses `CHECK_*` assertions instead of `OP_REQUIRES` to validate user controlled inputs. Whereas `OP_REQUIRES` allows returning an error condition back to the user, the `CHECK_*` macros result in a crash if the condition is false, similar to `assert`. In this case, `height` is 0 from the `images` input. This results in `max_box_row_clamp` being negative and the assertion being falsified, followed by aborting program execution. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.",
    "cve_publish_date": "2021-05-14",
    "cwe_id": "CWE-754",
    "cwe_name": "Improper Check for Unusual or Exceptional Conditions",
    "cwe_description": "The product does not check or incorrectly checks for unusual or exceptional conditions that are not expected to occur frequently during day to day operation of the product.",
    "commit_message": "Fix overflow CHECK issue with `tf.raw_ops.DrawBoundingBoxes`.\n\nPiperOrigin-RevId: 369753591\nChange-Id: I3b45fc98ee0d28a3c20b7e9c995aa647c976ec40",
    "type_of_change": "Modification",
    "filename_of_changes": "draw_bounding_box_op.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "36",
    "number_of_lines_deleted_vulnerable_to_cve": "12",
    "vulnerable_lines": [
        "// Line_Reference 150:         CHECK_GE(min_box_row_clamp, 0);",
        "// Line_Reference 151:         CHECK_GE(max_box_row_clamp, 0);",
        "// Line_Reference 152:         CHECK_LT(min_box_row_clamp, height);",
        "// Line_Reference 153:         CHECK_LT(max_box_row_clamp, height);",
        "// Line_Reference 154:         CHECK_GE(min_box_col_clamp, 0);",
        "// Line_Reference 155:         CHECK_GE(max_box_col_clamp, 0);",
        "// Line_Reference 156:         CHECK_LT(min_box_col_clamp, width);",
        "// Line_Reference 157:         CHECK_LT(max_box_col_clamp, width);",
        "// Line_Reference 162:         CHECK_LT(min_box_row, height);",
        "// Line_Reference 163:         CHECK_GE(max_box_row, 0);",
        "// Line_Reference 164:         CHECK_LT(min_box_col, width);",
        "// Line_Reference 165:         CHECK_GE(max_box_col, 0);"
    ]
}
