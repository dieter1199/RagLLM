{
    "cve_id": "CVE-2024-32462",
    "cve_description": "Flatpak is a system for building, distributing, and running sandboxed desktop applications on Linux. in versions before 1.10.9, 1.12.9, 1.14.6, and 1.15.8, a malicious or compromised Flatpak app could execute arbitrary code outside its sandbox. Normally, the `--command` argument of `flatpak run` expects to be given a command to run in the specified Flatpak app, optionally along with some arguments. However it is possible to instead pass `bwrap` arguments to `--command=`, such as `--bind`. It's possible to pass an arbitrary `commandline` to the portal interface `org.freedesktop.portal.Background.RequestBackground` from within a Flatpak app. When this is converted into a `--command` and arguments, it achieves the same effect of passing arguments directly to `bwrap`, and thus can be used for a sandbox escape. The solution is to pass the `--` argument to `bwrap`, which makes it stop processing options. This has been supported since bubblewrap 0.3.0. All supported versions of Flatpak require at least that version of bubblewrap. xdg-desktop-portal version 1.18.4 will mitigate this vulnerability by only allowing Flatpak apps to create .desktop files for commands that do not start with --. The vulnerability is patched in 1.15.8, 1.10.9, 1.12.9, and 1.14.6.",
    "cve_publish_date": "2024-04-18",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "When starting non-static command using bwrap use \"--\"\n\nThis ensures that the command is not taken to be a bwrap option.\n\nResolves: CVE-2024-32462\nResolves: GHSA-phv6-cpc2-2fgj\nSigned-off-by: Alexander Larsson <alexl@redhat.com>\n[smcv: Fix DISABLE_SANDBOXED_TRIGGERS code path]\n[smcv: Make flatpak_run_maybe_start_dbus_proxy() more obviously correct]\nSigned-off-by: Simon McVittie <smcv@collabora.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "flatpak-run.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "1",
    "vulnerable_lines": [
        "// Line_Reference 3428:   flatpak_bwrap_add_arg (bwrap, command);"
    ]
}
