{
    "cve_id": "CVE-2021-32641",
    "cve_description": "auth0-lock is Auth0's signin solution. Versions of nauth0-lock before and including `11.30.0` are vulnerable to reflected XSS. An attacker can execute arbitrary code when the library's `flashMessage` feature is utilized and user input or data from URL parameters is incorporated into the `flashMessage` or the library's `languageDictionary` feature is utilized and user input or data from URL parameters is incorporated into the `languageDictionary`. The vulnerability is patched in version 11.30.1.",
    "cve_publish_date": "2021-06-04",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Merge pull request from GHSA-jr3j-whm4-9wwm\n\n* Convert svg strings to elements\n\n* Sanitizing usage of dangerouslySetInnerHTML\n\nCo-authored-by: David <david.patrick@auth0.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "button.jsx",
    "code_language": "JavaScript",
    "number_of_lines_added_for_mitigation": "56",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 4: const svgs = {",
        "// Line_Reference 5:   back:",
        "// Line_Reference 6:     '<svg aria-hidden=\"true\" focusable=\"false\" enable-background=\"new 0 0 24 24\" version=\"1.0\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"> <polyline fill=\"none\" points=\"12.5,21 3.5,12 12.5,3 \" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\"></polyline> <line fill=\"none\" stroke=\"#000000\" stroke-miterlimit=\"10\" stroke-width=\"2\" x1=\"22\" x2=\"3.5\" y1=\"12\" y2=\"12\"></line> </svg>',",
        "// Line_Reference 7:   close:",
        "// Line_Reference 8:     '<svg aria-hidden=\"true\" focusable=\"false\" enable-background=\"new 0 0 128 128\" version=\"1.1\" viewBox=\"0 0 128 128\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><g><polygon fill=\"#373737\" points=\"123.5429688,11.59375 116.4765625,4.5185547 64.0019531,56.9306641 11.5595703,4.4882813     4.4882813,11.5595703 56.9272461,63.9970703 4.4570313,116.4052734 11.5244141,123.4814453 63.9985352,71.0683594     116.4423828,123.5117188 123.5126953,116.4414063 71.0732422,64.0019531   \"></polygon></g></svg>'",
        "// Line_Reference 9: };",
        "// Line_Reference 17:     dangerouslySetInnerHTML={{ __html: svg }}",
        "// Line_Reference 29:   />",
        "// Line_Reference 35:   svg: PropTypes.string.isRequired",
        "// Line_Reference 38: // const createButton = name => {",
        "// Line_Reference 39: //   const f = ({onClick}) => (",
        "// Line_Reference 40: //     <IconButton name={name} svg={svgs[name]} onClick={onClick} />",
        "// Line_Reference 41: //   );",
        "// Line_Reference 42: //   f.displayName = `IconButton (${name})`;",
        "// Line_Reference 43: //   f.propTypes = { onClick: React.PropTypes.func.isRequired };",
        "// Line_Reference 44: //",
        "// Line_Reference 45: //   return f;",
        "// Line_Reference 46: // };",
        "// Line_Reference 47: //",
        "// Line_Reference 48: // export const CloseButton = createButton(\"close\");",
        "// Line_Reference 49: // export const BackButton = createButton(\"back\");",
        "// Line_Reference 50: ",
        "// Line_Reference 52:   <IconButton lockId={lockId} name=\"close\" svg={svgs['close']} onClick={onClick} />",
        "// Line_Reference 60:   <IconButton lockId={lockId} name=\"back\" svg={svgs['back']} onClick={onClick} />"
    ]
}
