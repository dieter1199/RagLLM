{
    "cve_id": "CVE-2024-27318",
    "cve_description": "Versions of the package onnx before and including 1.15.0 are vulnerable to Directory Traversal as the external_data field of the tensor proto can have a path to the file which is outside the model current directory or user-provided directory. The vulnerability occurs as a bypass for the patch added for CVE-2022-25882.\n",
    "cve_publish_date": "2024-02-23",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix path sanitization bypass leading to arbitrary read (#5917)\n\nSigned-off-by: liqunfu <liqun.fu@microsoft.com>\nSigned-off-by: liqun Fu <liqun.fu@microsoft.com>\nCo-authored-by: Justin Chu <justinchuby@users.noreply.github.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "external_data_helper.py",
    "code_language": "Python",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 41:     file_location = _sanitize_path(info.location)",
        "// Line_Reference 42:     external_data_file_path = os.path.join(base_dir, file_location)",
        "// Line_Reference 43: ",
        "// Line_Reference 257: def _sanitize_path(path: str) -> str:",
        "// Line_Reference 258:     \"\"\"Remove path components which would allow traversing up a directory tree from a base path.",
        "// Line_Reference 259: ",
        "// Line_Reference 260:     Note: This method is currently very basic and should be expanded.",
        "// Line_Reference 261:     \"\"\"",
        "// Line_Reference 262:     return path.lstrip(\"/.\")",
        "// Line_Reference 263: ",
        "// Line_Reference 264: "
    ]
}
