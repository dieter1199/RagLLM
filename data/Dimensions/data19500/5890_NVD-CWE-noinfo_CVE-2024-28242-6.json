{
    "cve_id": "CVE-2024-28242",
    "cve_description": "Discourse is an open source platform for community discussion. In affected versions an attacker can learn that secret categories exist when they have backgrounds set. The issue is patched in the latest stable, beta and tests-passed version of Discourse. Users are advised to upgrade. Users unable to upgrade should temporarily remove category backgrounds.",
    "cve_publish_date": "2024-03-15",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "SECURITY: Generate more category CSS on client\n\nThis commit moves the generation of category background CSS from the\nserver side to the client side. This simplifies the server side code\nbecause it does not need to check which categories are visible to the\ncurrent user.",
    "type_of_change": "Modification",
    "filename_of_changes": "manager_spec.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "0",
    "number_of_lines_deleted_vulnerable_to_cve": "23",
    "vulnerable_lines": [
        "// Line_Reference 486:     it \"changes with category background image\" do",
        "// Line_Reference 487:       category1 = Fabricate(:category, uploaded_background_id: 123, updated_at: 1.week.ago)",
        "// Line_Reference 488:       category2 = Fabricate(:category, uploaded_background_id: 456, updated_at: 2.days.ago)",
        "// Line_Reference 489: ",
        "// Line_Reference 490:       manager = manager(theme.id)",
        "// Line_Reference 491: ",
        "// Line_Reference 492:       builder =",
        "// Line_Reference 493:         Stylesheet::Manager::Builder.new(target: :desktop_theme, theme: theme, manager: manager)",
        "// Line_Reference 494: ",
        "// Line_Reference 495:       digest1 = builder.color_scheme_digest",
        "// Line_Reference 496: ",
        "// Line_Reference 497:       category2.update!(uploaded_background_id: 789, updated_at: 1.day.ago)",
        "// Line_Reference 498: ",
        "// Line_Reference 499:       digest2 = builder.color_scheme_digest",
        "// Line_Reference 500:       expect(digest2).to_not eq(digest1)",
        "// Line_Reference 501: ",
        "// Line_Reference 502:       category1.update!(uploaded_background_id: nil, updated_at: 5.minutes.ago)",
        "// Line_Reference 503: ",
        "// Line_Reference 504:       digest3 = builder.color_scheme_digest",
        "// Line_Reference 505:       expect(digest3).to_not eq(digest2)",
        "// Line_Reference 506:       expect(digest3).to_not eq(digest1)",
        "// Line_Reference 507:     end",
        "// Line_Reference 508: "
    ]
}
