{
    "cve_id": "CVE-2013-2093",
    "cve_description": "Dolibarr ERP/CRM 3.3.1 does not properly validate user input in viewimage.php and barcode.lib.php which allows remote attackers to execute arbitrary commands.",
    "cve_publish_date": "2019-11-20",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "Sec: Param not escaped\nFix: Bad return error",
    "type_of_change": "Modification",
    "filename_of_changes": "barcode.lib.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 77: ",
        "// Line_Reference 78:     if (! $bars)",
        "// Line_Reference 81:         $error='Bad Value '.$code.' for encoding '.$encoding;",
        "// Line_Reference 136:     else if (file_exists($genbarcode_loc))",
        "// Line_Reference 255:     $paramclear=\" \\\"\".str_replace(\"\\\"\", \"\\\\\\\"\",$code).\"\\\" \\\"\".str_replace(\"\\\"\", \"\\\\\\\"\",strtoupper($encoding)).\"\\\"\";",
        "// Line_Reference 256: ",
        "// Line_Reference 258:     //print $fullcommandclear.\"<br>\\n\";",
        "// Line_Reference 276: \t\t\"encoding\" => trim($encoding),",
        "// Line_Reference 278: \t\t\"text\" => trim($text)",
        "// Line_Reference 281:     if (!$ret['encoding']) return false;"
    ]
}
