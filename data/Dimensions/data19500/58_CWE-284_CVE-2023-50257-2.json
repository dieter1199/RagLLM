{
    "cve_id": "CVE-2023-50257",
    "cve_description": "eProsima Fast DDS (formerly Fast RTPS) is a C++ implementation of the Data Distribution Service standard of the Object Management Group. Even with the application of SROS2, due to the issue where the data (`p[UD]`) and `guid` values used to disconnect between nodes are not encrypted, a vulnerability has been discovered where a malicious attacker can forcibly disconnect a Subscriber and can deny a Subscriber attempting to connect. Afterwards, if the attacker sends the packet for disconnecting, which is data (`p[UD]`), to the Global Data Space (`239.255.0.1:7400`) using the said Publisher ID, all the Subscribers (Listeners) connected to the Publisher (Talker) will not receive any data and their connection will be disconnected. Moreover, if this disconnection packet is sent continuously, the Subscribers (Listeners) trying to connect will not be able to do so. Since the initial commit of the `SecurityManager.cpp` code (`init`, `on_process_handshake`) on Nov 8, 2016, the Disconnect Vulnerability in RTPS Packets Used by SROS2 has been present prior to versions 2.13.0, 2.12.2, 2.11.3, 2.10.3, and 2.6.7.",
    "cve_publish_date": "2024-02-19",
    "cwe_id": "CWE-284",
    "cwe_name": "Improper Access Control",
    "cwe_description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
    "commit_message": "Fix CVE-2023-50257\n\nSigned-off-by: Miguel Company <miguelcompany@eprosima.com>\nCo-authored-by: Mario Dominguez <mariodominguez@eprosima.com>\n\ncommit f2bcd264798ebd0d45241e57f7d522c68920b26f\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Thu Dec 14 10:52:32 2023 +0100\n\n    Refs #19770. Improve BuiltinAuthenticationPlugin_second_participant_creation_loop.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 07380f840422f8ea2a6ae62ec901fe94687f3b3c\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Wed Dec 13 08:21:34 2023 +0100\n\n    Refs #19770. Fix PDPTests.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 4c2c21e5f2be63c1f4e0766cc8bc5a59a857b106\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Wed Dec 13 07:26:51 2023 +0100\n\n    Refs #19770. Adding override keyword.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit d185a85b937a1fd64f86a40b9db2d0b994e39a7f\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Tue Dec 12 16:05:00 2023 +0100\n\n    Refs #19770. Uncrustify.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 54a01ab0eff0e326c868d1a32bd44203bf184b4d\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Tue Dec 12 10:29:42 2023 +0100\n\n    Refs #19770. PDPSecurityInitiatorListener relies on PDPListener::onNewCacheChangeAdded.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 202bc52a4584025c897e06a40f50d5d7d6be8ce6\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Tue Dec 12 09:49:20 2023 +0100\n\n    Refs #19770. Only process removals when reader is matched.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit a4a30779c0ae3b410b8cce4aa56f47490995d20d\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Tue Dec 12 09:46:03 2023 +0100\n\n    Refs #19770. Added PDPSecurityInitiatorListener::process_alive_data.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 3c7547e0b125ab7156aaf3f72b1a431a9d77672f\nAuthor: Miguel Company <miguelcompany@eprosima.com>\nDate:   Tue Dec 12 09:32:55 2023 +0100\n\n    Refs #19770. Refactor with PDPListener::process_alive_data.\n\n    Signed-off-by: Miguel Company <miguelcompany@eprosima.com>\n\ncommit 4571178679af32902a5ba6719807b75eabafc296\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 15 12:28:14 2023 +0100\n\n    Refs #19770. StatelessReader does not call update_last_notified for not matched writers.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 8294ca3b0bae320f066779dfa1d9a8690b16ebfc\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 29 13:30:14 2023 +0100\n\n    Refs #19770. Avoid dynamic_cast when participant is not secure.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 83820e84c6cc3dcaf53e6ffe784ed03b2fac9bfa\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 29 13:24:59 2023 +0100\n\n    Refs #19770. Avoid warning when built without security.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 8ce1216f6af4758f4cb8dc1ea63c770a5ff86e1a\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 29 12:55:28 2023 +0100\n\n    Refs #19770. Fixed typo in comments.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 7bb64eb4a0b899b8055beb8a8b0b279db80e20d6\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 29 12:52:07 2023 +0100\n\n    Refs #19770. Use constexpr for topic names.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit eef95273d5464210c50a01cb22cc4a3989233f2f\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 29 12:50:56 2023 +0100\n\n    Refs #19770. Send participant dispose messages through both writers.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit c3c831f5f047c4a02a3ddd9944ce3015644f3e27\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Tue Nov 28 10:07:17 2023 +0100\n\n    Refs #19770. Move to `AUTHENTICATION_FAILED` when authentication fails.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 11f98a4d0132d630b76c68ed4157a8624dcffaa5\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Tue Nov 28 10:05:47 2023 +0100\n\n    Refs #19770. Simulate DATA(p) reception on non secure `notifyAboveRemoteEndpoints`.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 5097288e5f4816e653a7c5a4c4839d2a077f3d19\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Wed Nov 22 09:36:14 2023 +0100\n\n    Refs #19770. Common factor method `notify_and_maybe_ignore_new_participant`.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 9364310c5c3cf47b586470b90f9511b0be11fbc4\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Tue Nov 21 07:56:17 2023 +0100\n\n    Refs #19770. Improve AllowUnauthenticatedParticipants blackbox tests.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit bb8af40be3c8c138e48acfced5835f2066d864dd\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Mon Nov 20 09:53:10 2023 +0100\n\n    Refs #19770. Change builtin endpoints matching workflow.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 4fc685f75949637ee07ede7a72dd43ed4ab351f3\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 12:34:40 2023 +0100\n\n    Refs #19770. Chages in announceParticipantState.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit fb26bbccf6400123d2cb0d89d34f8c907e301d1a\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 12:23:48 2023 +0100\n\n    Refs #19770. Chages in removeRemoteEndpoints.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 96442d58fa0b16984289bbe16a132769e9cbcd81\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 12:15:35 2023 +0100\n\n    Refs #19770. Chages in notifyAboveRemoteEndpoints.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit cea35be6c84e633a500bd4565119d1a7ec6066da\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 11:52:15 2023 +0100\n\n    Refs #19770. Additional work on endpoints creation.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 02f95cf90b8acdf84c0c6dd357b8a7a26816db93\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 10:46:48 2023 +0100\n\n    Refs #19770. Methods in PDP to setup builtin endpoints security attributes.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 1f5c43734dfc6d420103e16132034e7e85ba0c3a\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Fri Nov 17 10:38:57 2023 +0100\n\n    Refs #19770. Methods in PDP to create builtin endpoints attributes.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 49624e88746389b44384f007dc17610ba929731a\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 16:56:25 2023 +0100\n\n    Refs #19770. Endpoints creation refactor.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 4ab8d1e1e24819da5d27009ec3e80051329dfbb0\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 16:28:15 2023 +0100\n\n    Refs #19770. Fix unprotected access to local participant data.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 57b99075eae290412b4d08798e1df27fc9972e1c\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 15:38:24 2023 +0100\n\n    Refs #19770. Added SimplePDPEndpointsSecure.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit e67c703db6956e15e187868f90f1f99b25e37627\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 15:28:38 2023 +0100\n\n    Refs #19770. Listeners moved into BuiltinReader.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit b2fe97e1e0001b24b18d4b145143139a084dc37d\nAuthor: Mario Dominguez <mariodominguez@eprosima.com>\nDate:   Wed Nov 8 15:42:34 2023 +0100\n\n    Refs #19770. PDP listener moved into PDPEndpoints.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 1af9da00af27591be14a1abe1d9928ccff83048d\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 13:33:37 2023 +0100\n\n    Refs #19770. Test improvements.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 03eeda5f6b305768cc876056ff6584c153c947d1\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 13:21:45 2023 +0100\n\n    Refs #19770. Regression test for vulnerability.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\ncommit 6cd538753fb8be550f9b3a58c508021d2bdf6ccd\nAuthor: Miguel Company <MiguelCompany@eprosima.com>\nDate:   Thu Nov 16 12:30:36 2023 +0100\n\n    Refs #19770. Refactor on BlackboxTestsSecurity.\n\n    Signed-off-by: Miguel Company <MiguelCompany@eprosima.com>\n\nSigned-off-by: Miguel Company <miguelcompany@eprosima.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "PDP.h",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 333:     ParticipantProxyData* getLocalParticipantProxyData()",
        "// Line_Reference 335:         return participant_proxies_.front();",
        "// Line_Reference 504:     //!Listener for the SPDP messages.",
        "// Line_Reference 505:     ReaderListener* mp_listener;"
    ]
}
