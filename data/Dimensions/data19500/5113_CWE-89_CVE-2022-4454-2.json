{
    "cve_id": "CVE-2022-4454",
    "cve_description": "A vulnerability, which was classified as critical, has been found in m0ver bible-online. Affected by this issue is the function query of the file src/main/java/custom/application/search.java of the component Search Handler. The manipulation leads to sql injection. The name of the patch is 6ef0aabfb2d4ccd53fcaa9707781303af357410e. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-215444.",
    "cve_publish_date": "2022-12-13",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Fixed the SQL Injection issue.",
    "type_of_change": "Modification",
    "filename_of_changes": "search.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "22",
    "vulnerable_lines": [
        "// Line_Reference 197:         StringBuffer condition = new StringBuffer();",
        "// Line_Reference 199:         String _keyword;",
        "// Line_Reference 201:             _keyword = keywords[i];",
        "// Line_Reference 202:             if (_keyword.trim().length() > 0) {",
        "// Line_Reference 203:                 if (condition.length() == 0) {",
        "// Line_Reference 204:                     condition.append(\" bible.content like '%\" + _keyword + \"%' \");",
        "// Line_Reference 205:                 } else {",
        "// Line_Reference 206:                     condition.append(\" AND bible.content like '%\" + _keyword + \"%' \");",
        "// Line_Reference 207:                     /*",
        "// Line_Reference 208:                      * if(true)",
        "// Line_Reference 209:                      * condition.append(\" AND bible.content like '%\"+keywords[i]+\"%' \");",
        "// Line_Reference 210:                      * else",
        "// Line_Reference 211:                      * condition.append(\" OR bible.content like '%\"+keywords[i]+\"%' \");",
        "// Line_Reference 212:                      */",
        "// Line_Reference 213:                 }",
        "// Line_Reference 220:             condition.append(\" book.language='\" + locale + \"' \");",
        "// Line_Reference 222:             condition.append(\" AND book.language='\" + locale + \"' \");",
        "// Line_Reference 243:         Table vtable = bible.find(SQL, new Object[]{});",
        "// Line_Reference 269:         Row found = bible.findOne(look, new Object[]{});",
        "// Line_Reference 280:         html.append(\"<ol class=\\\"searchresults\\\" start=\\\"\" + next + \"\\\">\\r\\n\");",
        "// Line_Reference 352:                 + String.valueOf(System.currentTimeMillis() - startTime) + \" -->\");",
        "// Line_Reference 384:         StringBuffer xml = new StringBuffer();"
    ]
}
