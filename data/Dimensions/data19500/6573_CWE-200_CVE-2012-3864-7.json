{
    "cve_id": "CVE-2012-3864",
    "cve_description": "Puppet before 2.6.17 and 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, allows remote authenticated users to read arbitrary files on the puppet master server by leveraging an arbitrary user's certificate and private key in a GET request.",
    "cve_publish_date": "2012-08-06",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Add Selector terminus for file_content/file_metadata\n\nThis terminus is now the default, and encapsulates the behavior that was\npreviously in the IndirectionHooks. That is, we dynamically select the\nterminus to use for a file request based on the key. However, for the\npuppet master, we instead explicitly always use the FileServer terminus,\nso that *all* requests for files from the master will go through\nthe file server. This ensures that we will never accidentally\nserve local files on the puppet master.",
    "type_of_change": "Modification",
    "filename_of_changes": "terminus_selector.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 1: require 'uri'",
        "// Line_Reference 3: require 'puppet/util'",
        "// Line_Reference 8: module Puppet::FileServing::IndirectionHooks",
        "// Line_Reference 11:   # Pick an appropriate terminus based on the protocol.",
        "// Line_Reference 12:   def select_terminus(request)"
    ]
}
