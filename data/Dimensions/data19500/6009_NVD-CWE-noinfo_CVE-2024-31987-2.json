{
    "cve_id": "CVE-2024-31987",
    "cve_description": "XWiki Platform is a generic wiki platform. Starting in version 6.4-milestone-1 and prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, any user who can edit any page like their profile can create a custom skin with a template override that is executed with programming right, thus allowing remote code execution. This has been patched in XWiki 14.10.19, 15.5.4 and 15.10RC1. No known workarounds are available except for upgrading.",
    "cve_publish_date": "2024-04-10",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "XWIKI-21478: Improve rights check of template macros",
    "type_of_change": "Modification",
    "filename_of_changes": "XWikiVelocityManagerTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "71",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 25: import org.xwiki.component.manager.ComponentLookupException;",
        "// Line_Reference 50:  *",
        "// Line_Reference 53: @ComponentList(value = {DefaultScriptContextManager.class, XWikiScriptContextInitializer.class,",
        "// Line_Reference 54:     DefaultVelocityConfiguration.class, DefaultLoggerConfiguration.class})",
        "// Line_Reference 68:     public void beforeEach() throws ComponentLookupException",
        "// Line_Reference 77:     public void getVelocityContext()",
        "// Line_Reference 79:         VelocityContext context = velocityManager.getVelocityContext();"
    ]
}
