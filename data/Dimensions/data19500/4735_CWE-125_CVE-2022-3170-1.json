{
    "cve_id": "CVE-2022-3170",
    "cve_description": "An out-of-bounds access issue was found in the Linux kernel sound subsystem. It could occur when the 'id->name' provided by the user did not end with '\\0'. A privileged local user could pass a specially crafted name through ioctl() interface and crash the system or potentially escalate their privileges on the system.",
    "cve_publish_date": "2022-09-13",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "ALSA: control: Fix an out-of-bounds bug in get_ctl_id_hash()\n\nSince the user can control the arguments provided to the kernel by the\nioctl() system call, an out-of-bounds bug occurs when the 'id->name'\nprovided by the user does not end with '\\0'.\n\nThe following log can reveal it:\n\n[    10.002313] BUG: KASAN: stack-out-of-bounds in snd_ctl_find_id+0x36c/0x3a0\n[    10.002895] Read of size 1 at addr ffff888109f5fe28 by task snd/439\n[    10.004934] Call Trace:\n[    10.007140]  snd_ctl_find_id+0x36c/0x3a0\n[    10.007489]  snd_ctl_ioctl+0x6cf/0x10e0\n\nFix this by checking the bound of 'id->name' in the loop.\n\nFixes: c27e1efb61c5 (\"ALSA: control: Use xarray for faster lookups\")\nSigned-off-by: Zheyu Ma <zheyuma97@gmail.com>\nLink: https://lore.kernel.org/r/20220824081654.3767739-1-zheyuma97@gmail.com\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
    "type_of_change": "Modification",
    "filename_of_changes": "control.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "3",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 389: \tconst unsigned char *p;",
        "// Line_Reference 394: \tfor (p = id->name; *p; p++)",
        "// Line_Reference 395: \t\th = MULTIPLIER * h + *p;"
    ]
}
