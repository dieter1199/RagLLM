{
    "cve_id": "CVE-2020-26267",
    "cve_description": "In affected versions of TensorFlow the tf.raw_ops.DataFormatVecPermute API does not validate the src_format and dst_format attributes. The code assumes that these two arguments define a permutation of NHWC. This can result in uninitialized memory accesses, read outside of bounds and even crashes. This is fixed in versions 1.15.5, 2.0.4, 2.1.3, 2.2.2, 2.3.2, and 2.4.0.",
    "cve_publish_date": "2020-12-10",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "Validate that `DataFormat*` attributes form a permutation.\n\nThe `src_format` and `dst_format` attributes for the `DataFormatDimMap` and `DataFormatVecPermute` raw ops are supposed to determine a permutation. However, this was not validated and could result in unitialized memory accesses as well as writes outside of bounds and potential crashes.\n\nWhile here, we also test that the format attributes have the needed length, add tests for all validation failure cases, remove unnecessary calls to `strings::StrCat`, and fix a few grammar errors.\n\nThis will be cherry-picked on the supported release branches.\n\nPiperOrigin-RevId: 346135579\nChange-Id: I1c76392382c89ad8f072d5bc93d70669851eb404",
    "type_of_change": "Modification",
    "filename_of_changes": "data_format_ops.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "65",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 41:                 errors::InvalidArgument(strings::StrCat(",
        "// Line_Reference 42:                     \"Source format must of length 4 or 5, received \"",
        "// Line_Reference 44:                     src_format)));",
        "// Line_Reference 46:         context, dst_format.size() == 4 || dst_format.size() == 5,",
        "// Line_Reference 47:         errors::InvalidArgument(strings::StrCat(",
        "// Line_Reference 48:             \"Destination format must of length 4 or 5, received dst_format = \",",
        "// Line_Reference 49:             dst_format)));"
    ]
}
