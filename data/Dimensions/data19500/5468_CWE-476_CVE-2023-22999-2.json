{
    "cve_id": "CVE-2023-22999",
    "cve_description": "In the Linux kernel before 5.16.3, drivers/usb/dwc3/dwc3-qcom.c misinterprets the dwc3_qcom_create_urs_usb_platdev return value (expects it to be NULL in the error case, whereas it is actually an error pointer).",
    "cve_publish_date": "2023-02-28",
    "cwe_id": "CWE-476",
    "cwe_name": "NULL Pointer Dereference",
    "cwe_description": "The product dereferences a pointer that it expects to be valid but is NULL.",
    "commit_message": "usb: dwc3: qcom: Fix NULL vs IS_ERR checking in dwc3_qcom_probe\n\nSince the acpi_create_platform_device() function may return error\npointers, dwc3_qcom_create_urs_usb_platdev() function may return error\npointers too. Using IS_ERR_OR_NULL() to check the return value to fix this.\n\nFixes: c25c210f590e (\"usb: dwc3: qcom: add URS Host support for sdm845 ACPI boot\")\nSigned-off-by: Miaoqian Lin <linmq006@gmail.com>\nLink: https://lore.kernel.org/r/20211222111823.22887-1-linmq006@gmail.com\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "dwc3-qcom.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 778: \t\t\tif (!qcom->urs_usb) {",
        "// Line_Reference 780: \t\t\t\treturn -ENODEV;"
    ]
}
