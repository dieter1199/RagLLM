{
    "cve_id": "CVE-2021-41220",
    "cve_description": "TensorFlow is an open source platform for machine learning. In affected versions the async implementation of `CollectiveReduceV2` suffers from a memory leak and a use after free. This occurs due to the asynchronous computation and the fact that objects that have been `std::move()`d from are still accessed. The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, as this version is the only one that is also affected.",
    "cve_publish_date": "2021-11-05",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "Fix undefined behavior in CollectiveReduceV2 and others\n\nWe should not call done after it's moved.\n\nPiperOrigin-RevId: 400838185\nChange-Id: Ifc979740054b8f8c6f4d50acc89472fe60c4fdb1",
    "type_of_change": "Modification",
    "filename_of_changes": "collective_ops.cc",
    "code_language": "C++",
    "number_of_lines_added_for_mitigation": "14",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 497:       return errors::Internal(\"Unexpected dimensions on input group_size, got \",",
        "// Line_Reference 498:                               group_size.shape().DebugString());",
        "// Line_Reference 501:       return errors::Internal(\"Unexpected dimensions on input group_key, got \",",
        "// Line_Reference 502:                               group_key.shape().DebugString());",
        "// Line_Reference 505:       return errors::Internal(",
        "// Line_Reference 628:                          done);",
        "// Line_Reference 858:       return errors::Internal(",
        "// Line_Reference 864:       return errors::Internal(\"Unexpected dimensions on input group_key, got \",",
        "// Line_Reference 865:                               group_key_t.shape().DebugString());",
        "// Line_Reference 1087:                          done);",
        "// Line_Reference 1137:                          done);"
    ]
}
