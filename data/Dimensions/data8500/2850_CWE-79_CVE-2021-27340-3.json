{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "AssignOtherInfo.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "28",
    "number_of_lines_deleted_vulnerable_to_cve": "26",
    "vulnerable_lines": [
        "// Line_Reference 105: ",
        "// Line_Reference 205:         elseif($_REQUEST['category_id'] == 6 && ($next_school == '' && !$calendar && $str_date=='' && $end_date==''))",
        "// Line_Reference 234:         ShowErr(''._youMustChooseAtLeastOneFieldAndOneStudent.'.');",
        "// Line_Reference 538:                 $title = strtolower(trim($field['TITLE']));",
        "// Line_Reference 539:                 if (strpos(trim($field['TITLE']), ' ') != 0) {",
        "// Line_Reference 540:                     $p1 = substr(trim($field['TITLE']), 0, strpos(trim($field['TITLE']), ' '));",
        "// Line_Reference 541:                     $p2 = substr(trim($field['TITLE']), strpos(trim($field['TITLE']), ' ') + 1);",
        "// Line_Reference 542:                     $title = strtolower($p1 . '_' . $p2);",
        "// Line_Reference 543:                 }",
        "// Line_Reference 544: ",
        "// Line_Reference 545:                 $query = DBGet(DBQuery('SELECT * FROM students LIMIT 0,1'));",
        "// Line_Reference 546:                 $query = $query[1];",
        "// Line_Reference 547:                 $f = 0;",
        "// Line_Reference 548:                 foreach ($query as $k => $v) {",
        "// Line_Reference 549:                     if (strtolower($k) == strtolower($title))",
        "// Line_Reference 550:                         $f = 1;",
        "// Line_Reference 551:                 }",
        "// Line_Reference 552:                 if ($f == 0) {",
        "// Line_Reference 553:                     if (trim($title) == 'physician')",
        "// Line_Reference 554:                         $title = 'medical_info[PHYSICIAN]';",
        "// Line_Reference 555:                     if (trim($title) == 'physician_phone')",
        "// Line_Reference 556:                         $title = 'medical_info[PHYSICIAN_PHONE]';",
        "// Line_Reference 557:                     else if (trim($title) == 'preferred_hospital')",
        "// Line_Reference 558:                         $title = 'medical_info[PREFERRED_HOSPITAL]';",
        "// Line_Reference 559:                 }",
        "// Line_Reference 560:                 array_push($fields, '<div class=\"form-group\">' . _makeTextInput($title) . '</div>');"
    ]
}
