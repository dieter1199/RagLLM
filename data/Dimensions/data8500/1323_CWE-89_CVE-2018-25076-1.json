{
    "cve_id": "CVE-2018-25076",
    "cve_description": "A vulnerability classified as critical was found in Events Extension on BigTree. Affected by this vulnerability is the function getRandomFeaturedEventByDate/getUpcomingFeaturedEventsInCategoriesWithSubcategories/recacheEvent/searchResults of the file classes/events.php. The manipulation leads to sql injection. The patch is named 11169e48ab1249109485fdb1e0c9fca3d25ba01d. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218395.",
    "cve_publish_date": "2023-01-16",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "Added methods for getting a page of upcoming events, fixed SQL injection in searches",
    "type_of_change": "Modification",
    "filename_of_changes": "events.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "102",
    "number_of_lines_deleted_vulnerable_to_cve": "6",
    "vulnerable_lines": [
        "// Line_Reference 1019: \t\t\t$words = explode(\" \",$query);",
        "// Line_Reference 1020: \t\t\t$qwords = array();",
        "// Line_Reference 1299: \t\tstatic function getUpcomingSearchResults($query,$limit = 5,$featured = false) {",
        "// Line_Reference 1316: \t\t\t$q = sqlquery(\"SELECT btx_events_date_cache.start,btx_events_date_cache.end,btx_events_date_cache.id as instance,btx_events_date_cache.title_route AS title_route, btx_events_date_cache.date_route AS date_route,btx_events_events.* FROM btx_events_events JOIN btx_events_date_cache WHERE btx_events_date_cache.event = btx_events_events.id AND $qwords btx_events_date_cache.end >= NOW() $featured ORDER BY btx_events_date_cache.start ASC LIMIT $limit\");",
        "// Line_Reference 1399: \t\tstatic function searchResultsInCategory($query,$category) {",
        "// Line_Reference 1402: "
    ]
}
