{
    "cve_id": "CVE-2021-24892",
    "cve_description": "Insecure Direct Object Reference in edit function of Advanced Forms (Free & Pro) before 1.6.9 allows authenticated remote attacker to change arbitrary user's email address and request for reset password, which could lead to take over of WordPress's administrator account. To exploit this vulnerability, an attacker must register to obtain a valid WordPress's user and use such user to authenticate with WordPress in order to exploit the vulnerable edit function.",
    "cve_publish_date": "2021-11-23",
    "cwe_id": "CWE-639",
    "cwe_name": "Authorization Bypass Through User-Controlled Key",
    "cwe_description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
    "commit_message": "Added form nonce with arguments\n\nThis fixes a security issue where arguments could be edited client-side.",
    "type_of_change": "Modification",
    "filename_of_changes": "forms-rendering.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "12",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 301:       $nonce = wp_create_nonce( 'acf_nonce' );",
        "// Line_Reference 302:       echo sprintf( '<input type=\"hidden\" name=\"_acfnonce\" value=\"%s\">', $nonce );",
        "// Line_Reference 303:       echo sprintf( '<input type=\"hidden\" name=\"nonce\" value=\"%s\">', $nonce );",
        "// Line_Reference 306:       echo sprintf( '<input type=\"hidden\" name=\"af_form_args\" value=\"%s\">', base64_encode( json_encode( $args ) ) );",
        "// Line_Reference 307:       echo sprintf( '<input type=\"hidden\" name=\"_acf_form\" value=\"%s\">', base64_encode( json_encode( $args ) ) );"
    ]
}
