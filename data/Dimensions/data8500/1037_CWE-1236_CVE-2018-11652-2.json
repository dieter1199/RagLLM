{
    "cve_id": "CVE-2018-11652",
    "cve_description": "CSV Injection vulnerability in Nikto 2.1.6 and earlier allows remote attackers to inject arbitrary OS commands via the Server field in an HTTP response header, which is directly injected into a CSV report.",
    "cve_publish_date": "2018-06-01",
    "cwe_id": "CWE-1236",
    "cwe_name": "Improper Neutralization of Formula Elements in a CSV File",
    "cwe_description": "The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.",
    "commit_message": "Fix CSV injection issue if server responds with a malicious Server string & CSV output is opened in Excel or other spreadsheet app. Potentially malicious cell start characters are now prefaced with a ' mark. Thanks to Adam (@bytesoverbombs) for letting me know!\n\nAlso fixed a crash in the outdated plugin if the $sepr field ends up being something that triggers a panic in split().",
    "type_of_change": "Modification",
    "filename_of_changes": "nikto_report_csv.plugin",
    "code_language": "Perl",
    "number_of_lines_added_for_mitigation": "25",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 56:     print $handle \"\\\"$hostname\\\",\"",
        "// Line_Reference 57:       . \"\\\"$mark->{'ip'}\\\",\"",
        "// Line_Reference 58:       . \"\\\"$mark->{'port'}\\\",\" . \"\\\"\\\",\" . \"\\\"\\\",\" . \"\\\"\\\",\"",
        "// Line_Reference 59:       . \"\\\"$mark->{'banner'}\\\"\\n\";",
        "// Line_Reference 70:         $line .= \"\\\"$hostname\\\",\";",
        "// Line_Reference 71:         $line .= \"\\\"$item->{'mark'}->{'ip'}\\\",\";",
        "// Line_Reference 72:         $line .= \"\\\"$item->{'mark'}->{'port'}\\\",\";",
        "// Line_Reference 79:         if ($item->{'method'} ne '') { $line .= $item->{'method'}; }",
        "// Line_Reference 84: \t\t\t{ $line .= $mark->{'root'} . $uri; }",
        "// Line_Reference 85: \t\telse { $line .= $uri; }",
        "// Line_Reference 88: \t\tmy $msg = $item->{'message'};",
        "// Line_Reference 89: \t\t$uri=quotemeta($uri);",
        "// Line_Reference 90: \t\tmy $root = quotemeta($mark->{'root'});",
        "// Line_Reference 91: \t\t$msg =~ s/^$uri:\\s//;",
        "// Line_Reference 92: \t\t$msg =~ s/^$root$uri:\\s//;",
        "// Line_Reference 94:         $line .= \"\\\"$msg\\\"\";"
    ]
}
