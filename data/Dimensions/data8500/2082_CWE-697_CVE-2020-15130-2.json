{
    "cve_id": "CVE-2020-15130",
    "cve_description": "In SLPJS (npm package slpjs) before version 0.27.4, there is a vulnerability to false-positive validation outcomes for the NFT1 Child Genesis transaction type. A poorly implemented SLP wallet or opportunistic attacker could create a seemingly valid NFT1 child token without burning any of the NFT1 Group token type as is required by the NFT1 specification. This is fixed in version 0.27.4.",
    "cve_publish_date": "2020-07-30",
    "cwe_id": "CWE-697",
    "cwe_name": "Incorrect Comparison",
    "cwe_description": "The product compares two entities in a security-relevant context, but the comparison is incorrect, which may lead to resultant weaknesses.",
    "commit_message": "critical update for NFT child genesis validation",
    "type_of_change": "Modification",
    "filename_of_changes": "validation.ts",
    "code_language": "TypeScript",
    "number_of_lines_added_for_mitigation": "34",
    "number_of_lines_deleted_vulnerable_to_cve": "18",
    "vulnerable_lines": [
        "// Line_Reference 349:                 const inputTxid = txn.inputs[0].previousTxHash;",
        "// Line_Reference 350:                 const inputTxHex = await this.retrieveRawTransaction(inputTxid);",
        "// Line_Reference 351:                 const inputTx: Transaction = Transaction.parseFromBuffer(inputTxHex);",
        "// Line_Reference 354:                     inputSlpMsg = Slp.parseSlpOutputScript(inputTx.outputs[0].scriptPubKey);",
        "// Line_Reference 363:                 if (inputSlpMsg.transactionType === SlpTransactionType.SEND &&",
        "// Line_Reference 364:                     !inputSlpMsg.sendOutputs![1].gt(0)) {",
        "// Line_Reference 365:                     validation.validity = false;",
        "// Line_Reference 366:                     validation.waiting = false;",
        "// Line_Reference 367:                     validation.invalidReason = \"NFT1 child's parent has SLP output that is not greater than zero.\";",
        "// Line_Reference 368:                     return validation.validity!;",
        "// Line_Reference 369:                 } else if ((inputSlpMsg.transactionType === SlpTransactionType.GENESIS ||",
        "// Line_Reference 370:                             inputSlpMsg.transactionType === SlpTransactionType.MINT) &&",
        "// Line_Reference 371:                             !inputSlpMsg.genesisOrMintQuantity!.gt(0)) {",
        "// Line_Reference 372:                     validation.validity = false;",
        "// Line_Reference 373:                     validation.waiting = false;",
        "// Line_Reference 374:                     validation.invalidReason = \"NFT1 child's parent has SLP output that is not greater than zero.\";",
        "// Line_Reference 375:                     return validation.validity!;",
        "// Line_Reference 379:                     txid: inputTxid,"
    ]
}
