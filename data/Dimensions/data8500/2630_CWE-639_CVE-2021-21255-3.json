{
    "cve_id": "CVE-2021-21255",
    "cve_description": "GLPI is an open-source asset and IT management software package that provides ITIL Service Desk features, licenses tracking and software auditing. In GLPI version 9.5.3, it was possible to switch entities with IDOR from a logged in user. This is fixed in version 9.5.4.",
    "cve_publish_date": "2021-03-02",
    "cwe_id": "CWE-639",
    "cwe_name": "Authorization Bypass Through User-Controlled Key",
    "cwe_description": "The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.",
    "commit_message": "validate entity_restrict when available with idor tokens",
    "type_of_change": "Modification",
    "filename_of_changes": "dropdown.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "9",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 176:             'entity_restrict'      => (is_array($params['entity']) ? json_encode(array_values($params['entity'])) : $params['entity']),",
        "// Line_Reference 180:             '_idor_token'          => Session::getNewIDORToken($itemtype),",
        "// Line_Reference 2202:       // check if asked itemtype is the one originaly requested by the form",
        "// Line_Reference 2203:       if (!Session::validateIDOR($post)) {",
        "// Line_Reference 2204:          return;",
        "// Line_Reference 2205:       }",
        "// Line_Reference 2206: "
    ]
}
