{
    "cve_id": "CVE-2020-13692",
    "cve_description": "PostgreSQL JDBC Driver (aka PgJDBC) before 42.2.13 allows XXE.",
    "cve_publish_date": "2020-06-04",
    "cwe_id": "CWE-611",
    "cwe_name": "Improper Restriction of XML External Entity Reference",
    "cwe_description": "The product processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.",
    "commit_message": "Merge pull request from GHSA-37xm-4h3m-5w3v\n\n* refactor: Clean up whitespace in existing PgSQLXMLTest\n\n* fix: Fix XXE vulnerability in PgSQLXML by disabling external access and doctypes\n\nFixes XXE vulnerability by defaulting to disabling external access and doc types. The\nlegacy insecure behavior can be restored via the new connection property xmlFactoryFactory\nwith a value of LEGACY_INSECURE. Alternatively, a custom class name can be specified that\nimplements org.postgresql.xml.PGXmlFactoryFactory and takes a no argument constructor.\n\n* fix: Add missing getter and setter for XML_FACTORY_FACTORY to BasicDataSource",
    "type_of_change": "Modification",
    "filename_of_changes": "PgSQLXMLTest.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "93",
    "number_of_lines_deleted_vulnerable_to_cve": "3",
    "vulnerable_lines": [
        "// Line_Reference 30:     TestUtil.createTempTable(con, \"xmltab\",\"x xml\");",
        "// Line_Reference 34:   public void setCharacterStream() throws  Exception {",
        "// Line_Reference 40:     preparedStatement.setSQLXML(1,pgSQLXML);"
    ]
}
