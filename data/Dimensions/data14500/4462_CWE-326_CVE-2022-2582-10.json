{
    "cve_id": "CVE-2022-2582",
    "cve_description": "The AWS S3 Crypto SDK sends an unencrypted hash of the plaintext alongside the ciphertext as a metadata field. This hash can be used to brute force the plaintext, if the hash is readable to the attacker. AWS now blocks this metadata field, but older SDK versions still send it.",
    "cve_publish_date": "2022-12-27",
    "cwe_id": "CWE-326",
    "cwe_name": "Inadequate Encryption Strength",
    "cwe_description": "The product stores or transmits sensitive data using an encryption scheme that is theoretically sound, but is not strong enough for the level of protection required.",
    "commit_message": "service/s3/s3crypto: V2 Client Release (#3403)",
    "type_of_change": "Modification",
    "filename_of_changes": "kms_key_handler.go",
    "code_language": "Go",
    "number_of_lines_added_for_mitigation": "115",
    "number_of_lines_deleted_vulnerable_to_cve": "16",
    "vulnerable_lines": [
        "// Line_Reference 17: \tkms   kmsiface.KMSAPI",
        "// Line_Reference 18: \tcmkID *string",
        "// Line_Reference 35: // NewKMSKeyGeneratorWithMatDesc builds a new KMS key provider using the customer key ID and material",
        "// Line_Reference 42: //\thandler := s3crypto.NewKMSKeyGeneratorWithMatDesc(kms.New(sess), cmkID, matdesc)",
        "// Line_Reference 43: func NewKMSKeyGeneratorWithMatDesc(kmsClient kmsiface.KMSAPI, cmkID string, matdesc MaterialDescription) CipherDataGenerator {",
        "// Line_Reference 47: \tmatdesc[\"kms_cmk_id\"] = &cmkID",
        "// Line_Reference 50: \tkp := &kmsKeyHandler{",
        "// Line_Reference 51: \t\tkms:   kmsClient,",
        "// Line_Reference 52: \t\tcmkID: &cmkID,",
        "// Line_Reference 54: \t// These values are read only making them thread safe",
        "// Line_Reference 55: \tkp.CipherData.WrapAlgorithm = KMSWrap",
        "// Line_Reference 89: \tif !ok {",
        "// Line_Reference 129: \t\t\tEncryptionContext: kp.CipherData.MaterialDescription,",
        "// Line_Reference 137: \tiv := generateBytes(ivSize)",
        "// Line_Reference 141: \t\tWrapAlgorithm:       KMSWrap,",
        "// Line_Reference 142: \t\tMaterialDescription: kp.CipherData.MaterialDescription,"
    ]
}
