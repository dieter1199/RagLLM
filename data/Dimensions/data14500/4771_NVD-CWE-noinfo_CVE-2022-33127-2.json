{
    "cve_id": "CVE-2022-33127",
    "cve_description": "The function that calls the diff tool in Diffy 3.4.1 does not properly handle double quotes in a filename when run in a windows environment. This allows attackers to execute arbitrary commands via a crafted string.",
    "cve_publish_date": "2022-06-23",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Remove windows specific exec.  Open2.capture3 should work on all\nplatforms.",
    "type_of_change": "Modification",
    "filename_of_changes": "diff.rb",
    "code_language": "Ruby",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "7",
    "vulnerable_lines": [
        "// Line_Reference 52:         if WINDOWS",
        "// Line_Reference 53:           # don't use open3 on windows",
        "// Line_Reference 54:           cmd = sprintf '\"%s\" %s %s', diff_bin, diff_options.join(' '), @paths.map { |s| %(\"#{s}\") }.join(' ')",
        "// Line_Reference 55:           diff = `#{cmd}`",
        "// Line_Reference 56:         else",
        "// Line_Reference 57:           diff = Open3.popen3(diff_bin, *(diff_options + @paths)) { |i, o, e| o.read }",
        "// Line_Reference 58:         end"
    ]
}
