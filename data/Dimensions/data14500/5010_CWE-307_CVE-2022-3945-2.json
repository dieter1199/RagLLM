{
    "cve_id": "CVE-2022-3945",
    "cve_description": "Improper Restriction of Excessive Authentication Attempts in GitHub repository kareadita/kavita prior to 0.6.0.3.",
    "cve_publish_date": "2022-11-11",
    "cwe_id": "CWE-307",
    "cwe_name": "Improper Restriction of Excessive Authentication Attempts",
    "cwe_description": "The product does not implement sufficient measures to prevent multiple failed authentication attempts within a short time frame, making it more susceptible to brute force attacks.",
    "commit_message": "Security Patches (#1624)\n\n* Fixed an issue where migrate-email could be called when an admin already existed\r\n\r\n* When logging in, ensure there is no bias towards username or password when rejecting\r\n\r\n* Cleaned up some messaging around anonymous apis to ensure there are no attack vectors.",
    "type_of_change": "Modification",
    "filename_of_changes": "AccountController.cs",
    "code_language": "C#",
    "number_of_lines_added_for_mitigation": "37",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 189:         if (user == null) return Unauthorized(\"Invalid username\");",
        "// Line_Reference 201:             return Unauthorized(result.IsNotAllowed ? \"You must confirm your email first\" : \"Your credentials are not correct.\");",
        "// Line_Reference 643:             return BadRequest(\"The email does not match the registered email\");",
        "// Line_Reference 657:         if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest(\"Invalid Email Token\");",
        "// Line_Reference 697:             return BadRequest(\"Invalid Email Token\");",
        "// Line_Reference 700:         if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest(\"Invalid Email Token\");",
        "// Line_Reference 701: ",
        "// Line_Reference 731:                 return BadRequest(\"Invalid Details\");",
        "// Line_Reference 736:             if (!result) return BadRequest(\"Unable to reset password, your email token is not correct.\");",
        "// Line_Reference 804:         if (user == null) return BadRequest(\"This email is not on system\");",
        "// Line_Reference 806:         if (!await ConfirmEmailToken(dto.Token, user)) return BadRequest(\"Invalid Email Token\");"
    ]
}
