{
    "cve_id": "CVE-2016-7565",
    "cve_description": "install/index.php in Exponent CMS 2.3.9 allows remote attackers to execute arbitrary commands via shell metacharacters in the sc array parameter.",
    "cve_publish_date": "2017-02-13",
    "cwe_id": "CWE-284",
    "cwe_name": "Improper Access Control",
    "cwe_description": "The product does not restrict or incorrectly restricts access to a resource from an unauthorized actor.",
    "commit_message": "security fix to prevent possible hacking by moving security checks earlier in the install code",
    "type_of_change": "Modification",
    "filename_of_changes": "index.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "26",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 32: ",
        "// Line_Reference 60: //            $value = expString::sanitize($value);",
        "// Line_Reference 66: //            'c'          => expString::sanitize($_REQUEST['sc']),",
        "// Line_Reference 107: // Make sure our 'page' is set correctly",
        "// Line_Reference 108: if (file_exists(\"../framework/conf/config.php\") && !isset($_REQUEST['page'])) {",
        "// Line_Reference 109:     $_REQUEST['page'] = 'upgrade-1';",
        "// Line_Reference 110: }",
        "// Line_Reference 111: if (!file_exists(\"../framework/conf/config.php\") && !isset($_REQUEST['page'])) {",
        "// Line_Reference 112:     $_REQUEST['page'] = 'welcome';",
        "// Line_Reference 113: }",
        "// Line_Reference 114: $page = $_REQUEST['page'];",
        "// Line_Reference 115: ",
        "// Line_Reference 116: // Superadmin must be logged in to do an upgrade",
        "// Line_Reference 117: if (strpos($page, 'upgrade-') !== false && empty($user->is_admin)) {",
        "// Line_Reference 118:     header('Location: ../index.php');",
        "// Line_Reference 119:     exit();",
        "// Line_Reference 120: }",
        "// Line_Reference 121: ",
        "// Line_Reference 122: // Only run installation if not already installed",
        "// Line_Reference 123: if (strpos($page, 'upgrade-') === false && !file_exists(BASE . 'install/not_configured')) {",
        "// Line_Reference 124:     header('Location: ../index.php');",
        "// Line_Reference 125:     exit();",
        "// Line_Reference 126: }",
        "// Line_Reference 127: ",
        "// Line_Reference 274: ?>"
    ]
}
