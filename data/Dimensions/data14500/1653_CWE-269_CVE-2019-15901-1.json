{
    "cve_id": "CVE-2019-15901",
    "cve_description": "An issue was discovered in slicer69 doas before 6.2 on certain platforms other than OpenBSD. A setusercontext(3) call with flags to change the UID, primary GID, and secondary GIDs was replaced (on certain platforms: Linux and possibly NetBSD) with a single setuid(2) call. This resulted in neither changing the group id nor initializing secondary group ids.",
    "cve_publish_date": "2019-10-18",
    "cwe_id": "CWE-269",
    "cwe_name": "Improper Privilege Management",
    "cwe_description": "The product does not properly assign, modify, track, or check privileges for an actor, creating an unintended sphere of control for that actor.",
    "commit_message": "fix the setusercontext(3) workaround\n\nSeeing this being used on even more system like Illumos with this ugly\nand security critical bug open makes me cringe every time I check if it\nwas finally fixed.\n\nI reported it directly to the maintainer in 2017. I reported it to\npkgsrc-security@netbsd.org without a response.",
    "type_of_change": "Modification",
    "filename_of_changes": "doas.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "17",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 560: #ifndef HAVE_LOGIN_CAP_H",
        "// Line_Reference 561:         /* If we effectively are root, set the UID to actually be root to avoid",
        "// Line_Reference 562:            permission errors. */",
        "// Line_Reference 563:         if (target != 0)",
        "// Line_Reference 564:            setuid(target);",
        "// Line_Reference 565:         if ( geteuid() == ROOT_UID )",
        "// Line_Reference 566:            setuid(ROOT_UID);",
        "// Line_Reference 567: #endif"
    ]
}
