{
    "cve_id": "CVE-2021-41243",
    "cve_description": "There is a Potential Zip Slip Vulnerability and OS Command Injection Vulnerability on the management system of baserCMS. Users with permissions to upload files may upload crafted zip files which may execute arbitrary commands on the host operating system. This is a vulnerability that needs to be addressed when the management system is used by an unspecified number of users. If you are eligible, please update to the new version as soon as possible.",
    "cve_publish_date": "2021-11-26",
    "cwe_id": "CWE-78",
    "cwe_name": "Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')",
    "cwe_description": "The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.",
    "commit_message": "Merge pull request from GHSA-7rpc-9m88-cf9w\n\n* 固定ページプレビュー実行時に入力内容検証を追加\n\n* SimpleZipの利用を停止しZipArchiveの利用に切り替え\n\n* 不要コード除去\n\n* BcZip利用時、ZipArchiveをopenしていない場合エラーログが出力される問題を改善",
    "type_of_change": "Modification",
    "filename_of_changes": "ThemesController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "39",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 13: App::uses('Simplezip', 'Vendor');",
        "// Line_Reference 98: \t\tApp::uses('BcZip', 'Lib');",
        "// Line_Reference 608: \t\t$fileName = 'default';",
        "// Line_Reference 609: \t\t$Simplezip = new Simplezip();",
        "// Line_Reference 610: \t\t$Simplezip->addFolder($tmpDir);",
        "// Line_Reference 611: \t\t$Simplezip->download($fileName);",
        "// Line_Reference 613: \t\texit();",
        "// Line_Reference 678: \t\t$path = BASER_THEMES . $this->siteConfigs['theme'] . DS;",
        "// Line_Reference 680: \t\t\t'from' => $path,",
        "// Line_Reference 681: \t\t\t'to' => $tmpDir . $this->siteConfigs['theme'],",
        "// Line_Reference 684: \t\t$Simplezip = new Simplezip();",
        "// Line_Reference 685: \t\t$Simplezip->addFolder($tmpDir);",
        "// Line_Reference 686: \t\t$Simplezip->download($this->siteConfigs['theme']);"
    ]
}
