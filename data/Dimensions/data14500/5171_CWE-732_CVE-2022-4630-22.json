{
    "cve_id": "CVE-2022-4630",
    "cve_description": "Sensitive Cookie Without 'HttpOnly' Flag in GitHub repository lirantal/daloradius prior to master.",
    "cve_publish_date": "2022-12-21",
    "cwe_id": "CWE-732",
    "cwe_name": "Incorrect Permission Assignment for Critical Resource",
    "cwe_description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
    "commit_message": "Improved attribute dictionaries management feature (#316)\n\nImproved layout and other minor features",
    "type_of_change": "Modification",
    "filename_of_changes": "menu-bill-history.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "71",
    "number_of_lines_deleted_vulnerable_to_cve": "81",
    "vulnerable_lines": [
        "// Line_Reference 26:     header(\"Location: /index.php\");",
        "// Line_Reference 37: $checkboxes = array(",
        "// Line_Reference 38:                         \"id\" => t('all','ID'),",
        "// Line_Reference 39:                         \"username\" => t('all','Username'),",
        "// Line_Reference 40:                         \"planId\" => t('all','PlanId'),",
        "// Line_Reference 41: ",
        "// Line_Reference 42:                         \"billAmount\" => t('all','BillAmount'),",
        "// Line_Reference 43:                         \"billAction\" => t('all','BillAction'),",
        "// Line_Reference 44:                         \"billPerformer\" => t('all','BillPerformer'),",
        "// Line_Reference 45:                         \"billReason\" => t('all','BillReason'),",
        "// Line_Reference 46: ",
        "// Line_Reference 47:                         \"paymentmethod\" => t('ContactInfo','PaymentMethod'),",
        "// Line_Reference 48:                         \"cash\" => t('ContactInfo','Cash'),",
        "// Line_Reference 49: ",
        "// Line_Reference 50:                         \"creditcardname\" => t('ContactInfo','CreditCardName'),",
        "// Line_Reference 51:                         \"creditcardnumber\" => t('ContactInfo','CreditCardNumber'),",
        "// Line_Reference 52:                         \"creditcardverification\" => t('ContactInfo','CreditCardVerificationNumber'),",
        "// Line_Reference 53:                         \"creditcardtype\" => t('ContactInfo','CreditCardType'),",
        "// Line_Reference 54:                         \"creditcardexp\" => t('ContactInfo','CreditCardExpiration'),",
        "// Line_Reference 55:                         \"coupon\" => t('all','Coupon'),",
        "// Line_Reference 56:                         \"discount\" => t('all','Discount'),",
        "// Line_Reference 57:                         \"notes\" => t('ContactInfo','Notes'),",
        "// Line_Reference 58:                         \"creationdate\" => t('all','CreationDate'),",
        "// Line_Reference 59:                         \"creationby\" => t('all','CreationBy'),",
        "// Line_Reference 60:                         \"updatedate\" => t('all','UpdateDate'),",
        "// Line_Reference 61:                         \"updateby\" => t('all','UpdateBy')",
        "// Line_Reference 62:                     );",
        "// Line_Reference 63: ",
        "// Line_Reference 64: $checkboxes_checked = array(",
        "// Line_Reference 65:                                 \"username\",",
        "// Line_Reference 66:                                 \"planId\",",
        "// Line_Reference 67:                                 \"billAmount\",",
        "// Line_Reference 68:                                 \"billAction\",",
        "// Line_Reference 69:                                 \"billPerformer\",",
        "// Line_Reference 70:                                 \"paymentmethod\"",
        "// Line_Reference 71:                            );",
        "// Line_Reference 72: ",
        "// Line_Reference 85: ",
        "// Line_Reference 86:                             <h109><?= t('button','BetweenDates') ?></h109><br>",
        "// Line_Reference 94: ",
        "// Line_Reference 95:                             <br><br>",
        "// Line_Reference 97:                             <h109><?= t('all','Username') ?></h109><br>",
        "// Line_Reference 98:                             <input name=\"username\" type=\"text\"",
        "// Line_Reference 99:                                 value=\"<?= (isset($billing_history_username)) ? $billing_history_username : \"*\" ?>\">",
        "// Line_Reference 100: ",
        "// Line_Reference 101:                             <h109><?= t('all','BillAction') ?></h109><br>",
        "// Line_Reference 102:                             <select name=\"billaction\" size=\"1\">",
        "// Line_Reference 103:                                 <option value=\"<?= (isset($billing_history_billaction)) ? $billing_history_billaction : \"%\" ?>\">",
        "// Line_Reference 104:                                     <?= (isset($billing_history_billaction)) ? $billing_history_billaction : \"Any\" ?>",
        "// Line_Reference 105:                                 </option>",
        "// Line_Reference 106: ",
        "// Line_Reference 107:                                 <option value=\"\"></option>",
        "// Line_Reference 108:                                 <option value=\"Refill Session Time\">Refill Session Time</option>",
        "// Line_Reference 109:                                 <option value=\"Refill Session Traffic\">Refill Session Traffic</option>",
        "// Line_Reference 110:                             </select>",
        "// Line_Reference 113: ",
        "// Line_Reference 114:                             <h109><?= t('button','AccountingFieldsinQuery') ?></h109><br>",
        "// Line_Reference 116:                             foreach ($checkboxes as $value => $caption) {",
        "// Line_Reference 117:                                 $checked = in_array($value, $checkboxes_checked) ? ' checked' : '';",
        "// Line_Reference 118:                                 printf('<input type=\"checkbox\" name=\"sqlfields[]\" value=\"%s\"%s><h109>%s</h109><br>', $value, $checked, $caption);",
        "// Line_Reference 119:                             }",
        "// Line_Reference 121: ",
        "// Line_Reference 122:                             <br>Select:",
        "// Line_Reference 123:                             <a class=\"table\" href=\"javascript:SetChecked(1,'sqlfields[]','billhistory')\">All</a>",
        "// Line_Reference 124:                             <a class=\"table\" href=\"javascript:SetChecked(0,'sqlfields[]','billhistory')\">None</a>",
        "// Line_Reference 125: ",
        "// Line_Reference 127: ",
        "// Line_Reference 128:                             <h109><?= t('button','OrderBy') ?><h109><br>",
        "// Line_Reference 129:                             <div style=\"text-align: center\">",
        "// Line_Reference 130:                                 <select name=\"orderBy\" size=\"1\">",
        "// Line_Reference 131:                                     <option value=\"id\"> Id </option>",
        "// Line_Reference 132:                                     <option value=\"username\"> username </option>",
        "// Line_Reference 133:                                     <option value=\"txnId\"> txnId </option>",
        "// Line_Reference 134:                                 </select>",
        "// Line_Reference 136:                                 <select name=\"orderType\" size=\"1\">",
        "// Line_Reference 137:                                     <option value=\"ASC\"> Ascending </option>",
        "// Line_Reference 138:                                     <option value=\"DESC\"> Descending </option>",
        "// Line_Reference 139:                                 </select>",
        "// Line_Reference 140:                             </div>",
        "// Line_Reference 141: ",
        "// Line_Reference 142:                             <br><br>"
    ]
}
