{
    "cve_id": "CVE-2022-23475",
    "cve_description": "daloRADIUS is an open source RADIUS web management application. daloRadius 1.3 and prior are vulnerable to a combination cross site scripting (XSS) and cross site request forgery (CSRF) vulnerability which leads to account takeover in the mng-del.php file because of an unescaped variable reflected in the DOM on line 116. This issue has been addressed in commit `ec3b4a419e`. Users are advised to manually apply the commit in order to mitigate this issue. Users may also mitigate this issue with in two parts 1) The CSRF vulnerability can be mitigated  by making the daloRadius session cookie to samesite=Lax or by the implimentation of a CSRF token in all forms. 2) The XSS vulnerability may be mitigated by escaping it or by introducing a Content-Security policy.\n\n\n",
    "cve_publish_date": "2022-12-06",
    "cwe_id": "CWE-352",
    "cwe_name": "Cross-Site Request Forgery (CSRF)",
    "cwe_description": "The web application does not, or can not, sufficiently verify whether a well-formed, valid, consistent request was intentionally provided by the user who submitted the request.",
    "commit_message": "Improvements to PDF ticket printing and security issues fix/mitigation (#297)\n\n* Improved notification and ticket printing features\r\n\r\n* minor template fixes\r\n\r\n* fixed redirection on checklogin\r\n\r\n* addressed some security issues",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "rep-batch-details.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "18",
    "number_of_lines_deleted_vulnerable_to_cve": "35",
    "vulnerable_lines": [
        "// Line_Reference 89: ",
        "// Line_Reference 90: ?>",
        "// Line_Reference 91: ",
        "// Line_Reference 92:         <div id=\"contentnorightbar\">",
        "// Line_Reference 93:             <h2 id=\"Intro\">",
        "// Line_Reference 94:                 <a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\">",
        "// Line_Reference 95:                     <?= t('Intro','repbatchdetails.php'); ?><h144>&#x2754;</h144>",
        "// Line_Reference 96:                 </a>",
        "// Line_Reference 97:             </h2>",
        "// Line_Reference 98: ",
        "// Line_Reference 99:             <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage','repbatchdetails') ?><br></div>",
        "// Line_Reference 100: ",
        "// Line_Reference 101: <?php",
        "// Line_Reference 151:                         onclick=\"location.href='include/common/notificationsBatchDetails.php?batch_name=<?= urlencode($batch_name_enc) ?>&destination=download'\">",
        "// Line_Reference 321: ?>",
        "// Line_Reference 322: ",
        "// Line_Reference 323: </div><!-- #contentnorightbar -->",
        "// Line_Reference 324: ",
        "// Line_Reference 325:         <div id=\"footer\">",
        "// Line_Reference 326: <?php",
        "// Line_Reference 328:     include('page-footer.php');",
        "// Line_Reference 330:         </div><!-- #footer -->",
        "// Line_Reference 331:     </div>",
        "// Line_Reference 332: </div>",
        "// Line_Reference 333: ",
        "// Line_Reference 334: <script>",
        "// Line_Reference 335:     var tooltipObj = new DHTMLgoodies_formTooltip();",
        "// Line_Reference 336:     tooltipObj.setTooltipPosition('right');",
        "// Line_Reference 337:     tooltipObj.setPageBgColor('#EEEEEE');",
        "// Line_Reference 338:     tooltipObj.setTooltipCornerSize(15);",
        "// Line_Reference 339:     tooltipObj.initFormFieldTooltip();",
        "// Line_Reference 340: </script>",
        "// Line_Reference 341: ",
        "// Line_Reference 342: </body>",
        "// Line_Reference 343: </html>"
    ]
}
