import com.thoughtworks.go.security.CryptoException;
import com.thoughtworks.go.security.GoCipher;
import static com.thoughtworks.go.util.ExceptionUtils.bomb;
import static org.apache.commons.lang3.StringUtils.isBlank;
protected final GoCipher goCipher;
protected String encryptedPassword;
public ScmMaterial(String typeName, GoCipher goCipher) {
this.goCipher = goCipher;
if (StringUtils.isBlank(passwordToSet)) {
encryptedPassword = null;
}
this.encryptedPassword = StringUtils.stripToNull(encryptedPassword);
if (this.password == null) {
return;
}
try {
this.encryptedPassword = this.goCipher.encrypt(password);
} catch (Exception e) {
bomb("Password encryption failed. Please verify your cipher key.", e);
}
this.password = null;
public final void setEncryptedPassword(String encryptedPassword) {
this.encryptedPassword = encryptedPassword;
}
public final String getEncryptedPassword() {
return encryptedPassword;
}
return currentPassword();
public final String currentPassword() {
try {
return isBlank(encryptedPassword) ? null : this.goCipher.decrypt(encryptedPassword);
} catch (CryptoException e) {
throw new RuntimeException("Could not decrypt the password to get the real password", e);
}
}
