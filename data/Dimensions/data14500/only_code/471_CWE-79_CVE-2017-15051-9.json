$label = noHTML(htmlspecialchars_decode($dataReceived['label']));
$url = htmlspecialchars_decode($dataReceived['url']);
$login = htmlspecialchars_decode($dataReceived['login']);
$label = noHTML(($dataReceived['label']));
$url = noHTML(htmlspecialchars_decode($dataReceived['url']));
$login = noHTML(htmlspecialchars_decode($dataReceived['login']));
$email = noHTML(htmlspecialchars_decode($dataReceived['email']));
(@in_array(
$post_id,
$_SESSION['list_folders_limited'][$post_folder_id]
))
$returnValues = '[{"error" : "not_allowed"}, {"error_text" : "2'.addslashes($LANG['error_not_allowed_to']).'"}]';
if (null !== $post_item_id
&& empty($post_item_id) === false
$rows_tmp = DB::query("SELECT role_id FROM ".prefix_table("restriction_to_roles")." WHERE item_id=%i", $post_id);
$myTest = 0;
if (in_array($_SESSION['user_id'], $rows_tmp)) {
$myTest = 1;
if (null !== filter_input(INPUT_POST, 'salt_key_required', FILTER_SANITIZE_STRING)
&& filter_input(INPUT_POST, 'salt_key_required', FILTER_SANITIZE_STRING) === '1'
&& null !== filter_input(INPUT_POST, 'salt_key_set', FILTER_SANITIZE_STRING)
&& filter_input(INPUT_POST, 'salt_key_set', FILTER_SANITIZE_STRING) === '1'
if (null !== filter_input(INPUT_POST, 'expired_item', FILTER_SANITIZE_STRING)
&& filter_input(INPUT_POST, 'expired_item', FILTER_SANITIZE_STRING) === '1'
&& isset($_SESSION['list_folders_limited'][$post_folder_id])
&& in_array($post_id, $_SESSION['list_folders_limited'][$post_folder_id]))
if (null !== filter_input(INPUT_POST, 'restricted', FILTER_SANITIZE_STRING)) {
$arrData['restricted'] = filter_input(INPUT_POST, 'restricted', FILTER_SANITIZE_STRING);
"has_change_proposal" => DB::count()
case "update_rep":
$title = htmlspecialchars_decode($dataReceived['title']);
$dataReceived['folder']
$dataReceived['folder']
$dataReceived['folder'],
$dataReceived['source_folder_id']
$dataReceived['target_folder_id']
if ($tree->isChildOf($dataReceived['target_folder_id'], $dataReceived['source_folder_id']) === true) {
'parent_id' => $dataReceived['target_folder_id']
$dataReceived['source_folder_id']
/*
* CASE
* WANT TO CLIPBOARD PW/LOGIN OF ITEM
*/
case "get_clipboard_item":
$dataItem = DB::queryfirstrow(
"SELECT pw,login,perso FROM ".prefix_table("items")." WHERE id=%i",
$post_id
);
if (filter_input(INPUT_POST, 'field', FILTER_SANITIZE_STRING) === "pw") {
if ($dataItem['perso'] === '1') {
$data = cryption(
$dataItem['pw'],
$_SESSION['user_settings']['session_psk'],
"decrypt"
);
} else {
$data = cryption(
$dataItem['pw'],
"",
"decrypt"
);
}
} else {
$data = $dataItem['login'];
}
// Encrypt data to return
echo prepareExchangedData($data, "encode");
break;
"SELECT name,id_item,file
