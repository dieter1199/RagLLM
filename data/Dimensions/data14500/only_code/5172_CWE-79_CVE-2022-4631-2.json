Version: 1.69
Copyright 2016  Lester Chan  (email : lesterchan@gmail.com)
if( isset( $banned_stats['count'] ) ) {
if( isset( $banned_stats['users'][$banned_ip] ) ) {
add_action('init', 'banned');
if($ip == 'unknown') {
$banned_ips = get_option('banned_ips');
if(is_array($banned_ips))
$banned_ips = array_filter($banned_ips);
$banned_ips_range = get_option('banned_ips_range');
if(is_array($banned_ips_range))
$banned_ips_range = array_filter($banned_ips_range);
$banned_hosts = get_option('banned_hosts');
if(is_array($banned_hosts))
$banned_hosts = array_filter($banned_hosts);
$banned_referers = get_option('banned_referers');
if(is_array($banned_referers))
$banned_referers = array_filter($banned_referers);
$banned_user_agents = get_option('banned_user_agents');
if(is_array($banned_user_agents))
$banned_user_agents = array_filter($banned_user_agents);
if(is_array($banned_exclude_ips))
$banned_exclude_ips = array_filter($banned_exclude_ips);
if(!empty($banned_exclude_ips)) {
foreach($banned_exclude_ips as $banned_exclude_ip) {
if($ip == $banned_exclude_ip) {
if( ! $is_excluded ) {
if( ! empty( $banned_ips_range ) ) {
if( ! empty( $banned_hosts ) ) {
if( ! empty( $banned_referers ) && ! empty( $_SERVER['HTTP_REFERER'] ) ) {
if( ! empty( $banned_user_agents ) && ! empty( $_SERVER['HTTP_USER_AGENT'] ) ) {
add_option('banned_message', '<!DOCTYPE html>'."\n".
'<html>'."\n".