{
    "cve_id": "CVE-2016-7781",
    "cve_description": "SQL injection vulnerability in framework/modules/blog/controllers/blogController.php in Exponent CMS 2.3.9 and earlier allows remote attackers to execute arbitrary SQL commands via the author parameter.",
    "cve_publish_date": "2017-03-07",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "iniitial effort to greatly enhance system security (xss, sql inject, file exploit, rce, etc...)",
    "type_of_change": "Modification",
    "filename_of_changes": "expPaginator.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "74",
    "number_of_lines_deleted_vulnerable_to_cve": "66",
    "vulnerable_lines": [
        "// Line_Reference 26:  *",
        "// Line_Reference 28:  *",
        "// Line_Reference 33:  *      'where'=>1,",
        "// Line_Reference 41:  *",
        "// Line_Reference 55: \tpublic $where = '';",
        "// Line_Reference 94:      */",
        "// Line_Reference 109: \t\tglobal $router,$db;",
        "// Line_Reference 115:         $this->limit = empty($params['limit']) ? 0 : $params['limit'];",
        "// Line_Reference 121: \t\t$this->order = empty($params['order']) ? 'id' : $params['order'];",
        "// Line_Reference 122: \t\t$this->dir = empty($params['dir']) ? 'ASC' : $params['dir'];",
        "// Line_Reference 123: \t\t$this->src = empty($params['src']) ? null : $params['src'];",
        "// Line_Reference 140: ",
        "// Line_Reference 148: ",
        "// Line_Reference 170: ",
        "// Line_Reference 175: \t\t$this->order_direction = $this->dir;",
        "// Line_Reference 212: ",
        "// Line_Reference 218: ",
        "// Line_Reference 230: \t\t}",
        "// Line_Reference 317: ",
        "// Line_Reference 356: ",
        "// Line_Reference 361: ",
        "// Line_Reference 373: ",
        "// Line_Reference 376: ",
        "// Line_Reference 410: \t\t        $this->last_pagelink = $this->total_pages;",
        "// Line_Reference 436: \t\tfor($i=$this->first_pagelink; $i<=$this->last_pagelink; $i++) {",
        "// Line_Reference 439: \t\t}",
        "// Line_Reference 444: ",
        "// Line_Reference 446: ",
        "// Line_Reference 448: ",
        "// Line_Reference 457: ",
        "// Line_Reference 461: ",
        "// Line_Reference 463: ",
        "// Line_Reference 468:         $func = new ReflectionClass($this);",
        "// Line_Reference 472:                 $newParams[$propname] = $params[$propname];",
        "// Line_Reference 473:             }",
        "// Line_Reference 474:         }",
        "// Line_Reference 478:                 $newParams[$propname] = $params[$propname];",
        "// Line_Reference 479:             }",
        "// Line_Reference 480:         }",
        "// Line_Reference 481: ",
        "// Line_Reference 484: ",
        "// Line_Reference 490: ",
        "// Line_Reference 497: ",
        "// Line_Reference 505: ",
        "// Line_Reference 511: ",
        "// Line_Reference 515:                 }",
        "// Line_Reference 518: ",
        "// Line_Reference 527: ",
        "// Line_Reference 568: ",
        "// Line_Reference 573: ",
        "// Line_Reference 588:         }",
        "// Line_Reference 590: ",
        "// Line_Reference 603: ",
        "// Line_Reference 611: ",
        "// Line_Reference 620: ",
        "// Line_Reference 626: ",
        "// Line_Reference 635: \t\t\t\t}",
        "// Line_Reference 637: \t\t\t\t$params['order'] = $col;",
        "// Line_Reference 638: ",
        "// Line_Reference 639: \t\t\t\tif (!empty($col)) {",
        "// Line_Reference 641:                         $params['dir'] = 'ASC';",
        "// Line_Reference 643:                         $params['dir'] = 'DESC';",
        "// Line_Reference 646:                         $params['dir'] = 'ASC';",
        "// Line_Reference 650:                     }",
        "// Line_Reference 651: \t\t\t\t}",
        "// Line_Reference 655: "
    ]
}
