{
    "cve_id": "CVE-2020-15255",
    "cve_description": "In Anuko Time Tracker before verion 1.19.23.5325, due to not properly filtered user input a CSV export of a report could contain cells that are treated as formulas by spreadsheet software (for example, when a cell value starts with an equal sign). This is fixed in version 1.19.23.5325.",
    "cve_publish_date": "2020-10-16",
    "cwe_id": "CWE-1236",
    "cwe_name": "Improper Neutralization of Formula Elements in a CSV File",
    "cwe_description": "The product saves user-provided information into a Comma-Separated Value (CSV) file, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as a command when the file is opened by a spreadsheet product.",
    "commit_message": "Security fix for csv injections.",
    "type_of_change": "Modification",
    "filename_of_changes": "tofile.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "11",
    "number_of_lines_deleted_vulnerable_to_cve": "11",
    "vulnerable_lines": [
        "// Line_Reference 221:         if ($bean->getAttribute($checkbox_control_name)) print ',\"'.str_replace('\"','\"\"',$userField['label']).'\"';",
        "// Line_Reference 232:         if ($bean->getAttribute($checkbox_control_name)) print ',\"'.str_replace('\"','\"\"',$timeField['label']).'\"';",
        "// Line_Reference 251:       if ($user->can('view_reports') || $user->can('view_all_reports') || $user->isClient()) print ',\"'.str_replace('\"','\"\"',$item['user']).'\"';",
        "// Line_Reference 257:           if ($bean->getAttribute($checkbox_control_name)) print ',\"'.str_replace('\"','\"\"',$item[$field_name]).'\"';",
        "// Line_Reference 260:       if ($bean->getAttribute('chclient')) print ',\"'.str_replace('\"','\"\"',$item['client']).'\"';",
        "// Line_Reference 261:       if ($bean->getAttribute('chproject')) print ',\"'.str_replace('\"','\"\"',$item['project']).'\"';",
        "// Line_Reference 262:       if ($bean->getAttribute('chtask')) print ',\"'.str_replace('\"','\"\"',$item['task']).'\"';",
        "// Line_Reference 268:           if ($bean->getAttribute($checkbox_control_name)) print ',\"'.str_replace('\"','\"\"',$item[$field_name]).'\"';",
        "// Line_Reference 280:       if ($bean->getAttribute('chnote')) print ',\"'.str_replace('\"','\"\"',$item['note']).'\"';",
        "// Line_Reference 293:       if ($bean->getAttribute('chinvoice')) print ',\"'.str_replace('\"','\"\"',$item['invoice']).'\"';",
        "// Line_Reference 294:       if ($bean->getAttribute('chtimesheet')) print ',\"'.str_replace('\"','\"\"',$item['timesheet_name']).'\"';"
    ]
}
