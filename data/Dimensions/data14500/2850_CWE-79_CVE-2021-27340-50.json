{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "Courses.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "43",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 2030:             $header .= '<div class=\"form-group\"><label class=\"col-md-4 control-label text-right\">'._primaryTeacher.'</label><div class=\"col-md-8\">' . SelectInputDisabledMsg($RET['TEACHER_ID'], 'tables[course_periods][' . $_REQUEST['course_period_id'] . '][TEACHER_ID]', '', $teachers, 'N/A', '', $div, \"\"._toChangeTeacherGoToSchoolSetupCoursesTeacherReAssignment.\"\") . '</div></div>';",
        "// Line_Reference 2032:             $header .= '<div class=\"form-group\"><label class=\"col-md-4 control-label text-right\">'._primaryTeacher.'</label><div class=\"col-md-8\">' . SelectInput($RET['TEACHER_ID'], 'tables[course_periods][' . $_REQUEST['course_period_id'] . '][TEACHER_ID]', '', $teachers, 'N/A', '', $div) . '</div></div>';",
        "// Line_Reference 2038:         $header .= '<div class=\"form-group\"><label class=\"col-md-4 control-label text-right\">'._secondaryTeacher.'</label><div class=\"col-md-8\">' . SelectInput($RET['SECONDARY_TEACHER_ID'], 'tables[course_periods][' . $_REQUEST['course_period_id'] . '][SECONDARY_TEACHER_ID]', '', $teachers, 'N/A', '', $div) . '</div></div>';",
        "// Line_Reference 2548:             $sql = \"SELECT COURSE_PERIOD_ID,TITLE,COALESCE(TOTAL_SEATS-FILLED_SEATS,0) AS AVAILABLE_SEATS FROM course_periods WHERE COURSE_ID='$_REQUEST[course_id]' AND (marking_period_id IN(\" . GetAllMP(GetMPTable(GetMP(UserMP(), 'TABLE')), UserMP()) . \") OR (MARKING_PERIOD_ID IS NULL)) ORDER BY TITLE\";"
    ]
}
