{
    "cve_id": "CVE-2021-32663",
    "cve_description": "iTop is an open source web based IT Service Management tool. In affected versions an attacker can call the system setup without authentication. Given specific parameters this can lead to SSRF. This issue has been resolved in versions 2.6.5 and 2.7.5 and later",
    "cve_publish_date": "2021-10-19",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "NÂ°3952 - code hardening",
    "type_of_change": "Modification",
    "filename_of_changes": "ajax.dataloader.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "8",
    "vulnerable_lines": [
        "// Line_Reference 150: \t$sAuthent = utils::ReadParam('authent', '', false, 'raw_data');",
        "// Line_Reference 151: \tif (!file_exists(APPROOT.'data/setup/authent') || $sAuthent !== file_get_contents(APPROOT.'data/setup/authent'))",
        "// Line_Reference 152: \t{",
        "// Line_Reference 153: \t\tthrow new SecurityException('Setup operations are not allowed outside of the setup');",
        "// Line_Reference 154: \t\tSetupPage::log_error(\"Setup operations are not allowed outside of the setup\");",
        "// Line_Reference 155: \t}",
        "// Line_Reference 202: \techo '<p>'.$e.\"</p>\\n\";",
        "// Line_Reference 210: \t\tSetupPage::log_info(\"loading file '$sFileName', peak memory usage. \".memory_get_peak_usage());"
    ]
}
