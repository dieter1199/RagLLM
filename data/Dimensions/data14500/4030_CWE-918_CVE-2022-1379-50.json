{
    "cve_id": "CVE-2022-1379",
    "cve_description": "URL Restriction Bypass in GitHub repository plantuml/plantuml prior to V1.2022.5. An attacker can abuse this to bypass URL restrictions that are imposed by the different security profiles and achieve server side request forgery (SSRF). This allows accessing restricted internal resources/servers or sending requests to third party servers.",
    "cve_publish_date": "2022-05-14",
    "cwe_id": "CWE-918",
    "cwe_name": "Server-Side Request Forgery (SSRF)",
    "cwe_description": "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",
    "commit_message": "Import version 1.2022.5",
    "type_of_change": "Modification",
    "filename_of_changes": "GeneralImageBuilder.java",
    "code_language": "Java",
    "number_of_lines_added_for_mitigation": "19",
    "number_of_lines_deleted_vulnerable_to_cve": "17",
    "vulnerable_lines": [
        "// Line_Reference 105: import net.sourceforge.plantuml.style.StyleSignature;",
        "// Line_Reference 706: \t\tfinal FontConfiguration fontConfiguration;",
        "// Line_Reference 707: \t\tif (UseStyle.useBetaStyle()) {",
        "// Line_Reference 708: \t\t\tfinal SName sname = dotData.getUmlDiagramType().getStyleName();",
        "// Line_Reference 709: \t\t\tfinal StyleSignatureBasic signature;",
        "// Line_Reference 710: \t\t\tfinal USymbol uSymbol = g.getUSymbol();",
        "// Line_Reference 711: \t\t\tif (uSymbol == USymbols.RECTANGLE)",
        "// Line_Reference 712: \t\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, uSymbol.getSName(), SName.title);",
        "// Line_Reference 713: \t\t\telse",
        "// Line_Reference 714: \t\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, SName.title);",
        "// Line_Reference 716: \t\t\tfinal Style style = signature //",
        "// Line_Reference 717: \t\t\t\t\t.withTOBECHANGED(g.getStereotype()) //",
        "// Line_Reference 718: \t\t\t\t\t.with(g.getStereostyles()) //",
        "// Line_Reference 719: \t\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder());",
        "// Line_Reference 721: \t\t\tfontConfiguration = style.getFontConfiguration(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());",
        "// Line_Reference 722: \t\t} else",
        "// Line_Reference 723: \t\t\tfontConfiguration = g.getFontConfigurationForTitle(skinParam);"
    ]
}
