{
    "cve_id": "CVE-2018-17553",
    "cve_description": "An \"Unrestricted Upload of File with Dangerous Type\" issue with directory traversal in navigate_upload.php in Naviwebs Navigate CMS 2.8 allows authenticated attackers to achieve remote code execution via a POST request with engine=picnik and id=../../../navigate_info.php.",
    "cve_publish_date": "2018-10-03",
    "cwe_id": "CWE-22",
    "cwe_name": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
    "cwe_description": "The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.",
    "commit_message": "- files: removed unused code related to \"picnik\" upload",
    "type_of_change": "Modification",
    "filename_of_changes": "navigate_upload.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "1",
    "number_of_lines_deleted_vulnerable_to_cve": "24",
    "vulnerable_lines": [
        "// Line_Reference 86: // no maximum uploading / execution time",
        "// Line_Reference 89: //file_put_contents(NAVIGATE_PRIVATE.'/'.$website->id.'/files/out.txt', print_r($_FILES, true));",
        "// Line_Reference 90: ",
        "// Line_Reference 139: else if($_REQUEST['engine']=='picnik')",
        "// Line_Reference 140: {",
        "// Line_Reference 141: \t// PHP script to receive image data from Picnik via HTTP POST",
        "// Line_Reference 142: \t// retrieve the image's attributes from the $_FILES array",
        "// Line_Reference 143: \t$image_tmp_filename = $_FILES['file']['tmp_name'];",
        "// Line_Reference 144: \t$image_filename = $_FILES['file']['name'];",
        "// Line_Reference 145: ",
        "// Line_Reference 146: \t// Save the image to disk.  It'll go into the same directory as",
        "// Line_Reference 147: \t// this script.  You'd probably want to put it somewhere else in the",
        "// Line_Reference 148: \t// file system like a \"/images\" directory, or maybe even into a database.",
        "// Line_Reference 149: \t// Make sure your web server has write access to the destination dir,",
        "// Line_Reference 150: \t// or the call to file_put_contents isn't going to work.",
        "// Line_Reference 151: \t$image_data = file_get_contents( $image_tmp_filename );",
        "// Line_Reference 152: ",
        "// Line_Reference 153: \tif(!empty($_REQUEST['id']) && file_exists($targetDir.'/'.$_REQUEST['id']))",
        "// Line_Reference 154: \t{",
        "// Line_Reference 155: \t\tfile_put_contents( $targetDir.'/'.$_REQUEST['id'], $image_data );",
        "// Line_Reference 156: \t}",
        "// Line_Reference 157: ",
        "// Line_Reference 158: \tcore_terminate();",
        "// Line_Reference 159: }"
    ]
}
