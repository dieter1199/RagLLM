{
    "cve_id": "CVE-2018-25062",
    "cve_description": "A vulnerability classified as problematic has been found in flar2 ElementalX up to 6.x on Nexus 9. Affected is the function xfrm_dump_policy_done of the file net/xfrm/xfrm_user.c of the component ipsec. The manipulation leads to denial of service. Upgrading to version 7.00 is able to address this issue. The name of the patch is 1df72c9f0f61304437f4f1037df03b5fb36d5a79. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217152.",
    "cve_publish_date": "2023-01-01",
    "cwe_id": "CWE-404",
    "cwe_name": "Improper Resource Shutdown or Release",
    "cwe_description": "The product does not release or incorrectly releases a resource before it is made available for re-use.",
    "commit_message": "ipsec: Fix aborted xfrm policy dump crash\n\nAn independent security researcher, Mohamed Ghannam, has reported\nthis vulnerability to Beyond Security's SecuriTeam Secure Disclosure\nprogram.\n\nThe xfrm_dump_policy_done function expects xfrm_dump_policy to\nhave been called at least once or it will crash.  This can be\ntriggered if a dump fails because the target socket's receive\nbuffer is full.\n\nThis patch fixes it by using the cb->start mechanism to ensure that\nthe initialisation is always done regardless of the buffer situation.\n\nChange-Id: Id41cdd41c4e43e0c3ac30c5d03c15b8046d70845\nFixes: 12a169e7d8f4 (\"ipsec: Put dumpers on the dump list\")\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: Steffen Klassert <steffen.klassert@secunet.com>",
    "type_of_change": "Modification",
    "filename_of_changes": "xfrm_user.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "10",
    "vulnerable_lines": [
        "// Line_Reference 1556: \tstruct xfrm_policy_walk *walk = (struct xfrm_policy_walk *) &cb->args[1];",
        "// Line_Reference 1565: \tstruct xfrm_policy_walk *walk = (struct xfrm_policy_walk *) &cb->args[1];",
        "// Line_Reference 1568: \tBUILD_BUG_ON(sizeof(struct xfrm_policy_walk) >",
        "// Line_Reference 1569: \t\t     sizeof(cb->args) - sizeof(cb->args[0]));",
        "// Line_Reference 1570: ",
        "// Line_Reference 1576: \tif (!cb->args[0]) {",
        "// Line_Reference 1577: \t\tcb->args[0] = 1;",
        "// Line_Reference 1578: \t\txfrm_policy_walk_init(walk, XFRM_POLICY_TYPE_ANY);",
        "// Line_Reference 1579: \t}",
        "// Line_Reference 1580: "
    ]
}
