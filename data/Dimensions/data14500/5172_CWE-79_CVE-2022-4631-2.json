{
    "cve_id": "CVE-2022-4631",
    "cve_description": "A vulnerability, which was classified as problematic, was found in WP-Ban. Affected is an unknown function of the file ban-options.php. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. The name of the patch is 22b925449c84faa9b7496abe4f8f5661cb5eb3bf. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216480.",
    "cve_publish_date": "2022-12-21",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed XSS",
    "type_of_change": "Modification",
    "filename_of_changes": "wp-ban.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "33",
    "number_of_lines_deleted_vulnerable_to_cve": "33",
    "vulnerable_lines": [
        "// Line_Reference 6: Version: 1.69",
        "// Line_Reference 14: \tCopyright 2016  Lester Chan  (email : lesterchan@gmail.com)",
        "// Line_Reference 94: \tif( isset( $banned_stats['count'] ) ) {",
        "// Line_Reference 99: \tif( isset( $banned_stats['users'][$banned_ip] ) ) {",
        "// Line_Reference 159: add_action('init', 'banned');",
        "// Line_Reference 162: \tif($ip == 'unknown') {",
        "// Line_Reference 165: \t$banned_ips = get_option('banned_ips');",
        "// Line_Reference 166: \tif(is_array($banned_ips))",
        "// Line_Reference 167: \t\t$banned_ips = array_filter($banned_ips);",
        "// Line_Reference 169: \t$banned_ips_range = get_option('banned_ips_range');",
        "// Line_Reference 170: \tif(is_array($banned_ips_range))",
        "// Line_Reference 171: \t\t$banned_ips_range = array_filter($banned_ips_range);",
        "// Line_Reference 173: \t$banned_hosts = get_option('banned_hosts');",
        "// Line_Reference 174: \tif(is_array($banned_hosts))",
        "// Line_Reference 175: \t\t$banned_hosts = array_filter($banned_hosts);",
        "// Line_Reference 177: \t$banned_referers = get_option('banned_referers');",
        "// Line_Reference 178: \tif(is_array($banned_referers))",
        "// Line_Reference 179: \t\t$banned_referers = array_filter($banned_referers);",
        "// Line_Reference 181: \t$banned_user_agents = get_option('banned_user_agents');",
        "// Line_Reference 182: \tif(is_array($banned_user_agents))",
        "// Line_Reference 183: \t\t$banned_user_agents = array_filter($banned_user_agents);",
        "// Line_Reference 186: \tif(is_array($banned_exclude_ips))",
        "// Line_Reference 187: \t\t$banned_exclude_ips = array_filter($banned_exclude_ips);",
        "// Line_Reference 190: \tif(!empty($banned_exclude_ips)) {",
        "// Line_Reference 191: \t\tforeach($banned_exclude_ips as $banned_exclude_ip) {",
        "// Line_Reference 192: \t\t\tif($ip == $banned_exclude_ip) {",
        "// Line_Reference 199: \tif( ! $is_excluded ) {",
        "// Line_Reference 203: \t\tif( ! empty( $banned_ips_range ) ) {",
        "// Line_Reference 206: \t\tif( ! empty( $banned_hosts ) ) {",
        "// Line_Reference 209: \t\tif( ! empty( $banned_referers ) && ! empty( $_SERVER['HTTP_REFERER'] ) ) {",
        "// Line_Reference 212: \t\tif( ! empty( $banned_user_agents ) && ! empty( $_SERVER['HTTP_USER_AGENT'] ) ) {",
        "// Line_Reference 302: \tadd_option('banned_message', '<!DOCTYPE html>'.\"\\n\".",
        "// Line_Reference 303: \t'<html>'.\"\\n\"."
    ]
}
