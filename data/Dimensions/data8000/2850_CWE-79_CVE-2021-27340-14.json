{
    "cve_id": "CVE-2021-27340",
    "cve_description": "OpenSIS Community Edition version <= 7.6 is affected by a reflected XSS vulnerability in EmailCheck.php via the \"opt\" parameter.",
    "cve_publish_date": "2021-09-16",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Commit with security and bug fixes",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "EmailCheck.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "29",
    "number_of_lines_deleted_vulnerable_to_cve": "37",
    "vulnerable_lines": [
        "// Line_Reference 3: #  openSIS is a free student information system for public and non-public",
        "// Line_Reference 6: #  openSIS is  web-based, open source, and comes packed with features that",
        "// Line_Reference 7: #  include student demographic info, scheduling, grade book, attendance,",
        "// Line_Reference 8: #  report cards, eligibility, transcripts, parent portal,",
        "// Line_Reference 9: #  student portal and more.",
        "// Line_Reference 12: #  If you have question regarding this system or the license, please send",
        "// Line_Reference 15: #  This program is released under the terms of the GNU General Public License as",
        "// Line_Reference 16: #  published by the Free Software Foundation, version 2 of the License.",
        "// Line_Reference 28: include('RedirectRootInc.php');",
        "// Line_Reference 29: \tinclude 'Warehouse.php';",
        "// Line_Reference 30: \tinclude 'Data.php';",
        "// Line_Reference 35: ",
        "// Line_Reference 36:         if(isset($_REQUEST['email']) && $_REQUEST['email']!='')",
        "// Line_Reference 37:         {",
        "// Line_Reference 38:             if($_REQUEST['p_id']==0)",
        "// Line_Reference 39:             {",
        "// Line_Reference 40:         $result=DBGet(DBQuery('SELECT STAFF_ID FROM people WHERE EMAIL=\\''.$email.'\\''));",
        "// Line_Reference 41:         $res_stf=DBGet(DBQuery('SELECT STAFF_ID FROM staff WHERE EMAIL=\\''.$email.'\\''));",
        "// Line_Reference 42:         $res_stu=DBGet(DBQuery('SELECT STUDENT_ID FROM students WHERE EMAIL=\\''.$email.'\\''));",
        "// Line_Reference 43:             }",
        "// Line_Reference 44:             else",
        "// Line_Reference 45:             {",
        "// Line_Reference 46:         $result=DBGet(DBQuery('SELECT STAFF_ID FROM people WHERE EMAIL=\\''.$email.'\\' AND STAFF_ID!='.$p_id));",
        "// Line_Reference 47:         $res_stf=DBGet(DBQuery('SELECT STAFF_ID FROM staff WHERE EMAIL=\\''.$email.'\\''));",
        "// Line_Reference 48:         $res_stu=DBGet(DBQuery('SELECT STUDENT_ID FROM students WHERE EMAIL=\\''.$email.'\\''));",
        "// Line_Reference 49:             }",
        "// Line_Reference 50:             if(count($result)>0 || count($res_stf)>0 ||  count($res_stu)>0)",
        "// Line_Reference 51:             {",
        "// Line_Reference 52:                 echo '0_'.$_REQUEST['opt'];",
        "// Line_Reference 53:             }",
        "// Line_Reference 54:             else",
        "// Line_Reference 55:             {",
        "// Line_Reference 56:                 echo '1_'.$_REQUEST['opt'];",
        "// Line_Reference 57:             }",
        "// Line_Reference 58:             exit;",
        "// Line_Reference 59:         }",
        "// Line_Reference 60: ?>"
    ]
}
