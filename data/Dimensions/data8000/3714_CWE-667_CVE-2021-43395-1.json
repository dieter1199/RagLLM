{
    "cve_id": "CVE-2021-43395",
    "cve_description": "An issue was discovered in illumos before f859e7171bb5db34321e45585839c6c3200ebb90, OmniOS Community Edition r151038, OpenIndiana Hipster 2021.04, and SmartOS 20210923. A local unprivileged user can cause a deadlock and kernel panic via crafted rename and rmdir calls on tmpfs filesystems. Oracle Solaris 10 and 11 is also affected.",
    "cve_publish_date": "2022-12-26",
    "cwe_id": "CWE-667",
    "cwe_name": "Improper Locking",
    "cwe_description": "The product does not properly acquire or release a lock on a resource, leading to unexpected resource state changes and behaviors.",
    "commit_message": "14424 tmpfs can be induced to deadlock\nReviewed by: Robert Mustacchi <rm@fingolfin.org>\nReviewed by: Andy Fiddaman <andy@omnios.org>\nReviewed by: Mike Zeller <mike.zeller@joyent.com>\nApproved by: Robert Mustacchi <rm@fingolfin.org>",
    "type_of_change": "Modification",
    "filename_of_changes": "tmp_dir.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "64",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 270: \t\tif (tp != dir)",
        "// Line_Reference 271: \t\t\trw_enter(&tp->tn_rwlock, RW_WRITER);"
    ]
}
