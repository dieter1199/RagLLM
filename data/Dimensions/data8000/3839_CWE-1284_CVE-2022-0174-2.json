{
    "cve_id": "CVE-2022-0174",
    "cve_description": "Improper Validation of Specified Quantity in Input vulnerability in dolibarr dolibarr/dolibarr.",
    "cve_publish_date": "2022-01-10",
    "cwe_id": "CWE-1284",
    "cwe_name": "Improper Validation of Specified Quantity in Input",
    "cwe_description": "The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.",
    "commit_message": "Fix error management",
    "type_of_change": "Modification",
    "filename_of_changes": "don.class.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "35",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 385: \t\t$sql .= \", \".price2num($this->amount);",
        "// Line_Reference 470: \t\t$sql = \"UPDATE \".MAIN_DB_PREFIX.\"don SET \";",
        "// Line_Reference 471: \t\t$sql .= \"amount = \".price2num($this->amount);",
        "// Line_Reference 472: \t\t$sql .= \",fk_payment = \".($this->modepaymentid ? $this->modepaymentid : \"null\");",
        "// Line_Reference 473: \t\t$sql .= \",firstname = '\".$this->db->escape($this->firstname).\"'\";",
        "// Line_Reference 474: \t\t$sql .= \",lastname='\".$this->db->escape($this->lastname).\"'\";",
        "// Line_Reference 475: \t\t$sql .= \",societe='\".$this->db->escape($this->societe).\"'\";",
        "// Line_Reference 476: \t\t$sql .= \",address='\".$this->db->escape($this->address).\"'\";",
        "// Line_Reference 477: \t\t$sql .= \",zip='\".$this->db->escape($this->zip).\"'\";",
        "// Line_Reference 478: \t\t$sql .= \",town='\".$this->db->escape($this->town).\"'\";",
        "// Line_Reference 479: \t\t$sql .= \",fk_country = \".($this->country_id > 0 ? ((int) $this->country_id) : '0');",
        "// Line_Reference 480: \t\t$sql .= \",public=\".((int) $this->public);",
        "// Line_Reference 481: \t\t$sql .= \",fk_projet=\".($this->fk_project > 0 ? $this->fk_project : 'null');",
        "// Line_Reference 482: \t\t$sql .= \",note_private=\".(!empty($this->note_private) ? (\"'\".$this->db->escape($this->note_private).\"'\") : \"NULL\");",
        "// Line_Reference 483: \t\t$sql .= \",note_public=\".(!empty($this->note_public) ? (\"'\".$this->db->escape($this->note_public).\"'\") : \"NULL\");",
        "// Line_Reference 484: \t\t$sql .= \",datedon='\".$this->db->idate($this->date).\"'\";",
        "// Line_Reference 485: \t\t$sql .= \",date_valid=\".($this->date_valid ? \"'\".$this->db->idate($this->date).\"'\" : \"null\");",
        "// Line_Reference 486: \t\t$sql .= \",email='\".$this->db->escape(trim($this->email)).\"'\";",
        "// Line_Reference 487: \t\t$sql .= \",phone='\".$this->db->escape(trim($this->phone)).\"'\";",
        "// Line_Reference 488: \t\t$sql .= \",phone_mobile='\".$this->db->escape(trim($this->phone_mobile)).\"'\";",
        "// Line_Reference 489: \t\t$sql .= \",fk_statut=\".((int) $this->statut);"
    ]
}
