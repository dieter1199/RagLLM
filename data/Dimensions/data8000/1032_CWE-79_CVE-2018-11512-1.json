{
    "cve_id": "CVE-2018-11512",
    "cve_description": "Stored cross-site scripting (XSS) vulnerability in the \"Website's name\" field found in the \"Settings\" page under the \"General\" menu in Creatiwity wityCMS 0.6.1 allows remote attackers to inject arbitrary web script or HTML via a crafted website name by doing an authenticated POST HTTP request to admin/settings/general.",
    "cve_publish_date": "2018-05-28",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "#146 - Uses HTML purifier and htmlspecialchars in search app",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "WRequest.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "2",
    "number_of_lines_deleted_vulnerable_to_cve": "21",
    "vulnerable_lines": [
        "// Line_Reference 237: \t\t\t// Prevent XSS abuse",
        "// Line_Reference 238: \t\t\t$variable = preg_replace_callback('#</?([a-z]+)(\\s.*)?/?>#i', function($matches) {",
        "// Line_Reference 239: \t\t\t\t$tag = strtolower($matches[1]);",
        "// Line_Reference 240: ",
        "// Line_Reference 241: \t\t\t\t// Allowed tags",
        "// Line_Reference 242: \t\t\t\tif (in_array($tag, array(",
        "// Line_Reference 243: \t\t\t\t\t'b', 'strong', 'small', 'i', 'em', 'u', 's', 'sub', 'sup', 'a', 'button', 'img', 'br',",
        "// Line_Reference 244: \t\t\t\t\t'font', 'span', 'blockquote', 'q', 'abbr', 'address', 'code', 'hr',",
        "// Line_Reference 245: \t\t\t\t\t'audio', 'video', 'source', 'iframe',",
        "// Line_Reference 246: \t\t\t\t\t'h1', 'h2', 'h3', 'h4', 'h5', 'h6',",
        "// Line_Reference 247: \t\t\t\t\t'ul', 'ol', 'li', 'dl', 'dt', 'dd',",
        "// Line_Reference 248: \t\t\t\t\t'div', 'p', 'var',",
        "// Line_Reference 249: \t\t\t\t\t'table', 'thead', 'tbody', 'tfoot', 'tr', 'th', 'td', 'colgroup', 'col',",
        "// Line_Reference 250: \t\t\t\t\t'section', 'article', 'aside'))) {",
        "// Line_Reference 251: \t\t\t\t\treturn $matches[0];",
        "// Line_Reference 252: \t\t\t\t} else if (in_array($tag, array('script', 'link'))) {",
        "// Line_Reference 253: \t\t\t\t\treturn '';",
        "// Line_Reference 254: \t\t\t\t} else {",
        "// Line_Reference 255: \t\t\t\t\treturn htmlentities($matches[0]);",
        "// Line_Reference 256: \t\t\t\t}",
        "// Line_Reference 257: \t\t\t}, $variable);"
    ]
}
