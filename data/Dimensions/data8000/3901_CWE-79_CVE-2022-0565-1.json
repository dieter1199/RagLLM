{
    "cve_id": "CVE-2022-0565",
    "cve_description": "Cross-site Scripting in Packagist pimcore/pimcore prior to 10.3.1.\n\n",
    "cve_publish_date": "2022-02-14",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Svg sanitization (#11386)\n\n* setting up the svg saniziter on logo and assets upload\r\n\r\n* more detailed exception message\r\n\r\n* changed to mime type check instead of file extension\r\n\r\n* adding the sanitization to \"Upload new version\"\r\n\r\n* refactor to sanitize on preAdd/preUpdate, rollback AssetController.php\r\n\r\n* fix resource|string, null given on mime_content_type\r\n\r\n* using symfony mime component + small tweaks\r\n\r\n* avoiding save without changes case\r\n\r\n* tweak when checking if is image type",
    "type_of_change": "ModificationType.ADD",
    "filename_of_changes": "SettingsController.php",
    "code_language": "PHP",
    "number_of_lines_added_for_mitigation": "20",
    "number_of_lines_deleted_vulnerable_to_cve": "4",
    "vulnerable_lines": [
        "// Line_Reference 112:         if ($fileExt === 'svg' && stripos(file_get_contents($_FILES['Filedata']['tmp_name']), '<script')) {",
        "// Line_Reference 113:             throw new \\Exception('Scripts in SVG files are not supported');",
        "// Line_Reference 114:         }",
        "// Line_Reference 117:         $storage->writeStream(self::CUSTOM_LOGO_PATH, fopen($_FILES['Filedata']['tmp_name'], 'rb'));"
    ]
}
