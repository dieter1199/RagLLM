{
    "cve_id": "CVE-2021-38171",
    "cve_description": "adts_decode_extradata in libavformat/adtsenc.c in FFmpeg 4.4 does not check the init_get_bits return value, which is a necessary step because the second argument to init_get_bits can be crafted.",
    "cve_publish_date": "2021-08-21",
    "cwe_id": "CWE-252",
    "cwe_name": "Unchecked Return Value",
    "cwe_description": "The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",
    "commit_message": "avformat/adtsenc: return value check for init_get_bits in adts_decode_extradata\n\nAs the second argument for init_get_bits (buf) can be crafted, a return value check for this function call is necessary.\n'buf' is  part of  'AVPacket pkt'.\nreplace init_get_bits with init_get_bits8.\n\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "type_of_change": "Modification",
    "filename_of_changes": "adtsenc.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "4",
    "number_of_lines_deleted_vulnerable_to_cve": "2",
    "vulnerable_lines": [
        "// Line_Reference 56:     int off;",
        "// Line_Reference 58:     init_get_bits(&gb, buf, size * 8);"
    ]
}
