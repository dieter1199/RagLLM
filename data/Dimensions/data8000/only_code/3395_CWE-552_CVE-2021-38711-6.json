import Network.Gitit.Export (exportFormats)
import Data.Maybe (isNothing, isJust, fromJust)
T.setAttribute "exportbox"
(renderHtmlFragment $  exportBox base' cfg page rev) .
exportBox :: String -> Config -> String -> Maybe String -> Html
exportBox base' cfg page rev | not (isSourceCode page) =
gui (base' ++ urlForPage page) ! [identifier "exportbox"] <<
([ textfield "revision" ! [thestyle "display: none;",
value (fromJust rev)] | isJust rev ] ++
[ select ! [name "format"] <<
map ((\f -> option ! [value f] << f) . fst) (exportFormats cfg)
, primHtmlChar "nbsp"
, submit "export" "Export" ])
exportBox _ _ _ _ = noHtml
