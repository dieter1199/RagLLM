//Receiving handler START
string answ = "";
bool flag = true;
bool upper = true;
while (flag)
{
int a = sr.Read();
if (upper)
{
answ += char.ToUpper((char)a);
} else
{
answ += (char)a;
}
if (a == 13)
{
flag = false;
}
if (a == 0x20)
{
upper = false;
}
if (answ.Length > 128)
{
client.Close();
}
}
answ = answ.Trim();
//Receiving handler END
if (r.IsMatch(temp) && temp.Length < 32 && temp.Length > 1 && (temp != "anonymous" && !AllowAnonymous))
var bytes = default(byte[]);
bytes = memstream.ToArray();
System.IO.File.WriteAllBytes("dumps/dump_i" + rnd.Next(1, 2000000000).ToString() + ".txt", bytes);
