if((ulen > SIZE_T_MAX/2) || (plen > (SIZE_T_MAX/2 - 2)))