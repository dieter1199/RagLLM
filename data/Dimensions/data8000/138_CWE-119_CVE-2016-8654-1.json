{
    "cve_id": "CVE-2016-8654",
    "cve_description": "A heap-buffer overflow vulnerability was found in QMFB code in JPC codec caused by buffer being allocated with too small size. jasper versions before 2.0.0 are affected.",
    "cve_publish_date": "2018-08-01",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "Fixed a buffer overrun problem in the QMFB code in the JPC codec\nthat was caused by a buffer being allocated with a size that was too small\nin some cases.\nAdded a new regression test case.",
    "type_of_change": "Modification",
    "filename_of_changes": "jpc_qmfb.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "15",
    "number_of_lines_deleted_vulnerable_to_cve": "13",
    "vulnerable_lines": [
        "// Line_Reference 377: \tint hstartcol;",
        "// Line_Reference 388: \t\thstartcol = (numrows + 1 - parity) >> 1;",
        "// Line_Reference 389: \t\t// ORIGINAL (WRONG): m = (parity) ? hstartcol : (numrows - hstartcol);",
        "// Line_Reference 390: \t\tm = numrows - hstartcol;",
        "// Line_Reference 411: \t\tdstptr = &a[hstartcol * stride];",
        "// Line_Reference 442: \tint hstartcol;",
        "// Line_Reference 446: \t\tif (!(buf = jas_alloc2(bufsize, sizeof(jpc_fix_t)))) {",
        "// Line_Reference 453: \t\thstartcol = (numrows + 1 - parity) >> 1;",
        "// Line_Reference 454: \t\t// ORIGINAL (WRONG): m = (parity) ? hstartcol : (numrows - hstartcol);",
        "// Line_Reference 455: \t\tm = numrows - hstartcol;",
        "// Line_Reference 488: \t\tdstptr = &a[hstartcol * stride];",
        "// Line_Reference 529: \t\tif (!(buf = jas_alloc2(bufsize, sizeof(jpc_fix_t)))) {",
        "// Line_Reference 724: \t\tif (!(buf = jas_alloc3(bufsize, JPC_QMFB_COLGRPSIZE, sizeof(jpc_fix_t)))) {"
    ]
}
