{
    "cve_id": "CVE-2016-9395",
    "cve_description": "The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.",
    "cve_publish_date": "2017-03-23",
    "cwe_id": "CWE-20",
    "cwe_name": "Improper Input Validation",
    "cwe_description": "The product receives input or data, but it does\n        not validate or incorrectly validates that the input has the\n        properties that are required to process the data safely and\n        correctly.",
    "commit_message": "The generation of the configuration file jas_config.h has been completely\nreworked in order to avoid pollution of the global namespace.\n\nSome problematic types like uchar, ulong, and friends have been replaced\nwith names with a jas_ prefix.\n\nAn option max_samples has been added to the BMP and JPEG decoders to\nrestrict the maximum size of image that they can decode.  This change\nwas made as a (possibly temporary) fix to address security concerns.\nA max_samples command-line option has also been added to imginfo.\n\nWhether an image component (for jas_image_t) is stored in memory or on\ndisk is now based on the component size (rather than the image size).\n\nSome debug log message were added.\n\nSome new integer overflow checks were added.\n\nSome new safe integer add/multiply functions were added.\n\nMore pre-C99 cruft was removed.  JasPer has numerous \"hacks\" to\nhandle pre-C99 compilers.  JasPer now assumes C99 support.  So, this\npre-C99 cruft is unnecessary and can be removed.\n\nThe regression jasper-doublefree-mem_close.jpg has been re-enabled.\nTheoretically, it should work more predictably now.",
    "type_of_change": "Modification",
    "filename_of_changes": "jas_types.h",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "13",
    "number_of_lines_deleted_vulnerable_to_cve": "25",
    "vulnerable_lines": [
        "// Line_Reference 77: #if defined(WIN32) || defined(HAVE_WINDOWS_H)",
        "// Line_Reference 87: #undef longlong",
        "// Line_Reference 88: #define\tlonglong\tINT64",
        "// Line_Reference 89: #undef ulonglong",
        "// Line_Reference 90: #define\tulonglong\tUINT64",
        "// Line_Reference 101: #if defined(HAVE_SYS_TYPES_H)",
        "// Line_Reference 105: /* Hopefully, these macro definitions will fix more problems than they cause. */",
        "// Line_Reference 106: #if !defined(uchar)",
        "// Line_Reference 107: #define uchar unsigned char",
        "// Line_Reference 108: #endif",
        "// Line_Reference 109: #if !defined(ushort)",
        "// Line_Reference 110: #define ushort unsigned short",
        "// Line_Reference 111: #endif",
        "// Line_Reference 112: #if !defined(uint)",
        "// Line_Reference 113: #define uint unsigned int",
        "// Line_Reference 114: #endif",
        "// Line_Reference 115: #if !defined(ulong)",
        "// Line_Reference 116: #define ulong unsigned long",
        "// Line_Reference 117: #endif",
        "// Line_Reference 118: #if !defined(longlong)",
        "// Line_Reference 119: #define longlong long long",
        "// Line_Reference 120: #endif",
        "// Line_Reference 121: #if !defined(ulonglong)",
        "// Line_Reference 122: #define ulonglong unsigned long long",
        "// Line_Reference 123: #endif"
    ]
}
