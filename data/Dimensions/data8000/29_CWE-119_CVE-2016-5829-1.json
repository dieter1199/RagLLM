{
    "cve_id": "CVE-2016-5829",
    "cve_description": "Multiple heap-based buffer overflows in the hiddev_ioctl_usage function in drivers/hid/usbhid/hiddev.c in the Linux kernel through 4.6.3 allow local users to cause a denial of service or possibly have unspecified other impact via a crafted (1) HIDIOCGUSAGES or (2) HIDIOCSUSAGES ioctl call.",
    "cve_publish_date": "2016-06-27",
    "cwe_id": "CWE-119",
    "cwe_name": "Improper Restriction of Operations within the Bounds of a Memory Buffer",
    "cwe_description": "The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.",
    "commit_message": "HID: hiddev: validate num_values for HIDIOCGUSAGES, HIDIOCSUSAGES commands\n\nThis patch validates the num_values parameter from userland during the\nHIDIOCGUSAGES and HIDIOCSUSAGES commands. Previously, if the report id was set\nto HID_REPORT_ID_UNKNOWN, we would fail to validate the num_values parameter\nleading to a heap overflow.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Scott Bauer <sbauer@plzdonthack.me>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "type_of_change": "Modification",
    "filename_of_changes": "hiddev.c",
    "code_language": "C",
    "number_of_lines_added_for_mitigation": "5",
    "number_of_lines_deleted_vulnerable_to_cve": "5",
    "vulnerable_lines": [
        "// Line_Reference 519: ",
        "// Line_Reference 520: \t\t\telse if ((cmd == HIDIOCGUSAGES || cmd == HIDIOCSUSAGES) &&",
        "// Line_Reference 521: \t\t\t\t (uref_multi->num_values > HID_MAX_MULTI_USAGES ||",
        "// Line_Reference 522: \t\t\t\t  uref->usage_index + uref_multi->num_values > field->report_count))",
        "// Line_Reference 523: \t\t\t\tgoto inval;"
    ]
}
