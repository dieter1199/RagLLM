{
    "cve_id": "CVE-2024-31217",
    "cve_description": "Strapi is an open-source content management system. Prior to version 4.22.0, a denial-of-service vulnerability is present in the media upload process causing the server to crash without restarting, affecting either development and production environments. Usually, errors in the application cause it to log the error and keep it running for other clients. This behavior, in contrast, stops the server execution, making it unavailable for any clients until it's manually restarted. Any user with access to the file upload functionality is able to exploit this vulnerability, affecting applications running in both development mode and production mode as well. Users should upgrade @strapi/plugin-upload to version 4.22.0 to receive a patch.\n",
    "cve_publish_date": "2024-06-12T15:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: dont close modal on error (#19946)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ReleaseDetailsPage.tsx",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 904:         message: formatAPIError(response.error),",
                "// Line 905:       });",
                "// Line 906:     } else {",
                "// Line 907:       // Otherwise, the response returns an object with 'error', handle a generic error",
                "// Line 908:       toggleNotification({",
                "// Line 909:         type: 'warning',",
                "// Line 910:         message: formatMessage({ id: 'notification.error', defaultMessage: 'An error occurred' }),",
                "// Line 911:       });",
                "// Line 912:     }",
                "// Line 913: ",
                "// vulnerable line: 914: toggleEditReleaseModal();",
                "// Line 915:   };",
                "// Line 916: ",
                "// Line 917:   const handleDeleteRelease = async () => {",
                "// Line 918:     const response = await deleteRelease({",
                "// Line 919:       id: releaseId,",
                "// Line 920:     });",
                "// Line 921: ",
                "// Line 922:     if ('data' in response) {",
                "// Line 923:       replace('/plugins/content-releases');",
                "// Line 924:     } else if (isAxiosError(response.error)) {"
            ]
        },
        {
            "filename_of_changes": "ReleaseModal.tsx",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 9:   TextInput,",
                "// Line 10:   Typography,",
                "// Line 11:   Checkbox,",
                "// Line 12:   Flex,",
                "// Line 13:   Box,",
                "// Line 14:   DatePicker,",
                "// Line 15:   TimePicker,",
                "// Line 16:   Combobox,",
                "// Line 17:   ComboboxOption,",
                "// Line 18: } from '@strapi/design-system';",
                "// vulnerable line: 19: import { formatISO, parse } from 'date-fns';",
                "// Line 20: import { utcToZonedTime, zonedTimeToUtc } from 'date-fns-tz';",
                "// Line 21: import { Formik, Form, useFormikContext } from 'formik';",
                "// Line 22: import { useIntl } from 'react-intl';",
                "// Line 23: import { useLocation } from 'react-router-dom';",
                "// Line 24: ",
                "// Line 25: import { RELEASE_SCHEMA } from '../../../shared/validation-schemas';",
                "// Line 26: import { pluginId } from '../pluginId';",
                "// Line 27: import { getTimezoneOffset } from '../utils/time';",
                "// Line 28: ",
                "// Line 29: export interface FormValues {"
            ]
        }
    ]
}