{
    "cve_id": "CVE-2024-28107",
    "cve_description": "phpMyFAQ is an open source FAQ web application for PHP 8.1+ and MySQL, PostgreSQL and other databases.  A SQL injection vulnerability has been discovered in the `insertentry` & `saveentry` when modifying records due to improper escaping of the email address. This allows any authenticated user with the rights to add/edit FAQ news to exploit this vulnerability to exfiltrate data, take over accounts and in some cases, even achieve RCE. This vulnerability is fixed in 3.2.6.",
    "cve_publish_date": "2024-03-25T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: added missing escapting of value",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "Faq.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 919:             $faq->getId(),",
                "// Line 920:             $this->config->getDb()->escape($faq->getLanguage()),",
                "// Line 921:             $this->getNextSolutionId(),",
                "// Line 922:             0,",
                "// Line 923:             $faq->isActive() ? 'yes' : 'no',",
                "// Line 924:             $faq->isSticky() ? 1 : 0,",
                "// Line 925:             $this->config->getDb()->escape($faq->getKeywords()),",
                "// Line 926:             $this->config->getDb()->escape($faq->getQuestion()),",
                "// Line 927:             $this->config->getDb()->escape($faq->getAnswer()),",
                "// Line 928:             $this->config->getDb()->escape($faq->getAuthor()),",
                "// vulnerable line: 929: $faq->getEmail(),",
                "// Line 930:             $faq->isComment() ? 'y' : 'n',",
                "// Line 931:             $faq->getUpdatedDate()->format('YmdHis'),",
                "// Line 932:             '00000000000000',",
                "// Line 933:             '99991231235959',",
                "// Line 934:             date('Y-m-d H:i:s'),",
                "// vulnerable line: 935: $faq->getNotes()",
                "// Line 936:         );",
                "// Line 937: ",
                "// Line 938:         $this->config->getDb()->query($query);",
                "// Line 939: ",
                "// Line 940:         return $faq->getId();",
                "// Line 941:     }",
                "// Line 942: ",
                "// Line 943:     /**",
                "// Line 944:      * Gets the latest solution id for a FAQ record.",
                "// Line 945:      */",
                "// Line 988:             AND",
                "// Line 989:                 lang = '%s'\",",
                "// Line 990:             Database::getTablePrefix(),",
                "// Line 991:             $faq->getRevisionId(),",
                "// Line 992:             $faq->isActive() ? 'yes' : 'no',",
                "// Line 993:             $faq->isSticky() ? 1 : 0,",
                "// Line 994:             $this->config->getDb()->escape($faq->getKeywords()),",
                "// Line 995:             $this->config->getDb()->escape($faq->getQuestion()),",
                "// Line 996:             $this->config->getDb()->escape($faq->getAnswer()),",
                "// Line 997:             $this->config->getDb()->escape($faq->getAuthor()),",
                "// vulnerable line: 998: $faq->getEmail(),",
                "// Line 999:             $faq->isComment() ? 'y' : 'n',",
                "// Line 1000:             $faq->getUpdatedDate()->format('YmdHis'),",
                "// Line 1001:             $faq->getValidFrom()->format('YmdHis'),",
                "// Line 1002:             $faq->getValidTo()->format('YmdHis'),",
                "// vulnerable line: 1003: $faq->getNotes(),",
                "// Line 1004:             $faq->getId(),",
                "// Line 1005:             $faq->getLanguage()",
                "// Line 1006:         );",
                "// Line 1007: ",
                "// Line 1008:         return (bool) $this->config->getDb()->query($query);",
                "// Line 1009:     }",
                "// Line 1010: ",
                "// Line 1011:     /**",
                "// Line 1012:      * Deletes a record and all the dependencies.",
                "// Line 1013:      *"
            ]
        }
    ]
}