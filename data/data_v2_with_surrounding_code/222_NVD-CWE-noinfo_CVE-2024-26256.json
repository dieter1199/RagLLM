{
    "cve_id": "CVE-2024-26256",
    "cve_description": "libarchive Remote Code Execution Vulnerability",
    "cve_publish_date": "2024-04-09T17:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: OOB in rar e8 filter (#2135)\n\nThis patch fixes an out-of-bound error in rar e8 filter.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "archive_read_support_format_rar.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3602:   return 1;",
                "// Line 3603: }",
                "// Line 3604: ",
                "// Line 3605: static int",
                "// Line 3606: execute_filter_e8(struct rar_filter *filter, struct rar_virtual_machine *vm, size_t pos, int e9also)",
                "// Line 3607: {",
                "// Line 3608:   uint32_t length = filter->initialregisters[4];",
                "// Line 3609:   uint32_t filesize = 0x1000000;",
                "// Line 3610:   uint32_t i;",
                "// Line 3611: ",
                "// vulnerable line: 3612: if (length > PROGRAM_WORK_SIZE || length < 4)",
                "// Line 3613:     return 0;",
                "// Line 3614: ",
                "// Line 3615:   for (i = 0; i <= length - 5; i++)",
                "// Line 3616:   {",
                "// Line 3617:     if (vm->memory[i] == 0xE8 || (e9also && vm->memory[i] == 0xE9))",
                "// Line 3618:     {",
                "// Line 3619:       uint32_t currpos = (uint32_t)pos + i + 1;",
                "// Line 3620:       int32_t address = (int32_t)vm_read_32(vm, i + 1);",
                "// Line 3621:       if (address < 0 && currpos >= (uint32_t)-address)",
                "// Line 3622:         vm_write_32(vm, i + 1, address + filesize);"
            ]
        }
    ]
}