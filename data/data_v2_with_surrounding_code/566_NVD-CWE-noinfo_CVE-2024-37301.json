{
    "cve_id": "CVE-2024-37301",
    "cve_description": "Document Merge Service is a document template merge service providing an API to manage templates and merge them with given data. Versions 6.5.1 and prior are vulnerable to remote code execution via server-side template injection which, when executed as root, can result in full takeover of the affected system. As of time of publication, no patched version exists, nor have any known workarounds been disclosed.",
    "cve_publish_date": "2024-06-11T19:16Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: use a sandboxed environment (#763)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "jinja.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: import imghdr",
                "// Line 2: ",
                "// Line 3: from babel.dates import format_date, format_datetime, format_time",
                "// Line 4: from dateutil.parser import parse",
                "// Line 5: from django.conf import settings",
                "// Line 6: from django.utils.translation import to_locale",
                "// Line 7: from docx.shared import Mm",
                "// Line 8: from docxtpl import InlineImage, Listing",
                "// vulnerable line: 9: from jinja2 import Environment, pass_context",
                "// Line 10: from rest_framework.exceptions import ValidationError",
                "// Line 11: ",
                "// Line 12: ",
                "// Line 13: def parse_string(value):",
                "// Line 14:     return parse(str(value))",
                "// Line 15: ",
                "// Line 16: ",
                "// Line 17: def dateformat(value, format=\"medium\", locale=None):",
                "// Line 18:     if value is None:",
                "// Line 19:         return \"\"",
                "// Line 91:         \"datetime\": datetimeformat,",
                "// Line 92:         \"time\": timeformat,",
                "// Line 93:         \"emptystring\": emptystring,",
                "// Line 94:         \"getwithdefault\": getwithdefault,",
                "// Line 95:         \"multiline\": multiline,",
                "// Line 96:         \"image\": image,",
                "// Line 97:     }",
                "// Line 98: ",
                "// Line 99: ",
                "// Line 100: def get_jinja_env():",
                "// vulnerable line: 101: jinja_env = Environment(extensions=settings.DOCXTEMPLATE_JINJA_EXTENSIONS)",
                "// Line 102:     jinja_env.filters.update(get_jinja_filters())",
                "// Line 103:     return jinja_env"
            ]
        }
    ]
}