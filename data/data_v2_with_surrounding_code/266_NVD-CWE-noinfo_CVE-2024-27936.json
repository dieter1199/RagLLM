{
    "cve_id": "CVE-2024-27936",
    "cve_description": "Deno is a JavaScript, TypeScript, and WebAssembly runtime with secure defaults. Starting in version 1.32.1 and prior to version 1.41.0 of the deno library, maliciously crafted permission request can show the spoofed permission prompt by inserting a broken ANSI escape sequence into the request contents. Deno is stripping any ANSI escape sequences from the permission prompt, but permissions given to the program are based on the contents that contain the ANSI escape sequences. Any Deno program can spoof the content of the interactive permission prompt by inserting a broken ANSI code, which allows a malicious Deno program to display the wrong file path or program name to the user. Version 1.41.0 of the deno library contains a patch for the issue.",
    "cve_publish_date": "2024-03-21T02:52Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(prompt): better output with control chars (#18108)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "prompter.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "14",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 205:     let _stderr_guard = std::io::stderr().lock();",
                "// Line 206: ",
                "// Line 207:     // print to stderr so that if stdout is piped this is still displayed.",
                "// Line 208:     let opts: String = if is_unary {",
                "// Line 209:       format!(\"[y/n/A] (y = yes, allow; n = no, deny; A = allow all {name} permissions)\")",
                "// Line 210:     } else {",
                "// Line 211:       \"[y/n] (y = yes, allow; n = no, deny)\".to_string()",
                "// Line 212:     };",
                "// Line 213:     eprint!(\"┌ {PERMISSION_EMOJI}  \");",
                "// Line 214:     eprint!(\"{}\", colors::bold(\"Deno requests \"));",
                "// vulnerable line: 215: eprint!(\"{}\", colors::bold(message));",
                "// Line 216:     eprintln!(\"{}\", colors::bold(\".\"));",
                "// vulnerable line: 217: if let Some(api_name) = api_name {",
                "// Line 218:       eprintln!(\"├ Requested by `{api_name}` API\");",
                "// Line 219:     }",
                "// Line 220:     let msg = format!(\"Run again with --allow-{name} to bypass this prompt.\");",
                "// Line 221:     eprintln!(\"├ {}\", colors::italic(&msg));",
                "// Line 222:     eprint!(\"└ {}\", colors::bold(\"Allow?\"));",
                "// Line 223:     eprint!(\" {opts} > \");",
                "// Line 224:     let value = loop {",
                "// Line 225:       let mut input = String::new();",
                "// Line 226:       let stdin = std::io::stdin();",
                "// Line 227:       let result = stdin.read_line(&mut input);"
            ]
        }
    ]
}