{
    "cve_id": "CVE-2023-47635",
    "cve_description": "Decidim is a participatory democracy framework. Starting in version 0.23.0 and prior to versions 0.27.5 and 0.28.0, the CSRF authenticity token check is disabled for the questionnaire templates preview. The issue does not imply a serious security thread as you need to have access also to the session cookie in order to see this resource. This URL does not allow modifying the resource but it may allow attackers to gain access to information which was not meant to be public. The issue is fixed in version 0.27.5 and 0.28.0. As a workaround, disable the templates functionality or remove all available templates.",
    "cve_publish_date": "2024-02-20T18:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Simplify the code related to questionnaire templates previews (#11743)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "questionnaire_templates_controller.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "0",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: # frozen_string_literal: true",
                "// Line 2: ",
                "// Line 3: module Decidim",
                "// Line 4:   module Templates",
                "// Line 5:     module Admin",
                "// Line 6:       # Controller that allows managing templates.",
                "// Line 7:       #",
                "// Line 8:       class QuestionnaireTemplatesController < Decidim::Templates::Admin::ApplicationController",
                "// Line 9:         include Decidim::TranslatableAttributes",
                "// Line 10: ",
                "// vulnerable line: 11: skip_before_action :verify_authenticity_token, only: :preview",
                "// Line 12: ",
                "// Line 13:         helper_method :template",
                "// Line 14: ",
                "// Line 15:         def index",
                "// Line 16:           enforce_permission_to :index, :templates",
                "// Line 17:           @templates = collection",
                "// Line 18: ",
                "// Line 19:           respond_to do |format|",
                "// Line 20:             format.html { render :index }",
                "// Line 21:             format.json do"
            ]
        }
    ]
}