{
    "cve_id": "CVE-2024-31582",
    "cve_description": "FFmpeg version n6.1 was discovered to contain a heap buffer overflow vulnerability in the draw_block_rectangle function of libavfilter/vf_codecview.c. This vulnerability allows attackers to cause undefined behavior or a Denial of Service (DoS) via crafted input.",
    "cve_publish_date": "2024-04-17T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "avfilter/vf_codecview: fix heap buffer overflow\n\nAnd improve the performance by a little bit.\n\nSigned-off-by: Zhao Zhili <zhilizhao@tencent.com>",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "vf_codecview.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "0",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 201:         }",
                "// Line 202: ",
                "// Line 203:         draw_line(buf, sx, sy, sx + rx, sy + ry, w, h, stride, color);",
                "// Line 204:         draw_line(buf, sx, sy, sx - ry, sy + rx, w, h, stride, color);",
                "// Line 205:     }",
                "// Line 206:     draw_line(buf, sx, sy, ex, ey, w, h, stride, color);",
                "// Line 207: }",
                "// Line 208: ",
                "// Line 209: static void draw_block_rectangle(uint8_t *buf, int sx, int sy, int w, int h, ptrdiff_t stride, int color)",
                "// Line 210: {",
                "// vulnerable line: 211: for (int x = sx; x < sx + w; x++)",
                "// vulnerable line: 212: buf[x] = color;",
                "// Line 213: ",
                "// Line 214:     for (int y = sy; y < sy + h; y++) {",
                "// Line 215:         buf[sx] = color;",
                "// Line 216:         buf[sx + w - 1] = color;",
                "// Line 217:         buf += stride;",
                "// Line 218:     }",
                "// Line 219: ",
                "// vulnerable line: 220: for (int x = sx; x < sx + w; x++)",
                "// vulnerable line: 221: buf[x] = color;",
                "// Line 222: }",
                "// Line 223: ",
                "// Line 224: static int filter_frame(AVFilterLink *inlink, AVFrame *frame)",
                "// Line 225: {",
                "// Line 226:     AVFilterContext *ctx = inlink->dst;",
                "// Line 227:     CodecViewContext *s = ctx->priv;",
                "// Line 228:     AVFilterLink *outlink = ctx->outputs[0];",
                "// Line 229: ",
                "// Line 230:     if (s->qp) {",
                "// Line 231:         enum AVVideoEncParamsType qp_type;"
            ]
        }
    ]
}