{
    "cve_id": "CVE-2024-27516",
    "cve_description": "Server-Side Template Injection (SSTI) vulnerability in livehelperchat before 4.34v, allows remote attackers to execute arbitrary code and obtain sensitive information via the search parameter in lhc_web/modules/lhfaq/faqweight.php.",
    "cve_publish_date": "2024-02-29T01:44Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix #2054\n\nIn next two weeks svelte version will be released. So all these never ending angular issues will be over for the most of the part.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "faqwidget.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 130:     }",
                "// Line 131: } elseif ((string)$Params['user_parameters_unordered']['search'] != '') {",
                "// Line 132:     $keywordSearch = $searchString = strip_tags(rawurldecode($Params['user_parameters_unordered']['search']));",
                "// Line 133:     $whereConditions[] = $q->expr->lOr(",
                "// Line 134:         $q->expr->like('answer', $q->bindValue('%' . $searchString . '%')),",
                "// Line 135:         $q->expr->like('question', $q->bindValue('%' . $searchString . '%')",
                "// Line 136:      ));",
                "// Line 137:     $dynamic_url_append .= '/(search)/'.rawurlencode($searchString);",
                "// Line 138: }",
                "// Line 139: ",
                "// vulnerable line: 140: $tpl->set('keyword',$keywordSearch);",
                "// Line 141: ",
                "// Line 142: $q->where($whereConditions);",
                "// Line 143: ",
                "// Line 144: ",
                "// Line 145: $stmt = $q->prepare();",
                "// Line 146: $stmt->execute();",
                "// Line 147: $result = $stmt->fetchColumn();",
                "// Line 148: ",
                "// Line 149: ",
                "// Line 150: $pages = new lhPaginator();"
            ]
        },
        {
            "filename_of_changes": "section_online_users.tpl.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 13:             </li>",
                "// Line 14:             <li class=\"li-icon list-inline-item\">",
                "// Line 15:                 <a href=\"#\" onclick=\"return lhc.revealModal({'url':WWW_DIR_JAVASCRIPT +'chat/sendmassmessage'})\">",
                "// Line 16:                     <i class=\"material-icons\" >send</i>",
                "// Line 17:                 </a>",
                "// Line 18:             </li>",
                "// Line 19:         </div>",
                "// Line 20: ",
                "// Line 21:     </div>",
                "// Line 22:     <div class=\"col-2 pe-0\">",
                "// vulnerable line: 23: <input class=\"form-control form-control-sm\" <?php if (isset($_GET['search'])) :?>ng-init='query=<?php echo json_encode(strip_tags($_GET['search']),JSON_HEX_APOS);?>'<?php endif?> ng-model=\"query\" type=\"text\" value=\"\" placeholder=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/lists/search_panel','Type to search')?>\">",
                "// Line 24:     </div>",
                "// Line 25:     <div class=\"col-1 pe-0\">",
                "// Line 26:         <select class=\"form-control form-control-sm\" ng-model=\"groupByField\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Group list by');?>\">",
                "// Line 27:                 <option value=\"none\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Group by');?></option>",
                "// Line 28:                 <option value=\"user_country_name\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','User country');?></option>",
                "// Line 29:                 <option value=\"current_page\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Page');?></option>",
                "// Line 30:                 <option value=\"page_title\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Page title');?></option>",
                "// Line 31:                 <option value=\"referrer\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Referrer');?></option>",
                "// Line 32:                 <option value=\"identifier\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Identifier');?></option>",
                "// Line 33:                 <option value=\"dep_id\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/onlineusers','Department');?></option>"
            ]
        }
    ]
}