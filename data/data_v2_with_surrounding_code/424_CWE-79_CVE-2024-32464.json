{
    "cve_id": "CVE-2024-32464",
    "cve_description": "Action Text brings rich text content and editing to Rails. Instances of ActionText::Attachable::ContentAttachment included within a rich_text_area tag could potentially contain unsanitized HTML. This vulnerability is fixed in 7.1.3.4 and 7.2.0.beta2.",
    "cve_publish_date": "2024-06-04T20:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Sanitize ActionText HTML ContentAttachment in Trix edit view\n\n[CVE-2024-32464]\nInstances of ActionText::Attachable::ContentAttachment included\nwithin a rich_text_area tag could potentially contain unsanitized\nHTML. This could lead to a potential cross site scripting issue\nwithin the Trix editor.\n\nThis change enforces existing sanitization routines on\nActionText::Attachable::ContentAttachment attachments.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "attachment_test.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "9",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "content.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 15:   #",
                "// Line 16:   #     class Message < ActiveRecord::Base",
                "// Line 17:   #       has_rich_text :content",
                "// Line 18:   #     end",
                "// Line 19:   #",
                "// Line 20:   #     message = Message.create!(content: \"<h1>Funny times!</h1>\")",
                "// Line 21:   #     body = message.content.body # => #<ActionText::Content \"<div class=\"trix-conte...\">",
                "// Line 22:   #     body.to_s # => \"<h1>Funny times!</h1>\"",
                "// Line 23:   #     body.to_plain_text # => \"Funny times!\"",
                "// Line 24:   class Content",
                "// vulnerable line: 25: include Rendering, Serialization",
                "// Line 26: ",
                "// Line 27:     attr_reader :fragment",
                "// Line 28: ",
                "// Line 29:     delegate :deconstruct, to: :fragment",
                "// Line 30:     delegate :blank?, :empty?, :html_safe, :present?, to: :to_html # Delegating to to_html to avoid including the layout",
                "// Line 31: ",
                "// Line 32:     class << self",
                "// Line 33:       def fragment_by_canonicalizing_content(content)",
                "// Line 34:         fragment = ActionText::Attachment.fragment_by_canonicalizing_attachments(content)",
                "// Line 35:         fragment = ActionText::AttachmentGallery.fragment_by_canonicalizing_attachment_galleries(fragment)"
            ]
        },
        {
            "filename_of_changes": "content_helper.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "9",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}