{
    "cve_id": "CVE-2024-39313",
    "cve_description": "toy-blog is a headless content management system implementation. Starting in version 0.5.4 and prior to version 0.6.1, articles with private visibility can be read if the reader does not set credentials for the request. Users should upgrade to 0.6.1 or later to receive a patch. No known workarounds are available.",
    "cve_publish_date": "2024-07-01T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: `GET /article/{id}` に認証トークンを与えないと非公開の記事を閲覧できてしまうバグを修正",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "article.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 85:         if !exists {",
                "// Line 86:             return Res::General(GetArticleError::NoSuchArticleFoundById)",
                "// Line 87:         }",
                "// Line 88: ",
                "// Line 89:         let content = match x_get().read_snapshot(&article_id) {",
                "// Line 90:             Ok(content) => content,",
                "// Line 91:             Err(e) => return Res::Internal(UnhandledError::new(e))",
                "// Line 92:         };",
                "// Line 93: ",
                "// Line 94:         // Visibility::Restricted, Visibility::Publicは検証不要",
                "// vulnerable line: 95: if let (Visibility::Private, Some(auth)) = (content.visibility, auth) {",
                "// vulnerable line: 96: if is_wrong_token(auth.token()) {",
                "// Line 97:                 return Res::General(GetArticleError::NoSuchArticleFoundById)",
                "// Line 98:             }",
                "// Line 99:             // now, private article can see from permitted user!",
                "// Line 100:         }",
                "// Line 101: ",
                "// Line 102:         let u = content.updated_at;",
                "// Line 103:         let uo = u.offset();",
                "// Line 104:         let uu = u.with_timezone(uo);",
                "// Line 105: ",
                "// Line 106:         Res::Ok(OwnedMetadata {"
            ]
        },
        {
            "filename_of_changes": "repository.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}