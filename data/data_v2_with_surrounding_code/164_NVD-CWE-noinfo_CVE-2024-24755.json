{
    "cve_id": "CVE-2024-24755",
    "cve_description": "discourse-group-membership-ip-block is a discourse plugin that adds support for adding users to groups based on their IP address. discourse-group-membership-ip-block was sending all group custom fields to the client, including group custom fields from other plugins which may expect their custom fields to remain secret.",
    "cve_publish_date": "2024-02-01T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "SECURITY: Don't expose custom fields from other plugins (#13)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "plugin.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: # version: 0.1",
                "// Line 5: # authors: Falco",
                "// Line 6: # url: https://github.com/discourse/discourse-group-membership-ip-block",
                "// Line 7: ",
                "// Line 8: enabled_site_setting :group_membership_ip_block_enabled",
                "// Line 9: register_asset \"stylesheets/group-settings.scss\"",
                "// Line 10: ",
                "// Line 11: after_initialize do",
                "// Line 12:   DiscoursePluginRegistry.register_editable_group_custom_field(:ip_blocks_list, self)",
                "// Line 13:   register_group_custom_field_type(\"ip_blocks_list\", :string, max_length: 1000)",
                "// vulnerable line: 14: add_to_serializer(:basic_group, :custom_fields) { object.custom_fields }",
                "// Line 15: ",
                "// Line 16:   on(:user_logged_in) do |user|",
                "// Line 17:     return unless SiteSetting.group_membership_ip_block_enabled",
                "// Line 18: ",
                "// Line 19:     GroupCustomField",
                "// Line 20:       .where(name: \"ip_blocks_list\")",
                "// Line 21:       .each do |rule|",
                "// Line 22:         ips = rule.value.split.map { |ip| IPAddr.new(ip) }",
                "// Line 23:         ips.each { |ip| Group.find_by(id: rule.group).add(user) if ip.include?(user.ip_address) }",
                "// Line 24:       end"
            ]
        }
    ]
}