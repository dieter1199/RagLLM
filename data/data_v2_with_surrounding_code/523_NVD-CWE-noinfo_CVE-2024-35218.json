{
    "cve_id": "CVE-2024-35218",
    "cve_description": "Umbraco CMS is an ASP.NET CMS used by more than 730.000 websites. Stored Cross-site scripting (XSS) enable attackers that have access to backoffice to bring malicious content into a website or application. This vulnerability has been patched in version(s) 8.18.13, 10.8.4, 12.3.7, 13.1.1 by implementing IHtmlSanitizer.\n\n\n\n\n",
    "cve_publish_date": "2024-05-21T14:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-gvpc-3pj6-4m9w\n\n* Add MarkDownPropertyValueEditor with html sanitizer\n\n* Implement IMarkdownSanitizer.",
    "type_of_change": "Addition",
    "changes": [
        {
            "filename_of_changes": "IMarkdownSanitizer.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "14",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "MarkdownPropertyEditor.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "MarkdownPropertyEditor.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "NoopMarkdownSanitizer.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "UmbracoBuilder.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 310:             Services.AddUnique<IExternalLoginWithKeyService>(factory => factory.GetRequiredService<ExternalLoginService>());",
                "// Line 311:             Services.AddUnique<ILocalizedTextService>(factory => new LocalizedTextService(",
                "// Line 312:                 factory.GetRequiredService<Lazy<LocalizedTextServiceFileSources>>(),",
                "// Line 313:                 factory.GetRequiredService<ILogger<LocalizedTextService>>()));",
                "// Line 314: ",
                "// Line 315:             Services.AddUnique<IEntityXmlSerializer, EntityXmlSerializer>();",
                "// Line 316: ",
                "// Line 317:             Services.AddSingleton<ConflictingPackageData>();",
                "// Line 318:             Services.AddSingleton<CompiledPackageXmlParser>();",
                "// Line 319: ",
                "// vulnerable line: 320: // Register a noop IHtmlSanitizer to be replaced",
                "// Line 321:             Services.AddUnique<IHtmlSanitizer, NoopHtmlSanitizer>();",
                "// Line 322: ",
                "// Line 323:             Services.AddUnique<IPropertyTypeUsageService, PropertyTypeUsageService>();",
                "// Line 324:             Services.AddUnique<IDataTypeUsageService, DataTypeUsageService>();",
                "// Line 325: ",
                "// Line 326:             Services.AddUnique<ICultureImpactFactory>(provider => new CultureImpactFactory(provider.GetRequiredService<IOptionsMonitor<ContentSettings>>()));",
                "// Line 327:             Services.AddUnique<IDictionaryService, DictionaryService>();",
                "// Line 328:             Services.AddUnique<ITemporaryMediaService, TemporaryMediaService>();",
                "// Line 329: ",
                "// Line 330:             // Register filestream security analyzers"
            ]
        },
        {
            "filename_of_changes": "UmbracoBuilder.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 311:             Services.AddUnique<IExternalLoginWithKeyService>(factory => factory.GetRequiredService<ExternalLoginService>());",
                "// Line 312:             Services.AddUnique<ILocalizedTextService>(factory => new LocalizedTextService(",
                "// Line 313:                 factory.GetRequiredService<Lazy<LocalizedTextServiceFileSources>>(),",
                "// Line 314:                 factory.GetRequiredService<ILogger<LocalizedTextService>>()));",
                "// Line 315: ",
                "// Line 316:             Services.AddUnique<IEntityXmlSerializer, EntityXmlSerializer>();",
                "// Line 317: ",
                "// Line 318:             Services.AddSingleton<ConflictingPackageData>();",
                "// Line 319:             Services.AddSingleton<CompiledPackageXmlParser>();",
                "// Line 320: ",
                "// vulnerable line: 321: // Register a noop IHtmlSanitizer to be replaced",
                "// Line 322:             Services.AddUnique<IHtmlSanitizer, NoopHtmlSanitizer>();",
                "// Line 323: ",
                "// Line 324:             Services.AddUnique<IPropertyTypeUsageService, PropertyTypeUsageService>();",
                "// Line 325:             Services.AddUnique<IDataTypeUsageService, DataTypeUsageService>();",
                "// Line 326: ",
                "// Line 327:             Services.AddUnique<ICultureImpactFactory>(provider => new CultureImpactFactory(provider.GetRequiredService<IOptionsMonitor<ContentSettings>>()));",
                "// Line 328:             Services.AddUnique<IDictionaryService, DictionaryService>();",
                "// Line 329:             Services.AddUnique<ITemporaryMediaService, TemporaryMediaService>();",
                "// Line 330: ",
                "// Line 331:             // Register filestream security analyzers"
            ]
        },
        {
            "filename_of_changes": "UmbracoBuilder.cs",
            "code_language": "C#",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 310:             Services.AddUnique<IExternalLoginWithKeyService>(factory => factory.GetRequiredService<ExternalLoginService>());",
                "// Line 311:             Services.AddUnique<ILocalizedTextService>(factory => new LocalizedTextService(",
                "// Line 312:                 factory.GetRequiredService<Lazy<LocalizedTextServiceFileSources>>(),",
                "// Line 313:                 factory.GetRequiredService<ILogger<LocalizedTextService>>()));",
                "// Line 314: ",
                "// Line 315:             Services.AddUnique<IEntityXmlSerializer, EntityXmlSerializer>();",
                "// Line 316: ",
                "// Line 317:             Services.AddSingleton<ConflictingPackageData>();",
                "// Line 318:             Services.AddSingleton<CompiledPackageXmlParser>();",
                "// Line 319: ",
                "// vulnerable line: 320: // Register a noop IHtmlSanitizer to be replaced",
                "// Line 321:             Services.AddUnique<IHtmlSanitizer, NoopHtmlSanitizer>();",
                "// Line 322: ",
                "// Line 323:             Services.AddUnique<IPropertyTypeUsageService, PropertyTypeUsageService>();",
                "// Line 324:             Services.AddUnique<IDataTypeUsageService, DataTypeUsageService>();",
                "// Line 325: ",
                "// Line 326:             Services.AddUnique<ICultureImpactFactory>(provider => new CultureImpactFactory(provider.GetRequiredService<IOptionsMonitor<ContentSettings>>()));",
                "// Line 327:             Services.AddUnique<IDictionaryService, DictionaryService>();",
                "// Line 328:             Services.AddUnique<ITemporaryMediaService, TemporaryMediaService>();",
                "// Line 329: ",
                "// Line 330:             // Register filestream security analyzers"
            ]
        }
    ]
}