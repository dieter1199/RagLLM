{
    "cve_id": "CVE-2024-24574",
    "cve_description": "phpMyFAQ is an open source FAQ web application for PHP 8.1+ and MySQL, PostgreSQL and other databases. Unsafe echo of filename in phpMyFAQ\\phpmyfaq\\admin\\attachments.php leads to allowed execution of JavaScript code in client side (XSS). This vulnerability has been patched in version 3.2.5.",
    "cve_publish_date": "2024-02-05T21:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixing unsafe render filename on attachments.php\n\nPathing the unsafe filename rendering that causing the Store XSS on attachments pages",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "attachments.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 63:         <th><?= Translation::get('msgAttachmentsFilename') ?></th>",
                "// Line 64:         <th><?= Translation::get('msgTransToolLanguage') ?></th>",
                "// Line 65:         <th><?= Translation::get('msgAttachmentsFilesize') ?></th>",
                "// Line 66:         <th colspan=\"3\"><?= Translation::get('msgAttachmentsMimeType') ?></th>",
                "// Line 67:       </tr>",
                "// Line 68:       </thead>",
                "// Line 69:       <tbody id=\"attachment-table\">",
                "// Line 70:       <?php foreach ($crumbs as $item) : ?>",
                "// Line 71:         <tr id=\"attachment_<?= $item->id ?>\" title=\"<?= $item->thema ?>\">",
                "// Line 72:           <td><?= $item->id ?></td>",
                "// vulnerable line: 73: <td><?= $item->filename ?></td>",
                "// vulnerable line: 74: <td><?= $item->record_lang ?></td>",
                "// Line 75:           <td><?= Utils::formatBytes($item->filesize) ?></td>",
                "// vulnerable line: 76: <td><?= $item->mime_type ?></td>",
                "// Line 77:           <td>",
                "// Line 78:             <button class=\"btn btn-danger btn-delete-attachment\" title=\"<?= Translation::get('ad_gen_delete') ?>\"",
                "// Line 79:                     data-attachment-id=\"<?= $item->id ?>\"",
                "// Line 80:                     data-csrf=\"<?= Token::getInstance()->getTokenString('delete-attachment') ?>\">",
                "// Line 81:               <i aria-hidden=\"true\" class=\"fa fa-trash btn-delete-attachment\" data-attachment-id=\"<?= $item->id ?>\"",
                "// Line 82:                     data-csrf=\"<?= Token::getInstance()->getTokenString('delete-attachment') ?>\"></i>",
                "// Line 83:             </button>",
                "// Line 84:           </td>",
                "// Line 85:           <td>",
                "// Line 86:             <a title=\"<?= Translation::get('ad_entry_faq_record') ?>\" class=\"btn btn-info\""
            ]
        },
        {
            "filename_of_changes": "attachments.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 63:         <th><?= Translation::get('msgAttachmentsFilename') ?></th>",
                "// Line 64:         <th><?= Translation::get('msgTransToolLanguage') ?></th>",
                "// Line 65:         <th><?= Translation::get('msgAttachmentsFilesize') ?></th>",
                "// Line 66:         <th colspan=\"3\"><?= Translation::get('msgAttachmentsMimeType') ?></th>",
                "// Line 67:       </tr>",
                "// Line 68:       </thead>",
                "// Line 69:       <tbody id=\"attachment-table\">",
                "// Line 70:       <?php foreach ($crumbs as $item) : ?>",
                "// Line 71:         <tr id=\"attachment_<?= $item->id ?>\" title=\"<?= $item->thema ?>\">",
                "// Line 72:           <td><?= $item->id ?></td>",
                "// vulnerable line: 73: <td><?= $item->filename ?></td>",
                "// vulnerable line: 74: <td><?= $item->record_lang ?></td>",
                "// Line 75:           <td><?= Utils::formatBytes($item->filesize) ?></td>",
                "// vulnerable line: 76: <td><?= $item->mime_type ?></td>",
                "// Line 77:           <td>",
                "// Line 78:             <button class=\"btn btn-danger btn-delete-attachment\" title=\"<?= Translation::get('ad_gen_delete') ?>\"",
                "// Line 79:                     data-attachment-id=\"<?= $item->id ?>\"",
                "// Line 80:                     data-csrf=\"<?= Token::getInstance()->getTokenString('delete-attachment') ?>\">",
                "// Line 81:               <i aria-hidden=\"true\" class=\"fa fa-trash btn-delete-attachment\" data-attachment-id=\"<?= $item->id ?>\"",
                "// Line 82:                     data-csrf=\"<?= Token::getInstance()->getTokenString('delete-attachment') ?>\"></i>",
                "// Line 83:             </button>",
                "// Line 84:           </td>",
                "// Line 85:           <td>",
                "// Line 86:             <a title=\"<?= Translation::get('ad_entry_faq_record') ?>\" class=\"btn btn-info\""
            ]
        }
    ]
}