{
    "cve_id": "CVE-2024-24817",
    "cve_description": "Discourse Calendar adds the ability to create a dynamic calendar in the first post of a topic on the open-source discussion platform Discourse. Prior to version 0.4, event invitees created in topics in private categories or PMs (private messages) can be retrieved by anyone, even if they're not logged in. This problem is resolved in version 0.4 of the discourse-calendar plugin. While no known workaround is available, putting the site behind `login_required` will disallow this endpoint to be used by anonymous users, but logged in users can still get the list of invitees in the private topics.",
    "cve_publish_date": "2024-02-22T18:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "SECURITY: Hide invitees from users who are not allowed to see the event post (#544)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "invitees_controller.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "invitees_controller_spec.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "26",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "plugin.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: # frozen_string_literal: true",
                "// Line 2: ",
                "// Line 3: # name: discourse-calendar",
                "// Line 4: # about: Adds the ability to create a dynamic calendar with events in a topic.",
                "// Line 5: # meta_topic_id: 97376",
                "// vulnerable line: 6: # version: 0.3",
                "// Line 7: # author: Daniel Waterworth, Joffrey Jaffeux",
                "// Line 8: # url: https://github.com/discourse/discourse-calendar",
                "// Line 9: ",
                "// Line 10: libdir = File.join(File.dirname(__FILE__), \"vendor/holidays/lib\")",
                "// Line 11: $LOAD_PATH.unshift(libdir) unless $LOAD_PATH.include?(libdir)",
                "// Line 12: ",
                "// Line 13: gem \"rrule\", \"0.4.4\", require: false",
                "// Line 14: ",
                "// Line 15: require_relative \"lib/calendar_settings_validator.rb\"",
                "// Line 16: "
            ]
        }
    ]
}