{
    "cve_id": "CVE-2024-24758",
    "cve_description": "Undici is an HTTP/1.1 client, written from scratch for Node.js. Undici already cleared Authorization headers on cross-origin redirects, but did not clear `Proxy-Authentication` headers. This issue has been patched in versions 5.28.3 and 6.6.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-02-16T22:15Z",
    "cwe_id": "CWE-200",
    "cwe_name": "Exposure of Sensitive Information to an Unauthorized Actor",
    "cwe_description": "The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.",
    "commit_message": "Merge pull request from GHSA-3787-6prv-h9w3\n\nSigned-off-by: Matteo Collina <hello@matteocollina.com>",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "index.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "redirect-cross-origin-header.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: 'use strict'",
                "// Line 2: ",
                "// Line 3: const { test } = require('node:test')",
                "// Line 4: const { tspl } = require('@matteo.collina/tspl')",
                "// Line 5: const { createServer } = require('node:http')",
                "// Line 6: const { once } = require('node:events')",
                "// Line 7: const { fetch } = require('../..')",
                "// Line 8: ",
                "// Line 9: test('Cross-origin redirects clear forbidden headers', async (t) => {",
                "// vulnerable line: 10: const { strictEqual } = tspl(t, { plan: 5 })",
                "// Line 11: ",
                "// Line 12:   const server1 = createServer((req, res) => {",
                "// Line 13:     strictEqual(req.headers.cookie, undefined)",
                "// Line 14:     strictEqual(req.headers.authorization, undefined)",
                "// Line 15: ",
                "// Line 16:     res.end('redirected')",
                "// Line 17:   }).listen(0)",
                "// Line 18: ",
                "// Line 19:   const server2 = createServer((req, res) => {",
                "// Line 20:     strictEqual(req.headers.authorization, 'test')",
                "// Line 33:   })",
                "// Line 34: ",
                "// Line 35:   await Promise.all([",
                "// Line 36:     once(server1, 'listening'),",
                "// Line 37:     once(server2, 'listening')",
                "// Line 38:   ])",
                "// Line 39: ",
                "// Line 40:   const res = await fetch(`http://localhost:${server2.address().port}`, {",
                "// Line 41:     headers: {",
                "// Line 42:       Authorization: 'test',",
                "// vulnerable line: 43: Cookie: 'ddd=dddd'",
                "// Line 44:     }",
                "// Line 45:   })",
                "// Line 46: ",
                "// Line 47:   const text = await res.text()",
                "// Line 48:   strictEqual(text, 'redirected')",
                "// Line 49: })"
            ]
        }
    ]
}