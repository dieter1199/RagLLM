{
    "cve_id": "CVE-2024-28108",
    "cve_description": "phpMyFAQ is an open source FAQ web application for PHP 8.1+ and MySQL, PostgreSQL and other databases. Due to insufficient validation on the `contentLink` parameter, it is possible for unauthenticated users to inject HTML code to the page which might affect other users. _Also, requires that adding new FAQs is allowed for guests and that the admin doesn't check the content of a newly added FAQ._ This vulnerability is fixed in 3.2.6.",
    "cve_publish_date": "2024-03-25T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: added missing conversion to HTML entities",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "api.service.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 409:                 $isTranslation = true;",
                "// Line 410:                 $newLanguage = $faqLanguage;",
                "// Line 411:             }",
                "// Line 412: ",
                "// Line 413:             if (!is_null($contentLink) && Strings::substr($contentLink, 7) !== '') {",
                "// Line 414:                 $answer = sprintf(",
                "// Line 415:                     '%s<br><div id=\"newFAQContentLink\">%s<a href=\"https://%s\" target=\"_blank\">%s</a></div>',",
                "// Line 416:                     $answer,",
                "// Line 417:                     Translation::get('msgInfo'),",
                "// Line 418:                     Strings::substr($contentLink, 7),",
                "// vulnerable line: 419: $contentLink",
                "// Line 420:                 );",
                "// Line 421:             }",
                "// Line 422: ",
                "// Line 423:             $autoActivate = $faqConfig->get('records.defaultActivation');",
                "// Line 424: ",
                "// Line 425:             $faqEntity = new FaqEntity();",
                "// Line 426:             $faqEntity",
                "// Line 427:                 ->setLanguage(($isTranslation === true ? $newLanguage : $languageCode))",
                "// Line 428:                 ->setQuestion($question)",
                "// Line 429:                 ->setActive(($autoActivate ? FAQ_SQL_ACTIVE_YES : FAQ_SQL_ACTIVE_NO))"
            ]
        }
    ]
}