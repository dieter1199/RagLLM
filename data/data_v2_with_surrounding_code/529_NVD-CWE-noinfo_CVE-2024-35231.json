{
    "cve_id": "CVE-2024-35231",
    "cve_description": "rack-contrib provides contributed rack middleware and utilities for Rack, a Ruby web server interface. Versions of rack-contrib prior to 2.5.0 are vulnerable to denial of service due to the fact that the user controlled data `profiler_runs` was not constrained to any limitation. This would lead to allocating resources on the server side with no limitation and a potential denial of service by remotely user-controlled data. Version 2.5.0 contains a patch for the issue.",
    "cve_publish_date": "2024-05-27T17:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Specify a maximum number of runs to limit the request params -> DoS. (#191)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "profiler.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "23",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 59:             false",
                "// Line 60:           end",
                "// Line 61:         end",
                "// Line 62:       end",
                "// Line 63: ",
                "// Line 64:       def profile(env, mode)",
                "// Line 65:         @profile = ::RubyProf::Profile.new(measure_mode: ::RubyProf.const_get(mode.upcase))",
                "// Line 66: ",
                "// Line 67:         GC.enable_stats if GC.respond_to?(:enable_stats)",
                "// Line 68:         request = Rack::Request.new(env.clone)",
                "// vulnerable line: 69: runs = (request.params['profiler_runs'] || @times).to_i",
                "// Line 70:         result = @profile.profile do",
                "// vulnerable line: 71: runs.times { @app.call(env) }",
                "// Line 72:         end",
                "// Line 73:         GC.disable_stats if GC.respond_to?(:disable_stats)",
                "// Line 74: ",
                "// Line 75:         [200, headers(@printer, env, mode), print(@printer, result)]",
                "// Line 76:       end",
                "// Line 77: ",
                "// Line 78:       def print(printer, result)",
                "// Line 79:         body = StringIO.new",
                "// Line 80:         printer.new(result).print(body, :min_percent => 0.01)",
                "// Line 81:         body.rewind"
            ]
        },
        {
            "filename_of_changes": "spec_rack_profiler.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}