{
    "cve_id": "CVE-2024-33905",
    "cve_description": "In Telegram WebK before 2.0.0 (488), a crafted Mini Web App allows XSS via the postMessage web_app_open_link event type.",
    "cve_publish_date": "2024-04-29T06:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "f",
    "type_of_change": "Renaming",
    "changes": [
        {
            "filename_of_changes": "avatar-HalcuPNE.js.map",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "button-Mm7TqKr1.js.map",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "countryInputField-tqY1KpER.js.map",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "page-kT6kVFv9.js.map",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "peerProfile.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 176:             simulateClickEvent(this.phone.container);",
                "// Line 177:           }",
                "// Line 178:         }, {",
                "// Line 179:           icon: 'info',",
                "// Line 180:           text: 'PeerInfo.Phone.AnonymousInfo',",
                "// Line 181:           textArgs: [(() => {",
                "// Line 182:             const a = document.createElement('a');",
                "// Line 183:             return a;",
                "// Line 184:           })()],",
                "// Line 185:           onClick: () => {",
                "// vulnerable line: 186: window.open('https://fragment.com/numbers', '_blank');",
                "// Line 187:           },",
                "// Line 188:           separator: true,",
                "// Line 189:           secondary: true,",
                "// Line 190:           verify: async() => {",
                "// Line 191:             const {isAnonymous} = await this.managers.appUsersManager.getUserPhone(this.peerId.toUserId()) || {};",
                "// Line 192:             return isAnonymous;",
                "// Line 193:           }",
                "// Line 194:         }]",
                "// Line 195:       }",
                "// Line 196:     });"
            ]
        },
        {
            "filename_of_changes": "safeWindowOpen.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "scrollable-ILmNatrX.js.map",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "sponsored.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 12:     super('popup-sponsored', {",
                "// Line 13:       titleLangKey: 'Chat.Message.Sponsored.What',",
                "// Line 14:       descriptionLangKey: 'Chat.Message.Ad.Text',",
                "// Line 15:       descriptionLangArgs: [i18n('Chat.Message.Sponsored.Link')],",
                "// Line 16:       buttons: [{",
                "// Line 17:         langKey: 'OK',",
                "// Line 18:         isCancel: true",
                "// Line 19:       }, {",
                "// Line 20:         langKey: 'Chat.Message.Ad.ReadMore',",
                "// Line 21:         callback: () => {",
                "// vulnerable line: 22: window.open(I18n.format('Chat.Message.Sponsored.Link', true));",
                "// Line 23:         },",
                "// Line 24:         isCancel: true",
                "// Line 25:       }],",
                "// Line 26:       scrollable: true",
                "// Line 27:     });",
                "// Line 28: ",
                "// Line 29:     this.scrollable.append(this.description);",
                "// Line 30: ",
                "// Line 31:     this.show();",
                "// Line 32:   }"
            ]
        },
        {
            "filename_of_changes": "webApp.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 405:           return;",
                "// Line 406:         }",
                "// Line 407: ",
                "// Line 408:         this.forceHide();",
                "// Line 409:         this.managers.appAttachMenuBotsManager.sendWebViewData(this.webViewOptions.botId, this.webViewOptions.buttonText, data);",
                "// Line 410:       },",
                "// Line 411:       web_app_close: () => {",
                "// Line 412:         this.forceHide();",
                "// Line 413:       },",
                "// Line 414:       web_app_open_link: ({url}) => {",
                "// vulnerable line: 415: window.open(url, '_blank');",
                "// Line 416:       },",
                "// Line 417:       web_app_open_tg_link: ({path_full}) => {",
                "// Line 418:         appImManager.openUrl('https://t.me' + path_full);",
                "// Line 419:         // this.forceHide();",
                "// Line 420:       },",
                "// Line 421:       web_app_open_invoice: ({slug}) => {",
                "// Line 422:         const link: InternalLink.InternalLinkInvoice = {",
                "// Line 423:           _: INTERNAL_LINK_TYPE.INVOICE,",
                "// Line 424:           slug",
                "// Line 425:         };"
            ]
        }
    ]
}