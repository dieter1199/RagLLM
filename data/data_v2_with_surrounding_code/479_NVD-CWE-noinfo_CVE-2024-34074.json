{
    "cve_id": "CVE-2024-34074",
    "cve_description": "Frappe is a full-stack web application framework. Prior to 15.26.0 and 14.74.0, the login page accepts redirect argument and it allowed redirect to untrusted external URls. This behaviour can be used by malicious actors for phishing. This vulnerability is fixed in 15.26.0 and 14.74.0.",
    "cve_publish_date": "2024-05-14T15:38Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: only redirect to same domain (#26304)\n\nThis limits post login redirects to same domain to avoid social engineering attempts.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "login.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "25",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "test_api.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "14",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: import json",
                "// Line 2: import sys",
                "// Line 3: import typing",
                "// Line 4: from contextlib import contextmanager",
                "// Line 5: from functools import cached_property",
                "// Line 6: from random import choice",
                "// Line 7: from threading import Thread",
                "// Line 8: from time import time",
                "// Line 9: from unittest.mock import patch",
                "// vulnerable line: 10: from urllib.parse import urljoin",
                "// Line 11: ",
                "// Line 12: import requests",
                "// Line 13: from filetype import guess_mime",
                "// Line 14: from werkzeug.test import TestResponse",
                "// Line 15: ",
                "// Line 16: import frappe",
                "// Line 17: from frappe.installer import update_site_config",
                "// Line 18: from frappe.tests.utils import FrappeTestCase, patch_hooks",
                "// Line 19: from frappe.utils import cint, get_test_client, get_url",
                "// Line 20: "
            ]
        }
    ]
}