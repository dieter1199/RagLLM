{
    "cve_id": "CVE-2023-48710",
    "cve_description": "iTop is an IT service management platform.  Files from the `env-production` folder can be retrieved even though they should have restricted access.  Hopefully, there is no sensitive files stored in that folder natively, but there could be from a third-party module. \n The `pages/exec.php` script as been fixed to limit execution of PHP files only.  Other file types won't be retrieved and exposed.  The vulnerability is fixed in 2.7.10, 3.0.4, 3.1.1, and 3.2.0.",
    "cve_publish_date": "2024-04-15T18:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "NÂ°6989 - Security hardening",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "exec.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 20: require_once('../approot.inc.php');",
                "// Line 21: ",
                "// Line 22: // Needed to read the parameters (with sanitization)",
                "// Line 23: require_once(APPROOT.'application/utils.inc.php');",
                "// Line 24: require_once(APPROOT.'core/metamodel.class.php');",
                "// Line 25: ",
                "// Line 26: utils::InitTimeZone();",
                "// Line 27: ",
                "// Line 28: $sModule = utils::ReadParam('exec_module', '');",
                "// Line 29: if ($sModule == '')",
                "// vulnerable line: 30: {",
                "// Line 31:     echo \"Missing argument 'exec_module'\";",
                "// Line 32:     exit;",
                "// Line 33: }",
                "// Line 34: $sModule = basename($sModule); // protect against ../.. ...",
                "// Line 35: ",
                "// Line 36: $sPage = utils::ReadParam('exec_page', '', false, 'raw_data');",
                "// Line 37: if ($sPage == '')",
                "// vulnerable line: 38: {",
                "// Line 39:     echo \"Missing argument 'exec_page'\";",
                "// Line 40:     exit;",
                "// Line 41: }",
                "// Line 42: $sPage = basename($sPage); // protect against ../.. ...",
                "// Line 43: ",
                "// Line 44: session_name('itop-'.md5(APPROOT));",
                "// Line 45: session_start();",
                "// Line 46: $sEnvironment = utils::ReadParam('exec_env', utils::GetCurrentEnvironment());",
                "// Line 47: session_write_close();",
                "// Line 48: ",
                "// Line 49: $sTargetPage = APPROOT.'env-'.$sEnvironment.'/'.$sModule.'/'.$sPage;",
                "// Line 50: ",
                "// vulnerable line: 51: if (!file_exists($sTargetPage))",
                "// vulnerable line: 52: {",
                "// Line 53:     // Do not recall the parameters (security takes precedence)",
                "// Line 54:     echo \"Wrong module, page name or environment...\";",
                "// Line 55:     exit;",
                "// Line 56: }",
                "// Line 57: ",
                "// Line 58: /////////////////////////////////////////",
                "// Line 59: //",
                "// Line 60: // GO!",
                "// Line 61: //",
                "// Line 62: require_once($sTargetPage);"
            ]
        }
    ]
}