{
    "cve_id": "CVE-2024-28849",
    "cve_description": "follow-redirects is an open source, drop-in replacement for Node's `http` and `https` modules that automatically follows redirects. In affected versions follow-redirects only clears authorization header during cross-domain redirect, but keep the proxy-authentication header which contains credentials too. This vulnerability may lead to credentials leak, but has been addressed in version 1.15.6. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-03-14T17:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Drop Proxy-Authorization across hosts.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "index.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 454:   debug(\"redirecting to\", redirectUrl.href);",
                "// Line 455:   this._isRedirect = true;",
                "// Line 456:   spreadUrlObject(redirectUrl, this._options);",
                "// Line 457: ",
                "// Line 458:   // Drop confidential headers when redirecting to a less secure protocol",
                "// Line 459:   // or to a different domain that is not a superdomain",
                "// Line 460:   if (redirectUrl.protocol !== currentUrlParts.protocol &&",
                "// Line 461:      redirectUrl.protocol !== \"https:\" ||",
                "// Line 462:      redirectUrl.host !== currentHost &&",
                "// Line 463:      !isSubdomain(redirectUrl.host, currentHost)) {",
                "// vulnerable line: 464: removeMatchingHeaders(/^(?:authorization|cookie)$/i, this._options.headers);",
                "// Line 465:   }",
                "// Line 466: ",
                "// Line 467:   // Evaluate the beforeRedirect callback",
                "// Line 468:   if (isFunction(beforeRedirect)) {",
                "// Line 469:     var responseDetails = {",
                "// Line 470:       headers: response.headers,",
                "// Line 471:       statusCode: statusCode,",
                "// Line 472:     };",
                "// Line 473:     var requestDetails = {",
                "// Line 474:       url: currentUrl,"
            ]
        },
        {
            "filename_of_changes": "test.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}