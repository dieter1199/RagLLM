{
    "cve_id": "CVE-2024-1230",
    "cve_description": "The SimpleShop plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.10.0. This is due to missing or incorrect nonce validation on the maybe_disconnect_simpleshop function. This makes it possible for unauthenticated attackers to disconnect the site from simpleshop via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.",
    "cve_publish_date": "2024-05-14T14:45Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Add nonce verification to SimpleShop disconnect feature\n\nThe commit ensures security by adding nonce verification to the option to disconnect SimpleShop. Before this, the \"Disconnect SimpleShop\" link lacked this verification. Now, the option checks the '_wpnonce' query parameter with nonce before proceeding.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "Settings.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "11",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 78: ",
                "// Line 79:     public function field_type_disconnect_button(",
                "// Line 80:         $field,",
                "// Line 81:         $escaped_value,",
                "// Line 82:         $object_id,",
                "// Line 83:         $object_type,",
                "// Line 84:         $field_type_object",
                "// Line 85:     ) {",
                "// Line 86:         printf(",
                "// Line 87:             '<a href=\"%s\">%s</a>',",
                "// vulnerable line: 88: htmlspecialchars( admin_url( 'admin.php?page=ssc_options&disconnect_simpleshop=1' ), ENT_QUOTES ),",
                "// Line 89:             __( 'Disconnect SimpleShop', 'simpleshop-cz' )",
                "// Line 90:         );",
                "// Line 91:     }",
                "// Line 92: ",
                "// Line 93:     /**",
                "// Line 94:      * Register our setting to WP",
                "// Line 95:      * @since  0.1.0",
                "// Line 96:      */",
                "// Line 97:     public function init() {",
                "// Line 98:         register_setting( $this->key, $this->key );"
            ]
        }
    ]
}