{
    "cve_id": "CVE-2024-25638",
    "cve_description": "dnsjava is an implementation of DNS in Java. Records in DNS replies are not checked for their relevance to the query, allowing an attacker to respond with RRs from different zones. This vulnerability is fixed in 3.6.0.",
    "cve_publish_date": "2024-07-22T14:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix links to RFCs and IANA registries",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "A6Record.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.net.InetAddress;",
                "// Line 8: import java.net.UnknownHostException;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * A6 Record - maps a domain name to an IPv6 address (historic)",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc6563\">RFC 6563: Moving A6 to Historic Status</a>",
                "// Line 15:  */",
                "// Line 16: public class A6Record extends Record {",
                "// Line 17:   private int prefixBits;",
                "// Line 18:   private InetAddress suffix;",
                "// Line 19:   private Name prefix;",
                "// Line 20: ",
                "// Line 21:   A6Record() {}",
                "// Line 22: ",
                "// Line 23:   /**",
                "// Line 24:    * Creates an A6 Record from the given data"
            ]
        },
        {
            "filename_of_changes": "AAAARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.net.InetAddress;",
                "// Line 8: import java.net.UnknownHostException;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * IPv6 Address Record - maps a domain name to an IPv6 address",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc3596\">RFC 3596: DNS Extensions to Support IP Version",
                "// vulnerable line: 15: *     6</a>",
                "// Line 16:  */",
                "// Line 17: public class AAAARecord extends Record {",
                "// Line 18:   private byte[] address;",
                "// Line 19: ",
                "// Line 20:   AAAARecord() {}",
                "// Line 21: ",
                "// Line 22:   /**",
                "// Line 23:    * Creates an AAAA record from the given address.",
                "// Line 24:    *",
                "// Line 25:    * @param address The address that the name refers to."
            ]
        },
        {
            "filename_of_changes": "AFSDBRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * AFS Data Base Record - maps a domain name to the name of an AFS cell database server.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1183\">RFC 1183: New DNS RR Definitions</a>",
                "// Line 11:  */",
                "// Line 12: public class AFSDBRecord extends U16NameBase {",
                "// Line 13:   AFSDBRecord() {}",
                "// Line 14: ",
                "// Line 15:   /**",
                "// Line 16:    * Creates an AFSDB Record from the given data.",
                "// Line 17:    *",
                "// Line 18:    * @param subtype Indicates the type of service provided by the host.",
                "// Line 19:    * @param host The host providing the service.",
                "// Line 20:    */"
            ]
        },
        {
            "filename_of_changes": "APLRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 12: ",
                "// Line 13: /*",
                "// Line 14:  * Note: this currently uses the same constants as the Address class;",
                "// Line 15:  * this could change if more constants are defined for APL records.",
                "// Line 16:  */",
                "// Line 17: ",
                "// Line 18: /**",
                "// Line 19:  * APL - Address Prefix List.",
                "// Line 20:  *",
                "// Line 21:  * @author Brian Wellington",
                "// vulnerable line: 22: * @see <a href=\"https://tools.ietf.org/html/rfc3123\">RFC 3123: A DNS RR Type for Lists of Address",
                "// vulnerable line: 23: *     Prefixes (APL RR)</a>",
                "// Line 24:  */",
                "// Line 25: public class APLRecord extends Record {",
                "// Line 26: ",
                "// Line 27:   public static class Element {",
                "// Line 28:     public final int family;",
                "// Line 29:     public final boolean negative;",
                "// Line 30:     public final int prefixLength;",
                "// Line 31:     public final Object address;",
                "// Line 32: ",
                "// Line 33:     private Element(int family, boolean negative, Object address, int prefixLength) {"
            ]
        },
        {
            "filename_of_changes": "ARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.net.InetAddress;",
                "// Line 8: import java.net.UnknownHostException;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * Address Record - maps a domain name to an Internet address",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 15: *     Specification</a>",
                "// Line 16:  */",
                "// Line 17: public class ARecord extends Record {",
                "// Line 18:   private int addr;",
                "// Line 19: ",
                "// Line 20:   ARecord() {}",
                "// Line 21: ",
                "// Line 22:   private static int fromArray(byte[] array) {",
                "// Line 23:     return ((array[0] & 0xFF) << 24)",
                "// Line 24:         | ((array[1] & 0xFF) << 16)",
                "// Line 25:         | ((array[2] & 0xFF) << 8)"
            ]
        },
        {
            "filename_of_changes": "CAARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Certification Authority Authorization",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc6844\">RFC 6844: DNS Certification Authority",
                "// vulnerable line: 13: *     Authorization (CAA) Resource Record</a>",
                "// Line 14:  */",
                "// Line 15: public class CAARecord extends Record {",
                "// Line 16:   public static class Flags {",
                "// Line 17:     private Flags() {}",
                "// Line 18: ",
                "// Line 19:     public static final int IssuerCritical = 128;",
                "// Line 20:   }",
                "// Line 21: ",
                "// Line 22:   private int flags;",
                "// Line 23:   private byte[] tag;"
            ]
        },
        {
            "filename_of_changes": "CDNSKEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.security.PublicKey;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Child DNSKEY record as specified in RFC 8078.",
                "// Line 8:  *",
                "// Line 9:  * @see DNSSEC",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc8078\">RFC 8078: Managing DS Records from the Parent",
                "// vulnerable line: 11: *     via CDS/CDNSKEY</a>",
                "// Line 12:  */",
                "// Line 13: public class CDNSKEYRecord extends DNSKEYRecord {",
                "// Line 14:   CDNSKEYRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a CDNSKEY Record from the given data",
                "// Line 18:    *",
                "// Line 19:    * @param flags Flags describing the key's properties",
                "// Line 20:    * @param proto The protocol that the key was created for",
                "// Line 21:    * @param alg The key's algorithm"
            ]
        },
        {
            "filename_of_changes": "CDSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: /**",
                "// Line 5:  * Child Delegation Signer record as specified in RFC 8078.",
                "// Line 6:  *",
                "// Line 7:  * @see DNSSEC",
                "// vulnerable line: 8: * @see <a href=\"https://tools.ietf.org/html/rfc8078\">RFC 8078: Managing DS Records from the Parent",
                "// vulnerable line: 9: *     via CDS/CDNSKEY</a>",
                "// Line 10:  */",
                "// Line 11: public class CDSRecord extends DSRecord {",
                "// Line 12:   CDSRecord() {}",
                "// Line 13: ",
                "// Line 14:   /**",
                "// Line 15:    * Creates a CDS Record from the given data",
                "// Line 16:    *",
                "// Line 17:    * @param footprint The original KEY record's footprint (keyid).",
                "// Line 18:    * @param alg The original key algorithm.",
                "// Line 19:    * @param digestid The digest id code."
            ]
        },
        {
            "filename_of_changes": "CERTRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import org.xbill.DNS.utils.base64;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Certificate Record - Stores a certificate associated with a name. The certificate might also be",
                "// Line 11:  * associated with a KEYRecord.",
                "// Line 12:  *",
                "// Line 13:  * @see KEYRecord",
                "// Line 14:  * @author Brian Wellington",
                "// vulnerable line: 15: * @see <a href=\"https://tools.ietf.org/html/rfc4398\">RFC 4398: Storing Certificates in the Domain",
                "// vulnerable line: 16: *     Name System (DNS)</a>",
                "// Line 17:  */",
                "// Line 18: public class CERTRecord extends Record {",
                "// Line 19: ",
                "// Line 20:   /** Certificate type identifiers. */",
                "// Line 21:   public static class CertificateType {",
                "// Line 22: ",
                "// Line 23:     private CertificateType() {}",
                "// Line 24: ",
                "// Line 25:     /** PKIX (X.509v3) */",
                "// Line 26:     public static final int PKIX = 1;"
            ]
        },
        {
            "filename_of_changes": "CNAMERecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * CNAME Record - maps an alias to its real name",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class CNAMERecord extends SingleCompressedNameBase {",
                "// Line 14:   CNAMERecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new CNAMERecord with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param alias The name to which the CNAME alias points",
                "// Line 20:    */",
                "// Line 21:   public CNAMERecord(Name name, int dclass, long ttl, Name alias) {"
            ]
        },
        {
            "filename_of_changes": "ClientSubnetOption.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.net.InetAddress;",
                "// Line 7: import java.net.UnknownHostException;",
                "// Line 8: ",
                "// Line 9: /**",
                "// vulnerable line: 10: * The Client Subnet EDNS Option, defined in <a href=\"https://tools.ietf.org/html/rfc7871\">Client",
                "// vulnerable line: 11: * subnet in DNS requests</a>.",
                "// Line 12:  *",
                "// Line 13:  * <p>The option is used to convey information about the IP address of the originating client, so",
                "// Line 14:  * that an authoritative server can make decisions based on this address, rather than the address of",
                "// Line 15:  * the intermediate caching name server.",
                "// Line 16:  *",
                "// Line 17:  * <p>The option is transmitted as part of an OPTRecord in the additional section of a DNS message,",
                "// Line 18:  * as defined by RFC 6891 (EDNS0).",
                "// Line 19:  *",
                "// Line 20:  * <p>The wire format of the option contains a 2-byte length field (1 for IPv4, 2 for IPv6), a",
                "// Line 21:  * 1-byte source netmask, a 1-byte scope netmask, and an address truncated to the source netmask"
            ]
        },
        {
            "filename_of_changes": "CookieOption.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.io.IOException;",
                "// Line 5: import java.util.Optional;",
                "// Line 6: import org.xbill.DNS.utils.base16;",
                "// Line 7: ",
                "// Line 8: /**",
                "// vulnerable line: 9: * Cookie EDNS0 Option, as defined in https://tools.ietf.org/html/rfc7873",
                "// Line 10:  *",
                "// Line 11:  * @see OPTRecord",
                "// Line 12:  * @author Klaus Malorny",
                "// Line 13:  */",
                "// Line 14: public class CookieOption extends EDNSOption {",
                "// Line 15: ",
                "// Line 16:   /** client cookie */",
                "// Line 17:   private byte[] clientCookie;",
                "// Line 18: ",
                "// Line 19:   /** server cookie */"
            ]
        },
        {
            "filename_of_changes": "DHCIDRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import org.xbill.DNS.utils.base64;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * DHCID - Dynamic Host Configuration Protocol (DHCP) ID (RFC 4701)",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc4701\">RFC 4701: A DNS Resource Record (RR) for",
                "// vulnerable line: 14: *     Encoding Dynamic Host Configuration Protocol (DHCP) Information (DHCID RR)</a>",
                "// Line 15:  */",
                "// Line 16: public class DHCIDRecord extends Record {",
                "// Line 17:   private byte[] data;",
                "// Line 18: ",
                "// Line 19:   DHCIDRecord() {}",
                "// Line 20: ",
                "// Line 21:   /**",
                "// Line 22:    * Creates an DHCID Record from the given data",
                "// Line 23:    *",
                "// Line 24:    * @param data The binary data, which is opaque to DNS."
            ]
        },
        {
            "filename_of_changes": "DLVRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7: import org.xbill.DNS.utils.base16;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * DLV - contains a Delegation Lookaside Validation record, which acts as the equivalent of a DS",
                "// Line 11:  * record in a lookaside zone.",
                "// Line 12:  *",
                "// Line 13:  * @see DNSSEC",
                "// Line 14:  * @see DSRecord",
                "// Line 15:  * @author David Blacka",
                "// Line 16:  * @author Brian Wellington",
                "// vulnerable line: 17: * @see <a href=\"https://tools.ietf.org/html/rfc4431\">RFC 4431: The DNSSEC Lookaside Validation",
                "// vulnerable line: 18: *     (DLV) DNS Resource Record</a>",
                "// Line 19:  */",
                "// Line 20: public class DLVRecord extends Record {",
                "// Line 21: ",
                "// Line 22:   /**",
                "// Line 23:    * SHA1 digest ID for DLV records.",
                "// Line 24:    *",
                "// Line 25:    * @deprecated use {@link DNSSEC.Digest#SHA1}",
                "// Line 26:    */",
                "// Line 27:   @Deprecated public static final int SHA1_DIGEST_ID = DNSSEC.Digest.SHA1;",
                "// Line 28: "
            ]
        },
        {
            "filename_of_changes": "DNAMERecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * DNAME Record - maps a nonterminal alias (subtree) to a different domain",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc6672\">RFC 6672: DNAME Redirection in the DNS</a>",
                "// Line 11:  */",
                "// Line 12: public class DNAMERecord extends SingleNameBase {",
                "// Line 13:   DNAMERecord() {}",
                "// Line 14: ",
                "// Line 15:   /**",
                "// Line 16:    * Creates a new DNAMERecord with the given data",
                "// Line 17:    *",
                "// Line 18:    * @param alias The name to which the DNAME alias points",
                "// Line 19:    */",
                "// Line 20:   public DNAMERecord(Name name, int dclass, long ttl, Name alias) {"
            ]
        },
        {
            "filename_of_changes": "DNSKEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.security.PublicKey;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Key - contains a cryptographic public key for use by DNS. The data can be converted to objects",
                "// Line 11:  * implementing java.security.interfaces.PublicKey",
                "// Line 12:  *",
                "// Line 13:  * @see DNSSEC",
                "// Line 14:  * @author Brian Wellington",
                "// vulnerable line: 15: * @see <a href=\"https://tools.ietf.org/html/rfc4034\">RFC 4034: Resource Records for the DNS",
                "// vulnerable line: 16: *     Security Extensions</a>",
                "// Line 17:  */",
                "// Line 18: public class DNSKEYRecord extends KEYBase {",
                "// Line 19: ",
                "// Line 20:   public static class Protocol {",
                "// Line 21:     private Protocol() {}",
                "// Line 22: ",
                "// Line 23:     /** Key will be used for DNSSEC */",
                "// Line 24:     public static final int DNSSEC = 3;",
                "// Line 25:   }",
                "// Line 26: "
            ]
        },
        {
            "filename_of_changes": "DSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 6: import java.io.IOException;",
                "// Line 7: import org.xbill.DNS.utils.base16;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * DS - contains a Delegation Signer record, which acts as a placeholder for KEY records in the",
                "// Line 11:  * parent zone.",
                "// Line 12:  *",
                "// Line 13:  * @see DNSSEC",
                "// Line 14:  * @author David Blacka",
                "// Line 15:  * @author Brian Wellington",
                "// vulnerable line: 16: * @see <a href=\"https://tools.ietf.org/html/rfc4034\">RFC 4034: Resource Records for the DNS",
                "// vulnerable line: 17: *     Security Extensions</a>",
                "// Line 18:  */",
                "// Line 19: public class DSRecord extends Record {",
                "// Line 20: ",
                "// Line 21:   /**",
                "// Line 22:    * DS digest constants.",
                "// Line 23:    *",
                "// Line 24:    * @deprecated use {@link DNSSEC.Digest}",
                "// Line 25:    */",
                "// Line 26:   @Deprecated",
                "// Line 27:   public static class Digest {"
            ]
        },
        {
            "filename_of_changes": "DohResolver.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 28: import javax.net.ssl.HttpsURLConnection;",
                "// Line 29: import javax.net.ssl.SSLContext;",
                "// Line 30: import javax.net.ssl.SSLSocketFactory;",
                "// Line 31: import lombok.SneakyThrows;",
                "// Line 32: import lombok.Value;",
                "// Line 33: import lombok.extern.slf4j.Slf4j;",
                "// Line 34: import org.xbill.DNS.AsyncSemaphore.Permit;",
                "// Line 35: import org.xbill.DNS.utils.base64;",
                "// Line 36: ",
                "// Line 37: /**",
                "// vulnerable line: 38: * Proof-of-concept <a href=\"https://tools.ietf.org/html/rfc8484\">DNS over HTTP (DoH)</a> resolver.",
                "// vulnerable line: 39: * This class is not suitable for high load scenarios because of the shortcomings of Java's built-in",
                "// vulnerable line: 40: * HTTP clients. For more control, implement your own {@link Resolver} using e.g. <a",
                "// Line 41:  * href=\"https://github.com/square/okhttp/\">OkHttp</a>.",
                "// Line 42:  *",
                "// Line 43:  * <p>On Java 8, it uses HTTP/1.1, which is against the recommendation of RFC 8484 to use HTTP/2 and",
                "// Line 44:  * thus slower. On Java 11 or newer, HTTP/2 is always used, but the built-in HttpClient has its own",
                "// Line 45:  * <a href=\"https://bugs.openjdk.java.net/browse/JDK-8225647\">issues</a> with connection handling.",
                "// Line 46:  *",
                "// Line 47:  * <p>As of 2020-09-13, the following limits of public resolvers for HTTP/2 were observed:",
                "// Line 48:  * <li>https://cloudflare-dns.com/dns-query: max streams=250, idle timeout=400s",
                "// Line 49:  * <li>https://dns.google/dns-query: max streams=100, idle timeout=240s",
                "// Line 50:  *"
            ]
        },
        {
            "filename_of_changes": "ExtendedErrorCodeOption.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "6",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 33:    */",
                "// Line 34:   public static final int STALE_ANSWER = 3;",
                "// Line 35: ",
                "// Line 36:   /**",
                "// Line 37:    * For policy reasons (legal obligation or malware filtering, for instance), an answer was forged.",
                "// Line 38:    */",
                "// Line 39:   public static final int FORGED_ANSWER = 4;",
                "// Line 40: ",
                "// Line 41:   /**",
                "// Line 42:    * The resolver attempted to perform DNSSEC validation, but validation ended in the Indeterminate",
                "// vulnerable line: 43: * state [RFC4035].",
                "// Line 44:    */",
                "// Line 45:   public static final int DNSSEC_INDETERMINATE = 5;",
                "// Line 46: ",
                "// Line 47:   /**",
                "// Line 48:    * The resolver attempted to perform DNSSEC validation, but validation ended in the Bogus state.",
                "// Line 49:    */",
                "// Line 50:   public static final int DNSSEC_BOGUS = 6;",
                "// Line 51: ",
                "// Line 52:   /**",
                "// Line 53:    * The resolver attempted to perform DNSSEC validation, but no signatures are presently valid and",
                "// Line 156:    * @since 3.6",
                "// Line 157:    * @see <a href=\"https://github.com/NLnetLabs/unbound/pull/604#discussion_r802678343\">Unbound",
                "// Line 158:    *     PR#604</a>",
                "// Line 159:    */",
                "// Line 160:   public static final int SIGNATURE_EXPIRED_BEFORE_VALID = 25;",
                "// Line 161: ",
                "// Line 162:   /**",
                "// Line 163:    * DNS over QUIC session resumption error.",
                "// Line 164:    *",
                "// Line 165:    * @since 3.6",
                "// vulnerable line: 166: * @see <a href=\"https://www.rfc-editor.org/rfc/rfc9250.html#section-4.5-3\">RFC9250, 4.5</a>",
                "// Line 167:    */",
                "// Line 168:   public static final int TOO_EARLY = 26;",
                "// Line 169: ",
                "// Line 170:   /**",
                "// Line 171:    * The NSEC3 iterations value is not supported.",
                "// Line 172:    *",
                "// Line 173:    * @since 3.6",
                "// vulnerable line: 174: * @see <a href=\"https://www.rfc-editor.org/rfc/rfc9276.html#section-3.2\">RFC9276, 3.2</a>",
                "// Line 175:    */",
                "// Line 176:   public static final int UNSUPPORTED_NSEC3_ITERATIONS_VALUE = 27;",
                "// Line 177: ",
                "// Line 178:   /**",
                "// Line 179:    * Unable to conform to policy.",
                "// Line 180:    *",
                "// Line 181:    * @since 3.6",
                "// Line 182:    * @see <a",
                "// vulnerable line: 183: *     href=\"https://datatracker.ietf.org/doc/draft-homburg-dnsop-codcp/01/\">draft-homburg-dnsop-codcp,",
                "// vulnerable line: 184: *     12</a>",
                "// Line 185:    */",
                "// Line 186:   public static final int UNABLE_TO_CONFORM_TO_POLICY = 28;",
                "// Line 187: ",
                "// Line 188:   /**",
                "// Line 189:    * Result synthesized from aggressive NSEC cache.",
                "// Line 190:    *",
                "// Line 191:    * @since 3.6",
                "// Line 192:    * @see <a href=\"https://github.com/PowerDNS/pdns/pull/12334\">PowerDNS PR#12334</a>",
                "// vulnerable line: 193: * @see <a href=\"https://datatracker.ietf.org/doc/html/rfc8198\">RFC8198</a>",
                "// Line 194:    */",
                "// Line 195:   public static final int SYNTHESIZED = 29;",
                "// Line 196: ",
                "// Line 197:   @Getter private int errorCode;",
                "// Line 198:   @Getter private String text;",
                "// Line 199: ",
                "// Line 200:   private static final Mnemonic codes =",
                "// Line 201:       new Mnemonic(\"EDNS Extended Error Codes\", Mnemonic.CASE_SENSITIVE);",
                "// Line 202: ",
                "// Line 203:   static {"
            ]
        },
        {
            "filename_of_changes": "GPOSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Geographical Location - describes the physical location of a host. (withdrawn -- this was a",
                "// Line 10:  * limited early version of {@link LOCRecord})",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc1712\">RFC 1712: DNS Encoding of Geographical",
                "// vulnerable line: 14: *     Location</a>",
                "// Line 15:  */",
                "// Line 16: public class GPOSRecord extends Record {",
                "// Line 17:   private byte[] latitude, longitude, altitude;",
                "// Line 18: ",
                "// Line 19:   GPOSRecord() {}",
                "// Line 20: ",
                "// Line 21:   private void validate(double longitude, double latitude) throws IllegalArgumentException {",
                "// Line 22:     if (longitude < -90.0 || longitude > 90.0) {",
                "// Line 23:       throw new IllegalArgumentException(\"illegal longitude \" + longitude);",
                "// Line 24:     }"
            ]
        },
        {
            "filename_of_changes": "HINFORecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Host Information - describes the CPU and OS of a host",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 13: *     Specification</a>",
                "// Line 14:  */",
                "// Line 15: public class HINFORecord extends Record {",
                "// Line 16:   private byte[] cpu, os;",
                "// Line 17: ",
                "// Line 18:   HINFORecord() {}",
                "// Line 19: ",
                "// Line 20:   /**",
                "// Line 21:    * Creates an HINFO Record from the given data",
                "// Line 22:    *",
                "// Line 23:    * @param cpu A string describing the host's CPU"
            ]
        },
        {
            "filename_of_changes": "HTTPSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.util.List;",
                "// Line 5: ",
                "// Line 6: /**",
                "// vulnerable line: 7: * HTTPS Service Location and Parameter Binding Record",
                "// Line 8:  *",
                "// vulnerable line: 9: * @see <a",
                "// vulnerable line: 10: *     href=\"https://tools.ietf.org/html/draft-ietf-dnsop-svcb-https-06\">draft-ietf-dnsop-svcb-https</a>",
                "// Line 11:  * @since 3.3",
                "// Line 12:  */",
                "// Line 13: public class HTTPSRecord extends SVCBBase {",
                "// Line 14:   HTTPSRecord() {}",
                "// Line 15: ",
                "// Line 16:   public HTTPSRecord(",
                "// Line 17:       Name name, int dclass, long ttl, int priority, Name domain, List<ParameterBase> params) {",
                "// Line 18:     super(name, Type.HTTPS, dclass, ttl, priority, domain, params);",
                "// Line 19:   }",
                "// Line 20: }"
            ]
        },
        {
            "filename_of_changes": "IPSECKEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "17",
            "number_of_lines_deleted_vulnerable_to_cve": "5",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.net.Inet6Address;",
                "// Line 8: import java.net.InetAddress;",
                "// Line 9: import org.xbill.DNS.utils.base64;",
                "// Line 10: ",
                "// Line 11: /**",
                "// Line 12:  * IPsec Keying Material (RFC 4025)",
                "// Line 13:  *",
                "// Line 14:  * @author Brian Wellington",
                "// vulnerable line: 15: * @see <a href=\"https://tools.ietf.org/html/rfc4025\">RFC 4025: A Method for Storing IPsec Keying",
                "// vulnerable line: 16: *     Material in DNS</a>",
                "// Line 17:  */",
                "// Line 18: public class IPSECKEYRecord extends Record {",
                "// Line 19:   /**",
                "// Line 20:    * Algorithm types for IPSECKEY RRs as defined in <a",
                "// Line 21:    * href=\"https://www.iana.org/assignments/ipseckey-rr-parameters/ipseckey-rr-parameters.xhtml#ipseckey-rr-parameters-1\">IPSECKEY",
                "// Line 22:    * Resource Record Parameters</a>.",
                "// Line 23:    */",
                "// Line 24:   public static class Algorithm {",
                "// Line 25:     private Algorithm() {}",
                "// Line 26: ",
                "// vulnerable line: 27: /** A DSA key is present, in the format defined in [RFC2536] */",
                "// Line 28:     public static final int DSA = 1;",
                "// Line 29: ",
                "// vulnerable line: 30: /** A RSA key is present, in the format defined in [RFC3110] */",
                "// Line 31:     public static final int RSA = 2;",
                "// Line 32: ",
                "// vulnerable line: 33: /** An ECDSA key is present, in the format defined in [RFC6605] */",
                "// Line 34:     public static final int ECDSA = 3;",
                "// Line 35:   }",
                "// Line 36: ",
                "// Line 37:   /**",
                "// Line 38:    * Gateway types for IPSECKEY RRs as defined in <a",
                "// Line 39:    * href=\"https://www.iana.org/assignments/ipseckey-rr-parameters/ipseckey-rr-parameters.xhtml#ipseckey-rr-parameters-2\">IPSECKEY",
                "// Line 40:    * Resource Record Parameters</a>.",
                "// Line 41:    */",
                "// Line 42:   public static class Gateway {",
                "// Line 43:     private Gateway() {}"
            ]
        },
        {
            "filename_of_changes": "ISDNRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * ISDN - identifies the ISDN number and subaddress associated with a name.",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc1183\">RFC 1183: New DNS RR Definitions</a>",
                "// Line 13:  */",
                "// Line 14: public class ISDNRecord extends Record {",
                "// Line 15:   private byte[] address;",
                "// Line 16:   private byte[] subAddress;",
                "// Line 17: ",
                "// Line 18:   ISDNRecord() {}",
                "// Line 19: ",
                "// Line 20:   /**",
                "// Line 21:    * Creates an ISDN Record from the given data",
                "// Line 22:    *"
            ]
        },
        {
            "filename_of_changes": "KEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7: import java.security.PublicKey;",
                "// Line 8: import java.util.StringTokenizer;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * Key - contains a cryptographic public key. The data can be converted to objects implementing",
                "// Line 12:  * java.security.interfaces.PublicKey",
                "// Line 13:  *",
                "// Line 14:  * @see DNSSEC",
                "// Line 15:  * @see DNSKEYRecord",
                "// Line 16:  * @author Brian Wellington",
                "// vulnerable line: 17: * @see <a href=\"https://tools.ietf.org/html/rfc2535\">RFC 2535: Domain Name System Security",
                "// vulnerable line: 18: *     Extensions</a>",
                "// vulnerable line: 19: * @see <a href=\"https://tools.ietf.org/html/rfc3755\">RFC 3755: Legacy Resolver Compatibility for",
                "// vulnerable line: 20: *     Delegation Signer (DS)</a>",
                "// Line 21:  */",
                "// Line 22: public class KEYRecord extends KEYBase {",
                "// Line 23:   /** KEY protocol identifiers. */",
                "// Line 24:   public static class Protocol {",
                "// Line 25: ",
                "// Line 26:     private Protocol() {}",
                "// Line 27: ",
                "// Line 28:     /** No defined protocol. */",
                "// Line 29:     public static final int NONE = 0;",
                "// Line 30: "
            ]
        },
        {
            "filename_of_changes": "KXRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Key Exchange - delegation of authority",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc2230\">RFC 2230: Key Exchange Delegation Record for",
                "// vulnerable line: 11: *     the DNS</a>",
                "// Line 12:  */",
                "// Line 13: public class KXRecord extends U16NameBase {",
                "// Line 14:   KXRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a KX Record from the given data",
                "// Line 18:    *",
                "// Line 19:    * @param preference The preference of this KX. Records with lower priority are preferred.",
                "// Line 20:    * @param target The host that authority is delegated to",
                "// Line 21:    */"
            ]
        },
        {
            "filename_of_changes": "LOCRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.text.DecimalFormat;",
                "// Line 8: import java.text.NumberFormat;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * Location - describes the physical location of hosts, networks, subnets.",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc1876\">RFC 1876: A Means for Expressing Location",
                "// vulnerable line: 15: *     Information in the Domain Name System</a>",
                "// Line 16:  */",
                "// Line 17: public class LOCRecord extends Record {",
                "// Line 18:   private static final NumberFormat w2;",
                "// Line 19:   private static final NumberFormat w3;",
                "// Line 20:   private long size, hPrecision, vPrecision;",
                "// Line 21:   private long latitude, longitude, altitude;",
                "// Line 22: ",
                "// Line 23:   static {",
                "// Line 24:     w2 = new DecimalFormat();",
                "// Line 25:     w2.setMinimumIntegerDigits(2);"
            ]
        },
        {
            "filename_of_changes": "LookupSession.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 556:                         \"Message normalization failed, refusing to return it\", e));",
                "// Line 557:               }",
                "// Line 558:             })",
                "// Line 559:         .thenApply(this::maybeAddToCache)",
                "// Line 560:         .thenApply(answer -> buildResult(answer, aliases, queryRecord));",
                "// Line 561:   }",
                "// Line 562: ",
                "// Line 563:   private Message maybeAddToCache(Message message) {",
                "// Line 564:     for (RRset set : message.getSectionRRsets(Section.ANSWER)) {",
                "// Line 565:       if ((set.getType() == Type.CNAME || set.getType() == Type.DNAME) && set.size() != 1) {",
                "// vulnerable line: 566: throw new InvalidZoneDataException(\"Multiple CNAME RRs not allowed, see RFC1034 3.6.2\");",
                "// Line 567:       }",
                "// Line 568:     }",
                "// Line 569:     Optional.ofNullable(caches.get(message.getQuestion().getDClass()))",
                "// Line 570:         .ifPresent(cache -> cache.addMessage(message));",
                "// Line 571:     return message;",
                "// Line 572:   }",
                "// Line 573: ",
                "// Line 574:   @SuppressWarnings(\"deprecated\")",
                "// Line 575:   private CompletionStage<LookupResult> setResponseToMessageFuture(",
                "// Line 576:       SetResponse setResponse, Record queryRecord, List<Name> aliases) {"
            ]
        },
        {
            "filename_of_changes": "MBRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mailbox Record - specifies a host containing a mailbox.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc883\">RFC 883: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class MBRecord extends SingleNameBase {",
                "// Line 14:   MBRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new MB Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param mailbox The host containing the mailbox for the domain.",
                "// Line 20:    */",
                "// Line 21:   public MBRecord(Name name, int dclass, long ttl, Name mailbox) {"
            ]
        },
        {
            "filename_of_changes": "MDRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mail Destination Record - specifies a mail agent which delivers mail for a domain (obsolete)",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc973\">RFC 973: Domain System Changes and",
                "// Line 11:  *     Observations</a>",
                "// Line 12:  */",
                "// Line 13: public class MDRecord extends SingleNameBase {",
                "// Line 14:   MDRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new MD Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param mailAgent The mail agent that delivers mail for the domain.",
                "// Line 20:    */"
            ]
        },
        {
            "filename_of_changes": "MFRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mail Forwarder Record - specifies a mail agent which forwards mail for a domain (obsolete)",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc973\">RFC 973: Domain System Changes and",
                "// Line 11:  *     Observations</a>",
                "// Line 12:  */",
                "// Line 13: public class MFRecord extends SingleNameBase {",
                "// Line 14:   MFRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new MF Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param mailAgent The mail agent that forwards mail for the domain.",
                "// Line 20:    */"
            ]
        },
        {
            "filename_of_changes": "MGRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mail Group Record - specifies a mailbox which is a member of a mail group.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc883\">RFC 883: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class MGRecord extends SingleNameBase {",
                "// Line 14:   MGRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new MG Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param mailbox The mailbox that is a member of the group specified by the domain.",
                "// Line 20:    */",
                "// Line 21:   public MGRecord(Name name, int dclass, long ttl, Name mailbox) {"
            ]
        },
        {
            "filename_of_changes": "MINFORecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Mailbox information Record - lists the address responsible for a mailing list/mailbox and the",
                "// Line 10:  * address to receive error messages relating to the mailing list/mailbox.",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc883\">RFC 883: Domain Names - Implementation and",
                "// vulnerable line: 14: *     Specification</a>",
                "// Line 15:  */",
                "// Line 16: public class MINFORecord extends Record {",
                "// Line 17:   private Name responsibleAddress;",
                "// Line 18:   private Name errorAddress;",
                "// Line 19: ",
                "// Line 20:   MINFORecord() {}",
                "// Line 21: ",
                "// Line 22:   /**",
                "// Line 23:    * Creates an MINFO Record from the given data",
                "// Line 24:    *"
            ]
        },
        {
            "filename_of_changes": "MRRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mailbox Rename Record - specifies a rename of a mailbox.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc883\">RFC 883: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class MRRecord extends SingleNameBase {",
                "// Line 14:   MRRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new MR Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param newName The new name of the mailbox specified by the domain. domain.",
                "// Line 20:    */",
                "// Line 21:   public MRRecord(Name name, int dclass, long ttl, Name newName) {"
            ]
        },
        {
            "filename_of_changes": "MXRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Mail Exchange - specifies where mail to a domain is sent",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc7505\">RFC 7505: A \"Null MX\" No Service Resource",
                "// vulnerable line: 13: *     Record for Domains That Accept No Mail</a>",
                "// Line 14:  */",
                "// Line 15: public class MXRecord extends U16NameBase {",
                "// Line 16:   MXRecord() {}",
                "// Line 17: ",
                "// Line 18:   /**",
                "// Line 19:    * Creates an MX Record from the given data",
                "// Line 20:    *",
                "// Line 21:    * @param priority The priority of this MX. Records with lower priority are preferred.",
                "// Line 22:    * @param target The host that mail is sent to",
                "// Line 23:    */"
            ]
        },
        {
            "filename_of_changes": "NAPTRRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Name Authority Pointer Record - specifies rewrite rule, that when applied to an existing string",
                "// Line 10:  * will produce a new domain.",
                "// Line 11:  *",
                "// Line 12:  * @author Chuck Santos",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc3403\">RFC 3403: Dynamic Delegation Discovery System",
                "// vulnerable line: 14: *     (DDDS) Part Three: The Domain Name System (DNS) Database</a>",
                "// Line 15:  */",
                "// Line 16: public class NAPTRRecord extends Record {",
                "// Line 17:   private int order, preference;",
                "// Line 18:   private byte[] flags, service, regexp;",
                "// Line 19:   private Name replacement;",
                "// Line 20: ",
                "// Line 21:   NAPTRRecord() {}",
                "// Line 22: ",
                "// Line 23:   /**",
                "// Line 24:    * Creates an NAPTR Record from the given data"
            ]
        },
        {
            "filename_of_changes": "NSAPRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.ByteArrayOutputStream;",
                "// Line 7: import java.io.IOException;",
                "// Line 8: import org.xbill.DNS.utils.base16;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * NSAP Address Record.",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc1706\">RFC 1706: DNS NSAP Resource Records</a>",
                "// Line 15:  */",
                "// Line 16: public class NSAPRecord extends Record {",
                "// Line 17:   private byte[] address;",
                "// Line 18: ",
                "// Line 19:   NSAPRecord() {}",
                "// Line 20: ",
                "// Line 21:   private static byte[] checkAndConvertAddress(String address) {",
                "// Line 22:     if (!address.substring(0, 2).equalsIgnoreCase(\"0x\")) {",
                "// Line 23:       return null;",
                "// Line 24:     }"
            ]
        },
        {
            "filename_of_changes": "NSAP_PTRRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * NSAP Pointer Record - maps a domain name representing an NSAP Address to a hostname. (obsolete)",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1706\">RFC 1706: DNS NSAP Resource Records</a>",
                "// Line 11:  */",
                "// Line 12: public class NSAP_PTRRecord extends SingleNameBase {",
                "// Line 13:   NSAP_PTRRecord() {}",
                "// Line 14: ",
                "// Line 15:   /**",
                "// Line 16:    * Creates a new NSAP_PTR Record with the given data",
                "// Line 17:    *",
                "// Line 18:    * @param target The name of the host with this address",
                "// Line 19:    */",
                "// Line 20:   public NSAP_PTRRecord(Name name, int dclass, long ttl, Name target) {"
            ]
        },
        {
            "filename_of_changes": "NSEC3PARAMRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 8: import org.xbill.DNS.utils.base16;",
                "// Line 9: ",
                "// Line 10: /**",
                "// Line 11:  * Next SECure name 3 Parameters - this record contains the parameters (hash algorithm, salt,",
                "// Line 12:  * iterations) used for a valid, complete NSEC3 chain present in a zone. Zones signed using NSEC3",
                "// Line 13:  * must include this record at the zone apex to inform authoritative servers that NSEC3 is being",
                "// Line 14:  * used with the given parameters.",
                "// Line 15:  *",
                "// Line 16:  * @author Brian Wellington",
                "// Line 17:  * @author David Blacka",
                "// vulnerable line: 18: * @see <a href=\"https://tools.ietf.org/html/rfc5155\">RFC 5155: DNS Security (DNSSEC) Hashed",
                "// vulnerable line: 19: *     Authenticated Denial of Existence</a>",
                "// Line 20:  */",
                "// Line 21: public class NSEC3PARAMRecord extends Record {",
                "// Line 22:   private int hashAlg;",
                "// Line 23:   private int flags;",
                "// Line 24:   private int iterations;",
                "// Line 25:   private byte[] salt;",
                "// Line 26: ",
                "// Line 27:   NSEC3PARAMRecord() {}",
                "// Line 28: ",
                "// Line 29:   /**"
            ]
        },
        {
            "filename_of_changes": "NSEC3Record.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 11: ",
                "// Line 12: /**",
                "// Line 13:  * Next SECure name 3 - this record contains the next hashed name in an ordered list of hashed names",
                "// Line 14:  * in the zone, and a set of types for which records exist for this name. The presence of this",
                "// Line 15:  * record in a response signifies a negative response from a DNSSEC-signed zone.",
                "// Line 16:  *",
                "// Line 17:  * <p>This replaces the NSEC and NXT records, when used.",
                "// Line 18:  *",
                "// Line 19:  * @author Brian Wellington",
                "// Line 20:  * @author David Blacka",
                "// vulnerable line: 21: * @see <a href=\"https://tools.ietf.org/html/rfc5155\">RFC 5155: DNS Security (DNSSEC) Hashed",
                "// vulnerable line: 22: *     Authenticated Denial of Existence</a>",
                "// Line 23:  */",
                "// Line 24: public class NSEC3Record extends Record {",
                "// Line 25: ",
                "// Line 26:   public static class Flags {",
                "// Line 27:     /** NSEC3 flags identifiers. */",
                "// Line 28:     private Flags() {}",
                "// Line 29: ",
                "// Line 30:     /** Unsigned delegation are not included in the NSEC3 chain. */",
                "// Line 31:     public static final int OPT_OUT = 0x01;",
                "// Line 32:   }"
            ]
        },
        {
            "filename_of_changes": "NSECRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Next SECure name - this record contains the following name in an ordered list of names in the",
                "// Line 10:  * zone, and a set of types for which records exist for this name. The presence of this record in a",
                "// Line 11:  * response signifies a negative response from a DNSSEC-signed zone.",
                "// Line 12:  *",
                "// Line 13:  * <p>This replaces the NXT record.",
                "// Line 14:  *",
                "// Line 15:  * @author Brian Wellington",
                "// Line 16:  * @author David Blacka",
                "// vulnerable line: 17: * @see <a href=\"https://tools.ietf.org/html/rfc4034\">RFC 4034: Resource Records for the DNS",
                "// vulnerable line: 18: *     Security Extensions</a>",
                "// Line 19:  */",
                "// Line 20: public class NSECRecord extends Record {",
                "// Line 21:   private Name next;",
                "// Line 22:   private TypeBitmap types;",
                "// Line 23: ",
                "// Line 24:   NSECRecord() {}",
                "// Line 25: ",
                "// Line 26:   /**",
                "// Line 27:    * Creates an NSEC Record from the given data.",
                "// Line 28:    *"
            ]
        },
        {
            "filename_of_changes": "NSIDOption.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * The Name Server Identifier Option",
                "// Line 8:  *",
                "// Line 9:  * @see OPTRecord",
                "// Line 10:  * @author Brian Wellington",
                "// vulnerable line: 11: * @see <a href=\"https://tools.ietf.org/html/rfc5001\">RFC 5001: DNS Name Server Identifier (NSID)",
                "// vulnerable line: 12: *     Option</a>",
                "// Line 13:  */",
                "// Line 14: public class NSIDOption extends GenericEDNSOption {",
                "// Line 15:   NSIDOption() {",
                "// Line 16:     super(EDNSOption.Code.NSID);",
                "// Line 17:   }",
                "// Line 18: ",
                "// Line 19:   /**",
                "// Line 20:    * Construct an NSID option.",
                "// Line 21:    *",
                "// Line 22:    * @param data The contents of the option."
            ]
        },
        {
            "filename_of_changes": "NSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Name Server Record - contains the name server serving the named zone",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class NSRecord extends SingleCompressedNameBase {",
                "// Line 14:   NSRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new NS Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param target The name server for the given domain",
                "// Line 20:    */",
                "// Line 21:   public NSRecord(Name name, int dclass, long ttl, Name target) {"
            ]
        },
        {
            "filename_of_changes": "NULLRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * The NULL Record. This has no defined purpose, but can be used to hold arbitrary data.",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 13: *     Specification</a>",
                "// Line 14:  */",
                "// Line 15: public class NULLRecord extends Record {",
                "// Line 16:   private byte[] data;",
                "// Line 17: ",
                "// Line 18:   NULLRecord() {}",
                "// Line 19: ",
                "// Line 20:   /**",
                "// Line 21:    * Creates a NULL record from the given data.",
                "// Line 22:    *",
                "// Line 23:    * @param data The contents of the record."
            ]
        },
        {
            "filename_of_changes": "NXTRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.util.BitSet;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Next name - this record contains the following name in an ordered list of names in the zone, and",
                "// Line 11:  * a set of types for which records exist for this name. The presence of this record in a response",
                "// Line 12:  * signifies a failed query for data in a DNSSEC-signed zone.",
                "// Line 13:  *",
                "// Line 14:  * @author Brian Wellington",
                "// vulnerable line: 15: * @see <a href=\"https://tools.ietf.org/html/rfc2065\">RFC 2065: Domain Name System Security",
                "// vulnerable line: 16: *     Extensions</a>",
                "// Line 17:  */",
                "// Line 18: public class NXTRecord extends Record {",
                "// Line 19:   private Name next;",
                "// Line 20:   private BitSet bitmap;",
                "// Line 21: ",
                "// Line 22:   NXTRecord() {}",
                "// Line 23: ",
                "// Line 24:   /**",
                "// Line 25:    * Creates an NXT Record from the given data",
                "// Line 26:    *"
            ]
        },
        {
            "filename_of_changes": "NioTcpClient.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 85:         return;",
                "// Line 86:       }",
                "// Line 87: ",
                "// Line 88:       verboseLog(",
                "// Line 89:           \"TCP write: transaction id=\" + query.getHeader().getID(),",
                "// Line 90:           channel.socket().getLocalSocketAddress(),",
                "// Line 91:           channel.socket().getRemoteSocketAddress(),",
                "// Line 92:           queryData);",
                "// Line 93: ",
                "// Line 94:       // combine length+message to avoid multiple TCP packets",
                "// vulnerable line: 95: // https://tools.ietf.org/html/rfc7766#section-8",
                "// Line 96:       ByteBuffer buffer = ByteBuffer.allocate(queryData.length + 2);",
                "// Line 97:       buffer.put((byte) (queryData.length >>> 8));",
                "// Line 98:       buffer.put((byte) (queryData.length & 0xFF));",
                "// Line 99:       buffer.put(queryData);",
                "// Line 100:       buffer.flip();",
                "// Line 101:       while (buffer.hasRemaining()) {",
                "// Line 102:         long n = channel.write(buffer);",
                "// Line 103:         if (n == 0) {",
                "// Line 104:           throw new EOFException(",
                "// Line 105:               \"Insufficient room for the data in the underlying output buffer for transaction \""
            ]
        },
        {
            "filename_of_changes": "NioUdpClient.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 23: @Slf4j",
                "// Line 24: final class NioUdpClient extends NioClient implements UdpIoClient {",
                "// Line 25:   private final int ephemeralStart;",
                "// Line 26:   private final int ephemeralRange;",
                "// Line 27: ",
                "// Line 28:   private final SecureRandom prng;",
                "// Line 29:   private final Queue<Transaction> registrationQueue = new ConcurrentLinkedQueue<>();",
                "// Line 30:   private final Queue<Transaction> pendingTransactions = new ConcurrentLinkedQueue<>();",
                "// Line 31: ",
                "// Line 32:   NioUdpClient() {",
                "// vulnerable line: 33: // https://tools.ietf.org/html/rfc6335#section-6",
                "// Line 34:     int ephemeralStartDefault = 49152;",
                "// Line 35:     int ephemeralEndDefault = 65535;",
                "// Line 36: ",
                "// Line 37:     // Linux usually uses 32768-60999",
                "// Line 38:     if (System.getProperty(\"os.name\").toLowerCase().contains(\"linux\")) {",
                "// Line 39:       ephemeralStartDefault = 32768;",
                "// Line 40:       ephemeralEndDefault = 60999;",
                "// Line 41:     }",
                "// Line 42: ",
                "// Line 43:     ephemeralStart = Integer.getInteger(\"dnsjava.udp.ephemeral.start\", ephemeralStartDefault);"
            ]
        },
        {
            "filename_of_changes": "NoSuchRRSetException.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS.lookup;",
                "// Line 3: ",
                "// Line 4: import org.xbill.DNS.Name;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Thrown to indicate that records of the name and type queried does not exist, corresponding to the",
                "// vulnerable line: 8: * {@link org.xbill.DNS.Rcode#NXRRSET} return code as specified in RFC2136 Section 2.2.",
                "// Line 9:  *",
                "// Line 10:  * @since 3.4",
                "// Line 11:  */",
                "// Line 12: public class NoSuchRRSetException extends LookupFailedException {",
                "// Line 13:   public NoSuchRRSetException(Name name, int type) {",
                "// Line 14:     this(name, type, false);",
                "// Line 15:   }",
                "// Line 16: ",
                "// Line 17:   NoSuchRRSetException(Name name, int type, boolean isAuthenticated) {",
                "// Line 18:     super(null, null, name, type, isAuthenticated);"
            ]
        },
        {
            "filename_of_changes": "OPENPGPKEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.io.IOException;",
                "// Line 5: import org.xbill.DNS.utils.base64;",
                "// Line 6: ",
                "// Line 7: /**",
                "// Line 8:  * OPENPGPKEY Record - Stores an OpenPGP certificate associated with a name.",
                "// Line 9:  *",
                "// Line 10:  * @author Brian Wellington",
                "// Line 11:  * @author Valentin Hauner",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc7929\">RFC 7929: DNS-Based Authentication of Named",
                "// vulnerable line: 13: *     Entities (DANE) Bindings for OpenPGP</a>",
                "// Line 14:  */",
                "// Line 15: public class OPENPGPKEYRecord extends Record {",
                "// Line 16:   private byte[] cert;",
                "// Line 17: ",
                "// Line 18:   OPENPGPKEYRecord() {}",
                "// Line 19: ",
                "// Line 20:   /**",
                "// Line 21:    * Creates an OPENPGPKEY Record from the given data",
                "// Line 22:    *",
                "// Line 23:    * @param cert Binary data representing the certificate"
            ]
        },
        {
            "filename_of_changes": "OPTRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 11: ",
                "// Line 12: /**",
                "// Line 13:  * Options - describes Extended DNS (EDNS) properties of a Message. No specific options are defined",
                "// Line 14:  * other than those specified in the header. An OPT should be generated by Resolver.",
                "// Line 15:  *",
                "// Line 16:  * <p>EDNS is a method to extend the DNS protocol while providing backwards compatibility and not",
                "// Line 17:  * significantly changing the protocol. This implementation of EDNS is mostly complete at level 0.",
                "// Line 18:  *",
                "// Line 19:  * @see Message",
                "// Line 20:  * @see Resolver",
                "// vulnerable line: 21: * @see <a href=\"https://tools.ietf.org/html/rfc6891\">RFC 6891: Extension Mechanisms for DNS</a>",
                "// Line 22:  * @author Brian Wellington",
                "// Line 23:  */",
                "// Line 24: public class OPTRecord extends Record {",
                "// Line 25:   private List<EDNSOption> options;",
                "// Line 26: ",
                "// Line 27:   OPTRecord() {}",
                "// Line 28: ",
                "// Line 29:   /**",
                "// Line 30:    * Creates an OPT Record. This is normally called by SimpleResolver, but can also be called by a",
                "// Line 31:    * server."
            ]
        },
        {
            "filename_of_changes": "Opcode.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 18: ",
                "// Line 19:   /** A server status request (not used) */",
                "// Line 20:   public static final int STATUS = 2;",
                "// Line 21: ",
                "// Line 22:   /** A message from a primary to a secondary server to initiate a zone transfer */",
                "// Line 23:   public static final int NOTIFY = 4;",
                "// Line 24: ",
                "// Line 25:   /** A dynamic update message */",
                "// Line 26:   public static final int UPDATE = 5;",
                "// Line 27: ",
                "// vulnerable line: 28: /** DNS Stateful Operations (DSO, RFC8490) */",
                "// Line 29:   public static final int DSO = 6;",
                "// Line 30: ",
                "// Line 31:   private static final Mnemonic opcodes = new Mnemonic(\"DNS Opcode\", Mnemonic.CASE_UPPER);",
                "// Line 32: ",
                "// Line 33:   static {",
                "// Line 34:     opcodes.setMaximum(0xF);",
                "// Line 35:     opcodes.setPrefix(\"RESERVED\");",
                "// Line 36:     opcodes.setNumericAllowed(true);",
                "// Line 37: ",
                "// Line 38:     opcodes.add(QUERY, \"QUERY\");"
            ]
        },
        {
            "filename_of_changes": "PTRRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Pointer Record - maps a domain name representing an Internet Address to a hostname.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class PTRRecord extends SingleCompressedNameBase {",
                "// Line 14:   PTRRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates a new PTR Record with the given data",
                "// Line 18:    *",
                "// Line 19:    * @param target The name of the machine with this address",
                "// Line 20:    */",
                "// Line 21:   public PTRRecord(Name name, int dclass, long ttl, Name target) {"
            ]
        },
        {
            "filename_of_changes": "PXRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * X.400 mail mapping record.",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc2163\">RFC 2163: Using the Internet DNS to Distribute",
                "// vulnerable line: 13: *     MIXER Conformant Global Address Mapping (MCGAM)</a>",
                "// Line 14:  */",
                "// Line 15: public class PXRecord extends Record {",
                "// Line 16:   private int preference;",
                "// Line 17:   private Name map822;",
                "// Line 18:   private Name mapX400;",
                "// Line 19: ",
                "// Line 20:   PXRecord() {}",
                "// Line 21: ",
                "// Line 22:   /**",
                "// Line 23:    * Creates an PX Record from the given data"
            ]
        },
        {
            "filename_of_changes": "RPRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Responsible Person Record - lists the mail address of a responsible person and a domain where TXT",
                "// Line 10:  * records are available.",
                "// Line 11:  *",
                "// Line 12:  * @author Tom Scola (tscola@research.att.com)",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc1183\">RFC 1183: New DNS RR Definitions</a>",
                "// Line 15:  */",
                "// Line 16: public class RPRecord extends Record {",
                "// Line 17:   private Name mailbox;",
                "// Line 18:   private Name textDomain;",
                "// Line 19: ",
                "// Line 20:   RPRecord() {}",
                "// Line 21: ",
                "// Line 22:   /**",
                "// Line 23:    * Creates an RP Record from the given data",
                "// Line 24:    *"
            ]
        },
        {
            "filename_of_changes": "RRSIGRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7: import java.util.Date;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Resource Record Signature - An RRSIG provides the digital signature of an RRset, so that the data",
                "// Line 11:  * can be authenticated by a DNSSEC-capable resolver. The signature is generated by a key contained",
                "// Line 12:  * in a DNSKEY Record.",
                "// Line 13:  *",
                "// Line 14:  * @see RRset",
                "// Line 15:  * @see DNSSEC",
                "// Line 16:  * @see KEYRecord",
                "// vulnerable line: 17: * @see <a href=\"https://tools.ietf.org/html/rfc4034\">RFC 4034: Resource Records for the DNS",
                "// vulnerable line: 18: *     Security Extensions</a>",
                "// Line 19:  * @author Brian Wellington",
                "// Line 20:  */",
                "// Line 21: public class RRSIGRecord extends SIGBase {",
                "// Line 22:   RRSIGRecord() {}",
                "// Line 23: ",
                "// Line 24:   /**",
                "// Line 25:    * Creates an RRSIG Record from the given data",
                "// Line 26:    *",
                "// Line 27:    * @param covered The RRset type covered by this signature",
                "// Line 28:    * @param alg The cryptographic algorithm of the key that generated the signature"
            ]
        },
        {
            "filename_of_changes": "RTRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Route Through Record - lists a route preference and intermediate host.",
                "// Line 8:  *",
                "// Line 9:  * @author Brian Wellington",
                "// vulnerable line: 10: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 11: *     Specification</a>",
                "// Line 12:  */",
                "// Line 13: public class RTRecord extends U16NameBase {",
                "// Line 14:   RTRecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates an RT Record from the given data",
                "// Line 18:    *",
                "// Line 19:    * @param preference The preference of the route. Smaller numbers indicate more preferred routes.",
                "// Line 20:    * @param intermediateHost The domain name of the host to use as a router.",
                "// Line 21:    */"
            ]
        },
        {
            "filename_of_changes": "ResolveExample.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 14: import org.xbill.DNS.Resolver;",
                "// Line 15: import org.xbill.DNS.Section;",
                "// Line 16: import org.xbill.DNS.SimpleResolver;",
                "// Line 17: import org.xbill.DNS.TXTRecord;",
                "// Line 18: import org.xbill.DNS.Type;",
                "// Line 19: ",
                "// Line 20: class ResolveExample {",
                "// Line 21:   static String ROOT =",
                "// Line 22:       \". IN DS 20326 8 2 E06D44B80B8F1D39A95C0B0D7C65D08458E880409BBC683457104237C7F8EC8D\";",
                "// Line 23: ",
                "// vulnerable line: 24: static void main(String[] args) throws Exception {",
                "// Line 25:     // Send two sample queries using a standard DNSJAVA resolver",
                "// Line 26:     SimpleResolver sr = new SimpleResolver(\"8.8.8.8\");",
                "// Line 27:     System.out.println(\"Standard resolver:\");",
                "// Line 28:     sendAndPrint(sr, \"www.dnssec-failed.org.\");",
                "// Line 29:     sendAndPrint(sr, \"www.isc.org.\");",
                "// Line 30: ",
                "// Line 31:     // Send the same queries using the validating resolver with the",
                "// Line 32:     // trust anchor of the root zone",
                "// vulnerable line: 33: // http://data.iana.org/root-anchors/root-anchors.xml",
                "// Line 34:     ValidatingResolver vr = new ValidatingResolver(sr);",
                "// Line 35:     vr.loadTrustAnchors(new ByteArrayInputStream(ROOT.getBytes(\"ASCII\")));",
                "// Line 36:     vr.loadTrustAnchors(new ByteArrayInputStream(ROOT.getBytes(StandardCharsets.US_ASCII)));",
                "// Line 37:     System.out.println(\"",
                "// Line 38: ",
                "// Line 39: Validating resolver:\");",
                "// Line 40:     sendAndPrint(vr, \"www.dnssec-failed.org.\");",
                "// Line 41:     sendAndPrint(vr, \"www.isc.org.\");",
                "// Line 42:   }",
                "// Line 43: "
            ]
        },
        {
            "filename_of_changes": "SIGRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 6: import java.time.Instant;",
                "// Line 7: import java.util.Date;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Signature - A SIG provides the digital signature of an RRset, so that the data can be",
                "// Line 11:  * authenticated by a DNSSEC-capable resolver. The signature is usually generated by a key contained",
                "// Line 12:  * in a KEYRecord",
                "// Line 13:  *",
                "// Line 14:  * @see RRset",
                "// Line 15:  * @see DNSSEC",
                "// vulnerable line: 16: * @see KEYRecord <a href=\"https://tools.ietf.org/html/rfc2535\">RFC 2535: Domain Name System",
                "// vulnerable line: 17: *     Security Extensions</a>",
                "// Line 18:  * @author Brian Wellington",
                "// Line 19:  */",
                "// Line 20: public class SIGRecord extends SIGBase {",
                "// Line 21:   SIGRecord() {}",
                "// Line 22: ",
                "// Line 23:   /**",
                "// Line 24:    * Creates an SIG Record from the given data",
                "// Line 25:    *",
                "// Line 26:    * @param covered The RRset type covered by this signature",
                "// Line 27:    * @param alg The cryptographic algorithm of the key that generated the signature"
            ]
        },
        {
            "filename_of_changes": "SMIMEARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * S/MIME cert association",
                "// Line 8:  *",
                "// vulnerable line: 9: * @see <a href=\"https://tools.ietf.org/html/rfc8162\">RFC 8162: Using Secure DNS to Associate",
                "// vulnerable line: 10: *     Certificates with Domain Names for S/MIME</a>",
                "// Line 11:  * @author Brian Wellington",
                "// Line 12:  */",
                "// Line 13: public class SMIMEARecord extends TLSARecord {",
                "// Line 14:   SMIMEARecord() {}",
                "// Line 15: ",
                "// Line 16:   /**",
                "// Line 17:    * Creates an SMIMEA Record from the given data",
                "// Line 18:    *",
                "// Line 19:    * @param certificateUsage The provided association that will be used to match the certificate",
                "// Line 20:    *     presented in the S/MIME handshake."
            ]
        },
        {
            "filename_of_changes": "SOARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Start of Authority - describes properties of a zone.",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 13: *     Specification</a>",
                "// Line 14:  */",
                "// Line 15: public class SOARecord extends Record {",
                "// Line 16:   private Name host, admin;",
                "// Line 17:   private long serial, refresh, retry, expire, minimum;",
                "// Line 18: ",
                "// Line 19:   SOARecord() {}",
                "// Line 20: ",
                "// Line 21:   /**",
                "// Line 22:    * Creates an SOA Record from the given data",
                "// Line 23:    *"
            ]
        },
        {
            "filename_of_changes": "SPFRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.util.List;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Sender Policy Framework (discontinued in RFC 7208)",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc7208\">RFC 7208: Sender Policy Framework (SPF) for",
                "// vulnerable line: 13: *     Authorizing Use of Domains in Email, Version 1</a>",
                "// Line 14:  */",
                "// Line 15: public class SPFRecord extends TXTBase {",
                "// Line 16:   SPFRecord() {}",
                "// Line 17: ",
                "// Line 18:   /**",
                "// Line 19:    * Creates a SPF Record from the given data",
                "// Line 20:    *",
                "// Line 21:    * @param strings The text strings",
                "// Line 22:    * @throws IllegalArgumentException One of the strings has invalid escapes",
                "// Line 23:    */"
            ]
        },
        {
            "filename_of_changes": "SRVRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Server Selection Record - finds hosts running services in a domain. An SRV record will normally",
                "// Line 10:  * be named _&lt;service&gt;._&lt;protocol&gt;.domain - examples would be _sips._tcp.example.org",
                "// Line 11:  * (for the secure SIP protocol) and _http._tcp.example.com (if HTTP used SRV records)",
                "// Line 12:  *",
                "// Line 13:  * @author Brian Wellington",
                "// vulnerable line: 14: * @see <a href=\"https://tools.ietf.org/html/rfc2782\">RFC 2782: A DNS RR for specifying the location",
                "// vulnerable line: 15: *     of services (DNS SRV)</a>",
                "// Line 16:  */",
                "// Line 17: public class SRVRecord extends Record {",
                "// Line 18:   private int priority, weight, port;",
                "// Line 19:   private Name target;",
                "// Line 20: ",
                "// Line 21:   SRVRecord() {}",
                "// Line 22: ",
                "// Line 23:   /**",
                "// Line 24:    * Creates an SRV Record from the given data",
                "// Line 25:    *"
            ]
        },
        {
            "filename_of_changes": "SSHFPRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import org.xbill.DNS.utils.base16;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * SSH Fingerprint - stores the fingerprint of an SSH host key.",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc4255\">RFC 4255: Using DNS to Securely Publish Secure",
                "// vulnerable line: 14: *     Shell (SSH) Key Fingerprints</a>",
                "// Line 15:  */",
                "// Line 16: public class SSHFPRecord extends Record {",
                "// Line 17:   public static class Algorithm {",
                "// Line 18:     private Algorithm() {}",
                "// Line 19: ",
                "// Line 20:     public static final int RSA = 1;",
                "// Line 21:     public static final int DSS = 2;",
                "// Line 22:   }",
                "// Line 23: ",
                "// Line 24:   public static class Digest {"
            ]
        },
        {
            "filename_of_changes": "SVCBBase.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 13: import java.util.Map;",
                "// Line 14: import java.util.Set;",
                "// Line 15: import java.util.TreeMap;",
                "// Line 16: import java.util.function.Supplier;",
                "// Line 17: import java.util.stream.Collectors;",
                "// Line 18: import org.xbill.DNS.utils.base64;",
                "// Line 19: ",
                "// Line 20: /**",
                "// Line 21:  * Implements common functionality for SVCB and HTTPS records",
                "// Line 22:  *",
                "// vulnerable line: 23: * @see <a",
                "// vulnerable line: 24: *     href=\"https://tools.ietf.org/html/draft-ietf-dnsop-svcb-https-06\">draft-ietf-dnsop-svcb-https</a>",
                "// Line 25:  * @since 3.3",
                "// Line 26:  */",
                "// Line 27: public abstract class SVCBBase extends Record {",
                "// Line 28:   protected int svcPriority;",
                "// Line 29:   protected Name targetName;",
                "// Line 30:   protected final Map<Integer, ParameterBase> svcParams;",
                "// Line 31: ",
                "// Line 32:   public static final int MANDATORY = 0;",
                "// Line 33:   public static final int ALPN = 1;",
                "// Line 34:   public static final int NO_DEFAULT_ALPN = 2;"
            ]
        },
        {
            "filename_of_changes": "SVCBRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.util.List;",
                "// Line 5: ",
                "// Line 6: /**",
                "// Line 7:  * Service Location and Parameter Binding Record",
                "// Line 8:  *",
                "// vulnerable line: 9: * @see <a",
                "// vulnerable line: 10: *     href=\"https://tools.ietf.org/html/draft-ietf-dnsop-svcb-https-06\">draft-ietf-dnsop-svcb-https</a>",
                "// Line 11:  * @since 3.3",
                "// Line 12:  */",
                "// Line 13: public class SVCBRecord extends SVCBBase {",
                "// Line 14:   SVCBRecord() {}",
                "// Line 15: ",
                "// Line 16:   public SVCBRecord(",
                "// Line 17:       Name name, int dclass, long ttl, int priority, Name domain, List<ParameterBase> params) {",
                "// Line 18:     super(name, Type.SVCB, dclass, ttl, priority, domain, params);",
                "// Line 19:   }",
                "// Line 20: }"
            ]
        },
        {
            "filename_of_changes": "TKEYRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 6: import java.io.IOException;",
                "// Line 7: import java.time.Instant;",
                "// Line 8: import java.util.Date;",
                "// Line 9: import org.xbill.DNS.utils.base64;",
                "// Line 10: ",
                "// Line 11: /**",
                "// Line 12:  * Transaction Key - used to compute and/or securely transport a shared secret to be used with TSIG.",
                "// Line 13:  *",
                "// Line 14:  * @see TSIG",
                "// Line 15:  * @author Brian Wellington",
                "// vulnerable line: 16: * @see <a href=\"https://tools.ietf.org/html/rfc2930\">RFC 2930: Secret Key Establishment for DNS",
                "// vulnerable line: 17: *     (TKEY RR)</a>",
                "// Line 18:  */",
                "// Line 19: public class TKEYRecord extends Record {",
                "// Line 20:   private Name alg;",
                "// Line 21:   private Instant timeInception;",
                "// Line 22:   private Instant timeExpire;",
                "// Line 23:   private int mode, error;",
                "// Line 24:   private byte[] key;",
                "// Line 25:   private byte[] other;",
                "// Line 26: ",
                "// Line 27:   /** The key is assigned by the server (unimplemented) */"
            ]
        },
        {
            "filename_of_changes": "TLSARecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "22",
            "number_of_lines_deleted_vulnerable_to_cve": "6",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: import org.xbill.DNS.utils.base16;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Transport Layer Security Authentication",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc6698\">RFC 6698: The DNS-Based Authentication of",
                "// vulnerable line: 14: *     Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA</a>",
                "// Line 15:  */",
                "// Line 16: public class TLSARecord extends Record {",
                "// Line 17:   public static class CertificateUsage {",
                "// Line 18:     private CertificateUsage() {}",
                "// Line 19: ",
                "// Line 20:     public static final int CA_CONSTRAINT = 0;",
                "// Line 21:     public static final int SERVICE_CERTIFICATE_CONSTRAINT = 1;",
                "// Line 22:     public static final int TRUST_ANCHOR_ASSERTION = 2;",
                "// Line 23:     public static final int DOMAIN_ISSUED_CERTIFICATE = 3;",
                "// Line 24:   }",
                "// Line 25: ",
                "// Line 26:   public static class Selector {",
                "// Line 27:     private Selector() {}",
                "// Line 28: ",
                "// vulnerable line: 29: /** Full certificate; the Certificate binary structure defined in [RFC5280] */",
                "// Line 30:     public static final int FULL_CERTIFICATE = 0;",
                "// Line 31: ",
                "// vulnerable line: 32: /** SubjectPublicKeyInfo; DER-encoded binary structure defined in [RFC5280] */",
                "// Line 33:     public static final int SUBJECT_PUBLIC_KEY_INFO = 1;",
                "// Line 34:   }",
                "// Line 35: ",
                "// Line 36:   public static class MatchingType {",
                "// Line 37:     private MatchingType() {}",
                "// Line 38: ",
                "// Line 39:     /** Exact match on selected content */",
                "// Line 40:     public static final int EXACT = 0;",
                "// Line 41: ",
                "// vulnerable line: 42: /** SHA-256 hash of selected content [RFC6234] */",
                "// Line 43:     public static final int SHA256 = 1;",
                "// Line 44: ",
                "// vulnerable line: 45: /** SHA-512 hash of selected content [RFC6234] */",
                "// Line 46:     public static final int SHA512 = 2;",
                "// Line 47:   }",
                "// Line 48: ",
                "// Line 49:   private int certificateUsage;",
                "// Line 50:   private int selector;",
                "// Line 51:   private int matchingType;",
                "// Line 52:   private byte[] certificateAssociationData;",
                "// Line 53: ",
                "// Line 54:   TLSARecord() {}",
                "// Line 55: "
            ]
        },
        {
            "filename_of_changes": "TSIG.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 658:     byte[] tsigVariables = getTsigVariables(fullSignature, tsig);",
                "// Line 659:     hmac.update(tsigVariables);",
                "// Line 660: ",
                "// Line 661:     byte[] signature = tsig.getSignature();",
                "// Line 662:     int badsig = verifySignature(hmac, signature);",
                "// Line 663:     if (badsig != Rcode.NOERROR) {",
                "// Line 664:       return badsig;",
                "// Line 665:     }",
                "// Line 666: ",
                "// Line 667:     // validate time after the signature, as per",
                "// vulnerable line: 668: // https://www.rfc-editor.org/rfc/rfc8945.html#section-5.4",
                "// Line 669:     int badtime = verifyTime(tsig);",
                "// Line 670:     if (badtime != Rcode.NOERROR) {",
                "// Line 671:       return badtime;",
                "// Line 672:     }",
                "// Line 673: ",
                "// Line 674:     m.tsigState = Message.TSIG_VERIFIED;",
                "// Line 675:     return Rcode.NOERROR;",
                "// Line 676:   }",
                "// Line 677: ",
                "// Line 678:   private static byte[] getTsigVariables(boolean fullSignature, TSIGRecord tsig) {",
                "// Line 797:     private final Mac sharedHmac;",
                "// Line 798:     private final int signEveryNthMessage;",
                "// Line 799: ",
                "// Line 800:     private int numGenerated;",
                "// Line 801:     private TSIGRecord lastTsigRecord;",
                "// Line 802: ",
                "// Line 803:     /**",
                "// Line 804:      * Creates an instance to sign multiple message for use in a stream.",
                "// Line 805:      *",
                "// Line 806:      * <p>This class creates a {@link TSIGRecord} on every message to conform with <a",
                "// vulnerable line: 807: * href=\"https://www.rfc-editor.org/rfc/rfc8945.html#section-5.3.1\">RFC 8945, 5.3.1</a>.",
                "// Line 808:      *",
                "// Line 809:      * @param key The TSIG key used to create the signature records.",
                "// Line 810:      * @param queryTsig The initial TSIG records, e.g. from a query to a server.",
                "// Line 811:      */",
                "// Line 812:     public StreamGenerator(TSIG key, TSIGRecord queryTsig) {",
                "// Line 813:       // The TSIG MUST be included on all DNS messages in the response.",
                "// Line 814:       this(key, queryTsig, 1);",
                "// Line 815:     }",
                "// Line 816: ",
                "// Line 817:     /**"
            ]
        },
        {
            "filename_of_changes": "TSIGRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 8: import java.time.Instant;",
                "// Line 9: import java.util.Date;",
                "// Line 10: import org.xbill.DNS.utils.base64;",
                "// Line 11: ",
                "// Line 12: /**",
                "// Line 13:  * Transaction Signature - this record is automatically generated by the resolver. TSIG records",
                "// Line 14:  * provide transaction security between the sender and receiver of a message, using a shared key.",
                "// Line 15:  *",
                "// Line 16:  * @see Resolver",
                "// Line 17:  * @see TSIG",
                "// vulnerable line: 18: * @see <a href=\"https://tools.ietf.org/html/rfc2845\">RFC 2845: Secret Key Transaction",
                "// Line 19:  *     Authentication for DNS (TSIG)</a>",
                "// Line 20:  * @author Brian Wellington",
                "// Line 21:  */",
                "// Line 22: public class TSIGRecord extends Record {",
                "// Line 23:   private Name alg;",
                "// Line 24:   private Instant timeSigned;",
                "// Line 25:   private Duration fudge;",
                "// Line 26:   private byte[] signature;",
                "// Line 27:   private int originalID;",
                "// Line 28:   private int error;"
            ]
        },
        {
            "filename_of_changes": "TXTRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2: // Copyright (c) 1999-2004 Brian Wellington (bwelling@xbill.org)",
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.util.List;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * Text - stores text strings",
                "// Line 10:  *",
                "// Line 11:  * @author Brian Wellington",
                "// vulnerable line: 12: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 13: *     Specification</a>",
                "// Line 14:  */",
                "// Line 15: public class TXTRecord extends TXTBase {",
                "// Line 16:   TXTRecord() {}",
                "// Line 17: ",
                "// Line 18:   /**",
                "// Line 19:    * Creates a TXT Record from the given data",
                "// Line 20:    *",
                "// Line 21:    * @param strings The text strings",
                "// Line 22:    * @throws IllegalArgumentException One of the strings has invalid escapes",
                "// Line 23:    */"
            ]
        },
        {
            "filename_of_changes": "TcpKeepaliveOption.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: // SPDX-License-Identifier: BSD-3-Clause",
                "// Line 2: package org.xbill.DNS;",
                "// Line 3: ",
                "// Line 4: import java.io.IOException;",
                "// Line 5: import java.time.Duration;",
                "// Line 6: import java.util.Optional;",
                "// Line 7: import java.util.OptionalInt;",
                "// Line 8: ",
                "// Line 9: /**",
                "// vulnerable line: 10: * TCP Keepalive EDNS0 Option, as defined in https://tools.ietf.org/html/rfc7828",
                "// Line 11:  *",
                "// Line 12:  * @see OPTRecord",
                "// Line 13:  * @author Klaus Malorny",
                "// Line 14:  */",
                "// Line 15: public class TcpKeepaliveOption extends EDNSOption {",
                "// Line 16: ",
                "// Line 17:   /** the timeout */",
                "// Line 18:   private Integer timeout;",
                "// Line 19: ",
                "// Line 20:   /** upper limit of the duration (exclusive) */"
            ]
        },
        {
            "filename_of_changes": "Type.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "12",
            "number_of_lines_deleted_vulnerable_to_cve": "13",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 97:   /** {@link AAAARecord IPv6 address} */",
                "// Line 98:   public static final int AAAA = 28;",
                "// Line 99: ",
                "// Line 100:   /** {@link LOCRecord Location} */",
                "// Line 101:   public static final int LOC = 29;",
                "// Line 102: ",
                "// Line 103:   /** {@link NXTRecord Next valid name in zone} */",
                "// Line 104:   public static final int NXT = 30;",
                "// Line 105: ",
                "// Line 106:   /**",
                "// vulnerable line: 107: * Endpoint identifier",
                "// Line 108:    *",
                "// vulnerable line: 109: * @see <a href=\"https://tools.ietf.org/html/draft-ietf-nimrod-dns-00\">DNS Resource Records for",
                "// vulnerable line: 110: *     Nimrod Routing Architecture</a>",
                "// Line 111:    */",
                "// Line 112:   public static final int EID = 31;",
                "// Line 113: ",
                "// Line 114:   /**",
                "// vulnerable line: 115: * Nimrod locator",
                "// Line 116:    *",
                "// vulnerable line: 117: * @see <a href=\"https://tools.ietf.org/html/draft-ietf-nimrod-dns-00\">DNS Resource Records for",
                "// vulnerable line: 118: *     Nimrod Routing Architecture</a>",
                "// Line 119:    */",
                "// Line 120:   public static final int NIMLOC = 32;",
                "// Line 121: ",
                "// Line 122:   /** {@link SRVRecord Server selection} */",
                "// Line 123:   public static final int SRV = 33;",
                "// Line 124: ",
                "// Line 125:   /** ATM address */",
                "// Line 126:   public static final int ATMA = 34;",
                "// Line 127: ",
                "// Line 128:   /** {@link NAPTRRecord Naming authority pointer} */",
                "// Line 181: ",
                "// Line 182:   /** {@link SMIMEARecord S/MIME cert association} */",
                "// Line 183:   public static final int SMIMEA = 53;",
                "// Line 184: ",
                "// Line 185:   /** {@link HIPRecord Host Identity Protocol (HIP)} */",
                "// Line 186:   public static final int HIP = 55;",
                "// Line 187: ",
                "// Line 188:   /**",
                "// Line 189:    * Zone Status (ZS).",
                "// Line 190:    *",
                "// vulnerable line: 191: * @see <a href=\"https://tools.ietf.org/html/draft-reid-dnsext-zs-01\">draft-reid-dnsext-zs-01</a>",
                "// Line 192:    */",
                "// Line 193:   public static final int NINFO = 56;",
                "// Line 194: ",
                "// Line 195:   /**",
                "// Line 196:    * RKEY DNS Resource Record, used for encryption of NAPTR records.",
                "// Line 197:    *",
                "// vulnerable line: 198: * @see <a",
                "// vulnerable line: 199: *     href=\"https://tools.ietf.org/html/draft-reid-dnsext-rkey-00\">draft-reid-dnsext-rkey-00</a>",
                "// Line 200:    */",
                "// Line 201:   public static final int RKEY = 57;",
                "// Line 202: ",
                "// Line 203:   /**",
                "// Line 204:    * DNSSEC Trust Anchor History Service.",
                "// Line 205:    *",
                "// vulnerable line: 206: * @see <a",
                "// vulnerable line: 207: *     href=\"https://tools.ietf.org/html/draft-wijngaards-dnsop-trust-history-02\">draft-wijngaards-dnsop-trust-history-02</a>",
                "// Line 208:    */",
                "// Line 209:   public static final int TALINK = 58;",
                "// Line 210: ",
                "// Line 211:   /** {@link CDSRecord Child Delegation Signer} */",
                "// Line 212:   public static final int CDS = 59;",
                "// Line 213: ",
                "// Line 214:   /** {@link CDNSKEYRecord Child DNSKEY} * */",
                "// Line 215:   public static final int CDNSKEY = 60;",
                "// Line 216: ",
                "// Line 217:   /** {@link OPENPGPKEYRecord OpenPGP Key} */",
                "// Line 219: ",
                "// Line 220:   /** Child-to-Parent Synchronization. */",
                "// Line 221:   public static final int CSYNC = 62;",
                "// Line 222: ",
                "// Line 223:   /** Message Digest for DNS Zones. */",
                "// Line 224:   public static final int ZONEMD = 63;",
                "// Line 225: ",
                "// Line 226:   /**",
                "// Line 227:    * Service Location and Parameter Binding",
                "// Line 228:    *",
                "// vulnerable line: 229: * @see <a",
                "// vulnerable line: 230: *     href=\"https://tools.ietf.org/html/draft-ietf-dnsop-svcb-https-06\">draft-ietf-dnsop-svcb-https</a>",
                "// Line 231:    */",
                "// Line 232:   public static final int SVCB = 64;",
                "// Line 233: ",
                "// Line 234:   /**",
                "// Line 235:    * HTTPS Service Location and Parameter Binding",
                "// Line 236:    *",
                "// vulnerable line: 237: * @see <a",
                "// vulnerable line: 238: *     href=\"https://tools.ietf.org/html/draft-ietf-dnsop-svcb-https-06\">draft-ietf-dnsop-svcb-https</a>",
                "// Line 239:    */",
                "// Line 240:   public static final int HTTPS = 65;",
                "// Line 241: ",
                "// Line 242:   /** {@link SPFRecord Sender Policy Framework} */",
                "// Line 243:   public static final int SPF = 99;",
                "// Line 244: ",
                "// Line 245:   /** IANA-Reserved */",
                "// Line 246:   public static final int UINFO = 100;",
                "// Line 247: ",
                "// Line 248:   /** IANA-Reserved */"
            ]
        },
        {
            "filename_of_changes": "URIRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: // based on SRVRecord.java Copyright (c) 1999-2004 Brian Wellington",
                "// Line 4: ",
                "// Line 5: package org.xbill.DNS;",
                "// Line 6: ",
                "// Line 7: import java.io.IOException;",
                "// Line 8: ",
                "// Line 9: /**",
                "// Line 10:  * Uniform Resource Identifier (URI) DNS Resource Record",
                "// Line 11:  *",
                "// Line 12:  * @author Anthony Kirby",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc7553\">RFC 7553: The Uniform Resource Identifier",
                "// vulnerable line: 14: *     (URI) DNS Resource Record</a>",
                "// Line 15:  */",
                "// Line 16: public class URIRecord extends Record {",
                "// Line 17:   private int priority, weight;",
                "// Line 18:   private byte[] target;",
                "// Line 19: ",
                "// Line 20:   URIRecord() {",
                "// Line 21:     target = new byte[] {};",
                "// Line 22:   }",
                "// Line 23: ",
                "// Line 24:   /**"
            ]
        },
        {
            "filename_of_changes": "WKSRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7: import java.net.InetAddress;",
                "// Line 8: import java.net.UnknownHostException;",
                "// Line 9: import java.util.ArrayList;",
                "// Line 10: import java.util.Arrays;",
                "// Line 11: import java.util.List;",
                "// Line 12: ",
                "// Line 13: /**",
                "// Line 14:  * Well Known Services - Lists services offered by this host.",
                "// Line 15:  *",
                "// Line 16:  * @author Brian Wellington",
                "// vulnerable line: 17: * @see <a href=\"https://tools.ietf.org/html/rfc1035\">RFC 1035: Domain Names - Implementation and",
                "// vulnerable line: 18: *     Specification</a>",
                "// Line 19:  */",
                "// Line 20: public class WKSRecord extends Record {",
                "// Line 21:   /**",
                "// Line 22:    * IP protocol identifiers. This is basically copied out of RFC 1010.",
                "// Line 23:    *",
                "// vulnerable line: 24: * @see <a href=\"https://tools.ietf.org/html/rfc1010\">RFC 1010: Assigned Numbers</a>",
                "// Line 25:    */",
                "// Line 26:   public static class Protocol {",
                "// Line 27: ",
                "// Line 28:     private Protocol() {}",
                "// Line 29: ",
                "// Line 30:     /** Internet Control Message */",
                "// Line 31:     public static final int ICMP = 1;",
                "// Line 32: ",
                "// Line 33:     /** Internet Group Management */",
                "// Line 34:     public static final int IGMP = 2;"
            ]
        },
        {
            "filename_of_changes": "X25Record.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: ",
                "// Line 4: package org.xbill.DNS;",
                "// Line 5: ",
                "// Line 6: import java.io.IOException;",
                "// Line 7: ",
                "// Line 8: /**",
                "// Line 9:  * X25 - identifies the PSDN (Public Switched Data Network) address in the X.121 numbering plan",
                "// Line 10:  * associated with a name.",
                "// Line 11:  *",
                "// Line 12:  * @author Brian Wellington",
                "// vulnerable line: 13: * @see <a href=\"https://tools.ietf.org/html/rfc1183\">RFC 1183: New DNS RR Definitions</a>",
                "// Line 14:  */",
                "// Line 15: public class X25Record extends Record {",
                "// Line 16:   private byte[] address;",
                "// Line 17: ",
                "// Line 18:   X25Record() {}",
                "// Line 19: ",
                "// Line 20:   private static byte[] checkAndConvertAddress(String address) {",
                "// Line 21:     int length = address.length();",
                "// Line 22:     byte[] out = new byte[length];",
                "// Line 23:     for (int i = 0; i < length; i++) {"
            ]
        },
        {
            "filename_of_changes": "ZoneMDRecord.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 5: import java.util.HashMap;",
                "// Line 6: import java.util.Map;",
                "// Line 7: import lombok.Getter;",
                "// Line 8: import lombok.experimental.UtilityClass;",
                "// Line 9: import org.xbill.DNS.utils.base16;",
                "// Line 10: ",
                "// Line 11: /**",
                "// Line 12:  * ZONEMD Resource record.",
                "// Line 13:  *",
                "// Line 14:  * @since 3.6",
                "// vulnerable line: 15: * @see <a href=\"https://www.rfc-editor.org/rfc/rfc8976.html\">RFC8976</a>",
                "// Line 16:  */",
                "// Line 17: public class ZoneMDRecord extends Record {",
                "// Line 18:   /**",
                "// Line 19:    * ZONEMD Schemes.",
                "// Line 20:    *",
                "// Line 21:    * @see <a",
                "// Line 22:    *     href=\"https://www.iana.org/assignments/dns-parameters/dns-parameters.xml#zonemd-schemes\">IANA",
                "// Line 23:    *     registry</a>",
                "// Line 24:    */",
                "// Line 25:   @UtilityClass",
                "// Line 110:      * @return The length, in bytes, or -1 for an unknown hash algorithm.",
                "// Line 111:      */",
                "// Line 112:     public static int hashLength(int hashAlgorithm) {",
                "// Line 113:       Integer len = hashLengths.get(hashAlgorithm);",
                "// Line 114:       return len == null ? -1 : len;",
                "// Line 115:     }",
                "// Line 116:   }",
                "// Line 117: ",
                "// Line 118:   /**",
                "// Line 119:    * A 32-bit unsigned integer in network byte order. It is the serial number from the zone's SOA",
                "// vulnerable line: 120: * record (<a href=\"https://www.rfc-editor.org/rfc/rfc1035.html\">RFC1035, Section 3.3.13]</a>) for",
                "// vulnerable line: 121: * which the zone digest was generated.",
                "// Line 122:    */",
                "// Line 123:   @Getter private long serial;",
                "// Line 124: ",
                "// Line 125:   /**",
                "// Line 126:    * An 8-bit unsigned integer that identifies the methods by which data is collated and presented",
                "// Line 127:    * as input to the hashing function.",
                "// Line 128:    *",
                "// Line 129:    * @see Scheme",
                "// Line 130:    */",
                "// Line 131:   @Getter private int scheme;"
            ]
        }
    ]
}