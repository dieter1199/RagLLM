{
    "cve_id": "CVE-2024-32877",
    "cve_description": "Yii 2 is a PHP application framework. During internal penetration testing of a product based on Yii2, users discovered a Cross-site Scripting (XSS) vulnerability within the framework itself. This issue is relevant for the latest version of Yii2 (2.0.49.3). This issue lies in the mechanism for displaying function argument values in the stack trace. The vulnerability manifests when an argument's value exceeds 32 characters. For convenience, argument values exceeding this limit are truncated and displayed with an added \"...\". The full argument value becomes visible when hovering over it with the mouse, as it is displayed in the title attribute of a span tag. However, the use of a double quote (\") allows an attacker to break out of the title attribute's value context and inject their own attributes into the span tag, including malicious JavaScript code through event handlers such as onmousemove. This vulnerability allows an attacker to execute arbitrary JavaScript code in the security context of the victim's site via a specially crafted link. This could lead to the theft of cookies (including httpOnly cookies, which are accessible on the page), content substitution, or complete takeover of user accounts. This issue has been addressed in version 2.0.50. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-05-30T20:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-qg5r-95m4-mjgj\n\n* Hotfix: Reflected XSS in Debug mode\n\n* Added entry for the security issue GHSA-qg5r-95m4-mjgj to the CHANGELOG\n\n* Update CHANGELOG.md\n\n* Update CHANGELOG.md\n\n---------\n\nCo-authored-by: Alexander Makarov <sam@rmcreative.ru>",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ErrorHandler.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 175:         return $array;",
                "// Line 176:     }",
                "// Line 177: ",
                "// Line 178:     /**",
                "// Line 179:      * Converts special characters to HTML entities.",
                "// Line 180:      * @param string $text to encode.",
                "// Line 181:      * @return string encoded original text.",
                "// Line 182:      */",
                "// Line 183:     public function htmlEncode($text)",
                "// Line 184:     {",
                "// vulnerable line: 185: return htmlspecialchars($text, ENT_NOQUOTES | ENT_SUBSTITUTE | ENT_HTML5, 'UTF-8');",
                "// Line 186:     }",
                "// Line 187: ",
                "// Line 188:     /**",
                "// Line 189:      * Adds informational links to the given PHP type/class.",
                "// Line 190:      * @param string $code type/class name to be linkified.",
                "// Line 191:      * @return string linkified with HTML type/class name.",
                "// Line 192:      */",
                "// Line 193:     public function addTypeLinks($code)",
                "// Line 194:     {",
                "// Line 195:         if (preg_match('/(.*?)::([^(]+)/', $code, $matches)) {"
            ]
        }
    ]
}