{
    "cve_id": "CVE-2024-1454",
    "cve_description": "The use-after-free vulnerability was found in the AuthentIC driver in OpenSC packages, occuring in the card enrolment process using pkcs15-init when a user or administrator enrols or modifies cards. An attacker must have physical access to the computer system and requires a crafted USB device or smart card to present the system with specially crafted responses to the APDUs, which are considered high complexity and low severity. This manipulation can allow for compromised card management operations during enrolment.",
    "cve_publish_date": "2024-02-12T23:15Z",
    "cwe_id": "CWE-416",
    "cwe_name": "Use After Free",
    "cwe_description": "The product reuses or references memory after it has been freed. At some point afterward, the memory may be allocated again and saved in another pointer, while the original pointer references a location somewhere within the new allocation. Any operations using the original pointer are no longer valid because the memory \"belongs\" to the code that operates on the new pointer.",
    "commit_message": "authentic: Avoid use after free\n\nThanks oss-fuzz\n\nhttps://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64898",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "pkcs15-authentic.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 861:         struct sc_pkcs15_tokeninfo *tinfo)",
                "// Line 862: {",
                "// Line 863:     struct sc_context *ctx = p15card->card->ctx;",
                "// Line 864:     struct sc_file *file = NULL;",
                "// Line 865:     struct sc_path path;",
                "// Line 866:     unsigned char buffer[8];",
                "// Line 867:     int rv,len;",
                "// Line 868: ",
                "// Line 869:     sc_format_path(AUTHENTIC_CACHE_TIMESTAMP_PATH, &path);",
                "// Line 870:     rv = sc_select_file(p15card->card, &path, &file);",
                "// vulnerable line: 871: if (!rv) {",
                "// Line 872:         rv = sc_get_challenge(p15card->card, buffer, sizeof(buffer));",
                "// vulnerable line: 873: if (!rv) {",
                "// Line 874:             sc_file_free(file);",
                "// Line 875:             LOG_TEST_RET(ctx, rv, \"Get challenge error\");",
                "// Line 876:         }",
                "// Line 877: ",
                "// Line 878:         len = file->size > sizeof(buffer) ? sizeof(buffer) : file->size;",
                "// Line 879:         rv = sc_update_binary(p15card->card, 0, buffer, len, 0);",
                "// Line 880:         sc_file_free(file);",
                "// Line 881:         LOG_TEST_RET(ctx, rv, \"Update binary error\");",
                "// Line 882:     }",
                "// Line 883: "
            ]
        }
    ]
}