{
    "cve_id": "CVE-2024-26150",
    "cve_description": "`@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10.",
    "cve_publish_date": "2024-02-23T16:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: resolve the actual paths for base and target\n\nSigned-off-by: blam <ben@blam.sh>",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "paths.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "13",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 57:  * paths from user input, as it otherwise opens up for vulnerabilities.",
                "// Line 58:  *",
                "// Line 59:  * @public",
                "// Line 60:  * @param base - The base directory to resolve the path from.",
                "// Line 61:  * @param path - The target path, relative or absolute",
                "// Line 62:  * @returns A path that is guaranteed to point to or within the base path.",
                "// Line 63:  */",
                "// Line 64: export function resolveSafeChildPath(base: string, path: string): string {",
                "// Line 65:   const targetPath = resolvePath(base, path);",
                "// Line 66: ",
                "// vulnerable line: 67: if (!isChildPath(base, targetPath)) {",
                "// Line 68:     throw new NotAllowedError(",
                "// Line 69:       'Relative path is not allowed to refer to a directory outside its parent',",
                "// Line 70:     );",
                "// Line 71:   }",
                "// Line 72: ",
                "// Line 73:   return targetPath;",
                "// Line 74: }",
                "// Line 75: ",
                "// Line 76: // Re-export isChildPath so that backend packages don't need to depend on cli-common",
                "// Line 77: export { isChildPath };"
            ]
        }
    ]
}