{
    "cve_id": "CVE-2024-24479",
    "cve_description": "A Buffer Overflow in Wireshark before 4.2.0 allows a remote attacker to cause a denial of service via the wsutil/to_str.c, and format_fractional_part_nsecs components. NOTE: this is disputed by the vendor because neither release 4.2.0 nor any other release was affected.",
    "cve_publish_date": "2024-02-21T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Various enhancements and fixes to format_fractional_part_nsecs().\n\nHave format_fractional_part_nsecs() return the number of bytes\nformatted.  This matches what snprintf() and strlcpy() do, for the\nbenefit of routines constructing a string in a fixed-length buffer with\nmultiple calls, one of which is format_fractional_part_nsecs().\n\nHave format_fractional_part_nsecs() check for a count of nanoseconds\ngreatre than or equal to 1 billion, and report that specially.\n\nFix places wher it used the bufer pointer and size of the buffer, rather\nthan the current position in the buffer and the remaining space in the\nbuffer, to append to the buffer and make sure doing so doesn't overrun\nthe buffer.\n\nRename some variable names (rename buf_remaining to just remaining,\nrename num_chars to num_bytes as it counts bytes).\n\nFix some comments.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "to_str.h",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 290: ",
                "// Line 291: /* Returns length of the result. */",
                "// Line 292: WS_DLL_PUBLIC void ip6_to_str_buf(const ws_in6_addr *ad, gchar *buf, size_t buf_size);",
                "// Line 293: ",
                "// Line 294: WS_DLL_PUBLIC char *ip6_to_str(wmem_allocator_t *scope, const ws_in6_addr *ad);",
                "// Line 295: ",
                "// Line 296: WS_DLL_PUBLIC gchar *ipxnet_to_str_punct(wmem_allocator_t *scope, const guint32 ad, const char punct);",
                "// Line 297: ",
                "// Line 298: WS_DLL_PUBLIC gchar *eui64_to_str(wmem_allocator_t *scope, const guint64 ad);",
                "// Line 299: ",
                "// vulnerable line: 300: WS_DLL_PUBLIC void format_fractional_part_nsecs(gchar *, size_t, guint32, const char *, int);",
                "// Line 301: ",
                "// Line 302: WS_DLL_PUBLIC void display_epoch_time(gchar *, size_t, const nstime_t *, int);",
                "// Line 303: ",
                "// Line 304: WS_DLL_PUBLIC void display_signed_time(gchar *, size_t, const nstime_t *, int);",
                "// Line 305: ",
                "// Line 306: WS_DLL_PUBLIC void format_nstime_as_iso8601(gchar *, size_t, const nstime_t *, char *, gboolean, int);",
                "// Line 307: ",
                "// Line 308: #ifdef __cplusplus",
                "// Line 309: }",
                "// Line 310: #endif /* __cplusplus */"
            ]
        }
    ]
}