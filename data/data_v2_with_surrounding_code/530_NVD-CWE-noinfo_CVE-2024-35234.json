{
    "cve_id": "CVE-2024-35234",
    "cve_description": "Discourse is an open-source discussion platform. Prior to version 3.2.3 on the `stable` branch and version 3.3.0.beta3 on the `tests-passed` branch, an attacker can execute arbitrary JavaScript on usersâ€™ browsers by posting a specific URL containing maliciously crafted meta tags. This issue only affects sites with Content Security Polic (CSP) disabled. The problem has been patched in version 3.2.3 on the `stable` branch and version 3.3.0.beta3 on the `tests-passed` branch. As a workaround, ensure CSP is enabled on the forum.",
    "cve_publish_date": "2024-07-03T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "SECURITY: Fix Stored-dom XSS via Facebook Oneboxes",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "facebook_media_onebox.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: # frozen_string_literal: true",
                "// Line 2: ",
                "// Line 3: module Onebox",
                "// Line 4:   module Engine",
                "// Line 5:     class FacebookMediaOnebox",
                "// Line 6:       include Engine",
                "// Line 7:       include StandardEmbed",
                "// Line 8: ",
                "// vulnerable line: 9: matches_regexp(%r{^https?://.*\\.facebook\\.com/(\\w+)/(videos|\\?).*})",
                "// Line 10:       always_https",
                "// Line 11:       requires_iframe_origins \"https://www.facebook.com\"",
                "// Line 12: ",
                "// Line 13:       def to_html",
                "// Line 14:         metadata = get_twitter",
                "// Line 15:         if metadata.present? && metadata[:card] == \"player\" && metadata[:player].present?",
                "// Line 16:           <<-HTML",
                "// Line 17:             <iframe",
                "// Line 18:               src=\"#{metadata[:player]}\"",
                "// Line 19:               width=\"#{metadata[:player_width]}\""
            ]
        },
        {
            "filename_of_changes": "facebook_media_onebox_spec.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "21",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}