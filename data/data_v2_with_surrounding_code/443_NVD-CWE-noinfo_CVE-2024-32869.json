{
    "cve_id": "CVE-2024-32869",
    "cve_description": "Hono is a Web application framework that provides support for any JavaScript runtime. Prior to version 4.2.7, when using serveStatic with deno, it is possible to traverse the directory where `main.ts` is located. This can result in retrieval of unexpected files. Version 4.2.7 contains a patch for the issue.",
    "cve_publish_date": "2024-04-23T21:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-3mpf-rcc7-5347",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "index.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 23:     getContent: (path: string) => any",
                "// Line 24:     pathResolve?: (path: string) => string",
                "// Line 25:   }",
                "// Line 26: ): MiddlewareHandler => {",
                "// Line 27:   return async (c, next) => {",
                "// Line 28:     // Do nothing if Response is already set",
                "// Line 29:     if (c.finalized) {",
                "// Line 30:       await next()",
                "// Line 31:       return",
                "// Line 32:     }",
                "// vulnerable line: 33: const url = new URL(c.req.url)",
                "// Line 34: ",
                "// vulnerable line: 35: let filename = options.path ?? decodeURI(url.pathname)",
                "// Line 36:     filename = options.rewriteRequestPath ? options.rewriteRequestPath(filename) : filename",
                "// Line 37:     const root = options.root",
                "// Line 38: ",
                "// Line 39:     let path = getFilePath({",
                "// Line 40:       filename,",
                "// Line 41:       root,",
                "// Line 42:       defaultDocument: DEFAULT_DOCUMENT,",
                "// Line 43:     })",
                "// Line 44: ",
                "// Line 45:     if (!path) {"
            ]
        },
        {
            "filename_of_changes": "index.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 23:     getContent: (path: string) => any",
                "// Line 24:     pathResolve?: (path: string) => string",
                "// Line 25:   }",
                "// Line 26: ): MiddlewareHandler => {",
                "// Line 27:   return async (c, next) => {",
                "// Line 28:     // Do nothing if Response is already set",
                "// Line 29:     if (c.finalized) {",
                "// Line 30:       await next()",
                "// Line 31:       return",
                "// Line 32:     }",
                "// vulnerable line: 33: const url = new URL(c.req.url)",
                "// Line 34: ",
                "// vulnerable line: 35: let filename = options.path ?? decodeURI(url.pathname)",
                "// Line 36:     filename = options.rewriteRequestPath ? options.rewriteRequestPath(filename) : filename",
                "// Line 37:     const root = options.root",
                "// Line 38: ",
                "// Line 39:     let path = getFilePath({",
                "// Line 40:       filename,",
                "// Line 41:       root,",
                "// Line 42:       defaultDocument: DEFAULT_DOCUMENT,",
                "// Line 43:     })",
                "// Line 44: ",
                "// Line 45:     if (!path) {"
            ]
        },
        {
            "filename_of_changes": "middleware.test.tsx",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}