{
    "cve_id": "CVE-2019-25159",
    "cve_description": "A vulnerability was found in mpedraza2020 Intranet del Monterroso up to 4.50.0. It has been classified as critical. This affects an unknown part of the file config/cargos.php. The manipulation of the argument dni_profe leads to sql injection. Upgrading to version 4.51.0 is able to address this issue. The identifier of the patch is 678190bee1dfd64b54a2b0e88abfd009e78adce8. It is recommended to upgrade the affected component. The identifier VDB-252717 was assigned to this vulnerability.",
    "cve_publish_date": "2024-02-04T06:15Z",
    "cwe_id": "CWE-89",
    "cwe_name": "Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')",
    "cwe_description": "The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.",
    "commit_message": "SQL Injection in $_GET['dni_profe'] - \"config/cargos.php\"\n\nFilters for SQL Injection in $_GET['dni_profe']",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "cargos.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 6: include (\"../menu.php\");",
                "// Line 7: ?>",
                "// Line 8: <div class='container-fluid'>",
                "// Line 9: ",
                "// Line 10:     <div class=\"page-header\">",
                "// Line 11:       <h2>Administraci√≥n <small> Perfiles de Profesores</small></h2>",
                "// Line 12:     </div>",
                "// Line 13: ",
                "// Line 14:     <?php",
                "// Line 15:     if ($_GET['borrar']=='1') {",
                "// vulnerable line: 16: mysqli_query($db_con, \"delete from departamentos where dni = '\".$_GET['dni_profe'].\"'\");",
                "// Line 17:         echo '<div class=\"alert alert-success\">",
                "// Line 18:                 <button type=\"button\" class=\"close\" data-dismiss=\"alert\">&times;</button>",
                "// Line 19:                 El profesor ha sido borrado de la base de datos..",
                "// Line 20:               </div>';",
                "// Line 21:     }",
                "// Line 22:     if (isset($_POST['enviar'])) {",
                "// Line 23: ",
                "// Line 24:     mysqli_query($db_con, \"update c_profes set telefono = ''\" );",
                "// Line 25:     mysqli_query($db_con, \"truncate table FTUTORES\" );",
                "// Line 26:     mysqli_query($db_con, \"truncate table cargos \" );"
            ]
        }
    ]
}