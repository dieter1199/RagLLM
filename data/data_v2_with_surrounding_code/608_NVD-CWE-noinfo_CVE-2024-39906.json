{
    "cve_id": "CVE-2024-39906",
    "cve_description": "A command injection vulnerability was found in the IndieAuth functionality of the Ruby on Rails based Haven blog web application. The affected functionality requires authentication, but an attacker can craft a link that they can pass to a logged in administrator of the blog software. This leads to the immediate execution of the provided commands when the link is accessed by the authenticated administrator. This issue may lead to Remote Code Execution (RCE) and has been addressed by commit `c52f07c`. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n",
    "cve_publish_date": "2024-07-19T20:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "add URI validation to indieauth flow",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "indie_auth_client.rb",
            "code_language": "Ruby",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 21:   end",
                "// Line 22: ",
                "// Line 23:   def initialize(client_id)",
                "// Line 24:     @client_id = client_id",
                "// Line 25:     @name = \"An unknown application\"",
                "// Line 26:     @logo = \"/warning.svg\"",
                "// Line 27:     @url = @client_id",
                "// Line 28:     @redirects = []",
                "// Line 29:     if should_fetch?",
                "// Line 30:       begin",
                "// vulnerable line: 31: URI.open(client_id) do |f|",
                "// Line 32:           doc = Nokogiri::HTML(f.read)",
                "// Line 33: ",
                "// Line 34:           url = \"\"",
                "// Line 35:           doc.xpath(\"//div[@class='h-app']//a[contains(@class, 'u-url')]/@href\").each {|u| url = u.value}",
                "// Line 36:           @url = client_id.chomp(\"/\") + url if url.start_with? \"/\"",
                "// Line 37: ",
                "// Line 38:           name = \"\"",
                "// Line 39:           doc.xpath(\"//div[@class='h-app']//a[contains(@class, 'p-name')]/text()\").each {|n| name = n.text}",
                "// Line 40:           @name = name unless name.empty?",
                "// Line 41: "
            ]
        }
    ]
}