{
    "cve_id": "CVE-2024-24809",
    "cve_description": "Traccar is an open source GPS tracking system. Versions prior to 6.0 are vulnerable to path traversal and unrestricted upload of file with dangerous type. Since the system allows registration by default, attackers can acquire ordinary user permissions by registering an account and exploit this vulnerability to upload files with the prefix `device.` under any folder. Attackers can use this vulnerability for phishing, cross-site scripting attacks, and potentially execute arbitrary commands on the server. Version 6.0 contains a patch for the issue.",
    "cve_publish_date": "2024-04-10T15:16Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Remove extra dot",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "DeviceResource.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "5",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 168:             throw new IllegalArgumentException();",
                "// Line 169:         }",
                "// Line 170: ",
                "// Line 171:         LogAction.resetDeviceAccumulators(getUserId(), entity.getDeviceId());",
                "// Line 172:         return Response.noContent().build();",
                "// Line 173:     }",
                "// Line 174: ",
                "// Line 175:     private String imageExtension(String type) {",
                "// Line 176:         switch (type) {",
                "// Line 177:             case \"image/jpeg\":",
                "// vulnerable line: 178: return \".jpg\";",
                "// Line 179:             case \"image/png\":",
                "// vulnerable line: 180: return \".png\";",
                "// Line 181:             case \"image/gif\":",
                "// vulnerable line: 182: return \".gif\";",
                "// Line 183:             case \"image/webp\":",
                "// vulnerable line: 184: return \".webp\";",
                "// Line 185:             case \"image/svg+xml\":",
                "// vulnerable line: 186: return \".svg\";",
                "// Line 187:             default:",
                "// Line 188:                 throw new IllegalArgumentException(\"Unsupported image type\");",
                "// Line 189:         }",
                "// Line 190:     }",
                "// Line 191: ",
                "// Line 192:     @Path(\"{id}/image\")",
                "// Line 193:     @POST",
                "// Line 194:     @Consumes(\"image/*\")",
                "// Line 195:     public Response uploadImage(",
                "// Line 196:             @PathParam(\"id\") long deviceId, File file,"
            ]
        }
    ]
}