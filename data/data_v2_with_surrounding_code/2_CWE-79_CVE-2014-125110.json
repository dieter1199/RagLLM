{
    "cve_id": "CVE-2014-125110",
    "cve_description": "A vulnerability has been found in wp-file-upload Plugin up to 2.4.3 on WordPress and classified as problematic. Affected by this vulnerability is the function wfu_ajax_action_callback of the file lib/wfu_ajaxactions.php. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.4.4 is able to address this issue. The identifier of the patch is c846327df030a0a97da036a2f07c769ab9284ddb. It is recommended to upgrade the affected component. The identifier VDB-258781 was assigned to this vulnerability.",
    "cve_publish_date": "2024-04-01T00:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "new version 2.4.4 - fix XSS issues\n\ngit-svn-id: https://plugins.svn.wordpress.org/wp-file-upload/trunk@968920 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "wfu_ajaxactions.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "5",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 60: ",
                "// Line 61:     die(\"wfu_fileupload_success:\".$sout.\":\".wfu_encode_array_to_string($params_output_array)); ",
                "// Line 62: }",
                "// Line 63: ",
                "// Line 64: function wfu_ajax_action_callback() {",
                "// Line 65:     $user = wp_get_current_user();",
                "// Line 66:     $arr = wfu_get_params_fields_from_index($_POST['params_index']);",
                "// Line 67:     //check referer using server sessions to avoid CSRF attacks",
                "// Line 68:     if ( $_SESSION[\"wfu_token_\".$arr['shortcode_id']] != $_POST['session_token'] ) {",
                "// Line 69:         echo \"Session failed!<br/><br/>Session Data:<br/>\";",
                "// vulnerable line: 70: print_r($_SESSION);",
                "// Line 71:         echo \"<br/><br/>Post Data:<br/>\";",
                "// vulnerable line: 72: print_r($_POST);",
                "// Line 73:         die();",
                "// Line 74:     }",
                "// Line 75: ",
                "// Line 76:     if ( $user->user_login != $arr['user_login'] ) {",
                "// Line 77:         echo \"User failed!<br/><br/>User Data:<br/>\";",
                "// vulnerable line: 78: print_r($user);",
                "// Line 79:         echo \"<br/><br/>Post Data:<br/>\";",
                "// vulnerable line: 80: print_r($_POST);",
                "// Line 81:         echo \"<br/><br/>Params Data:<br/>\";",
                "// vulnerable line: 82: print_r($arr);",
                "// Line 83:         die();",
                "// Line 84:     }",
                "// Line 85: ",
                "// Line 86:     $params_str = get_option('wfu_params_'.$arr['unique_id']);",
                "// Line 87:     $params = wfu_decode_array_from_string($params_str);",
                "// Line 88: ",
                "// Line 89:     $params['subdir_selection_index'] = $_POST['subdir_sel_index'];",
                "// Line 90:     $_SESSION['wfu_check_refresh_'.$params[\"uploadid\"]] = 'do not process';",
                "// Line 91: ",
                "// Line 92:     $wfu_process_file_array = wfu_process_files($params, 'ajax');"
            ]
        },
        {
            "filename_of_changes": "wfu_functions.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "18",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "wordpress_file_upload.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: session_start();",
                "// Line 3: /*Plugin Name: Wordpress File Upload",
                "// Line 4: /*",
                "// Line 5: Plugin URI: http://www.iptanus.com/support/wordpress-file-upload",
                "// Line 6: Description: Simple interface to upload files from a page.",
                "// vulnerable line: 7: Version: 2.4.3",
                "// Line 8: Author: Nickolas Bossinas",
                "// Line 9: Author URI: http://www.iptanus.com",
                "// Line 10: */",
                "// Line 11: ",
                "// Line 12: /*",
                "// Line 13: Wordpress File Upload (Wordpress Plugin)",
                "// Line 14: Copyright (C) 2010-2014 Nickolas Bossinas",
                "// Line 15: Contact me at http://www.iptanus.com",
                "// Line 16: ",
                "// Line 17: This program is free software: you can redistribute it and/or modify"
            ]
        }
    ]
}