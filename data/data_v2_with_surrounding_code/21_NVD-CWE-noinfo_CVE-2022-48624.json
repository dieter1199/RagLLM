{
    "cve_id": "CVE-2022-48624",
    "cve_description": "close_altfile in filename.c in less before 606 omits shell_quote calls for LESSCLOSE.",
    "cve_publish_date": "2024-02-19T01:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Shell-quote filenames when invoking LESSCLOSE.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "filename.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 978:     if (secure)",
                "// Line 979:         return;",
                "// Line 980:     ch_ungetchar(-1);",
                "// Line 981:     if ((lessclose = lgetenv(\"LESSCLOSE\")) == NULL)",
                "// Line 982:         return;",
                "// Line 983:     if (num_pct_s(lessclose) > 2) ",
                "// Line 984:     {",
                "// Line 985:         error(\"LESSCLOSE ignored; must contain no more than 2 %%s\", NULL_PARG);",
                "// Line 986:         return;",
                "// Line 987:     }",
                "// vulnerable line: 988: len = (int) (strlen(lessclose) + strlen(filename) + strlen(altfilename) + 2);",
                "// Line 989:     cmd = (char *) ecalloc(len, sizeof(char));",
                "// vulnerable line: 990: SNPRINTF2(cmd, len, lessclose, filename, altfilename);",
                "// Line 991:     fd = shellcmd(cmd);",
                "// Line 992:     free(cmd);",
                "// Line 993:     if (fd != NULL)",
                "// Line 994:         pclose(fd);",
                "// Line 995: #endif",
                "// Line 996: }",
                "// Line 997:         ",
                "// Line 998: /*",
                "// Line 999:  * Is the specified file a directory?",
                "// Line 1000:  */"
            ]
        }
    ]
}