{
    "cve_id": "CVE-2024-25344",
    "cve_description": "Cross Site Scripting vulnerability in ITFlow.org before commit v.432488eca3998c5be6b6b9e8f8ba01f54bc12378 allows a remtoe attacker to execute arbitrary code and obtain sensitive information via the settings.php, settings+company.php, settings_defaults.php,settings_integrations.php, settings_invoice.php, settings_localization.php, settings_mail.php components.",
    "cve_publish_date": "2024-02-26T16:27Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Require CSRF token to edit Stripe settings - thanks to @stehled",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "setting.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_online_payment.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 46:                         <div class=\"input-group\">",
                "// Line 47:                             <div class=\"input-group-prepend\">",
                "// Line 48:                                 <span class=\"input-group-text\"><i class=\"fas fa-fw fa-piggy-bank\"></i></span>",
                "// Line 49:                             </div>",
                "// Line 50:                             <select class=\"form-control select2\" name=\"config_stripe_account\" required>",
                "// Line 51:                                 <option value=\"\">- Account -</option>",
                "// Line 52:                                 <?php",
                "// Line 53:                                 $sql_accounts = mysqli_query($mysqli, \"SELECT * FROM accounts LEFT JOIN account_types ON account_types.account_type_id = accounts.account_type WHERE account_type_parent = 1 AND account_archived_at IS NULL ORDER BY account_name ASC\");",
                "// Line 54:                                 while ($row = mysqli_fetch_array($sql_accounts)) {",
                "// Line 55:                                     $account_id = intval($row['account_id']);",
                "// vulnerable line: 56: $account_name = nullable_htmlentities($row['account_name']); ",
                "// Line 57:                                     ?>",
                "// Line 58: ",
                "// Line 59:                                     <option value=\"<?php echo $account_id ?>\" <?php if ($account_id == $config_stripe_account) { echo \"selected\"; } ?>><?php echo $account_name ?></option>",
                "// Line 60:                                 <?php",
                "// Line 61:                                 }",
                "// Line 62:                                 ?>",
                "// Line 63:                             </select>",
                "// Line 64:                         </div>",
                "// Line 65:                     </div>",
                "// Line 66:                     <div class=\"form-group\">"
            ]
        }
    ]
}