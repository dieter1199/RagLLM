{
    "cve_id": "CVE-2024-40129",
    "cve_description": "Open5GS v2.6.4 is vulnerable to Buffer Overflow. via /lib/pfcp/context.c.",
    "cve_publish_date": "2024-07-16T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "[PFCP] Fixed Possible heap buffer overflow (#2585)\n\nAfter examining the call stack and reading the source code, I found that\nin /lib/core/ogs-pool.h line 152: (pool)->array[i] = i+1;\nthen in lib/pfcp/context.c line 78: pdr_random_to_index[ogs_pfcp_pdr_teid_pool.array[i]] = i;\nogs_pfcp_pdr_teid_pool.array[i] may exceed the size of pdr_random_to_index, leading to a heap-buffer-overflow.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "context.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 65:             ogs_app()->pool.sess * OGS_MAX_NUM_OF_QER);",
                "// Line 66:     ogs_pool_init(&ogs_pfcp_bar_pool,",
                "// Line 67:             ogs_app()->pool.sess * OGS_MAX_NUM_OF_BAR);",
                "// Line 68: ",
                "// Line 69:     ogs_pool_init(&ogs_pfcp_pdr_pool,",
                "// Line 70:             ogs_app()->pool.sess * OGS_MAX_NUM_OF_PDR);",
                "// Line 71:     ogs_pool_init(&ogs_pfcp_pdr_teid_pool, ogs_pfcp_pdr_pool.size);",
                "// Line 72:     ogs_pool_random_id_generate(&ogs_pfcp_pdr_teid_pool);",
                "// Line 73: ",
                "// Line 74:     pdr_random_to_index = ogs_calloc(",
                "// vulnerable line: 75: sizeof(ogs_pool_id_t), ogs_pfcp_pdr_pool.size);",
                "// Line 76:     ogs_assert(pdr_random_to_index);",
                "// Line 77:     for (i = 0; i < ogs_pfcp_pdr_pool.size; i++)",
                "// Line 78:         pdr_random_to_index[ogs_pfcp_pdr_teid_pool.array[i]] = i;",
                "// Line 79: ",
                "// Line 80:     ogs_pool_init(&ogs_pfcp_rule_pool,",
                "// Line 81:             ogs_app()->pool.sess *",
                "// Line 82:             OGS_MAX_NUM_OF_PDR * OGS_MAX_NUM_OF_FLOW_IN_PDR);",
                "// Line 83: ",
                "// Line 84:     ogs_pool_init(&ogs_pfcp_dev_pool, OGS_MAX_NUM_OF_DEV);",
                "// Line 85:     ogs_pool_init(&ogs_pfcp_subnet_pool, OGS_MAX_NUM_OF_SUBNET);"
            ]
        }
    ]
}