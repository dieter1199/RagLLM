{
    "cve_id": "CVE-2024-28114",
    "cve_description": "Peering Manager is a BGP session management tool. There is a Server Side Template Injection vulnerability that leads to Remote Code Execution in Peering Manager <=1.8.2. As a result arbitrary commands can be executed on the operating system that is running Peering Manager. This issue has been addressed in version 1.8.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n",
    "cve_publish_date": "2024-03-12T20:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Run Jinja2 code in sandboxed environment\n\nAlso warn user in the documentation about security risks when using code\nfrom others.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "__init__.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 3: from .loaders import *",
                "// Line 4: ",
                "// Line 5: ",
                "// Line 6: def render_jinja2(template, context, trim=False, lstrip=False):",
                "// Line 7:     \"\"\"",
                "// Line 8:     Render the template using Jinja2.",
                "// Line 9:     \"\"\"",
                "// Line 10:     import traceback",
                "// Line 11: ",
                "// Line 12:     from django.conf import settings",
                "// vulnerable line: 13: from jinja2 import Environment, TemplateSyntaxError",
                "// Line 14: ",
                "// vulnerable line: 15: environment = Environment(",
                "// Line 16:         loader=PeeringManagerLoader(), trim_blocks=trim, lstrip_blocks=lstrip",
                "// Line 17:     )",
                "// Line 18:     environment.add_extension(IncludeTemplateExtension)",
                "// Line 19:     for extension in settings.JINJA2_TEMPLATE_EXTENSIONS:",
                "// Line 20:         environment.add_extension(extension)",
                "// Line 21: ",
                "// Line 22:     # Add custom filters to our environment",
                "// Line 23:     environment.filters.update(FILTER_DICT)",
                "// Line 24: ",
                "// Line 25:     # Try rendering the template, return a message about syntax issues if there"
            ]
        }
    ]
}