{
    "cve_id": "CVE-2024-25678",
    "cve_description": "In LiteSpeed QUIC (LSQUIC) Library before 4.0.4, DCID validation is mishandled.",
    "cve_publish_date": "2024-02-09T10:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Release 4.0.4",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "lsquic_full_conn_ietf.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 7249:  * Sets the new current SCID if the DCID in the incoming packet:",
                "// Line 7250:  *  (1) was issued by this endpoint and",
                "// Line 7251:  *  (2) has not been used before.",
                "// Line 7252:  */",
                "// Line 7253: static int",
                "// Line 7254: on_dcid_change (struct ietf_full_conn *conn, const lsquic_cid_t *dcid_in)",
                "// Line 7255: {",
                "// Line 7256:     struct lsquic_conn *const lconn = &conn->ifc_conn;  /* Shorthand */",
                "// Line 7257:     struct conn_cid_elem *cce;",
                "// Line 7258: ",
                "// vulnerable line: 7259: LSQ_DEBUG(\"peer switched its DCID, attempt to switch own SCID\");",
                "// Line 7260: ",
                "// Line 7261:     for (cce = lconn->cn_cces; cce < END_OF_CCES(lconn); ++cce)",
                "// Line 7262:         if (cce - lconn->cn_cces != lconn->cn_cur_cce_idx",
                "// Line 7263:                 && (lconn->cn_cces_mask & (1 << (cce - lconn->cn_cces)))",
                "// Line 7264:                     && LSQUIC_CIDS_EQ(&cce->cce_cid, dcid_in))",
                "// Line 7265:             break;",
                "// Line 7266: ",
                "// Line 7267:     if (cce >= END_OF_CCES(lconn))",
                "// Line 7268:     {",
                "// Line 7269:         ABORT_WARN(\"DCID not found\");",
                "// Line 7511:             if (conn->ifc_cur_path_id != packet_in->pi_path_id)",
                "// Line 7512:             {",
                "// Line 7513:                 if (0 != on_new_or_unconfirmed_path(conn, packet_in))",
                "// Line 7514:                 {",
                "// Line 7515:                     LSQ_DEBUG(\"path %hhu invalid, cancel any path response \"",
                "// Line 7516:                         \"on it\", packet_in->pi_path_id);",
                "// Line 7517:                     conn->ifc_send_flags &= ~(SF_SEND_PATH_RESP",
                "// Line 7518:                                                     << packet_in->pi_path_id);",
                "// Line 7519:                 }",
                "// Line 7520:             }",
                "// vulnerable line: 7521: else if (is_dcid_changed)",
                "// Line 7522:             {",
                "// Line 7523:                 if (0 != on_dcid_change(conn, &packet_in->pi_dcid))",
                "// Line 7524:                     return -1;",
                "// Line 7525:             }",
                "// Line 7526:         }",
                "// Line 7527:         if (lsquic_packet_in_non_probing(packet_in)",
                "// Line 7528:                         && packet_in->pi_packno > conn->ifc_max_non_probing)",
                "// Line 7529:             conn->ifc_max_non_probing = packet_in->pi_packno;",
                "// Line 7530:         /* From [draft-ietf-quic-transport-30] Section 13.2.1:",
                "// Line 7531:          *"
            ]
        }
    ]
}