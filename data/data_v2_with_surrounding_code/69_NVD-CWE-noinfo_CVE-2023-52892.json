{
    "cve_id": "CVE-2023-52892",
    "cve_description": "In phpseclib before 1.0.22, 2.x before 2.0.46, and 3.x before 3.0.33, some characters in Subject Alternative Name fields in TLS certificates are incorrectly allowed to have a special meaning in regular expressions (such as a + wildcard), leading to name confusion in X.509 certificate host verification.",
    "cve_publish_date": "2024-06-27T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "X509: fix for weird characters in subjaltname",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "X509.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 2095:         }",
                "// Line 2096: ",
                "// Line 2097:         $components = parse_url($url);",
                "// Line 2098:         if (!isset($components['host'])) {",
                "// Line 2099:             return false;",
                "// Line 2100:         }",
                "// Line 2101: ",
                "// Line 2102:         if ($names = $this->getExtension('id-ce-subjectAltName')) {",
                "// Line 2103:             foreach ($names as $name) {",
                "// Line 2104:                 foreach ($name as $key => $value) {",
                "// vulnerable line: 2105: $value = str_replace(array('.', '*'), array('\\.', '[^.]*'), $value);",
                "// Line 2106:                     switch ($key) {",
                "// Line 2107:                         case 'dNSName':",
                "// Line 2108:                             /* From RFC2818 \"HTTP over TLS\":",
                "// Line 2109: ",
                "// Line 2110:                                If a subjectAltName extension of type dNSName is present, that MUST",
                "// Line 2111:                                be used as the identity. Otherwise, the (most specific) Common Name",
                "// Line 2112:                                field in the Subject field of the certificate MUST be used. Although",
                "// Line 2113:                                the use of the Common Name is existing practice, it is deprecated and",
                "// Line 2114:                                Certification Authorities are encouraged to use the dNSName instead. */",
                "// Line 2115:                             if (preg_match('#^' . $value . '$#', $components['host'])) {"
            ]
        }
    ]
}