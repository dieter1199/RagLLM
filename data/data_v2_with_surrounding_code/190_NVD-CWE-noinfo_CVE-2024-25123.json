{
    "cve_id": "CVE-2024-25123",
    "cve_description": "MSS (Mission Support System) is an open source package designed for planning atmospheric research flights. In file: `index.py`, there is a method that is vulnerable to path manipulation attack. By modifying file paths, an attacker can acquire sensitive information from different resources. The `filename` variable is joined with other variables to form a file path in `_file`. However, `filename` is a route parameter that can capture path type values i.e. values including slashes (\\). So it is possible for an attacker to manipulate the file being read by assigning a value containing ../ to `filename` and so the attacker may be able to gain access to other files on the host filesystem. This issue has been addressed in MSS version 8.3.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-02-15T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-pf2h-qjcr-qvq2",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "index.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "6",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 150:         if STATIC_LOCATION != \"\" and os.path.exists(os.path.join(STATIC_LOCATION, 'plots.html')):",
                "// Line 151:             _file = os.path.join(STATIC_LOCATION, 'plots.html')",
                "// Line 152:             content = get_content(_file)",
                "// Line 153:         else:",
                "// Line 154:             content = \"Gallery was not generated for this server.<br>\"                       \"For further info on how to generate it, run the \"                       \"<b>gallery --help</b> command line parameter of mswms.<br>\"                       \"An example of the gallery can be seen \"                       \"<a href=\"https://mss.readthedocs.io/en/stable/gallery/index.html\">here</a>\"",
                "// Line 155:         return render_template(\"/content.html\", act=\"plots\", content=content)",
                "// Line 156: ",
                "// Line 157:     @APP.route(\"/mss/code/<path:filename>\")",
                "// Line 158:     def code(filename):",
                "// Line 159:         download = request.args.get(\"download\", False)",
                "// vulnerable line: 160: _file = os.path.join(STATIC_LOCATION, 'code', filename)",
                "// Line 161:         content = get_content(_file)",
                "// Line 162:         if not download:",
                "// Line 163:             return render_template(\"/content.html\", act=\"code\", content=content)",
                "// Line 164:         else:",
                "// Line 165:             with open(_file) as f:",
                "// Line 166:                 text = f.read()",
                "// Line 167:             return Response(\"\".join([s.replace(\"    \", \"\", 1) for s in text.split(\"```python\")[-1]",
                "// Line 168:                                     .splitlines(keepends=True)][1:-2]),",
                "// Line 169:                             mimetype=\"text/plain\",",
                "// Line 170:                             headers={\"Content-disposition\": f\"attachment; filename={filename.split('-')[0]}.py\"})"
            ]
        },
        {
            "filename_of_changes": "server.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 371:     return \"False\"",
                "// Line 372: ",
                "// Line 373: ",
                "// Line 374: @APP.route('/uploads/<name>/<path:filename>', methods=[\"GET\"])",
                "// Line 375: def uploads(name=None, filename=None):",
                "// Line 376:     base_path = mscolab_settings.UPLOAD_FOLDER",
                "// Line 377:     if name is None:",
                "// Line 378:         abort(404)",
                "// Line 379:     if filename is None:",
                "// Line 380:         abort(404)",
                "// vulnerable line: 381: return send_from_directory(fs.path.join(base_path, name), filename)",
                "// Line 382: ",
                "// Line 383: ",
                "// Line 384: # 413: Payload Too Large",
                "// Line 385: @APP.errorhandler(413)",
                "// Line 386: def error413(error):",
                "// Line 387:     upload_limit = APP.config['MAX_CONTENT_LENGTH'] / 1024 / 1024",
                "// Line 388:     return jsonify({\"success\": False, \"message\": f\"File size too large. Upload limit is {upload_limit}MB\"}), 413",
                "// Line 389: ",
                "// Line 390: ",
                "// Line 391: # File related routes"
            ]
        }
    ]
}