{
    "cve_id": "CVE-2024-31209",
    "cve_description": "oidcc is the OpenID Connect client library for Erlang. Denial of Service (DoS) by Atom exhaustion is possible by calling `oidcc_provider_configuration_worker:get_provider_configuration/1` or `oidcc_provider_configuration_worker:get_jwks/1`. This issue has been patched in version(s)`3.1.2` & `3.2.0-beta.3`.",
    "cve_publish_date": "2024-04-04T16:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-mj35-2rgf-cv8p",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "oidcc_provider_configuration_worker.erl",
            "code_language": "Erlang",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 375:         [{Key, Value}] ?= ets:lookup(TableName, Key),",
                "// Line 376:         Value",
                "// Line 377:     else",
                "// Line 378:         %% Fall Back to synchronous gen_server lookup if ets table can't be",
                "// Line 379:         %% located or the value is not present yet",
                "// Line 380:         _ -> gen_server:call(Name, Call)",
                "// Line 381:     end.",
                "// Line 382: ",
                "// Line 383: -spec get_ets_table_name(WorkerRef :: gen_server:server_ref()) ->",
                "// Line 384:     {ok, gen_server:server_ref()} | error.",
                "// vulnerable line: 385: get_ets_table_name(WorkerName) when is_atom(WorkerName) ->",
                "// vulnerable line: 386: {ok, erlang:list_to_atom(erlang:atom_to_list(WorkerName) ++ \"_table\")};",
                "// Line 387: get_ets_table_name(_Ref) ->",
                "// Line 388:     error.",
                "// Line 389: ",
                "// Line 390: -spec register_ets_table(Opts :: opts()) -> ets:table() | undefined.",
                "// Line 391: register_ets_table(Opts) ->",
                "// Line 392:     case maps:get(name, Opts, undefined) of",
                "// vulnerable line: 393: {local, WorkerName} ->",
                "// vulnerable line: 394: Name = erlang:list_to_atom(erlang:atom_to_list(WorkerName) ++ \"_table\"),",
                "// Line 395:             ets:new(Name, [named_table, bag, protected, {read_concurrency, true}]);",
                "// Line 396:         _OtherName ->",
                "// Line 397:             undefined",
                "// Line 398:     end.",
                "// Line 399: ",
                "// Line 400: -spec handle_backoff_retry(ErrorType, Reason, State) ->",
                "// Line 401:     {stop, {ErrorType, Reason}, State} | {noreply, State}",
                "// Line 402: when",
                "// Line 403:     ErrorType :: jwks_load_failed | configuration_load_failed,",
                "// Line 404:     Reason :: term(),"
            ]
        }
    ]
}