{
    "cve_id": "CVE-2024-39918",
    "cve_description": "@jmondi/url-to-png is an open source URL to PNG utility featuring parallel rendering using Playwright for screenshots and with storage caching via Local, S3, or CouchDB. Input of the `ImageId` in the code is not sanitized and may lead to path traversal. This allows an attacker to store an image in an arbitrary location that the server has permission to access. This issue has been addressed in version 2.1.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.\n",
    "cve_publish_date": "2024-07-15T20:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "sanitize params",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "extract_query_params.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 65:       validData.width = 1920;",
                "// Line 66:     }",
                "// Line 67: ",
                "// Line 68:     const viewportHeight = validData.viewportHeight ?? validData.viewPortHeight;",
                "// Line 69:     if (viewportHeight && viewportHeight > 1920) {",
                "// Line 70:       validData.width = 1920;",
                "// Line 71:     }",
                "// Line 72: ",
                "// Line 73:     const date = new Date();",
                "// Line 74:     const dateString = date.toLocaleDateString().replace(/\\//g, \"-\");",
                "// vulnerable line: 75: const imageId = dateString + \".\" + slugify(validData.url) + configToString(params);",
                "// Line 76: ",
                "// Line 77:     c.set(\"input\", validData);",
                "// Line 78:     c.set(\"imageId\", imageId);",
                "// Line 79: ",
                "// Line 80:     await next();",
                "// Line 81:   };",
                "// Line 82: }"
            ]
        }
    ]
}