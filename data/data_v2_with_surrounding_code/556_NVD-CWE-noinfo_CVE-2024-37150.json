{
    "cve_id": "CVE-2024-37150",
    "cve_description": "An issue in `.npmrc` support in Deno 1.44.0 was discovered where Deno would send `.npmrc` credentials for the scope to the tarball URL when the registry provided URLs for a tarball on a different domain. All users relying on .npmrc are potentially affected by this vulnerability if their private registry references tarball URLs at a different domain. This includes usage of deno install subcommand, auto-install for npm: specifiers and LSP usage. It is recommended to upgrade to Deno 1.44.1 and if your private registry ever serves tarballs at a different domain to rotate your registry credentials.",
    "cve_publish_date": "2024-06-06T16:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix(npm): use configured auth for tarball urls instead of scope auth (#24111)\n\nDeno was using the scope auth for the tarball urls, which is not always\r\ncorrect. We are going to do a release immediately for this issue.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "lsp_tests.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 9437:       \"version\": \"0.0.1\",",
                "// Line 9438:       \"dependencies\": {",
                "// Line 9439:         \"@denotest/basic\": \"1.0.0\",",
                "// Line 9440:       },",
                "// Line 9441:     })",
                "// Line 9442:     .to_string(),",
                "// Line 9443:   );",
                "// Line 9444:   temp_dir.write(",
                "// Line 9445:     temp_dir.path().join(\".npmrc\"),",
                "// Line 9446:     \"@denotest:registry=http://127.0.0.1:4261/",
                "// vulnerable line: 9447: //127.0.0.1:4261/:_authToken=private-reg-token",
                "// Line 9448: \",",
                "// Line 9449:   );",
                "// Line 9450:   let file = source_file(",
                "// Line 9451:     temp_dir.path().join(\"main.ts\"),",
                "// Line 9452:     r#\"",
                "// Line 9453:       import { getValue, setValue } from \"@denotest/basic\";",
                "// Line 9454:       setValue(42);",
                "// Line 9455:       const n: string = getValue();",
                "// Line 9456:       console.log(n);",
                "// Line 9457:     \"#,"
            ]
        },
        {
            "filename_of_changes": "mod.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "npm.rs",
            "code_language": "Rust",
            "number_of_lines_added_for_mitigation": "6",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}