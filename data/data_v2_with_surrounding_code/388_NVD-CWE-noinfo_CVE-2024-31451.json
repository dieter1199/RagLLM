{
    "cve_id": "CVE-2024-31451",
    "cve_description": "DocsGPT is a GPT-powered chat for documentation. DocsGPT is vulnerable to unauthenticated limited file write in routes.py. This vulnerability is fixed in 0.8.1.",
    "cve_publish_date": "2024-04-16T15:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "advisory-fix",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "routes.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "20",
            "number_of_lines_deleted_vulnerable_to_cve": "13",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 245:     # check if docs exist in a vectorstore folder",
                "// Line 246:     data = request.get_json()",
                "// Line 247:     # split docs on / and take first part",
                "// Line 248:     if data[\"docs\"].split(\"/\")[0] == \"local\":",
                "// Line 249:         return {\"status\": \"exists\"}",
                "// Line 250:     vectorstore = \"vectors/\" + data[\"docs\"]",
                "// Line 251:     base_path = \"https://raw.githubusercontent.com/arc53/DocsHUB/main/\"",
                "// Line 252:     if os.path.exists(vectorstore) or data[\"docs\"] == \"default\":",
                "// Line 253:         return {\"status\": \"exists\"}",
                "// Line 254:     else:",
                "// vulnerable line: 255: r = requests.get(base_path + vectorstore + \"index.faiss\")",
                "// Line 256: ",
                "// vulnerable line: 257: if r.status_code != 200:",
                "// vulnerable line: 258: return {\"status\": \"null\"}",
                "// Line 259:         else:",
                "// vulnerable line: 260: if not os.path.exists(vectorstore):",
                "// vulnerable line: 261: os.makedirs(vectorstore)",
                "// vulnerable line: 262: with open(vectorstore + \"index.faiss\", \"wb\") as f:",
                "// vulnerable line: 263: f.write(r.content)",
                "// Line 264: ",
                "// vulnerable line: 265: # download the store",
                "// vulnerable line: 266: r = requests.get(base_path + vectorstore + \"index.pkl\")",
                "// vulnerable line: 267: with open(vectorstore + \"index.pkl\", \"wb\") as f:",
                "// vulnerable line: 268: f.write(r.content)",
                "// Line 269: ",
                "// Line 270:         return {\"status\": \"loaded\"}",
                "// Line 271: ",
                "// Line 272: @user.route(\"/api/create_prompt\", methods=[\"POST\"])",
                "// Line 273: def create_prompt():",
                "// Line 274:     data = request.get_json()",
                "// Line 275:     content = data[\"content\"]",
                "// Line 276:     name = data[\"name\"]",
                "// Line 277:     if name == \"\":",
                "// Line 278:         return {\"status\": \"error\"}"
            ]
        }
    ]
}