{
    "cve_id": "CVE-2024-35241",
    "cve_description": "Composer is a dependency manager for PHP. On the 2.x branch prior to versions 2.2.24 and 2.7.7, the `status`, `reinstall` and `remove` commands with packages installed from source via git containing specially crafted branch names in the repository can be used to execute code. Patches for this issue are available in version 2.2.24 for 2.2 LTS or 2.7.7 for mainline. As a workaround, avoid installing dependencies via git by using `--prefer-dist` or the `preferred-install: dist` config setting.\n",
    "cve_publish_date": "2024-06-10T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-47f6-5gq3-vx9c",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "GitDownloader.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 295:             if (count($remoteBranches) === 0) {",
                "// Line 296:                 $unpushedChanges = 'Branch ' . $branch . ' could not be found on any remote and appears to be unpushed';",
                "// Line 297:                 $branchNotFoundError = true;",
                "// Line 298:             } else {",
                "// Line 299:                 // if first iteration found no remote branch but it has now found some, reset $unpushedChanges",
                "// Line 300:                 // so we get the real diff output no matter its length",
                "// Line 301:                 if ($branchNotFoundError) {",
                "// Line 302:                     $unpushedChanges = null;",
                "// Line 303:                 }",
                "// Line 304:                 foreach ($remoteBranches as $remoteBranch) {",
                "// vulnerable line: 305: $command = sprintf('git diff --name-status %s...%s --', $remoteBranch, $branch);",
                "// Line 306:                     if (0 !== $this->process->execute($command, $output, $path)) {",
                "// Line 307:                         throw new \\RuntimeException('Failed to execute ' . $command . \"",
                "// Line 308: ",
                "// Line 309: \" . $this->process->getErrorOutput());",
                "// Line 310:                     }",
                "// Line 311: ",
                "// Line 312:                     $output = trim($output);",
                "// Line 313:                     // keep the shortest diff from all remote branches we compare against",
                "// Line 314:                     if ($unpushedChanges === null || strlen($output) < strlen($unpushedChanges)) {",
                "// Line 315:                         $unpushedChanges = $output;"
            ]
        }
    ]
}