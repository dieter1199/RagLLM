{
    "cve_id": "CVE-2024-31445",
    "cve_description": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, a SQL injection vulnerability in `automation_get_new_graphs_sql` function of `api_automation.php` allows authenticated users to exploit these SQL injection vulnerabilities to perform privilege escalation and remote code execution. In `api_automation.php` line 856, the `get_request_var('filter')` is being concatenated into the SQL statement without any sanitization. In `api_automation.php` line 717, The filter of `'filter'` is `FILTER_DEFAULT`, which means there is no filter for it. Version 1.2.27 contains a patch for the issue.",
    "cve_publish_date": "2024-05-14T15:25Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-vjph-r677-6pcc",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "api_automation.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1807: function build_graph_object_sql_having($rule, $filter) {",
                "// Line 1808:     if ($filter != '') {",
                "// Line 1809:         $field_names = get_field_names($rule['snmp_query_id']);",
                "// Line 1810: ",
                "// Line 1811:         if (cacti_sizeof($field_names)) {",
                "// Line 1812:             $sql_having = ' HAVING (';",
                "// Line 1813: ",
                "// Line 1814:             $i = 0;",
                "// Line 1815: ",
                "// Line 1816:             foreach ($field_names as $column) {",
                "// vulnerable line: 1817: $sql_having .= ($i == 0 ? '':' OR ') . '`' . implode('`.`', explode('.', $column['field_name'])) . '`' . ' LIKE \"%' . $filter . '%\"';",
                "// Line 1818:                 $i++;",
                "// Line 1819:             }",
                "// Line 1820: ",
                "// Line 1821:             $sql_having .= ')';",
                "// Line 1822:         }",
                "// Line 1823: ",
                "// Line 1824:         return $sql_having;",
                "// Line 1825:     }",
                "// Line 1826: }",
                "// Line 1827: "
            ]
        }
    ]
}