{
    "cve_id": "CVE-2024-27296",
    "cve_description": "Directus is a real-time API and App dashboard for managing SQL database content. Prior to version 10.8.3, the exact Directus version number was being shipped in compiled JS bundles which are accessible without authentication. With this information a malicious attacker can trivially look for known vulnerabilities in Directus core or any of its shipped dependencies in that specific running version. The problem has been resolved in versions 10.8.3 and newer.",
    "cve_publish_date": "2024-03-01T16:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "replaced hardcoded versions in the app",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "main.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "7",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 10: import { registerDirectives } from './directives/register';",
                "// Line 11: import { loadExtensions, registerExtensions } from './extensions';",
                "// Line 12: import { i18n } from './lang/';",
                "// Line 13: import { router } from './router';",
                "// Line 14: import './styles/main.scss';",
                "// Line 15: import { registerViews } from './views/register';",
                "// Line 16: ",
                "// Line 17: init();",
                "// Line 18: ",
                "// Line 19: async function init() {",
                "// vulnerable line: 20: const version = __DIRECTUS_VERSION__;",
                "// Line 21: ",
                "// Line 22:     console.log(DIRECTUS_LOGO);",
                "// Line 23: ",
                "// Line 24:     console.info(",
                "// Line 25:         `Hey! Interested in helping build this open-source data management platform?",
                "// Line 26: If so, join our growing team of contributors at: https://directus.chat`,",
                "// Line 27:     );",
                "// Line 28: ",
                "// vulnerable line: 29: if (import.meta.env.DEV) {",
                "// vulnerable line: 30: console.info(`%c🐰 Starting Directus v${version}...`, 'color:Green');",
                "// vulnerable line: 31: } else {",
                "// vulnerable line: 32: console.info(`%c🐰 Starting Directus...`, 'color:Green');",
                "// vulnerable line: 33: }",
                "// Line 34: ",
                "// Line 35:     console.time('🕓 Application Loaded');",
                "// Line 36: ",
                "// Line 37:     const app = createApp(App);",
                "// Line 38: ",
                "// Line 39:     app.use(i18n);",
                "// Line 40:     app.use(createPinia());",
                "// Line 41:     app.use(createHead());",
                "// Line 42: ",
                "// Line 43:     app.config.errorHandler = (err, vm, info) => {",
                "// Line 56: ",
                "// Line 57:     // Add router after loading of extensions to ensure all routes are registered",
                "// Line 58:     app.use(router);",
                "// Line 59: ",
                "// Line 60:     app.mount('#app');",
                "// Line 61: ",
                "// Line 62:     console.timeEnd('🕓 Application Loaded');",
                "// Line 63: ",
                "// Line 64:     console.group(`%c✨ Project Information`, 'color:DodgerBlue'); // groupCollapsed",
                "// Line 65: ",
                "// vulnerable line: 66: if (import.meta.env.DEV) {",
                "// Line 67:         console.info(`%cVersion: v${version}`, 'color:DodgerBlue');",
                "// vulnerable line: 68: }",
                "// Line 69: ",
                "// Line 70:     console.info(`%cEnvironment: ${import.meta.env.MODE}`, 'color:DodgerBlue');",
                "// Line 71:     console.groupEnd();",
                "// Line 72: ",
                "// Line 73:     // Prevent the browser from opening files that are dragged on the window",
                "// Line 74:     window.addEventListener('dragover', (e) => e.preventDefault(), false);",
                "// Line 75:     window.addEventListener('drop', (e) => e.preventDefault(), false);",
                "// vulnerable line: 76: }"
            ]
        },
        {
            "filename_of_changes": "navigation.vue",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <script setup lang=\"ts\">",
                "// Line 2: import { computed } from 'vue';",
                "// Line 3: import { useI18n } from 'vue-i18n';",
                "// Line 4: ",
                "// vulnerable line: 5: const version = __DIRECTUS_VERSION__;",
                "// Line 6: ",
                "// Line 7: const { t } = useI18n();",
                "// Line 8: ",
                "// Line 9: const dataItems = [",
                "// Line 10:     {",
                "// Line 11:         icon: 'database',",
                "// Line 12:         name: t('settings_data_model'),",
                "// Line 13:         to: `/settings/data-model`,",
                "// Line 14:     },",
                "// Line 15:     {",
                "// Line 96:         <v-list-item v-for=\"item in externalItems\" :key=\"item.href\" :href=\"item.href\">",
                "// Line 97:             <v-list-item-icon><v-icon :name=\"item.icon\" /></v-list-item-icon>",
                "// Line 98:             <v-list-item-content>",
                "// Line 99:                 <v-text-overflow :text=\"item.name\" />",
                "// Line 100:             </v-list-item-content>",
                "// Line 101:         </v-list-item>",
                "// Line 102: ",
                "// Line 103:         <v-list-item href=\"https://github.com/directus/directus/releases\" class=\"version\">",
                "// Line 104:             <v-list-item-icon><v-icon name=\"directus\" /></v-list-item-icon>",
                "// Line 105:             <v-list-item-content>",
                "// vulnerable line: 106: <v-text-overflow class=\"version\" :text=\"`Directus ${version}`\" />",
                "// Line 107:             </v-list-item-content>",
                "// Line 108:         </v-list-item>",
                "// Line 109:     </v-list>",
                "// Line 110: </template>",
                "// Line 111: ",
                "// Line 112: <style scoped>",
                "// Line 113: .version .v-icon {",
                "// Line 114:     color: var(--theme--foreground-subdued);",
                "// Line 115:     transition: color var(--fast) var(--transition);",
                "// Line 116: }"
            ]
        },
        {
            "filename_of_changes": "server.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}