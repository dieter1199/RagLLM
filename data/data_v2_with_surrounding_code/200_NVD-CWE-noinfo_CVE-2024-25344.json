{
    "cve_id": "CVE-2024-25344",
    "cve_description": "Cross Site Scripting vulnerability in ITFlow.org before commit v.432488eca3998c5be6b6b9e8f8ba01f54bc12378 allows a remtoe attacker to execute arbitrary code and obtain sensitive information via the settings.php, settings+company.php, settings_defaults.php,settings_integrations.php, settings_invoice.php, settings_localization.php, settings_mail.php components.",
    "cve_publish_date": "2024-02-26T16:27Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Require CSRF token to edit more admin settings - thanks again to @stehled",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "setting.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "17",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_alerts.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_backup.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: require_once \"inc_all_settings.php\";",
                "// Line 3:  ?>",
                "// Line 4: ",
                "// Line 5:     <div class=\"card card-dark mb-3\">",
                "// Line 6:         <div class=\"card-header py-3\">",
                "// Line 7:             <h3 class=\"card-title\"><i class=\"fas fa-fw fa-database mr-2\"></i>Download Database</h3>",
                "// Line 8:         </div>",
                "// Line 9:         <div class=\"card-body\" style=\"text-align: center;\">",
                "// vulnerable line: 10: <a class=\"btn btn-primary btn-lg p-3\" href=\"post.php?download_database\"><i class=\"fas fa-fw fa-4x fa-download\"></i><br><br>Download</a>",
                "// Line 11:         </div>",
                "// Line 12:     </div>",
                "// Line 13: ",
                "// Line 14:     <div class=\"card card-dark\">",
                "// Line 15:         <div class=\"card-header py-3\">",
                "// Line 16:             <h3 class=\"card-title\"><i class=\"fas fa-fw fa-key mr-2\"></i>Backup Master Encryption Key</h3>",
                "// Line 17:         </div>",
                "// Line 18:         <div class=\"card-body\">",
                "// Line 19:             <div class=\"card-body\">",
                "// Line 20:                 <form action=\"post.php\" method=\"POST\">"
            ]
        },
        {
            "filename_of_changes": "settings_company.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_defaults.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 14:                 <label>Start Page</label>",
                "// Line 15:                 <div class=\"input-group\">",
                "// Line 16:                     <div class=\"input-group-prepend\">",
                "// Line 17:                         <span class=\"input-group-text\"><i class=\"fa fa-fw fa-home\"></i></span>",
                "// Line 18:                     </div>",
                "// Line 19:                     <select class=\"form-control select2\" name=\"start_page\" data-tags=\"true\" required>",
                "// Line 20:                         <?php if (!in_array($config_start_page, array_keys($start_page_select_array))) { ?>",
                "// Line 21:                             <option selected> <?php echo nullable_htmlentities($config_start_page); ?></option>",
                "// Line 22:                         <?php } ?>",
                "// Line 23:                         <?php foreach ($start_page_select_array as $start_page_value => $start_page_name) { ?>",
                "// vulnerable line: 24: <option <?php if ($start_page_value == $config_start_page) { echo \"selected\"; } ?> ",
                "// Line 25:                                 value=\"<?php echo nullable_htmlentities($start_page_value); ?>\">",
                "// Line 26:                                 <?php echo nullable_htmlentities($start_page_name); ?>",
                "// Line 27:                             </option>",
                "// Line 28:                         <?php }?>",
                "// Line 29:                     </select>",
                "// Line 30:                 </div>",
                "// Line 31:             </div>",
                "// Line 32: ",
                "// Line 33:             <div class=\"form-group\">",
                "// Line 34:                 <label>Calendar</label>"
            ]
        },
        {
            "filename_of_changes": "settings_integrations.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_invoice.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_localization.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_mail.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_modules.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_quote.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_security.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_tax_add_modal.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <div class=\"modal\" id=\"addTaxModal\" tabindex=\"-1\">",
                "// Line 2:   <div class=\"modal-dialog\">",
                "// Line 3:     <div class=\"modal-content bg-dark\">",
                "// Line 4:       <div class=\"modal-header text-white\">",
                "// Line 5:         <h5 class=\"modal-title\"><i class=\"fas fa-fw fa-balance-scale mr-2\"></i>New Tax</h5>",
                "// Line 6:         <button type=\"button\" class=\"close text-white\" data-dismiss=\"modal\">",
                "// Line 7:           <span aria-hidden=\"true\">&times;</span>",
                "// Line 8:         </button>",
                "// vulnerable line: 9: </div>",
                "// Line 10:       <form action=\"post.php\" method=\"post\" autocomplete=\"off\">",
                "// Line 11:         <div class=\"modal-body bg-white\">",
                "// Line 12:           <div class=\"form-group\">",
                "// Line 13:             <label>Name <strong class=\"text-danger\">*</strong></label>",
                "// Line 14:             <input type=\"text\" class=\"form-control\" name=\"name\" placeholder=\"Tax name\" required autofocus>",
                "// vulnerable line: 15: </div>",
                "// Line 16:           <div class=\"form-group\">",
                "// Line 17:             <label>Percent <strong class=\"text-danger\">*</strong></label>",
                "// Line 18:             <input type=\"number\" min=\"0\" step=\"any\" class=\"form-control col-md-4\" name=\"percent\">",
                "// vulnerable line: 19: </div>",
                "// vulnerable line: 20: </div>",
                "// Line 21:         <div class=\"modal-footer bg-white\">",
                "// Line 22:           <button type=\"submit\" name=\"add_tax\" class=\"btn btn-primary text-bold\"><i class=\"fa fa-check mr- 2\"></i>Create</button>",
                "// Line 23:           <button type=\"button\" class=\"btn btn-light\" data-dismiss=\"modal\"><i class=\"fas fa-times mr-2\"></i>Cancel</button>",
                "// vulnerable line: 24: </div>",
                "// Line 25:       </form>",
                "// vulnerable line: 26: </div>",
                "// vulnerable line: 27: </div>",
                "// vulnerable line: 28: </div>"
            ]
        },
        {
            "filename_of_changes": "settings_tax_edit_modal.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "5",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <div class=\"modal\" id=\"editTaxModal<?php echo $tax_id; ?>\" tabindex=\"-1\">",
                "// Line 2:   <div class=\"modal-dialog\">",
                "// Line 3:     <div class=\"modal-content bg-dark\">",
                "// Line 4:       <div class=\"modal-header\">",
                "// Line 5:         <h5 class=\"modal-title\"><i class=\"fas fa-fw fa-balance-scale mr-2\"></i>Editing tax: <strong><?php echo $tax_name; ?></strong></h5>",
                "// Line 6:         <button type=\"button\" class=\"close text-white\" data-dismiss=\"modal\">",
                "// Line 7:           <span>&times;</span>",
                "// Line 8:         </button>",
                "// vulnerable line: 9: </div>",
                "// Line 10:       <form action=\"post.php\" method=\"post\" autocomplete=\"off\">",
                "// Line 11:         <input type=\"hidden\" name=\"tax_id\" value=\"<?php echo $tax_id; ?>\">",
                "// Line 12:         <div class=\"modal-body bg-white\">",
                "// Line 13: ",
                "// Line 14:           <div class=\"form-group\">",
                "// Line 15:             <label>Name <strong class=\"text-danger\">*</strong></label>",
                "// Line 16:             <input type=\"text\" class=\"form-control\" name=\"name\" value=\"<?php echo $tax_name; ?>\" required>",
                "// vulnerable line: 17: </div>",
                "// Line 18: ",
                "// Line 19:           <div class=\"form-group\">",
                "// Line 20:             <label>Percent <strong class=\"text-danger\">*</strong></label>",
                "// Line 21:             <input type=\"number\" min=\"0\" step=\"any\" class=\"form-control col-md-4\" name=\"percent\" value=\"<?php echo $tax_percent; ?>\">",
                "// Line 22: ",
                "// vulnerable line: 23: </div>",
                "// Line 24: ",
                "// vulnerable line: 25: </div>",
                "// Line 26:         <div class=\"modal-footer bg-white\">",
                "// Line 27:           <button type=\"submit\" name=\"edit_tax\" class=\"btn btn-primary text-bold\"><i class=\"fas fa-check mr-2\"></i>Save</button>",
                "// Line 28:           <button type=\"button\" class=\"btn btn-light\" data-dismiss=\"modal\"><i class=\"fas fa-times mr-2\"></i>Cancel</button>",
                "// vulnerable line: 29: </div>",
                "// Line 30:       </form>",
                "// vulnerable line: 31: </div>",
                "// vulnerable line: 32: </div>",
                "// vulnerable line: 33: </div>"
            ]
        },
        {
            "filename_of_changes": "settings_taxes.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4: $sort = \"tax_name\";",
                "// Line 5: $order = \"ASC\";",
                "// Line 6: ",
                "// Line 7: require_once \"inc_all_settings.php\";",
                "// Line 8: ",
                "// Line 9: ",
                "// Line 10: //Rebuild URL",
                "// Line 11: $url_query_strings_sort = http_build_query($get_copy);",
                "// Line 12: ",
                "// Line 13: $sql = mysqli_query(",
                "// vulnerable line: 14: $mysqli, ",
                "// Line 15:     \"SELECT * FROM taxes",
                "// Line 16:     WHERE tax_archived_at IS NULL",
                "// Line 17:     ORDER BY $sort $order\"",
                "// Line 18: );",
                "// Line 19: ",
                "// Line 20: $num_rows = mysqli_num_rows($sql);",
                "// Line 21: ",
                "// Line 22: ?>",
                "// Line 23: ",
                "// Line 24:     <div class=\"card card-dark\">",
                "// Line 53:                             <td>",
                "// Line 54:                                 <div class=\"dropdown dropleft text-center\">",
                "// Line 55:                                     <button class=\"btn btn-secondary btn-sm\" type=\"button\" data-toggle=\"dropdown\">",
                "// Line 56:                                         <i class=\"fas fa-ellipsis-h\"></i>",
                "// Line 57:                                     </button>",
                "// Line 58:                                     <div class=\"dropdown-menu\">",
                "// Line 59:                                         <a class=\"dropdown-item\" href=\"#\" data-toggle=\"modal\" data-target=\"#editTaxModal<?php echo $tax_id; ?>\">",
                "// Line 60:                                             <i class=\"fas fa-fw fa-edit mr-2\"></i>Edit",
                "// Line 61:                                         </a>",
                "// Line 62:                                         <div class=\"dropdown-divider\"></div>",
                "// vulnerable line: 63: <a class=\"dropdown-item text-danger confirm-link\" href=\"post.php?archive_tax=<?php echo $tax_id; ?>\">",
                "// Line 64:                                             <i class=\"fas fa-fw fa-archive mr-2\"></i>Archive",
                "// Line 65:                                         </a>",
                "// Line 66:                                     </div>",
                "// Line 67:                                 </div>",
                "// Line 68:                             </td>",
                "// Line 69:                         </tr>",
                "// Line 70: ",
                "// Line 71:                         <?php",
                "// Line 72: ",
                "// Line 73:                         require \"settings_tax_edit_modal.php\";"
            ]
        },
        {
            "filename_of_changes": "settings_telemetry.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_theme.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "settings_ticket.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "tax.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}