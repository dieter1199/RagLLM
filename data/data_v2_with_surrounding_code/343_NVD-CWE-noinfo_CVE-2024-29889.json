{
    "cve_id": "CVE-2024-29889",
    "cve_description": "GLPI is a Free Asset and IT Management Software package. Prior to 10.0.15, an authenticated user can exploit a SQL injection vulnerability in the saved searches feature to alter another user account data take control of it. This vulnerability is fixed in 10.0.15.",
    "cve_publish_date": "2024-05-07T14:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-8xvf-v6vv-r75g",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "User.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "24",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "pin_savedsearches.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "9",
            "number_of_lines_deleted_vulnerable_to_cve": "15",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 33:  * ---------------------------------------------------------------------",
                "// Line 34:  */",
                "// Line 35: ",
                "// Line 36: include('../inc/includes.php');",
                "// Line 37: ",
                "// Line 38: header('Content-Type: application/json; charset=UTF-8');",
                "// Line 39: Html::header_nocache();",
                "// Line 40: ",
                "// Line 41: Session::checkLoginUser();",
                "// Line 42: ",
                "// vulnerable line: 43: if (!is_string($_POST['itemtype']) || getItemForItemtype($_POST['itemtype']) === false) {",
                "// vulnerable line: 44: echo json_encode(['success' => false]);",
                "// vulnerable line: 45: exit();",
                "// vulnerable line: 46: }",
                "// Line 47: ",
                "// vulnerable line: 48: $all_pinned = importArrayFromDB($_SESSION['glpisavedsearches_pinned']);",
                "// vulnerable line: 49: $already_pinned = $all_pinned[$_POST['itemtype']] ?? 0;",
                "// vulnerable line: 50: $all_pinned[$_POST['itemtype']] = $already_pinned ? 0 : 1;",
                "// vulnerable line: 51: $_SESSION['glpisavedsearches_pinned'] = exportArrayToDB($all_pinned);",
                "// Line 52: ",
                "// Line 53: $user = new User();",
                "// vulnerable line: 54: $success = $user->update(",
                "// vulnerable line: 55: [",
                "// vulnerable line: 56: 'id'                   => Session::getLoginUserID(),",
                "// vulnerable line: 57: 'savedsearches_pinned' => $_SESSION['glpisavedsearches_pinned'],",
                "// vulnerable line: 58: ]",
                "// vulnerable line: 59: );",
                "// Line 60: ",
                "// Line 61: echo json_encode(['success' => $success]);"
            ]
        }
    ]
}