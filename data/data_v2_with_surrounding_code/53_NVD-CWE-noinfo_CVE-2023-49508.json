{
    "cve_id": "CVE-2023-49508",
    "cve_description": "Directory Traversal vulnerability in YetiForceCompany YetiForceCRM versions 6.4.0 and before allows a remote authenticated attacker to obtain sensitive information via the license parameter in the LibraryLicense.php component.",
    "cve_publish_date": "2024-02-16T08:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Improved loading of details and licenses of dependent libraries",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "LibraryLicense.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 29:      * @param \\App\\Request $request",
                "// Line 30:      */",
                "// Line 31:     public function process(App\\Request $request)",
                "// Line 32:     {",
                "// Line 33:         $result = false;",
                "// Line 34:         $fileContent = '';",
                "// Line 35:         if ($request->isEmpty('license')) {",
                "// Line 36:             $result = false;",
                "// Line 37:         } else {",
                "// Line 38:             $dir = ROOT_DIRECTORY . DIRECTORY_SEPARATOR . 'licenses' . DIRECTORY_SEPARATOR;",
                "// vulnerable line: 39: $filePath = $dir . $request->getByType('license', 'Text') . '.txt';",
                "// vulnerable line: 40: if (file_exists($filePath)) {",
                "// Line 41:                 $result = true;",
                "// Line 42:                 $fileContent = file_get_contents($filePath);",
                "// Line 43:             } else {",
                "// Line 44:                 $result = false;",
                "// Line 45:             }",
                "// Line 46:         }",
                "// Line 47: ",
                "// Line 48:         $this->preProcess($request);",
                "// Line 49:         $qualifiedModuleName = $request->getModule(false);",
                "// Line 50:         $viewer = $this->getViewer($request);"
            ]
        },
        {
            "filename_of_changes": "LibraryMoreInfo.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "10",
            "number_of_lines_deleted_vulnerable_to_cve": "18",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 14:     /**",
                "// Line 15:      * Public libraries package files.",
                "// Line 16:      *",
                "// Line 17:      * @var string[]",
                "// Line 18:      */",
                "// Line 19:     public $packageFiles = ['package.json', 'composer.json', 'bower.json'];",
                "// Line 20: ",
                "// Line 21:     /** {@inheritdoc} */",
                "// Line 22:     public function process(App\\Request $request)",
                "// Line 23:     {",
                "// vulnerable line: 24: $result = false;",
                "// Line 25:         $fileContent = '';",
                "// vulnerable line: 26: if ($request->isEmpty('type') || $request->isEmpty('libraryName')) {",
                "// vulnerable line: 27: $result = false;",
                "// vulnerable line: 28: } else {",
                "// vulnerable line: 29: if ('public' === $request->getByType('type', 1)) {",
                "// Line 30:                 $dir = ROOT_DIRECTORY . DIRECTORY_SEPARATOR . 'public_html' . DIRECTORY_SEPARATOR . 'libraries' . DIRECTORY_SEPARATOR;",
                "// vulnerable line: 31: $libraryName = $request->getByType('libraryName', 'Text');",
                "// Line 32:                 foreach ($this->packageFiles as $file) {",
                "// Line 33:                     $packageFile = $dir . $libraryName . DIRECTORY_SEPARATOR . $file;",
                "// vulnerable line: 34: if ($fileContent) {",
                "// vulnerable line: 35: continue;",
                "// vulnerable line: 36: }",
                "// vulnerable line: 37: if (file_exists($packageFile)) {",
                "// Line 38:                         $fileContent = file_get_contents($packageFile);",
                "// Line 39:                         $result = true;",
                "// vulnerable line: 40: } else {",
                "// vulnerable line: 41: $result = false;",
                "// vulnerable line: 42: }",
                "// vulnerable line: 43: }",
                "// vulnerable line: 44: } elseif ('vendor' === $request->getByType('type', 1)) {",
                "// vulnerable line: 45: $filePath = 'vendor' . DIRECTORY_SEPARATOR . $request->getByType('libraryName', 'Text') . DIRECTORY_SEPARATOR . 'composer.json';",
                "// vulnerable line: 46: if (file_exists($filePath)) {",
                "// Line 47:                     $fileContent = file_get_contents($filePath);",
                "// Line 48:                     $result = true;",
                "// vulnerable line: 49: } else {",
                "// vulnerable line: 50: $result = false;",
                "// vulnerable line: 51: }",
                "// vulnerable line: 52: } else {",
                "// vulnerable line: 53: $result = false;",
                "// vulnerable line: 54: }",
                "// vulnerable line: 55: }",
                "// Line 56:         $this->preProcess($request);",
                "// Line 57:         $qualifiedModuleName = $request->getModule(false);",
                "// Line 58:         $viewer = $this->getViewer($request);",
                "// Line 59:         $viewer->assign('QUALIFIED_MODULE', $qualifiedModuleName);",
                "// Line 60:         $viewer->assign('RESULT', $result);",
                "// Line 61:         $viewer->assign('FILE_CONTENT', $fileContent);",
                "// Line 62:         $viewer->view('LibraryMoreInfo.tpl', $qualifiedModuleName);",
                "// Line 63:         $this->postProcess($request);",
                "// vulnerable line: 64: }",
                "// vulnerable line: 65: }"
            ]
        },
        {
            "filename_of_changes": "LibraryMoreInfo.tpl",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 6:             <span class=\"fas fa-info-circle mr-1\"></span>",
                "// Line 7:             {\\App\\Language::translate('LBL_MORE_LIBRARY_INFO', $QUALIFIED_MODULE)}",
                "// Line 8:         </h5>",
                "// Line 9:         <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"{\\App\\Language::translate('LBL_CLOSE')}\">",
                "// Line 10:             <span aria-hidden=\"true\" title=\"{\\App\\Language::translate('LBL_CLOSE')}\">&times;</span>",
                "// Line 11:         </button>",
                "// Line 12:     </div>",
                "// Line 13:     <div class=\"modal-body col-md-12\">",
                "// Line 14:         {if $RESULT}",
                "// Line 15:             <code>",
                "// vulnerable line: 16: <pre>{$FILE_CONTENT}</pre>",
                "// Line 17:             </code>",
                "// Line 18:         {else}",
                "// Line 19:             <div class=\"alert alert-danger\" role=\"alert\">",
                "// Line 20:                 {\\App\\Language::translate('LBL_MISSING_FILE', $QUALIFIED_MODULE)}",
                "// Line 21:             </div>",
                "// Line 22:         {/if}",
                "// Line 23:     </div>",
                "// Line 24:     <!-- /tpl-Settings-Dependencies-LibraryMoreInfo -->",
                "// Line 25: {/strip}"
            ]
        },
        {
            "filename_of_changes": "version.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: ",
                "// Line 3: return [",
                "// vulnerable line: 4: 'appVersion' => '6.4.270',",
                "// vulnerable line: 5: 'patchVersion' => '2023.07.14',",
                "// Line 6:     'lib_roundcube' => '0.3.4',",
                "// Line 7: ];"
            ]
        }
    ]
}