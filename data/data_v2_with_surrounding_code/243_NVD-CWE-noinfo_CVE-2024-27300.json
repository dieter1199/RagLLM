{
    "cve_id": "CVE-2024-27300",
    "cve_description": "phpMyFAQ is an open source FAQ web application for PHP 8.1+ and MySQL, PostgreSQL and other databases. The `email` field in phpMyFAQ's user control panel page is vulnerable to stored XSS attacks due to the inadequacy of PHP's `FILTER_VALIDATE_EMAIL` function, which only validates the email format, not its content. This vulnerability enables an attacker to execute arbitrary client-side JavaScript within the context of another user's phpMyFAQ session. This vulnerability is fixed in 3.2.6.",
    "cve_publish_date": "2024-03-25T19:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: added missing conversion to HTML entities",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ucp.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 68:         [",
                "// Line 69:             'headerUserControlPanel' => Translation::get('headerUserControlPanel'),",
                "// Line 70:             'ucpGravatarImage' => $gravatarImg,",
                "// Line 71:             'userid' => $user->getUserId(),",
                "// Line 72:             'csrf' => Token::getInstance()->getTokenInput('ucp'),",
                "// Line 73:             'lang' => $Language->getLanguage(),",
                "// Line 74:             'readonly' => $user->isLocalUser() ? '' : 'readonly disabled',",
                "// Line 75:             'msgRealName' => Translation::get('ad_user_name'),",
                "// Line 76:             'realname' => Strings::htmlentities($user->getUserData('display_name')),",
                "// Line 77:             'msgEmail' => Translation::get('msgNewContentMail'),",
                "// vulnerable line: 78: 'email' => $user->getUserData('email'),",
                "// Line 79:             'msgIsVisible' => Translation::get('ad_user_data_is_visible'),",
                "// Line 80:             'checked' => (int)$user->getUserData('is_visible') === 1 ? 'checked' : '',",
                "// Line 81:             'msgPassword' => Translation::get('ad_auth_passwd'),",
                "// Line 82:             'msgConfirm' => Translation::get('ad_user_confirm'),",
                "// Line 83:             'msgSave' => Translation::get('msgSave'),",
                "// Line 84:             'msgCancel' => Translation::get('msgCancel'),",
                "// Line 85:             'checked_twofactor_enabled' => (int)$user->getUserData('twofactor_enabled') === 1 ? 'checked' : '',",
                "// Line 86:             'msgTwofactorEnabled' => Translation::get('msgTwofactorEnabled'),",
                "// Line 87:             'msgTwofactorConfig' => Translation::get('msgTwofactorConfig'),",
                "// Line 88:             'msgTwofactorConfigModelTitle' => Translation::get('msgTwofactorConfigModelTitle'),"
            ]
        },
        {
            "filename_of_changes": "ucp.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 71:             'msgGravatar' => Translation::get('msgGravatar'),",
                "// Line 72:             'ucpGravatarImage' => $gravatarImg,",
                "// Line 73:             'msgHeaderUserData' => Translation::get('headerUserControlPanel'),",
                "// Line 74:             'userid' => $user->getUserId(),",
                "// Line 75:             'csrf' => Token::getInstance()->getTokenInput('ucp'),",
                "// Line 76:             'lang' => $Language->getLanguage(),",
                "// Line 77:             'readonly' => $user->isLocalUser() ? '' : 'readonly disabled',",
                "// Line 78:             'msgRealName' => Translation::get('ad_user_name'),",
                "// Line 79:             'realname' => Strings::htmlentities($user->getUserData('display_name')),",
                "// Line 80:             'msgEmail' => Translation::get('msgNewContentMail'),",
                "// vulnerable line: 81: 'email' => $user->getUserData('email'),",
                "// Line 82:             'msgIsVisible' => Translation::get('ad_user_data_is_visible'),",
                "// Line 83:             'checked' => (int)$user->getUserData('is_visible') === 1 ? 'checked' : '',",
                "// Line 84:             'msgPassword' => Translation::get('ad_auth_passwd'),",
                "// Line 85:             'msgConfirm' => Translation::get('ad_user_confirm'),",
                "// Line 86:             'msgSave' => Translation::get('msgSave'),",
                "// Line 87:             'msgCancel' => Translation::get('msgCancel'),",
                "// Line 88:             'checked_twofactor_enabled' => (int)$user->getUserData('twofactor_enabled') === 1 ? 'checked' : '',",
                "// Line 89:             'msgTwofactorEnabled' => Translation::get('msgTwofactorEnabled'),",
                "// Line 90:             'msgTwofactorConfig' => Translation::get('msgTwofactorConfig'),",
                "// Line 91:             'msgTwofactorConfigModelTitle' => Translation::get('msgTwofactorConfigModelTitle'),"
            ]
        },
        {
            "filename_of_changes": "user.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 565:                     ?> icon_user_id_<?= $user->getUserId() ?>\"></i></td>",
                "// Line 566:                     <td class=\"text-center\">",
                "// Line 567:                         <i class=\"fa <?= $user->isSuperAdmin() ? 'fa-user-secret' : 'fa-user-times' ?>\"></i>",
                "// Line 568:                     </td>",
                "// Line 569:                     <td class=\"text-center\">",
                "// Line 570:                         <i class=\"fa <?= $user->getUserData('is_visible') ? 'fa-user' : 'fa-user-o' ?>\"></i>",
                "// Line 571:                     </td>",
                "// Line 572:                     <td><?= Strings::htmlentities($user->getUserData('display_name')) ?></td>",
                "// Line 573:                     <td><?= Strings::htmlentities($user->getLogin()) ?></td>",
                "// Line 574:                     <td>",
                "// vulnerable line: 575: <a href=\"mailto:<?= $user->getUserData('email') ?>\">",
                "// vulnerable line: 576: <?= $user->getUserData('email') ?>",
                "// Line 577:                         </a>",
                "// Line 578:                     </td>",
                "// Line 579:                     <td>",
                "// Line 580:                         <a href=\"?action=user&amp;user_id=<?= $user->getUserData('user_id') ?>\"",
                "// Line 581:                            class=\"btn btn-sm btn-info\">",
                "// Line 582:                             <i class=\"fa fa-pencil\"></i> <?= Translation::get('ad_user_edit') ?>",
                "// Line 583:                         </a>",
                "// Line 584:                     </td>",
                "// Line 585:                     <td>",
                "// Line 586:                         <?php"
            ]
        },
        {
            "filename_of_changes": "user.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 566:                 ++$counter;",
                "// Line 567:             if ($counter <= $firstPage) {",
                "// Line 568:                 continue;",
                "// Line 569:             }",
                "// Line 570:                 ++$displayedCounter;",
                "// Line 571: ",
                "// Line 572:             ?>",
                "// Line 573:                 <tr class=\"row_user_id_<?= $user->getUserId() ?>\">",
                "// Line 574:                     <td><?= Strings::htmlentities($user->getUserData('display_name')) ?></td>",
                "// Line 575:                     <td>",
                "// vulnerable line: 576: <a href=\"mailto:<?= $user->getUserData('email') ?>\">",
                "// vulnerable line: 577: <?= $user->getUserData('email') ?>",
                "// Line 578:                         </a>",
                "// Line 579:                     </td>",
                "// Line 580:                     <td><?= Strings::htmlentities($user->getLogin()) ?></td>",
                "// Line 581: ",
                "// Line 582:                     <td class=\"text-center\"><i class=\"fa <?php",
                "// Line 583:                     switch ($user->getStatus()) {",
                "// Line 584:                         case 'active':",
                "// Line 585:                             echo 'bi-person-fill-check text-success';",
                "// Line 586:                             break;",
                "// Line 587:                         case 'blocked':"
            ]
        }
    ]
}