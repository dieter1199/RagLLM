{
    "cve_id": "CVE-2024-6387",
    "cve_description": "A security regression (CVE-2006-5051) was discovered in OpenSSH's server (sshd). There is a race condition which can lead sshd to handle some signals in an unsafe manner. An unauthenticated, remote attacker may be able to trigger it by failing to authenticate within a set time period.",
    "cve_publish_date": "2024-07-01T13:15Z",
    "cwe_id": "CWE-362",
    "cwe_name": "Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition')",
    "cwe_description": "The product contains a code sequence that can run concurrently with other code, and the code sequence requires temporary, exclusive access to a shared resource, but a timing window exists in which the shared resource can be modified by another code sequence that is operating concurrently.",
    "commit_message": "import openssh-8.7p1-38.el9_4.1",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "openssh.spec",
            "code_language": "Shell",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 47: ",
                "// Line 48: # Do not forget to bump pam_ssh_agent_auth release if you rewind the main package release to 1",
                "// Line 49: %global openssh_ver 8.7p1",
                "// Line 50: %global openssh_rel 38",
                "// Line 51: %global pam_ssh_agent_ver 0.10.4",
                "// Line 52: %global pam_ssh_agent_rel 5",
                "// Line 53: ",
                "// Line 54: Summary: An open source implementation of SSH protocol version 2",
                "// Line 55: Name: openssh",
                "// Line 56: Version: %{openssh_ver}",
                "// vulnerable line: 57: Release: %{openssh_rel}%{?dist}",
                "// Line 58: URL: http://www.openssh.com/portable.html",
                "// Line 59: #URL1: https://github.com/jbeverly/pam_ssh_agent_auth/",
                "// Line 60: Source0: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz",
                "// Line 61: Source1: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz.asc",
                "// Line 62: Source2: sshd.pam",
                "// Line 63: Source3: gpgkey-736060BA.gpg",
                "// Line 64: Source4: https://github.com/jbeverly/pam_ssh_agent_auth/archive/pam_ssh_agent_auth-%{pam_ssh_agent_ver}.tar.gz",
                "// Line 65: Source5: pam_ssh_agent-rmheaders",
                "// Line 66: Source6: ssh-keycat.pam",
                "// Line 67: Source7: sshd.sysconfig",
                "// Line 355: Summary: A passphrase dialog for OpenSSH and X",
                "// Line 356: Requires: openssh = %{version}-%{release}",
                "// Line 357: ",
                "// Line 358: %package sk-dummy",
                "// Line 359: Summary: OpenSSH SK driver for test purposes",
                "// Line 360: Requires: openssh = %{version}-%{release}",
                "// Line 361: ",
                "// Line 362: %package -n pam_ssh_agent_auth",
                "// Line 363: Summary: PAM module for authentication with ssh-agent",
                "// Line 364: Version: %{pam_ssh_agent_ver}",
                "// vulnerable line: 365: Release: %{pam_ssh_agent_rel}.%{openssh_rel}%{?dist}",
                "// Line 366: License: BSD",
                "// Line 367: ",
                "// Line 368: %description",
                "// Line 369: SSH (Secure SHell) is a program for logging into and executing",
                "// Line 370: commands on a remote machine. SSH is intended to replace rlogin and",
                "// Line 371: rsh, and to provide secure encrypted communications between two",
                "// Line 372: untrusted hosts over an insecure network. X11 connections and",
                "// Line 373: arbitrary TCP/IP ports can also be forwarded over the secure channel.",
                "// Line 374: ",
                "// Line 375: OpenSSH is OpenBSD's version of the last free version of SSH, bringing"
            ]
        }
    ]
}