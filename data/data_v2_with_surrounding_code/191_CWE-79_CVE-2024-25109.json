{
    "cve_id": "CVE-2024-25109",
    "cve_description": "ManageWiki is a MediaWiki extension allowing users to manage wikis. Special:ManageWiki does not escape escape interface messages on the `columns` and `help` keys on the form descriptor. An attacker may exploit this and would have a cross site scripting attack vector. Exploiting this on-wiki requires the `(editinterface)` right. Users should apply the code changes in commits `886cc6b94`, `2ef0f50880`, and `6942e8b2c` to resolve this vulnerability. There are no known workarounds for this vulnerability.",
    "cve_publish_date": "2024-02-09T23:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Escape some more interface messages",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ManageWikiFormFactoryBuilder.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "5",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 663:                 'help' => htmlspecialchars( User::getRightDescription( $perm ) ),",
                "// Line 664:                 'section' => ( $assigned ) ? 'assigned' : 'unassigned',",
                "// Line 665:                 'default' => $assigned,",
                "// Line 666:                 'disabled' => !$ceMW",
                "// Line 667:             ];",
                "// Line 668:         }",
                "// Line 669: ",
                "// Line 670:         $rowsBuilt = [];",
                "// Line 671: ",
                "// Line 672:         foreach ( $groupData['allGroups'] as $group ) {",
                "// vulnerable line: 673: $rowsBuilt[UserGroupMembership::getGroupName( $group )] = $group;",
                "// Line 674:         }",
                "// Line 675: ",
                "// Line 676:         $formDescriptor['group-matrix'] = [",
                "// Line 677:             'type' => 'checkmatrix',",
                "// Line 678:             'columns' => [",
                "// vulnerable line: 679: wfMessage( 'managewiki-permissions-addall' )->text() => 'wgAddGroups',",
                "// vulnerable line: 680: wfMessage( 'managewiki-permissions-removeall' )->text() => 'wgRemoveGroups',",
                "// vulnerable line: 681: wfMessage( 'managewiki-permissions-addself' )->text() => 'wgGroupsAddToSelf',",
                "// vulnerable line: 682: wfMessage( 'managewiki-permissions-removeself' )->text() => 'wgGroupsRemoveFromSelf'",
                "// Line 683:             ],",
                "// Line 684:             'rows' => $rowsBuilt,",
                "// Line 685:             'section' => 'group',",
                "// Line 686:             'default' => $groupData['groupMatrix'],",
                "// Line 687:             'disabled' => !$ceMW",
                "// Line 688:         ];",
                "// Line 689: ",
                "// Line 690:         // This is not a good method but it is a method.",
                "// Line 691:         $aP = $groupData['autopromote'];",
                "// Line 692:         $aPArray = [];"
            ]
        }
    ]
}