{
    "cve_id": "CVE-2011-10006",
    "cve_description": "A vulnerability was found in GamerZ WP-PostRatings up to 1.64. It has been classified as problematic. This affects an unknown part of the file wp-postratings.php. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.65 is able to address this issue. The identifier of the patch is 6182a5682b12369ced0becd3b505439ce2eb8132. It is recommended to upgrade the affected component. The identifier VDB-259629 was assigned to this vulnerability.",
    "cve_publish_date": "2024-04-08T13:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Fixed XSS + Increment version number\n\ngit-svn-id: https://plugins.svn.wordpress.org/wp-postratings/trunk@346735 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "postratings-admin-ajax.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Post Ratings AJAX For Admin Backend                                    |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-admin-ajax.php    |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "postratings-manager.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Manage Post Ratings Logs                                                    |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-manager.php        |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "postratings-options.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Configure Post Ratings Options                                                |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-options.php        |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "postratings-stats.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Containts Post Rating Stats                                                     |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-stats.php            |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "postratings-templates.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Configure Post Ratings Options                                                |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-options.php        |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "postratings-uninstall.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: +----------------------------------------------------------------+",
                "// Line 4: |                                                                                            |",
                "// vulnerable line: 5: |    WordPress 2.8 Plugin: WP-PostRatings 1.60                                |",
                "// Line 6: |    Copyright (c) 2009 Lester \"GaMerZ\" Chan                                    |",
                "// Line 7: |                                                                                            |",
                "// Line 8: |    File Written By:                                                                    |",
                "// Line 9: |    - Lester \"GaMerZ\" Chan                                                            |",
                "// Line 10: |    - http://lesterchan.net                                                            |",
                "// Line 11: |                                                                                            |",
                "// Line 12: |    File Information:                                                                    |",
                "// Line 13: |    - Uninstall WP-PostRatings                                                        |",
                "// Line 14: |    - wp-content/plugins/wp-postratings/postratings-uninstall.php        |",
                "// Line 15: |                                                                                            |"
            ]
        },
        {
            "filename_of_changes": "wp-postratings.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "3",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: <?php",
                "// Line 2: /*",
                "// Line 3: Plugin Name: WP-PostRatings",
                "// Line 4: Plugin URI: http://lesterchan.net/portfolio/programming/php/",
                "// Line 5: Description: Adds an AJAX rating system for your WordPress blog's post/page.",
                "// vulnerable line: 6: Version: 1.60",
                "// Line 7: Author: Lester 'GaMerZ' Chan",
                "// Line 8: Author URI: http://lesterchan.net",
                "// Line 9: */",
                "// Line 10: ",
                "// Line 11: ",
                "// Line 12: /* ",
                "// Line 13:     Copyright 2009  Lester Chan  (email : lesterchan@gmail.com)",
                "// Line 14: ",
                "// Line 15:     This program is free software; you can redistribute it and/or modify",
                "// Line 16:     it under the terms of the GNU General Public License as published by",
                "// Line 90:         $loading = '';",
                "// Line 91:     }",
                "// Line 92:     // Check To See Whether User Has Voted",
                "// Line 93:     $user_voted = check_rated($ratings_id);",
                "// Line 94:     // If User Voted Or Is Not Allowed To Rate",
                "// Line 95:     if($user_voted) {",
                "// Line 96:         if(!$display) {",
                "// Line 97:             return \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_results($ratings_id).'</'.$start_tag.'>'.$loading;",
                "// Line 98:         } else {",
                "// Line 99:             echo \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_results($ratings_id).'</'.$start_tag.'>'.$loading;",
                "// vulnerable line: 100: return;",
                "// Line 101:         }",
                "// Line 102:     // If User Is Not Allowed To Rate",
                "// Line 103:     } else if(!check_allowtorate()) {",
                "// Line 104:         if(!$display) {",
                "// Line 105:             return \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_results($ratings_id, 0, 0, 0, 1).'</'.$start_tag.'>'.$loading;",
                "// Line 106:         } else {",
                "// Line 107:             echo \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_results($ratings_id, 0, 0, 0, 1).'</'.$start_tag.'>'.$loading;",
                "// vulnerable line: 108: return;",
                "// Line 109:         }",
                "// Line 110:     // If User Has Not Voted",
                "// Line 111:     } else {",
                "// Line 112:         if(!$display) {",
                "// Line 113:             return \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_vote($ratings_id).'</'.$start_tag.'>'.$loading;",
                "// Line 114:         } else {",
                "// Line 115:             echo \"<$start_tag id=\"post-ratings-$ratings_id\" class=\"post-ratings\">\".the_ratings_vote($ratings_id).'</'.$start_tag.'>'.$loading;",
                "// vulnerable line: 116: return;",
                "// Line 117:         }",
                "// Line 118:     }",
                "// Line 119: }",
                "// Line 120: ",
                "// Line 121: ",
                "// Line 122: ### Function: Print Out jQuery Script At The Top",
                "// Line 123: add_action('wp_head', 'ratings_javascripts_header');",
                "// Line 124: function ratings_javascripts_header() {",
                "// Line 125:     wp_print_scripts('jquery');",
                "// Line 126: }",
                "// Line 562: function process_ratings() {",
                "// Line 563:     global $wpdb, $user_identity, $user_ID;",
                "// Line 564:     $rate = intval($_GET['rate']);",
                "// Line 565:     $post_id = intval($_GET['pid']);",
                "// Line 566:     if($rate > 0 && $post_id > 0 && check_allowtorate()) {        ",
                "// Line 567:         // Check For Bot",
                "// Line 568:         $bots_useragent = array('googlebot', 'google', 'msnbot', 'ia_archiver', 'lycos', 'jeeves', 'scooter', 'fast-webcrawler', 'slurp@inktomi', 'turnitinbot', 'technorati', 'yahoo', 'findexa', 'findlinks', 'gaisbo', 'zyborg', 'surveybot', 'bloglines', 'blogsearch', 'ubsub', 'syndic8', 'userland', 'gigabot', 'become.com');",
                "// Line 569:         $useragent = $_SERVER['HTTP_USER_AGENT'];",
                "// Line 570:         foreach ($bots_useragent as $bot) { ",
                "// Line 571:             if (stristr($useragent, $bot) !== false) {",
                "// vulnerable line: 572: return;",
                "// Line 573:             } ",
                "// Line 574:         }",
                "// Line 575:         header('Content-Type: text/html; charset='.get_option('blog_charset').'');",
                "// Line 576:         postratings_textdomain();",
                "// Line 577:         $rated = check_rated($post_id);",
                "// Line 578:         // Check Whether Post Has Been Rated By User",
                "// Line 579:         if(!$rated) {",
                "// Line 580:             // Check Whether Is There A Valid Post",
                "// Line 581:             $post = get_post($post_id);",
                "// Line 582:             // If Valid Post Then We Rate It",
                "// Line 734: }",
                "// Line 735: ",
                "// Line 736: ",
                "// Line 737: ### Function: Plug Into WP-Stats",
                "// Line 738: if(strpos(get_option('stats_url'), $_SERVER['REQUEST_URI']) || strpos($_SERVER['REQUEST_URI'], 'stats-options.php') || strpos($_SERVER['REQUEST_URI'], 'wp-stats/wp-stats.php')) {",
                "// Line 739:     add_filter('wp_stats_page_admin_plugins', 'postratings_page_admin_general_stats');",
                "// Line 740:     add_filter('wp_stats_page_admin_most', 'postratings_page_admin_most_stats');",
                "// Line 741:     add_filter('wp_stats_page_plugins', 'postratings_page_general_stats');",
                "// Line 742:     add_filter('wp_stats_page_most', 'postratings_page_most_stats');",
                "// Line 743: }",
                "// vulnerable line: 744: if ($_SERVER['PHP_SELF'] == @links_add_base_url(\"/\", $_SERVER['HTTP_REFERER'])) ",
                "// vulnerable line: 745: return;",
                "// Line 746: ",
                "// Line 747: ### Function: Add WP-PostRatings General Stats To WP-Stats Page Options",
                "// Line 748: function postratings_page_admin_general_stats($content) {",
                "// Line 749:     $stats_display = get_option('stats_display');",
                "// Line 750:     if($stats_display['ratings'] == 1) {",
                "// Line 751:         $content .= '<input type=\"checkbox\" name=\"stats_display[]\" id=\"wpstats_ratings\" value=\"ratings\" checked=\"checked\" />&nbsp;&nbsp;<label for=\"wpstats_ratings\">'.__('WP-PostRatings', 'wp-postratings').'</label><br />'.\"",
                "// Line 752: \";",
                "// Line 753:     } else {",
                "// Line 754:         $content .= '<input type=\"checkbox\" name=\"stats_display[]\" id=\"wpstats_ratings\" value=\"ratings\" />&nbsp;&nbsp;<label for=\"wpstats_ratings\">'.__('WP-PostRatings', 'wp-postratings').'</label><br />'.\"",
                "// Line 755: \";"
            ]
        }
    ]
}