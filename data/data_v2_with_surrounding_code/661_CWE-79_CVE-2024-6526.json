{
    "cve_id": "CVE-2024-6526",
    "cve_description": "A vulnerability classified as problematic has been found in CodeIgniter Ecommerce-CodeIgniter-Bootstrap up to 1998845073cf433bc6c250b0354461fbd84d0e03. This affects an unknown part. The manipulation of the argument search_title/catName/sub/name/categorie leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The identifier of the patch is 1b3da45308bb6c3f55247d0e99620b600bd85277. It is recommended to apply a patch to fix this issue. The identifier VDB-270369 was assigned to this vulnerability.",
    "cve_publish_date": "2024-07-05T14:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Multiples xss in the application request to open a CVE #263",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "footer.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 12:                         <li><a href=\"<?= base_url() ?>\">» <?= lang('home') ?> </a></li>",
                "// Line 13:                         <li><a href=\"<?= LANG_URL . '/checkout' ?>\">» <?= lang('checkout') ?> </a></li>",
                "// Line 14:                         <li><a href=\"<?= LANG_URL . '/contacts' ?>\">» <?= lang('contacts') ?> </a></li>",
                "// Line 15:                     </ul>",
                "// Line 16:                 </div>",
                "// Line 17:                 <div class=\"col-lg-2  col-md-2 col-sm-4 col-xs-6 f-col\">",
                "// Line 18:                     <h3><?= lang('categories') ?></h3>",
                "// Line 19:                     <?php if (!empty($footerCategories)) { ?>",
                "// Line 20:                         <ul>",
                "// Line 21:                             <?php foreach ($footerCategories as $key => $categorie) { ?>",
                "// vulnerable line: 22: <li><a href=\"javascript:void(0);\" data-categorie-id=\"<?= $key ?>\" class=\"go-category\"><?= $categorie ?></a></li>",
                "// Line 23:                             <?php } ?>",
                "// Line 24:                         </ul>",
                "// Line 25:                     <?php } else { ?>",
                "// Line 26:                         <p><?= lang('no_categories') ?></p>",
                "// Line 27:                     <?php } ?>",
                "// Line 28:                 </div>",
                "// Line 29:                 <div class=\"col-lg-2  col-md-2 col-sm-4 col-xs-6 f-col\">",
                "// Line 30:                     <h3><?= lang('contacts') ?></h3>",
                "// Line 31:                     <ul class=\"footer-icon\">",
                "// Line 32:                         <?php if ($footerContactAddr != '') { ?>"
            ]
        },
        {
            "filename_of_changes": "footer.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 12:                         <li><a href=\"<?= base_url() ?>\">» <?= lang('home') ?> </a></li>",
                "// Line 13:                         <li><a href=\"<?= LANG_URL . '/checkout' ?>\">» <?= lang('checkout') ?> </a></li>",
                "// Line 14:                         <li><a href=\"<?= LANG_URL . '/contacts' ?>\">» <?= lang('contacts') ?> </a></li>",
                "// Line 15:                     </ul>",
                "// Line 16:                 </div>",
                "// Line 17:                 <div class=\"col-lg-2  col-md-2 col-sm-4 col-xs-6 f-col\">",
                "// Line 18:                     <h3><?= lang('categories') ?></h3>",
                "// Line 19:                     <?php if (!empty($footerCategories)) { ?>",
                "// Line 20:                         <ul>",
                "// Line 21:                             <?php foreach ($footerCategories as $key => $categorie) { ?>",
                "// vulnerable line: 22: <li><a href=\"javascript:void(0);\" data-categorie-id=\"<?= $key ?>\" class=\"go-category\"><?= $categorie ?></a></li>",
                "// Line 23:                             <?php } ?>",
                "// Line 24:                         </ul>",
                "// Line 25:                     <?php } else { ?>",
                "// Line 26:                         <p><?= lang('no_categories') ?></p>",
                "// Line 27:                     <?php } ?>",
                "// Line 28:                 </div>",
                "// Line 29:                 <div class=\"col-lg-2  col-md-2 col-sm-4 col-xs-6 f-col\">",
                "// Line 30:                     <h3><?= lang('contacts') ?></h3>",
                "// Line 31:                     <ul class=\"footer-icon\">",
                "// Line 32:                         <?php if ($footerContactAddr != '') { ?>"
            ]
        },
        {
            "filename_of_changes": "header.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 162:                                                     ?>",
                "// Line 163:                                                     <span>",
                "// Line 164:                                                         <?php",
                "// Line 165:                                                     }",
                "// Line 166:                                                     foreach ($nav_categories as $nav_category) {",
                "// Line 167:                                                         $children = false;",
                "// Line 168:                                                         if (isset($nav_category['children']) && !empty($nav_category['children'])) {",
                "// Line 169:                                                             $children = true;",
                "// Line 170:                                                         }",
                "// Line 171:                                                         ?> ",
                "// vulnerable line: 172: <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $nav_category['id'] ?>\" class=\"go-category <?= $children == true ? 'mega-title' : '' ?>\"><?= $nav_category['name'] ?></a>",
                "// Line 173:                                                         <?php",
                "// Line 174:                                                         if ($children === true) {",
                "// Line 175:                                                             loop_tree_nav($nav_category['children'], true);",
                "// Line 176:                                                         }",
                "// Line 177:                                                     }",
                "// Line 178:                                                     if ($is_recursion == false) {",
                "// Line 179:                                                         ?>",
                "// Line 180:                                                     </span>",
                "// Line 181:                                                     <?php",
                "// Line 182:                                                 }"
            ]
        },
        {
            "filename_of_changes": "home.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 90:             <span class=\"hidde-sp\"><?= lang('hideXsNav') ?><i class=\"fa fa-arrow-circle-o-up\" aria-hidden=\"true\"></i></span>",
                "// Line 91:         </a>",
                "// Line 92:         <div class=\"categories\">",
                "// Line 93:             <?php if (!empty($arrCategories)) { ?>",
                "// Line 94:                 <ul class=\"list\">",
                "// Line 95:                     <?php",
                "// Line 96:                     foreach ($arrCategories as $categorie) {",
                "// Line 97:                         ?>",
                "// Line 98:                         <li>",
                "// Line 99:                             <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $categorie['id'] ?>\" class=\"go-category left-side <?= isset($_GET['category']) && $_GET['category'] == $categorie['id'] ? 'selected' : '' ?>\">",
                "// vulnerable line: 100: <span><?= $categorie['name'] ?></span>",
                "// Line 101:                                 <i class=\"fa fa-angle-double-down\" aria-hidden=\"true\"></i>",
                "// Line 102:                             </a>",
                "// Line 103:                         </li>",
                "// Line 104:                         <?php",
                "// Line 105:                     }",
                "// Line 106:                     ?>",
                "// Line 107:                 </ul>",
                "// Line 108:             <?php } else { ?>",
                "// Line 109:                 <div class=\"alert alert-info\"><?= lang('no_sub_categories') ?></div>",
                "// Line 110:             <?php } ?>"
            ]
        },
        {
            "filename_of_changes": "home.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 97:                                 }",
                "// Line 98:                                 ?>",
                "// Line 99:                                 <li>",
                "// Line 100:                                     <?php if ($children === true) {",
                "// Line 101:                                         ?>",
                "// Line 102:                                         <i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>",
                "// Line 103:                                     <?php } else { ?>",
                "// Line 104:                                         <i class=\"fa fa-circle-o\" aria-hidden=\"true\"></i>",
                "// Line 105:                                     <?php } ?>",
                "// Line 106:                                     <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $page['id'] ?>\" class=\"go-category left-side <?= isset($_GET['category']) && $_GET['category'] == $page['id'] ? 'selected' : '' ?>\">",
                "// vulnerable line: 107: <?= $page['name'] ?>",
                "// Line 108:                                     </a>",
                "// Line 109:                                     <?php",
                "// Line 110:                                     if ($children === true) {",
                "// Line 111:                                         loop_tree($page['children'], true);",
                "// Line 112:                                     } else {",
                "// Line 113:                                         ?>",
                "// Line 114:                                     </li>",
                "// Line 115:                                     <?php",
                "// Line 116:                                 }",
                "// Line 117:                             }"
            ]
        },
        {
            "filename_of_changes": "listVendors.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 12:                         <th>#ID</th>",
                "// Line 13:                         <th>Name</th>",
                "// Line 14:                         <th>Email</th>",
                "// Line 15:                         <th>Sold products amount</th>",
                "// Line 16:                         <th>Created At</th>",
                "// Line 17:                     </tr>",
                "// Line 18:                 </thead>",
                "// Line 19:                 <?php foreach ($vendors->result() as $vendor) { ?>",
                "// Line 20:                     <tr>",
                "// Line 21:                         <td><?= $vendor->id ?></td>",
                "// vulnerable line: 22: <td><?= isset($vendor->name) ? $vendor->name : 'Vendor name is empty' ?></td>",
                "// Line 23:                         <td><?= $vendor->email ?></td>",
                "// Line 24:                         <td>",
                "// Line 25:                             <?php",
                "// Line 26:                              $orders = $controller->getVendorOrders($vendor->id); ",
                "// Line 27:                              if(!count($orders)) {",
                "// Line 28:                                 ?>",
                "// Line 29:                                 <span class=\"label label-danger\">No orders</span>",
                "// Line 30:                                 <?php",
                "// Line 31:                              } else {",
                "// Line 32:                                 $countSales = 0;",
                "// Line 33:                                 foreach($orders as $order) {",
                "// vulnerable line: 34: $product = unserialize($order['products']);",
                "// Line 35:                                     foreach ($product as $key => $value) {",
                "// Line 36:                                         $countSales += (int)$value;",
                "// Line 37:                                     }",
                "// Line 38:                                 ?>",
                "// Line 39:                                 <span class=\"label label-success\"><?= $countSales ?></span>",
                "// Line 40:                             <?php }",
                "// Line 41:                              }",
                "// Line 42:                             ?>    ",
                "// Line 43:                         </td>",
                "// Line 44:                         <td><?= $vendor->created_at ?></td>"
            ]
        },
        {
            "filename_of_changes": "products.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 27:                             <select name=\"order_by\" class=\"form-control selectpicker change-products-form\">",
                "// Line 28:                                 <option <?= isset($_GET['order_by']) && $_GET['order_by'] == 'id=desc' ? 'selected=\"\"' : '' ?> value=\"id=desc\">Newest</option>",
                "// Line 29:                                 <option <?= isset($_GET['order_by']) && $_GET['order_by'] == 'id=asc' ? 'selected=\"\"' : '' ?> value=\"id=asc\">Latest</option>",
                "// Line 30:                                 <option <?= isset($_GET['order_by']) && $_GET['order_by'] == 'quantity=asc' ? 'selected=\"\"' : '' ?> value=\"quantity=asc\">Low Quantity</option>",
                "// Line 31:                                 <option <?= isset($_GET['order_by']) && $_GET['order_by'] == 'quantity=desc' ? 'selected=\"\"' : '' ?> value=\"quantity=desc\">High Quantity</option>",
                "// Line 32:                             </select>",
                "// Line 33:                         </div>",
                "// Line 34:                         <div class=\"col-sm-4\">",
                "// Line 35:                             <label>Title:</label>",
                "// Line 36:                             <div class=\"input-group\">",
                "// vulnerable line: 37: <input class=\"form-control\" placeholder=\"Product Title\" type=\"text\" value=\"<?= isset($_GET['search_title']) ? $_GET['search_title'] : '' ?>\" name=\"search_title\">",
                "// Line 38:                                 <span class=\"input-group-btn\">",
                "// Line 39:                                     <button class=\"btn btn-default\" type=\"submit\" value=\"\">",
                "// Line 40:                                         <i class=\"fa fa-search\"></i>",
                "// Line 41:                                     </button>",
                "// Line 42:                                 </span>",
                "// Line 43:                             </div>",
                "// Line 44:                         </div>",
                "// Line 45:                         <div class=\"col-sm-4\">",
                "// Line 46:                             <label>Category:</label>",
                "// Line 47:                             <select name=\"category\" class=\"form-control selectpicker change-products-form\">"
            ]
        },
        {
            "filename_of_changes": "shop.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 37:                                     }",
                "// Line 38:                                     ?>",
                "// Line 39:                                     <li>",
                "// Line 40:                                         <?php if ($children === true) {",
                "// Line 41:                                             ?>",
                "// Line 42:                                             <i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>",
                "// Line 43:                                         <?php } else { ?>",
                "// Line 44:                                             <i class=\"fa fa-circle-o\" aria-hidden=\"true\"></i>",
                "// Line 45:                                         <?php } ?>",
                "// Line 46:                                         <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $page['id'] ?>\" class=\"go-category left-side <?= isset($_GET['category']) && $_GET['category'] == $page['id'] ? 'selected' : '' ?>\">",
                "// vulnerable line: 47: <?= $page['name'] ?>",
                "// Line 48:                                         </a>",
                "// Line 49:                                         <?php",
                "// Line 50:                                         if ($children === true) {",
                "// Line 51:                                             loop_tree($page['children'], true);",
                "// Line 52:                                         } else {",
                "// Line 53:                                             ?>",
                "// Line 54:                                         </li>",
                "// Line 55:                                         <?php",
                "// Line 56:                                     }",
                "// Line 57:                                 }"
            ]
        },
        {
            "filename_of_changes": "shopcategories.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "4",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 44:                                 . '<a href=\"javascript:void(0);\" class=\"editCategorie\" data-indic=\"' . $i . '\" data-for-id=\"' . $key_cat . '\" data-abbr=\"' . $ff['abbr'] . '\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"Edit this categorie\">'",
                "// Line 45:                                 . '<i class=\"fa fa-pencil\" aria-hidden=\"true\"></i>'",
                "// Line 46:                                 . '</a> '",
                "// Line 47:                                 . '[' . $ff['abbr'] . ']<span id=\"indic-' . $i . '\">' . $ff['name'] . '</span>'",
                "// Line 48:                                 . '</div>';",
                "// Line 49:                         $i++;",
                "// Line 50:                     }",
                "// Line 51:                     ?>",
                "// Line 52:                     <tr>",
                "// Line 53:                         <td><?= $key_cat ?></td>",
                "// vulnerable line: 54: <td><?= $catName ?></td>",
                "// Line 55:                         <td> ",
                "// Line 56:                             <a href=\"javascript:void(0);\" class=\"editCategorieSub\" data-sub-for-id=\"<?= $key_cat ?>\">",
                "// Line 57:                                 <i class=\"fa fa-pencil\" aria-hidden=\"true\"></i>",
                "// Line 58:                             </a>",
                "// Line 59:                             <?php foreach ($shop_categorie['sub'] as $sub) { ?>",
                "// vulnerable line: 60: <div> <?= $sub ?> </div>",
                "// Line 61:                             <?php } ?>",
                "// Line 62:                         </td>",
                "// Line 63:                         <td>",
                "// Line 64:                             <a href=\"javascript:void(0);\" class=\"editPosition\" data-position-for-id=\"<?= $key_cat ?>\" data-my-position=\"<?= $shop_categorie['position'] ?>\">",
                "// Line 65:                                 <i class=\"fa fa-pencil\" aria-hidden=\"true\"></i>",
                "// Line 66:                             </a>",
                "// Line 67:                             <span id=\"position-<?= $key_cat ?>\"><?= $shop_categorie['position'] ?></span>",
                "// Line 68:                         </td>",
                "// Line 69:                         <td class=\"text-center\">",
                "// Line 70:                             <a href=\"<?= base_url('admin/shopcategories/?delete=' . $key_cat) ?>\" class=\"btn btn-danger btn-xs confirm-delete\"><span class=\"glyphicon glyphicon-remove\"></span> Del</a>",
                "// Line 102:                             </div>",
                "// Line 103:                         <?php } ?>",
                "// Line 104:                         <div class=\"form-group\">",
                "// Line 105:                             <label>Parent <sup>this categorie will be subcategorie of parent</sup>:</label>",
                "// Line 106:                             <select class=\"form-control\" name=\"sub_for\">",
                "// Line 107:                                 <option value=\"0\">None</option>",
                "// Line 108:                                 <?php",
                "// Line 109:                                 foreach ($shop_categories as $key_cat => $shop_categorie) {",
                "// Line 110:                                     $aa = '';",
                "// Line 111:                                     foreach ($shop_categorie['info'] as $ff) {",
                "// vulnerable line: 112: $aa .= '[' . $ff['abbr'] . ']' . $ff['name'] . '/';",
                "// Line 113:                                     }",
                "// Line 114:                                     ?>",
                "// Line 115:                                     <option value=\"<?= $key_cat ?>\"><?= $aa ?></option>",
                "// Line 116:                                 <?php } ?>",
                "// Line 117:                             </select>",
                "// Line 118:                         </div>",
                "// Line 119:                     </div>",
                "// Line 120:                     <div class=\"modal-footer\">",
                "// Line 121:                         <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancel</button>",
                "// Line 122:                         <button type=\"submit\" name=\"submit\" class=\"btn btn-primary\">Save</button>",
                "// Line 137: <div id=\"categorieSubEdit\">",
                "// Line 138:     <form method=\"POST\" id=\"categorieEditSubChanger\">",
                "// Line 139:         <input type=\"hidden\" name=\"editSubId\" value=\"\">",
                "// Line 140:         <select class=\"selectpicker\" name=\"newSubIs\">",
                "// Line 141:             <option value=\"\"></option>",
                "// Line 142:             <option value=\"0\">None</option>",
                "// Line 143:             <?php",
                "// Line 144:             foreach ($shop_categories as $key_cat => $shop_categorie) {",
                "// Line 145:                 $aa = '';",
                "// Line 146:                 foreach ($shop_categorie['info'] as $ff) {",
                "// vulnerable line: 147: $aa .= '[' . $ff['abbr'] . ']' . $ff['name'] . '/';",
                "// Line 148:                 }",
                "// Line 149:                 ?>",
                "// Line 150:                 <option value=\"<?= $key_cat ?>\"><?= $aa ?></option>",
                "// Line 151:             <?php } ?>",
                "// Line 152:         </select>",
                "// Line 153:     </form>",
                "// Line 154: </div>",
                "// Line 155: <div id=\"positionEditor\">",
                "// Line 156:     <input type=\"hidden\" name=\"positionEditId\" value=\"\">",
                "// Line 157:     <input type=\"text\" name=\"new_position\" class=\"form-control\" value=\"\">"
            ]
        },
        {
            "filename_of_changes": "vendor.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 29:             <span class=\"hidde-sp\"><?= lang('hideXsNav') ?><i class=\"fa fa-arrow-circle-o-up\" aria-hidden=\"true\"></i></span>",
                "// Line 30:         </a>",
                "// Line 31:         <div class=\"categories\">",
                "// Line 32:             <?php if (!empty($arrCategories)) { ?>",
                "// Line 33:                 <ul class=\"list\">",
                "// Line 34:                     <?php",
                "// Line 35:                     foreach ($arrCategories as $categorie) {",
                "// Line 36:                         ?>",
                "// Line 37:                         <li>",
                "// Line 38:                             <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $categorie['id'] ?>\" class=\"go-category left-side <?= isset($_GET['category']) && $_GET['category'] == $categorie['id'] ? 'selected' : '' ?>\">",
                "// vulnerable line: 39: <span><?= $categorie['name'] ?></span>",
                "// Line 40:                                 <i class=\"fa fa-angle-double-down\" aria-hidden=\"true\"></i>",
                "// Line 41:                             </a>",
                "// Line 42:                         </li>",
                "// Line 43:                         <?php",
                "// Line 44:                     }",
                "// Line 45:                     ?>",
                "// Line 46:                 </ul>",
                "// Line 47:             <?php } else { ?>",
                "// Line 48:                 <div class=\"alert alert-info\"><?= lang('no_sub_categories') ?></div>",
                "// Line 49:             <?php } ?>"
            ]
        },
        {
            "filename_of_changes": "vendor.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 31:                                 }",
                "// Line 32:                                 ?>",
                "// Line 33:                                 <li>",
                "// Line 34:                                     <?php if ($children === true) {",
                "// Line 35:                                         ?>",
                "// Line 36:                                         <i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>",
                "// Line 37:                                     <?php } else { ?>",
                "// Line 38:                                         <i class=\"fa fa-circle-o\" aria-hidden=\"true\"></i>",
                "// Line 39:                                     <?php } ?>",
                "// Line 40:                                     <a href=\"javascript:void(0);\" data-categorie-id=\"<?= $page['id'] ?>\" class=\"go-category left-side <?= isset($_GET['category']) && $_GET['category'] == $page['id'] ? 'selected' : '' ?>\">",
                "// vulnerable line: 41: <?= $page['name'] ?>",
                "// Line 42:                                     </a>",
                "// Line 43:                                     <?php",
                "// Line 44:                                     if ($children === true) {",
                "// Line 45:                                         loop_tree($page['children'], true);",
                "// Line 46:                                     } else {",
                "// Line 47:                                         ?>",
                "// Line 48:                                     </li>",
                "// Line 49:                                     <?php",
                "// Line 50:                                 }",
                "// Line 51:                             }"
            ]
        }
    ]
}