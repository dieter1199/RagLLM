{
    "cve_id": "CVE-2024-37407",
    "cve_description": "Libarchive before 3.7.4 allows name out-of-bounds access when a ZIP archive has an empty-name file and mac-ext is enabled. This occurs in slurp_central_directory in archive_read_support_format_zip.c.",
    "cve_publish_date": "2024-06-08T13:15Z",
    "cwe_id": "CWE-125",
    "cwe_name": "Out-of-bounds Read",
    "cwe_description": "The product reads data past the end, or before the beginning, of the intended buffer.",
    "commit_message": "zip: Fix out of boundary access (#2145)\n\nIf a ZIP file contains a file with an empty name and mac-ext option is\r\nset, then a check accesses memory out of bound of `name`.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "archive_read_support_format_zip.c",
            "code_language": "C",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 4089:                 }",
                "// Line 4090:             } else {",
                "// Line 4091:                 /* Generate resource fork name to find its",
                "// Line 4092:                  * resource file at zip->tree_rsrc. */",
                "// Line 4093: ",
                "// Line 4094:                 /* If this is an entry ending with slash,",
                "// Line 4095:                  * make the resource for name slash-less",
                "// Line 4096:                  * as the actual resource fork doesn't end with '/'.",
                "// Line 4097:                  */",
                "// Line 4098:                 size_t tmp_length = filename_length;",
                "// vulnerable line: 4099: if (name[tmp_length - 1] == '/') {",
                "// Line 4100:                     tmp_length--;",
                "// Line 4101:                     r = rsrc_basename(name, tmp_length);",
                "// Line 4102:                 }",
                "// Line 4103: ",
                "// Line 4104:                 archive_strcpy(&(zip_entry->rsrcname),",
                "// Line 4105:                     \"__MACOSX/\");",
                "// Line 4106:                 archive_strncat(&(zip_entry->rsrcname),",
                "// Line 4107:                     name, r - name);",
                "// Line 4108:                 archive_strcat(&(zip_entry->rsrcname), \"._\");",
                "// Line 4109:                 archive_strncat(&(zip_entry->rsrcname),"
            ]
        }
    ]
}