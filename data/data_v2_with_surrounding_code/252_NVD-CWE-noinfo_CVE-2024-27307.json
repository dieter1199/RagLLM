{
    "cve_id": "CVE-2024-27307",
    "cve_description": "JSONata is a JSON query and transformation language. Starting in version 1.4.0 and prior to version 1.8.7 and 2.0.4, a malicious expression can use the transform operator to override properties on the `Object` constructor and prototype. This may lead to denial of service, remote code execution or other unexpected behavior in applications that evaluate user-provided JSONata expressions. This issue has been fixed in JSONata versions 1.8.7 and 2.0.4. Applications that evaluate user-provided expressions should update ASAP to prevent exploitation. As a workaround, one may apply the patch manually.",
    "cve_publish_date": "2024-03-06T20:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Prevent access to __proto__\n\nSigned-off-by: andrew-coleman <andrew_coleman@uk.ibm.com>",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "implementation-tests.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "20",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "jsonata.js",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "9",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1532:                 throw {",
                "// Line 1533:                     code: \"T1006\",",
                "// Line 1534:                     stack: (new Error()).stack",
                "// Line 1535:                 };",
                "// Line 1536:             }",
                "// Line 1537:         } catch(err) {",
                "// Line 1538:             if(proc) {",
                "// Line 1539:                 if (typeof err.token == 'undefined' && typeof proc.token !== 'undefined') {",
                "// Line 1540:                     err.token = proc.token;",
                "// Line 1541:                 }",
                "// vulnerable line: 1542: err.position = proc.position;",
                "// Line 1543:             }",
                "// Line 1544:             throw err;",
                "// Line 1545:         }",
                "// Line 1546:         return result;",
                "// Line 1547:     }",
                "// Line 1548: ",
                "// Line 1549:     /**",
                "// Line 1550:      * Evaluate lambda against input data",
                "// Line 1551:      * @param {Object} expr - JSONata expression",
                "// Line 1552:      * @param {Object} input - Input data to evaluate against"
            ]
        }
    ]
}