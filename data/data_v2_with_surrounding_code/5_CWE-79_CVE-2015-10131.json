{
    "cve_id": "CVE-2015-10131",
    "cve_description": "A vulnerability was found in chrisy TFO Graphviz Plugin up to 1.9 on WordPress and classified as problematic. Affected by this issue is the function admin_page_load/admin_page of the file tfo-graphviz-admin.php. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 1.10 is able to address this issue. The name of the patch is 594c953a345f79e26003772093b0caafc14b92c2. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-258620.",
    "cve_publish_date": "2024-03-31T06:15Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "fix possible XSS vector\n\n\ngit-svn-id: https://plugins.svn.wordpress.org/tfo-graphviz/trunk@1166455 b8457f37-d9ea-0310-8a92-e5e31aec5664",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "tfo-graphviz-admin.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 91: ",
                "// Line 92:         add_action('admin_head', array(&$this, 'admin_head'));",
                "// Line 93: ",
                "// Line 94:         if (empty($_POST['tfo-graphviz'])) {",
                "// Line 95:             return;",
                "// Line 96:         }",
                "// Line 97: ",
                "// Line 98:         check_admin_referer('tfo-graphviz');",
                "// Line 99: ",
                "// Line 100:         if ($this->update(stripslashes_deep($_POST['tfo-graphviz']))) {",
                "// vulnerable line: 101: wp_redirect(add_query_arg('updated', '', wp_get_referer()));",
                "// Line 102:             exit;",
                "// Line 103:         }",
                "// Line 104:     }",
                "// Line 105: ",
                "// Line 106: ",
                "// Line 107:     /**",
                "// Line 108:      * Validates and updates settings for the plugin.",
                "// Line 109:      *",
                "// Line 110:      * @param hash    $new The new options to be validated and stored.",
                "// Line 111:      * @return bool True on success, False if there were any errors.",
                "// Line 352:         <?php endforeach; ?>",
                "// Line 353:         </ul>",
                "// Line 354:     </div>",
                "// Line 355:     <?php endif; ?>",
                "// Line 356: ",
                "// Line 357:     <div class='wrap'>",
                "// Line 358:     <h2><?php _e( 'TFO Graphviz Options', 'tfo-graphviz' ); ?></h2>",
                "// Line 359: ",
                "// Line 360:     <?php if ( empty( $errors ) ) $this->test_image(); ?>",
                "// Line 361: ",
                "// vulnerable line: 362: <form action=\"<?php echo clean_url( remove_query_arg( 'updated' ) ); ?>\" method=\"post\">",
                "// Line 363: ",
                "// Line 364:     <table class=\"form-table\">",
                "// Line 365:     <tbody>",
                "// Line 366:         <?php if ( empty( $errors ) ): ?>",
                "// Line 367:         <tr>",
                "// Line 368:             <th scope=\"row\"><?php _e( 'Syntax' ); ?></th>",
                "// Line 369:             <td class=\"syntax\">",
                "// Line 370:             <p><?php printf( __( 'Use the shortcode syntax %s to insert graphs into your posts.', 'tfo-graphviz' ),",
                "// Line 371:             '<code>[graphviz]digraph test { a1 -> a2 -> a3 -> a1; }[/graphviz]</code>'",
                "// Line 372:         ); ?></p>"
            ]
        }
    ]
}