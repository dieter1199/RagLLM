{
    "cve_id": "CVE-2023-45808",
    "cve_description": "iTop is an IT service management platform.  When creating or updating an object, extkey values aren't checked to be in the current user silo. In other words, by forging an http request, the user can create objects pointing to out of silo objects (for example a UserRequest in an out of scope Organization). Fixed in iTop 2.7.10, 3.0.4, 3.1.1, and 3.2.0.",
    "cve_publish_date": "2024-04-15T18:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "NÂ°6458 Fix portal errors",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ObjectFormManager.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 25: use AttributeSet;",
                "// Line 26: use CMDBChangeOpAttachmentAdded;",
                "// Line 27: use CMDBChangeOpAttachmentRemoved;",
                "// Line 28: use Combodo\\iTop\\Form\\Field\\Field;",
                "// Line 29: use Combodo\\iTop\\Form\\Field\\FileUploadField;",
                "// Line 30: use Combodo\\iTop\\Form\\Field\\LabelField;",
                "// Line 31: use Combodo\\iTop\\Form\\Form;",
                "// Line 32: use Combodo\\iTop\\Form\\FormManager;",
                "// Line 33: use Combodo\\iTop\\Portal\\Helper\\ApplicationHelper;",
                "// Line 34: use Combodo\\iTop\\Portal\\Helper\\ObjectFormHandlerHelper;",
                "// vulnerable line: 35: use Combodo\\iTop\\Portal\\Helper\\SecurityHelper;",
                "// Line 36: use CoreCannotSaveObjectException;",
                "// Line 37: use DBObject;",
                "// Line 38: use DBObjectSearch;",
                "// Line 39: use DBObjectSet;",
                "// Line 40: use DBSearch;",
                "// Line 41: use Dict;",
                "// Line 42: use DOMDocument;",
                "// Line 43: use DOMXPath;",
                "// Line 44: use Exception;",
                "// Line 45: use ExceptionLog;",
                "// Line 1129: ",
                "// Line 1130:         $sObjectClass = get_class($this->oObject);",
                "// Line 1131: ",
                "// Line 1132:         $bExceptionLogged = false;",
                "// Line 1133:         try {",
                "// Line 1134:             // modification flags",
                "// Line 1135:             $bIsNew = $this->oObject->IsNew();",
                "// Line 1136:             $bWasModified = $this->oObject->IsModified();",
                "// Line 1137:             $bActivateTriggers = (!$bIsNew && $bWasModified);",
                "// Line 1138: ",
                "// vulnerable line: 1139: /** @var SecurityHelper $oSecurityHelper */",
                "// vulnerable line: 1140: $oSecurityHelper = $this->oContainer->get('security_helper');",
                "// Line 1141: ",
                "// Line 1142:             // Forcing allowed writing on the object if necessary. This is used in some particular cases.",
                "// vulnerable line: 1143: $bAllowWrite = $this->oFormHandlerHelper->getSecurityHelper()->IsActionAllowed($bIsNew ? UR_ACTION_CREATE : UR_ACTION_MODIFY, $sObjectClass, $this->oObject->GetKey());",
                "// Line 1144:             if ($bAllowWrite) {",
                "// Line 1145:                 $this->oObject->AllowWrite(true);",
                "// Line 1146:             }",
                "// Line 1147: ",
                "// Line 1148:             // Writing object to DB",
                "// Line 1149:             try",
                "// Line 1150:             {",
                "// Line 1151:                 $this->oObject->CheckChangedExtKeysValues(function ($sClass, $sId) use ($oSecurityHelper): bool {",
                "// Line 1152:                     return $oSecurityHelper->IsActionAllowed(UR_ACTION_READ, $sClass, $sId);",
                "// Line 1153:                 });"
            ]
        }
    ]
}