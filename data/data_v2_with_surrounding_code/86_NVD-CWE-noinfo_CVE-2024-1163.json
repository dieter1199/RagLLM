{
    "cve_id": "CVE-2024-1163",
    "cve_description": "Uncontrolled Resource Consumption in GitHub repository mbloch/mapshaper prior to 0.6.44.",
    "cve_publish_date": "2024-02-13T15:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "v0.6.44",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "mapshaper-gui",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "9",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 54:   var str = Math.random().toString(16) + Math.random().toString(16);",
                "// Line 55:   return str.replace(/0\\./g, '').substr(0, 20);",
                "// Line 56: }",
                "// Line 57: ",
                "// Line 58: function startServer(port) {",
                "// Line 59:   var timeout;",
                "// Line 60: ",
                "// Line 61:   http.createServer(function(request, response) {",
                "// Line 62:     var uri = url.parse(request.url).pathname;",
                "// Line 63:     clearTimeout(timeout);",
                "// vulnerable line: 64: if (uri == '/close') {",
                "// Line 65:       // end process when page closes, unless page is immediately refreshed",
                "// Line 66:       timeout = setTimeout(function() {",
                "// Line 67:         process.exit(0);",
                "// Line 68:       }, 200);",
                "// Line 69:     } else if (uri == \"/manifest.js\") {",
                "// Line 70:       if (!sessionId && opts.directSave) {",
                "// Line 71:         // create a session id for authenticating requests to save files",
                "// Line 72:         // (see saveContent())",
                "// Line 73:         sessionId = getRandomSessionId();",
                "// Line 74:         new Cookies(request, response).set('session_id', sessionId);"
            ]
        },
        {
            "filename_of_changes": "package-lock.json",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: {",
                "// Line 2:   \"name\": \"mapshaper\",",
                "// vulnerable line: 3: \"version\": \"0.6.43\",",
                "// Line 4:   \"lockfileVersion\": 2,",
                "// Line 5:   \"requires\": true,",
                "// Line 6:   \"packages\": {",
                "// Line 7:     \"\": {",
                "// Line 8:       \"name\": \"mapshaper\",",
                "// vulnerable line: 9: \"version\": \"0.6.43\",",
                "// Line 10:       \"license\": \"MPL-2.0\",",
                "// Line 11:       \"dependencies\": {",
                "// Line 12:         \"@placemarkio/tokml\": \"^0.3.3\",",
                "// Line 13:         \"@tmcw/togeojson\": \"^5.6.0\",",
                "// Line 14:         \"@xmldom/xmldom\": \"^0.8.6\",",
                "// Line 15:         \"adm-zip\": \"^0.5.9\",",
                "// Line 16:         \"commander\": \"7.0.0\",",
                "// Line 17:         \"cookies\": \"^0.8.0\",",
                "// Line 18:         \"d3-color\": \"3.1.0\",",
                "// Line 19:         \"d3-interpolate\": \"^3.0.1\","
            ]
        }
    ]
}