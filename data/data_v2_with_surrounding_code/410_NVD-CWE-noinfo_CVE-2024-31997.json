{
    "cve_id": "CVE-2024-31997",
    "cve_description": "XWiki Platform is a generic wiki platform. Prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, parameters of UI extensions are always interpreted as Velocity code and executed with programming rights. Any user with edit right on any document like the user's own profile can create UI extensions. This allows remote code execution and thereby impacts the confidentiality, integrity and availability of the whole XWiki installation. This vulnerability has been patched in XWiki 14.10.19, 15.5.4 and 15.9-RC1. No known workarounds are available.",
    "cve_publish_date": "2024-04-10T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "XWIKI-21335: Execute UI Extension parameters with the rights of their author\n\n* Check script right for the UI extension's author\n* Use AuthorExecutor to set the context author",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "WikiUIExtensionComponentBuilder.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 129: ",
                "// Line 130:         WikiUIExtension extension;",
                "// Line 131:         try {",
                "// Line 132:             extension = this.extensionProvider.get();",
                "// Line 133:             extension.initialize(baseObject, roleHint, id, extensionPointId);",
                "// Line 134:         } catch (Exception e) {",
                "// Line 135:             throw new WikiComponentException(",
                "// Line 136:                 String.format(\"Failed to initialize Panel UI extension [%s]\", baseObject.getReference()), e);",
                "// Line 137:         }",
                "// Line 138: ",
                "// vulnerable line: 139: String rawParameters = baseObject.getStringValue(PARAMETERS_PROPERTY);",
                "// Line 140: ",
                "// Line 141:         // It would be nice to have PER_LOOKUP components for UIX parameters but without constructor injection it's",
                "// Line 142:         // safer to use a POJO and pass the Component Manager to it.",
                "// vulnerable line: 143: WikiUIExtensionParameters parameters =",
                "// vulnerable line: 144: new WikiUIExtensionParameters(id, rawParameters, this.wikiComponentManager);",
                "// Line 145:         extension.setParameters(parameters);",
                "// Line 146:         extension.setScope(scope);",
                "// Line 147: ",
                "// Line 148:         return Collections.singletonList(extension);",
                "// Line 149:     }",
                "// Line 150: }"
            ]
        },
        {
            "filename_of_changes": "WikiUIExtensionComponentBuilderTest.java",
            "code_language": "Java",
            "number_of_lines_added_for_mitigation": "18",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}