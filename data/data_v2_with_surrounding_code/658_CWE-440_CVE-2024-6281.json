{
    "cve_id": "CVE-2024-6281",
    "cve_description": "A path traversal vulnerability exists in the `apply_settings` function of parisneo/lollms versions prior to 9.5.1. The `sanitize_path` function does not adequately secure the `discussion_db_name` parameter, allowing attackers to manipulate the path and potentially write to important system folders.",
    "cve_publish_date": "2024-07-20T04:15Z",
    "cwe_id": "CWE-440",
    "cwe_name": "Expected Behavior Violation",
    "cwe_description": "A feature, API, or function does not perform according to its specification.",
    "commit_message": "Fixed endpoint sanitization of discussion_db_name and user_avatar",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "lollms_configuration_infos.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 150:     \"\"\"",
                "// Line 151:     path_traversal_prone_settings=[",
                "// Line 152:                                     \"binding_name\", ",
                "// Line 153:                                     \"model_name\", ",
                "// Line 154:                                     \"model_variant\", ",
                "// Line 155:                                     \"app_custom_logo\", ",
                "// Line 156:                                     \"user_avatar\", ",
                "// Line 157:                                     \"debug_log_file_path\", ",
                "// Line 158:                                     \"petals_model_path\",",
                "// Line 159:                                     \"skills_lib_database_name\",",
                "// vulnerable line: 160: \"discussion_db_name\"",
                "// Line 161:                                     \"user_avatar\",",
                "// Line 162:                                     ",
                "// Line 163:                                     ]",
                "// Line 164:     # Prevent all outsiders from sending something to this endpoint",
                "// Line 165:     forbid_remote_access(lollmsElfServer)",
                "// Line 166:     if lollmsElfServer.config.turn_on_setting_update_validation:",
                "// Line 167:         if not show_yes_no_dialog(\"WARNING!!!\",\"I received a settings modification request.",
                "// Line 168: If this was not initiated by you, please select No. Are you the one who requested these settings changes?\"):",
                "// Line 169:             return {\"status\":False,\"error\": \"A settings modification attempt not validated by user\"}",
                "// Line 170:     try:"
            ]
        }
    ]
}