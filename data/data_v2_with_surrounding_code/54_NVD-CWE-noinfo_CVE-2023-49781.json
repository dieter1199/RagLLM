{
    "cve_id": "CVE-2023-49781",
    "cve_description": "NocoDB is software for building databases as spreadsheets. Prior to 0.202.9, a stored cross-site scripting vulnerability exists within the Formula virtual cell comments functionality. The nc-gui/components/virtual-cell/Formula.vue displays a v-html tag with the value of \"urls\" whose contents are processed by the function replaceUrlsWithLink(). This function recognizes the pattern URI::(XXX) and creates a hyperlink tag <a> with href=XXX. However, it leaves all the other contents outside of the pattern URI::(XXX) unchanged. This vulnerability is fixed in 0.202.9.\n",
    "cve_publish_date": "2024-05-14T14:06Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix: sanitise formula text before rendering",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "urlUtils.ts",
            "code_language": "TypeScript",
            "number_of_lines_added_for_mitigation": "8",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: import isURL from 'validator/lib/isURL'",
                "// Line 2: ",
                "// Line 3: export const replaceUrlsWithLink = (text: string): boolean | string => {",
                "// Line 4:   if (!text) {",
                "// Line 5:     return false",
                "// Line 6:   }",
                "// Line 7: ",
                "// Line 8:   const rawText = text.toString()",
                "// Line 9:   let found = false",
                "// vulnerable line: 10: const out = rawText.replace(/URI::\\((.*?)\\)/g, (_, url) => {",
                "// Line 11:     found = true",
                "// Line 12:     const a = document.createElement('a')",
                "// Line 13:     a.textContent = url",
                "// Line 14:     a.setAttribute('href', url)",
                "// Line 15:     a.setAttribute('target', '_blank')",
                "// Line 16:     a.setAttribute('rel', 'noopener,noreferrer')",
                "// Line 17:     return a.outerHTML",
                "// Line 18:   })",
                "// Line 19: ",
                "// Line 20:   return found && out"
            ]
        }
    ]
}