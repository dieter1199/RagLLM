{
    "cve_id": "CVE-2024-31462",
    "cve_description": "stable-diffusion-webui is a web interface for Stable Diffusion, implemented using Gradio library. Stable-diffusion-webui 1.7.0 is vulnerable to a limited file write affecting Windows systems. The create_ui method (Backup/Restore tab) in modules/ui_extensions.py takes user input into the config_save_name variable on line 653. This user input is later used in the save_config_state method and used to create a file path on line 65, which is afterwards opened for writing on line 67, which leads to a limited file write exploitable on Windows systems. This issue may lead to limited file write. It allows for writing json files anywhere on the server where the web server has access.",
    "cve_publish_date": "2024-04-12T22:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "fix limited file write (thanks, Sylwia)",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "ui_extensions.py",
            "code_language": "Python",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 51:     shared.opts.save(shared.config_filename)",
                "// Line 52: ",
                "// Line 53:     if restart.is_restartable():",
                "// Line 54:         restart.restart_program()",
                "// Line 55:     else:",
                "// Line 56:         restart.stop_program()",
                "// Line 57: ",
                "// Line 58: ",
                "// Line 59: def save_config_state(name):",
                "// Line 60:     current_config_state = config_states.get_config()",
                "// vulnerable line: 61: if not name:",
                "// vulnerable line: 62: name = \"Config\"",
                "// Line 63:     current_config_state[\"name\"] = name",
                "// Line 64:     timestamp = datetime.now().strftime('%Y_%m_%d-%H_%M_%S')",
                "// Line 65:     filename = os.path.join(config_states_dir, f\"{timestamp}_{name}.json\")",
                "// Line 66:     print(f\"Saving backup of webui/extension state to {filename}.\")",
                "// Line 67:     with open(filename, \"w\", encoding=\"utf-8\") as f:",
                "// Line 68:         json.dump(current_config_state, f, indent=4, ensure_ascii=False)",
                "// Line 69:     config_states.list_config_states()",
                "// Line 70:     new_value = next(iter(config_states.all_config_states.keys()), \"Current\")",
                "// Line 71:     new_choices = [\"Current\"] + list(config_states.all_config_states.keys())",
                "// Line 72:     return gr.Dropdown.update(value=new_value, choices=new_choices), f\"<span>Saved current webui/extension state to \"{filename}\"</span>\""
            ]
        }
    ]
}