{
    "cve_id": "CVE-2021-47154",
    "cve_description": "The Net::CIDR::Lite module before 0.22 for Perl does not properly consider extraneous zero characters at the beginning of an IP address string, which (in some situations) allows attackers to bypass access control that is based on IP addresses.",
    "cve_publish_date": "2024-03-18T05:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Security: Prevent leading zeroes in ipv4 octets\n\nThis prevents prevents octal ipv4 addresses from being incorrectly\nhandled by not supporting leading zeroes.\n\n010.0.0.1 was incorrectly treated as 10.0.0.1, rather than 8.0.0.1\n\nMore information is availabe here:\nhttps://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "Lite.pm",
            "code_language": "Perl",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 174:           } 0..$nbits",
                "// Line 175:     ];",
                "// Line 176:     $$self{RANGES} = {};",
                "// Line 177:     $self;",
                "// Line 178: }",
                "// Line 179: ",
                "// Line 180: sub _pack_ipv4 {",
                "// Line 181:     my @nums = split /\\./, shift(), -1;",
                "// Line 182:     return unless @nums == 4;",
                "// Line 183:     for (@nums) {",
                "// vulnerable line: 184: return unless /^\\d{1,3}$/ and $_ <= 255;",
                "// Line 185:     }",
                "// Line 186:     pack(\"CC*\", 0, @nums);",
                "// Line 187: }",
                "// Line 188: ",
                "// Line 189: sub _unpack_ipv4 {",
                "// Line 190:     join(\".\", unpack(\"xC*\", shift));",
                "// Line 191: }",
                "// Line 192: ",
                "// Line 193: sub _pack_ipv6 {",
                "// Line 194:     my $ip = shift;"
            ]
        },
        {
            "filename_of_changes": "base.t",
            "code_language": "Perl",
            "number_of_lines_added_for_mitigation": "12",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 1: # Before `make install' is performed this script should be runnable with",
                "// Line 2: # `make test'. After `make install' it should work as `perl test.pl'",
                "// Line 3: ",
                "// Line 4: #########################",
                "// Line 5: ",
                "// Line 6: # change 'tests => 1' to 'tests => last_test_to_print';",
                "// Line 7: ",
                "// Line 8: use Test;",
                "// Line 9: use strict;",
                "// Line 10: $|++;",
                "// vulnerable line: 11: BEGIN { plan tests => 39 };",
                "// Line 12: use Net::CIDR::Lite;",
                "// Line 13: ok(1); # If we made it this far, we are ok.",
                "// Line 14: ",
                "// Line 15: #########################",
                "// Line 16: ",
                "// Line 17: # Insert your test code below, the Test module is use()ed here so read",
                "// Line 18: # its man page ( perldoc Test ) for help writing this test script.",
                "// Line 19: ",
                "// Line 20: my $empty = Net::CIDR::Lite->new;",
                "// Line 21: ok(!$empty->find('127.0.0.1'));"
            ]
        }
    ]
}