{
    "cve_id": "CVE-2024-22189",
    "cve_description": "quic-go is an implementation of the QUIC protocol in Go. Prior to version 0.42.0, an attacker can cause its peer to run out of memory sending a large number of `NEW_CONNECTION_ID` frames that retire old connection IDs. The receiver is supposed to respond to each retirement frame with a `RETIRE_CONNECTION_ID` frame. The attacker can prevent the receiver from sending out (the vast majority of) these `RETIRE_CONNECTION_ID` frames by collapsing the peers congestion window (by selectively acknowledging received packets) and by manipulating the peer's RTT estimate. Version 0.42.0 contains a patch for the issue. No known workarounds are available.",
    "cve_publish_date": "2024-04-04T15:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "close connection when an abnormally large number of frames are queued (#4369)\n\nUnder normal circumstances, we should be able to send out control frames\r\nright away, so we don't expect any queue to build up. To defend against\r\nresource exhaustion attacks, we limit the control frame queue to 16384\r\nelements.",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "connection.go",
            "code_language": "Go",
            "number_of_lines_added_for_mitigation": "3",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "framer.go",
            "code_language": "Go",
            "number_of_lines_added_for_mitigation": "24",
            "number_of_lines_deleted_vulnerable_to_cve": "4",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 16: ",
                "// Line 17:     QueueControlFrame(wire.Frame)",
                "// Line 18:     AppendControlFrames([]ackhandler.Frame, protocol.ByteCount, protocol.Version) ([]ackhandler.Frame, protocol.ByteCount)",
                "// Line 19: ",
                "// Line 20:     AddActiveStream(protocol.StreamID)",
                "// Line 21:     AppendStreamFrames([]ackhandler.StreamFrame, protocol.ByteCount, protocol.Version) ([]ackhandler.StreamFrame, protocol.ByteCount)",
                "// Line 22: ",
                "// Line 23:     Handle0RTTRejection() error",
                "// Line 24: }",
                "// Line 25: ",
                "// vulnerable line: 26: const maxPathResponses = 256",
                "// Line 27: ",
                "// Line 28: type framerI struct {",
                "// Line 29:     mutex sync.Mutex",
                "// Line 30: ",
                "// Line 31:     streamGetter streamGetter",
                "// Line 32: ",
                "// Line 33:     activeStreams map[protocol.StreamID]struct{}",
                "// Line 34:     streamQueue   ringbuffer.RingBuffer[protocol.StreamID]",
                "// Line 35: ",
                "// vulnerable line: 36: controlFrameMutex sync.Mutex",
                "// vulnerable line: 37: controlFrames     []wire.Frame",
                "// vulnerable line: 38: pathResponses     []*wire.PathResponseFrame",
                "// Line 39: }",
                "// Line 40: ",
                "// Line 41: var _ framer = &framerI{}",
                "// Line 42: ",
                "// Line 43: func newFramer(streamGetter streamGetter) framer {",
                "// Line 44:     return &framerI{",
                "// Line 45:         streamGetter:  streamGetter,",
                "// Line 46:         activeStreams: make(map[protocol.StreamID]struct{}),",
                "// Line 47:     }",
                "// Line 48: }"
            ]
        },
        {
            "filename_of_changes": "framer_test.go",
            "code_language": "Go",
            "number_of_lines_added_for_mitigation": "17",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}