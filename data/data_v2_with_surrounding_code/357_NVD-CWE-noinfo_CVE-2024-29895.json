{
    "cve_id": "CVE-2024-29895",
    "cve_description": "Cacti provides an operational monitoring and fault management framework. A command injection vulnerability on the 1.3.x DEV branch allows any unauthenticated user to execute arbitrary command on the server when `register_argc_argv` option of PHP is `On`. In `cmd_realtime.php` line 119, the `$poller_id` used as part of the command execution is sourced from `$_SERVER['argv']`, which can be controlled by URL when `register_argc_argv` option of PHP is `On`. And this option is `On` by default in many environments such as the main PHP Docker image for PHP. Commit 53e8014d1f082034e0646edc6286cde3800c683d contains a patch for the issue, but this commit was reverted in commit 99633903cad0de5ace636249de16f77e57a3c8fc.",
    "cve_publish_date": "2024-05-14T15:17Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-cr28-x256-xf5m",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "cmd_realtime.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 37:     print \"No graph_id, interval, pollerid specified.",
                "// Line 38: ",
                "// Line 39: \";",
                "// Line 40:     print \"Usage: cmd_realtime.php POLLER_ID GRAPH_ID INTERVAL",
                "// Line 41: ",
                "// Line 42: \";",
                "// Line 43: ",
                "// Line 44:     exit(-1);",
                "// Line 45: }",
                "// Line 46: ",
                "// vulnerable line: 47: $poller_id = $_SERVER['argv'][1];",
                "// Line 48: $graph_id  = (int)$_SERVER['argv'][2];",
                "// Line 49: $interval  = (int)$_SERVER['argv'][3];",
                "// Line 50: ",
                "// Line 51: if ($graph_id <= 0) {",
                "// Line 52:     print \"Invalid graph_id specified.",
                "// Line 53: ",
                "// Line 54: \";",
                "// Line 55: ",
                "// Line 56:     exit(-1);",
                "// Line 57: }"
            ]
        }
    ]
}