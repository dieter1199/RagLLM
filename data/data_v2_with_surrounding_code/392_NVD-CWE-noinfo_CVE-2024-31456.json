{
    "cve_id": "CVE-2024-31456",
    "cve_description": "GLPI is a Free Asset and IT Management Software package. Prior to 10.0.15, an authenticated user can exploit a SQL injection vulnerability from map search. This vulnerability is fixed in 10.0.15.",
    "cve_publish_date": "2024-05-07T14:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-gcj4-2cp3-6h5j",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "Search.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "7",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        },
        {
            "filename_of_changes": "map.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 41: ",
                "// Line 42: $result = [];",
                "// Line 43: if (!isset($_POST['itemtype']) || !isset($_POST['params'])) {",
                "// Line 44:     http_response_code(500);",
                "// Line 45:     $result = [",
                "// Line 46:         'success'   => false,",
                "// Line 47:         'message'   => __('Required argument missing!')",
                "// Line 48:     ];",
                "// Line 49: } else {",
                "// Line 50:     $itemtype = $_POST['itemtype'];",
                "// vulnerable line: 51: $params   = $_POST['params'];",
                "// Line 52: ",
                "// Line 53:     $data = Search::prepareDatasForSearch($itemtype, $params);",
                "// Line 54:     Search::constructSQL($data);",
                "// Line 55:     Search::constructData($data);",
                "// Line 56: ",
                "// Line 57:     if ($itemtype == 'Location') {",
                "// Line 58:         $lat_field = $itemtype . '_21';",
                "// Line 59:         $lng_field = $itemtype . '_20';",
                "// Line 60:         $name_field = $itemtype . '_1';",
                "// Line 61:     } else if ($itemtype == 'Entity') {"
            ]
        }
    ]
}