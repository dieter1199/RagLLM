{
    "cve_id": "CVE-2024-23335",
    "cve_description": "MyBB is a free and open source forum software. The backup management module of the Admin CP may accept `.htaccess` as the name of the backup file to be deleted, which may expose the stored backup files over HTTP on Apache servers. MyBB 1.8.38 resolves this issue. Users are advised to upgrade. There are no known workarounds for this vulnerability",
    "cve_publish_date": "2024-05-01T07:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Fix backups directory .htaccess deletion",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "backupdb.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "2",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 94: ",
                "// Line 95: if($mybb->input['action'] == \"delete\")",
                "// Line 96: {",
                "// Line 97:     if($mybb->get_input('no'))",
                "// Line 98:     {",
                "// Line 99:         admin_redirect(\"index.php?module=tools-backupdb\");",
                "// Line 100:     }",
                "// Line 101: ",
                "// Line 102:     $file = basename($mybb->input['file']);",
                "// Line 103: ",
                "// vulnerable line: 104: if(!trim($mybb->input['file']) || !file_exists(MYBB_ADMIN_DIR.'backups/'.$file))",
                "// Line 105:     {",
                "// Line 106:         flash_message($lang->error_backup_doesnt_exist, 'error');",
                "// Line 107:         admin_redirect(\"index.php?module=tools-backupdb\");",
                "// Line 108:     }",
                "// Line 109: ",
                "// Line 110:     $plugins->run_hooks(\"admin_tools_backupdb_delete\");",
                "// Line 111: ",
                "// Line 112:     if($mybb->request_method == \"post\")",
                "// Line 113:     {",
                "// Line 114:         $delete = @unlink(MYBB_ADMIN_DIR.'backups/'.$file);"
            ]
        }
    ]
}