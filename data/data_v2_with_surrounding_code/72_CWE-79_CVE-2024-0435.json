{
    "cve_id": "CVE-2024-0435",
    "cve_description": "User can send a chat that contains an XSS opportunity that will then run when the chat is sent and on subsequent page loads.\n\nGiven the minimum requirement for a user to send a chat is to be given access to a workspace via an admin the risk is low. Additionally, the location in which the XSS renders is only limited to the user who submits the XSS. \n\nUltimately, this attack is limited to the user attacking themselves. There is no anonymous chat submission unless the user does not take the minimum steps required to protect their instance.",
    "cve_publish_date": "2024-02-26T16:27Z",
    "cwe_id": "CWE-79",
    "cwe_name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "cwe_description": "The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.",
    "commit_message": "Patch minor XSS opportunity where user can self-XSS themselves.  (#574)\n\nPatch minor XSS opportunity where user can self-XSS themselvess. There is not real vuln here as any instance is not public facing",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "index.jsx",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "5",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 38:             {error ? (",
                "// Line 39:               <span",
                "// Line 40:                 className={`inline-block p-2 rounded-lg bg-red-50 text-red-500`}",
                "// Line 41:               >",
                "// Line 42:                 <Warning className=\"h-4 w-4 mb-1 inline-block\" /> Could not",
                "// Line 43:                 respond to message.",
                "// Line 44:               </span>",
                "// Line 45:             ) : (",
                "// Line 46:               <span",
                "// Line 47:                 className={`whitespace-pre-line text-white font-normal text-sm md:text-sm flex flex-col gap-y-1 mt-2`}",
                "// vulnerable line: 48: dangerouslySetInnerHTML={{ __html: renderMarkdown(message) }}",
                "// Line 49:               />",
                "// Line 50:             )}",
                "// Line 51:           </div>",
                "// Line 52:           {role === \"assistant\" && <Citations sources={sources} />}",
                "// Line 53:         </div>",
                "// Line 54:       </div>",
                "// Line 55:     );",
                "// Line 56:   }",
                "// Line 57: );",
                "// Line 58: "
            ]
        },
        {
            "filename_of_changes": "package.json",
            "code_language": "JavaScript",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "0",
            "Code_with_highlighted_vulnerability_lines": []
        }
    ]
}