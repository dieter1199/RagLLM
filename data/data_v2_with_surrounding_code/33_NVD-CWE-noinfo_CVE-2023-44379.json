{
    "cve_id": "CVE-2023-44379",
    "cve_description": "baserCMS is a website development framework. Prior to version 5.0.9, there is a cross-site scripting vulnerability in the site search feature. Version 5.0.9 contains a fix for this vulnerability.",
    "cve_publish_date": "2024-02-22T15:15Z",
    "cwe_id": "NVD-CWE-noinfo",
    "cwe_name": "Insufficient Information",
    "cwe_description": "There is insufficient information about the issue to classify it; details are unkown or unspecified.",
    "commit_message": "Merge pull request from GHSA-66c2-p8rh-qx87",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "search.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 25: ?>",
                "// Line 26: ",
                "// Line 27: ",
                "// Line 28: <h2 class=\"bs-search-title\"><?php $this->BcBaser->contentsTitle() ?></h2>",
                "// Line 29: ",
                "// Line 30: <div class=\"bs-search-form\">",
                "// Line 31:     <?php echo $this->BcBaser->createForm($searchIndexesFront, ['type' => 'get']) ?>",
                "// Line 32:     <?php if ($contentFolders): ?>",
                "// Line 33:         <?php echo $this->BcBaser->formControl('f', ['type' => 'select', 'options' => $contentFolders, 'empty' => __d('baser_core', 'カテゴリ')]) ?>",
                "// Line 34:     <?php endif ?>",
                "// vulnerable line: 35: <?php echo $this->BcBaser->formControl('q', ['placeholder' => __d('baser_core', 'キーワード'), 'escape' => false, 'div' => false]) ?>",
                "// Line 36:     <?php echo $this->BcBaser->formHidden('s') ?>",
                "// Line 37:     <?php echo $this->BcBaser->formSubmit(__d('baser_core', '検索'), ['div' => false, 'class' => 'bs-button-small']) ?>",
                "// Line 38:     <?php echo $this->BcBaser->endForm() ?>",
                "// Line 39: </div>",
                "// Line 40: ",
                "// Line 41: <section class=\"bs-search-header\">",
                "// Line 42:     <?php $this->BcBaser->element('list_counter') ?>",
                "// Line 43:     <?php $this->BcBaser->element('list_num') ?>",
                "// Line 44: </section>",
                "// Line 45: "
            ]
        },
        {
            "filename_of_changes": "site_search_form.php",
            "code_language": "PHP",
            "number_of_lines_added_for_mitigation": "1",
            "number_of_lines_deleted_vulnerable_to_cve": "1",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 9:     $url = array('plugin' => 'BcSearchIndex', 'controller' => 'SearchIndexes', 'action' => 'search', 'num' => $this->getRequest()->getQuery('limit'));",
                "// Line 10: } else {",
                "// Line 11:     $url = array('plugin' => 'BcSearchIndex', 'controller' => 'SearchIndexes', 'action' => 'search');",
                "// Line 12: }",
                "// Line 13: if(!isset($searchIndexesFront)) $searchIndexesFront = null;",
                "// Line 14: ?>",
                "// Line 15: ",
                "// Line 16: ",
                "// Line 17: <div class=\"section search-box\">",
                "// Line 18:     <?php echo $this->BcForm->create($searchIndexesFront, array('type' => 'get', 'url' => $url)) ?>",
                "// vulnerable line: 19: <?php echo $this->BcForm->control('q', ['escape' => false]) ?>",
                "// Line 20:     <?php echo $this->BcForm->hidden('site_id', ['value' => $this->getRequest()->getAttribute('currentSite')->id]) ?>",
                "// Line 21:     <?php echo $this->BcForm->submit('検索', array('div' => false, 'class' => 'submit_button bs-button')) ?>",
                "// Line 22:     <?php echo $this->BcForm->end() ?>",
                "// Line 23: </div>"
            ]
        }
    ]
}