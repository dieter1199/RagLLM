{
    "cve_id": "CVE-2024-6409",
    "cve_description": "A race condition vulnerability was discovered in how signals are handled by OpenSSH's server (sshd). If a remote attacker does not authenticate within a set time period, then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog(). As a consequence of a successful attack, in the worst case scenario, an attacker may be able to perform a remote code execution (RCE) as an unprivileged user running the sshd server.",
    "cve_publish_date": "2024-07-08T18:15Z",
    "cwe_id": "CWE-364",
    "cwe_name": "Signal Handler Race Condition",
    "cwe_description": "The product uses a signal handler that introduces a race condition.",
    "commit_message": "import openssh-8.7p1-38.el9_4.4",
    "type_of_change": "Modification",
    "changes": [
        {
            "filename_of_changes": "openssh.spec",
            "code_language": "Shell",
            "number_of_lines_added_for_mitigation": "12",
            "number_of_lines_deleted_vulnerable_to_cve": "2",
            "Code_with_highlighted_vulnerability_lines": [
                "// Line 47: ",
                "// Line 48: # Do not forget to bump pam_ssh_agent_auth release if you rewind the main package release to 1",
                "// Line 49: %global openssh_ver 8.7p1",
                "// Line 50: %global openssh_rel 38",
                "// Line 51: %global pam_ssh_agent_ver 0.10.4",
                "// Line 52: %global pam_ssh_agent_rel 5",
                "// Line 53: ",
                "// Line 54: Summary: An open source implementation of SSH protocol version 2",
                "// Line 55: Name: openssh",
                "// Line 56: Version: %{openssh_ver}",
                "// vulnerable line: 57: Release: %{openssh_rel}%{?dist}.1",
                "// Line 58: URL: http://www.openssh.com/portable.html",
                "// Line 59: #URL1: https://github.com/jbeverly/pam_ssh_agent_auth/",
                "// Line 60: Source0: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz",
                "// Line 61: Source1: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz.asc",
                "// Line 62: Source2: sshd.pam",
                "// Line 63: Source3: gpgkey-736060BA.gpg",
                "// Line 64: Source4: https://github.com/jbeverly/pam_ssh_agent_auth/archive/pam_ssh_agent_auth-%{pam_ssh_agent_ver}.tar.gz",
                "// Line 65: Source5: pam_ssh_agent-rmheaders",
                "// Line 66: Source6: ssh-keycat.pam",
                "// Line 67: Source7: sshd.sysconfig",
                "// Line 356: Summary: A passphrase dialog for OpenSSH and X",
                "// Line 357: Requires: openssh = %{version}-%{release}",
                "// Line 358: ",
                "// Line 359: %package sk-dummy",
                "// Line 360: Summary: OpenSSH SK driver for test purposes",
                "// Line 361: Requires: openssh = %{version}-%{release}",
                "// Line 362: ",
                "// Line 363: %package -n pam_ssh_agent_auth",
                "// Line 364: Summary: PAM module for authentication with ssh-agent",
                "// Line 365: Version: %{pam_ssh_agent_ver}",
                "// vulnerable line: 366: Release: %{pam_ssh_agent_rel}.%{openssh_rel}%{?dist}.1",
                "// Line 367: License: BSD",
                "// Line 368: ",
                "// Line 369: %description",
                "// Line 370: SSH (Secure SHell) is a program for logging into and executing",
                "// Line 371: commands on a remote machine. SSH is intended to replace rlogin and",
                "// Line 372: rsh, and to provide secure encrypted communications between two",
                "// Line 373: untrusted hosts over an insecure network. X11 connections and",
                "// Line 374: arbitrary TCP/IP ports can also be forwarded over the secure channel.",
                "// Line 375: ",
                "// Line 376: OpenSSH is OpenBSD's version of the last free version of SSH, bringing"
            ]
        }
    ]
}